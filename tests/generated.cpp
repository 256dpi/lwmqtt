#include <gtest/gtest.h>

extern "C" {
#include <lwmqtt.h>
#include "../src/packet.h"
}

#ifdef __GNUC__
#pragma GCC diagnostic push
#ifdef __clang__
#pragma GCC diagnostic ignored "-Wc99-extensions"
#else
#pragma GCC diagnostic ignored "-Wpedantic"
#endif
#endif

#define EXPECT_ARRAY_EQ(reference, actual, element_count)                 \
  {                                                                       \
    for (size_t cmp_i = 0; cmp_i < element_count; cmp_i++) {              \
      EXPECT_EQ(reference[cmp_i], actual[cmp_i]) << "At byte: " << cmp_i; \
    }                                                                     \
  }

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = ";\135[\241\201\187\168\ETX\227\158\138\182\179\234\250\172\152\219\131\130!", _pubPktID = 24061, _pubBody = "\206\141\147\181o\253", _pubProps = []}
TEST(Publish311QCTest, Encode1) {
uint8_t pkt[] = {0x33, 0x1f, 0x0, 0x15, 0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21, 0x5d, 0xfd, 0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
  uint8_t topic_bytes[] = {0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21};
  lwmqtt_string_t topic = {21, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 6;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 24061, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = ";\135[\241\201\187\168\ETX\227\158\138\182\179\234\250\172\152\219\131\130!", _pubPktID = 24061, _pubBody = "\206\141\147\181o\253", _pubProps = []}
TEST(Publish311QCTest, Decode1) {
uint8_t pkt[] = {0x33, 0x1f, 0x0, 0x15, 0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21, 0x5d, 0xfd, 0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21};
  lwmqtt_string_t exp_topic = {21, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
  lwmqtt_string_t exp_body = {6, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 24061);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 21);
EXPECT_EQ(msg.payload_len, 6);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 6);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\148\US\b\177\214\241A\128\215\138NRR\141\t\208\DC4\231\253\232\EM\205\r\162\157", _pubPktID = 0, _pubBody = "\DELQr", _pubProps = []}
TEST(Publish311QCTest, Encode2) {
uint8_t pkt[] = {0x31, 0x1e, 0x0, 0x19, 0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d, 0x7f, 0x51, 0x72};
  uint8_t topic_bytes[] = {0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d};
  lwmqtt_string_t topic = {25, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x7f, 0x51, 0x72};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\148\US\b\177\214\241A\128\215\138NRR\141\t\208\DC4\231\253\232\EM\205\r\162\157", _pubPktID = 0, _pubBody = "\DELQr", _pubProps = []}
TEST(Publish311QCTest, Decode2) {
uint8_t pkt[] = {0x31, 0x1e, 0x0, 0x19, 0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d, 0x7f, 0x51, 0x72};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d};
  lwmqtt_string_t exp_topic = {25, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7f, 0x51, 0x72};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 25);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\CANO\164\EM\236\160:x\bB\170\222ObK\201\DC1\168W}>\187\DC1", _pubPktID = 0, _pubBody = "", _pubProps = []}
TEST(Publish311QCTest, Encode3) {
uint8_t pkt[] = {0x38, 0x19, 0x0, 0x17, 0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
  uint8_t topic_bytes[] = {0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
  lwmqtt_string_t topic = {23, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = false;
uint8_t msg_bytes[] = {0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 0;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\CANO\164\EM\236\160:x\bB\170\222ObK\201\DC1\168W}>\187\DC1", _pubPktID = 0, _pubBody = "", _pubProps = []}
TEST(Publish311QCTest, Decode3) {
uint8_t pkt[] = {0x38, 0x19, 0x0, 0x17, 0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
  lwmqtt_string_t exp_topic = {23, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0};
  lwmqtt_string_t exp_body = {0, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 23);
EXPECT_EQ(msg.payload_len, 0);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 0);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "]\151\151\159oP\170", _pubPktID = 14052, _pubBody = "\254\174c\158\219\&7\163j\130\179TW\155\250\141\164c", _pubProps = []}
TEST(Publish311QCTest, Encode4) {
uint8_t pkt[] = {0x3b, 0x1c, 0x0, 0x7, 0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa, 0x36, 0xe4, 0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
  uint8_t topic_bytes[] = {0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa};
  lwmqtt_string_t topic = {7, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 17;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 14052, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "]\151\151\159oP\170", _pubPktID = 14052, _pubBody = "\254\174c\158\219\&7\163j\130\179TW\155\250\141\164c", _pubProps = []}
TEST(Publish311QCTest, Decode4) {
uint8_t pkt[] = {0x3b, 0x1c, 0x0, 0x7, 0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa, 0x36, 0xe4, 0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa};
  lwmqtt_string_t exp_topic = {7, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
  lwmqtt_string_t exp_body = {17, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 14052);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 7);
EXPECT_EQ(msg.payload_len, 17);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 17);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "F\129\169\SYN\215A[Qx}\223\&7NE\181\250\249\236\208\GSL\217\176\183\235\&0\189\247u_", _pubPktID = 26784, _pubBody = "\176\&0\158\138\138]\220(B\154\&3\224jV\159v+\130", _pubProps = []}
TEST(Publish311QCTest, Encode5) {
uint8_t pkt[] = {0x3d, 0x34, 0x0, 0x1e, 0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f, 0x68, 0xa0, 0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
  uint8_t topic_bytes[] = {0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f};
  lwmqtt_string_t topic = {30, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 18;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 26784, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "F\129\169\SYN\215A[Qx}\223\&7NE\181\250\249\236\208\GSL\217\176\183\235\&0\189\247u_", _pubPktID = 26784, _pubBody = "\176\&0\158\138\138]\220(B\154\&3\224jV\159v+\130", _pubProps = []}
TEST(Publish311QCTest, Decode5) {
uint8_t pkt[] = {0x3d, 0x34, 0x0, 0x1e, 0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f, 0x68, 0xa0, 0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f};
  lwmqtt_string_t exp_topic = {30, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
  lwmqtt_string_t exp_body = {18, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 26784);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 30);
EXPECT_EQ(msg.payload_len, 18);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 18);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "IP\\2\223\164P[u\SI\DLEh\171x\188\185\177Q#\163v7L\224Y;5", _pubPktID = 14257, _pubBody = "\215Vs\129\239\168\165b\145\208\232`\245", _pubProps = []}
TEST(Publish311QCTest, Encode6) {
uint8_t pkt[] = {0x35, 0x2c, 0x0, 0x1b, 0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35, 0x37, 0xb1, 0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
  uint8_t topic_bytes[] = {0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 14257, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "IP\\2\223\164P[u\SI\DLEh\171x\188\185\177Q#\163v7L\224Y;5", _pubPktID = 14257, _pubBody = "\215Vs\129\239\168\165b\145\208\232`\245", _pubProps = []}
TEST(Publish311QCTest, Decode6) {
uint8_t pkt[] = {0x35, 0x2c, 0x0, 0x1b, 0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35, 0x37, 0xb1, 0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35};
  lwmqtt_string_t exp_topic = {27, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 14257);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 27);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "6\RS\235\193R\DEL\172\233\219\ETX\209a8\243\RS\229\&2a", _pubPktID = 10501, _pubBody = "*K\219};J\192L&\150k\230#\253#\163\207\128\170\174\GS{\t", _pubProps = []}
TEST(Publish311QCTest, Encode7) {
uint8_t pkt[] = {0x3d, 0x2d, 0x0, 0x12, 0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61, 0x29, 0x5, 0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
  uint8_t topic_bytes[] = {0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 23;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 10501, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "6\RS\235\193R\DEL\172\233\219\ETX\209a8\243\RS\229\&2a", _pubPktID = 10501, _pubBody = "*K\219};J\192L&\150k\230#\253#\163\207\128\170\174\GS{\t", _pubProps = []}
TEST(Publish311QCTest, Decode7) {
uint8_t pkt[] = {0x3d, 0x2d, 0x0, 0x12, 0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61, 0x29, 0x5, 0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61};
  lwmqtt_string_t exp_topic = {18, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
  lwmqtt_string_t exp_body = {23, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 10501);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 18);
EXPECT_EQ(msg.payload_len, 23);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 23);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\129\171\&3\ETBSN", _pubPktID = 5903, _pubBody = "zPg\212~f\130\171\232\241P\212\ENQ'\234'@\v\177;s\157z*\DC2{\148\&6|", _pubProps = []}
TEST(Publish311QCTest, Encode8) {
uint8_t pkt[] = {0x3c, 0x27, 0x0, 0x6, 0x81, 0xab, 0x33, 0x17, 0x53, 0x4e, 0x17, 0xf, 0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
  uint8_t topic_bytes[] = {0x81, 0xab, 0x33, 0x17, 0x53, 0x4e};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 29;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 5903, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\129\171\&3\ETBSN", _pubPktID = 5903, _pubBody = "zPg\212~f\130\171\232\241P\212\ENQ'\234'@\v\177;s\157z*\DC2{\148\&6|", _pubProps = []}
TEST(Publish311QCTest, Decode8) {
uint8_t pkt[] = {0x3c, 0x27, 0x0, 0x6, 0x81, 0xab, 0x33, 0x17, 0x53, 0x4e, 0x17, 0xf, 0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x81, 0xab, 0x33, 0x17, 0x53, 0x4e};
  lwmqtt_string_t exp_topic = {6, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
  lwmqtt_string_t exp_body = {29, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 5903);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 6);
EXPECT_EQ(msg.payload_len, 29);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 29);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "f\145?\ETXkG", _pubPktID = 0, _pubBody = "z)\172\246\137o\201C\144\161\ETX\DC4\243V\SI\136\ETX\223\135V\253\SYN\a\200.", _pubProps = []}
TEST(Publish311QCTest, Encode9) {
uint8_t pkt[] = {0x31, 0x21, 0x0, 0x6, 0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47, 0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
  uint8_t topic_bytes[] = {0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "f\145?\ETXkG", _pubPktID = 0, _pubBody = "z)\172\246\137o\201C\144\161\ETX\DC4\243V\SI\136\ETX\223\135V\253\SYN\a\200.", _pubProps = []}
TEST(Publish311QCTest, Decode9) {
uint8_t pkt[] = {0x31, 0x21, 0x0, 0x6, 0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47, 0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47};
  lwmqtt_string_t exp_topic = {6, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 6);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\155rvW\187y*a\164\152\nL\EMg}@\SYN\142\DC2", _pubPktID = 0, _pubBody = "\US\US\DLE\ESC\221J\DC3T\209\207\183rx\202;\229\224\EM\241z#\169X\166\139", _pubProps = []}
TEST(Publish311QCTest, Encode10) {
uint8_t pkt[] = {0x39, 0x2e, 0x0, 0x13, 0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12, 0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
  uint8_t topic_bytes[] = {0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12};
  lwmqtt_string_t topic = {19, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\155rvW\187y*a\164\152\nL\EMg}@\SYN\142\DC2", _pubPktID = 0, _pubBody = "\US\US\DLE\ESC\221J\DC3T\209\207\183rx\202;\229\224\EM\241z#\169X\166\139", _pubProps = []}
TEST(Publish311QCTest, Decode10) {
uint8_t pkt[] = {0x39, 0x2e, 0x0, 0x13, 0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12, 0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12};
  lwmqtt_string_t exp_topic = {19, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 19);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "2n\201\176\229\EM\245*\ACK\SUB\177\b~\130\155,l", _pubPktID = 18294, _pubBody = "22", _pubProps = []}
TEST(Publish311QCTest, Encode11) {
uint8_t pkt[] = {0x33, 0x17, 0x0, 0x11, 0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c, 0x47, 0x76, 0x32, 0x32};
  uint8_t topic_bytes[] = {0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c};
  lwmqtt_string_t topic = {17, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x32, 0x32};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 2;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 18294, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "2n\201\176\229\EM\245*\ACK\SUB\177\b~\130\155,l", _pubPktID = 18294, _pubBody = "22", _pubProps = []}
TEST(Publish311QCTest, Decode11) {
uint8_t pkt[] = {0x33, 0x17, 0x0, 0x11, 0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c, 0x47, 0x76, 0x32, 0x32};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c};
  lwmqtt_string_t exp_topic = {17, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x32, 0x32};
  lwmqtt_string_t exp_body = {2, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 18294);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 17);
EXPECT_EQ(msg.payload_len, 2);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 2);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\SI\221\168J\184\157\208vn\224\GS", _pubPktID = 19130, _pubBody = "=m\162\166\ETX\DEL\SI?\155\155\229\193\RS\194\ETX^\144\196\"\134\199\t\254\147\&1\ESC\221\132", _pubProps = []}
TEST(Publish311QCTest, Encode12) {
uint8_t pkt[] = {0x3c, 0x2b, 0x0, 0xb, 0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d, 0x4a, 0xba, 0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
  uint8_t topic_bytes[] = {0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d};
  lwmqtt_string_t topic = {11, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 28;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 19130, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\SI\221\168J\184\157\208vn\224\GS", _pubPktID = 19130, _pubBody = "=m\162\166\ETX\DEL\SI?\155\155\229\193\RS\194\ETX^\144\196\"\134\199\t\254\147\&1\ESC\221\132", _pubProps = []}
TEST(Publish311QCTest, Decode12) {
uint8_t pkt[] = {0x3c, 0x2b, 0x0, 0xb, 0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d, 0x4a, 0xba, 0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d};
  lwmqtt_string_t exp_topic = {11, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
  lwmqtt_string_t exp_body = {28, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 19130);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 11);
EXPECT_EQ(msg.payload_len, 28);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 28);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\n\159\143\162\210", _pubPktID = 3591, _pubBody = "\156|7\ETB|\195\202\&4y", _pubProps = []}
TEST(Publish311QCTest, Encode13) {
uint8_t pkt[] = {0x32, 0x12, 0x0, 0x5, 0xa, 0x9f, 0x8f, 0xa2, 0xd2, 0xe, 0x7, 0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
  uint8_t topic_bytes[] = {0xa, 0x9f, 0x8f, 0xa2, 0xd2};
  lwmqtt_string_t topic = {5, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 9;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 3591, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\n\159\143\162\210", _pubPktID = 3591, _pubBody = "\156|7\ETB|\195\202\&4y", _pubProps = []}
TEST(Publish311QCTest, Decode13) {
uint8_t pkt[] = {0x32, 0x12, 0x0, 0x5, 0xa, 0x9f, 0x8f, 0xa2, 0xd2, 0xe, 0x7, 0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xa, 0x9f, 0x8f, 0xa2, 0xd2};
  lwmqtt_string_t exp_topic = {5, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
  lwmqtt_string_t exp_body = {9, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 3591);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 5);
EXPECT_EQ(msg.payload_len, 9);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 9);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\158\ESC\165s\240j\195I_\176\246\204\148I\213T\244\169E", _pubPktID = 15997, _pubBody = "tS\247\226P\227\&3\NUL\222\DC37I\219'", _pubProps = []}
TEST(Publish311QCTest, Encode14) {
uint8_t pkt[] = {0x33, 0x25, 0x0, 0x13, 0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45, 0x3e, 0x7d, 0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
  uint8_t topic_bytes[] = {0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45};
  lwmqtt_string_t topic = {19, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 14;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 15997, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\158\ESC\165s\240j\195I_\176\246\204\148I\213T\244\169E", _pubPktID = 15997, _pubBody = "tS\247\226P\227\&3\NUL\222\DC37I\219'", _pubProps = []}
TEST(Publish311QCTest, Decode14) {
uint8_t pkt[] = {0x33, 0x25, 0x0, 0x13, 0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45, 0x3e, 0x7d, 0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45};
  lwmqtt_string_t exp_topic = {19, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
  lwmqtt_string_t exp_body = {14, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 15997);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 19);
EXPECT_EQ(msg.payload_len, 14);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 14);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\233\224\135\179\172\244\254\241]\218|\ESC\137/", _pubPktID = 30908, _pubBody = "\235c=\156\"\206\185spp`\235\216", _pubProps = []}
TEST(Publish311QCTest, Encode15) {
uint8_t pkt[] = {0x32, 0x1f, 0x0, 0xe, 0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f, 0x78, 0xbc, 0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
  uint8_t topic_bytes[] = {0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f};
  lwmqtt_string_t topic = {14, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 30908, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\233\224\135\179\172\244\254\241]\218|\ESC\137/", _pubPktID = 30908, _pubBody = "\235c=\156\"\206\185spp`\235\216", _pubProps = []}
TEST(Publish311QCTest, Decode15) {
uint8_t pkt[] = {0x32, 0x1f, 0x0, 0xe, 0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f, 0x78, 0xbc, 0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f};
  lwmqtt_string_t exp_topic = {14, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 30908);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 14);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\233\218E\235\207\216\&6b\236\246\&0?\169D\196\137\228\212\200\179\RS\159", _pubPktID = 7795, _pubBody = ")\a\246\&4J\134\237\148\159\143:\EOT\237lN\252D\144\179\163'7\208\193\240", _pubProps = []}
TEST(Publish311QCTest, Encode16) {
uint8_t pkt[] = {0x3d, 0x33, 0x0, 0x16, 0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f, 0x1e, 0x73, 0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
  uint8_t topic_bytes[] = {0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f};
  lwmqtt_string_t topic = {22, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 7795, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\233\218E\235\207\216\&6b\236\246\&0?\169D\196\137\228\212\200\179\RS\159", _pubPktID = 7795, _pubBody = ")\a\246\&4J\134\237\148\159\143:\EOT\237lN\252D\144\179\163'7\208\193\240", _pubProps = []}
TEST(Publish311QCTest, Decode16) {
uint8_t pkt[] = {0x3d, 0x33, 0x0, 0x16, 0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f, 0x1e, 0x73, 0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f};
  lwmqtt_string_t exp_topic = {22, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 7795);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 22);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "i\236\180\192[~\199\179\163\147g\v\219?\135\190L\237\DC1\STX`", _pubPktID = 2871, _pubBody = "\166\217", _pubProps = []}
TEST(Publish311QCTest, Encode17) {
uint8_t pkt[] = {0x3d, 0x1b, 0x0, 0x15, 0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60, 0xb, 0x37, 0xa6, 0xd9};
  uint8_t topic_bytes[] = {0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60};
  lwmqtt_string_t topic = {21, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xa6, 0xd9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 2;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 2871, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "i\236\180\192[~\199\179\163\147g\v\219?\135\190L\237\DC1\STX`", _pubPktID = 2871, _pubBody = "\166\217", _pubProps = []}
TEST(Publish311QCTest, Decode17) {
uint8_t pkt[] = {0x3d, 0x1b, 0x0, 0x15, 0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60, 0xb, 0x37, 0xa6, 0xd9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60};
  lwmqtt_string_t exp_topic = {21, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xa6, 0xd9};
  lwmqtt_string_t exp_body = {2, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 2871);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 21);
EXPECT_EQ(msg.payload_len, 2);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 2);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "bc", _pubPktID = 16588, _pubBody = "BE\CAN\DEL\135:\DLE\226{E\240\163\&8oT+~\213", _pubProps = []}
TEST(Publish311QCTest, Encode18) {
uint8_t pkt[] = {0x33, 0x18, 0x0, 0x2, 0x62, 0x63, 0x40, 0xcc, 0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
  uint8_t topic_bytes[] = {0x62, 0x63};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 18;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 16588, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "bc", _pubPktID = 16588, _pubBody = "BE\CAN\DEL\135:\DLE\226{E\240\163\&8oT+~\213", _pubProps = []}
TEST(Publish311QCTest, Decode18) {
uint8_t pkt[] = {0x33, 0x18, 0x0, 0x2, 0x62, 0x63, 0x40, 0xcc, 0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x62, 0x63};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
  lwmqtt_string_t exp_body = {18, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 16588);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 18);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 18);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\DC3\255\173\206\232\229\219\SOH\SUB\237\217\218}\ENQ\DC3", _pubPktID = 0, _pubBody = "\184", _pubProps = []}
TEST(Publish311QCTest, Encode19) {
uint8_t pkt[] = {0x31, 0x12, 0x0, 0xf, 0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13, 0xb8};
  uint8_t topic_bytes[] = {0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13};
  lwmqtt_string_t topic = {15, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0xb8};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 1;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\DC3\255\173\206\232\229\219\SOH\SUB\237\217\218}\ENQ\DC3", _pubPktID = 0, _pubBody = "\184", _pubProps = []}
TEST(Publish311QCTest, Decode19) {
uint8_t pkt[] = {0x31, 0x12, 0x0, 0xf, 0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13, 0xb8};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13};
  lwmqtt_string_t exp_topic = {15, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xb8};
  lwmqtt_string_t exp_body = {1, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 15);
EXPECT_EQ(msg.payload_len, 1);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 1);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\134\&2\209f\v\148F\254 \253\tm", _pubPktID = 25649, _pubBody = "!mj\ACK\181\179\t\252S\212\144\149\130\150X", _pubProps = []}
TEST(Publish311QCTest, Encode20) {
uint8_t pkt[] = {0x3b, 0x1f, 0x0, 0xc, 0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d, 0x64, 0x31, 0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
  uint8_t topic_bytes[] = {0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d};
  lwmqtt_string_t topic = {12, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 15;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 25649, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\134\&2\209f\v\148F\254 \253\tm", _pubPktID = 25649, _pubBody = "!mj\ACK\181\179\t\252S\212\144\149\130\150X", _pubProps = []}
TEST(Publish311QCTest, Decode20) {
uint8_t pkt[] = {0x3b, 0x1f, 0x0, 0xc, 0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d, 0x64, 0x31, 0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d};
  lwmqtt_string_t exp_topic = {12, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
  lwmqtt_string_t exp_body = {15, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 25649);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 12);
EXPECT_EQ(msg.payload_len, 15);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 15);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "|\218", _pubPktID = 20394, _pubBody = "\153\SO\176", _pubProps = []}
TEST(Publish311QCTest, Encode21) {
uint8_t pkt[] = {0x3d, 0x9, 0x0, 0x2, 0x7c, 0xda, 0x4f, 0xaa, 0x99, 0xe, 0xb0};
  uint8_t topic_bytes[] = {0x7c, 0xda};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x99, 0xe, 0xb0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 20394, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "|\218", _pubPktID = 20394, _pubBody = "\153\SO\176", _pubProps = []}
TEST(Publish311QCTest, Decode21) {
uint8_t pkt[] = {0x3d, 0x9, 0x0, 0x2, 0x7c, 0xda, 0x4f, 0xaa, 0x99, 0xe, 0xb0};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7c, 0xda};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x99, 0xe, 0xb0};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 20394);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "<\t\"\209\184\182u\179\DLE\NAK\195\141\EM\237\189}\143\EOT\STX\188|\188\t\USv\US\209\"\STX", _pubPktID = 17374, _pubBody = "\"=\237\FS\247\238\129>oH\131~\158k\231\193}\194\ESCu", _pubProps = []}
TEST(Publish311QCTest, Encode22) {
uint8_t pkt[] = {0x3a, 0x35, 0x0, 0x1d, 0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2, 0x43, 0xde, 0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
  uint8_t topic_bytes[] = {0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2};
  lwmqtt_string_t topic = {29, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 20;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 17374, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "<\t\"\209\184\182u\179\DLE\NAK\195\141\EM\237\189}\143\EOT\STX\188|\188\t\USv\US\209\"\STX", _pubPktID = 17374, _pubBody = "\"=\237\FS\247\238\129>oH\131~\158k\231\193}\194\ESCu", _pubProps = []}
TEST(Publish311QCTest, Decode22) {
uint8_t pkt[] = {0x3a, 0x35, 0x0, 0x1d, 0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2, 0x43, 0xde, 0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2};
  lwmqtt_string_t exp_topic = {29, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
  lwmqtt_string_t exp_body = {20, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 17374);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 29);
EXPECT_EQ(msg.payload_len, 20);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 20);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "L\250\DC3", _pubPktID = 6223, _pubBody = ".K\236\242\210\250\192\219\175h\175p\249", _pubProps = []}
TEST(Publish311QCTest, Encode23) {
uint8_t pkt[] = {0x35, 0x14, 0x0, 0x3, 0x4c, 0xfa, 0x13, 0x18, 0x4f, 0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
  uint8_t topic_bytes[] = {0x4c, 0xfa, 0x13};
  lwmqtt_string_t topic = {3, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 6223, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "L\250\DC3", _pubPktID = 6223, _pubBody = ".K\236\242\210\250\192\219\175h\175p\249", _pubProps = []}
TEST(Publish311QCTest, Decode23) {
uint8_t pkt[] = {0x35, 0x14, 0x0, 0x3, 0x4c, 0xfa, 0x13, 0x18, 0x4f, 0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x4c, 0xfa, 0x13};
  lwmqtt_string_t exp_topic = {3, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 6223);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 3);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "^;.\197y\SO\163S\245~\178g\ETB", _pubPktID = 32148, _pubBody = "V\DC4\DC3 ZQ\164[\157n\197\162X\"*\220LH\RSF\206\255)Xpu!=", _pubProps = []}
TEST(Publish311QCTest, Encode24) {
uint8_t pkt[] = {0x34, 0x2d, 0x0, 0xd, 0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17, 0x7d, 0x94, 0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
  uint8_t topic_bytes[] = {0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17};
  lwmqtt_string_t topic = {13, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 28;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 32148, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "^;.\197y\SO\163S\245~\178g\ETB", _pubPktID = 32148, _pubBody = "V\DC4\DC3 ZQ\164[\157n\197\162X\"*\220LH\RSF\206\255)Xpu!=", _pubProps = []}
TEST(Publish311QCTest, Decode24) {
uint8_t pkt[] = {0x34, 0x2d, 0x0, 0xd, 0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17, 0x7d, 0x94, 0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17};
  lwmqtt_string_t exp_topic = {13, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
  lwmqtt_string_t exp_body = {28, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 32148);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 13);
EXPECT_EQ(msg.payload_len, 28);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 28);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "Vk\181\201\ETXZ\DC4\208\170\201\tDEB\153]Q\232", _pubPktID = 2981, _pubBody = "\\>V\153p|W\163\148\254\SYN@q\238?", _pubProps = []}
TEST(Publish311QCTest, Encode25) {
uint8_t pkt[] = {0x34, 0x25, 0x0, 0x12, 0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8, 0xb, 0xa5, 0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
  uint8_t topic_bytes[] = {0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 15;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 2981, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "Vk\181\201\ETXZ\DC4\208\170\201\tDEB\153]Q\232", _pubPktID = 2981, _pubBody = "\\>V\153p|W\163\148\254\SYN@q\238?", _pubProps = []}
TEST(Publish311QCTest, Decode25) {
uint8_t pkt[] = {0x34, 0x25, 0x0, 0x12, 0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8, 0xb, 0xa5, 0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8};
  lwmqtt_string_t exp_topic = {18, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
  lwmqtt_string_t exp_body = {15, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 2981);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 18);
EXPECT_EQ(msg.payload_len, 15);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 15);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "", _pubPktID = 12988, _pubBody = "\252Q\161\SUB\150\190\247\174s\151T8\149C\NAK9;)\159\188\140bs", _pubProps = []}
TEST(Publish311QCTest, Encode26) {
uint8_t pkt[] = {0x33, 0x1b, 0x0, 0x0, 0x32, 0xbc, 0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 23;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 12988, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "", _pubPktID = 12988, _pubBody = "\252Q\161\SUB\150\190\247\174s\151T8\149C\NAK9;)\159\188\140bs", _pubProps = []}
TEST(Publish311QCTest, Decode26) {
uint8_t pkt[] = {0x33, 0x1b, 0x0, 0x0, 0x32, 0xbc, 0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0};
  lwmqtt_string_t exp_topic = {0, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
  lwmqtt_string_t exp_body = {23, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 12988);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 0);
EXPECT_EQ(msg.payload_len, 23);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 23);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\a\206+\241_)~\225\174V\232:\184e", _pubPktID = 1045, _pubBody = "E\243x", _pubProps = []}
TEST(Publish311QCTest, Encode27) {
uint8_t pkt[] = {0x33, 0x15, 0x0, 0xe, 0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65, 0x4, 0x15, 0x45, 0xf3, 0x78};
  uint8_t topic_bytes[] = {0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65};
  lwmqtt_string_t topic = {14, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x45, 0xf3, 0x78};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 1045, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\a\206+\241_)~\225\174V\232:\184e", _pubPktID = 1045, _pubBody = "E\243x", _pubProps = []}
TEST(Publish311QCTest, Decode27) {
uint8_t pkt[] = {0x33, 0x15, 0x0, 0xe, 0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65, 0x4, 0x15, 0x45, 0xf3, 0x78};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65};
  lwmqtt_string_t exp_topic = {14, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x45, 0xf3, 0x78};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 1045);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 14);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\193`\187\247\203\252\193V\159\209\143}w\180\219\226\"\181nuE\nC\175-\SUB\141", _pubPktID = 0, _pubBody = "\213(\SUB\v\FS\224\252\152%p_*#w\218\204\240\237>\246", _pubProps = []}
TEST(Publish311QCTest, Encode28) {
uint8_t pkt[] = {0x30, 0x31, 0x0, 0x1b, 0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d, 0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
  uint8_t topic_bytes[] = {0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = false;
uint8_t msg_bytes[] = {0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 20;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\193`\187\247\203\252\193V\159\209\143}w\180\219\226\"\181nuE\nC\175-\SUB\141", _pubPktID = 0, _pubBody = "\213(\SUB\v\FS\224\252\152%p_*#w\218\204\240\237>\246", _pubProps = []}
TEST(Publish311QCTest, Decode28) {
uint8_t pkt[] = {0x30, 0x31, 0x0, 0x1b, 0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d, 0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d};
  lwmqtt_string_t exp_topic = {27, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
  lwmqtt_string_t exp_body = {20, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 27);
EXPECT_EQ(msg.payload_len, 20);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 20);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "}\180", _pubPktID = 11899, _pubBody = "\DC2\ACK%\181\DC3\164\204\173\204\223\DC2\161\&3uzk\152Xn\200\154d\154\143\245z\234", _pubProps = []}
TEST(Publish311QCTest, Encode29) {
uint8_t pkt[] = {0x34, 0x21, 0x0, 0x2, 0x7d, 0xb4, 0x2e, 0x7b, 0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
  uint8_t topic_bytes[] = {0x7d, 0xb4};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 27;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 11899, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "}\180", _pubPktID = 11899, _pubBody = "\DC2\ACK%\181\DC3\164\204\173\204\223\DC2\161\&3uzk\152Xn\200\154d\154\143\245z\234", _pubProps = []}
TEST(Publish311QCTest, Decode29) {
uint8_t pkt[] = {0x34, 0x21, 0x0, 0x2, 0x7d, 0xb4, 0x2e, 0x7b, 0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7d, 0xb4};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
  lwmqtt_string_t exp_body = {27, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 11899);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 27);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 27);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\150\tnz^#/~y\225", _pubPktID = 17773, _pubBody = "\130\\'n\215\&3\DC2\219\205\147\SOI\183c", _pubProps = []}
TEST(Publish311QCTest, Encode30) {
uint8_t pkt[] = {0x3b, 0x1c, 0x0, 0xa, 0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1, 0x45, 0x6d, 0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
  uint8_t topic_bytes[] = {0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1};
  lwmqtt_string_t topic = {10, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 14;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 17773, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\150\tnz^#/~y\225", _pubPktID = 17773, _pubBody = "\130\\'n\215\&3\DC2\219\205\147\SOI\183c", _pubProps = []}
TEST(Publish311QCTest, Decode30) {
uint8_t pkt[] = {0x3b, 0x1c, 0x0, 0xa, 0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1, 0x45, 0x6d, 0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT311, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1};
  lwmqtt_string_t exp_topic = {10, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
  lwmqtt_string_t exp_body = {14, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 17773);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 10);
EXPECT_EQ(msg.payload_len, 14);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 14);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = ";\135[\241\201\187\168\ETX\227\158\138\182\179\234\250\172\152\219\131\130!", _pubPktID = 24061, _pubBody = "\206\141\147\181o\253", _pubProps = [PropReceiveMaximum 21932,PropResponseInformation "c",PropMessageExpiryInterval 8939,PropAuthenticationData "y-+h",PropAssignedClientIdentifier "\RS\196RZ\231\&1Uh\149\146\237\168\NULH6\177F\246?\173\&4\137",PropAuthenticationData "m\227^\190\239\&1\240\232\EM\EM\128\149",PropServerKeepAlive 8119,PropResponseInformation "^\181\206\129aT\236\140",PropMaximumQoS 52,PropRequestResponseInformation 210,PropReceiveMaximum 8685,PropResponseInformation "\195\129\177\EM\STX~\194\n\207\204I\144@\226",PropMessageExpiryInterval 8052,PropReasonString "\215\213\194@e\ENQ\228\160\&6\143\GSC\ENQ\237Y?\208WL\130\250fRp\234",PropAuthenticationData "\233\DC4\217\246,\196\&4|\ESC'\236\232\150\152",PropMessageExpiryInterval 26546,PropWillDelayInterval 17713,PropSessionExpiryInterval 9284,PropContentType "\ACK@\193\237\DEL\251\ENQ\180yY\193",PropSharedSubscriptionAvailable 36,PropPayloadFormatIndicator 21,PropRequestResponseInformation 253,PropAuthenticationMethod "\DC4\179\189\165`\r\184HTgYh\211X\243;\134\151aY",PropSessionExpiryInterval 11426,PropUserProperty "HG\241{qJ\211\174\DC3\240\196\SO\133\EOT\ENQ\242u\129" "\164\216q\n\STX\STX\198\193D+\229\177",PropAuthenticationMethod "\130p\171\204s\CAN\234\&0\206:,\248\194\NAK}`\142!Yn\199$\224f\242&\135",PropAuthenticationData "\166\196`\240\&2\v\DEL\141\244\DC1*\200\218\202\215\210m\234\SOH\207[\166",PropReasonString "\150\SUB\183",PropTopicAlias 18572,PropMaximumPacketSize 6297]}
TEST(Publish5QCTest, Encode1) {
uint8_t pkt[] = {0x33, 0xdb, 0x2, 0x0, 0x15, 0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21, 0x5d, 0xfd, 0xba, 0x2, 0x21, 0x55, 0xac, 0x1a, 0x0, 0x1, 0x63, 0x2, 0x0, 0x0, 0x22, 0xeb, 0x16, 0x0, 0x4, 0x79, 0x2d, 0x2b, 0x68, 0x12, 0x0, 0x16, 0x1e, 0xc4, 0x52, 0x5a, 0xe7, 0x31, 0x55, 0x68, 0x95, 0x92, 0xed, 0xa8, 0x0, 0x48, 0x36, 0xb1, 0x46, 0xf6, 0x3f, 0xad, 0x34, 0x89, 0x16, 0x0, 0xc, 0x6d, 0xe3, 0x5e, 0xbe, 0xef, 0x31, 0xf0, 0xe8, 0x19, 0x19, 0x80, 0x95, 0x13, 0x1f, 0xb7, 0x1a, 0x0, 0x8, 0x5e, 0xb5, 0xce, 0x81, 0x61, 0x54, 0xec, 0x8c, 0x24, 0x34, 0x19, 0xd2, 0x21, 0x21, 0xed, 0x1a, 0x0, 0xe, 0xc3, 0x81, 0xb1, 0x19, 0x2, 0x7e, 0xc2, 0xa, 0xcf, 0xcc, 0x49, 0x90, 0x40, 0xe2, 0x2, 0x0, 0x0, 0x1f, 0x74, 0x1f, 0x0, 0x19, 0xd7, 0xd5, 0xc2, 0x40, 0x65, 0x5, 0xe4, 0xa0, 0x36, 0x8f, 0x1d, 0x43, 0x5, 0xed, 0x59, 0x3f, 0xd0, 0x57, 0x4c, 0x82, 0xfa, 0x66, 0x52, 0x70, 0xea, 0x16, 0x0, 0xe, 0xe9, 0x14, 0xd9, 0xf6, 0x2c, 0xc4, 0x34, 0x7c, 0x1b, 0x27, 0xec, 0xe8, 0x96, 0x98, 0x2, 0x0, 0x0, 0x67, 0xb2, 0x18, 0x0, 0x0, 0x45, 0x31, 0x11, 0x0, 0x0, 0x24, 0x44, 0x3, 0x0, 0xb, 0x6, 0x40, 0xc1, 0xed, 0x7f, 0xfb, 0x5, 0xb4, 0x79, 0x59, 0xc1, 0x2a, 0x24, 0x1, 0x15, 0x19, 0xfd, 0x15, 0x0, 0x14, 0x14, 0xb3, 0xbd, 0xa5, 0x60, 0xd, 0xb8, 0x48, 0x54, 0x67, 0x59, 0x68, 0xd3, 0x58, 0xf3, 0x3b, 0x86, 0x97, 0x61, 0x59, 0x11, 0x0, 0x0, 0x2c, 0xa2, 0x26, 0x0, 0x12, 0x48, 0x47, 0xf1, 0x7b, 0x71, 0x4a, 0xd3, 0xae, 0x13, 0xf0, 0xc4, 0xe, 0x85, 0x4, 0x5, 0xf2, 0x75, 0x81, 0x0, 0xc, 0xa4, 0xd8, 0x71, 0xa, 0x2, 0x2, 0xc6, 0xc1, 0x44, 0x2b, 0xe5, 0xb1, 0x15, 0x0, 0x1b, 0x82, 0x70, 0xab, 0xcc, 0x73, 0x18, 0xea, 0x30, 0xce, 0x3a, 0x2c, 0xf8, 0xc2, 0x15, 0x7d, 0x60, 0x8e, 0x21, 0x59, 0x6e, 0xc7, 0x24, 0xe0, 0x66, 0xf2, 0x26, 0x87, 0x16, 0x0, 0x16, 0xa6, 0xc4, 0x60, 0xf0, 0x32, 0xb, 0x7f, 0x8d, 0xf4, 0x11, 0x2a, 0xc8, 0xda, 0xca, 0xd7, 0xd2, 0x6d, 0xea, 0x1, 0xcf, 0x5b, 0xa6, 0x1f, 0x0, 0x3, 0x96, 0x1a, 0xb7, 0x23, 0x48, 0x8c, 0x27, 0x0, 0x0, 0x18, 0x99, 0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
  uint8_t topic_bytes[] = {0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21};
  lwmqtt_string_t topic = {21, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 6;

  uint8_t bytesprops0[] = {0x63};
  uint8_t bytesprops1[] = {0x79, 0x2d, 0x2b, 0x68};
  uint8_t bytesprops2[] = {0x1e, 0xc4, 0x52, 0x5a, 0xe7, 0x31, 0x55, 0x68, 0x95, 0x92, 0xed, 0xa8, 0x0, 0x48, 0x36, 0xb1, 0x46, 0xf6, 0x3f, 0xad, 0x34, 0x89};
  uint8_t bytesprops3[] = {0x6d, 0xe3, 0x5e, 0xbe, 0xef, 0x31, 0xf0, 0xe8, 0x19, 0x19, 0x80, 0x95};
  uint8_t bytesprops4[] = {0x5e, 0xb5, 0xce, 0x81, 0x61, 0x54, 0xec, 0x8c};
  uint8_t bytesprops5[] = {0xc3, 0x81, 0xb1, 0x19, 0x2, 0x7e, 0xc2, 0xa, 0xcf, 0xcc, 0x49, 0x90, 0x40, 0xe2};
  uint8_t bytesprops6[] = {0xd7, 0xd5, 0xc2, 0x40, 0x65, 0x5, 0xe4, 0xa0, 0x36, 0x8f, 0x1d, 0x43, 0x5, 0xed, 0x59, 0x3f, 0xd0, 0x57, 0x4c, 0x82, 0xfa, 0x66, 0x52, 0x70, 0xea};
  uint8_t bytesprops7[] = {0xe9, 0x14, 0xd9, 0xf6, 0x2c, 0xc4, 0x34, 0x7c, 0x1b, 0x27, 0xec, 0xe8, 0x96, 0x98};
  uint8_t bytesprops8[] = {0x6, 0x40, 0xc1, 0xed, 0x7f, 0xfb, 0x5, 0xb4, 0x79, 0x59, 0xc1};
  uint8_t bytesprops9[] = {0x14, 0xb3, 0xbd, 0xa5, 0x60, 0xd, 0xb8, 0x48, 0x54, 0x67, 0x59, 0x68, 0xd3, 0x58, 0xf3, 0x3b, 0x86, 0x97, 0x61, 0x59};
  uint8_t bytesprops11[] = {0xa4, 0xd8, 0x71, 0xa, 0x2, 0x2, 0xc6, 0xc1, 0x44, 0x2b, 0xe5, 0xb1};
  uint8_t bytesprops10[] = {0x48, 0x47, 0xf1, 0x7b, 0x71, 0x4a, 0xd3, 0xae, 0x13, 0xf0, 0xc4, 0xe, 0x85, 0x4, 0x5, 0xf2, 0x75, 0x81};
  uint8_t bytesprops12[] = {0x82, 0x70, 0xab, 0xcc, 0x73, 0x18, 0xea, 0x30, 0xce, 0x3a, 0x2c, 0xf8, 0xc2, 0x15, 0x7d, 0x60, 0x8e, 0x21, 0x59, 0x6e, 0xc7, 0x24, 0xe0, 0x66, 0xf2, 0x26, 0x87};
  uint8_t bytesprops13[] = {0xa6, 0xc4, 0x60, 0xf0, 0x32, 0xb, 0x7f, 0x8d, 0xf4, 0x11, 0x2a, 0xc8, 0xda, 0xca, 0xd7, 0xd2, 0x6d, 0xea, 0x1, 0xcf, 0x5b, 0xa6};
  uint8_t bytesprops14[] = {0x96, 0x1a, 0xb7};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 21932}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8939}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {4, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 8119}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {8, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 52}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 8685}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8052}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {25, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {14, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 26546}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17713}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9284}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 21}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 253}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11426}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={18, (char*)&bytesprops10}, .v={12, (char*)&bytesprops11}}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {27, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops13}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops14}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18572}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 6297}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 24061, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = ";\135[\241\201\187\168\ETX\227\158\138\182\179\234\250\172\152\219\131\130!", _pubPktID = 24061, _pubBody = "\206\141\147\181o\253", _pubProps = [PropReceiveMaximum 21932,PropResponseInformation "c",PropMessageExpiryInterval 8939,PropAuthenticationData "y-+h",PropAssignedClientIdentifier "\RS\196RZ\231\&1Uh\149\146\237\168\NULH6\177F\246?\173\&4\137",PropAuthenticationData "m\227^\190\239\&1\240\232\EM\EM\128\149",PropServerKeepAlive 8119,PropResponseInformation "^\181\206\129aT\236\140",PropMaximumQoS 52,PropRequestResponseInformation 210,PropReceiveMaximum 8685,PropResponseInformation "\195\129\177\EM\STX~\194\n\207\204I\144@\226",PropMessageExpiryInterval 8052,PropReasonString "\215\213\194@e\ENQ\228\160\&6\143\GSC\ENQ\237Y?\208WL\130\250fRp\234",PropAuthenticationData "\233\DC4\217\246,\196\&4|\ESC'\236\232\150\152",PropMessageExpiryInterval 26546,PropWillDelayInterval 17713,PropSessionExpiryInterval 9284,PropContentType "\ACK@\193\237\DEL\251\ENQ\180yY\193",PropSharedSubscriptionAvailable 36,PropPayloadFormatIndicator 21,PropRequestResponseInformation 253,PropAuthenticationMethod "\DC4\179\189\165`\r\184HTgYh\211X\243;\134\151aY",PropSessionExpiryInterval 11426,PropUserProperty "HG\241{qJ\211\174\DC3\240\196\SO\133\EOT\ENQ\242u\129" "\164\216q\n\STX\STX\198\193D+\229\177",PropAuthenticationMethod "\130p\171\204s\CAN\234\&0\206:,\248\194\NAK}`\142!Yn\199$\224f\242&\135",PropAuthenticationData "\166\196`\240\&2\v\DEL\141\244\DC1*\200\218\202\215\210m\234\SOH\207[\166",PropReasonString "\150\SUB\183",PropTopicAlias 18572,PropMaximumPacketSize 6297]}
TEST(Publish5QCTest, Decode1) {
uint8_t pkt[] = {0x33, 0xdb, 0x2, 0x0, 0x15, 0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21, 0x5d, 0xfd, 0xba, 0x2, 0x21, 0x55, 0xac, 0x1a, 0x0, 0x1, 0x63, 0x2, 0x0, 0x0, 0x22, 0xeb, 0x16, 0x0, 0x4, 0x79, 0x2d, 0x2b, 0x68, 0x12, 0x0, 0x16, 0x1e, 0xc4, 0x52, 0x5a, 0xe7, 0x31, 0x55, 0x68, 0x95, 0x92, 0xed, 0xa8, 0x0, 0x48, 0x36, 0xb1, 0x46, 0xf6, 0x3f, 0xad, 0x34, 0x89, 0x16, 0x0, 0xc, 0x6d, 0xe3, 0x5e, 0xbe, 0xef, 0x31, 0xf0, 0xe8, 0x19, 0x19, 0x80, 0x95, 0x13, 0x1f, 0xb7, 0x1a, 0x0, 0x8, 0x5e, 0xb5, 0xce, 0x81, 0x61, 0x54, 0xec, 0x8c, 0x24, 0x34, 0x19, 0xd2, 0x21, 0x21, 0xed, 0x1a, 0x0, 0xe, 0xc3, 0x81, 0xb1, 0x19, 0x2, 0x7e, 0xc2, 0xa, 0xcf, 0xcc, 0x49, 0x90, 0x40, 0xe2, 0x2, 0x0, 0x0, 0x1f, 0x74, 0x1f, 0x0, 0x19, 0xd7, 0xd5, 0xc2, 0x40, 0x65, 0x5, 0xe4, 0xa0, 0x36, 0x8f, 0x1d, 0x43, 0x5, 0xed, 0x59, 0x3f, 0xd0, 0x57, 0x4c, 0x82, 0xfa, 0x66, 0x52, 0x70, 0xea, 0x16, 0x0, 0xe, 0xe9, 0x14, 0xd9, 0xf6, 0x2c, 0xc4, 0x34, 0x7c, 0x1b, 0x27, 0xec, 0xe8, 0x96, 0x98, 0x2, 0x0, 0x0, 0x67, 0xb2, 0x18, 0x0, 0x0, 0x45, 0x31, 0x11, 0x0, 0x0, 0x24, 0x44, 0x3, 0x0, 0xb, 0x6, 0x40, 0xc1, 0xed, 0x7f, 0xfb, 0x5, 0xb4, 0x79, 0x59, 0xc1, 0x2a, 0x24, 0x1, 0x15, 0x19, 0xfd, 0x15, 0x0, 0x14, 0x14, 0xb3, 0xbd, 0xa5, 0x60, 0xd, 0xb8, 0x48, 0x54, 0x67, 0x59, 0x68, 0xd3, 0x58, 0xf3, 0x3b, 0x86, 0x97, 0x61, 0x59, 0x11, 0x0, 0x0, 0x2c, 0xa2, 0x26, 0x0, 0x12, 0x48, 0x47, 0xf1, 0x7b, 0x71, 0x4a, 0xd3, 0xae, 0x13, 0xf0, 0xc4, 0xe, 0x85, 0x4, 0x5, 0xf2, 0x75, 0x81, 0x0, 0xc, 0xa4, 0xd8, 0x71, 0xa, 0x2, 0x2, 0xc6, 0xc1, 0x44, 0x2b, 0xe5, 0xb1, 0x15, 0x0, 0x1b, 0x82, 0x70, 0xab, 0xcc, 0x73, 0x18, 0xea, 0x30, 0xce, 0x3a, 0x2c, 0xf8, 0xc2, 0x15, 0x7d, 0x60, 0x8e, 0x21, 0x59, 0x6e, 0xc7, 0x24, 0xe0, 0x66, 0xf2, 0x26, 0x87, 0x16, 0x0, 0x16, 0xa6, 0xc4, 0x60, 0xf0, 0x32, 0xb, 0x7f, 0x8d, 0xf4, 0x11, 0x2a, 0xc8, 0xda, 0xca, 0xd7, 0xd2, 0x6d, 0xea, 0x1, 0xcf, 0x5b, 0xa6, 0x1f, 0x0, 0x3, 0x96, 0x1a, 0xb7, 0x23, 0x48, 0x8c, 0x27, 0x0, 0x0, 0x18, 0x99, 0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x3b, 0x87, 0x5b, 0xf1, 0xc9, 0xbb, 0xa8, 0x3, 0xe3, 0x9e, 0x8a, 0xb6, 0xb3, 0xea, 0xfa, 0xac, 0x98, 0xdb, 0x83, 0x82, 0x21};
  lwmqtt_string_t exp_topic = {21, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xce, 0x8d, 0x93, 0xb5, 0x6f, 0xfd};
  lwmqtt_string_t exp_body = {6, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 24061);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 21);
EXPECT_EQ(msg.payload_len, 6);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 6);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\148\US\b\177\214\241A\128\215\138NRR\141\t\208\DC4\231\253\232\EM\205\r\162\157", _pubPktID = 0, _pubBody = "\DELQr", _pubProps = [PropCorrelationData "\189\129\175z\140\ETB\132",PropMessageExpiryInterval 31306,PropWildcardSubscriptionAvailable 199,PropContentType "\193B\DC3\184\200_",PropAssignedClientIdentifier "\200\131do}\205_\217~Z\149;\v\204\128",PropServerReference "\ENQ\135\165\f\196R\139>\214\231\DEL\208|\DC3\223H\152E\164",PropRequestProblemInformation 243,PropMaximumPacketSize 18984,PropTopicAlias 8169,PropRequestProblemInformation 2,PropMaximumQoS 70,PropWillDelayInterval 18634]}
TEST(Publish5QCTest, Encode2) {
uint8_t pkt[] = {0x31, 0x74, 0x0, 0x19, 0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d, 0x55, 0x9, 0x0, 0x7, 0xbd, 0x81, 0xaf, 0x7a, 0x8c, 0x17, 0x84, 0x2, 0x0, 0x0, 0x7a, 0x4a, 0x28, 0xc7, 0x3, 0x0, 0x6, 0xc1, 0x42, 0x13, 0xb8, 0xc8, 0x5f, 0x12, 0x0, 0xf, 0xc8, 0x83, 0x64, 0x6f, 0x7d, 0xcd, 0x5f, 0xd9, 0x7e, 0x5a, 0x95, 0x3b, 0xb, 0xcc, 0x80, 0x1c, 0x0, 0x13, 0x5, 0x87, 0xa5, 0xc, 0xc4, 0x52, 0x8b, 0x3e, 0xd6, 0xe7, 0x7f, 0xd0, 0x7c, 0x13, 0xdf, 0x48, 0x98, 0x45, 0xa4, 0x17, 0xf3, 0x27, 0x0, 0x0, 0x4a, 0x28, 0x23, 0x1f, 0xe9, 0x17, 0x2, 0x24, 0x46, 0x18, 0x0, 0x0, 0x48, 0xca, 0x7f, 0x51, 0x72};
  uint8_t topic_bytes[] = {0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d};
  lwmqtt_string_t topic = {25, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x7f, 0x51, 0x72};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  uint8_t bytesprops0[] = {0xbd, 0x81, 0xaf, 0x7a, 0x8c, 0x17, 0x84};
  uint8_t bytesprops1[] = {0xc1, 0x42, 0x13, 0xb8, 0xc8, 0x5f};
  uint8_t bytesprops2[] = {0xc8, 0x83, 0x64, 0x6f, 0x7d, 0xcd, 0x5f, 0xd9, 0x7e, 0x5a, 0x95, 0x3b, 0xb, 0xcc, 0x80};
  uint8_t bytesprops3[] = {0x5, 0x87, 0xa5, 0xc, 0xc4, 0x52, 0x8b, 0x3e, 0xd6, 0xe7, 0x7f, 0xd0, 0x7c, 0x13, 0xdf, 0x48, 0x98, 0x45, 0xa4};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31306}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 199}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 243}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18984}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 8169}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 2}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 70}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18634}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\148\US\b\177\214\241A\128\215\138NRR\141\t\208\DC4\231\253\232\EM\205\r\162\157", _pubPktID = 0, _pubBody = "\DELQr", _pubProps = [PropCorrelationData "\189\129\175z\140\ETB\132",PropMessageExpiryInterval 31306,PropWildcardSubscriptionAvailable 199,PropContentType "\193B\DC3\184\200_",PropAssignedClientIdentifier "\200\131do}\205_\217~Z\149;\v\204\128",PropServerReference "\ENQ\135\165\f\196R\139>\214\231\DEL\208|\DC3\223H\152E\164",PropRequestProblemInformation 243,PropMaximumPacketSize 18984,PropTopicAlias 8169,PropRequestProblemInformation 2,PropMaximumQoS 70,PropWillDelayInterval 18634]}
TEST(Publish5QCTest, Decode2) {
uint8_t pkt[] = {0x31, 0x74, 0x0, 0x19, 0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d, 0x55, 0x9, 0x0, 0x7, 0xbd, 0x81, 0xaf, 0x7a, 0x8c, 0x17, 0x84, 0x2, 0x0, 0x0, 0x7a, 0x4a, 0x28, 0xc7, 0x3, 0x0, 0x6, 0xc1, 0x42, 0x13, 0xb8, 0xc8, 0x5f, 0x12, 0x0, 0xf, 0xc8, 0x83, 0x64, 0x6f, 0x7d, 0xcd, 0x5f, 0xd9, 0x7e, 0x5a, 0x95, 0x3b, 0xb, 0xcc, 0x80, 0x1c, 0x0, 0x13, 0x5, 0x87, 0xa5, 0xc, 0xc4, 0x52, 0x8b, 0x3e, 0xd6, 0xe7, 0x7f, 0xd0, 0x7c, 0x13, 0xdf, 0x48, 0x98, 0x45, 0xa4, 0x17, 0xf3, 0x27, 0x0, 0x0, 0x4a, 0x28, 0x23, 0x1f, 0xe9, 0x17, 0x2, 0x24, 0x46, 0x18, 0x0, 0x0, 0x48, 0xca, 0x7f, 0x51, 0x72};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x94, 0x1f, 0x8, 0xb1, 0xd6, 0xf1, 0x41, 0x80, 0xd7, 0x8a, 0x4e, 0x52, 0x52, 0x8d, 0x9, 0xd0, 0x14, 0xe7, 0xfd, 0xe8, 0x19, 0xcd, 0xd, 0xa2, 0x9d};
  lwmqtt_string_t exp_topic = {25, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7f, 0x51, 0x72};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 25);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\CANO\164\EM\236\160:x\bB\170\222ObK\201\DC1\168W}>\187\DC1", _pubPktID = 0, _pubBody = "", _pubProps = [PropServerKeepAlive 2018]}
TEST(Publish5QCTest, Encode3) {
uint8_t pkt[] = {0x38, 0x1d, 0x0, 0x17, 0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11, 0x3, 0x13, 0x7, 0xe2};
  uint8_t topic_bytes[] = {0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
  lwmqtt_string_t topic = {23, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = false;
uint8_t msg_bytes[] = {0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 0;

  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2018}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\CANO\164\EM\236\160:x\bB\170\222ObK\201\DC1\168W}>\187\DC1", _pubPktID = 0, _pubBody = "", _pubProps = [PropServerKeepAlive 2018]}
TEST(Publish5QCTest, Decode3) {
uint8_t pkt[] = {0x38, 0x1d, 0x0, 0x17, 0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11, 0x3, 0x13, 0x7, 0xe2};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x18, 0x4f, 0xa4, 0x19, 0xec, 0xa0, 0x3a, 0x78, 0x8, 0x42, 0xaa, 0xde, 0x4f, 0x62, 0x4b, 0xc9, 0x11, 0xa8, 0x57, 0x7d, 0x3e, 0xbb, 0x11};
  lwmqtt_string_t exp_topic = {23, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0};
  lwmqtt_string_t exp_body = {0, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 23);
EXPECT_EQ(msg.payload_len, 0);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 0);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "]\151\151\159oP\170", _pubPktID = 14052, _pubBody = "\254\174c\158\219\&7\163j\130\179TW\155\250\141\164c", _pubProps = [PropResponseTopic "\218\139\158d\216\160\SUB\156h\198\176Jr\158\139\&0\196\194h\251\SOH\EOT\233Z\239\219\146",PropSessionExpiryInterval 3572,PropSubscriptionIdentifier 18,PropCorrelationData "4w\174@n\DC1\156\DC1(\CAN\240\164>/\140\&3~n#\175X\CAN\199\221\&4j\159Kf*",PropServerKeepAlive 5008,PropUserProperty "S\DC3[\235\174\129 pA\216\163\&2.\238\ETB>k\243" "\204\189\195iQ\144\132\211\217r\247\NUL\131\244t8\229@\196\244\174}X",PropTopicAlias 974,PropContentType "sQ",PropRequestResponseInformation 85,PropContentType "\t\175\244\144\207\SOH\181",PropSessionExpiryInterval 6517,PropSessionExpiryInterval 8268,PropSessionExpiryInterval 11191,PropSubscriptionIdentifierAvailable 225,PropMaximumPacketSize 26160,PropMaximumPacketSize 24248,PropSubscriptionIdentifierAvailable 187,PropCorrelationData "+\RS:!7\187\222\134`]\210\250\ACK\223W\130H\140\194$\255d\145\237\189\154N\SUB\152\221",PropWillDelayInterval 13076,PropSessionExpiryInterval 17784,PropTopicAliasMaximum 28192,PropReceiveMaximum 30677,PropSharedSubscriptionAvailable 104,PropMessageExpiryInterval 5065,PropRequestProblemInformation 113,PropRequestResponseInformation 239,PropMessageExpiryInterval 11285]}
TEST(Publish5QCTest, Encode4) {
uint8_t pkt[] = {0x3b, 0x87, 0x2, 0x0, 0x7, 0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa, 0x36, 0xe4, 0xe9, 0x1, 0x8, 0x0, 0x1b, 0xda, 0x8b, 0x9e, 0x64, 0xd8, 0xa0, 0x1a, 0x9c, 0x68, 0xc6, 0xb0, 0x4a, 0x72, 0x9e, 0x8b, 0x30, 0xc4, 0xc2, 0x68, 0xfb, 0x1, 0x4, 0xe9, 0x5a, 0xef, 0xdb, 0x92, 0x11, 0x0, 0x0, 0xd, 0xf4, 0xb, 0x12, 0x9, 0x0, 0x1e, 0x34, 0x77, 0xae, 0x40, 0x6e, 0x11, 0x9c, 0x11, 0x28, 0x18, 0xf0, 0xa4, 0x3e, 0x2f, 0x8c, 0x33, 0x7e, 0x6e, 0x23, 0xaf, 0x58, 0x18, 0xc7, 0xdd, 0x34, 0x6a, 0x9f, 0x4b, 0x66, 0x2a, 0x13, 0x13, 0x90, 0x26, 0x0, 0x12, 0x53, 0x13, 0x5b, 0xeb, 0xae, 0x81, 0x20, 0x70, 0x41, 0xd8, 0xa3, 0x32, 0x2e, 0xee, 0x17, 0x3e, 0x6b, 0xf3, 0x0, 0x17, 0xcc, 0xbd, 0xc3, 0x69, 0x51, 0x90, 0x84, 0xd3, 0xd9, 0x72, 0xf7, 0x0, 0x83, 0xf4, 0x74, 0x38, 0xe5, 0x40, 0xc4, 0xf4, 0xae, 0x7d, 0x58, 0x23, 0x3, 0xce, 0x3, 0x0, 0x2, 0x73, 0x51, 0x19, 0x55, 0x3, 0x0, 0x7, 0x9, 0xaf, 0xf4, 0x90, 0xcf, 0x1, 0xb5, 0x11, 0x0, 0x0, 0x19, 0x75, 0x11, 0x0, 0x0, 0x20, 0x4c, 0x11, 0x0, 0x0, 0x2b, 0xb7, 0x29, 0xe1, 0x27, 0x0, 0x0, 0x66, 0x30, 0x27, 0x0, 0x0, 0x5e, 0xb8, 0x29, 0xbb, 0x9, 0x0, 0x1e, 0x2b, 0x1e, 0x3a, 0x21, 0x37, 0xbb, 0xde, 0x86, 0x60, 0x5d, 0xd2, 0xfa, 0x6, 0xdf, 0x57, 0x82, 0x48, 0x8c, 0xc2, 0x24, 0xff, 0x64, 0x91, 0xed, 0xbd, 0x9a, 0x4e, 0x1a, 0x98, 0xdd, 0x18, 0x0, 0x0, 0x33, 0x14, 0x11, 0x0, 0x0, 0x45, 0x78, 0x22, 0x6e, 0x20, 0x21, 0x77, 0xd5, 0x2a, 0x68, 0x2, 0x0, 0x0, 0x13, 0xc9, 0x17, 0x71, 0x19, 0xef, 0x2, 0x0, 0x0, 0x2c, 0x15, 0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
  uint8_t topic_bytes[] = {0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa};
  lwmqtt_string_t topic = {7, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 17;

  uint8_t bytesprops0[] = {0xda, 0x8b, 0x9e, 0x64, 0xd8, 0xa0, 0x1a, 0x9c, 0x68, 0xc6, 0xb0, 0x4a, 0x72, 0x9e, 0x8b, 0x30, 0xc4, 0xc2, 0x68, 0xfb, 0x1, 0x4, 0xe9, 0x5a, 0xef, 0xdb, 0x92};
  uint8_t bytesprops1[] = {0x34, 0x77, 0xae, 0x40, 0x6e, 0x11, 0x9c, 0x11, 0x28, 0x18, 0xf0, 0xa4, 0x3e, 0x2f, 0x8c, 0x33, 0x7e, 0x6e, 0x23, 0xaf, 0x58, 0x18, 0xc7, 0xdd, 0x34, 0x6a, 0x9f, 0x4b, 0x66, 0x2a};
  uint8_t bytesprops3[] = {0xcc, 0xbd, 0xc3, 0x69, 0x51, 0x90, 0x84, 0xd3, 0xd9, 0x72, 0xf7, 0x0, 0x83, 0xf4, 0x74, 0x38, 0xe5, 0x40, 0xc4, 0xf4, 0xae, 0x7d, 0x58};
  uint8_t bytesprops2[] = {0x53, 0x13, 0x5b, 0xeb, 0xae, 0x81, 0x20, 0x70, 0x41, 0xd8, 0xa3, 0x32, 0x2e, 0xee, 0x17, 0x3e, 0x6b, 0xf3};
  uint8_t bytesprops4[] = {0x73, 0x51};
  uint8_t bytesprops5[] = {0x9, 0xaf, 0xf4, 0x90, 0xcf, 0x1, 0xb5};
  uint8_t bytesprops6[] = {0x2b, 0x1e, 0x3a, 0x21, 0x37, 0xbb, 0xde, 0x86, 0x60, 0x5d, 0xd2, 0xfa, 0x6, 0xdf, 0x57, 0x82, 0x48, 0x8c, 0xc2, 0x24, 0xff, 0x64, 0x91, 0xed, 0xbd, 0x9a, 0x4e, 0x1a, 0x98, 0xdd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 3572}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 18}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 5008}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={18, (char*)&bytesprops2}, .v={23, (char*)&bytesprops3}}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 974}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {7, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 6517}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 8268}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11191}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 225}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 26160}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 24248}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 187}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 13076}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 17784}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28192}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30677}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5065}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 113}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 239}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11285}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 14052, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "]\151\151\159oP\170", _pubPktID = 14052, _pubBody = "\254\174c\158\219\&7\163j\130\179TW\155\250\141\164c", _pubProps = [PropResponseTopic "\218\139\158d\216\160\SUB\156h\198\176Jr\158\139\&0\196\194h\251\SOH\EOT\233Z\239\219\146",PropSessionExpiryInterval 3572,PropSubscriptionIdentifier 18,PropCorrelationData "4w\174@n\DC1\156\DC1(\CAN\240\164>/\140\&3~n#\175X\CAN\199\221\&4j\159Kf*",PropServerKeepAlive 5008,PropUserProperty "S\DC3[\235\174\129 pA\216\163\&2.\238\ETB>k\243" "\204\189\195iQ\144\132\211\217r\247\NUL\131\244t8\229@\196\244\174}X",PropTopicAlias 974,PropContentType "sQ",PropRequestResponseInformation 85,PropContentType "\t\175\244\144\207\SOH\181",PropSessionExpiryInterval 6517,PropSessionExpiryInterval 8268,PropSessionExpiryInterval 11191,PropSubscriptionIdentifierAvailable 225,PropMaximumPacketSize 26160,PropMaximumPacketSize 24248,PropSubscriptionIdentifierAvailable 187,PropCorrelationData "+\RS:!7\187\222\134`]\210\250\ACK\223W\130H\140\194$\255d\145\237\189\154N\SUB\152\221",PropWillDelayInterval 13076,PropSessionExpiryInterval 17784,PropTopicAliasMaximum 28192,PropReceiveMaximum 30677,PropSharedSubscriptionAvailable 104,PropMessageExpiryInterval 5065,PropRequestProblemInformation 113,PropRequestResponseInformation 239,PropMessageExpiryInterval 11285]}
TEST(Publish5QCTest, Decode4) {
uint8_t pkt[] = {0x3b, 0x87, 0x2, 0x0, 0x7, 0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa, 0x36, 0xe4, 0xe9, 0x1, 0x8, 0x0, 0x1b, 0xda, 0x8b, 0x9e, 0x64, 0xd8, 0xa0, 0x1a, 0x9c, 0x68, 0xc6, 0xb0, 0x4a, 0x72, 0x9e, 0x8b, 0x30, 0xc4, 0xc2, 0x68, 0xfb, 0x1, 0x4, 0xe9, 0x5a, 0xef, 0xdb, 0x92, 0x11, 0x0, 0x0, 0xd, 0xf4, 0xb, 0x12, 0x9, 0x0, 0x1e, 0x34, 0x77, 0xae, 0x40, 0x6e, 0x11, 0x9c, 0x11, 0x28, 0x18, 0xf0, 0xa4, 0x3e, 0x2f, 0x8c, 0x33, 0x7e, 0x6e, 0x23, 0xaf, 0x58, 0x18, 0xc7, 0xdd, 0x34, 0x6a, 0x9f, 0x4b, 0x66, 0x2a, 0x13, 0x13, 0x90, 0x26, 0x0, 0x12, 0x53, 0x13, 0x5b, 0xeb, 0xae, 0x81, 0x20, 0x70, 0x41, 0xd8, 0xa3, 0x32, 0x2e, 0xee, 0x17, 0x3e, 0x6b, 0xf3, 0x0, 0x17, 0xcc, 0xbd, 0xc3, 0x69, 0x51, 0x90, 0x84, 0xd3, 0xd9, 0x72, 0xf7, 0x0, 0x83, 0xf4, 0x74, 0x38, 0xe5, 0x40, 0xc4, 0xf4, 0xae, 0x7d, 0x58, 0x23, 0x3, 0xce, 0x3, 0x0, 0x2, 0x73, 0x51, 0x19, 0x55, 0x3, 0x0, 0x7, 0x9, 0xaf, 0xf4, 0x90, 0xcf, 0x1, 0xb5, 0x11, 0x0, 0x0, 0x19, 0x75, 0x11, 0x0, 0x0, 0x20, 0x4c, 0x11, 0x0, 0x0, 0x2b, 0xb7, 0x29, 0xe1, 0x27, 0x0, 0x0, 0x66, 0x30, 0x27, 0x0, 0x0, 0x5e, 0xb8, 0x29, 0xbb, 0x9, 0x0, 0x1e, 0x2b, 0x1e, 0x3a, 0x21, 0x37, 0xbb, 0xde, 0x86, 0x60, 0x5d, 0xd2, 0xfa, 0x6, 0xdf, 0x57, 0x82, 0x48, 0x8c, 0xc2, 0x24, 0xff, 0x64, 0x91, 0xed, 0xbd, 0x9a, 0x4e, 0x1a, 0x98, 0xdd, 0x18, 0x0, 0x0, 0x33, 0x14, 0x11, 0x0, 0x0, 0x45, 0x78, 0x22, 0x6e, 0x20, 0x21, 0x77, 0xd5, 0x2a, 0x68, 0x2, 0x0, 0x0, 0x13, 0xc9, 0x17, 0x71, 0x19, 0xef, 0x2, 0x0, 0x0, 0x2c, 0x15, 0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x5d, 0x97, 0x97, 0x9f, 0x6f, 0x50, 0xaa};
  lwmqtt_string_t exp_topic = {7, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xfe, 0xae, 0x63, 0x9e, 0xdb, 0x37, 0xa3, 0x6a, 0x82, 0xb3, 0x54, 0x57, 0x9b, 0xfa, 0x8d, 0xa4, 0x63};
  lwmqtt_string_t exp_body = {17, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 14052);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 7);
EXPECT_EQ(msg.payload_len, 17);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 17);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "F\129\169\SYN\215A[Qx}\223\&7NE\181\250\249\236\208\GSL\217\176\183\235\&0\189\247u_", _pubPktID = 26784, _pubBody = "\176\&0\158\138\138]\220(B\154\&3\224jV\159v+\130", _pubProps = [PropServerReference "\171\NUL\255\181W#c)\213_\233\156l\214e7\223\159\SYN\138\186Na\129\231\200\222\187\SI",PropResponseInformation "9\247>''\242\222\229\ACK#n\DC4!\\\253\&4pA\238\158\195",PropCorrelationData "v\US\177M\242\DC2\171\229\194h\194\147\236KT\147",PropWildcardSubscriptionAvailable 249,PropAuthenticationMethod "\ACK\168\&7$\DEL\194wS\162",PropTopicAliasMaximum 28784,PropTopicAliasMaximum 19013,PropServerKeepAlive 3972,PropPayloadFormatIndicator 111,PropTopicAlias 4635,PropWillDelayInterval 6106,PropResponseTopic "!\248",PropSubscriptionIdentifier 16,PropResponseTopic "c4Pne\208y\197\194",PropContentType "3A\148\175\r",PropTopicAliasMaximum 8280,PropRequestResponseInformation 163,PropMaximumPacketSize 10851,PropReceiveMaximum 29504,PropMaximumPacketSize 24457,PropServerReference "/\164X\232R9B\249\173Y\ACK\144\ACK%\138a\STX\ETX\190}\250WU\169\164\183",PropServerKeepAlive 15970,PropAuthenticationMethod ";J6"]}
TEST(Publish5QCTest, Encode5) {
uint8_t pkt[] = {0x3d, 0xf5, 0x1, 0x0, 0x1e, 0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f, 0x68, 0xa0, 0xbf, 0x1, 0x1c, 0x0, 0x1d, 0xab, 0x0, 0xff, 0xb5, 0x57, 0x23, 0x63, 0x29, 0xd5, 0x5f, 0xe9, 0x9c, 0x6c, 0xd6, 0x65, 0x37, 0xdf, 0x9f, 0x16, 0x8a, 0xba, 0x4e, 0x61, 0x81, 0xe7, 0xc8, 0xde, 0xbb, 0xf, 0x1a, 0x0, 0x15, 0x39, 0xf7, 0x3e, 0x27, 0x27, 0xf2, 0xde, 0xe5, 0x6, 0x23, 0x6e, 0x14, 0x21, 0x5c, 0xfd, 0x34, 0x70, 0x41, 0xee, 0x9e, 0xc3, 0x9, 0x0, 0x10, 0x76, 0x1f, 0xb1, 0x4d, 0xf2, 0x12, 0xab, 0xe5, 0xc2, 0x68, 0xc2, 0x93, 0xec, 0x4b, 0x54, 0x93, 0x28, 0xf9, 0x15, 0x0, 0x9, 0x6, 0xa8, 0x37, 0x24, 0x7f, 0xc2, 0x77, 0x53, 0xa2, 0x22, 0x70, 0x70, 0x22, 0x4a, 0x45, 0x13, 0xf, 0x84, 0x1, 0x6f, 0x23, 0x12, 0x1b, 0x18, 0x0, 0x0, 0x17, 0xda, 0x8, 0x0, 0x2, 0x21, 0xf8, 0xb, 0x10, 0x8, 0x0, 0x9, 0x63, 0x34, 0x50, 0x6e, 0x65, 0xd0, 0x79, 0xc5, 0xc2, 0x3, 0x0, 0x5, 0x33, 0x41, 0x94, 0xaf, 0xd, 0x22, 0x20, 0x58, 0x19, 0xa3, 0x27, 0x0, 0x0, 0x2a, 0x63, 0x21, 0x73, 0x40, 0x27, 0x0, 0x0, 0x5f, 0x89, 0x1c, 0x0, 0x1a, 0x2f, 0xa4, 0x58, 0xe8, 0x52, 0x39, 0x42, 0xf9, 0xad, 0x59, 0x6, 0x90, 0x6, 0x25, 0x8a, 0x61, 0x2, 0x3, 0xbe, 0x7d, 0xfa, 0x57, 0x55, 0xa9, 0xa4, 0xb7, 0x13, 0x3e, 0x62, 0x15, 0x0, 0x3, 0x3b, 0x4a, 0x36, 0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
  uint8_t topic_bytes[] = {0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f};
  lwmqtt_string_t topic = {30, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 18;

  uint8_t bytesprops0[] = {0xab, 0x0, 0xff, 0xb5, 0x57, 0x23, 0x63, 0x29, 0xd5, 0x5f, 0xe9, 0x9c, 0x6c, 0xd6, 0x65, 0x37, 0xdf, 0x9f, 0x16, 0x8a, 0xba, 0x4e, 0x61, 0x81, 0xe7, 0xc8, 0xde, 0xbb, 0xf};
  uint8_t bytesprops1[] = {0x39, 0xf7, 0x3e, 0x27, 0x27, 0xf2, 0xde, 0xe5, 0x6, 0x23, 0x6e, 0x14, 0x21, 0x5c, 0xfd, 0x34, 0x70, 0x41, 0xee, 0x9e, 0xc3};
  uint8_t bytesprops2[] = {0x76, 0x1f, 0xb1, 0x4d, 0xf2, 0x12, 0xab, 0xe5, 0xc2, 0x68, 0xc2, 0x93, 0xec, 0x4b, 0x54, 0x93};
  uint8_t bytesprops3[] = {0x6, 0xa8, 0x37, 0x24, 0x7f, 0xc2, 0x77, 0x53, 0xa2};
  uint8_t bytesprops4[] = {0x21, 0xf8};
  uint8_t bytesprops5[] = {0x63, 0x34, 0x50, 0x6e, 0x65, 0xd0, 0x79, 0xc5, 0xc2};
  uint8_t bytesprops6[] = {0x33, 0x41, 0x94, 0xaf, 0xd};
  uint8_t bytesprops7[] = {0x2f, 0xa4, 0x58, 0xe8, 0x52, 0x39, 0x42, 0xf9, 0xad, 0x59, 0x6, 0x90, 0x6, 0x25, 0x8a, 0x61, 0x2, 0x3, 0xbe, 0x7d, 0xfa, 0x57, 0x55, 0xa9, 0xa4, 0xb7};
  uint8_t bytesprops8[] = {0x3b, 0x4a, 0x36};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {29, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {21, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 249}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {9, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28784}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19013}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 3972}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 111}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4635}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 6106}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 16}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {5, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 8280}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 163}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10851}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29504}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 24457}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 15970}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 26784, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "F\129\169\SYN\215A[Qx}\223\&7NE\181\250\249\236\208\GSL\217\176\183\235\&0\189\247u_", _pubPktID = 26784, _pubBody = "\176\&0\158\138\138]\220(B\154\&3\224jV\159v+\130", _pubProps = [PropServerReference "\171\NUL\255\181W#c)\213_\233\156l\214e7\223\159\SYN\138\186Na\129\231\200\222\187\SI",PropResponseInformation "9\247>''\242\222\229\ACK#n\DC4!\\\253\&4pA\238\158\195",PropCorrelationData "v\US\177M\242\DC2\171\229\194h\194\147\236KT\147",PropWildcardSubscriptionAvailable 249,PropAuthenticationMethod "\ACK\168\&7$\DEL\194wS\162",PropTopicAliasMaximum 28784,PropTopicAliasMaximum 19013,PropServerKeepAlive 3972,PropPayloadFormatIndicator 111,PropTopicAlias 4635,PropWillDelayInterval 6106,PropResponseTopic "!\248",PropSubscriptionIdentifier 16,PropResponseTopic "c4Pne\208y\197\194",PropContentType "3A\148\175\r",PropTopicAliasMaximum 8280,PropRequestResponseInformation 163,PropMaximumPacketSize 10851,PropReceiveMaximum 29504,PropMaximumPacketSize 24457,PropServerReference "/\164X\232R9B\249\173Y\ACK\144\ACK%\138a\STX\ETX\190}\250WU\169\164\183",PropServerKeepAlive 15970,PropAuthenticationMethod ";J6"]}
TEST(Publish5QCTest, Decode5) {
uint8_t pkt[] = {0x3d, 0xf5, 0x1, 0x0, 0x1e, 0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f, 0x68, 0xa0, 0xbf, 0x1, 0x1c, 0x0, 0x1d, 0xab, 0x0, 0xff, 0xb5, 0x57, 0x23, 0x63, 0x29, 0xd5, 0x5f, 0xe9, 0x9c, 0x6c, 0xd6, 0x65, 0x37, 0xdf, 0x9f, 0x16, 0x8a, 0xba, 0x4e, 0x61, 0x81, 0xe7, 0xc8, 0xde, 0xbb, 0xf, 0x1a, 0x0, 0x15, 0x39, 0xf7, 0x3e, 0x27, 0x27, 0xf2, 0xde, 0xe5, 0x6, 0x23, 0x6e, 0x14, 0x21, 0x5c, 0xfd, 0x34, 0x70, 0x41, 0xee, 0x9e, 0xc3, 0x9, 0x0, 0x10, 0x76, 0x1f, 0xb1, 0x4d, 0xf2, 0x12, 0xab, 0xe5, 0xc2, 0x68, 0xc2, 0x93, 0xec, 0x4b, 0x54, 0x93, 0x28, 0xf9, 0x15, 0x0, 0x9, 0x6, 0xa8, 0x37, 0x24, 0x7f, 0xc2, 0x77, 0x53, 0xa2, 0x22, 0x70, 0x70, 0x22, 0x4a, 0x45, 0x13, 0xf, 0x84, 0x1, 0x6f, 0x23, 0x12, 0x1b, 0x18, 0x0, 0x0, 0x17, 0xda, 0x8, 0x0, 0x2, 0x21, 0xf8, 0xb, 0x10, 0x8, 0x0, 0x9, 0x63, 0x34, 0x50, 0x6e, 0x65, 0xd0, 0x79, 0xc5, 0xc2, 0x3, 0x0, 0x5, 0x33, 0x41, 0x94, 0xaf, 0xd, 0x22, 0x20, 0x58, 0x19, 0xa3, 0x27, 0x0, 0x0, 0x2a, 0x63, 0x21, 0x73, 0x40, 0x27, 0x0, 0x0, 0x5f, 0x89, 0x1c, 0x0, 0x1a, 0x2f, 0xa4, 0x58, 0xe8, 0x52, 0x39, 0x42, 0xf9, 0xad, 0x59, 0x6, 0x90, 0x6, 0x25, 0x8a, 0x61, 0x2, 0x3, 0xbe, 0x7d, 0xfa, 0x57, 0x55, 0xa9, 0xa4, 0xb7, 0x13, 0x3e, 0x62, 0x15, 0x0, 0x3, 0x3b, 0x4a, 0x36, 0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x46, 0x81, 0xa9, 0x16, 0xd7, 0x41, 0x5b, 0x51, 0x78, 0x7d, 0xdf, 0x37, 0x4e, 0x45, 0xb5, 0xfa, 0xf9, 0xec, 0xd0, 0x1d, 0x4c, 0xd9, 0xb0, 0xb7, 0xeb, 0x30, 0xbd, 0xf7, 0x75, 0x5f};
  lwmqtt_string_t exp_topic = {30, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xb0, 0x30, 0x9e, 0x8a, 0x8a, 0x5d, 0xdc, 0x28, 0x42, 0x9a, 0x33, 0xe0, 0x6a, 0x56, 0x9f, 0x76, 0x2b, 0x82};
  lwmqtt_string_t exp_body = {18, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 26784);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 30);
EXPECT_EQ(msg.payload_len, 18);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 18);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "IP\\2\223\164P[u\SI\DLEh\171x\188\185\177Q#\163v7L\224Y;5", _pubPktID = 14257, _pubBody = "\215Vs\129\239\168\165b\145\208\232`\245", _pubProps = [PropSessionExpiryInterval 4222,PropSubscriptionIdentifierAvailable 237,PropReasonString "6\175G3d\SO*\237\171\SO\234\f*`\253\166\201\&2\GS\204H\250\t\DLE\239",PropCorrelationData "\228",PropResponseTopic "\198$\r\206\225\242\139<\249",PropResponseInformation "\aO",PropUserProperty "\129\ETXH\149M\197\153>\237T\173\192" "\249\130.\189\196\248\154\154\163G",PropAssignedClientIdentifier "\215\161\223\nAr\172a#\252`!\188\208g\DEL~\f\RSx",PropReceiveMaximum 15611,PropAuthenticationMethod "\172\238\233\&0\220|E.3\250s8D-A%\251\&08\FS\215\201\136\186\142?",PropTopicAlias 27987,PropResponseInformation "n\142\194\\\150\183\193K\USk<\"\239\195",PropAssignedClientIdentifier "\150\134\239\143\183b&\198^1_\DEL\136\242\v\246a\fH\175\208\RS\198\141\176\"N=\140",PropServerKeepAlive 15578,PropTopicAliasMaximum 1748,PropContentType "r\ETX\t\ETB\bu.I\161\128K6\184d\138\"\SI;\b\184\"",PropContentType "1-\247a\147\147\ESC\183\&0\221y|7\SI(W\239n?",PropPayloadFormatIndicator 60,PropSubscriptionIdentifier 25,PropPayloadFormatIndicator 36,PropUserProperty "\"-m\172=\230\237\245\206\162\182\177\182\GS\165\250\190\141\252\168\173" "1",PropRequestResponseInformation 106,PropSubscriptionIdentifier 25,PropSubscriptionIdentifier 23]}
TEST(Publish5QCTest, Encode6) {
uint8_t pkt[] = {0x35, 0xc7, 0x2, 0x0, 0x1b, 0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35, 0x37, 0xb1, 0x99, 0x2, 0x11, 0x0, 0x0, 0x10, 0x7e, 0x29, 0xed, 0x1f, 0x0, 0x19, 0x36, 0xaf, 0x47, 0x33, 0x64, 0xe, 0x2a, 0xed, 0xab, 0xe, 0xea, 0xc, 0x2a, 0x60, 0xfd, 0xa6, 0xc9, 0x32, 0x1d, 0xcc, 0x48, 0xfa, 0x9, 0x10, 0xef, 0x9, 0x0, 0x1, 0xe4, 0x8, 0x0, 0x9, 0xc6, 0x24, 0xd, 0xce, 0xe1, 0xf2, 0x8b, 0x3c, 0xf9, 0x1a, 0x0, 0x2, 0x7, 0x4f, 0x26, 0x0, 0xc, 0x81, 0x3, 0x48, 0x95, 0x4d, 0xc5, 0x99, 0x3e, 0xed, 0x54, 0xad, 0xc0, 0x0, 0xa, 0xf9, 0x82, 0x2e, 0xbd, 0xc4, 0xf8, 0x9a, 0x9a, 0xa3, 0x47, 0x12, 0x0, 0x14, 0xd7, 0xa1, 0xdf, 0xa, 0x41, 0x72, 0xac, 0x61, 0x23, 0xfc, 0x60, 0x21, 0xbc, 0xd0, 0x67, 0x7f, 0x7e, 0xc, 0x1e, 0x78, 0x21, 0x3c, 0xfb, 0x15, 0x0, 0x1a, 0xac, 0xee, 0xe9, 0x30, 0xdc, 0x7c, 0x45, 0x2e, 0x33, 0xfa, 0x73, 0x38, 0x44, 0x2d, 0x41, 0x25, 0xfb, 0x30, 0x38, 0x1c, 0xd7, 0xc9, 0x88, 0xba, 0x8e, 0x3f, 0x23, 0x6d, 0x53, 0x1a, 0x0, 0xe, 0x6e, 0x8e, 0xc2, 0x5c, 0x96, 0xb7, 0xc1, 0x4b, 0x1f, 0x6b, 0x3c, 0x22, 0xef, 0xc3, 0x12, 0x0, 0x1d, 0x96, 0x86, 0xef, 0x8f, 0xb7, 0x62, 0x26, 0xc6, 0x5e, 0x31, 0x5f, 0x7f, 0x88, 0xf2, 0xb, 0xf6, 0x61, 0xc, 0x48, 0xaf, 0xd0, 0x1e, 0xc6, 0x8d, 0xb0, 0x22, 0x4e, 0x3d, 0x8c, 0x13, 0x3c, 0xda, 0x22, 0x6, 0xd4, 0x3, 0x0, 0x15, 0x72, 0x3, 0x9, 0x17, 0x8, 0x75, 0x2e, 0x49, 0xa1, 0x80, 0x4b, 0x36, 0xb8, 0x64, 0x8a, 0x22, 0xf, 0x3b, 0x8, 0xb8, 0x22, 0x3, 0x0, 0x13, 0x31, 0x2d, 0xf7, 0x61, 0x93, 0x93, 0x1b, 0xb7, 0x30, 0xdd, 0x79, 0x7c, 0x37, 0xf, 0x28, 0x57, 0xef, 0x6e, 0x3f, 0x1, 0x3c, 0xb, 0x19, 0x1, 0x24, 0x26, 0x0, 0x15, 0x22, 0x2d, 0x6d, 0xac, 0x3d, 0xe6, 0xed, 0xf5, 0xce, 0xa2, 0xb6, 0xb1, 0xb6, 0x1d, 0xa5, 0xfa, 0xbe, 0x8d, 0xfc, 0xa8, 0xad, 0x0, 0x1, 0x31, 0x19, 0x6a, 0xb, 0x19, 0xb, 0x17, 0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
  uint8_t topic_bytes[] = {0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  uint8_t bytesprops0[] = {0x36, 0xaf, 0x47, 0x33, 0x64, 0xe, 0x2a, 0xed, 0xab, 0xe, 0xea, 0xc, 0x2a, 0x60, 0xfd, 0xa6, 0xc9, 0x32, 0x1d, 0xcc, 0x48, 0xfa, 0x9, 0x10, 0xef};
  uint8_t bytesprops1[] = {0xe4};
  uint8_t bytesprops2[] = {0xc6, 0x24, 0xd, 0xce, 0xe1, 0xf2, 0x8b, 0x3c, 0xf9};
  uint8_t bytesprops3[] = {0x7, 0x4f};
  uint8_t bytesprops5[] = {0xf9, 0x82, 0x2e, 0xbd, 0xc4, 0xf8, 0x9a, 0x9a, 0xa3, 0x47};
  uint8_t bytesprops4[] = {0x81, 0x3, 0x48, 0x95, 0x4d, 0xc5, 0x99, 0x3e, 0xed, 0x54, 0xad, 0xc0};
  uint8_t bytesprops6[] = {0xd7, 0xa1, 0xdf, 0xa, 0x41, 0x72, 0xac, 0x61, 0x23, 0xfc, 0x60, 0x21, 0xbc, 0xd0, 0x67, 0x7f, 0x7e, 0xc, 0x1e, 0x78};
  uint8_t bytesprops7[] = {0xac, 0xee, 0xe9, 0x30, 0xdc, 0x7c, 0x45, 0x2e, 0x33, 0xfa, 0x73, 0x38, 0x44, 0x2d, 0x41, 0x25, 0xfb, 0x30, 0x38, 0x1c, 0xd7, 0xc9, 0x88, 0xba, 0x8e, 0x3f};
  uint8_t bytesprops8[] = {0x6e, 0x8e, 0xc2, 0x5c, 0x96, 0xb7, 0xc1, 0x4b, 0x1f, 0x6b, 0x3c, 0x22, 0xef, 0xc3};
  uint8_t bytesprops9[] = {0x96, 0x86, 0xef, 0x8f, 0xb7, 0x62, 0x26, 0xc6, 0x5e, 0x31, 0x5f, 0x7f, 0x88, 0xf2, 0xb, 0xf6, 0x61, 0xc, 0x48, 0xaf, 0xd0, 0x1e, 0xc6, 0x8d, 0xb0, 0x22, 0x4e, 0x3d, 0x8c};
  uint8_t bytesprops10[] = {0x72, 0x3, 0x9, 0x17, 0x8, 0x75, 0x2e, 0x49, 0xa1, 0x80, 0x4b, 0x36, 0xb8, 0x64, 0x8a, 0x22, 0xf, 0x3b, 0x8, 0xb8, 0x22};
  uint8_t bytesprops11[] = {0x31, 0x2d, 0xf7, 0x61, 0x93, 0x93, 0x1b, 0xb7, 0x30, 0xdd, 0x79, 0x7c, 0x37, 0xf, 0x28, 0x57, 0xef, 0x6e, 0x3f};
  uint8_t bytesprops13[] = {0x31};
  uint8_t bytesprops12[] = {0x22, 0x2d, 0x6d, 0xac, 0x3d, 0xe6, 0xed, 0xf5, 0xce, 0xa2, 0xb6, 0xb1, 0xb6, 0x1d, 0xa5, 0xfa, 0xbe, 0x8d, 0xfc, 0xa8, 0xad};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 4222}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 237}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {25, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {1, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={12, (char*)&bytesprops4}, .v={10, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15611}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 27987}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 15578}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1748}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {19, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 60}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={21, (char*)&bytesprops12}, .v={1, (char*)&bytesprops13}}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 106}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 23}},
  };

  lwmqtt_properties_t props = {24, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 14257, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "IP\\2\223\164P[u\SI\DLEh\171x\188\185\177Q#\163v7L\224Y;5", _pubPktID = 14257, _pubBody = "\215Vs\129\239\168\165b\145\208\232`\245", _pubProps = [PropSessionExpiryInterval 4222,PropSubscriptionIdentifierAvailable 237,PropReasonString "6\175G3d\SO*\237\171\SO\234\f*`\253\166\201\&2\GS\204H\250\t\DLE\239",PropCorrelationData "\228",PropResponseTopic "\198$\r\206\225\242\139<\249",PropResponseInformation "\aO",PropUserProperty "\129\ETXH\149M\197\153>\237T\173\192" "\249\130.\189\196\248\154\154\163G",PropAssignedClientIdentifier "\215\161\223\nAr\172a#\252`!\188\208g\DEL~\f\RSx",PropReceiveMaximum 15611,PropAuthenticationMethod "\172\238\233\&0\220|E.3\250s8D-A%\251\&08\FS\215\201\136\186\142?",PropTopicAlias 27987,PropResponseInformation "n\142\194\\\150\183\193K\USk<\"\239\195",PropAssignedClientIdentifier "\150\134\239\143\183b&\198^1_\DEL\136\242\v\246a\fH\175\208\RS\198\141\176\"N=\140",PropServerKeepAlive 15578,PropTopicAliasMaximum 1748,PropContentType "r\ETX\t\ETB\bu.I\161\128K6\184d\138\"\SI;\b\184\"",PropContentType "1-\247a\147\147\ESC\183\&0\221y|7\SI(W\239n?",PropPayloadFormatIndicator 60,PropSubscriptionIdentifier 25,PropPayloadFormatIndicator 36,PropUserProperty "\"-m\172=\230\237\245\206\162\182\177\182\GS\165\250\190\141\252\168\173" "1",PropRequestResponseInformation 106,PropSubscriptionIdentifier 25,PropSubscriptionIdentifier 23]}
TEST(Publish5QCTest, Decode6) {
uint8_t pkt[] = {0x35, 0xc7, 0x2, 0x0, 0x1b, 0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35, 0x37, 0xb1, 0x99, 0x2, 0x11, 0x0, 0x0, 0x10, 0x7e, 0x29, 0xed, 0x1f, 0x0, 0x19, 0x36, 0xaf, 0x47, 0x33, 0x64, 0xe, 0x2a, 0xed, 0xab, 0xe, 0xea, 0xc, 0x2a, 0x60, 0xfd, 0xa6, 0xc9, 0x32, 0x1d, 0xcc, 0x48, 0xfa, 0x9, 0x10, 0xef, 0x9, 0x0, 0x1, 0xe4, 0x8, 0x0, 0x9, 0xc6, 0x24, 0xd, 0xce, 0xe1, 0xf2, 0x8b, 0x3c, 0xf9, 0x1a, 0x0, 0x2, 0x7, 0x4f, 0x26, 0x0, 0xc, 0x81, 0x3, 0x48, 0x95, 0x4d, 0xc5, 0x99, 0x3e, 0xed, 0x54, 0xad, 0xc0, 0x0, 0xa, 0xf9, 0x82, 0x2e, 0xbd, 0xc4, 0xf8, 0x9a, 0x9a, 0xa3, 0x47, 0x12, 0x0, 0x14, 0xd7, 0xa1, 0xdf, 0xa, 0x41, 0x72, 0xac, 0x61, 0x23, 0xfc, 0x60, 0x21, 0xbc, 0xd0, 0x67, 0x7f, 0x7e, 0xc, 0x1e, 0x78, 0x21, 0x3c, 0xfb, 0x15, 0x0, 0x1a, 0xac, 0xee, 0xe9, 0x30, 0xdc, 0x7c, 0x45, 0x2e, 0x33, 0xfa, 0x73, 0x38, 0x44, 0x2d, 0x41, 0x25, 0xfb, 0x30, 0x38, 0x1c, 0xd7, 0xc9, 0x88, 0xba, 0x8e, 0x3f, 0x23, 0x6d, 0x53, 0x1a, 0x0, 0xe, 0x6e, 0x8e, 0xc2, 0x5c, 0x96, 0xb7, 0xc1, 0x4b, 0x1f, 0x6b, 0x3c, 0x22, 0xef, 0xc3, 0x12, 0x0, 0x1d, 0x96, 0x86, 0xef, 0x8f, 0xb7, 0x62, 0x26, 0xc6, 0x5e, 0x31, 0x5f, 0x7f, 0x88, 0xf2, 0xb, 0xf6, 0x61, 0xc, 0x48, 0xaf, 0xd0, 0x1e, 0xc6, 0x8d, 0xb0, 0x22, 0x4e, 0x3d, 0x8c, 0x13, 0x3c, 0xda, 0x22, 0x6, 0xd4, 0x3, 0x0, 0x15, 0x72, 0x3, 0x9, 0x17, 0x8, 0x75, 0x2e, 0x49, 0xa1, 0x80, 0x4b, 0x36, 0xb8, 0x64, 0x8a, 0x22, 0xf, 0x3b, 0x8, 0xb8, 0x22, 0x3, 0x0, 0x13, 0x31, 0x2d, 0xf7, 0x61, 0x93, 0x93, 0x1b, 0xb7, 0x30, 0xdd, 0x79, 0x7c, 0x37, 0xf, 0x28, 0x57, 0xef, 0x6e, 0x3f, 0x1, 0x3c, 0xb, 0x19, 0x1, 0x24, 0x26, 0x0, 0x15, 0x22, 0x2d, 0x6d, 0xac, 0x3d, 0xe6, 0xed, 0xf5, 0xce, 0xa2, 0xb6, 0xb1, 0xb6, 0x1d, 0xa5, 0xfa, 0xbe, 0x8d, 0xfc, 0xa8, 0xad, 0x0, 0x1, 0x31, 0x19, 0x6a, 0xb, 0x19, 0xb, 0x17, 0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x49, 0x50, 0x5c, 0x32, 0xdf, 0xa4, 0x50, 0x5b, 0x75, 0xf, 0x10, 0x68, 0xab, 0x78, 0xbc, 0xb9, 0xb1, 0x51, 0x23, 0xa3, 0x76, 0x37, 0x4c, 0xe0, 0x59, 0x3b, 0x35};
  lwmqtt_string_t exp_topic = {27, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xd7, 0x56, 0x73, 0x81, 0xef, 0xa8, 0xa5, 0x62, 0x91, 0xd0, 0xe8, 0x60, 0xf5};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 14257);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 27);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "6\RS\235\193R\DEL\172\233\219\ETX\209a8\243\RS\229\&2a", _pubPktID = 10501, _pubBody = "*K\219};J\192L&\150k\230#\253#\163\207\128\170\174\GS{\t", _pubProps = [PropMessageExpiryInterval 20953,PropRequestProblemInformation 35,PropReasonString "\239\&8\203",PropPayloadFormatIndicator 223,PropSharedSubscriptionAvailable 171,PropReasonString "\166o\v3\139\232g;\f\SI\"\147[Rr\DC2 p\243\ACK\r\206<6",PropWillDelayInterval 5646,PropMessageExpiryInterval 2935,PropResponseInformation "\ACKD6\229=@",PropContentType "\194",PropMessageExpiryInterval 3137,PropRetainAvailable 40,PropMaximumPacketSize 2855,PropReasonString "m8\255\n>\131Q\132-=\228\254\v\228\SYN",PropTopicAliasMaximum 818,PropSessionExpiryInterval 7249,PropSubscriptionIdentifier 21,PropServerKeepAlive 32278,PropTopicAlias 21281,PropResponseTopic "\211[",PropReasonString "~\175\237->\ENQ\146\144\202\223\143\148\201\197\ESC",PropRequestResponseInformation 158,PropTopicAliasMaximum 9622,PropSubscriptionIdentifierAvailable 9,PropMessageExpiryInterval 3827,PropReasonString "I\190\181\231\SYN\211;\NAK\245\&9\223\DC1\NAKR\148\197\223X\CANGp",PropAuthenticationMethod "\132\147\148\166\SYN\ACK\235\179\183\STX\137\193\DC3\136U\130\243\RS\162\233\165d",PropAuthenticationMethod "\f\249Y\216\201\209\248\&5\232\212\&4-\165d\202\145\&3&}\216\SUB",PropReasonString "\185B\160\232\167#\190j\177\157^\182\198\196_\192\184\207\246;\148B\215\208\137\179\b\204a"]}
TEST(Publish5QCTest, Encode7) {
uint8_t pkt[] = {0x3d, 0xac, 0x2, 0x0, 0x12, 0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61, 0x29, 0x5, 0xfd, 0x1, 0x2, 0x0, 0x0, 0x51, 0xd9, 0x17, 0x23, 0x1f, 0x0, 0x3, 0xef, 0x38, 0xcb, 0x1, 0xdf, 0x2a, 0xab, 0x1f, 0x0, 0x18, 0xa6, 0x6f, 0xb, 0x33, 0x8b, 0xe8, 0x67, 0x3b, 0xc, 0xf, 0x22, 0x93, 0x5b, 0x52, 0x72, 0x12, 0x20, 0x70, 0xf3, 0x6, 0xd, 0xce, 0x3c, 0x36, 0x18, 0x0, 0x0, 0x16, 0xe, 0x2, 0x0, 0x0, 0xb, 0x77, 0x1a, 0x0, 0x6, 0x6, 0x44, 0x36, 0xe5, 0x3d, 0x40, 0x3, 0x0, 0x1, 0xc2, 0x2, 0x0, 0x0, 0xc, 0x41, 0x25, 0x28, 0x27, 0x0, 0x0, 0xb, 0x27, 0x1f, 0x0, 0xf, 0x6d, 0x38, 0xff, 0xa, 0x3e, 0x83, 0x51, 0x84, 0x2d, 0x3d, 0xe4, 0xfe, 0xb, 0xe4, 0x16, 0x22, 0x3, 0x32, 0x11, 0x0, 0x0, 0x1c, 0x51, 0xb, 0x15, 0x13, 0x7e, 0x16, 0x23, 0x53, 0x21, 0x8, 0x0, 0x2, 0xd3, 0x5b, 0x1f, 0x0, 0xf, 0x7e, 0xaf, 0xed, 0x2d, 0x3e, 0x5, 0x92, 0x90, 0xca, 0xdf, 0x8f, 0x94, 0xc9, 0xc5, 0x1b, 0x19, 0x9e, 0x22, 0x25, 0x96, 0x29, 0x9, 0x2, 0x0, 0x0, 0xe, 0xf3, 0x1f, 0x0, 0x15, 0x49, 0xbe, 0xb5, 0xe7, 0x16, 0xd3, 0x3b, 0x15, 0xf5, 0x39, 0xdf, 0x11, 0x15, 0x52, 0x94, 0xc5, 0xdf, 0x58, 0x18, 0x47, 0x70, 0x15, 0x0, 0x16, 0x84, 0x93, 0x94, 0xa6, 0x16, 0x6, 0xeb, 0xb3, 0xb7, 0x2, 0x89, 0xc1, 0x13, 0x88, 0x55, 0x82, 0xf3, 0x1e, 0xa2, 0xe9, 0xa5, 0x64, 0x15, 0x0, 0x15, 0xc, 0xf9, 0x59, 0xd8, 0xc9, 0xd1, 0xf8, 0x35, 0xe8, 0xd4, 0x34, 0x2d, 0xa5, 0x64, 0xca, 0x91, 0x33, 0x26, 0x7d, 0xd8, 0x1a, 0x1f, 0x0, 0x1d, 0xb9, 0x42, 0xa0, 0xe8, 0xa7, 0x23, 0xbe, 0x6a, 0xb1, 0x9d, 0x5e, 0xb6, 0xc6, 0xc4, 0x5f, 0xc0, 0xb8, 0xcf, 0xf6, 0x3b, 0x94, 0x42, 0xd7, 0xd0, 0x89, 0xb3, 0x8, 0xcc, 0x61, 0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
  uint8_t topic_bytes[] = {0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 23;

  uint8_t bytesprops0[] = {0xef, 0x38, 0xcb};
  uint8_t bytesprops1[] = {0xa6, 0x6f, 0xb, 0x33, 0x8b, 0xe8, 0x67, 0x3b, 0xc, 0xf, 0x22, 0x93, 0x5b, 0x52, 0x72, 0x12, 0x20, 0x70, 0xf3, 0x6, 0xd, 0xce, 0x3c, 0x36};
  uint8_t bytesprops2[] = {0x6, 0x44, 0x36, 0xe5, 0x3d, 0x40};
  uint8_t bytesprops3[] = {0xc2};
  uint8_t bytesprops4[] = {0x6d, 0x38, 0xff, 0xa, 0x3e, 0x83, 0x51, 0x84, 0x2d, 0x3d, 0xe4, 0xfe, 0xb, 0xe4, 0x16};
  uint8_t bytesprops5[] = {0xd3, 0x5b};
  uint8_t bytesprops6[] = {0x7e, 0xaf, 0xed, 0x2d, 0x3e, 0x5, 0x92, 0x90, 0xca, 0xdf, 0x8f, 0x94, 0xc9, 0xc5, 0x1b};
  uint8_t bytesprops7[] = {0x49, 0xbe, 0xb5, 0xe7, 0x16, 0xd3, 0x3b, 0x15, 0xf5, 0x39, 0xdf, 0x11, 0x15, 0x52, 0x94, 0xc5, 0xdf, 0x58, 0x18, 0x47, 0x70};
  uint8_t bytesprops8[] = {0x84, 0x93, 0x94, 0xa6, 0x16, 0x6, 0xeb, 0xb3, 0xb7, 0x2, 0x89, 0xc1, 0x13, 0x88, 0x55, 0x82, 0xf3, 0x1e, 0xa2, 0xe9, 0xa5, 0x64};
  uint8_t bytesprops9[] = {0xc, 0xf9, 0x59, 0xd8, 0xc9, 0xd1, 0xf8, 0x35, 0xe8, 0xd4, 0x34, 0x2d, 0xa5, 0x64, 0xca, 0x91, 0x33, 0x26, 0x7d, 0xd8, 0x1a};
  uint8_t bytesprops10[] = {0xb9, 0x42, 0xa0, 0xe8, 0xa7, 0x23, 0xbe, 0x6a, 0xb1, 0x9d, 0x5e, 0xb6, 0xc6, 0xc4, 0x5f, 0xc0, 0xb8, 0xcf, 0xf6, 0x3b, 0x94, 0x42, 0xd7, 0xd0, 0x89, 0xb3, 0x8, 0xcc, 0x61};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 20953}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 35}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 223}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5646}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2935}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {1, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3137}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 40}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2855}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 818}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7249}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 21}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 32278}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21281}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 158}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 9622}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 9}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3827}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {21, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {22, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 10501, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "6\RS\235\193R\DEL\172\233\219\ETX\209a8\243\RS\229\&2a", _pubPktID = 10501, _pubBody = "*K\219};J\192L&\150k\230#\253#\163\207\128\170\174\GS{\t", _pubProps = [PropMessageExpiryInterval 20953,PropRequestProblemInformation 35,PropReasonString "\239\&8\203",PropPayloadFormatIndicator 223,PropSharedSubscriptionAvailable 171,PropReasonString "\166o\v3\139\232g;\f\SI\"\147[Rr\DC2 p\243\ACK\r\206<6",PropWillDelayInterval 5646,PropMessageExpiryInterval 2935,PropResponseInformation "\ACKD6\229=@",PropContentType "\194",PropMessageExpiryInterval 3137,PropRetainAvailable 40,PropMaximumPacketSize 2855,PropReasonString "m8\255\n>\131Q\132-=\228\254\v\228\SYN",PropTopicAliasMaximum 818,PropSessionExpiryInterval 7249,PropSubscriptionIdentifier 21,PropServerKeepAlive 32278,PropTopicAlias 21281,PropResponseTopic "\211[",PropReasonString "~\175\237->\ENQ\146\144\202\223\143\148\201\197\ESC",PropRequestResponseInformation 158,PropTopicAliasMaximum 9622,PropSubscriptionIdentifierAvailable 9,PropMessageExpiryInterval 3827,PropReasonString "I\190\181\231\SYN\211;\NAK\245\&9\223\DC1\NAKR\148\197\223X\CANGp",PropAuthenticationMethod "\132\147\148\166\SYN\ACK\235\179\183\STX\137\193\DC3\136U\130\243\RS\162\233\165d",PropAuthenticationMethod "\f\249Y\216\201\209\248\&5\232\212\&4-\165d\202\145\&3&}\216\SUB",PropReasonString "\185B\160\232\167#\190j\177\157^\182\198\196_\192\184\207\246;\148B\215\208\137\179\b\204a"]}
TEST(Publish5QCTest, Decode7) {
uint8_t pkt[] = {0x3d, 0xac, 0x2, 0x0, 0x12, 0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61, 0x29, 0x5, 0xfd, 0x1, 0x2, 0x0, 0x0, 0x51, 0xd9, 0x17, 0x23, 0x1f, 0x0, 0x3, 0xef, 0x38, 0xcb, 0x1, 0xdf, 0x2a, 0xab, 0x1f, 0x0, 0x18, 0xa6, 0x6f, 0xb, 0x33, 0x8b, 0xe8, 0x67, 0x3b, 0xc, 0xf, 0x22, 0x93, 0x5b, 0x52, 0x72, 0x12, 0x20, 0x70, 0xf3, 0x6, 0xd, 0xce, 0x3c, 0x36, 0x18, 0x0, 0x0, 0x16, 0xe, 0x2, 0x0, 0x0, 0xb, 0x77, 0x1a, 0x0, 0x6, 0x6, 0x44, 0x36, 0xe5, 0x3d, 0x40, 0x3, 0x0, 0x1, 0xc2, 0x2, 0x0, 0x0, 0xc, 0x41, 0x25, 0x28, 0x27, 0x0, 0x0, 0xb, 0x27, 0x1f, 0x0, 0xf, 0x6d, 0x38, 0xff, 0xa, 0x3e, 0x83, 0x51, 0x84, 0x2d, 0x3d, 0xe4, 0xfe, 0xb, 0xe4, 0x16, 0x22, 0x3, 0x32, 0x11, 0x0, 0x0, 0x1c, 0x51, 0xb, 0x15, 0x13, 0x7e, 0x16, 0x23, 0x53, 0x21, 0x8, 0x0, 0x2, 0xd3, 0x5b, 0x1f, 0x0, 0xf, 0x7e, 0xaf, 0xed, 0x2d, 0x3e, 0x5, 0x92, 0x90, 0xca, 0xdf, 0x8f, 0x94, 0xc9, 0xc5, 0x1b, 0x19, 0x9e, 0x22, 0x25, 0x96, 0x29, 0x9, 0x2, 0x0, 0x0, 0xe, 0xf3, 0x1f, 0x0, 0x15, 0x49, 0xbe, 0xb5, 0xe7, 0x16, 0xd3, 0x3b, 0x15, 0xf5, 0x39, 0xdf, 0x11, 0x15, 0x52, 0x94, 0xc5, 0xdf, 0x58, 0x18, 0x47, 0x70, 0x15, 0x0, 0x16, 0x84, 0x93, 0x94, 0xa6, 0x16, 0x6, 0xeb, 0xb3, 0xb7, 0x2, 0x89, 0xc1, 0x13, 0x88, 0x55, 0x82, 0xf3, 0x1e, 0xa2, 0xe9, 0xa5, 0x64, 0x15, 0x0, 0x15, 0xc, 0xf9, 0x59, 0xd8, 0xc9, 0xd1, 0xf8, 0x35, 0xe8, 0xd4, 0x34, 0x2d, 0xa5, 0x64, 0xca, 0x91, 0x33, 0x26, 0x7d, 0xd8, 0x1a, 0x1f, 0x0, 0x1d, 0xb9, 0x42, 0xa0, 0xe8, 0xa7, 0x23, 0xbe, 0x6a, 0xb1, 0x9d, 0x5e, 0xb6, 0xc6, 0xc4, 0x5f, 0xc0, 0xb8, 0xcf, 0xf6, 0x3b, 0x94, 0x42, 0xd7, 0xd0, 0x89, 0xb3, 0x8, 0xcc, 0x61, 0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x36, 0x1e, 0xeb, 0xc1, 0x52, 0x7f, 0xac, 0xe9, 0xdb, 0x3, 0xd1, 0x61, 0x38, 0xf3, 0x1e, 0xe5, 0x32, 0x61};
  lwmqtt_string_t exp_topic = {18, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x2a, 0x4b, 0xdb, 0x7d, 0x3b, 0x4a, 0xc0, 0x4c, 0x26, 0x96, 0x6b, 0xe6, 0x23, 0xfd, 0x23, 0xa3, 0xcf, 0x80, 0xaa, 0xae, 0x1d, 0x7b, 0x9};
  lwmqtt_string_t exp_body = {23, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 10501);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 18);
EXPECT_EQ(msg.payload_len, 23);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 23);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\129\171\&3\ETBSN", _pubPktID = 5903, _pubBody = "zPg\212~f\130\171\232\241P\212\ENQ'\234'@\v\177;s\157z*\DC2{\148\&6|", _pubProps = [PropServerKeepAlive 25004,PropRequestProblemInformation 146,PropTopicAlias 13436,PropServerKeepAlive 31880,PropPayloadFormatIndicator 16,PropMessageExpiryInterval 18537,PropAuthenticationData "",PropReasonString "\134\128\129\246\142\ETX]x",PropSessionExpiryInterval 1893,PropMaximumQoS 117,PropMaximumPacketSize 16084,PropTopicAlias 17664,PropTopicAlias 2670,PropServerKeepAlive 6931,PropTopicAliasMaximum 10342,PropUserProperty "\DC4\f{9\243\233\247\196" "\179\ETB\168\&8\STXk\158\SUB\\\132",PropMessageExpiryInterval 14066,PropUserProperty "" "\SO\220\&3oO>\198i\ENQv\147",PropAssignedClientIdentifier "\EMd\138\217\173\154\ETX\145\DC2\173\220\214",PropServerKeepAlive 19246,PropMaximumPacketSize 1458,PropTopicAliasMaximum 9667,PropContentType "I\139L?\197OGv3\t*, `N\138\244\206k\211\\"]}
TEST(Publish5QCTest, Encode8) {
uint8_t pkt[] = {0x3c, 0xbf, 0x1, 0x0, 0x6, 0x81, 0xab, 0x33, 0x17, 0x53, 0x4e, 0x17, 0xf, 0x96, 0x1, 0x13, 0x61, 0xac, 0x17, 0x92, 0x23, 0x34, 0x7c, 0x13, 0x7c, 0x88, 0x1, 0x10, 0x2, 0x0, 0x0, 0x48, 0x69, 0x16, 0x0, 0x0, 0x1f, 0x0, 0x8, 0x86, 0x80, 0x81, 0xf6, 0x8e, 0x3, 0x5d, 0x78, 0x11, 0x0, 0x0, 0x7, 0x65, 0x24, 0x75, 0x27, 0x0, 0x0, 0x3e, 0xd4, 0x23, 0x45, 0x0, 0x23, 0xa, 0x6e, 0x13, 0x1b, 0x13, 0x22, 0x28, 0x66, 0x26, 0x0, 0x8, 0x14, 0xc, 0x7b, 0x39, 0xf3, 0xe9, 0xf7, 0xc4, 0x0, 0xa, 0xb3, 0x17, 0xa8, 0x38, 0x2, 0x6b, 0x9e, 0x1a, 0x5c, 0x84, 0x2, 0x0, 0x0, 0x36, 0xf2, 0x26, 0x0, 0x0, 0x0, 0xb, 0xe, 0xdc, 0x33, 0x6f, 0x4f, 0x3e, 0xc6, 0x69, 0x5, 0x76, 0x93, 0x12, 0x0, 0xc, 0x19, 0x64, 0x8a, 0xd9, 0xad, 0x9a, 0x3, 0x91, 0x12, 0xad, 0xdc, 0xd6, 0x13, 0x4b, 0x2e, 0x27, 0x0, 0x0, 0x5, 0xb2, 0x22, 0x25, 0xc3, 0x3, 0x0, 0x15, 0x49, 0x8b, 0x4c, 0x3f, 0xc5, 0x4f, 0x47, 0x76, 0x33, 0x9, 0x2a, 0x2c, 0x20, 0x60, 0x4e, 0x8a, 0xf4, 0xce, 0x6b, 0xd3, 0x5c, 0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
  uint8_t topic_bytes[] = {0x81, 0xab, 0x33, 0x17, 0x53, 0x4e};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 29;

  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0x86, 0x80, 0x81, 0xf6, 0x8e, 0x3, 0x5d, 0x78};
  uint8_t bytesprops3[] = {0xb3, 0x17, 0xa8, 0x38, 0x2, 0x6b, 0x9e, 0x1a, 0x5c, 0x84};
  uint8_t bytesprops2[] = {0x14, 0xc, 0x7b, 0x39, 0xf3, 0xe9, 0xf7, 0xc4};
  uint8_t bytesprops5[] = {0xe, 0xdc, 0x33, 0x6f, 0x4f, 0x3e, 0xc6, 0x69, 0x5, 0x76, 0x93};
  uint8_t bytesprops4[] = {0};
  uint8_t bytesprops6[] = {0x19, 0x64, 0x8a, 0xd9, 0xad, 0x9a, 0x3, 0x91, 0x12, 0xad, 0xdc, 0xd6};
  uint8_t bytesprops7[] = {0x49, 0x8b, 0x4c, 0x3f, 0xc5, 0x4f, 0x47, 0x76, 0x33, 0x9, 0x2a, 0x2c, 0x20, 0x60, 0x4e, 0x8a, 0xf4, 0xce, 0x6b, 0xd3, 0x5c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 25004}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 146}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 13436}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 31880}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 16}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18537}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {0, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {8, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1893}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 16084}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 17664}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 2670}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 6931}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 10342}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={8, (char*)&bytesprops2}, .v={10, (char*)&bytesprops3}}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14066}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={0, (char*)&bytesprops4}, .v={11, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19246}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1458}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 9667}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 5903, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\129\171\&3\ETBSN", _pubPktID = 5903, _pubBody = "zPg\212~f\130\171\232\241P\212\ENQ'\234'@\v\177;s\157z*\DC2{\148\&6|", _pubProps = [PropServerKeepAlive 25004,PropRequestProblemInformation 146,PropTopicAlias 13436,PropServerKeepAlive 31880,PropPayloadFormatIndicator 16,PropMessageExpiryInterval 18537,PropAuthenticationData "",PropReasonString "\134\128\129\246\142\ETX]x",PropSessionExpiryInterval 1893,PropMaximumQoS 117,PropMaximumPacketSize 16084,PropTopicAlias 17664,PropTopicAlias 2670,PropServerKeepAlive 6931,PropTopicAliasMaximum 10342,PropUserProperty "\DC4\f{9\243\233\247\196" "\179\ETB\168\&8\STXk\158\SUB\\\132",PropMessageExpiryInterval 14066,PropUserProperty "" "\SO\220\&3oO>\198i\ENQv\147",PropAssignedClientIdentifier "\EMd\138\217\173\154\ETX\145\DC2\173\220\214",PropServerKeepAlive 19246,PropMaximumPacketSize 1458,PropTopicAliasMaximum 9667,PropContentType "I\139L?\197OGv3\t*, `N\138\244\206k\211\\"]}
TEST(Publish5QCTest, Decode8) {
uint8_t pkt[] = {0x3c, 0xbf, 0x1, 0x0, 0x6, 0x81, 0xab, 0x33, 0x17, 0x53, 0x4e, 0x17, 0xf, 0x96, 0x1, 0x13, 0x61, 0xac, 0x17, 0x92, 0x23, 0x34, 0x7c, 0x13, 0x7c, 0x88, 0x1, 0x10, 0x2, 0x0, 0x0, 0x48, 0x69, 0x16, 0x0, 0x0, 0x1f, 0x0, 0x8, 0x86, 0x80, 0x81, 0xf6, 0x8e, 0x3, 0x5d, 0x78, 0x11, 0x0, 0x0, 0x7, 0x65, 0x24, 0x75, 0x27, 0x0, 0x0, 0x3e, 0xd4, 0x23, 0x45, 0x0, 0x23, 0xa, 0x6e, 0x13, 0x1b, 0x13, 0x22, 0x28, 0x66, 0x26, 0x0, 0x8, 0x14, 0xc, 0x7b, 0x39, 0xf3, 0xe9, 0xf7, 0xc4, 0x0, 0xa, 0xb3, 0x17, 0xa8, 0x38, 0x2, 0x6b, 0x9e, 0x1a, 0x5c, 0x84, 0x2, 0x0, 0x0, 0x36, 0xf2, 0x26, 0x0, 0x0, 0x0, 0xb, 0xe, 0xdc, 0x33, 0x6f, 0x4f, 0x3e, 0xc6, 0x69, 0x5, 0x76, 0x93, 0x12, 0x0, 0xc, 0x19, 0x64, 0x8a, 0xd9, 0xad, 0x9a, 0x3, 0x91, 0x12, 0xad, 0xdc, 0xd6, 0x13, 0x4b, 0x2e, 0x27, 0x0, 0x0, 0x5, 0xb2, 0x22, 0x25, 0xc3, 0x3, 0x0, 0x15, 0x49, 0x8b, 0x4c, 0x3f, 0xc5, 0x4f, 0x47, 0x76, 0x33, 0x9, 0x2a, 0x2c, 0x20, 0x60, 0x4e, 0x8a, 0xf4, 0xce, 0x6b, 0xd3, 0x5c, 0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x81, 0xab, 0x33, 0x17, 0x53, 0x4e};
  lwmqtt_string_t exp_topic = {6, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7a, 0x50, 0x67, 0xd4, 0x7e, 0x66, 0x82, 0xab, 0xe8, 0xf1, 0x50, 0xd4, 0x5, 0x27, 0xea, 0x27, 0x40, 0xb, 0xb1, 0x3b, 0x73, 0x9d, 0x7a, 0x2a, 0x12, 0x7b, 0x94, 0x36, 0x7c};
  lwmqtt_string_t exp_body = {29, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 5903);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 6);
EXPECT_EQ(msg.payload_len, 29);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 29);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "f\145?\ETXkG", _pubPktID = 0, _pubBody = "z)\172\246\137o\201C\144\161\ETX\DC4\243V\SI\136\ETX\223\135V\253\SYN\a\200.", _pubProps = [PropTopicAliasMaximum 31258,PropAssignedClientIdentifier ".\236\244\&2}I\NAK\164\152\251\\\176\&5\244'\245\152YXN\USq\218\249\DC4\SYN\ETX",PropRetainAvailable 81]}
TEST(Publish5QCTest, Encode9) {
uint8_t pkt[] = {0x31, 0x45, 0x0, 0x6, 0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47, 0x23, 0x22, 0x7a, 0x1a, 0x12, 0x0, 0x1b, 0x2e, 0xec, 0xf4, 0x32, 0x7d, 0x49, 0x15, 0xa4, 0x98, 0xfb, 0x5c, 0xb0, 0x35, 0xf4, 0x27, 0xf5, 0x98, 0x59, 0x58, 0x4e, 0x1f, 0x71, 0xda, 0xf9, 0x14, 0x16, 0x3, 0x25, 0x51, 0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
  uint8_t topic_bytes[] = {0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  uint8_t bytesprops0[] = {0x2e, 0xec, 0xf4, 0x32, 0x7d, 0x49, 0x15, 0xa4, 0x98, 0xfb, 0x5c, 0xb0, 0x35, 0xf4, 0x27, 0xf5, 0x98, 0x59, 0x58, 0x4e, 0x1f, 0x71, 0xda, 0xf9, 0x14, 0x16, 0x3};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 31258}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 81}},
  };

  lwmqtt_properties_t props = {3, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "f\145?\ETXkG", _pubPktID = 0, _pubBody = "z)\172\246\137o\201C\144\161\ETX\DC4\243V\SI\136\ETX\223\135V\253\SYN\a\200.", _pubProps = [PropTopicAliasMaximum 31258,PropAssignedClientIdentifier ".\236\244\&2}I\NAK\164\152\251\\\176\&5\244'\245\152YXN\USq\218\249\DC4\SYN\ETX",PropRetainAvailable 81]}
TEST(Publish5QCTest, Decode9) {
uint8_t pkt[] = {0x31, 0x45, 0x0, 0x6, 0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47, 0x23, 0x22, 0x7a, 0x1a, 0x12, 0x0, 0x1b, 0x2e, 0xec, 0xf4, 0x32, 0x7d, 0x49, 0x15, 0xa4, 0x98, 0xfb, 0x5c, 0xb0, 0x35, 0xf4, 0x27, 0xf5, 0x98, 0x59, 0x58, 0x4e, 0x1f, 0x71, 0xda, 0xf9, 0x14, 0x16, 0x3, 0x25, 0x51, 0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x66, 0x91, 0x3f, 0x3, 0x6b, 0x47};
  lwmqtt_string_t exp_topic = {6, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x7a, 0x29, 0xac, 0xf6, 0x89, 0x6f, 0xc9, 0x43, 0x90, 0xa1, 0x3, 0x14, 0xf3, 0x56, 0xf, 0x88, 0x3, 0xdf, 0x87, 0x56, 0xfd, 0x16, 0x7, 0xc8, 0x2e};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 6);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\155rvW\187y*a\164\152\nL\EMg}@\SYN\142\DC2", _pubPktID = 0, _pubBody = "\US\US\DLE\ESC\221J\DC3T\209\207\183rx\202;\229\224\EM\241z#\169X\166\139", _pubProps = [PropServerKeepAlive 6612,PropResponseTopic "\211\178"]}
TEST(Publish5QCTest, Encode10) {
uint8_t pkt[] = {0x39, 0x37, 0x0, 0x13, 0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12, 0x8, 0x13, 0x19, 0xd4, 0x8, 0x0, 0x2, 0xd3, 0xb2, 0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
  uint8_t topic_bytes[] = {0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12};
  lwmqtt_string_t topic = {19, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  uint8_t bytesprops0[] = {0xd3, 0xb2};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 6612}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\155rvW\187y*a\164\152\nL\EMg}@\SYN\142\DC2", _pubPktID = 0, _pubBody = "\US\US\DLE\ESC\221J\DC3T\209\207\183rx\202;\229\224\EM\241z#\169X\166\139", _pubProps = [PropServerKeepAlive 6612,PropResponseTopic "\211\178"]}
TEST(Publish5QCTest, Decode10) {
uint8_t pkt[] = {0x39, 0x37, 0x0, 0x13, 0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12, 0x8, 0x13, 0x19, 0xd4, 0x8, 0x0, 0x2, 0xd3, 0xb2, 0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x9b, 0x72, 0x76, 0x57, 0xbb, 0x79, 0x2a, 0x61, 0xa4, 0x98, 0xa, 0x4c, 0x19, 0x67, 0x7d, 0x40, 0x16, 0x8e, 0x12};
  lwmqtt_string_t exp_topic = {19, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x1f, 0x1f, 0x10, 0x1b, 0xdd, 0x4a, 0x13, 0x54, 0xd1, 0xcf, 0xb7, 0x72, 0x78, 0xca, 0x3b, 0xe5, 0xe0, 0x19, 0xf1, 0x7a, 0x23, 0xa9, 0x58, 0xa6, 0x8b};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 19);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "2n\201\176\229\EM\245*\ACK\SUB\177\b~\130\155,l", _pubPktID = 18294, _pubBody = "22", _pubProps = [PropTopicAlias 1825,PropServerKeepAlive 27568,PropMaximumPacketSize 32649,PropSessionExpiryInterval 12496,PropUserProperty "\191\&8m" "Zj\183\171\&9\190~\166\141\175\\\ACK8>\236\253Sa\DC2qTY\138\GS{w\214",PropReasonString "\SO~\152\246\198\247\169r"]}
TEST(Publish5QCTest, Encode11) {
uint8_t pkt[] = {0x33, 0x56, 0x0, 0x11, 0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c, 0x47, 0x76, 0x3e, 0x23, 0x7, 0x21, 0x13, 0x6b, 0xb0, 0x27, 0x0, 0x0, 0x7f, 0x89, 0x11, 0x0, 0x0, 0x30, 0xd0, 0x26, 0x0, 0x3, 0xbf, 0x38, 0x6d, 0x0, 0x1b, 0x5a, 0x6a, 0xb7, 0xab, 0x39, 0xbe, 0x7e, 0xa6, 0x8d, 0xaf, 0x5c, 0x6, 0x38, 0x3e, 0xec, 0xfd, 0x53, 0x61, 0x12, 0x71, 0x54, 0x59, 0x8a, 0x1d, 0x7b, 0x77, 0xd6, 0x1f, 0x0, 0x8, 0xe, 0x7e, 0x98, 0xf6, 0xc6, 0xf7, 0xa9, 0x72, 0x32, 0x32};
  uint8_t topic_bytes[] = {0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c};
  lwmqtt_string_t topic = {17, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x32, 0x32};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 2;

  uint8_t bytesprops1[] = {0x5a, 0x6a, 0xb7, 0xab, 0x39, 0xbe, 0x7e, 0xa6, 0x8d, 0xaf, 0x5c, 0x6, 0x38, 0x3e, 0xec, 0xfd, 0x53, 0x61, 0x12, 0x71, 0x54, 0x59, 0x8a, 0x1d, 0x7b, 0x77, 0xd6};
  uint8_t bytesprops0[] = {0xbf, 0x38, 0x6d};
  uint8_t bytesprops2[] = {0xe, 0x7e, 0x98, 0xf6, 0xc6, 0xf7, 0xa9, 0x72};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1825}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27568}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32649}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 12496}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={3, (char*)&bytesprops0}, .v={27, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {8, (char*)&bytesprops2}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 18294, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "2n\201\176\229\EM\245*\ACK\SUB\177\b~\130\155,l", _pubPktID = 18294, _pubBody = "22", _pubProps = [PropTopicAlias 1825,PropServerKeepAlive 27568,PropMaximumPacketSize 32649,PropSessionExpiryInterval 12496,PropUserProperty "\191\&8m" "Zj\183\171\&9\190~\166\141\175\\\ACK8>\236\253Sa\DC2qTY\138\GS{w\214",PropReasonString "\SO~\152\246\198\247\169r"]}
TEST(Publish5QCTest, Decode11) {
uint8_t pkt[] = {0x33, 0x56, 0x0, 0x11, 0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c, 0x47, 0x76, 0x3e, 0x23, 0x7, 0x21, 0x13, 0x6b, 0xb0, 0x27, 0x0, 0x0, 0x7f, 0x89, 0x11, 0x0, 0x0, 0x30, 0xd0, 0x26, 0x0, 0x3, 0xbf, 0x38, 0x6d, 0x0, 0x1b, 0x5a, 0x6a, 0xb7, 0xab, 0x39, 0xbe, 0x7e, 0xa6, 0x8d, 0xaf, 0x5c, 0x6, 0x38, 0x3e, 0xec, 0xfd, 0x53, 0x61, 0x12, 0x71, 0x54, 0x59, 0x8a, 0x1d, 0x7b, 0x77, 0xd6, 0x1f, 0x0, 0x8, 0xe, 0x7e, 0x98, 0xf6, 0xc6, 0xf7, 0xa9, 0x72, 0x32, 0x32};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x32, 0x6e, 0xc9, 0xb0, 0xe5, 0x19, 0xf5, 0x2a, 0x6, 0x1a, 0xb1, 0x8, 0x7e, 0x82, 0x9b, 0x2c, 0x6c};
  lwmqtt_string_t exp_topic = {17, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x32, 0x32};
  lwmqtt_string_t exp_body = {2, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 18294);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 17);
EXPECT_EQ(msg.payload_len, 2);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 2);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\SI\221\168J\184\157\208vn\224\GS", _pubPktID = 19130, _pubBody = "=m\162\166\ETX\DEL\SI?\155\155\229\193\RS\194\ETX^\144\196\"\134\199\t\254\147\&1\ESC\221\132", _pubProps = [PropMessageExpiryInterval 10784,PropMaximumPacketSize 27458,PropAssignedClientIdentifier "G$v\235\218\"\220",PropAuthenticationMethod "\133",PropMaximumQoS 124,PropAssignedClientIdentifier "\228\220\169\131\254^\178\229\DC3\141\ESC\188NjB",PropReceiveMaximum 15546,PropSubscriptionIdentifierAvailable 23,PropWillDelayInterval 22707,PropWildcardSubscriptionAvailable 210,PropAssignedClientIdentifier "D3\203.C~\144\185r\v\ESC\211\151|\202\134\199y\b\213\US\135\190",PropAuthenticationMethod "\ETB;\223\&4\n\\M\ESC\188\132",PropAuthenticationData "\158U]a\252o\250\153\140\174\208ZV\205\SYNTw\149",PropMessageExpiryInterval 13702,PropSubscriptionIdentifier 27,PropPayloadFormatIndicator 144,PropWillDelayInterval 18493,PropServerReference "\US=r\ENQZ\174m\240\v%\SYN\186\207\135K",PropTopicAlias 14505,PropSharedSubscriptionAvailable 82,PropReceiveMaximum 19530,PropRequestProblemInformation 56,PropAuthenticationMethod "\150N\SO\230\134$\141\238\132\203P\noE\185YC+\NAKt\SO\158\245\242%X\156h\161\CAN",PropResponseTopic "!t\195\255Ea\140\248\250i\ESCmu\181\195.\241\n\v\147\211\177LtW\162",PropAuthenticationData "\164B\248,\195\GSB\225\242\SI\SO\172\251\220W3J\US\250\161\216\241\212V\223B\218XA",PropAuthenticationMethod "\232\213\&8\166x\STX4\171",PropResponseInformation "\215",PropAuthenticationData "*\170]\135\238\156\238\162\229\213\247\DC1\234G\r\182\200@\207o'",PropResponseInformation "w\SO.\186a\218\208\221*"]}
TEST(Publish5QCTest, Encode12) {
uint8_t pkt[] = {0x3c, 0xdc, 0x2, 0x0, 0xb, 0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d, 0x4a, 0xba, 0xaf, 0x2, 0x2, 0x0, 0x0, 0x2a, 0x20, 0x27, 0x0, 0x0, 0x6b, 0x42, 0x12, 0x0, 0x7, 0x47, 0x24, 0x76, 0xeb, 0xda, 0x22, 0xdc, 0x15, 0x0, 0x1, 0x85, 0x24, 0x7c, 0x12, 0x0, 0xf, 0xe4, 0xdc, 0xa9, 0x83, 0xfe, 0x5e, 0xb2, 0xe5, 0x13, 0x8d, 0x1b, 0xbc, 0x4e, 0x6a, 0x42, 0x21, 0x3c, 0xba, 0x29, 0x17, 0x18, 0x0, 0x0, 0x58, 0xb3, 0x28, 0xd2, 0x12, 0x0, 0x17, 0x44, 0x33, 0xcb, 0x2e, 0x43, 0x7e, 0x90, 0xb9, 0x72, 0xb, 0x1b, 0xd3, 0x97, 0x7c, 0xca, 0x86, 0xc7, 0x79, 0x8, 0xd5, 0x1f, 0x87, 0xbe, 0x15, 0x0, 0xa, 0x17, 0x3b, 0xdf, 0x34, 0xa, 0x5c, 0x4d, 0x1b, 0xbc, 0x84, 0x16, 0x0, 0x12, 0x9e, 0x55, 0x5d, 0x61, 0xfc, 0x6f, 0xfa, 0x99, 0x8c, 0xae, 0xd0, 0x5a, 0x56, 0xcd, 0x16, 0x54, 0x77, 0x95, 0x2, 0x0, 0x0, 0x35, 0x86, 0xb, 0x1b, 0x1, 0x90, 0x18, 0x0, 0x0, 0x48, 0x3d, 0x1c, 0x0, 0xf, 0x1f, 0x3d, 0x72, 0x5, 0x5a, 0xae, 0x6d, 0xf0, 0xb, 0x25, 0x16, 0xba, 0xcf, 0x87, 0x4b, 0x23, 0x38, 0xa9, 0x2a, 0x52, 0x21, 0x4c, 0x4a, 0x17, 0x38, 0x15, 0x0, 0x1e, 0x96, 0x4e, 0xe, 0xe6, 0x86, 0x24, 0x8d, 0xee, 0x84, 0xcb, 0x50, 0xa, 0x6f, 0x45, 0xb9, 0x59, 0x43, 0x2b, 0x15, 0x74, 0xe, 0x9e, 0xf5, 0xf2, 0x25, 0x58, 0x9c, 0x68, 0xa1, 0x18, 0x8, 0x0, 0x1a, 0x21, 0x74, 0xc3, 0xff, 0x45, 0x61, 0x8c, 0xf8, 0xfa, 0x69, 0x1b, 0x6d, 0x75, 0xb5, 0xc3, 0x2e, 0xf1, 0xa, 0xb, 0x93, 0xd3, 0xb1, 0x4c, 0x74, 0x57, 0xa2, 0x16, 0x0, 0x1d, 0xa4, 0x42, 0xf8, 0x2c, 0xc3, 0x1d, 0x42, 0xe1, 0xf2, 0xf, 0xe, 0xac, 0xfb, 0xdc, 0x57, 0x33, 0x4a, 0x1f, 0xfa, 0xa1, 0xd8, 0xf1, 0xd4, 0x56, 0xdf, 0x42, 0xda, 0x58, 0x41, 0x15, 0x0, 0x8, 0xe8, 0xd5, 0x38, 0xa6, 0x78, 0x2, 0x34, 0xab, 0x1a, 0x0, 0x1, 0xd7, 0x16, 0x0, 0x15, 0x2a, 0xaa, 0x5d, 0x87, 0xee, 0x9c, 0xee, 0xa2, 0xe5, 0xd5, 0xf7, 0x11, 0xea, 0x47, 0xd, 0xb6, 0xc8, 0x40, 0xcf, 0x6f, 0x27, 0x1a, 0x0, 0x9, 0x77, 0xe, 0x2e, 0xba, 0x61, 0xda, 0xd0, 0xdd, 0x2a, 0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
  uint8_t topic_bytes[] = {0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d};
  lwmqtt_string_t topic = {11, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 28;

  uint8_t bytesprops0[] = {0x47, 0x24, 0x76, 0xeb, 0xda, 0x22, 0xdc};
  uint8_t bytesprops1[] = {0x85};
  uint8_t bytesprops2[] = {0xe4, 0xdc, 0xa9, 0x83, 0xfe, 0x5e, 0xb2, 0xe5, 0x13, 0x8d, 0x1b, 0xbc, 0x4e, 0x6a, 0x42};
  uint8_t bytesprops3[] = {0x44, 0x33, 0xcb, 0x2e, 0x43, 0x7e, 0x90, 0xb9, 0x72, 0xb, 0x1b, 0xd3, 0x97, 0x7c, 0xca, 0x86, 0xc7, 0x79, 0x8, 0xd5, 0x1f, 0x87, 0xbe};
  uint8_t bytesprops4[] = {0x17, 0x3b, 0xdf, 0x34, 0xa, 0x5c, 0x4d, 0x1b, 0xbc, 0x84};
  uint8_t bytesprops5[] = {0x9e, 0x55, 0x5d, 0x61, 0xfc, 0x6f, 0xfa, 0x99, 0x8c, 0xae, 0xd0, 0x5a, 0x56, 0xcd, 0x16, 0x54, 0x77, 0x95};
  uint8_t bytesprops6[] = {0x1f, 0x3d, 0x72, 0x5, 0x5a, 0xae, 0x6d, 0xf0, 0xb, 0x25, 0x16, 0xba, 0xcf, 0x87, 0x4b};
  uint8_t bytesprops7[] = {0x96, 0x4e, 0xe, 0xe6, 0x86, 0x24, 0x8d, 0xee, 0x84, 0xcb, 0x50, 0xa, 0x6f, 0x45, 0xb9, 0x59, 0x43, 0x2b, 0x15, 0x74, 0xe, 0x9e, 0xf5, 0xf2, 0x25, 0x58, 0x9c, 0x68, 0xa1, 0x18};
  uint8_t bytesprops8[] = {0x21, 0x74, 0xc3, 0xff, 0x45, 0x61, 0x8c, 0xf8, 0xfa, 0x69, 0x1b, 0x6d, 0x75, 0xb5, 0xc3, 0x2e, 0xf1, 0xa, 0xb, 0x93, 0xd3, 0xb1, 0x4c, 0x74, 0x57, 0xa2};
  uint8_t bytesprops9[] = {0xa4, 0x42, 0xf8, 0x2c, 0xc3, 0x1d, 0x42, 0xe1, 0xf2, 0xf, 0xe, 0xac, 0xfb, 0xdc, 0x57, 0x33, 0x4a, 0x1f, 0xfa, 0xa1, 0xd8, 0xf1, 0xd4, 0x56, 0xdf, 0x42, 0xda, 0x58, 0x41};
  uint8_t bytesprops10[] = {0xe8, 0xd5, 0x38, 0xa6, 0x78, 0x2, 0x34, 0xab};
  uint8_t bytesprops11[] = {0xd7};
  uint8_t bytesprops12[] = {0x2a, 0xaa, 0x5d, 0x87, 0xee, 0x9c, 0xee, 0xa2, 0xe5, 0xd5, 0xf7, 0x11, 0xea, 0x47, 0xd, 0xb6, 0xc8, 0x40, 0xcf, 0x6f, 0x27};
  uint8_t bytesprops13[] = {0x77, 0xe, 0x2e, 0xba, 0x61, 0xda, 0xd0, 0xdd, 0x2a};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10784}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27458}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {7, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {1, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 124}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15546}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 23}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 22707}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {23, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13702}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 27}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 144}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18493}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {15, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14505}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 82}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19530}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 56}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {30, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {26, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {21, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {9, (char*)&bytesprops13}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 19130, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\SI\221\168J\184\157\208vn\224\GS", _pubPktID = 19130, _pubBody = "=m\162\166\ETX\DEL\SI?\155\155\229\193\RS\194\ETX^\144\196\"\134\199\t\254\147\&1\ESC\221\132", _pubProps = [PropMessageExpiryInterval 10784,PropMaximumPacketSize 27458,PropAssignedClientIdentifier "G$v\235\218\"\220",PropAuthenticationMethod "\133",PropMaximumQoS 124,PropAssignedClientIdentifier "\228\220\169\131\254^\178\229\DC3\141\ESC\188NjB",PropReceiveMaximum 15546,PropSubscriptionIdentifierAvailable 23,PropWillDelayInterval 22707,PropWildcardSubscriptionAvailable 210,PropAssignedClientIdentifier "D3\203.C~\144\185r\v\ESC\211\151|\202\134\199y\b\213\US\135\190",PropAuthenticationMethod "\ETB;\223\&4\n\\M\ESC\188\132",PropAuthenticationData "\158U]a\252o\250\153\140\174\208ZV\205\SYNTw\149",PropMessageExpiryInterval 13702,PropSubscriptionIdentifier 27,PropPayloadFormatIndicator 144,PropWillDelayInterval 18493,PropServerReference "\US=r\ENQZ\174m\240\v%\SYN\186\207\135K",PropTopicAlias 14505,PropSharedSubscriptionAvailable 82,PropReceiveMaximum 19530,PropRequestProblemInformation 56,PropAuthenticationMethod "\150N\SO\230\134$\141\238\132\203P\noE\185YC+\NAKt\SO\158\245\242%X\156h\161\CAN",PropResponseTopic "!t\195\255Ea\140\248\250i\ESCmu\181\195.\241\n\v\147\211\177LtW\162",PropAuthenticationData "\164B\248,\195\GSB\225\242\SI\SO\172\251\220W3J\US\250\161\216\241\212V\223B\218XA",PropAuthenticationMethod "\232\213\&8\166x\STX4\171",PropResponseInformation "\215",PropAuthenticationData "*\170]\135\238\156\238\162\229\213\247\DC1\234G\r\182\200@\207o'",PropResponseInformation "w\SO.\186a\218\208\221*"]}
TEST(Publish5QCTest, Decode12) {
uint8_t pkt[] = {0x3c, 0xdc, 0x2, 0x0, 0xb, 0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d, 0x4a, 0xba, 0xaf, 0x2, 0x2, 0x0, 0x0, 0x2a, 0x20, 0x27, 0x0, 0x0, 0x6b, 0x42, 0x12, 0x0, 0x7, 0x47, 0x24, 0x76, 0xeb, 0xda, 0x22, 0xdc, 0x15, 0x0, 0x1, 0x85, 0x24, 0x7c, 0x12, 0x0, 0xf, 0xe4, 0xdc, 0xa9, 0x83, 0xfe, 0x5e, 0xb2, 0xe5, 0x13, 0x8d, 0x1b, 0xbc, 0x4e, 0x6a, 0x42, 0x21, 0x3c, 0xba, 0x29, 0x17, 0x18, 0x0, 0x0, 0x58, 0xb3, 0x28, 0xd2, 0x12, 0x0, 0x17, 0x44, 0x33, 0xcb, 0x2e, 0x43, 0x7e, 0x90, 0xb9, 0x72, 0xb, 0x1b, 0xd3, 0x97, 0x7c, 0xca, 0x86, 0xc7, 0x79, 0x8, 0xd5, 0x1f, 0x87, 0xbe, 0x15, 0x0, 0xa, 0x17, 0x3b, 0xdf, 0x34, 0xa, 0x5c, 0x4d, 0x1b, 0xbc, 0x84, 0x16, 0x0, 0x12, 0x9e, 0x55, 0x5d, 0x61, 0xfc, 0x6f, 0xfa, 0x99, 0x8c, 0xae, 0xd0, 0x5a, 0x56, 0xcd, 0x16, 0x54, 0x77, 0x95, 0x2, 0x0, 0x0, 0x35, 0x86, 0xb, 0x1b, 0x1, 0x90, 0x18, 0x0, 0x0, 0x48, 0x3d, 0x1c, 0x0, 0xf, 0x1f, 0x3d, 0x72, 0x5, 0x5a, 0xae, 0x6d, 0xf0, 0xb, 0x25, 0x16, 0xba, 0xcf, 0x87, 0x4b, 0x23, 0x38, 0xa9, 0x2a, 0x52, 0x21, 0x4c, 0x4a, 0x17, 0x38, 0x15, 0x0, 0x1e, 0x96, 0x4e, 0xe, 0xe6, 0x86, 0x24, 0x8d, 0xee, 0x84, 0xcb, 0x50, 0xa, 0x6f, 0x45, 0xb9, 0x59, 0x43, 0x2b, 0x15, 0x74, 0xe, 0x9e, 0xf5, 0xf2, 0x25, 0x58, 0x9c, 0x68, 0xa1, 0x18, 0x8, 0x0, 0x1a, 0x21, 0x74, 0xc3, 0xff, 0x45, 0x61, 0x8c, 0xf8, 0xfa, 0x69, 0x1b, 0x6d, 0x75, 0xb5, 0xc3, 0x2e, 0xf1, 0xa, 0xb, 0x93, 0xd3, 0xb1, 0x4c, 0x74, 0x57, 0xa2, 0x16, 0x0, 0x1d, 0xa4, 0x42, 0xf8, 0x2c, 0xc3, 0x1d, 0x42, 0xe1, 0xf2, 0xf, 0xe, 0xac, 0xfb, 0xdc, 0x57, 0x33, 0x4a, 0x1f, 0xfa, 0xa1, 0xd8, 0xf1, 0xd4, 0x56, 0xdf, 0x42, 0xda, 0x58, 0x41, 0x15, 0x0, 0x8, 0xe8, 0xd5, 0x38, 0xa6, 0x78, 0x2, 0x34, 0xab, 0x1a, 0x0, 0x1, 0xd7, 0x16, 0x0, 0x15, 0x2a, 0xaa, 0x5d, 0x87, 0xee, 0x9c, 0xee, 0xa2, 0xe5, 0xd5, 0xf7, 0x11, 0xea, 0x47, 0xd, 0xb6, 0xc8, 0x40, 0xcf, 0x6f, 0x27, 0x1a, 0x0, 0x9, 0x77, 0xe, 0x2e, 0xba, 0x61, 0xda, 0xd0, 0xdd, 0x2a, 0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xf, 0xdd, 0xa8, 0x4a, 0xb8, 0x9d, 0xd0, 0x76, 0x6e, 0xe0, 0x1d};
  lwmqtt_string_t exp_topic = {11, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x3d, 0x6d, 0xa2, 0xa6, 0x3, 0x7f, 0xf, 0x3f, 0x9b, 0x9b, 0xe5, 0xc1, 0x1e, 0xc2, 0x3, 0x5e, 0x90, 0xc4, 0x22, 0x86, 0xc7, 0x9, 0xfe, 0x93, 0x31, 0x1b, 0xdd, 0x84};
  lwmqtt_string_t exp_body = {28, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 19130);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 11);
EXPECT_EQ(msg.payload_len, 28);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 28);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\n\159\143\162\210", _pubPktID = 3591, _pubBody = "\156|7\ETB|\195\202\&4y", _pubProps = [PropTopicAlias 16866,PropPayloadFormatIndicator 161,PropWillDelayInterval 10125,PropTopicAliasMaximum 9943,PropAssignedClientIdentifier "\166}b\131\251\SI\238\142;\227K\136T\135V\247\161",PropUserProperty "" "\US&\214kE\128q\201\193`7",PropSubscriptionIdentifier 14,PropServerReference "\STXg4\v~\SYN",PropContentType "\180\GS\161\&3\158\249",PropContentType "s+\137|8\r'&\231D=7\234F\240UP\250Q\249\223xm",PropSharedSubscriptionAvailable 120,PropRetainAvailable 148,PropReceiveMaximum 21370,PropReceiveMaximum 15880,PropCorrelationData "\SYN\145\218\133",PropMaximumQoS 249,PropRetainAvailable 68,PropServerReference "\214\163?X\208\137\tL\204\249\150\193\138C\US\223\167\247\232=",PropWildcardSubscriptionAvailable 42,PropMessageExpiryInterval 15417,PropCorrelationData "\234\150\202\&8\208(\204\142&\190$|\SYNgY@\221\162\164",PropTopicAliasMaximum 15741,PropContentType "Yvww",PropSessionExpiryInterval 32202,PropPayloadFormatIndicator 229,PropResponseInformation "\164"]}
TEST(Publish5QCTest, Encode13) {
uint8_t pkt[] = {0x32, 0xd1, 0x1, 0x0, 0x5, 0xa, 0x9f, 0x8f, 0xa2, 0xd2, 0xe, 0x7, 0xbd, 0x1, 0x23, 0x41, 0xe2, 0x1, 0xa1, 0x18, 0x0, 0x0, 0x27, 0x8d, 0x22, 0x26, 0xd7, 0x12, 0x0, 0x11, 0xa6, 0x7d, 0x62, 0x83, 0xfb, 0xf, 0xee, 0x8e, 0x3b, 0xe3, 0x4b, 0x88, 0x54, 0x87, 0x56, 0xf7, 0xa1, 0x26, 0x0, 0x0, 0x0, 0xb, 0x1f, 0x26, 0xd6, 0x6b, 0x45, 0x80, 0x71, 0xc9, 0xc1, 0x60, 0x37, 0xb, 0xe, 0x1c, 0x0, 0x6, 0x2, 0x67, 0x34, 0xb, 0x7e, 0x16, 0x3, 0x0, 0x6, 0xb4, 0x1d, 0xa1, 0x33, 0x9e, 0xf9, 0x3, 0x0, 0x17, 0x73, 0x2b, 0x89, 0x7c, 0x38, 0xd, 0x27, 0x26, 0xe7, 0x44, 0x3d, 0x37, 0xea, 0x46, 0xf0, 0x55, 0x50, 0xfa, 0x51, 0xf9, 0xdf, 0x78, 0x6d, 0x2a, 0x78, 0x25, 0x94, 0x21, 0x53, 0x7a, 0x21, 0x3e, 0x8, 0x9, 0x0, 0x4, 0x16, 0x91, 0xda, 0x85, 0x24, 0xf9, 0x25, 0x44, 0x1c, 0x0, 0x14, 0xd6, 0xa3, 0x3f, 0x58, 0xd0, 0x89, 0x9, 0x4c, 0xcc, 0xf9, 0x96, 0xc1, 0x8a, 0x43, 0x1f, 0xdf, 0xa7, 0xf7, 0xe8, 0x3d, 0x28, 0x2a, 0x2, 0x0, 0x0, 0x3c, 0x39, 0x9, 0x0, 0x13, 0xea, 0x96, 0xca, 0x38, 0xd0, 0x28, 0xcc, 0x8e, 0x26, 0xbe, 0x24, 0x7c, 0x16, 0x67, 0x59, 0x40, 0xdd, 0xa2, 0xa4, 0x22, 0x3d, 0x7d, 0x3, 0x0, 0x4, 0x59, 0x76, 0x77, 0x77, 0x11, 0x0, 0x0, 0x7d, 0xca, 0x1, 0xe5, 0x1a, 0x0, 0x1, 0xa4, 0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
  uint8_t topic_bytes[] = {0xa, 0x9f, 0x8f, 0xa2, 0xd2};
  lwmqtt_string_t topic = {5, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 9;

  uint8_t bytesprops0[] = {0xa6, 0x7d, 0x62, 0x83, 0xfb, 0xf, 0xee, 0x8e, 0x3b, 0xe3, 0x4b, 0x88, 0x54, 0x87, 0x56, 0xf7, 0xa1};
  uint8_t bytesprops2[] = {0x1f, 0x26, 0xd6, 0x6b, 0x45, 0x80, 0x71, 0xc9, 0xc1, 0x60, 0x37};
  uint8_t bytesprops1[] = {0};
  uint8_t bytesprops3[] = {0x2, 0x67, 0x34, 0xb, 0x7e, 0x16};
  uint8_t bytesprops4[] = {0xb4, 0x1d, 0xa1, 0x33, 0x9e, 0xf9};
  uint8_t bytesprops5[] = {0x73, 0x2b, 0x89, 0x7c, 0x38, 0xd, 0x27, 0x26, 0xe7, 0x44, 0x3d, 0x37, 0xea, 0x46, 0xf0, 0x55, 0x50, 0xfa, 0x51, 0xf9, 0xdf, 0x78, 0x6d};
  uint8_t bytesprops6[] = {0x16, 0x91, 0xda, 0x85};
  uint8_t bytesprops7[] = {0xd6, 0xa3, 0x3f, 0x58, 0xd0, 0x89, 0x9, 0x4c, 0xcc, 0xf9, 0x96, 0xc1, 0x8a, 0x43, 0x1f, 0xdf, 0xa7, 0xf7, 0xe8, 0x3d};
  uint8_t bytesprops8[] = {0xea, 0x96, 0xca, 0x38, 0xd0, 0x28, 0xcc, 0x8e, 0x26, 0xbe, 0x24, 0x7c, 0x16, 0x67, 0x59, 0x40, 0xdd, 0xa2, 0xa4};
  uint8_t bytesprops9[] = {0x59, 0x76, 0x77, 0x77};
  uint8_t bytesprops10[] = {0xa4};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 16866}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 161}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 10125}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 9943}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={0, (char*)&bytesprops1}, .v={11, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 14}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 120}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 148}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 21370}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15880}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 249}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 68}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {20, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15417}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 15741}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {4, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 32202}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 229}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 3591, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\n\159\143\162\210", _pubPktID = 3591, _pubBody = "\156|7\ETB|\195\202\&4y", _pubProps = [PropTopicAlias 16866,PropPayloadFormatIndicator 161,PropWillDelayInterval 10125,PropTopicAliasMaximum 9943,PropAssignedClientIdentifier "\166}b\131\251\SI\238\142;\227K\136T\135V\247\161",PropUserProperty "" "\US&\214kE\128q\201\193`7",PropSubscriptionIdentifier 14,PropServerReference "\STXg4\v~\SYN",PropContentType "\180\GS\161\&3\158\249",PropContentType "s+\137|8\r'&\231D=7\234F\240UP\250Q\249\223xm",PropSharedSubscriptionAvailable 120,PropRetainAvailable 148,PropReceiveMaximum 21370,PropReceiveMaximum 15880,PropCorrelationData "\SYN\145\218\133",PropMaximumQoS 249,PropRetainAvailable 68,PropServerReference "\214\163?X\208\137\tL\204\249\150\193\138C\US\223\167\247\232=",PropWildcardSubscriptionAvailable 42,PropMessageExpiryInterval 15417,PropCorrelationData "\234\150\202\&8\208(\204\142&\190$|\SYNgY@\221\162\164",PropTopicAliasMaximum 15741,PropContentType "Yvww",PropSessionExpiryInterval 32202,PropPayloadFormatIndicator 229,PropResponseInformation "\164"]}
TEST(Publish5QCTest, Decode13) {
uint8_t pkt[] = {0x32, 0xd1, 0x1, 0x0, 0x5, 0xa, 0x9f, 0x8f, 0xa2, 0xd2, 0xe, 0x7, 0xbd, 0x1, 0x23, 0x41, 0xe2, 0x1, 0xa1, 0x18, 0x0, 0x0, 0x27, 0x8d, 0x22, 0x26, 0xd7, 0x12, 0x0, 0x11, 0xa6, 0x7d, 0x62, 0x83, 0xfb, 0xf, 0xee, 0x8e, 0x3b, 0xe3, 0x4b, 0x88, 0x54, 0x87, 0x56, 0xf7, 0xa1, 0x26, 0x0, 0x0, 0x0, 0xb, 0x1f, 0x26, 0xd6, 0x6b, 0x45, 0x80, 0x71, 0xc9, 0xc1, 0x60, 0x37, 0xb, 0xe, 0x1c, 0x0, 0x6, 0x2, 0x67, 0x34, 0xb, 0x7e, 0x16, 0x3, 0x0, 0x6, 0xb4, 0x1d, 0xa1, 0x33, 0x9e, 0xf9, 0x3, 0x0, 0x17, 0x73, 0x2b, 0x89, 0x7c, 0x38, 0xd, 0x27, 0x26, 0xe7, 0x44, 0x3d, 0x37, 0xea, 0x46, 0xf0, 0x55, 0x50, 0xfa, 0x51, 0xf9, 0xdf, 0x78, 0x6d, 0x2a, 0x78, 0x25, 0x94, 0x21, 0x53, 0x7a, 0x21, 0x3e, 0x8, 0x9, 0x0, 0x4, 0x16, 0x91, 0xda, 0x85, 0x24, 0xf9, 0x25, 0x44, 0x1c, 0x0, 0x14, 0xd6, 0xa3, 0x3f, 0x58, 0xd0, 0x89, 0x9, 0x4c, 0xcc, 0xf9, 0x96, 0xc1, 0x8a, 0x43, 0x1f, 0xdf, 0xa7, 0xf7, 0xe8, 0x3d, 0x28, 0x2a, 0x2, 0x0, 0x0, 0x3c, 0x39, 0x9, 0x0, 0x13, 0xea, 0x96, 0xca, 0x38, 0xd0, 0x28, 0xcc, 0x8e, 0x26, 0xbe, 0x24, 0x7c, 0x16, 0x67, 0x59, 0x40, 0xdd, 0xa2, 0xa4, 0x22, 0x3d, 0x7d, 0x3, 0x0, 0x4, 0x59, 0x76, 0x77, 0x77, 0x11, 0x0, 0x0, 0x7d, 0xca, 0x1, 0xe5, 0x1a, 0x0, 0x1, 0xa4, 0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xa, 0x9f, 0x8f, 0xa2, 0xd2};
  lwmqtt_string_t exp_topic = {5, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x9c, 0x7c, 0x37, 0x17, 0x7c, 0xc3, 0xca, 0x34, 0x79};
  lwmqtt_string_t exp_body = {9, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 3591);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 5);
EXPECT_EQ(msg.payload_len, 9);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 9);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\158\ESC\165s\240j\195I_\176\246\204\148I\213T\244\169E", _pubPktID = 15997, _pubBody = "tS\247\226P\227\&3\NUL\222\DC37I\219'", _pubProps = [PropAuthenticationData "Z\144(\SO\168[T\179\224`}&\140\218\195",PropSubscriptionIdentifier 18,PropContentType "`.\177\&6C)4\240\226\GS\ENQ\135J\160=]]\EOT9\153\204/,\212L\129\248O",PropAuthenticationData "\188U\232\SUB\163\151;\177Z\222\t\STX\131]\245\158\&6Y\140",PropTopicAlias 6708,PropReceiveMaximum 12966,PropMaximumQoS 54,PropServerReference "o\180B;\169\150\161\FS\DC2jtr\154\150",PropAuthenticationData "V\138\t\160\208\SYN\DEL@\137\181Iz\238\240\US\213\205\212",PropWildcardSubscriptionAvailable 32,PropRequestProblemInformation 34,PropSubscriptionIdentifierAvailable 138]}
TEST(Publish5QCTest, Encode14) {
uint8_t pkt[] = {0x33, 0xa3, 0x1, 0x0, 0x13, 0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45, 0x3e, 0x7d, 0x7d, 0x16, 0x0, 0xf, 0x5a, 0x90, 0x28, 0xe, 0xa8, 0x5b, 0x54, 0xb3, 0xe0, 0x60, 0x7d, 0x26, 0x8c, 0xda, 0xc3, 0xb, 0x12, 0x3, 0x0, 0x1c, 0x60, 0x2e, 0xb1, 0x36, 0x43, 0x29, 0x34, 0xf0, 0xe2, 0x1d, 0x5, 0x87, 0x4a, 0xa0, 0x3d, 0x5d, 0x5d, 0x4, 0x39, 0x99, 0xcc, 0x2f, 0x2c, 0xd4, 0x4c, 0x81, 0xf8, 0x4f, 0x16, 0x0, 0x13, 0xbc, 0x55, 0xe8, 0x1a, 0xa3, 0x97, 0x3b, 0xb1, 0x5a, 0xde, 0x9, 0x2, 0x83, 0x5d, 0xf5, 0x9e, 0x36, 0x59, 0x8c, 0x23, 0x1a, 0x34, 0x21, 0x32, 0xa6, 0x24, 0x36, 0x1c, 0x0, 0xe, 0x6f, 0xb4, 0x42, 0x3b, 0xa9, 0x96, 0xa1, 0x1c, 0x12, 0x6a, 0x74, 0x72, 0x9a, 0x96, 0x16, 0x0, 0x12, 0x56, 0x8a, 0x9, 0xa0, 0xd0, 0x16, 0x7f, 0x40, 0x89, 0xb5, 0x49, 0x7a, 0xee, 0xf0, 0x1f, 0xd5, 0xcd, 0xd4, 0x28, 0x20, 0x17, 0x22, 0x29, 0x8a, 0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
  uint8_t topic_bytes[] = {0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45};
  lwmqtt_string_t topic = {19, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 14;

  uint8_t bytesprops0[] = {0x5a, 0x90, 0x28, 0xe, 0xa8, 0x5b, 0x54, 0xb3, 0xe0, 0x60, 0x7d, 0x26, 0x8c, 0xda, 0xc3};
  uint8_t bytesprops1[] = {0x60, 0x2e, 0xb1, 0x36, 0x43, 0x29, 0x34, 0xf0, 0xe2, 0x1d, 0x5, 0x87, 0x4a, 0xa0, 0x3d, 0x5d, 0x5d, 0x4, 0x39, 0x99, 0xcc, 0x2f, 0x2c, 0xd4, 0x4c, 0x81, 0xf8, 0x4f};
  uint8_t bytesprops2[] = {0xbc, 0x55, 0xe8, 0x1a, 0xa3, 0x97, 0x3b, 0xb1, 0x5a, 0xde, 0x9, 0x2, 0x83, 0x5d, 0xf5, 0x9e, 0x36, 0x59, 0x8c};
  uint8_t bytesprops3[] = {0x6f, 0xb4, 0x42, 0x3b, 0xa9, 0x96, 0xa1, 0x1c, 0x12, 0x6a, 0x74, 0x72, 0x9a, 0x96};
  uint8_t bytesprops4[] = {0x56, 0x8a, 0x9, 0xa0, 0xd0, 0x16, 0x7f, 0x40, 0x89, 0xb5, 0x49, 0x7a, 0xee, 0xf0, 0x1f, 0xd5, 0xcd, 0xd4};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {15, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 18}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6708}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 12966}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {14, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 32}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 34}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 138}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 15997, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\158\ESC\165s\240j\195I_\176\246\204\148I\213T\244\169E", _pubPktID = 15997, _pubBody = "tS\247\226P\227\&3\NUL\222\DC37I\219'", _pubProps = [PropAuthenticationData "Z\144(\SO\168[T\179\224`}&\140\218\195",PropSubscriptionIdentifier 18,PropContentType "`.\177\&6C)4\240\226\GS\ENQ\135J\160=]]\EOT9\153\204/,\212L\129\248O",PropAuthenticationData "\188U\232\SUB\163\151;\177Z\222\t\STX\131]\245\158\&6Y\140",PropTopicAlias 6708,PropReceiveMaximum 12966,PropMaximumQoS 54,PropServerReference "o\180B;\169\150\161\FS\DC2jtr\154\150",PropAuthenticationData "V\138\t\160\208\SYN\DEL@\137\181Iz\238\240\US\213\205\212",PropWildcardSubscriptionAvailable 32,PropRequestProblemInformation 34,PropSubscriptionIdentifierAvailable 138]}
TEST(Publish5QCTest, Decode14) {
uint8_t pkt[] = {0x33, 0xa3, 0x1, 0x0, 0x13, 0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45, 0x3e, 0x7d, 0x7d, 0x16, 0x0, 0xf, 0x5a, 0x90, 0x28, 0xe, 0xa8, 0x5b, 0x54, 0xb3, 0xe0, 0x60, 0x7d, 0x26, 0x8c, 0xda, 0xc3, 0xb, 0x12, 0x3, 0x0, 0x1c, 0x60, 0x2e, 0xb1, 0x36, 0x43, 0x29, 0x34, 0xf0, 0xe2, 0x1d, 0x5, 0x87, 0x4a, 0xa0, 0x3d, 0x5d, 0x5d, 0x4, 0x39, 0x99, 0xcc, 0x2f, 0x2c, 0xd4, 0x4c, 0x81, 0xf8, 0x4f, 0x16, 0x0, 0x13, 0xbc, 0x55, 0xe8, 0x1a, 0xa3, 0x97, 0x3b, 0xb1, 0x5a, 0xde, 0x9, 0x2, 0x83, 0x5d, 0xf5, 0x9e, 0x36, 0x59, 0x8c, 0x23, 0x1a, 0x34, 0x21, 0x32, 0xa6, 0x24, 0x36, 0x1c, 0x0, 0xe, 0x6f, 0xb4, 0x42, 0x3b, 0xa9, 0x96, 0xa1, 0x1c, 0x12, 0x6a, 0x74, 0x72, 0x9a, 0x96, 0x16, 0x0, 0x12, 0x56, 0x8a, 0x9, 0xa0, 0xd0, 0x16, 0x7f, 0x40, 0x89, 0xb5, 0x49, 0x7a, 0xee, 0xf0, 0x1f, 0xd5, 0xcd, 0xd4, 0x28, 0x20, 0x17, 0x22, 0x29, 0x8a, 0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x9e, 0x1b, 0xa5, 0x73, 0xf0, 0x6a, 0xc3, 0x49, 0x5f, 0xb0, 0xf6, 0xcc, 0x94, 0x49, 0xd5, 0x54, 0xf4, 0xa9, 0x45};
  lwmqtt_string_t exp_topic = {19, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x74, 0x53, 0xf7, 0xe2, 0x50, 0xe3, 0x33, 0x0, 0xde, 0x13, 0x37, 0x49, 0xdb, 0x27};
  lwmqtt_string_t exp_body = {14, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 15997);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 19);
EXPECT_EQ(msg.payload_len, 14);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 14);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\233\224\135\179\172\244\254\241]\218|\ESC\137/", _pubPktID = 30908, _pubBody = "\235c=\156\"\206\185spp`\235\216", _pubProps = [PropMessageExpiryInterval 6037,PropWillDelayInterval 28652,PropCorrelationData "\244zO@\192\189\&3)\US\177*\173\142\ENQ\144\218'\172\ETX\180O\DC3\156\205\206",PropSessionExpiryInterval 8920,PropWillDelayInterval 5875,PropSubscriptionIdentifier 9,PropReasonString "\166g\238\&9\US\DC2F\192dH\254\182\146\254",PropTopicAlias 32438,PropMessageExpiryInterval 10202,PropSubscriptionIdentifierAvailable 253,PropContentType "/\227\214\211",PropReasonString "K\182N",PropTopicAlias 10419,PropMessageExpiryInterval 18017,PropSubscriptionIdentifierAvailable 65,PropWillDelayInterval 743,PropRequestProblemInformation 232,PropSubscriptionIdentifierAvailable 126,PropRetainAvailable 132,PropRequestResponseInformation 184,PropReceiveMaximum 25871,PropMessageExpiryInterval 21303,PropCorrelationData "\211L\234\251\NAKtw\ETB\206L\157\190\244?2%\157",PropServerReference "\232T\205?\234\b\US{6\141\173\CAN(\GS\175/\238^\224\159R\244\130\208\202E",PropTopicAlias 15782,PropSharedSubscriptionAvailable 56]}
TEST(Publish5QCTest, Encode15) {
uint8_t pkt[] = {0x32, 0xd0, 0x1, 0x0, 0xe, 0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f, 0x78, 0xbc, 0xaf, 0x1, 0x2, 0x0, 0x0, 0x17, 0x95, 0x18, 0x0, 0x0, 0x6f, 0xec, 0x9, 0x0, 0x19, 0xf4, 0x7a, 0x4f, 0x40, 0xc0, 0xbd, 0x33, 0x29, 0x1f, 0xb1, 0x2a, 0xad, 0x8e, 0x5, 0x90, 0xda, 0x27, 0xac, 0x3, 0xb4, 0x4f, 0x13, 0x9c, 0xcd, 0xce, 0x11, 0x0, 0x0, 0x22, 0xd8, 0x18, 0x0, 0x0, 0x16, 0xf3, 0xb, 0x9, 0x1f, 0x0, 0xe, 0xa6, 0x67, 0xee, 0x39, 0x1f, 0x12, 0x46, 0xc0, 0x64, 0x48, 0xfe, 0xb6, 0x92, 0xfe, 0x23, 0x7e, 0xb6, 0x2, 0x0, 0x0, 0x27, 0xda, 0x29, 0xfd, 0x3, 0x0, 0x4, 0x2f, 0xe3, 0xd6, 0xd3, 0x1f, 0x0, 0x3, 0x4b, 0xb6, 0x4e, 0x23, 0x28, 0xb3, 0x2, 0x0, 0x0, 0x46, 0x61, 0x29, 0x41, 0x18, 0x0, 0x0, 0x2, 0xe7, 0x17, 0xe8, 0x29, 0x7e, 0x25, 0x84, 0x19, 0xb8, 0x21, 0x65, 0xf, 0x2, 0x0, 0x0, 0x53, 0x37, 0x9, 0x0, 0x11, 0xd3, 0x4c, 0xea, 0xfb, 0x15, 0x74, 0x77, 0x17, 0xce, 0x4c, 0x9d, 0xbe, 0xf4, 0x3f, 0x32, 0x25, 0x9d, 0x1c, 0x0, 0x1a, 0xe8, 0x54, 0xcd, 0x3f, 0xea, 0x8, 0x1f, 0x7b, 0x36, 0x8d, 0xad, 0x18, 0x28, 0x1d, 0xaf, 0x2f, 0xee, 0x5e, 0xe0, 0x9f, 0x52, 0xf4, 0x82, 0xd0, 0xca, 0x45, 0x23, 0x3d, 0xa6, 0x2a, 0x38, 0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
  uint8_t topic_bytes[] = {0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f};
  lwmqtt_string_t topic = {14, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  uint8_t bytesprops0[] = {0xf4, 0x7a, 0x4f, 0x40, 0xc0, 0xbd, 0x33, 0x29, 0x1f, 0xb1, 0x2a, 0xad, 0x8e, 0x5, 0x90, 0xda, 0x27, 0xac, 0x3, 0xb4, 0x4f, 0x13, 0x9c, 0xcd, 0xce};
  uint8_t bytesprops1[] = {0xa6, 0x67, 0xee, 0x39, 0x1f, 0x12, 0x46, 0xc0, 0x64, 0x48, 0xfe, 0xb6, 0x92, 0xfe};
  uint8_t bytesprops2[] = {0x2f, 0xe3, 0xd6, 0xd3};
  uint8_t bytesprops3[] = {0x4b, 0xb6, 0x4e};
  uint8_t bytesprops4[] = {0xd3, 0x4c, 0xea, 0xfb, 0x15, 0x74, 0x77, 0x17, 0xce, 0x4c, 0x9d, 0xbe, 0xf4, 0x3f, 0x32, 0x25, 0x9d};
  uint8_t bytesprops5[] = {0xe8, 0x54, 0xcd, 0x3f, 0xea, 0x8, 0x1f, 0x7b, 0x36, 0x8d, 0xad, 0x18, 0x28, 0x1d, 0xaf, 0x2f, 0xee, 0x5e, 0xe0, 0x9f, 0x52, 0xf4, 0x82, 0xd0, 0xca, 0x45};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6037}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 28652}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {25, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 8920}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5875}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 9}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32438}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10202}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 253}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {4, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10419}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18017}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 65}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 743}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 232}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 126}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 132}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 184}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 25871}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21303}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {17, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15782}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 56}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 30908, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\233\224\135\179\172\244\254\241]\218|\ESC\137/", _pubPktID = 30908, _pubBody = "\235c=\156\"\206\185spp`\235\216", _pubProps = [PropMessageExpiryInterval 6037,PropWillDelayInterval 28652,PropCorrelationData "\244zO@\192\189\&3)\US\177*\173\142\ENQ\144\218'\172\ETX\180O\DC3\156\205\206",PropSessionExpiryInterval 8920,PropWillDelayInterval 5875,PropSubscriptionIdentifier 9,PropReasonString "\166g\238\&9\US\DC2F\192dH\254\182\146\254",PropTopicAlias 32438,PropMessageExpiryInterval 10202,PropSubscriptionIdentifierAvailable 253,PropContentType "/\227\214\211",PropReasonString "K\182N",PropTopicAlias 10419,PropMessageExpiryInterval 18017,PropSubscriptionIdentifierAvailable 65,PropWillDelayInterval 743,PropRequestProblemInformation 232,PropSubscriptionIdentifierAvailable 126,PropRetainAvailable 132,PropRequestResponseInformation 184,PropReceiveMaximum 25871,PropMessageExpiryInterval 21303,PropCorrelationData "\211L\234\251\NAKtw\ETB\206L\157\190\244?2%\157",PropServerReference "\232T\205?\234\b\US{6\141\173\CAN(\GS\175/\238^\224\159R\244\130\208\202E",PropTopicAlias 15782,PropSharedSubscriptionAvailable 56]}
TEST(Publish5QCTest, Decode15) {
uint8_t pkt[] = {0x32, 0xd0, 0x1, 0x0, 0xe, 0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f, 0x78, 0xbc, 0xaf, 0x1, 0x2, 0x0, 0x0, 0x17, 0x95, 0x18, 0x0, 0x0, 0x6f, 0xec, 0x9, 0x0, 0x19, 0xf4, 0x7a, 0x4f, 0x40, 0xc0, 0xbd, 0x33, 0x29, 0x1f, 0xb1, 0x2a, 0xad, 0x8e, 0x5, 0x90, 0xda, 0x27, 0xac, 0x3, 0xb4, 0x4f, 0x13, 0x9c, 0xcd, 0xce, 0x11, 0x0, 0x0, 0x22, 0xd8, 0x18, 0x0, 0x0, 0x16, 0xf3, 0xb, 0x9, 0x1f, 0x0, 0xe, 0xa6, 0x67, 0xee, 0x39, 0x1f, 0x12, 0x46, 0xc0, 0x64, 0x48, 0xfe, 0xb6, 0x92, 0xfe, 0x23, 0x7e, 0xb6, 0x2, 0x0, 0x0, 0x27, 0xda, 0x29, 0xfd, 0x3, 0x0, 0x4, 0x2f, 0xe3, 0xd6, 0xd3, 0x1f, 0x0, 0x3, 0x4b, 0xb6, 0x4e, 0x23, 0x28, 0xb3, 0x2, 0x0, 0x0, 0x46, 0x61, 0x29, 0x41, 0x18, 0x0, 0x0, 0x2, 0xe7, 0x17, 0xe8, 0x29, 0x7e, 0x25, 0x84, 0x19, 0xb8, 0x21, 0x65, 0xf, 0x2, 0x0, 0x0, 0x53, 0x37, 0x9, 0x0, 0x11, 0xd3, 0x4c, 0xea, 0xfb, 0x15, 0x74, 0x77, 0x17, 0xce, 0x4c, 0x9d, 0xbe, 0xf4, 0x3f, 0x32, 0x25, 0x9d, 0x1c, 0x0, 0x1a, 0xe8, 0x54, 0xcd, 0x3f, 0xea, 0x8, 0x1f, 0x7b, 0x36, 0x8d, 0xad, 0x18, 0x28, 0x1d, 0xaf, 0x2f, 0xee, 0x5e, 0xe0, 0x9f, 0x52, 0xf4, 0x82, 0xd0, 0xca, 0x45, 0x23, 0x3d, 0xa6, 0x2a, 0x38, 0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xe9, 0xe0, 0x87, 0xb3, 0xac, 0xf4, 0xfe, 0xf1, 0x5d, 0xda, 0x7c, 0x1b, 0x89, 0x2f};
  lwmqtt_string_t exp_topic = {14, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xeb, 0x63, 0x3d, 0x9c, 0x22, 0xce, 0xb9, 0x73, 0x70, 0x70, 0x60, 0xeb, 0xd8};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 30908);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 14);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\233\218E\235\207\216\&6b\236\246\&0?\169D\196\137\228\212\200\179\RS\159", _pubPktID = 7795, _pubBody = ")\a\246\&4J\134\237\148\159\143:\EOT\237lN\252D\144\179\163'7\208\193\240", _pubProps = []}
TEST(Publish5QCTest, Encode16) {
uint8_t pkt[] = {0x3d, 0x34, 0x0, 0x16, 0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f, 0x1e, 0x73, 0x0, 0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
  uint8_t topic_bytes[] = {0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f};
  lwmqtt_string_t topic = {22, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 25;

  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 7795, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\233\218E\235\207\216\&6b\236\246\&0?\169D\196\137\228\212\200\179\RS\159", _pubPktID = 7795, _pubBody = ")\a\246\&4J\134\237\148\159\143:\EOT\237lN\252D\144\179\163'7\208\193\240", _pubProps = []}
TEST(Publish5QCTest, Decode16) {
uint8_t pkt[] = {0x3d, 0x34, 0x0, 0x16, 0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f, 0x1e, 0x73, 0x0, 0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xe9, 0xda, 0x45, 0xeb, 0xcf, 0xd8, 0x36, 0x62, 0xec, 0xf6, 0x30, 0x3f, 0xa9, 0x44, 0xc4, 0x89, 0xe4, 0xd4, 0xc8, 0xb3, 0x1e, 0x9f};
  lwmqtt_string_t exp_topic = {22, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x29, 0x7, 0xf6, 0x34, 0x4a, 0x86, 0xed, 0x94, 0x9f, 0x8f, 0x3a, 0x4, 0xed, 0x6c, 0x4e, 0xfc, 0x44, 0x90, 0xb3, 0xa3, 0x27, 0x37, 0xd0, 0xc1, 0xf0};
  lwmqtt_string_t exp_body = {25, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 7795);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 22);
EXPECT_EQ(msg.payload_len, 25);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 25);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "i\236\180\192[~\199\179\163\147g\v\219?\135\190L\237\DC1\STX`", _pubPktID = 2871, _pubBody = "\166\217", _pubProps = [PropUserProperty "\215|\bNh\138F\244s\162\207\164A\EMc\239\135" "H\f",PropResponseInformation "\211"]}
TEST(Publish5QCTest, Encode17) {
uint8_t pkt[] = {0x3d, 0x38, 0x0, 0x15, 0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60, 0xb, 0x37, 0x1c, 0x26, 0x0, 0x11, 0xd7, 0x7c, 0x8, 0x4e, 0x68, 0x8a, 0x46, 0xf4, 0x73, 0xa2, 0xcf, 0xa4, 0x41, 0x19, 0x63, 0xef, 0x87, 0x0, 0x2, 0x48, 0xc, 0x1a, 0x0, 0x1, 0xd3, 0xa6, 0xd9};
  uint8_t topic_bytes[] = {0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60};
  lwmqtt_string_t topic = {21, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0xa6, 0xd9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 2;

  uint8_t bytesprops1[] = {0x48, 0xc};
  uint8_t bytesprops0[] = {0xd7, 0x7c, 0x8, 0x4e, 0x68, 0x8a, 0x46, 0xf4, 0x73, 0xa2, 0xcf, 0xa4, 0x41, 0x19, 0x63, 0xef, 0x87};
  uint8_t bytesprops2[] = {0xd3};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={17, (char*)&bytesprops0}, .v={2, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&bytesprops2}}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 2871, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "i\236\180\192[~\199\179\163\147g\v\219?\135\190L\237\DC1\STX`", _pubPktID = 2871, _pubBody = "\166\217", _pubProps = [PropUserProperty "\215|\bNh\138F\244s\162\207\164A\EMc\239\135" "H\f",PropResponseInformation "\211"]}
TEST(Publish5QCTest, Decode17) {
uint8_t pkt[] = {0x3d, 0x38, 0x0, 0x15, 0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60, 0xb, 0x37, 0x1c, 0x26, 0x0, 0x11, 0xd7, 0x7c, 0x8, 0x4e, 0x68, 0x8a, 0x46, 0xf4, 0x73, 0xa2, 0xcf, 0xa4, 0x41, 0x19, 0x63, 0xef, 0x87, 0x0, 0x2, 0x48, 0xc, 0x1a, 0x0, 0x1, 0xd3, 0xa6, 0xd9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x69, 0xec, 0xb4, 0xc0, 0x5b, 0x7e, 0xc7, 0xb3, 0xa3, 0x93, 0x67, 0xb, 0xdb, 0x3f, 0x87, 0xbe, 0x4c, 0xed, 0x11, 0x2, 0x60};
  lwmqtt_string_t exp_topic = {21, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xa6, 0xd9};
  lwmqtt_string_t exp_body = {2, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 2871);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 21);
EXPECT_EQ(msg.payload_len, 2);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 2);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "bc", _pubPktID = 16588, _pubBody = "BE\CAN\DEL\135:\DLE\226{E\240\163\&8oT+~\213", _pubProps = [PropMaximumQoS 133,PropMaximumPacketSize 18313,PropCorrelationData "L",PropMessageExpiryInterval 12669,PropMessageExpiryInterval 6374,PropServerReference "n\234\217\197t\209\183\189\207\SUB\DEL\251\203+1L\146\141",PropMessageExpiryInterval 24703,PropReceiveMaximum 24739,PropRequestProblemInformation 194,PropRequestProblemInformation 79,PropWildcardSubscriptionAvailable 243,PropTopicAliasMaximum 393,PropReasonString "#l",PropMessageExpiryInterval 22807,PropAuthenticationMethod "\131\156",PropMessageExpiryInterval 18090]}
TEST(Publish5QCTest, Encode18) {
uint8_t pkt[] = {0x33, 0x68, 0x0, 0x2, 0x62, 0x63, 0x40, 0xcc, 0x4f, 0x24, 0x85, 0x27, 0x0, 0x0, 0x47, 0x89, 0x9, 0x0, 0x1, 0x4c, 0x2, 0x0, 0x0, 0x31, 0x7d, 0x2, 0x0, 0x0, 0x18, 0xe6, 0x1c, 0x0, 0x12, 0x6e, 0xea, 0xd9, 0xc5, 0x74, 0xd1, 0xb7, 0xbd, 0xcf, 0x1a, 0x7f, 0xfb, 0xcb, 0x2b, 0x31, 0x4c, 0x92, 0x8d, 0x2, 0x0, 0x0, 0x60, 0x7f, 0x21, 0x60, 0xa3, 0x17, 0xc2, 0x17, 0x4f, 0x28, 0xf3, 0x22, 0x1, 0x89, 0x1f, 0x0, 0x2, 0x23, 0x6c, 0x2, 0x0, 0x0, 0x59, 0x17, 0x15, 0x0, 0x2, 0x83, 0x9c, 0x2, 0x0, 0x0, 0x46, 0xaa, 0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
  uint8_t topic_bytes[] = {0x62, 0x63};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 18;

  uint8_t bytesprops0[] = {0x4c};
  uint8_t bytesprops1[] = {0x6e, 0xea, 0xd9, 0xc5, 0x74, 0xd1, 0xb7, 0xbd, 0xcf, 0x1a, 0x7f, 0xfb, 0xcb, 0x2b, 0x31, 0x4c, 0x92, 0x8d};
  uint8_t bytesprops2[] = {0x23, 0x6c};
  uint8_t bytesprops3[] = {0x83, 0x9c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 133}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18313}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {1, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12669}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6374}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {18, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24703}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 24739}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 194}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 79}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 243}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 393}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {2, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22807}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18090}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 16588, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "bc", _pubPktID = 16588, _pubBody = "BE\CAN\DEL\135:\DLE\226{E\240\163\&8oT+~\213", _pubProps = [PropMaximumQoS 133,PropMaximumPacketSize 18313,PropCorrelationData "L",PropMessageExpiryInterval 12669,PropMessageExpiryInterval 6374,PropServerReference "n\234\217\197t\209\183\189\207\SUB\DEL\251\203+1L\146\141",PropMessageExpiryInterval 24703,PropReceiveMaximum 24739,PropRequestProblemInformation 194,PropRequestProblemInformation 79,PropWildcardSubscriptionAvailable 243,PropTopicAliasMaximum 393,PropReasonString "#l",PropMessageExpiryInterval 22807,PropAuthenticationMethod "\131\156",PropMessageExpiryInterval 18090]}
TEST(Publish5QCTest, Decode18) {
uint8_t pkt[] = {0x33, 0x68, 0x0, 0x2, 0x62, 0x63, 0x40, 0xcc, 0x4f, 0x24, 0x85, 0x27, 0x0, 0x0, 0x47, 0x89, 0x9, 0x0, 0x1, 0x4c, 0x2, 0x0, 0x0, 0x31, 0x7d, 0x2, 0x0, 0x0, 0x18, 0xe6, 0x1c, 0x0, 0x12, 0x6e, 0xea, 0xd9, 0xc5, 0x74, 0xd1, 0xb7, 0xbd, 0xcf, 0x1a, 0x7f, 0xfb, 0xcb, 0x2b, 0x31, 0x4c, 0x92, 0x8d, 0x2, 0x0, 0x0, 0x60, 0x7f, 0x21, 0x60, 0xa3, 0x17, 0xc2, 0x17, 0x4f, 0x28, 0xf3, 0x22, 0x1, 0x89, 0x1f, 0x0, 0x2, 0x23, 0x6c, 0x2, 0x0, 0x0, 0x59, 0x17, 0x15, 0x0, 0x2, 0x83, 0x9c, 0x2, 0x0, 0x0, 0x46, 0xaa, 0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x62, 0x63};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x42, 0x45, 0x18, 0x7f, 0x87, 0x3a, 0x10, 0xe2, 0x7b, 0x45, 0xf0, 0xa3, 0x38, 0x6f, 0x54, 0x2b, 0x7e, 0xd5};
  lwmqtt_string_t exp_body = {18, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 16588);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 18);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 18);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\DC3\255\173\206\232\229\219\SOH\SUB\237\217\218}\ENQ\DC3", _pubPktID = 0, _pubBody = "\184", _pubProps = [PropAuthenticationData "e\ESC\ESC\a\DC4o\EOT\197\137\215\223<\199'sz\ETXKw\195\&6\130\DC3\244",PropAuthenticationData "\138\228",PropSessionExpiryInterval 7762,PropWillDelayInterval 29687,PropAuthenticationMethod "\250\186&\163\132s\174\178Bt\136\203l\225~\151$",PropSharedSubscriptionAvailable 29,PropMaximumQoS 225]}
TEST(Publish5QCTest, Encode19) {
uint8_t pkt[] = {0x31, 0x55, 0x0, 0xf, 0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13, 0x42, 0x16, 0x0, 0x18, 0x65, 0x1b, 0x1b, 0x7, 0x14, 0x6f, 0x4, 0xc5, 0x89, 0xd7, 0xdf, 0x3c, 0xc7, 0x27, 0x73, 0x7a, 0x3, 0x4b, 0x77, 0xc3, 0x36, 0x82, 0x13, 0xf4, 0x16, 0x0, 0x2, 0x8a, 0xe4, 0x11, 0x0, 0x0, 0x1e, 0x52, 0x18, 0x0, 0x0, 0x73, 0xf7, 0x15, 0x0, 0x11, 0xfa, 0xba, 0x26, 0xa3, 0x84, 0x73, 0xae, 0xb2, 0x42, 0x74, 0x88, 0xcb, 0x6c, 0xe1, 0x7e, 0x97, 0x24, 0x2a, 0x1d, 0x24, 0xe1, 0xb8};
  uint8_t topic_bytes[] = {0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13};
  lwmqtt_string_t topic = {15, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = true;
uint8_t msg_bytes[] = {0xb8};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 1;

  uint8_t bytesprops0[] = {0x65, 0x1b, 0x1b, 0x7, 0x14, 0x6f, 0x4, 0xc5, 0x89, 0xd7, 0xdf, 0x3c, 0xc7, 0x27, 0x73, 0x7a, 0x3, 0x4b, 0x77, 0xc3, 0x36, 0x82, 0x13, 0xf4};
  uint8_t bytesprops1[] = {0x8a, 0xe4};
  uint8_t bytesprops2[] = {0xfa, 0xba, 0x26, 0xa3, 0x84, 0x73, 0xae, 0xb2, 0x42, 0x74, 0x88, 0xcb, 0x6c, 0xe1, 0x7e, 0x97, 0x24};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {24, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {2, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7762}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29687}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 29}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 225}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "\DC3\255\173\206\232\229\219\SOH\SUB\237\217\218}\ENQ\DC3", _pubPktID = 0, _pubBody = "\184", _pubProps = [PropAuthenticationData "e\ESC\ESC\a\DC4o\EOT\197\137\215\223<\199'sz\ETXKw\195\&6\130\DC3\244",PropAuthenticationData "\138\228",PropSessionExpiryInterval 7762,PropWillDelayInterval 29687,PropAuthenticationMethod "\250\186&\163\132s\174\178Bt\136\203l\225~\151$",PropSharedSubscriptionAvailable 29,PropMaximumQoS 225]}
TEST(Publish5QCTest, Decode19) {
uint8_t pkt[] = {0x31, 0x55, 0x0, 0xf, 0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13, 0x42, 0x16, 0x0, 0x18, 0x65, 0x1b, 0x1b, 0x7, 0x14, 0x6f, 0x4, 0xc5, 0x89, 0xd7, 0xdf, 0x3c, 0xc7, 0x27, 0x73, 0x7a, 0x3, 0x4b, 0x77, 0xc3, 0x36, 0x82, 0x13, 0xf4, 0x16, 0x0, 0x2, 0x8a, 0xe4, 0x11, 0x0, 0x0, 0x1e, 0x52, 0x18, 0x0, 0x0, 0x73, 0xf7, 0x15, 0x0, 0x11, 0xfa, 0xba, 0x26, 0xa3, 0x84, 0x73, 0xae, 0xb2, 0x42, 0x74, 0x88, 0xcb, 0x6c, 0xe1, 0x7e, 0x97, 0x24, 0x2a, 0x1d, 0x24, 0xe1, 0xb8};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x13, 0xff, 0xad, 0xce, 0xe8, 0xe5, 0xdb, 0x1, 0x1a, 0xed, 0xd9, 0xda, 0x7d, 0x5, 0x13};
  lwmqtt_string_t exp_topic = {15, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xb8};
  lwmqtt_string_t exp_body = {1, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 15);
EXPECT_EQ(msg.payload_len, 1);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 1);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\134\&2\209f\v\148F\254 \253\tm", _pubPktID = 25649, _pubBody = "!mj\ACK\181\179\t\252S\212\144\149\130\150X", _pubProps = [PropRequestProblemInformation 125,PropMessageExpiryInterval 9893,PropWillDelayInterval 12742,PropContentType "\252\247q\147\&3\229\143\251\206O\238.\149\204C\151\193z\181\239\150G^j\EOTR\150j",PropPayloadFormatIndicator 218,PropServerKeepAlive 17321]}
TEST(Publish5QCTest, Encode20) {
uint8_t pkt[] = {0x3b, 0x50, 0x0, 0xc, 0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d, 0x64, 0x31, 0x30, 0x17, 0x7d, 0x2, 0x0, 0x0, 0x26, 0xa5, 0x18, 0x0, 0x0, 0x31, 0xc6, 0x3, 0x0, 0x1c, 0xfc, 0xf7, 0x71, 0x93, 0x33, 0xe5, 0x8f, 0xfb, 0xce, 0x4f, 0xee, 0x2e, 0x95, 0xcc, 0x43, 0x97, 0xc1, 0x7a, 0xb5, 0xef, 0x96, 0x47, 0x5e, 0x6a, 0x4, 0x52, 0x96, 0x6a, 0x1, 0xda, 0x13, 0x43, 0xa9, 0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
  uint8_t topic_bytes[] = {0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d};
  lwmqtt_string_t topic = {12, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 15;

  uint8_t bytesprops0[] = {0xfc, 0xf7, 0x71, 0x93, 0x33, 0xe5, 0x8f, 0xfb, 0xce, 0x4f, 0xee, 0x2e, 0x95, 0xcc, 0x43, 0x97, 0xc1, 0x7a, 0xb5, 0xef, 0x96, 0x47, 0x5e, 0x6a, 0x4, 0x52, 0x96, 0x6a};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 125}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9893}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 12742}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 218}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 17321}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 25649, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\134\&2\209f\v\148F\254 \253\tm", _pubPktID = 25649, _pubBody = "!mj\ACK\181\179\t\252S\212\144\149\130\150X", _pubProps = [PropRequestProblemInformation 125,PropMessageExpiryInterval 9893,PropWillDelayInterval 12742,PropContentType "\252\247q\147\&3\229\143\251\206O\238.\149\204C\151\193z\181\239\150G^j\EOTR\150j",PropPayloadFormatIndicator 218,PropServerKeepAlive 17321]}
TEST(Publish5QCTest, Decode20) {
uint8_t pkt[] = {0x3b, 0x50, 0x0, 0xc, 0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d, 0x64, 0x31, 0x30, 0x17, 0x7d, 0x2, 0x0, 0x0, 0x26, 0xa5, 0x18, 0x0, 0x0, 0x31, 0xc6, 0x3, 0x0, 0x1c, 0xfc, 0xf7, 0x71, 0x93, 0x33, 0xe5, 0x8f, 0xfb, 0xce, 0x4f, 0xee, 0x2e, 0x95, 0xcc, 0x43, 0x97, 0xc1, 0x7a, 0xb5, 0xef, 0x96, 0x47, 0x5e, 0x6a, 0x4, 0x52, 0x96, 0x6a, 0x1, 0xda, 0x13, 0x43, 0xa9, 0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x86, 0x32, 0xd1, 0x66, 0xb, 0x94, 0x46, 0xfe, 0x20, 0xfd, 0x9, 0x6d};
  lwmqtt_string_t exp_topic = {12, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x21, 0x6d, 0x6a, 0x6, 0xb5, 0xb3, 0x9, 0xfc, 0x53, 0xd4, 0x90, 0x95, 0x82, 0x96, 0x58};
  lwmqtt_string_t exp_body = {15, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 25649);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 12);
EXPECT_EQ(msg.payload_len, 15);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 15);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "|\218", _pubPktID = 20394, _pubBody = "\153\SO\176", _pubProps = [PropAssignedClientIdentifier "\SI\n\150!\196\164",PropResponseTopic "\ACK\163\157\162#a\230E\167\179\232\140\192\FS5\ACK\200\219\164*h<a",PropMessageExpiryInterval 22175,PropSubscriptionIdentifierAvailable 245,PropSubscriptionIdentifierAvailable 248,PropRequestResponseInformation 23,PropMaximumPacketSize 16605,PropMessageExpiryInterval 12209,PropSessionExpiryInterval 31384,PropSessionExpiryInterval 11817,PropRequestResponseInformation 80,PropAssignedClientIdentifier "f\DC1\156\157\178\154\226\195\RS~J\172\226\148eV\204\187",PropSharedSubscriptionAvailable 72,PropReceiveMaximum 5868,PropMaximumPacketSize 19856,PropServerKeepAlive 25841,PropServerKeepAlive 18572,PropRetainAvailable 90,PropMessageExpiryInterval 20156,PropServerKeepAlive 22993,PropRequestProblemInformation 46,PropPayloadFormatIndicator 13,PropAuthenticationData "}%",PropAuthenticationData "j\151\211\"\154\243\168\ACK\180\242Y\253\&3\152\244C\ETB",PropSharedSubscriptionAvailable 203,PropResponseInformation "\231\173k\201\238{3\163\193\218\192U\FS\GS\131XL\128\b"]}
TEST(Publish5QCTest, Encode21) {
uint8_t pkt[] = {0x3d, 0xb3, 0x1, 0x0, 0x2, 0x7c, 0xda, 0x4f, 0xaa, 0xa8, 0x1, 0x12, 0x0, 0x6, 0xf, 0xa, 0x96, 0x21, 0xc4, 0xa4, 0x8, 0x0, 0x17, 0x6, 0xa3, 0x9d, 0xa2, 0x23, 0x61, 0xe6, 0x45, 0xa7, 0xb3, 0xe8, 0x8c, 0xc0, 0x1c, 0x35, 0x6, 0xc8, 0xdb, 0xa4, 0x2a, 0x68, 0x3c, 0x61, 0x2, 0x0, 0x0, 0x56, 0x9f, 0x29, 0xf5, 0x29, 0xf8, 0x19, 0x17, 0x27, 0x0, 0x0, 0x40, 0xdd, 0x2, 0x0, 0x0, 0x2f, 0xb1, 0x11, 0x0, 0x0, 0x7a, 0x98, 0x11, 0x0, 0x0, 0x2e, 0x29, 0x19, 0x50, 0x12, 0x0, 0x12, 0x66, 0x11, 0x9c, 0x9d, 0xb2, 0x9a, 0xe2, 0xc3, 0x1e, 0x7e, 0x4a, 0xac, 0xe2, 0x94, 0x65, 0x56, 0xcc, 0xbb, 0x2a, 0x48, 0x21, 0x16, 0xec, 0x27, 0x0, 0x0, 0x4d, 0x90, 0x13, 0x64, 0xf1, 0x13, 0x48, 0x8c, 0x25, 0x5a, 0x2, 0x0, 0x0, 0x4e, 0xbc, 0x13, 0x59, 0xd1, 0x17, 0x2e, 0x1, 0xd, 0x16, 0x0, 0x2, 0x7d, 0x25, 0x16, 0x0, 0x11, 0x6a, 0x97, 0xd3, 0x22, 0x9a, 0xf3, 0xa8, 0x6, 0xb4, 0xf2, 0x59, 0xfd, 0x33, 0x98, 0xf4, 0x43, 0x17, 0x2a, 0xcb, 0x1a, 0x0, 0x13, 0xe7, 0xad, 0x6b, 0xc9, 0xee, 0x7b, 0x33, 0xa3, 0xc1, 0xda, 0xc0, 0x55, 0x1c, 0x1d, 0x83, 0x58, 0x4c, 0x80, 0x8, 0x99, 0xe, 0xb0};
  uint8_t topic_bytes[] = {0x7c, 0xda};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x99, 0xe, 0xb0};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  uint8_t bytesprops0[] = {0xf, 0xa, 0x96, 0x21, 0xc4, 0xa4};
  uint8_t bytesprops1[] = {0x6, 0xa3, 0x9d, 0xa2, 0x23, 0x61, 0xe6, 0x45, 0xa7, 0xb3, 0xe8, 0x8c, 0xc0, 0x1c, 0x35, 0x6, 0xc8, 0xdb, 0xa4, 0x2a, 0x68, 0x3c, 0x61};
  uint8_t bytesprops2[] = {0x66, 0x11, 0x9c, 0x9d, 0xb2, 0x9a, 0xe2, 0xc3, 0x1e, 0x7e, 0x4a, 0xac, 0xe2, 0x94, 0x65, 0x56, 0xcc, 0xbb};
  uint8_t bytesprops3[] = {0x7d, 0x25};
  uint8_t bytesprops4[] = {0x6a, 0x97, 0xd3, 0x22, 0x9a, 0xf3, 0xa8, 0x6, 0xb4, 0xf2, 0x59, 0xfd, 0x33, 0x98, 0xf4, 0x43, 0x17};
  uint8_t bytesprops5[] = {0xe7, 0xad, 0x6b, 0xc9, 0xee, 0x7b, 0x33, 0xa3, 0xc1, 0xda, 0xc0, 0x55, 0x1c, 0x1d, 0x83, 0x58, 0x4c, 0x80, 0x8};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {6, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22175}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 245}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 248}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 23}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 16605}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12209}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31384}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11817}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 80}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {18, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 72}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 5868}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 19856}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 25841}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 18572}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 90}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 20156}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22993}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 46}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 13}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {2, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {17, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 203}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {19, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 20394, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "|\218", _pubPktID = 20394, _pubBody = "\153\SO\176", _pubProps = [PropAssignedClientIdentifier "\SI\n\150!\196\164",PropResponseTopic "\ACK\163\157\162#a\230E\167\179\232\140\192\FS5\ACK\200\219\164*h<a",PropMessageExpiryInterval 22175,PropSubscriptionIdentifierAvailable 245,PropSubscriptionIdentifierAvailable 248,PropRequestResponseInformation 23,PropMaximumPacketSize 16605,PropMessageExpiryInterval 12209,PropSessionExpiryInterval 31384,PropSessionExpiryInterval 11817,PropRequestResponseInformation 80,PropAssignedClientIdentifier "f\DC1\156\157\178\154\226\195\RS~J\172\226\148eV\204\187",PropSharedSubscriptionAvailable 72,PropReceiveMaximum 5868,PropMaximumPacketSize 19856,PropServerKeepAlive 25841,PropServerKeepAlive 18572,PropRetainAvailable 90,PropMessageExpiryInterval 20156,PropServerKeepAlive 22993,PropRequestProblemInformation 46,PropPayloadFormatIndicator 13,PropAuthenticationData "}%",PropAuthenticationData "j\151\211\"\154\243\168\ACK\180\242Y\253\&3\152\244C\ETB",PropSharedSubscriptionAvailable 203,PropResponseInformation "\231\173k\201\238{3\163\193\218\192U\FS\GS\131XL\128\b"]}
TEST(Publish5QCTest, Decode21) {
uint8_t pkt[] = {0x3d, 0xb3, 0x1, 0x0, 0x2, 0x7c, 0xda, 0x4f, 0xaa, 0xa8, 0x1, 0x12, 0x0, 0x6, 0xf, 0xa, 0x96, 0x21, 0xc4, 0xa4, 0x8, 0x0, 0x17, 0x6, 0xa3, 0x9d, 0xa2, 0x23, 0x61, 0xe6, 0x45, 0xa7, 0xb3, 0xe8, 0x8c, 0xc0, 0x1c, 0x35, 0x6, 0xc8, 0xdb, 0xa4, 0x2a, 0x68, 0x3c, 0x61, 0x2, 0x0, 0x0, 0x56, 0x9f, 0x29, 0xf5, 0x29, 0xf8, 0x19, 0x17, 0x27, 0x0, 0x0, 0x40, 0xdd, 0x2, 0x0, 0x0, 0x2f, 0xb1, 0x11, 0x0, 0x0, 0x7a, 0x98, 0x11, 0x0, 0x0, 0x2e, 0x29, 0x19, 0x50, 0x12, 0x0, 0x12, 0x66, 0x11, 0x9c, 0x9d, 0xb2, 0x9a, 0xe2, 0xc3, 0x1e, 0x7e, 0x4a, 0xac, 0xe2, 0x94, 0x65, 0x56, 0xcc, 0xbb, 0x2a, 0x48, 0x21, 0x16, 0xec, 0x27, 0x0, 0x0, 0x4d, 0x90, 0x13, 0x64, 0xf1, 0x13, 0x48, 0x8c, 0x25, 0x5a, 0x2, 0x0, 0x0, 0x4e, 0xbc, 0x13, 0x59, 0xd1, 0x17, 0x2e, 0x1, 0xd, 0x16, 0x0, 0x2, 0x7d, 0x25, 0x16, 0x0, 0x11, 0x6a, 0x97, 0xd3, 0x22, 0x9a, 0xf3, 0xa8, 0x6, 0xb4, 0xf2, 0x59, 0xfd, 0x33, 0x98, 0xf4, 0x43, 0x17, 0x2a, 0xcb, 0x1a, 0x0, 0x13, 0xe7, 0xad, 0x6b, 0xc9, 0xee, 0x7b, 0x33, 0xa3, 0xc1, 0xda, 0xc0, 0x55, 0x1c, 0x1d, 0x83, 0x58, 0x4c, 0x80, 0x8, 0x99, 0xe, 0xb0};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7c, 0xda};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x99, 0xe, 0xb0};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 20394);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "<\t\"\209\184\182u\179\DLE\NAK\195\141\EM\237\189}\143\EOT\STX\188|\188\t\USv\US\209\"\STX", _pubPktID = 17374, _pubBody = "\"=\237\FS\247\238\129>oH\131~\158k\231\193}\194\ESCu", _pubProps = [PropWillDelayInterval 30493,PropResponseTopic "G\239\184\133\ETB~j'_\181t\194\148\221\231\SUB+\166\231\ETB\171\t,",PropWillDelayInterval 8185,PropContentType "[4:\219Gf\160\206\208qv\232\159\&8\190\211`\253\192\182\213\t",PropAssignedClientIdentifier "\145nCH\170\200\198[\135\249X\255\214\132\137(\234\179\223\190",PropSharedSubscriptionAvailable 64,PropMessageExpiryInterval 432,PropSubscriptionIdentifier 5,PropRetainAvailable 204,PropRequestResponseInformation 110,PropResponseTopic "\194\237\206\ACKh\ACK\132)\172\t\174\206\189\192,\161",PropRequestProblemInformation 68,PropSubscriptionIdentifierAvailable 215,PropReasonString "\DC1\168\133\202\NUL\146\148=\ACKg\172:\FSr\140\139\DC4\134\208\209\USR",PropUserProperty "\ENQ\255\SOHm\177\154f\207\198\147\186{tO\\z0\232\155\233\186\169\230" "\140\199",PropSessionExpiryInterval 30860,PropSessionExpiryInterval 31114,PropPayloadFormatIndicator 25,PropAssignedClientIdentifier "z=>'\171\235\192{\133AbA\172\178\175+\213\137a\r@",PropPayloadFormatIndicator 106,PropRequestResponseInformation 81,PropServerReference "1\162\156\135\224\162\243\243\216:{v;\213\204^\160\219\193\a\138\228OX\240C\150",PropCorrelationData "\f\179\FSBM"]}
TEST(Publish5QCTest, Encode22) {
uint8_t pkt[] = {0x3a, 0xb4, 0x2, 0x0, 0x1d, 0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2, 0x43, 0xde, 0xfd, 0x1, 0x18, 0x0, 0x0, 0x77, 0x1d, 0x8, 0x0, 0x17, 0x47, 0xef, 0xb8, 0x85, 0x17, 0x7e, 0x6a, 0x27, 0x5f, 0xb5, 0x74, 0xc2, 0x94, 0xdd, 0xe7, 0x1a, 0x2b, 0xa6, 0xe7, 0x17, 0xab, 0x9, 0x2c, 0x18, 0x0, 0x0, 0x1f, 0xf9, 0x3, 0x0, 0x16, 0x5b, 0x34, 0x3a, 0xdb, 0x47, 0x66, 0xa0, 0xce, 0xd0, 0x71, 0x76, 0xe8, 0x9f, 0x38, 0xbe, 0xd3, 0x60, 0xfd, 0xc0, 0xb6, 0xd5, 0x9, 0x12, 0x0, 0x14, 0x91, 0x6e, 0x43, 0x48, 0xaa, 0xc8, 0xc6, 0x5b, 0x87, 0xf9, 0x58, 0xff, 0xd6, 0x84, 0x89, 0x28, 0xea, 0xb3, 0xdf, 0xbe, 0x2a, 0x40, 0x2, 0x0, 0x0, 0x1, 0xb0, 0xb, 0x5, 0x25, 0xcc, 0x19, 0x6e, 0x8, 0x0, 0x10, 0xc2, 0xed, 0xce, 0x6, 0x68, 0x6, 0x84, 0x29, 0xac, 0x9, 0xae, 0xce, 0xbd, 0xc0, 0x2c, 0xa1, 0x17, 0x44, 0x29, 0xd7, 0x1f, 0x0, 0x16, 0x11, 0xa8, 0x85, 0xca, 0x0, 0x92, 0x94, 0x3d, 0x6, 0x67, 0xac, 0x3a, 0x1c, 0x72, 0x8c, 0x8b, 0x14, 0x86, 0xd0, 0xd1, 0x1f, 0x52, 0x26, 0x0, 0x17, 0x5, 0xff, 0x1, 0x6d, 0xb1, 0x9a, 0x66, 0xcf, 0xc6, 0x93, 0xba, 0x7b, 0x74, 0x4f, 0x5c, 0x7a, 0x30, 0xe8, 0x9b, 0xe9, 0xba, 0xa9, 0xe6, 0x0, 0x2, 0x8c, 0xc7, 0x11, 0x0, 0x0, 0x78, 0x8c, 0x11, 0x0, 0x0, 0x79, 0x8a, 0x1, 0x19, 0x12, 0x0, 0x15, 0x7a, 0x3d, 0x3e, 0x27, 0xab, 0xeb, 0xc0, 0x7b, 0x85, 0x41, 0x62, 0x41, 0xac, 0xb2, 0xaf, 0x2b, 0xd5, 0x89, 0x61, 0xd, 0x40, 0x1, 0x6a, 0x19, 0x51, 0x1c, 0x0, 0x1b, 0x31, 0xa2, 0x9c, 0x87, 0xe0, 0xa2, 0xf3, 0xf3, 0xd8, 0x3a, 0x7b, 0x76, 0x3b, 0xd5, 0xcc, 0x5e, 0xa0, 0xdb, 0xc1, 0x7, 0x8a, 0xe4, 0x4f, 0x58, 0xf0, 0x43, 0x96, 0x9, 0x0, 0x5, 0xc, 0xb3, 0x1c, 0x42, 0x4d, 0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
  uint8_t topic_bytes[] = {0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2};
  lwmqtt_string_t topic = {29, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = false;
uint8_t msg_bytes[] = {0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 20;

  uint8_t bytesprops0[] = {0x47, 0xef, 0xb8, 0x85, 0x17, 0x7e, 0x6a, 0x27, 0x5f, 0xb5, 0x74, 0xc2, 0x94, 0xdd, 0xe7, 0x1a, 0x2b, 0xa6, 0xe7, 0x17, 0xab, 0x9, 0x2c};
  uint8_t bytesprops1[] = {0x5b, 0x34, 0x3a, 0xdb, 0x47, 0x66, 0xa0, 0xce, 0xd0, 0x71, 0x76, 0xe8, 0x9f, 0x38, 0xbe, 0xd3, 0x60, 0xfd, 0xc0, 0xb6, 0xd5, 0x9};
  uint8_t bytesprops2[] = {0x91, 0x6e, 0x43, 0x48, 0xaa, 0xc8, 0xc6, 0x5b, 0x87, 0xf9, 0x58, 0xff, 0xd6, 0x84, 0x89, 0x28, 0xea, 0xb3, 0xdf, 0xbe};
  uint8_t bytesprops3[] = {0xc2, 0xed, 0xce, 0x6, 0x68, 0x6, 0x84, 0x29, 0xac, 0x9, 0xae, 0xce, 0xbd, 0xc0, 0x2c, 0xa1};
  uint8_t bytesprops4[] = {0x11, 0xa8, 0x85, 0xca, 0x0, 0x92, 0x94, 0x3d, 0x6, 0x67, 0xac, 0x3a, 0x1c, 0x72, 0x8c, 0x8b, 0x14, 0x86, 0xd0, 0xd1, 0x1f, 0x52};
  uint8_t bytesprops6[] = {0x8c, 0xc7};
  uint8_t bytesprops5[] = {0x5, 0xff, 0x1, 0x6d, 0xb1, 0x9a, 0x66, 0xcf, 0xc6, 0x93, 0xba, 0x7b, 0x74, 0x4f, 0x5c, 0x7a, 0x30, 0xe8, 0x9b, 0xe9, 0xba, 0xa9, 0xe6};
  uint8_t bytesprops7[] = {0x7a, 0x3d, 0x3e, 0x27, 0xab, 0xeb, 0xc0, 0x7b, 0x85, 0x41, 0x62, 0x41, 0xac, 0xb2, 0xaf, 0x2b, 0xd5, 0x89, 0x61, 0xd, 0x40};
  uint8_t bytesprops8[] = {0x31, 0xa2, 0x9c, 0x87, 0xe0, 0xa2, 0xf3, 0xf3, 0xd8, 0x3a, 0x7b, 0x76, 0x3b, 0xd5, 0xcc, 0x5e, 0xa0, 0xdb, 0xc1, 0x7, 0x8a, 0xe4, 0x4f, 0x58, 0xf0, 0x43, 0x96};
  uint8_t bytesprops9[] = {0xc, 0xb3, 0x1c, 0x42, 0x4d};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 30493}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8185}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 64}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 432}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 5}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 204}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 110}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {16, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 68}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 215}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={23, (char*)&bytesprops5}, .v={2, (char*)&bytesprops6}}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 30860}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31114}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 25}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 106}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {5, (char*)&bytesprops9}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 17374, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "<\t\"\209\184\182u\179\DLE\NAK\195\141\EM\237\189}\143\EOT\STX\188|\188\t\USv\US\209\"\STX", _pubPktID = 17374, _pubBody = "\"=\237\FS\247\238\129>oH\131~\158k\231\193}\194\ESCu", _pubProps = [PropWillDelayInterval 30493,PropResponseTopic "G\239\184\133\ETB~j'_\181t\194\148\221\231\SUB+\166\231\ETB\171\t,",PropWillDelayInterval 8185,PropContentType "[4:\219Gf\160\206\208qv\232\159\&8\190\211`\253\192\182\213\t",PropAssignedClientIdentifier "\145nCH\170\200\198[\135\249X\255\214\132\137(\234\179\223\190",PropSharedSubscriptionAvailable 64,PropMessageExpiryInterval 432,PropSubscriptionIdentifier 5,PropRetainAvailable 204,PropRequestResponseInformation 110,PropResponseTopic "\194\237\206\ACKh\ACK\132)\172\t\174\206\189\192,\161",PropRequestProblemInformation 68,PropSubscriptionIdentifierAvailable 215,PropReasonString "\DC1\168\133\202\NUL\146\148=\ACKg\172:\FSr\140\139\DC4\134\208\209\USR",PropUserProperty "\ENQ\255\SOHm\177\154f\207\198\147\186{tO\\z0\232\155\233\186\169\230" "\140\199",PropSessionExpiryInterval 30860,PropSessionExpiryInterval 31114,PropPayloadFormatIndicator 25,PropAssignedClientIdentifier "z=>'\171\235\192{\133AbA\172\178\175+\213\137a\r@",PropPayloadFormatIndicator 106,PropRequestResponseInformation 81,PropServerReference "1\162\156\135\224\162\243\243\216:{v;\213\204^\160\219\193\a\138\228OX\240C\150",PropCorrelationData "\f\179\FSBM"]}
TEST(Publish5QCTest, Decode22) {
uint8_t pkt[] = {0x3a, 0xb4, 0x2, 0x0, 0x1d, 0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2, 0x43, 0xde, 0xfd, 0x1, 0x18, 0x0, 0x0, 0x77, 0x1d, 0x8, 0x0, 0x17, 0x47, 0xef, 0xb8, 0x85, 0x17, 0x7e, 0x6a, 0x27, 0x5f, 0xb5, 0x74, 0xc2, 0x94, 0xdd, 0xe7, 0x1a, 0x2b, 0xa6, 0xe7, 0x17, 0xab, 0x9, 0x2c, 0x18, 0x0, 0x0, 0x1f, 0xf9, 0x3, 0x0, 0x16, 0x5b, 0x34, 0x3a, 0xdb, 0x47, 0x66, 0xa0, 0xce, 0xd0, 0x71, 0x76, 0xe8, 0x9f, 0x38, 0xbe, 0xd3, 0x60, 0xfd, 0xc0, 0xb6, 0xd5, 0x9, 0x12, 0x0, 0x14, 0x91, 0x6e, 0x43, 0x48, 0xaa, 0xc8, 0xc6, 0x5b, 0x87, 0xf9, 0x58, 0xff, 0xd6, 0x84, 0x89, 0x28, 0xea, 0xb3, 0xdf, 0xbe, 0x2a, 0x40, 0x2, 0x0, 0x0, 0x1, 0xb0, 0xb, 0x5, 0x25, 0xcc, 0x19, 0x6e, 0x8, 0x0, 0x10, 0xc2, 0xed, 0xce, 0x6, 0x68, 0x6, 0x84, 0x29, 0xac, 0x9, 0xae, 0xce, 0xbd, 0xc0, 0x2c, 0xa1, 0x17, 0x44, 0x29, 0xd7, 0x1f, 0x0, 0x16, 0x11, 0xa8, 0x85, 0xca, 0x0, 0x92, 0x94, 0x3d, 0x6, 0x67, 0xac, 0x3a, 0x1c, 0x72, 0x8c, 0x8b, 0x14, 0x86, 0xd0, 0xd1, 0x1f, 0x52, 0x26, 0x0, 0x17, 0x5, 0xff, 0x1, 0x6d, 0xb1, 0x9a, 0x66, 0xcf, 0xc6, 0x93, 0xba, 0x7b, 0x74, 0x4f, 0x5c, 0x7a, 0x30, 0xe8, 0x9b, 0xe9, 0xba, 0xa9, 0xe6, 0x0, 0x2, 0x8c, 0xc7, 0x11, 0x0, 0x0, 0x78, 0x8c, 0x11, 0x0, 0x0, 0x79, 0x8a, 0x1, 0x19, 0x12, 0x0, 0x15, 0x7a, 0x3d, 0x3e, 0x27, 0xab, 0xeb, 0xc0, 0x7b, 0x85, 0x41, 0x62, 0x41, 0xac, 0xb2, 0xaf, 0x2b, 0xd5, 0x89, 0x61, 0xd, 0x40, 0x1, 0x6a, 0x19, 0x51, 0x1c, 0x0, 0x1b, 0x31, 0xa2, 0x9c, 0x87, 0xe0, 0xa2, 0xf3, 0xf3, 0xd8, 0x3a, 0x7b, 0x76, 0x3b, 0xd5, 0xcc, 0x5e, 0xa0, 0xdb, 0xc1, 0x7, 0x8a, 0xe4, 0x4f, 0x58, 0xf0, 0x43, 0x96, 0x9, 0x0, 0x5, 0xc, 0xb3, 0x1c, 0x42, 0x4d, 0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x3c, 0x9, 0x22, 0xd1, 0xb8, 0xb6, 0x75, 0xb3, 0x10, 0x15, 0xc3, 0x8d, 0x19, 0xed, 0xbd, 0x7d, 0x8f, 0x4, 0x2, 0xbc, 0x7c, 0xbc, 0x9, 0x1f, 0x76, 0x1f, 0xd1, 0x22, 0x2};
  lwmqtt_string_t exp_topic = {29, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x22, 0x3d, 0xed, 0x1c, 0xf7, 0xee, 0x81, 0x3e, 0x6f, 0x48, 0x83, 0x7e, 0x9e, 0x6b, 0xe7, 0xc1, 0x7d, 0xc2, 0x1b, 0x75};
  lwmqtt_string_t exp_body = {20, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 17374);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 29);
EXPECT_EQ(msg.payload_len, 20);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 20);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "L\250\DC3", _pubPktID = 6223, _pubBody = ".K\236\242\210\250\192\219\175h\175p\249", _pubProps = [PropSessionExpiryInterval 21695,PropSubscriptionIdentifierAvailable 48,PropUserProperty "h\160\209\172\SYN\ENQ\165\230=\215\207\137\244\DC3\NUL|\145\&6\153\193\140~f\SI\246/" "\231u2\n-\196\188\203F",PropServerKeepAlive 11554,PropAssignedClientIdentifier "\243\&8]\161ZF\r\166\198el\182",PropCorrelationData "\a_\228\&3Ve<\FS[i\238\r\169\188y\187\FS0\145o_8\160t\186",PropResponseInformation "\189\FS\136\EM7\131T\SUB\239\167\221\232\tA\ETX\235n\205",PropTopicAliasMaximum 25457,PropWildcardSubscriptionAvailable 204,PropTopicAliasMaximum 32590,PropPayloadFormatIndicator 81,PropMessageExpiryInterval 27542,PropRequestResponseInformation 163,PropCorrelationData "K\240\248\217\EMt\176\249y\177\DC4\ENQ\134\198\&21\200\NAK\155",PropPayloadFormatIndicator 193,PropServerKeepAlive 20073,PropSubscriptionIdentifierAvailable 37,PropTopicAliasMaximum 7907,PropSessionExpiryInterval 4906]}
TEST(Publish5QCTest, Encode23) {
uint8_t pkt[] = {0x35, 0xbe, 0x1, 0x0, 0x3, 0x4c, 0xfa, 0x13, 0x18, 0x4f, 0xa8, 0x1, 0x11, 0x0, 0x0, 0x54, 0xbf, 0x29, 0x30, 0x26, 0x0, 0x1a, 0x68, 0xa0, 0xd1, 0xac, 0x16, 0x5, 0xa5, 0xe6, 0x3d, 0xd7, 0xcf, 0x89, 0xf4, 0x13, 0x0, 0x7c, 0x91, 0x36, 0x99, 0xc1, 0x8c, 0x7e, 0x66, 0xf, 0xf6, 0x2f, 0x0, 0x9, 0xe7, 0x75, 0x32, 0xa, 0x2d, 0xc4, 0xbc, 0xcb, 0x46, 0x13, 0x2d, 0x22, 0x12, 0x0, 0xc, 0xf3, 0x38, 0x5d, 0xa1, 0x5a, 0x46, 0xd, 0xa6, 0xc6, 0x65, 0x6c, 0xb6, 0x9, 0x0, 0x19, 0x7, 0x5f, 0xe4, 0x33, 0x56, 0x65, 0x3c, 0x1c, 0x5b, 0x69, 0xee, 0xd, 0xa9, 0xbc, 0x79, 0xbb, 0x1c, 0x30, 0x91, 0x6f, 0x5f, 0x38, 0xa0, 0x74, 0xba, 0x1a, 0x0, 0x12, 0xbd, 0x1c, 0x88, 0x19, 0x37, 0x83, 0x54, 0x1a, 0xef, 0xa7, 0xdd, 0xe8, 0x9, 0x41, 0x3, 0xeb, 0x6e, 0xcd, 0x22, 0x63, 0x71, 0x28, 0xcc, 0x22, 0x7f, 0x4e, 0x1, 0x51, 0x2, 0x0, 0x0, 0x6b, 0x96, 0x19, 0xa3, 0x9, 0x0, 0x13, 0x4b, 0xf0, 0xf8, 0xd9, 0x19, 0x74, 0xb0, 0xf9, 0x79, 0xb1, 0x14, 0x5, 0x86, 0xc6, 0x32, 0x31, 0xc8, 0x15, 0x9b, 0x1, 0xc1, 0x13, 0x4e, 0x69, 0x29, 0x25, 0x22, 0x1e, 0xe3, 0x11, 0x0, 0x0, 0x13, 0x2a, 0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
  uint8_t topic_bytes[] = {0x4c, 0xfa, 0x13};
  lwmqtt_string_t topic = {3, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = true;
uint8_t msg_bytes[] = {0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 13;

  uint8_t bytesprops1[] = {0xe7, 0x75, 0x32, 0xa, 0x2d, 0xc4, 0xbc, 0xcb, 0x46};
  uint8_t bytesprops0[] = {0x68, 0xa0, 0xd1, 0xac, 0x16, 0x5, 0xa5, 0xe6, 0x3d, 0xd7, 0xcf, 0x89, 0xf4, 0x13, 0x0, 0x7c, 0x91, 0x36, 0x99, 0xc1, 0x8c, 0x7e, 0x66, 0xf, 0xf6, 0x2f};
  uint8_t bytesprops2[] = {0xf3, 0x38, 0x5d, 0xa1, 0x5a, 0x46, 0xd, 0xa6, 0xc6, 0x65, 0x6c, 0xb6};
  uint8_t bytesprops3[] = {0x7, 0x5f, 0xe4, 0x33, 0x56, 0x65, 0x3c, 0x1c, 0x5b, 0x69, 0xee, 0xd, 0xa9, 0xbc, 0x79, 0xbb, 0x1c, 0x30, 0x91, 0x6f, 0x5f, 0x38, 0xa0, 0x74, 0xba};
  uint8_t bytesprops4[] = {0xbd, 0x1c, 0x88, 0x19, 0x37, 0x83, 0x54, 0x1a, 0xef, 0xa7, 0xdd, 0xe8, 0x9, 0x41, 0x3, 0xeb, 0x6e, 0xcd};
  uint8_t bytesprops5[] = {0x4b, 0xf0, 0xf8, 0xd9, 0x19, 0x74, 0xb0, 0xf9, 0x79, 0xb1, 0x14, 0x5, 0x86, 0xc6, 0x32, 0x31, 0xc8, 0x15, 0x9b};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21695}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 48}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={26, (char*)&bytesprops0}, .v={9, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 11554}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {25, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 25457}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 204}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32590}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27542}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 163}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 193}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20073}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 37}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 7907}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 4906}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 6223, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "L\250\DC3", _pubPktID = 6223, _pubBody = ".K\236\242\210\250\192\219\175h\175p\249", _pubProps = [PropSessionExpiryInterval 21695,PropSubscriptionIdentifierAvailable 48,PropUserProperty "h\160\209\172\SYN\ENQ\165\230=\215\207\137\244\DC3\NUL|\145\&6\153\193\140~f\SI\246/" "\231u2\n-\196\188\203F",PropServerKeepAlive 11554,PropAssignedClientIdentifier "\243\&8]\161ZF\r\166\198el\182",PropCorrelationData "\a_\228\&3Ve<\FS[i\238\r\169\188y\187\FS0\145o_8\160t\186",PropResponseInformation "\189\FS\136\EM7\131T\SUB\239\167\221\232\tA\ETX\235n\205",PropTopicAliasMaximum 25457,PropWildcardSubscriptionAvailable 204,PropTopicAliasMaximum 32590,PropPayloadFormatIndicator 81,PropMessageExpiryInterval 27542,PropRequestResponseInformation 163,PropCorrelationData "K\240\248\217\EMt\176\249y\177\DC4\ENQ\134\198\&21\200\NAK\155",PropPayloadFormatIndicator 193,PropServerKeepAlive 20073,PropSubscriptionIdentifierAvailable 37,PropTopicAliasMaximum 7907,PropSessionExpiryInterval 4906]}
TEST(Publish5QCTest, Decode23) {
uint8_t pkt[] = {0x35, 0xbe, 0x1, 0x0, 0x3, 0x4c, 0xfa, 0x13, 0x18, 0x4f, 0xa8, 0x1, 0x11, 0x0, 0x0, 0x54, 0xbf, 0x29, 0x30, 0x26, 0x0, 0x1a, 0x68, 0xa0, 0xd1, 0xac, 0x16, 0x5, 0xa5, 0xe6, 0x3d, 0xd7, 0xcf, 0x89, 0xf4, 0x13, 0x0, 0x7c, 0x91, 0x36, 0x99, 0xc1, 0x8c, 0x7e, 0x66, 0xf, 0xf6, 0x2f, 0x0, 0x9, 0xe7, 0x75, 0x32, 0xa, 0x2d, 0xc4, 0xbc, 0xcb, 0x46, 0x13, 0x2d, 0x22, 0x12, 0x0, 0xc, 0xf3, 0x38, 0x5d, 0xa1, 0x5a, 0x46, 0xd, 0xa6, 0xc6, 0x65, 0x6c, 0xb6, 0x9, 0x0, 0x19, 0x7, 0x5f, 0xe4, 0x33, 0x56, 0x65, 0x3c, 0x1c, 0x5b, 0x69, 0xee, 0xd, 0xa9, 0xbc, 0x79, 0xbb, 0x1c, 0x30, 0x91, 0x6f, 0x5f, 0x38, 0xa0, 0x74, 0xba, 0x1a, 0x0, 0x12, 0xbd, 0x1c, 0x88, 0x19, 0x37, 0x83, 0x54, 0x1a, 0xef, 0xa7, 0xdd, 0xe8, 0x9, 0x41, 0x3, 0xeb, 0x6e, 0xcd, 0x22, 0x63, 0x71, 0x28, 0xcc, 0x22, 0x7f, 0x4e, 0x1, 0x51, 0x2, 0x0, 0x0, 0x6b, 0x96, 0x19, 0xa3, 0x9, 0x0, 0x13, 0x4b, 0xf0, 0xf8, 0xd9, 0x19, 0x74, 0xb0, 0xf9, 0x79, 0xb1, 0x14, 0x5, 0x86, 0xc6, 0x32, 0x31, 0xc8, 0x15, 0x9b, 0x1, 0xc1, 0x13, 0x4e, 0x69, 0x29, 0x25, 0x22, 0x1e, 0xe3, 0x11, 0x0, 0x0, 0x13, 0x2a, 0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x4c, 0xfa, 0x13};
  lwmqtt_string_t exp_topic = {3, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x2e, 0x4b, 0xec, 0xf2, 0xd2, 0xfa, 0xc0, 0xdb, 0xaf, 0x68, 0xaf, 0x70, 0xf9};
  lwmqtt_string_t exp_body = {13, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 6223);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 3);
EXPECT_EQ(msg.payload_len, 13);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 13);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "^;.\197y\SO\163S\245~\178g\ETB", _pubPktID = 32148, _pubBody = "V\DC4\DC3 ZQ\164[\157n\197\162X\"*\220LH\RSF\206\255)Xpu!=", _pubProps = [PropSharedSubscriptionAvailable 5]}
TEST(Publish5QCTest, Encode24) {
uint8_t pkt[] = {0x34, 0x30, 0x0, 0xd, 0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17, 0x7d, 0x94, 0x2, 0x2a, 0x5, 0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
  uint8_t topic_bytes[] = {0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17};
  lwmqtt_string_t topic = {13, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 28;

  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 5}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 32148, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "^;.\197y\SO\163S\245~\178g\ETB", _pubPktID = 32148, _pubBody = "V\DC4\DC3 ZQ\164[\157n\197\162X\"*\220LH\RSF\206\255)Xpu!=", _pubProps = [PropSharedSubscriptionAvailable 5]}
TEST(Publish5QCTest, Decode24) {
uint8_t pkt[] = {0x34, 0x30, 0x0, 0xd, 0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17, 0x7d, 0x94, 0x2, 0x2a, 0x5, 0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x5e, 0x3b, 0x2e, 0xc5, 0x79, 0xe, 0xa3, 0x53, 0xf5, 0x7e, 0xb2, 0x67, 0x17};
  lwmqtt_string_t exp_topic = {13, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x56, 0x14, 0x13, 0x20, 0x5a, 0x51, 0xa4, 0x5b, 0x9d, 0x6e, 0xc5, 0xa2, 0x58, 0x22, 0x2a, 0xdc, 0x4c, 0x48, 0x1e, 0x46, 0xce, 0xff, 0x29, 0x58, 0x70, 0x75, 0x21, 0x3d};
  lwmqtt_string_t exp_body = {28, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 32148);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 13);
EXPECT_EQ(msg.payload_len, 28);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 28);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "Vk\181\201\ETXZ\DC4\208\170\201\tDEB\153]Q\232", _pubPktID = 2981, _pubBody = "\\>V\153p|W\163\148\254\SYN@q\238?", _pubProps = [PropPayloadFormatIndicator 104,PropMaximumQoS 226,PropWildcardSubscriptionAvailable 205,PropWildcardSubscriptionAvailable 60,PropCorrelationData "\235\225\DLE\160\166;<C\STX\171\197\135M\147\STXF",PropSubscriptionIdentifierAvailable 130,PropTopicAliasMaximum 21996,PropReasonString "3,V\216\209",PropTopicAlias 13827,PropAuthenticationMethod "\147\&6\221",PropResponseInformation "\245\DC2;mj\164\148R\193\av\224\&6\154\245\fq\206|\134\137\166\ESCt\232",PropRequestResponseInformation 141,PropMessageExpiryInterval 19030,PropSubscriptionIdentifier 30,PropSharedSubscriptionAvailable 145,PropAuthenticationData "\150Q2\139\GS\252\228\DC3\220D\a",PropUserProperty "\"\216\DC4\156w\r!\134m\191W\170\v\238\160y-b\169C" "p\243v\NUL]\141",PropSubscriptionIdentifierAvailable 58,PropRetainAvailable 88,PropResponseTopic "|\236[1\SUB\147\232\211W \134\143\208\DC3\183",PropServerReference "\248",PropServerKeepAlive 8987,PropPayloadFormatIndicator 128,PropResponseInformation "\242pW\231\ETB\248#SH\149\214K\141z",PropRetainAvailable 136,PropRetainAvailable 40,PropResponseInformation "\180\171\180U3\162\134\251\SYN\DC4\SOV\199E\219\222\\\149"]}
TEST(Publish5QCTest, Encode25) {
uint8_t pkt[] = {0x34, 0xf5, 0x1, 0x0, 0x12, 0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8, 0xb, 0xa5, 0xce, 0x1, 0x1, 0x68, 0x24, 0xe2, 0x28, 0xcd, 0x28, 0x3c, 0x9, 0x0, 0x10, 0xeb, 0xe1, 0x10, 0xa0, 0xa6, 0x3b, 0x3c, 0x43, 0x2, 0xab, 0xc5, 0x87, 0x4d, 0x93, 0x2, 0x46, 0x29, 0x82, 0x22, 0x55, 0xec, 0x1f, 0x0, 0x5, 0x33, 0x2c, 0x56, 0xd8, 0xd1, 0x23, 0x36, 0x3, 0x15, 0x0, 0x3, 0x93, 0x36, 0xdd, 0x1a, 0x0, 0x19, 0xf5, 0x12, 0x3b, 0x6d, 0x6a, 0xa4, 0x94, 0x52, 0xc1, 0x7, 0x76, 0xe0, 0x36, 0x9a, 0xf5, 0xc, 0x71, 0xce, 0x7c, 0x86, 0x89, 0xa6, 0x1b, 0x74, 0xe8, 0x19, 0x8d, 0x2, 0x0, 0x0, 0x4a, 0x56, 0xb, 0x1e, 0x2a, 0x91, 0x16, 0x0, 0xb, 0x96, 0x51, 0x32, 0x8b, 0x1d, 0xfc, 0xe4, 0x13, 0xdc, 0x44, 0x7, 0x26, 0x0, 0x14, 0x22, 0xd8, 0x14, 0x9c, 0x77, 0xd, 0x21, 0x86, 0x6d, 0xbf, 0x57, 0xaa, 0xb, 0xee, 0xa0, 0x79, 0x2d, 0x62, 0xa9, 0x43, 0x0, 0x6, 0x70, 0xf3, 0x76, 0x0, 0x5d, 0x8d, 0x29, 0x3a, 0x25, 0x58, 0x8, 0x0, 0xf, 0x7c, 0xec, 0x5b, 0x31, 0x1a, 0x93, 0xe8, 0xd3, 0x57, 0x20, 0x86, 0x8f, 0xd0, 0x13, 0xb7, 0x1c, 0x0, 0x1, 0xf8, 0x13, 0x23, 0x1b, 0x1, 0x80, 0x1a, 0x0, 0xe, 0xf2, 0x70, 0x57, 0xe7, 0x17, 0xf8, 0x23, 0x53, 0x48, 0x95, 0xd6, 0x4b, 0x8d, 0x7a, 0x25, 0x88, 0x25, 0x28, 0x1a, 0x0, 0x12, 0xb4, 0xab, 0xb4, 0x55, 0x33, 0xa2, 0x86, 0xfb, 0x16, 0x14, 0xe, 0x56, 0xc7, 0x45, 0xdb, 0xde, 0x5c, 0x95, 0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
  uint8_t topic_bytes[] = {0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 15;

  uint8_t bytesprops0[] = {0xeb, 0xe1, 0x10, 0xa0, 0xa6, 0x3b, 0x3c, 0x43, 0x2, 0xab, 0xc5, 0x87, 0x4d, 0x93, 0x2, 0x46};
  uint8_t bytesprops1[] = {0x33, 0x2c, 0x56, 0xd8, 0xd1};
  uint8_t bytesprops2[] = {0x93, 0x36, 0xdd};
  uint8_t bytesprops3[] = {0xf5, 0x12, 0x3b, 0x6d, 0x6a, 0xa4, 0x94, 0x52, 0xc1, 0x7, 0x76, 0xe0, 0x36, 0x9a, 0xf5, 0xc, 0x71, 0xce, 0x7c, 0x86, 0x89, 0xa6, 0x1b, 0x74, 0xe8};
  uint8_t bytesprops4[] = {0x96, 0x51, 0x32, 0x8b, 0x1d, 0xfc, 0xe4, 0x13, 0xdc, 0x44, 0x7};
  uint8_t bytesprops6[] = {0x70, 0xf3, 0x76, 0x0, 0x5d, 0x8d};
  uint8_t bytesprops5[] = {0x22, 0xd8, 0x14, 0x9c, 0x77, 0xd, 0x21, 0x86, 0x6d, 0xbf, 0x57, 0xaa, 0xb, 0xee, 0xa0, 0x79, 0x2d, 0x62, 0xa9, 0x43};
  uint8_t bytesprops7[] = {0x7c, 0xec, 0x5b, 0x31, 0x1a, 0x93, 0xe8, 0xd3, 0x57, 0x20, 0x86, 0x8f, 0xd0, 0x13, 0xb7};
  uint8_t bytesprops8[] = {0xf8};
  uint8_t bytesprops9[] = {0xf2, 0x70, 0x57, 0xe7, 0x17, 0xf8, 0x23, 0x53, 0x48, 0x95, 0xd6, 0x4b, 0x8d, 0x7a};
  uint8_t bytesprops10[] = {0xb4, 0xab, 0xb4, 0x55, 0x33, 0xa2, 0x86, 0xfb, 0x16, 0x14, 0xe, 0x56, 0xc7, 0x45, 0xdb, 0xde, 0x5c, 0x95};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 226}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 205}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 60}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 130}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 21996}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {5, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 13827}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {25, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19030}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 30}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 145}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={20, (char*)&bytesprops5}, .v={6, (char*)&bytesprops6}}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 58}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 88}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {15, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 8987}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 128}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 136}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 40}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 2981, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "Vk\181\201\ETXZ\DC4\208\170\201\tDEB\153]Q\232", _pubPktID = 2981, _pubBody = "\\>V\153p|W\163\148\254\SYN@q\238?", _pubProps = [PropPayloadFormatIndicator 104,PropMaximumQoS 226,PropWildcardSubscriptionAvailable 205,PropWildcardSubscriptionAvailable 60,PropCorrelationData "\235\225\DLE\160\166;<C\STX\171\197\135M\147\STXF",PropSubscriptionIdentifierAvailable 130,PropTopicAliasMaximum 21996,PropReasonString "3,V\216\209",PropTopicAlias 13827,PropAuthenticationMethod "\147\&6\221",PropResponseInformation "\245\DC2;mj\164\148R\193\av\224\&6\154\245\fq\206|\134\137\166\ESCt\232",PropRequestResponseInformation 141,PropMessageExpiryInterval 19030,PropSubscriptionIdentifier 30,PropSharedSubscriptionAvailable 145,PropAuthenticationData "\150Q2\139\GS\252\228\DC3\220D\a",PropUserProperty "\"\216\DC4\156w\r!\134m\191W\170\v\238\160y-b\169C" "p\243v\NUL]\141",PropSubscriptionIdentifierAvailable 58,PropRetainAvailable 88,PropResponseTopic "|\236[1\SUB\147\232\211W \134\143\208\DC3\183",PropServerReference "\248",PropServerKeepAlive 8987,PropPayloadFormatIndicator 128,PropResponseInformation "\242pW\231\ETB\248#SH\149\214K\141z",PropRetainAvailable 136,PropRetainAvailable 40,PropResponseInformation "\180\171\180U3\162\134\251\SYN\DC4\SOV\199E\219\222\\\149"]}
TEST(Publish5QCTest, Decode25) {
uint8_t pkt[] = {0x34, 0xf5, 0x1, 0x0, 0x12, 0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8, 0xb, 0xa5, 0xce, 0x1, 0x1, 0x68, 0x24, 0xe2, 0x28, 0xcd, 0x28, 0x3c, 0x9, 0x0, 0x10, 0xeb, 0xe1, 0x10, 0xa0, 0xa6, 0x3b, 0x3c, 0x43, 0x2, 0xab, 0xc5, 0x87, 0x4d, 0x93, 0x2, 0x46, 0x29, 0x82, 0x22, 0x55, 0xec, 0x1f, 0x0, 0x5, 0x33, 0x2c, 0x56, 0xd8, 0xd1, 0x23, 0x36, 0x3, 0x15, 0x0, 0x3, 0x93, 0x36, 0xdd, 0x1a, 0x0, 0x19, 0xf5, 0x12, 0x3b, 0x6d, 0x6a, 0xa4, 0x94, 0x52, 0xc1, 0x7, 0x76, 0xe0, 0x36, 0x9a, 0xf5, 0xc, 0x71, 0xce, 0x7c, 0x86, 0x89, 0xa6, 0x1b, 0x74, 0xe8, 0x19, 0x8d, 0x2, 0x0, 0x0, 0x4a, 0x56, 0xb, 0x1e, 0x2a, 0x91, 0x16, 0x0, 0xb, 0x96, 0x51, 0x32, 0x8b, 0x1d, 0xfc, 0xe4, 0x13, 0xdc, 0x44, 0x7, 0x26, 0x0, 0x14, 0x22, 0xd8, 0x14, 0x9c, 0x77, 0xd, 0x21, 0x86, 0x6d, 0xbf, 0x57, 0xaa, 0xb, 0xee, 0xa0, 0x79, 0x2d, 0x62, 0xa9, 0x43, 0x0, 0x6, 0x70, 0xf3, 0x76, 0x0, 0x5d, 0x8d, 0x29, 0x3a, 0x25, 0x58, 0x8, 0x0, 0xf, 0x7c, 0xec, 0x5b, 0x31, 0x1a, 0x93, 0xe8, 0xd3, 0x57, 0x20, 0x86, 0x8f, 0xd0, 0x13, 0xb7, 0x1c, 0x0, 0x1, 0xf8, 0x13, 0x23, 0x1b, 0x1, 0x80, 0x1a, 0x0, 0xe, 0xf2, 0x70, 0x57, 0xe7, 0x17, 0xf8, 0x23, 0x53, 0x48, 0x95, 0xd6, 0x4b, 0x8d, 0x7a, 0x25, 0x88, 0x25, 0x28, 0x1a, 0x0, 0x12, 0xb4, 0xab, 0xb4, 0x55, 0x33, 0xa2, 0x86, 0xfb, 0x16, 0x14, 0xe, 0x56, 0xc7, 0x45, 0xdb, 0xde, 0x5c, 0x95, 0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x56, 0x6b, 0xb5, 0xc9, 0x3, 0x5a, 0x14, 0xd0, 0xaa, 0xc9, 0x9, 0x44, 0x45, 0x42, 0x99, 0x5d, 0x51, 0xe8};
  lwmqtt_string_t exp_topic = {18, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x5c, 0x3e, 0x56, 0x99, 0x70, 0x7c, 0x57, 0xa3, 0x94, 0xfe, 0x16, 0x40, 0x71, 0xee, 0x3f};
  lwmqtt_string_t exp_body = {15, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 2981);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 18);
EXPECT_EQ(msg.payload_len, 15);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 15);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "", _pubPktID = 12988, _pubBody = "\252Q\161\SUB\150\190\247\174s\151T8\149C\NAK9;)\159\188\140bs", _pubProps = [PropRequestProblemInformation 31,PropAssignedClientIdentifier "\DC3\182\192\154\225\188^@\162S\227\251\178",PropAuthenticationMethod "l\171X\185\ETBzS\160",PropRetainAvailable 56,PropSubscriptionIdentifier 3,PropResponseTopic "\rGO4\241\253\189",PropPayloadFormatIndicator 10,PropWillDelayInterval 27162,PropUserProperty "\t|Q\220\160\SOH\160\DC4%\208\208\DELV\221 \157\205\&4\162" "\133t\211\178\159\232\204HKv|y\SOH\224\&6\234",PropAssignedClientIdentifier "",PropRequestProblemInformation 241,PropServerKeepAlive 24630,PropMessageExpiryInterval 3172,PropUserProperty "R\191\DC2\242Ix\135\156.\141\205i\155\174\196\&1" "\SYN\160.\234\RS)",PropSubscriptionIdentifier 19,PropUserProperty "\146[\196\170\191+\231(y#\US,\151\224\ETB\233\215\142)#\ETX\ENQ\214\&0\253\200" "\237.\226]\171\248\148\189j\162\RS\247Z\ETX\165\207\224o\137",PropSharedSubscriptionAvailable 62,PropSubscriptionIdentifier 10,PropAuthenticationData "\184\&2\244\200\164nX5\251\191:\249z\172\168\210;\182\NAK\190C\179\147W\237Q\192\196"]}
TEST(Publish5QCTest, Encode26) {
uint8_t pkt[] = {0x33, 0xf6, 0x1, 0x0, 0x0, 0x32, 0xbc, 0xd9, 0x1, 0x17, 0x1f, 0x12, 0x0, 0xd, 0x13, 0xb6, 0xc0, 0x9a, 0xe1, 0xbc, 0x5e, 0x40, 0xa2, 0x53, 0xe3, 0xfb, 0xb2, 0x15, 0x0, 0x8, 0x6c, 0xab, 0x58, 0xb9, 0x17, 0x7a, 0x53, 0xa0, 0x25, 0x38, 0xb, 0x3, 0x8, 0x0, 0x7, 0xd, 0x47, 0x4f, 0x34, 0xf1, 0xfd, 0xbd, 0x1, 0xa, 0x18, 0x0, 0x0, 0x6a, 0x1a, 0x26, 0x0, 0x13, 0x9, 0x7c, 0x51, 0xdc, 0xa0, 0x1, 0xa0, 0x14, 0x25, 0xd0, 0xd0, 0x7f, 0x56, 0xdd, 0x20, 0x9d, 0xcd, 0x34, 0xa2, 0x0, 0x10, 0x85, 0x74, 0xd3, 0xb2, 0x9f, 0xe8, 0xcc, 0x48, 0x4b, 0x76, 0x7c, 0x79, 0x1, 0xe0, 0x36, 0xea, 0x12, 0x0, 0x0, 0x17, 0xf1, 0x13, 0x60, 0x36, 0x2, 0x0, 0x0, 0xc, 0x64, 0x26, 0x0, 0x10, 0x52, 0xbf, 0x12, 0xf2, 0x49, 0x78, 0x87, 0x9c, 0x2e, 0x8d, 0xcd, 0x69, 0x9b, 0xae, 0xc4, 0x31, 0x0, 0x6, 0x16, 0xa0, 0x2e, 0xea, 0x1e, 0x29, 0xb, 0x13, 0x26, 0x0, 0x1a, 0x92, 0x5b, 0xc4, 0xaa, 0xbf, 0x2b, 0xe7, 0x28, 0x79, 0x23, 0x1f, 0x2c, 0x97, 0xe0, 0x17, 0xe9, 0xd7, 0x8e, 0x29, 0x23, 0x3, 0x5, 0xd6, 0x30, 0xfd, 0xc8, 0x0, 0x13, 0xed, 0x2e, 0xe2, 0x5d, 0xab, 0xf8, 0x94, 0xbd, 0x6a, 0xa2, 0x1e, 0xf7, 0x5a, 0x3, 0xa5, 0xcf, 0xe0, 0x6f, 0x89, 0x2a, 0x3e, 0xb, 0xa, 0x16, 0x0, 0x1c, 0xb8, 0x32, 0xf4, 0xc8, 0xa4, 0x6e, 0x58, 0x35, 0xfb, 0xbf, 0x3a, 0xf9, 0x7a, 0xac, 0xa8, 0xd2, 0x3b, 0xb6, 0x15, 0xbe, 0x43, 0xb3, 0x93, 0x57, 0xed, 0x51, 0xc0, 0xc4, 0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 23;

  uint8_t bytesprops0[] = {0x13, 0xb6, 0xc0, 0x9a, 0xe1, 0xbc, 0x5e, 0x40, 0xa2, 0x53, 0xe3, 0xfb, 0xb2};
  uint8_t bytesprops1[] = {0x6c, 0xab, 0x58, 0xb9, 0x17, 0x7a, 0x53, 0xa0};
  uint8_t bytesprops2[] = {0xd, 0x47, 0x4f, 0x34, 0xf1, 0xfd, 0xbd};
  uint8_t bytesprops4[] = {0x85, 0x74, 0xd3, 0xb2, 0x9f, 0xe8, 0xcc, 0x48, 0x4b, 0x76, 0x7c, 0x79, 0x1, 0xe0, 0x36, 0xea};
  uint8_t bytesprops3[] = {0x9, 0x7c, 0x51, 0xdc, 0xa0, 0x1, 0xa0, 0x14, 0x25, 0xd0, 0xd0, 0x7f, 0x56, 0xdd, 0x20, 0x9d, 0xcd, 0x34, 0xa2};
  uint8_t bytesprops5[] = {0};
  uint8_t bytesprops7[] = {0x16, 0xa0, 0x2e, 0xea, 0x1e, 0x29};
  uint8_t bytesprops6[] = {0x52, 0xbf, 0x12, 0xf2, 0x49, 0x78, 0x87, 0x9c, 0x2e, 0x8d, 0xcd, 0x69, 0x9b, 0xae, 0xc4, 0x31};
  uint8_t bytesprops9[] = {0xed, 0x2e, 0xe2, 0x5d, 0xab, 0xf8, 0x94, 0xbd, 0x6a, 0xa2, 0x1e, 0xf7, 0x5a, 0x3, 0xa5, 0xcf, 0xe0, 0x6f, 0x89};
  uint8_t bytesprops8[] = {0x92, 0x5b, 0xc4, 0xaa, 0xbf, 0x2b, 0xe7, 0x28, 0x79, 0x23, 0x1f, 0x2c, 0x97, 0xe0, 0x17, 0xe9, 0xd7, 0x8e, 0x29, 0x23, 0x3, 0x5, 0xd6, 0x30, 0xfd, 0xc8};
  uint8_t bytesprops10[] = {0xb8, 0x32, 0xf4, 0xc8, 0xa4, 0x6e, 0x58, 0x35, 0xfb, 0xbf, 0x3a, 0xf9, 0x7a, 0xac, 0xa8, 0xd2, 0x3b, 0xb6, 0x15, 0xbe, 0x43, 0xb3, 0x93, 0x57, 0xed, 0x51, 0xc0, 0xc4};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 31}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {13, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 56}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 3}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 10}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 27162}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={19, (char*)&bytesprops3}, .v={16, (char*)&bytesprops4}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 241}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 24630}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3172}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={16, (char*)&bytesprops6}, .v={6, (char*)&bytesprops7}}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 19}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={26, (char*)&bytesprops8}, .v={19, (char*)&bytesprops9}}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 62}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 10}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 12988, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "", _pubPktID = 12988, _pubBody = "\252Q\161\SUB\150\190\247\174s\151T8\149C\NAK9;)\159\188\140bs", _pubProps = [PropRequestProblemInformation 31,PropAssignedClientIdentifier "\DC3\182\192\154\225\188^@\162S\227\251\178",PropAuthenticationMethod "l\171X\185\ETBzS\160",PropRetainAvailable 56,PropSubscriptionIdentifier 3,PropResponseTopic "\rGO4\241\253\189",PropPayloadFormatIndicator 10,PropWillDelayInterval 27162,PropUserProperty "\t|Q\220\160\SOH\160\DC4%\208\208\DELV\221 \157\205\&4\162" "\133t\211\178\159\232\204HKv|y\SOH\224\&6\234",PropAssignedClientIdentifier "",PropRequestProblemInformation 241,PropServerKeepAlive 24630,PropMessageExpiryInterval 3172,PropUserProperty "R\191\DC2\242Ix\135\156.\141\205i\155\174\196\&1" "\SYN\160.\234\RS)",PropSubscriptionIdentifier 19,PropUserProperty "\146[\196\170\191+\231(y#\US,\151\224\ETB\233\215\142)#\ETX\ENQ\214\&0\253\200" "\237.\226]\171\248\148\189j\162\RS\247Z\ETX\165\207\224o\137",PropSharedSubscriptionAvailable 62,PropSubscriptionIdentifier 10,PropAuthenticationData "\184\&2\244\200\164nX5\251\191:\249z\172\168\210;\182\NAK\190C\179\147W\237Q\192\196"]}
TEST(Publish5QCTest, Decode26) {
uint8_t pkt[] = {0x33, 0xf6, 0x1, 0x0, 0x0, 0x32, 0xbc, 0xd9, 0x1, 0x17, 0x1f, 0x12, 0x0, 0xd, 0x13, 0xb6, 0xc0, 0x9a, 0xe1, 0xbc, 0x5e, 0x40, 0xa2, 0x53, 0xe3, 0xfb, 0xb2, 0x15, 0x0, 0x8, 0x6c, 0xab, 0x58, 0xb9, 0x17, 0x7a, 0x53, 0xa0, 0x25, 0x38, 0xb, 0x3, 0x8, 0x0, 0x7, 0xd, 0x47, 0x4f, 0x34, 0xf1, 0xfd, 0xbd, 0x1, 0xa, 0x18, 0x0, 0x0, 0x6a, 0x1a, 0x26, 0x0, 0x13, 0x9, 0x7c, 0x51, 0xdc, 0xa0, 0x1, 0xa0, 0x14, 0x25, 0xd0, 0xd0, 0x7f, 0x56, 0xdd, 0x20, 0x9d, 0xcd, 0x34, 0xa2, 0x0, 0x10, 0x85, 0x74, 0xd3, 0xb2, 0x9f, 0xe8, 0xcc, 0x48, 0x4b, 0x76, 0x7c, 0x79, 0x1, 0xe0, 0x36, 0xea, 0x12, 0x0, 0x0, 0x17, 0xf1, 0x13, 0x60, 0x36, 0x2, 0x0, 0x0, 0xc, 0x64, 0x26, 0x0, 0x10, 0x52, 0xbf, 0x12, 0xf2, 0x49, 0x78, 0x87, 0x9c, 0x2e, 0x8d, 0xcd, 0x69, 0x9b, 0xae, 0xc4, 0x31, 0x0, 0x6, 0x16, 0xa0, 0x2e, 0xea, 0x1e, 0x29, 0xb, 0x13, 0x26, 0x0, 0x1a, 0x92, 0x5b, 0xc4, 0xaa, 0xbf, 0x2b, 0xe7, 0x28, 0x79, 0x23, 0x1f, 0x2c, 0x97, 0xe0, 0x17, 0xe9, 0xd7, 0x8e, 0x29, 0x23, 0x3, 0x5, 0xd6, 0x30, 0xfd, 0xc8, 0x0, 0x13, 0xed, 0x2e, 0xe2, 0x5d, 0xab, 0xf8, 0x94, 0xbd, 0x6a, 0xa2, 0x1e, 0xf7, 0x5a, 0x3, 0xa5, 0xcf, 0xe0, 0x6f, 0x89, 0x2a, 0x3e, 0xb, 0xa, 0x16, 0x0, 0x1c, 0xb8, 0x32, 0xf4, 0xc8, 0xa4, 0x6e, 0x58, 0x35, 0xfb, 0xbf, 0x3a, 0xf9, 0x7a, 0xac, 0xa8, 0xd2, 0x3b, 0xb6, 0x15, 0xbe, 0x43, 0xb3, 0x93, 0x57, 0xed, 0x51, 0xc0, 0xc4, 0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0};
  lwmqtt_string_t exp_topic = {0, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xfc, 0x51, 0xa1, 0x1a, 0x96, 0xbe, 0xf7, 0xae, 0x73, 0x97, 0x54, 0x38, 0x95, 0x43, 0x15, 0x39, 0x3b, 0x29, 0x9f, 0xbc, 0x8c, 0x62, 0x73};
  lwmqtt_string_t exp_body = {23, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 12988);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 0);
EXPECT_EQ(msg.payload_len, 23);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 23);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\a\206+\241_)~\225\174V\232:\184e", _pubPktID = 1045, _pubBody = "E\243x", _pubProps = [PropUserProperty "\135O\CAN\f(\133\158\229\237\&0:g$\SUB((\243W\228" "6\214\190\&0\238[\170\&5k\222\192?`\202,j\166\STX[\DLE\211\228\214\230\191\210\216W",PropUserProperty "Q\199y\153\173\ENQ\161\205DUN\128\231\149" "Eh\176\198\182\233\162\153#a\157\v\DLE\STX\135\NAK\201\128H\140",PropRequestResponseInformation 104,PropAssignedClientIdentifier "w\147\SUB\154RXi#\179\241\169k/E\187\170\US\SI(o]ZT\177\EM<\178",PropAuthenticationMethod "\206\160\SYN\ETB\231\245WV@\DELv\235",PropSessionExpiryInterval 9123,PropRequestProblemInformation 198,PropSharedSubscriptionAvailable 144,PropWildcardSubscriptionAvailable 30,PropTopicAlias 14192,PropTopicAliasMaximum 28876,PropContentType "\218\195\141G\183\247\135+\242fa\220\239\167\173u\SI\235\141",PropRequestProblemInformation 177,PropSessionExpiryInterval 85,PropReceiveMaximum 15015,PropResponseTopic "t$S\140\222\&6",PropRetainAvailable 130,PropPayloadFormatIndicator 149,PropResponseInformation "%!",PropResponseInformation "#z\191\231\149\EM\218\t\SYN?\202p\207\225\150c\t\228",PropUserProperty "\213z\f\194<\151" "\233\STX\184a),>\245I&\184\241\tE\224\ESC0h\130\138\254\206\209!M",PropServerKeepAlive 22611,PropCorrelationData "\128}\SO\223\179\158\136EI\244\145\ESCHq\DC4>:+\242\129\196I\245&\196\241",PropMessageExpiryInterval 9516,PropRetainAvailable 117,PropTopicAliasMaximum 18796,PropAuthenticationData "\228*W"]}
TEST(Publish5QCTest, Encode27) {
uint8_t pkt[] = {0x33, 0xcd, 0x2, 0x0, 0xe, 0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65, 0x4, 0x15, 0xb6, 0x2, 0x26, 0x0, 0x13, 0x87, 0x4f, 0x18, 0xc, 0x28, 0x85, 0x9e, 0xe5, 0xed, 0x30, 0x3a, 0x67, 0x24, 0x1a, 0x28, 0x28, 0xf3, 0x57, 0xe4, 0x0, 0x1c, 0x36, 0xd6, 0xbe, 0x30, 0xee, 0x5b, 0xaa, 0x35, 0x6b, 0xde, 0xc0, 0x3f, 0x60, 0xca, 0x2c, 0x6a, 0xa6, 0x2, 0x5b, 0x10, 0xd3, 0xe4, 0xd6, 0xe6, 0xbf, 0xd2, 0xd8, 0x57, 0x26, 0x0, 0xe, 0x51, 0xc7, 0x79, 0x99, 0xad, 0x5, 0xa1, 0xcd, 0x44, 0x55, 0x4e, 0x80, 0xe7, 0x95, 0x0, 0x14, 0x45, 0x68, 0xb0, 0xc6, 0xb6, 0xe9, 0xa2, 0x99, 0x23, 0x61, 0x9d, 0xb, 0x10, 0x2, 0x87, 0x15, 0xc9, 0x80, 0x48, 0x8c, 0x19, 0x68, 0x12, 0x0, 0x1b, 0x77, 0x93, 0x1a, 0x9a, 0x52, 0x58, 0x69, 0x23, 0xb3, 0xf1, 0xa9, 0x6b, 0x2f, 0x45, 0xbb, 0xaa, 0x1f, 0xf, 0x28, 0x6f, 0x5d, 0x5a, 0x54, 0xb1, 0x19, 0x3c, 0xb2, 0x15, 0x0, 0xc, 0xce, 0xa0, 0x16, 0x17, 0xe7, 0xf5, 0x57, 0x56, 0x40, 0x7f, 0x76, 0xeb, 0x11, 0x0, 0x0, 0x23, 0xa3, 0x17, 0xc6, 0x2a, 0x90, 0x28, 0x1e, 0x23, 0x37, 0x70, 0x22, 0x70, 0xcc, 0x3, 0x0, 0x13, 0xda, 0xc3, 0x8d, 0x47, 0xb7, 0xf7, 0x87, 0x2b, 0xf2, 0x66, 0x61, 0xdc, 0xef, 0xa7, 0xad, 0x75, 0xf, 0xeb, 0x8d, 0x17, 0xb1, 0x11, 0x0, 0x0, 0x0, 0x55, 0x21, 0x3a, 0xa7, 0x8, 0x0, 0x6, 0x74, 0x24, 0x53, 0x8c, 0xde, 0x36, 0x25, 0x82, 0x1, 0x95, 0x1a, 0x0, 0x2, 0x25, 0x21, 0x1a, 0x0, 0x12, 0x23, 0x7a, 0xbf, 0xe7, 0x95, 0x19, 0xda, 0x9, 0x16, 0x3f, 0xca, 0x70, 0xcf, 0xe1, 0x96, 0x63, 0x9, 0xe4, 0x26, 0x0, 0x6, 0xd5, 0x7a, 0xc, 0xc2, 0x3c, 0x97, 0x0, 0x19, 0xe9, 0x2, 0xb8, 0x61, 0x29, 0x2c, 0x3e, 0xf5, 0x49, 0x26, 0xb8, 0xf1, 0x9, 0x45, 0xe0, 0x1b, 0x30, 0x68, 0x82, 0x8a, 0xfe, 0xce, 0xd1, 0x21, 0x4d, 0x13, 0x58, 0x53, 0x9, 0x0, 0x1a, 0x80, 0x7d, 0xe, 0xdf, 0xb3, 0x9e, 0x88, 0x45, 0x49, 0xf4, 0x91, 0x1b, 0x48, 0x71, 0x14, 0x3e, 0x3a, 0x2b, 0xf2, 0x81, 0xc4, 0x49, 0xf5, 0x26, 0xc4, 0xf1, 0x2, 0x0, 0x0, 0x25, 0x2c, 0x25, 0x75, 0x22, 0x49, 0x6c, 0x16, 0x0, 0x3, 0xe4, 0x2a, 0x57, 0x45, 0xf3, 0x78};
  uint8_t topic_bytes[] = {0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65};
  lwmqtt_string_t topic = {14, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x45, 0xf3, 0x78};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 3;

  uint8_t bytesprops1[] = {0x36, 0xd6, 0xbe, 0x30, 0xee, 0x5b, 0xaa, 0x35, 0x6b, 0xde, 0xc0, 0x3f, 0x60, 0xca, 0x2c, 0x6a, 0xa6, 0x2, 0x5b, 0x10, 0xd3, 0xe4, 0xd6, 0xe6, 0xbf, 0xd2, 0xd8, 0x57};
  uint8_t bytesprops0[] = {0x87, 0x4f, 0x18, 0xc, 0x28, 0x85, 0x9e, 0xe5, 0xed, 0x30, 0x3a, 0x67, 0x24, 0x1a, 0x28, 0x28, 0xf3, 0x57, 0xe4};
  uint8_t bytesprops3[] = {0x45, 0x68, 0xb0, 0xc6, 0xb6, 0xe9, 0xa2, 0x99, 0x23, 0x61, 0x9d, 0xb, 0x10, 0x2, 0x87, 0x15, 0xc9, 0x80, 0x48, 0x8c};
  uint8_t bytesprops2[] = {0x51, 0xc7, 0x79, 0x99, 0xad, 0x5, 0xa1, 0xcd, 0x44, 0x55, 0x4e, 0x80, 0xe7, 0x95};
  uint8_t bytesprops4[] = {0x77, 0x93, 0x1a, 0x9a, 0x52, 0x58, 0x69, 0x23, 0xb3, 0xf1, 0xa9, 0x6b, 0x2f, 0x45, 0xbb, 0xaa, 0x1f, 0xf, 0x28, 0x6f, 0x5d, 0x5a, 0x54, 0xb1, 0x19, 0x3c, 0xb2};
  uint8_t bytesprops5[] = {0xce, 0xa0, 0x16, 0x17, 0xe7, 0xf5, 0x57, 0x56, 0x40, 0x7f, 0x76, 0xeb};
  uint8_t bytesprops6[] = {0xda, 0xc3, 0x8d, 0x47, 0xb7, 0xf7, 0x87, 0x2b, 0xf2, 0x66, 0x61, 0xdc, 0xef, 0xa7, 0xad, 0x75, 0xf, 0xeb, 0x8d};
  uint8_t bytesprops7[] = {0x74, 0x24, 0x53, 0x8c, 0xde, 0x36};
  uint8_t bytesprops8[] = {0x25, 0x21};
  uint8_t bytesprops9[] = {0x23, 0x7a, 0xbf, 0xe7, 0x95, 0x19, 0xda, 0x9, 0x16, 0x3f, 0xca, 0x70, 0xcf, 0xe1, 0x96, 0x63, 0x9, 0xe4};
  uint8_t bytesprops11[] = {0xe9, 0x2, 0xb8, 0x61, 0x29, 0x2c, 0x3e, 0xf5, 0x49, 0x26, 0xb8, 0xf1, 0x9, 0x45, 0xe0, 0x1b, 0x30, 0x68, 0x82, 0x8a, 0xfe, 0xce, 0xd1, 0x21, 0x4d};
  uint8_t bytesprops10[] = {0xd5, 0x7a, 0xc, 0xc2, 0x3c, 0x97};
  uint8_t bytesprops12[] = {0x80, 0x7d, 0xe, 0xdf, 0xb3, 0x9e, 0x88, 0x45, 0x49, 0xf4, 0x91, 0x1b, 0x48, 0x71, 0x14, 0x3e, 0x3a, 0x2b, 0xf2, 0x81, 0xc4, 0x49, 0xf5, 0x26, 0xc4, 0xf1};
  uint8_t bytesprops13[] = {0xe4, 0x2a, 0x57};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={19, (char*)&bytesprops0}, .v={28, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={14, (char*)&bytesprops2}, .v={20, (char*)&bytesprops3}}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {27, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9123}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 198}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 144}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 30}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14192}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28876}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {19, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 177}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 85}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15015}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 130}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 149}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={6, (char*)&bytesprops10}, .v={25, (char*)&bytesprops11}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22611}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9516}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 18796}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {3, (char*)&bytesprops13}}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 1045, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\a\206+\241_)~\225\174V\232:\184e", _pubPktID = 1045, _pubBody = "E\243x", _pubProps = [PropUserProperty "\135O\CAN\f(\133\158\229\237\&0:g$\SUB((\243W\228" "6\214\190\&0\238[\170\&5k\222\192?`\202,j\166\STX[\DLE\211\228\214\230\191\210\216W",PropUserProperty "Q\199y\153\173\ENQ\161\205DUN\128\231\149" "Eh\176\198\182\233\162\153#a\157\v\DLE\STX\135\NAK\201\128H\140",PropRequestResponseInformation 104,PropAssignedClientIdentifier "w\147\SUB\154RXi#\179\241\169k/E\187\170\US\SI(o]ZT\177\EM<\178",PropAuthenticationMethod "\206\160\SYN\ETB\231\245WV@\DELv\235",PropSessionExpiryInterval 9123,PropRequestProblemInformation 198,PropSharedSubscriptionAvailable 144,PropWildcardSubscriptionAvailable 30,PropTopicAlias 14192,PropTopicAliasMaximum 28876,PropContentType "\218\195\141G\183\247\135+\242fa\220\239\167\173u\SI\235\141",PropRequestProblemInformation 177,PropSessionExpiryInterval 85,PropReceiveMaximum 15015,PropResponseTopic "t$S\140\222\&6",PropRetainAvailable 130,PropPayloadFormatIndicator 149,PropResponseInformation "%!",PropResponseInformation "#z\191\231\149\EM\218\t\SYN?\202p\207\225\150c\t\228",PropUserProperty "\213z\f\194<\151" "\233\STX\184a),>\245I&\184\241\tE\224\ESC0h\130\138\254\206\209!M",PropServerKeepAlive 22611,PropCorrelationData "\128}\SO\223\179\158\136EI\244\145\ESCHq\DC4>:+\242\129\196I\245&\196\241",PropMessageExpiryInterval 9516,PropRetainAvailable 117,PropTopicAliasMaximum 18796,PropAuthenticationData "\228*W"]}
TEST(Publish5QCTest, Decode27) {
uint8_t pkt[] = {0x33, 0xcd, 0x2, 0x0, 0xe, 0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65, 0x4, 0x15, 0xb6, 0x2, 0x26, 0x0, 0x13, 0x87, 0x4f, 0x18, 0xc, 0x28, 0x85, 0x9e, 0xe5, 0xed, 0x30, 0x3a, 0x67, 0x24, 0x1a, 0x28, 0x28, 0xf3, 0x57, 0xe4, 0x0, 0x1c, 0x36, 0xd6, 0xbe, 0x30, 0xee, 0x5b, 0xaa, 0x35, 0x6b, 0xde, 0xc0, 0x3f, 0x60, 0xca, 0x2c, 0x6a, 0xa6, 0x2, 0x5b, 0x10, 0xd3, 0xe4, 0xd6, 0xe6, 0xbf, 0xd2, 0xd8, 0x57, 0x26, 0x0, 0xe, 0x51, 0xc7, 0x79, 0x99, 0xad, 0x5, 0xa1, 0xcd, 0x44, 0x55, 0x4e, 0x80, 0xe7, 0x95, 0x0, 0x14, 0x45, 0x68, 0xb0, 0xc6, 0xb6, 0xe9, 0xa2, 0x99, 0x23, 0x61, 0x9d, 0xb, 0x10, 0x2, 0x87, 0x15, 0xc9, 0x80, 0x48, 0x8c, 0x19, 0x68, 0x12, 0x0, 0x1b, 0x77, 0x93, 0x1a, 0x9a, 0x52, 0x58, 0x69, 0x23, 0xb3, 0xf1, 0xa9, 0x6b, 0x2f, 0x45, 0xbb, 0xaa, 0x1f, 0xf, 0x28, 0x6f, 0x5d, 0x5a, 0x54, 0xb1, 0x19, 0x3c, 0xb2, 0x15, 0x0, 0xc, 0xce, 0xa0, 0x16, 0x17, 0xe7, 0xf5, 0x57, 0x56, 0x40, 0x7f, 0x76, 0xeb, 0x11, 0x0, 0x0, 0x23, 0xa3, 0x17, 0xc6, 0x2a, 0x90, 0x28, 0x1e, 0x23, 0x37, 0x70, 0x22, 0x70, 0xcc, 0x3, 0x0, 0x13, 0xda, 0xc3, 0x8d, 0x47, 0xb7, 0xf7, 0x87, 0x2b, 0xf2, 0x66, 0x61, 0xdc, 0xef, 0xa7, 0xad, 0x75, 0xf, 0xeb, 0x8d, 0x17, 0xb1, 0x11, 0x0, 0x0, 0x0, 0x55, 0x21, 0x3a, 0xa7, 0x8, 0x0, 0x6, 0x74, 0x24, 0x53, 0x8c, 0xde, 0x36, 0x25, 0x82, 0x1, 0x95, 0x1a, 0x0, 0x2, 0x25, 0x21, 0x1a, 0x0, 0x12, 0x23, 0x7a, 0xbf, 0xe7, 0x95, 0x19, 0xda, 0x9, 0x16, 0x3f, 0xca, 0x70, 0xcf, 0xe1, 0x96, 0x63, 0x9, 0xe4, 0x26, 0x0, 0x6, 0xd5, 0x7a, 0xc, 0xc2, 0x3c, 0x97, 0x0, 0x19, 0xe9, 0x2, 0xb8, 0x61, 0x29, 0x2c, 0x3e, 0xf5, 0x49, 0x26, 0xb8, 0xf1, 0x9, 0x45, 0xe0, 0x1b, 0x30, 0x68, 0x82, 0x8a, 0xfe, 0xce, 0xd1, 0x21, 0x4d, 0x13, 0x58, 0x53, 0x9, 0x0, 0x1a, 0x80, 0x7d, 0xe, 0xdf, 0xb3, 0x9e, 0x88, 0x45, 0x49, 0xf4, 0x91, 0x1b, 0x48, 0x71, 0x14, 0x3e, 0x3a, 0x2b, 0xf2, 0x81, 0xc4, 0x49, 0xf5, 0x26, 0xc4, 0xf1, 0x2, 0x0, 0x0, 0x25, 0x2c, 0x25, 0x75, 0x22, 0x49, 0x6c, 0x16, 0x0, 0x3, 0xe4, 0x2a, 0x57, 0x45, 0xf3, 0x78};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7, 0xce, 0x2b, 0xf1, 0x5f, 0x29, 0x7e, 0xe1, 0xae, 0x56, 0xe8, 0x3a, 0xb8, 0x65};
  lwmqtt_string_t exp_topic = {14, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x45, 0xf3, 0x78};
  lwmqtt_string_t exp_body = {3, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 1045);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 14);
EXPECT_EQ(msg.payload_len, 3);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 3);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\193`\187\247\203\252\193V\159\209\143}w\180\219\226\"\181nuE\nC\175-\SUB\141", _pubPktID = 0, _pubBody = "\213(\SUB\v\FS\224\252\152%p_*#w\218\204\240\237>\246", _pubProps = [PropReceiveMaximum 9423,PropMaximumQoS 52,PropSubscriptionIdentifierAvailable 143,PropRetainAvailable 169,PropServerKeepAlive 17612,PropWildcardSubscriptionAvailable 23,PropAssignedClientIdentifier "\185\154~\209#\ETB\140\220vi|\205P@|`\238^\137\194\250\207P",PropServerReference "bg\130Bs\SOHk\175\225\&1\206\186\129\234;m\149\163?\198\197\vI2",PropAuthenticationMethod "#\180\rR\SYN\146\154\238\163\163\204\225rk\221.UERH\ETB",PropCorrelationData "\173D\232\150\212",PropMessageExpiryInterval 22176,PropServerKeepAlive 26594,PropServerKeepAlive 339,PropServerReference "\EM\159S\176\t\228\156\DC1\227H\US\155\"q.\250\222\223\159\DC4\SOo\234[",PropSharedSubscriptionAvailable 144,PropSubscriptionIdentifierAvailable 236,PropRetainAvailable 111,PropCorrelationData "\198\144\221\167\158*\SYN\b\194\216",PropServerKeepAlive 20480,PropReceiveMaximum 24642,PropWildcardSubscriptionAvailable 206,PropMaximumQoS 243,PropAuthenticationData "\224M\n\225]e\226\213\239\&8\188=\234",PropAuthenticationMethod "\175\142\209/I\209\159\DEL\254i",PropWillDelayInterval 15570,PropAuthenticationData "&\EM'6a\253=f\231D\155",PropCorrelationData "\131\160\210\223\151\207%?S\219\DC4\US\129H\207\DLE\213p\CAN\136T"]}
TEST(Publish5QCTest, Encode28) {
uint8_t pkt[] = {0x30, 0xa1, 0x2, 0x0, 0x1b, 0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d, 0xee, 0x1, 0x21, 0x24, 0xcf, 0x24, 0x34, 0x29, 0x8f, 0x25, 0xa9, 0x13, 0x44, 0xcc, 0x28, 0x17, 0x12, 0x0, 0x17, 0xb9, 0x9a, 0x7e, 0xd1, 0x23, 0x17, 0x8c, 0xdc, 0x76, 0x69, 0x7c, 0xcd, 0x50, 0x40, 0x7c, 0x60, 0xee, 0x5e, 0x89, 0xc2, 0xfa, 0xcf, 0x50, 0x1c, 0x0, 0x18, 0x62, 0x67, 0x82, 0x42, 0x73, 0x1, 0x6b, 0xaf, 0xe1, 0x31, 0xce, 0xba, 0x81, 0xea, 0x3b, 0x6d, 0x95, 0xa3, 0x3f, 0xc6, 0xc5, 0xb, 0x49, 0x32, 0x15, 0x0, 0x15, 0x23, 0xb4, 0xd, 0x52, 0x16, 0x92, 0x9a, 0xee, 0xa3, 0xa3, 0xcc, 0xe1, 0x72, 0x6b, 0xdd, 0x2e, 0x55, 0x45, 0x52, 0x48, 0x17, 0x9, 0x0, 0x5, 0xad, 0x44, 0xe8, 0x96, 0xd4, 0x2, 0x0, 0x0, 0x56, 0xa0, 0x13, 0x67, 0xe2, 0x13, 0x1, 0x53, 0x1c, 0x0, 0x18, 0x19, 0x9f, 0x53, 0xb0, 0x9, 0xe4, 0x9c, 0x11, 0xe3, 0x48, 0x1f, 0x9b, 0x22, 0x71, 0x2e, 0xfa, 0xde, 0xdf, 0x9f, 0x14, 0xe, 0x6f, 0xea, 0x5b, 0x2a, 0x90, 0x29, 0xec, 0x25, 0x6f, 0x9, 0x0, 0xa, 0xc6, 0x90, 0xdd, 0xa7, 0x9e, 0x2a, 0x16, 0x8, 0xc2, 0xd8, 0x13, 0x50, 0x0, 0x21, 0x60, 0x42, 0x28, 0xce, 0x24, 0xf3, 0x16, 0x0, 0xd, 0xe0, 0x4d, 0xa, 0xe1, 0x5d, 0x65, 0xe2, 0xd5, 0xef, 0x38, 0xbc, 0x3d, 0xea, 0x15, 0x0, 0xa, 0xaf, 0x8e, 0xd1, 0x2f, 0x49, 0xd1, 0x9f, 0x7f, 0xfe, 0x69, 0x18, 0x0, 0x0, 0x3c, 0xd2, 0x16, 0x0, 0xb, 0x26, 0x19, 0x27, 0x36, 0x61, 0xfd, 0x3d, 0x66, 0xe7, 0x44, 0x9b, 0x9, 0x0, 0x15, 0x83, 0xa0, 0xd2, 0xdf, 0x97, 0xcf, 0x25, 0x3f, 0x53, 0xdb, 0x14, 0x1f, 0x81, 0x48, 0xcf, 0x10, 0xd5, 0x70, 0x18, 0x88, 0x54, 0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
  uint8_t topic_bytes[] = {0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS0;
msg.retained = false;
uint8_t msg_bytes[] = {0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 20;

  uint8_t bytesprops0[] = {0xb9, 0x9a, 0x7e, 0xd1, 0x23, 0x17, 0x8c, 0xdc, 0x76, 0x69, 0x7c, 0xcd, 0x50, 0x40, 0x7c, 0x60, 0xee, 0x5e, 0x89, 0xc2, 0xfa, 0xcf, 0x50};
  uint8_t bytesprops1[] = {0x62, 0x67, 0x82, 0x42, 0x73, 0x1, 0x6b, 0xaf, 0xe1, 0x31, 0xce, 0xba, 0x81, 0xea, 0x3b, 0x6d, 0x95, 0xa3, 0x3f, 0xc6, 0xc5, 0xb, 0x49, 0x32};
  uint8_t bytesprops2[] = {0x23, 0xb4, 0xd, 0x52, 0x16, 0x92, 0x9a, 0xee, 0xa3, 0xa3, 0xcc, 0xe1, 0x72, 0x6b, 0xdd, 0x2e, 0x55, 0x45, 0x52, 0x48, 0x17};
  uint8_t bytesprops3[] = {0xad, 0x44, 0xe8, 0x96, 0xd4};
  uint8_t bytesprops4[] = {0x19, 0x9f, 0x53, 0xb0, 0x9, 0xe4, 0x9c, 0x11, 0xe3, 0x48, 0x1f, 0x9b, 0x22, 0x71, 0x2e, 0xfa, 0xde, 0xdf, 0x9f, 0x14, 0xe, 0x6f, 0xea, 0x5b};
  uint8_t bytesprops5[] = {0xc6, 0x90, 0xdd, 0xa7, 0x9e, 0x2a, 0x16, 0x8, 0xc2, 0xd8};
  uint8_t bytesprops6[] = {0xe0, 0x4d, 0xa, 0xe1, 0x5d, 0x65, 0xe2, 0xd5, 0xef, 0x38, 0xbc, 0x3d, 0xea};
  uint8_t bytesprops7[] = {0xaf, 0x8e, 0xd1, 0x2f, 0x49, 0xd1, 0x9f, 0x7f, 0xfe, 0x69};
  uint8_t bytesprops8[] = {0x26, 0x19, 0x27, 0x36, 0x61, 0xfd, 0x3d, 0x66, 0xe7, 0x44, 0x9b};
  uint8_t bytesprops9[] = {0x83, 0xa0, 0xd2, 0xdf, 0x97, 0xcf, 0x25, 0x3f, 0x53, 0xdb, 0x14, 0x1f, 0x81, 0x48, 0xcf, 0x10, 0xd5, 0x70, 0x18, 0x88, 0x54};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 9423}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 52}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 143}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 169}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 17612}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 23}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {23, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {5, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22176}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 26594}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 339}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 144}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 236}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 111}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20480}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 24642}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 206}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 243}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {13, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 15570}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {21, (char*)&bytesprops9}}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "\193`\187\247\203\252\193V\159\209\143}w\180\219\226\"\181nuE\nC\175-\SUB\141", _pubPktID = 0, _pubBody = "\213(\SUB\v\FS\224\252\152%p_*#w\218\204\240\237>\246", _pubProps = [PropReceiveMaximum 9423,PropMaximumQoS 52,PropSubscriptionIdentifierAvailable 143,PropRetainAvailable 169,PropServerKeepAlive 17612,PropWildcardSubscriptionAvailable 23,PropAssignedClientIdentifier "\185\154~\209#\ETB\140\220vi|\205P@|`\238^\137\194\250\207P",PropServerReference "bg\130Bs\SOHk\175\225\&1\206\186\129\234;m\149\163?\198\197\vI2",PropAuthenticationMethod "#\180\rR\SYN\146\154\238\163\163\204\225rk\221.UERH\ETB",PropCorrelationData "\173D\232\150\212",PropMessageExpiryInterval 22176,PropServerKeepAlive 26594,PropServerKeepAlive 339,PropServerReference "\EM\159S\176\t\228\156\DC1\227H\US\155\"q.\250\222\223\159\DC4\SOo\234[",PropSharedSubscriptionAvailable 144,PropSubscriptionIdentifierAvailable 236,PropRetainAvailable 111,PropCorrelationData "\198\144\221\167\158*\SYN\b\194\216",PropServerKeepAlive 20480,PropReceiveMaximum 24642,PropWildcardSubscriptionAvailable 206,PropMaximumQoS 243,PropAuthenticationData "\224M\n\225]e\226\213\239\&8\188=\234",PropAuthenticationMethod "\175\142\209/I\209\159\DEL\254i",PropWillDelayInterval 15570,PropAuthenticationData "&\EM'6a\253=f\231D\155",PropCorrelationData "\131\160\210\223\151\207%?S\219\DC4\US\129H\207\DLE\213p\CAN\136T"]}
TEST(Publish5QCTest, Decode28) {
uint8_t pkt[] = {0x30, 0xa1, 0x2, 0x0, 0x1b, 0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d, 0xee, 0x1, 0x21, 0x24, 0xcf, 0x24, 0x34, 0x29, 0x8f, 0x25, 0xa9, 0x13, 0x44, 0xcc, 0x28, 0x17, 0x12, 0x0, 0x17, 0xb9, 0x9a, 0x7e, 0xd1, 0x23, 0x17, 0x8c, 0xdc, 0x76, 0x69, 0x7c, 0xcd, 0x50, 0x40, 0x7c, 0x60, 0xee, 0x5e, 0x89, 0xc2, 0xfa, 0xcf, 0x50, 0x1c, 0x0, 0x18, 0x62, 0x67, 0x82, 0x42, 0x73, 0x1, 0x6b, 0xaf, 0xe1, 0x31, 0xce, 0xba, 0x81, 0xea, 0x3b, 0x6d, 0x95, 0xa3, 0x3f, 0xc6, 0xc5, 0xb, 0x49, 0x32, 0x15, 0x0, 0x15, 0x23, 0xb4, 0xd, 0x52, 0x16, 0x92, 0x9a, 0xee, 0xa3, 0xa3, 0xcc, 0xe1, 0x72, 0x6b, 0xdd, 0x2e, 0x55, 0x45, 0x52, 0x48, 0x17, 0x9, 0x0, 0x5, 0xad, 0x44, 0xe8, 0x96, 0xd4, 0x2, 0x0, 0x0, 0x56, 0xa0, 0x13, 0x67, 0xe2, 0x13, 0x1, 0x53, 0x1c, 0x0, 0x18, 0x19, 0x9f, 0x53, 0xb0, 0x9, 0xe4, 0x9c, 0x11, 0xe3, 0x48, 0x1f, 0x9b, 0x22, 0x71, 0x2e, 0xfa, 0xde, 0xdf, 0x9f, 0x14, 0xe, 0x6f, 0xea, 0x5b, 0x2a, 0x90, 0x29, 0xec, 0x25, 0x6f, 0x9, 0x0, 0xa, 0xc6, 0x90, 0xdd, 0xa7, 0x9e, 0x2a, 0x16, 0x8, 0xc2, 0xd8, 0x13, 0x50, 0x0, 0x21, 0x60, 0x42, 0x28, 0xce, 0x24, 0xf3, 0x16, 0x0, 0xd, 0xe0, 0x4d, 0xa, 0xe1, 0x5d, 0x65, 0xe2, 0xd5, 0xef, 0x38, 0xbc, 0x3d, 0xea, 0x15, 0x0, 0xa, 0xaf, 0x8e, 0xd1, 0x2f, 0x49, 0xd1, 0x9f, 0x7f, 0xfe, 0x69, 0x18, 0x0, 0x0, 0x3c, 0xd2, 0x16, 0x0, 0xb, 0x26, 0x19, 0x27, 0x36, 0x61, 0xfd, 0x3d, 0x66, 0xe7, 0x44, 0x9b, 0x9, 0x0, 0x15, 0x83, 0xa0, 0xd2, 0xdf, 0x97, 0xcf, 0x25, 0x3f, 0x53, 0xdb, 0x14, 0x1f, 0x81, 0x48, 0xcf, 0x10, 0xd5, 0x70, 0x18, 0x88, 0x54, 0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0xc1, 0x60, 0xbb, 0xf7, 0xcb, 0xfc, 0xc1, 0x56, 0x9f, 0xd1, 0x8f, 0x7d, 0x77, 0xb4, 0xdb, 0xe2, 0x22, 0xb5, 0x6e, 0x75, 0x45, 0xa, 0x43, 0xaf, 0x2d, 0x1a, 0x8d};
  lwmqtt_string_t exp_topic = {27, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0xd5, 0x28, 0x1a, 0xb, 0x1c, 0xe0, 0xfc, 0x98, 0x25, 0x70, 0x5f, 0x2a, 0x23, 0x77, 0xda, 0xcc, 0xf0, 0xed, 0x3e, 0xf6};
  lwmqtt_string_t exp_body = {20, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS0);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 0);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 27);
EXPECT_EQ(msg.payload_len, 20);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 20);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "}\180", _pubPktID = 11899, _pubBody = "\DC2\ACK%\181\DC3\164\204\173\204\223\DC2\161\&3uzk\152Xn\200\154d\154\143\245z\234", _pubProps = [PropTopicAliasMaximum 7896,PropResponseInformation "S9",PropRequestProblemInformation 238,PropTopicAlias 5269,PropWildcardSubscriptionAvailable 89,PropAuthenticationData "Q\239\248\130D\175\208\216\245\175\251-j\166\254}?r",PropTopicAliasMaximum 13548,PropMaximumPacketSize 11043,PropTopicAliasMaximum 13191,PropMessageExpiryInterval 29315,PropServerReference "\193$\226\145\182\194\&5\164",PropWillDelayInterval 17549,PropSubscriptionIdentifier 5,PropReceiveMaximum 20528,PropMessageExpiryInterval 4596,PropServerReference "\190",PropResponseTopic "r-\150\ACKj;\171p\DLE\240F\139r\NUL\233\144\145P\222\255\191\164/G\EOTi\133",PropAssignedClientIdentifier "\184\239^\234\179hA\255\\\DC3\US",PropResponseTopic "\196\DLE\186\253\138hei\SYN\250",PropMaximumPacketSize 1183,PropContentType "\178\207h\154\174\205\178\169\DC2\t-\FS\131u",PropTopicAliasMaximum 4401,PropUserProperty "^\146;=I\fvo\187\SOH\200\202S\DC3I\151" ".\168g\207z\DC1\248\234\DC2\b\143\175D\204\228m\139\141\206&W|\US\157\235\176B~\128N",PropPayloadFormatIndicator 126,PropTopicAliasMaximum 698]}
TEST(Publish5QCTest, Encode29) {
uint8_t pkt[] = {0x34, 0xff, 0x1, 0x0, 0x2, 0x7d, 0xb4, 0x2e, 0x7b, 0xdc, 0x1, 0x22, 0x1e, 0xd8, 0x1a, 0x0, 0x2, 0x53, 0x39, 0x17, 0xee, 0x23, 0x14, 0x95, 0x28, 0x59, 0x16, 0x0, 0x12, 0x51, 0xef, 0xf8, 0x82, 0x44, 0xaf, 0xd0, 0xd8, 0xf5, 0xaf, 0xfb, 0x2d, 0x6a, 0xa6, 0xfe, 0x7d, 0x3f, 0x72, 0x22, 0x34, 0xec, 0x27, 0x0, 0x0, 0x2b, 0x23, 0x22, 0x33, 0x87, 0x2, 0x0, 0x0, 0x72, 0x83, 0x1c, 0x0, 0x8, 0xc1, 0x24, 0xe2, 0x91, 0xb6, 0xc2, 0x35, 0xa4, 0x18, 0x0, 0x0, 0x44, 0x8d, 0xb, 0x5, 0x21, 0x50, 0x30, 0x2, 0x0, 0x0, 0x11, 0xf4, 0x1c, 0x0, 0x1, 0xbe, 0x8, 0x0, 0x1b, 0x72, 0x2d, 0x96, 0x6, 0x6a, 0x3b, 0xab, 0x70, 0x10, 0xf0, 0x46, 0x8b, 0x72, 0x0, 0xe9, 0x90, 0x91, 0x50, 0xde, 0xff, 0xbf, 0xa4, 0x2f, 0x47, 0x4, 0x69, 0x85, 0x12, 0x0, 0xb, 0xb8, 0xef, 0x5e, 0xea, 0xb3, 0x68, 0x41, 0xff, 0x5c, 0x13, 0x1f, 0x8, 0x0, 0xa, 0xc4, 0x10, 0xba, 0xfd, 0x8a, 0x68, 0x65, 0x69, 0x16, 0xfa, 0x27, 0x0, 0x0, 0x4, 0x9f, 0x3, 0x0, 0xe, 0xb2, 0xcf, 0x68, 0x9a, 0xae, 0xcd, 0xb2, 0xa9, 0x12, 0x9, 0x2d, 0x1c, 0x83, 0x75, 0x22, 0x11, 0x31, 0x26, 0x0, 0x10, 0x5e, 0x92, 0x3b, 0x3d, 0x49, 0xc, 0x76, 0x6f, 0xbb, 0x1, 0xc8, 0xca, 0x53, 0x13, 0x49, 0x97, 0x0, 0x1e, 0x2e, 0xa8, 0x67, 0xcf, 0x7a, 0x11, 0xf8, 0xea, 0x12, 0x8, 0x8f, 0xaf, 0x44, 0xcc, 0xe4, 0x6d, 0x8b, 0x8d, 0xce, 0x26, 0x57, 0x7c, 0x1f, 0x9d, 0xeb, 0xb0, 0x42, 0x7e, 0x80, 0x4e, 0x1, 0x7e, 0x22, 0x2, 0xba, 0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
  uint8_t topic_bytes[] = {0x7d, 0xb4};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS2;
msg.retained = false;
uint8_t msg_bytes[] = {0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 27;

  uint8_t bytesprops0[] = {0x53, 0x39};
  uint8_t bytesprops1[] = {0x51, 0xef, 0xf8, 0x82, 0x44, 0xaf, 0xd0, 0xd8, 0xf5, 0xaf, 0xfb, 0x2d, 0x6a, 0xa6, 0xfe, 0x7d, 0x3f, 0x72};
  uint8_t bytesprops2[] = {0xc1, 0x24, 0xe2, 0x91, 0xb6, 0xc2, 0x35, 0xa4};
  uint8_t bytesprops3[] = {0xbe};
  uint8_t bytesprops4[] = {0x72, 0x2d, 0x96, 0x6, 0x6a, 0x3b, 0xab, 0x70, 0x10, 0xf0, 0x46, 0x8b, 0x72, 0x0, 0xe9, 0x90, 0x91, 0x50, 0xde, 0xff, 0xbf, 0xa4, 0x2f, 0x47, 0x4, 0x69, 0x85};
  uint8_t bytesprops5[] = {0xb8, 0xef, 0x5e, 0xea, 0xb3, 0x68, 0x41, 0xff, 0x5c, 0x13, 0x1f};
  uint8_t bytesprops6[] = {0xc4, 0x10, 0xba, 0xfd, 0x8a, 0x68, 0x65, 0x69, 0x16, 0xfa};
  uint8_t bytesprops7[] = {0xb2, 0xcf, 0x68, 0x9a, 0xae, 0xcd, 0xb2, 0xa9, 0x12, 0x9, 0x2d, 0x1c, 0x83, 0x75};
  uint8_t bytesprops9[] = {0x2e, 0xa8, 0x67, 0xcf, 0x7a, 0x11, 0xf8, 0xea, 0x12, 0x8, 0x8f, 0xaf, 0x44, 0xcc, 0xe4, 0x6d, 0x8b, 0x8d, 0xce, 0x26, 0x57, 0x7c, 0x1f, 0x9d, 0xeb, 0xb0, 0x42, 0x7e, 0x80, 0x4e};
  uint8_t bytesprops8[] = {0x5e, 0x92, 0x3b, 0x3d, 0x49, 0xc, 0x76, 0x6f, 0xbb, 0x1, 0xc8, 0xca, 0x53, 0x13, 0x49, 0x97};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 7896}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 238}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 5269}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 89}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13548}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 11043}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13191}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29315}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {8, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17549}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 5}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 20528}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4596}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {10, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1183}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4401}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={16, (char*)&bytesprops8}, .v={30, (char*)&bytesprops9}}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 126}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 698}},
  };

  lwmqtt_properties_t props = {25, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 11899, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "}\180", _pubPktID = 11899, _pubBody = "\DC2\ACK%\181\DC3\164\204\173\204\223\DC2\161\&3uzk\152Xn\200\154d\154\143\245z\234", _pubProps = [PropTopicAliasMaximum 7896,PropResponseInformation "S9",PropRequestProblemInformation 238,PropTopicAlias 5269,PropWildcardSubscriptionAvailable 89,PropAuthenticationData "Q\239\248\130D\175\208\216\245\175\251-j\166\254}?r",PropTopicAliasMaximum 13548,PropMaximumPacketSize 11043,PropTopicAliasMaximum 13191,PropMessageExpiryInterval 29315,PropServerReference "\193$\226\145\182\194\&5\164",PropWillDelayInterval 17549,PropSubscriptionIdentifier 5,PropReceiveMaximum 20528,PropMessageExpiryInterval 4596,PropServerReference "\190",PropResponseTopic "r-\150\ACKj;\171p\DLE\240F\139r\NUL\233\144\145P\222\255\191\164/G\EOTi\133",PropAssignedClientIdentifier "\184\239^\234\179hA\255\\\DC3\US",PropResponseTopic "\196\DLE\186\253\138hei\SYN\250",PropMaximumPacketSize 1183,PropContentType "\178\207h\154\174\205\178\169\DC2\t-\FS\131u",PropTopicAliasMaximum 4401,PropUserProperty "^\146;=I\fvo\187\SOH\200\202S\DC3I\151" ".\168g\207z\DC1\248\234\DC2\b\143\175D\204\228m\139\141\206&W|\US\157\235\176B~\128N",PropPayloadFormatIndicator 126,PropTopicAliasMaximum 698]}
TEST(Publish5QCTest, Decode29) {
uint8_t pkt[] = {0x34, 0xff, 0x1, 0x0, 0x2, 0x7d, 0xb4, 0x2e, 0x7b, 0xdc, 0x1, 0x22, 0x1e, 0xd8, 0x1a, 0x0, 0x2, 0x53, 0x39, 0x17, 0xee, 0x23, 0x14, 0x95, 0x28, 0x59, 0x16, 0x0, 0x12, 0x51, 0xef, 0xf8, 0x82, 0x44, 0xaf, 0xd0, 0xd8, 0xf5, 0xaf, 0xfb, 0x2d, 0x6a, 0xa6, 0xfe, 0x7d, 0x3f, 0x72, 0x22, 0x34, 0xec, 0x27, 0x0, 0x0, 0x2b, 0x23, 0x22, 0x33, 0x87, 0x2, 0x0, 0x0, 0x72, 0x83, 0x1c, 0x0, 0x8, 0xc1, 0x24, 0xe2, 0x91, 0xb6, 0xc2, 0x35, 0xa4, 0x18, 0x0, 0x0, 0x44, 0x8d, 0xb, 0x5, 0x21, 0x50, 0x30, 0x2, 0x0, 0x0, 0x11, 0xf4, 0x1c, 0x0, 0x1, 0xbe, 0x8, 0x0, 0x1b, 0x72, 0x2d, 0x96, 0x6, 0x6a, 0x3b, 0xab, 0x70, 0x10, 0xf0, 0x46, 0x8b, 0x72, 0x0, 0xe9, 0x90, 0x91, 0x50, 0xde, 0xff, 0xbf, 0xa4, 0x2f, 0x47, 0x4, 0x69, 0x85, 0x12, 0x0, 0xb, 0xb8, 0xef, 0x5e, 0xea, 0xb3, 0x68, 0x41, 0xff, 0x5c, 0x13, 0x1f, 0x8, 0x0, 0xa, 0xc4, 0x10, 0xba, 0xfd, 0x8a, 0x68, 0x65, 0x69, 0x16, 0xfa, 0x27, 0x0, 0x0, 0x4, 0x9f, 0x3, 0x0, 0xe, 0xb2, 0xcf, 0x68, 0x9a, 0xae, 0xcd, 0xb2, 0xa9, 0x12, 0x9, 0x2d, 0x1c, 0x83, 0x75, 0x22, 0x11, 0x31, 0x26, 0x0, 0x10, 0x5e, 0x92, 0x3b, 0x3d, 0x49, 0xc, 0x76, 0x6f, 0xbb, 0x1, 0xc8, 0xca, 0x53, 0x13, 0x49, 0x97, 0x0, 0x1e, 0x2e, 0xa8, 0x67, 0xcf, 0x7a, 0x11, 0xf8, 0xea, 0x12, 0x8, 0x8f, 0xaf, 0x44, 0xcc, 0xe4, 0x6d, 0x8b, 0x8d, 0xce, 0x26, 0x57, 0x7c, 0x1f, 0x9d, 0xeb, 0xb0, 0x42, 0x7e, 0x80, 0x4e, 0x1, 0x7e, 0x22, 0x2, 0xba, 0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x7d, 0xb4};
  lwmqtt_string_t exp_topic = {2, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x12, 0x6, 0x25, 0xb5, 0x13, 0xa4, 0xcc, 0xad, 0xcc, 0xdf, 0x12, 0xa1, 0x33, 0x75, 0x7a, 0x6b, 0x98, 0x58, 0x6e, 0xc8, 0x9a, 0x64, 0x9a, 0x8f, 0xf5, 0x7a, 0xea};
  lwmqtt_string_t exp_body = {27, (char*)&exp_body_bytes};
EXPECT_EQ(dup, false);
EXPECT_EQ(msg.qos, LWMQTT_QOS2);
EXPECT_EQ(msg.retained, false);
EXPECT_EQ(packet_id, 11899);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 2);
EXPECT_EQ(msg.payload_len, 27);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 27);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\150\tnz^#/~y\225", _pubPktID = 17773, _pubBody = "\130\\'n\215\&3\DC2\219\205\147\SOI\183c", _pubProps = [PropRequestProblemInformation 236]}
TEST(Publish5QCTest, Encode30) {
uint8_t pkt[] = {0x3b, 0x1f, 0x0, 0xa, 0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1, 0x45, 0x6d, 0x2, 0x17, 0xec, 0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
  uint8_t topic_bytes[] = {0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1};
  lwmqtt_string_t topic = {10, (char*)&topic_bytes};

  uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_message_t msg = lwmqtt_default_message;
msg.qos = LWMQTT_QOS1;
msg.retained = true;
uint8_t msg_bytes[] = {0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
msg.payload = (unsigned char*)&msg_bytes;
msg.payload_len = 14;

  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 236}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 17773, topic, msg, props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic = "\150\tnz^#/~y\225", _pubPktID = 17773, _pubBody = "\130\\'n\215\&3\DC2\219\205\147\SOI\183c", _pubProps = [PropRequestProblemInformation 236]}
TEST(Publish5QCTest, Decode30) {
uint8_t pkt[] = {0x3b, 0x1f, 0x0, 0xa, 0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1, 0x45, 0x6d, 0x2, 0x17, 0xec, 0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
bool dup;
uint16_t packet_id;
lwmqtt_string_t topic;
lwmqtt_message_t msg;
lwmqtt_serialized_properties_t props;
lwmqtt_err_t err = lwmqtt_decode_publish(pkt, sizeof(pkt), LWMQTT_MQTT5, &dup, &packet_id, &topic, &msg, &props);

EXPECT_EQ(err, LWMQTT_SUCCESS);
  uint8_t exp_topic_bytes[] = {0x96, 0x9, 0x6e, 0x7a, 0x5e, 0x23, 0x2f, 0x7e, 0x79, 0xe1};
  lwmqtt_string_t exp_topic = {10, (char*)&exp_topic_bytes};
  uint8_t exp_body_bytes[] = {0x82, 0x5c, 0x27, 0x6e, 0xd7, 0x33, 0x12, 0xdb, 0xcd, 0x93, 0xe, 0x49, 0xb7, 0x63};
  lwmqtt_string_t exp_body = {14, (char*)&exp_body_bytes};
EXPECT_EQ(dup, true);
EXPECT_EQ(msg.qos, LWMQTT_QOS1);
EXPECT_EQ(msg.retained, true);
EXPECT_EQ(packet_id, 17773);
EXPECT_ARRAY_EQ(exp_topic_bytes, reinterpret_cast<uint8_t*>(topic.data), 10);
EXPECT_EQ(msg.payload_len, 14);
EXPECT_ARRAY_EQ(exp_body_bytes, msg.payload, 14);
lwmqtt_string_t x = exp_topic;
x = exp_body;

}


// ConnectRequest {_username = Nothing, _password = Just "<\200\232q\179c\222\168\a\186M\US\251I\210\222w\195H8\NUL\242!X\199s\219\245\165i", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "e\166s3\SOH\158_\232u5y\249\184aJ\194\246\220\226\184\209\223\EM", _willMsg = "_\245\131\131I\205\b\225\ETB\152\SO\152\&0\ENQ\145<\158\t4:\135", _willProps = []}), _cleanSession = False, _keepAlive = 14400, _connID = "\NAK\178o-", _properties = []}
TEST(Connect311QCTest, Encode1) {
uint8_t pkt[] = {0x10, 0x40, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x2c, 0x38, 0x40, 0x0, 0x4, 0x15, 0xb2, 0x6f, 0x2d, 0x0, 0x17, 0x65, 0xa6, 0x73, 0x33, 0x1, 0x9e, 0x5f, 0xe8, 0x75, 0x35, 0x79, 0xf9, 0xb8, 0x61, 0x4a, 0xc2, 0xf6, 0xdc, 0xe2, 0xb8, 0xd1, 0xdf, 0x19, 0x0, 0x15, 0x5f, 0xf5, 0x83, 0x83, 0x49, 0xcd, 0x8, 0xe1, 0x17, 0x98, 0xe, 0x98, 0x30, 0x5, 0x91, 0x3c, 0x9e, 0x9, 0x34, 0x3a, 0x87};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x65, 0xa6, 0x73, 0x33, 0x1, 0x9e, 0x5f, 0xe8, 0x75, 0x35, 0x79, 0xf9, 0xb8, 0x61, 0x4a, 0xc2, 0xf6, 0xdc, 0xe2, 0xb8, 0xd1, 0xdf, 0x19};
  lwmqtt_string_t will_topic = {23, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x5f, 0xf5, 0x83, 0x83, 0x49, 0xcd, 0x8, 0xe1, 0x17, 0x98, 0xe, 0x98, 0x30, 0x5, 0x91, 0x3c, 0x9e, 0x9, 0x34, 0x3a, 0x87};
  lwmqtt_string_t will_payload = {21, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 14400;
  uint8_t client_id_bytes[] = {0x15, 0xb2, 0x6f, 0x2d};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x3c, 0xc8, 0xe8, 0x71, 0xb3, 0x63, 0xde, 0xa8, 0x7, 0xba, 0x4d, 0x1f, 0xfb, 0x49, 0xd2, 0xde, 0x77, 0xc3, 0x48, 0x38, 0x0, 0xf2, 0x21, 0x58, 0xc7, 0x73, 0xdb, 0xf5, 0xa5, 0x69};
  lwmqtt_string_t password = {30, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\157\&7\160\&4!<\152o", _willMsg = "\207\206*\r\196x\199J", _willProps = []}), _cleanSession = False, _keepAlive = 22372, _connID = "\153\215g\142q\253\SUB\139\224jU\202Kb\220Q\233\DC2\137\&5", _properties = []}
TEST(Connect311QCTest, Encode2) {
uint8_t pkt[] = {0x10, 0x34, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xc, 0x57, 0x64, 0x0, 0x14, 0x99, 0xd7, 0x67, 0x8e, 0x71, 0xfd, 0x1a, 0x8b, 0xe0, 0x6a, 0x55, 0xca, 0x4b, 0x62, 0xdc, 0x51, 0xe9, 0x12, 0x89, 0x35, 0x0, 0x8, 0x9d, 0x37, 0xa0, 0x34, 0x21, 0x3c, 0x98, 0x6f, 0x0, 0x8, 0xcf, 0xce, 0x2a, 0xd, 0xc4, 0x78, 0xc7, 0x4a};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x9d, 0x37, 0xa0, 0x34, 0x21, 0x3c, 0x98, 0x6f};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xcf, 0xce, 0x2a, 0xd, 0xc4, 0x78, 0xc7, 0x4a};
  lwmqtt_string_t will_payload = {8, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 22372;
  uint8_t client_id_bytes[] = {0x99, 0xd7, 0x67, 0x8e, 0x71, 0xfd, 0x1a, 0x8b, 0xe0, 0x6a, 0x55, 0xca, 0x4b, 0x62, 0xdc, 0x51, 0xe9, 0x12, 0x89, 0x35};
  lwmqtt_string_t client_id = {20, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\210\154\156`\157$\167\211\ACK|\EMc\FS\DC4;\244\132\247\250\DC1p\226", _password = Just "\250\211\178\rK\SUB\US\221G\171\f\202\222h\195\201\142\SOH\178\141\RS\179\234d\191G\245\249", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic = "\166\245E _4\192:\130\134\233", _willMsg = "\199!\216\227\149HhD#\178\nH@\210\185:C\147\183\168", _willProps = []}), _cleanSession = False, _keepAlive = 11307, _connID = "\214\137\207{L;\190\191\172O\206z4\183", _properties = []}
TEST(Connect311QCTest, Encode3) {
uint8_t pkt[] = {0x10, 0x73, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xc4, 0x2c, 0x2b, 0x0, 0xe, 0xd6, 0x89, 0xcf, 0x7b, 0x4c, 0x3b, 0xbe, 0xbf, 0xac, 0x4f, 0xce, 0x7a, 0x34, 0xb7, 0x0, 0xb, 0xa6, 0xf5, 0x45, 0x20, 0x5f, 0x34, 0xc0, 0x3a, 0x82, 0x86, 0xe9, 0x0, 0x14, 0xc7, 0x21, 0xd8, 0xe3, 0x95, 0x48, 0x68, 0x44, 0x23, 0xb2, 0xa, 0x48, 0x40, 0xd2, 0xb9, 0x3a, 0x43, 0x93, 0xb7, 0xa8, 0x0, 0x16, 0xd2, 0x9a, 0x9c, 0x60, 0x9d, 0x24, 0xa7, 0xd3, 0x6, 0x7c, 0x19, 0x63, 0x1c, 0x14, 0x3b, 0xf4, 0x84, 0xf7, 0xfa, 0x11, 0x70, 0xe2, 0x0, 0x1c, 0xfa, 0xd3, 0xb2, 0xd, 0x4b, 0x1a, 0x1f, 0xdd, 0x47, 0xab, 0xc, 0xca, 0xde, 0x68, 0xc3, 0xc9, 0x8e, 0x1, 0xb2, 0x8d, 0x1e, 0xb3, 0xea, 0x64, 0xbf, 0x47, 0xf5, 0xf9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa6, 0xf5, 0x45, 0x20, 0x5f, 0x34, 0xc0, 0x3a, 0x82, 0x86, 0xe9};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xc7, 0x21, 0xd8, 0xe3, 0x95, 0x48, 0x68, 0x44, 0x23, 0xb2, 0xa, 0x48, 0x40, 0xd2, 0xb9, 0x3a, 0x43, 0x93, 0xb7, 0xa8};
  lwmqtt_string_t will_payload = {20, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 11307;
  uint8_t client_id_bytes[] = {0xd6, 0x89, 0xcf, 0x7b, 0x4c, 0x3b, 0xbe, 0xbf, 0xac, 0x4f, 0xce, 0x7a, 0x34, 0xb7};
  lwmqtt_string_t client_id = {14, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xd2, 0x9a, 0x9c, 0x60, 0x9d, 0x24, 0xa7, 0xd3, 0x6, 0x7c, 0x19, 0x63, 0x1c, 0x14, 0x3b, 0xf4, 0x84, 0xf7, 0xfa, 0x11, 0x70, 0xe2};
  lwmqtt_string_t username = {22, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xfa, 0xd3, 0xb2, 0xd, 0x4b, 0x1a, 0x1f, 0xdd, 0x47, 0xab, 0xc, 0xca, 0xde, 0x68, 0xc3, 0xc9, 0x8e, 0x1, 0xb2, 0x8d, 0x1e, 0xb3, 0xea, 0x64, 0xbf, 0x47, 0xf5, 0xf9};
  lwmqtt_string_t password = {28, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\129&\239\168\247MW\197\EOT\DEL\231\f9.aTK,o\DC324I\149\171", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "\192\172\136", _willMsg = "W\132\155\204", _willProps = []}), _cleanSession = True, _keepAlive = 16616, _connID = "f4\EOTKMC\199\173\161\251\151", _properties = []}
TEST(Connect311QCTest, Encode4) {
uint8_t pkt[] = {0x10, 0x3d, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xa6, 0x40, 0xe8, 0x0, 0xb, 0x66, 0x34, 0x4, 0x4b, 0x4d, 0x43, 0xc7, 0xad, 0xa1, 0xfb, 0x97, 0x0, 0x3, 0xc0, 0xac, 0x88, 0x0, 0x4, 0x57, 0x84, 0x9b, 0xcc, 0x0, 0x19, 0x81, 0x26, 0xef, 0xa8, 0xf7, 0x4d, 0x57, 0xc5, 0x4, 0x7f, 0xe7, 0xc, 0x39, 0x2e, 0x61, 0x54, 0x4b, 0x2c, 0x6f, 0x13, 0x32, 0x34, 0x49, 0x95, 0xab};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xc0, 0xac, 0x88};
  lwmqtt_string_t will_topic = {3, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x57, 0x84, 0x9b, 0xcc};
  lwmqtt_string_t will_payload = {4, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 16616;
  uint8_t client_id_bytes[] = {0x66, 0x34, 0x4, 0x4b, 0x4d, 0x43, 0xc7, 0xad, 0xa1, 0xfb, 0x97};
  lwmqtt_string_t client_id = {11, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x81, 0x26, 0xef, 0xa8, 0xf7, 0x4d, 0x57, 0xc5, 0x4, 0x7f, 0xe7, 0xc, 0x39, 0x2e, 0x61, 0x54, 0x4b, 0x2c, 0x6f, 0x13, 0x32, 0x34, 0x49, 0x95, 0xab};
  lwmqtt_string_t username = {25, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "?w\155e\220+\213:#.\196F<M\247", _willMsg = "\163\226:\244\SYN\132\149D_\239a\242x\167x\211-\215\219\144\148g\235i\239\246\143\204tK", _willProps = []}), _cleanSession = False, _keepAlive = 25316, _connID = "\b", _properties = []}
TEST(Connect311QCTest, Encode5) {
uint8_t pkt[] = {0x10, 0x3e, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x2c, 0x62, 0xe4, 0x0, 0x1, 0x8, 0x0, 0xf, 0x3f, 0x77, 0x9b, 0x65, 0xdc, 0x2b, 0xd5, 0x3a, 0x23, 0x2e, 0xc4, 0x46, 0x3c, 0x4d, 0xf7, 0x0, 0x1e, 0xa3, 0xe2, 0x3a, 0xf4, 0x16, 0x84, 0x95, 0x44, 0x5f, 0xef, 0x61, 0xf2, 0x78, 0xa7, 0x78, 0xd3, 0x2d, 0xd7, 0xdb, 0x90, 0x94, 0x67, 0xeb, 0x69, 0xef, 0xf6, 0x8f, 0xcc, 0x74, 0x4b};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x3f, 0x77, 0x9b, 0x65, 0xdc, 0x2b, 0xd5, 0x3a, 0x23, 0x2e, 0xc4, 0x46, 0x3c, 0x4d, 0xf7};
  lwmqtt_string_t will_topic = {15, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xa3, 0xe2, 0x3a, 0xf4, 0x16, 0x84, 0x95, 0x44, 0x5f, 0xef, 0x61, 0xf2, 0x78, 0xa7, 0x78, 0xd3, 0x2d, 0xd7, 0xdb, 0x90, 0x94, 0x67, 0xeb, 0x69, 0xef, 0xf6, 0x8f, 0xcc, 0x74, 0x4b};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 25316;
  uint8_t client_id_bytes[] = {0x8};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\231\215\CAN\203\225\ETX1\228\EM$\170", _willMsg = "v\245\158;\210\154\234\241O\186u[,<\NAK'r>", _willProps = []}), _cleanSession = True, _keepAlive = 30216, _connID = "\ETBtE\131\"\233<\193T\DLE", _properties = []}
TEST(Connect311QCTest, Encode6) {
uint8_t pkt[] = {0x10, 0x37, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x16, 0x76, 0x8, 0x0, 0xa, 0x17, 0x74, 0x45, 0x83, 0x22, 0xe9, 0x3c, 0xc1, 0x54, 0x10, 0x0, 0xb, 0xe7, 0xd7, 0x18, 0xcb, 0xe1, 0x3, 0x31, 0xe4, 0x19, 0x24, 0xaa, 0x0, 0x12, 0x76, 0xf5, 0x9e, 0x3b, 0xd2, 0x9a, 0xea, 0xf1, 0x4f, 0xba, 0x75, 0x5b, 0x2c, 0x3c, 0x15, 0x27, 0x72, 0x3e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe7, 0xd7, 0x18, 0xcb, 0xe1, 0x3, 0x31, 0xe4, 0x19, 0x24, 0xaa};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x76, 0xf5, 0x9e, 0x3b, 0xd2, 0x9a, 0xea, 0xf1, 0x4f, 0xba, 0x75, 0x5b, 0x2c, 0x3c, 0x15, 0x27, 0x72, 0x3e};
  lwmqtt_string_t will_payload = {18, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 30216;
  uint8_t client_id_bytes[] = {0x17, 0x74, 0x45, 0x83, 0x22, 0xe9, 0x3c, 0xc1, 0x54, 0x10};
  lwmqtt_string_t client_id = {10, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\184\RS2\175$\t.Y\176C6\139.\188\209\208\199", _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "k_hun\216\209\212\219%\193\NAK[\175\250\232\STX\214\196)\SOH\135\SO\t", _willMsg = "\216\193J\242J\215\b\166\FS\181,u\246W&\128\245\STXbo\142d\186\234!\250\EM\219\136", _willProps = []}), _cleanSession = True, _keepAlive = 12402, _connID = "\157\DC4\228=k\DLE5N\171\v+\185\227", _properties = []}
TEST(Connect311QCTest, Encode7) {
uint8_t pkt[] = {0x10, 0x65, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x8e, 0x30, 0x72, 0x0, 0xd, 0x9d, 0x14, 0xe4, 0x3d, 0x6b, 0x10, 0x35, 0x4e, 0xab, 0xb, 0x2b, 0xb9, 0xe3, 0x0, 0x18, 0x6b, 0x5f, 0x68, 0x75, 0x6e, 0xd8, 0xd1, 0xd4, 0xdb, 0x25, 0xc1, 0x15, 0x5b, 0xaf, 0xfa, 0xe8, 0x2, 0xd6, 0xc4, 0x29, 0x1, 0x87, 0xe, 0x9, 0x0, 0x1d, 0xd8, 0xc1, 0x4a, 0xf2, 0x4a, 0xd7, 0x8, 0xa6, 0x1c, 0xb5, 0x2c, 0x75, 0xf6, 0x57, 0x26, 0x80, 0xf5, 0x2, 0x62, 0x6f, 0x8e, 0x64, 0xba, 0xea, 0x21, 0xfa, 0x19, 0xdb, 0x88, 0x0, 0x11, 0xb8, 0x1e, 0x32, 0xaf, 0x24, 0x9, 0x2e, 0x59, 0xb0, 0x43, 0x36, 0x8b, 0x2e, 0xbc, 0xd1, 0xd0, 0xc7};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x6b, 0x5f, 0x68, 0x75, 0x6e, 0xd8, 0xd1, 0xd4, 0xdb, 0x25, 0xc1, 0x15, 0x5b, 0xaf, 0xfa, 0xe8, 0x2, 0xd6, 0xc4, 0x29, 0x1, 0x87, 0xe, 0x9};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd8, 0xc1, 0x4a, 0xf2, 0x4a, 0xd7, 0x8, 0xa6, 0x1c, 0xb5, 0x2c, 0x75, 0xf6, 0x57, 0x26, 0x80, 0xf5, 0x2, 0x62, 0x6f, 0x8e, 0x64, 0xba, 0xea, 0x21, 0xfa, 0x19, 0xdb, 0x88};
  lwmqtt_string_t will_payload = {29, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 12402;
  uint8_t client_id_bytes[] = {0x9d, 0x14, 0xe4, 0x3d, 0x6b, 0x10, 0x35, 0x4e, 0xab, 0xb, 0x2b, 0xb9, 0xe3};
  lwmqtt_string_t client_id = {13, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xb8, 0x1e, 0x32, 0xaf, 0x24, 0x9, 0x2e, 0x59, 0xb0, 0x43, 0x36, 0x8b, 0x2e, 0xbc, 0xd1, 0xd0, 0xc7};
  lwmqtt_string_t username = {17, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "W\DC2v\185\154.x\154\183R\236\DC4\SI\179\251\231", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\230,\132\194wK\251\ENQ\NUL\154\229\223\206\215", _willMsg = "\149\250\&2EL\189\206", _willProps = []}), _cleanSession = True, _keepAlive = 4527, _connID = "\140Kc\DC2\DC2\249`", _properties = []}
TEST(Connect311QCTest, Encode8) {
uint8_t pkt[] = {0x10, 0x2c, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xe, 0x11, 0xaf, 0x0, 0x7, 0x8c, 0x4b, 0x63, 0x12, 0x12, 0xf9, 0x60, 0x0, 0xe, 0xe6, 0x2c, 0x84, 0xc2, 0x77, 0x4b, 0xfb, 0x5, 0x0, 0x9a, 0xe5, 0xdf, 0xce, 0xd7, 0x0, 0x7, 0x95, 0xfa, 0x32, 0x45, 0x4c, 0xbd, 0xce};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe6, 0x2c, 0x84, 0xc2, 0x77, 0x4b, 0xfb, 0x5, 0x0, 0x9a, 0xe5, 0xdf, 0xce, 0xd7};
  lwmqtt_string_t will_topic = {14, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x95, 0xfa, 0x32, 0x45, 0x4c, 0xbd, 0xce};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 4527;
  uint8_t client_id_bytes[] = {0x8c, 0x4b, 0x63, 0x12, 0x12, 0xf9, 0x60};
  lwmqtt_string_t client_id = {7, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x57, 0x12, 0x76, 0xb9, 0x9a, 0x2e, 0x78, 0x9a, 0xb7, 0x52, 0xec, 0x14, 0xf, 0xb3, 0xfb, 0xe7};
  lwmqtt_string_t password = {16, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "A\ESC'\139\188\167\DEL0\247\183\225\230dn1\207\&4a+\229#\149s\233\178Lz\188B", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "1\210\DC3\DC47O", _willMsg = "M\176\215\\\188\144\&2\213\199\175\GS", _willProps = []}), _cleanSession = False, _keepAlive = 26060, _connID = "'M\238\158*c\NUL\197&]T\231\237\226\255e=\SUB]&\188\246", _properties = []}
TEST(Connect311QCTest, Encode9) {
uint8_t pkt[] = {0x10, 0x37, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x34, 0x65, 0xcc, 0x0, 0x16, 0x27, 0x4d, 0xee, 0x9e, 0x2a, 0x63, 0x0, 0xc5, 0x26, 0x5d, 0x54, 0xe7, 0xed, 0xe2, 0xff, 0x65, 0x3d, 0x1a, 0x5d, 0x26, 0xbc, 0xf6, 0x0, 0x6, 0x31, 0xd2, 0x13, 0x14, 0x37, 0x4f, 0x0, 0xb, 0x4d, 0xb0, 0xd7, 0x5c, 0xbc, 0x90, 0x32, 0xd5, 0xc7, 0xaf, 0x1d};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x31, 0xd2, 0x13, 0x14, 0x37, 0x4f};
  lwmqtt_string_t will_topic = {6, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x4d, 0xb0, 0xd7, 0x5c, 0xbc, 0x90, 0x32, 0xd5, 0xc7, 0xaf, 0x1d};
  lwmqtt_string_t will_payload = {11, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 26060;
  uint8_t client_id_bytes[] = {0x27, 0x4d, 0xee, 0x9e, 0x2a, 0x63, 0x0, 0xc5, 0x26, 0x5d, 0x54, 0xe7, 0xed, 0xe2, 0xff, 0x65, 0x3d, 0x1a, 0x5d, 0x26, 0xbc, 0xf6};
  lwmqtt_string_t client_id = {22, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x41, 0x1b, 0x27, 0x8b, 0xbc, 0xa7, 0x7f, 0x30, 0xf7, 0xb7, 0xe1, 0xe6, 0x64, 0x6e, 0x31, 0xcf, 0x34, 0x61, 0x2b, 0xe5, 0x23, 0x95, 0x73, 0xe9, 0xb2, 0x4c, 0x7a, 0xbc, 0x42};
  lwmqtt_string_t password = {29, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\203\215'q\192;\253\158\131\"\185\255\168\f\227", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "\DC3]\143\242\EOT8\146", _willMsg = "\230\207C'/^Ln\SOH\ACK\239\208\&6\227\162B~\222\142", _willProps = []}), _cleanSession = False, _keepAlive = 18009, _connID = "\223\157;e\ACKs*\NUL\134N\151K\212g\170", _properties = []}
TEST(Connect311QCTest, Encode10) {
uint8_t pkt[] = {0x10, 0x4a, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xac, 0x46, 0x59, 0x0, 0xf, 0xdf, 0x9d, 0x3b, 0x65, 0x6, 0x73, 0x2a, 0x0, 0x86, 0x4e, 0x97, 0x4b, 0xd4, 0x67, 0xaa, 0x0, 0x7, 0x13, 0x5d, 0x8f, 0xf2, 0x4, 0x38, 0x92, 0x0, 0x13, 0xe6, 0xcf, 0x43, 0x27, 0x2f, 0x5e, 0x4c, 0x6e, 0x1, 0x6, 0xef, 0xd0, 0x36, 0xe3, 0xa2, 0x42, 0x7e, 0xde, 0x8e, 0x0, 0xf, 0xcb, 0xd7, 0x27, 0x71, 0xc0, 0x3b, 0xfd, 0x9e, 0x83, 0x22, 0xb9, 0xff, 0xa8, 0xc, 0xe3};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x13, 0x5d, 0x8f, 0xf2, 0x4, 0x38, 0x92};
  lwmqtt_string_t will_topic = {7, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xe6, 0xcf, 0x43, 0x27, 0x2f, 0x5e, 0x4c, 0x6e, 0x1, 0x6, 0xef, 0xd0, 0x36, 0xe3, 0xa2, 0x42, 0x7e, 0xde, 0x8e};
  lwmqtt_string_t will_payload = {19, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 18009;
  uint8_t client_id_bytes[] = {0xdf, 0x9d, 0x3b, 0x65, 0x6, 0x73, 0x2a, 0x0, 0x86, 0x4e, 0x97, 0x4b, 0xd4, 0x67, 0xaa};
  lwmqtt_string_t client_id = {15, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xcb, 0xd7, 0x27, 0x71, 0xc0, 0x3b, 0xfd, 0x9e, 0x83, 0x22, 0xb9, 0xff, 0xa8, 0xc, 0xe3};
  lwmqtt_string_t username = {15, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\SOH\169\149X", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "\185\164\201\218\t\RS\138w4\237\150O\188z}W", _willMsg = "<\195\167\FSW", _willProps = []}), _cleanSession = True, _keepAlive = 29930, _connID = "\b7o\203\f\197", _properties = []}
TEST(Connect311QCTest, Encode11) {
uint8_t pkt[] = {0x10, 0x2b, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x2e, 0x74, 0xea, 0x0, 0x6, 0x8, 0x37, 0x6f, 0xcb, 0xc, 0xc5, 0x0, 0x10, 0xb9, 0xa4, 0xc9, 0xda, 0x9, 0x1e, 0x8a, 0x77, 0x34, 0xed, 0x96, 0x4f, 0xbc, 0x7a, 0x7d, 0x57, 0x0, 0x5, 0x3c, 0xc3, 0xa7, 0x1c, 0x57};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb9, 0xa4, 0xc9, 0xda, 0x9, 0x1e, 0x8a, 0x77, 0x34, 0xed, 0x96, 0x4f, 0xbc, 0x7a, 0x7d, 0x57};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x3c, 0xc3, 0xa7, 0x1c, 0x57};
  lwmqtt_string_t will_payload = {5, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 29930;
  uint8_t client_id_bytes[] = {0x8, 0x37, 0x6f, 0xcb, 0xc, 0xc5};
  lwmqtt_string_t client_id = {6, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x1, 0xa9, 0x95, 0x58};
  lwmqtt_string_t password = {4, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "xj\DC2d\147j\242\141\DC1\253\179o\188", _password = Just "\144\238/&m", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "\191\197a\194u\133\135\244\211\170\162\129\161\&6\225\&2", _willMsg = "\218\f", _willProps = []}), _cleanSession = False, _keepAlive = 15412, _connID = "\176\143\160_\\\166\148\213\226\224\CAN>\238\v\168\163", _properties = []}
TEST(Connect311QCTest, Encode12) {
uint8_t pkt[] = {0x10, 0x48, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xe4, 0x3c, 0x34, 0x0, 0x10, 0xb0, 0x8f, 0xa0, 0x5f, 0x5c, 0xa6, 0x94, 0xd5, 0xe2, 0xe0, 0x18, 0x3e, 0xee, 0xb, 0xa8, 0xa3, 0x0, 0x10, 0xbf, 0xc5, 0x61, 0xc2, 0x75, 0x85, 0x87, 0xf4, 0xd3, 0xaa, 0xa2, 0x81, 0xa1, 0x36, 0xe1, 0x32, 0x0, 0x2, 0xda, 0xc, 0x0, 0xd, 0x78, 0x6a, 0x12, 0x64, 0x93, 0x6a, 0xf2, 0x8d, 0x11, 0xfd, 0xb3, 0x6f, 0xbc, 0x0, 0x5, 0x90, 0xee, 0x2f, 0x26, 0x6d};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xbf, 0xc5, 0x61, 0xc2, 0x75, 0x85, 0x87, 0xf4, 0xd3, 0xaa, 0xa2, 0x81, 0xa1, 0x36, 0xe1, 0x32};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xda, 0xc};
  lwmqtt_string_t will_payload = {2, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 15412;
  uint8_t client_id_bytes[] = {0xb0, 0x8f, 0xa0, 0x5f, 0x5c, 0xa6, 0x94, 0xd5, 0xe2, 0xe0, 0x18, 0x3e, 0xee, 0xb, 0xa8, 0xa3};
  lwmqtt_string_t client_id = {16, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x78, 0x6a, 0x12, 0x64, 0x93, 0x6a, 0xf2, 0x8d, 0x11, 0xfd, 0xb3, 0x6f, 0xbc};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x90, 0xee, 0x2f, 0x26, 0x6d};
  lwmqtt_string_t password = {5, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\128p\220>r\201\195\&0\200", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\DC3l\244\169\203\EOT\129\173\&4\NUL\252\RS\184\133V\249z\191:P~GH\EM\193\SOH29\254e", _willMsg = "mvB", _willProps = []}), _cleanSession = True, _keepAlive = 30313, _connID = "\215\250VLG@\204B\"\166$HJ", _properties = []}
TEST(Connect311QCTest, Encode13) {
uint8_t pkt[] = {0x10, 0x3e, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xe, 0x76, 0x69, 0x0, 0xd, 0xd7, 0xfa, 0x56, 0x4c, 0x47, 0x40, 0xcc, 0x42, 0x22, 0xa6, 0x24, 0x48, 0x4a, 0x0, 0x1e, 0x13, 0x6c, 0xf4, 0xa9, 0xcb, 0x4, 0x81, 0xad, 0x34, 0x0, 0xfc, 0x1e, 0xb8, 0x85, 0x56, 0xf9, 0x7a, 0xbf, 0x3a, 0x50, 0x7e, 0x47, 0x48, 0x19, 0xc1, 0x1, 0x32, 0x39, 0xfe, 0x65, 0x0, 0x3, 0x6d, 0x76, 0x42};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x13, 0x6c, 0xf4, 0xa9, 0xcb, 0x4, 0x81, 0xad, 0x34, 0x0, 0xfc, 0x1e, 0xb8, 0x85, 0x56, 0xf9, 0x7a, 0xbf, 0x3a, 0x50, 0x7e, 0x47, 0x48, 0x19, 0xc1, 0x1, 0x32, 0x39, 0xfe, 0x65};
  lwmqtt_string_t will_topic = {30, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x6d, 0x76, 0x42};
  lwmqtt_string_t will_payload = {3, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 30313;
  uint8_t client_id_bytes[] = {0xd7, 0xfa, 0x56, 0x4c, 0x47, 0x40, 0xcc, 0x42, 0x22, 0xa6, 0x24, 0x48, 0x4a};
  lwmqtt_string_t client_id = {13, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x80, 0x70, 0xdc, 0x3e, 0x72, 0xc9, 0xc3, 0x30, 0xc8};
  lwmqtt_string_t password = {9, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\b\247\147N", _password = Just "\158\238\145\147\144\128C\149\133Syv\234\ESC?", _lastWill = Nothing, _cleanSession = True, _keepAlive = 13836, _connID = "", _properties = []}
TEST(Connect311QCTest, Encode14) {
uint8_t pkt[] = {0x10, 0x23, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xc2, 0x36, 0xc, 0x0, 0x0, 0x0, 0x4, 0x8, 0xf7, 0x93, 0x4e, 0x0, 0xf, 0x9e, 0xee, 0x91, 0x93, 0x90, 0x80, 0x43, 0x95, 0x85, 0x53, 0x79, 0x76, 0xea, 0x1b, 0x3f};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 13836;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x8, 0xf7, 0x93, 0x4e};
  lwmqtt_string_t username = {4, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x9e, 0xee, 0x91, 0x93, 0x90, 0x80, 0x43, 0x95, 0x85, 0x53, 0x79, 0x76, 0xea, 0x1b, 0x3f};
  lwmqtt_string_t password = {15, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, NULL);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "A;\168\224\240\237\DC1\US`k\228D\201 \211vE.\203\STX&", _password = Just "\229\SYN\236\252jrj\246\DLE=x", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\241\&5\180\235\133=\135\224", _willMsg = "+r\156\250\&3\164\138\npj\245=\238\182N^\ra\151\161", _willProps = []}), _cleanSession = False, _keepAlive = 4733, _connID = "\v\ETX,\204b\141\136r!r\DC3a-\138\249M7\afg\EOT\139\228W", _properties = []}
TEST(Connect311QCTest, Encode15) {
uint8_t pkt[] = {0x10, 0x68, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xf4, 0x12, 0x7d, 0x0, 0x18, 0xb, 0x3, 0x2c, 0xcc, 0x62, 0x8d, 0x88, 0x72, 0x21, 0x72, 0x13, 0x61, 0x2d, 0x8a, 0xf9, 0x4d, 0x37, 0x7, 0x66, 0x67, 0x4, 0x8b, 0xe4, 0x57, 0x0, 0x8, 0xf1, 0x35, 0xb4, 0xeb, 0x85, 0x3d, 0x87, 0xe0, 0x0, 0x14, 0x2b, 0x72, 0x9c, 0xfa, 0x33, 0xa4, 0x8a, 0xa, 0x70, 0x6a, 0xf5, 0x3d, 0xee, 0xb6, 0x4e, 0x5e, 0xd, 0x61, 0x97, 0xa1, 0x0, 0x15, 0x41, 0x3b, 0xa8, 0xe0, 0xf0, 0xed, 0x11, 0x1f, 0x60, 0x6b, 0xe4, 0x44, 0xc9, 0x20, 0xd3, 0x76, 0x45, 0x2e, 0xcb, 0x2, 0x26, 0x0, 0xb, 0xe5, 0x16, 0xec, 0xfc, 0x6a, 0x72, 0x6a, 0xf6, 0x10, 0x3d, 0x78};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xf1, 0x35, 0xb4, 0xeb, 0x85, 0x3d, 0x87, 0xe0};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x2b, 0x72, 0x9c, 0xfa, 0x33, 0xa4, 0x8a, 0xa, 0x70, 0x6a, 0xf5, 0x3d, 0xee, 0xb6, 0x4e, 0x5e, 0xd, 0x61, 0x97, 0xa1};
  lwmqtt_string_t will_payload = {20, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 4733;
  uint8_t client_id_bytes[] = {0xb, 0x3, 0x2c, 0xcc, 0x62, 0x8d, 0x88, 0x72, 0x21, 0x72, 0x13, 0x61, 0x2d, 0x8a, 0xf9, 0x4d, 0x37, 0x7, 0x66, 0x67, 0x4, 0x8b, 0xe4, 0x57};
  lwmqtt_string_t client_id = {24, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x41, 0x3b, 0xa8, 0xe0, 0xf0, 0xed, 0x11, 0x1f, 0x60, 0x6b, 0xe4, 0x44, 0xc9, 0x20, 0xd3, 0x76, 0x45, 0x2e, 0xcb, 0x2, 0x26};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xe5, 0x16, 0xec, 0xfc, 0x6a, 0x72, 0x6a, 0xf6, 0x10, 0x3d, 0x78};
  lwmqtt_string_t password = {11, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\172\&0m\236P\216\191\220\208y\146\237\159\163\244Q\136\214\218\197\202\DC3(d\vm\142\GSO\DC3", _password = Just "\EM\a\ACKM\203i\200\227NY:", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\170\n\217\SO\CANI8\208\NAK", _willMsg = "", _willProps = []}), _cleanSession = True, _keepAlive = 25021, _connID = "h\216P$\178\190\228\190\138\FS", _properties = []}
TEST(Connect311QCTest, Encode16) {
uint8_t pkt[] = {0x10, 0x50, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xd6, 0x61, 0xbd, 0x0, 0xa, 0x68, 0xd8, 0x50, 0x24, 0xb2, 0xbe, 0xe4, 0xbe, 0x8a, 0x1c, 0x0, 0x9, 0xaa, 0xa, 0xd9, 0xe, 0x18, 0x49, 0x38, 0xd0, 0x15, 0x0, 0x0, 0x0, 0x1e, 0xac, 0x30, 0x6d, 0xec, 0x50, 0xd8, 0xbf, 0xdc, 0xd0, 0x79, 0x92, 0xed, 0x9f, 0xa3, 0xf4, 0x51, 0x88, 0xd6, 0xda, 0xc5, 0xca, 0x13, 0x28, 0x64, 0xb, 0x6d, 0x8e, 0x1d, 0x4f, 0x13, 0x0, 0xb, 0x19, 0x7, 0x6, 0x4d, 0xcb, 0x69, 0xc8, 0xe3, 0x4e, 0x59, 0x3a};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xaa, 0xa, 0xd9, 0xe, 0x18, 0x49, 0x38, 0xd0, 0x15};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0};
  lwmqtt_string_t will_payload = {0, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 25021;
  uint8_t client_id_bytes[] = {0x68, 0xd8, 0x50, 0x24, 0xb2, 0xbe, 0xe4, 0xbe, 0x8a, 0x1c};
  lwmqtt_string_t client_id = {10, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xac, 0x30, 0x6d, 0xec, 0x50, 0xd8, 0xbf, 0xdc, 0xd0, 0x79, 0x92, 0xed, 0x9f, 0xa3, 0xf4, 0x51, 0x88, 0xd6, 0xda, 0xc5, 0xca, 0x13, 0x28, 0x64, 0xb, 0x6d, 0x8e, 0x1d, 0x4f, 0x13};
  lwmqtt_string_t username = {30, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x19, 0x7, 0x6, 0x4d, 0xcb, 0x69, 0xc8, 0xe3, 0x4e, 0x59, 0x3a};
  lwmqtt_string_t password = {11, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "-\\\US\191>B\216\175\176\r\209#\187\163", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = ",R\166,\231d\190T\\4\f\152s\ENQ\214\188\159\242\200\STX\212yX\237", _willMsg = "G\242R!yU\157\129c\166", _willProps = []}), _cleanSession = True, _keepAlive = 13547, _connID = "r\251\173\&4c\162{\179\188\SO\213\162/\US\158ej\186\DC43\174\157\&4(u\213\US\164E", _properties = []}
TEST(Connect311QCTest, Encode17) {
uint8_t pkt[] = {0x10, 0x5f, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xb6, 0x34, 0xeb, 0x0, 0x1d, 0x72, 0xfb, 0xad, 0x34, 0x63, 0xa2, 0x7b, 0xb3, 0xbc, 0xe, 0xd5, 0xa2, 0x2f, 0x1f, 0x9e, 0x65, 0x6a, 0xba, 0x14, 0x33, 0xae, 0x9d, 0x34, 0x28, 0x75, 0xd5, 0x1f, 0xa4, 0x45, 0x0, 0x18, 0x2c, 0x52, 0xa6, 0x2c, 0xe7, 0x64, 0xbe, 0x54, 0x5c, 0x34, 0xc, 0x98, 0x73, 0x5, 0xd6, 0xbc, 0x9f, 0xf2, 0xc8, 0x2, 0xd4, 0x79, 0x58, 0xed, 0x0, 0xa, 0x47, 0xf2, 0x52, 0x21, 0x79, 0x55, 0x9d, 0x81, 0x63, 0xa6, 0x0, 0xe, 0x2d, 0x5c, 0x1f, 0xbf, 0x3e, 0x42, 0xd8, 0xaf, 0xb0, 0xd, 0xd1, 0x23, 0xbb, 0xa3};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x2c, 0x52, 0xa6, 0x2c, 0xe7, 0x64, 0xbe, 0x54, 0x5c, 0x34, 0xc, 0x98, 0x73, 0x5, 0xd6, 0xbc, 0x9f, 0xf2, 0xc8, 0x2, 0xd4, 0x79, 0x58, 0xed};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x47, 0xf2, 0x52, 0x21, 0x79, 0x55, 0x9d, 0x81, 0x63, 0xa6};
  lwmqtt_string_t will_payload = {10, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 13547;
  uint8_t client_id_bytes[] = {0x72, 0xfb, 0xad, 0x34, 0x63, 0xa2, 0x7b, 0xb3, 0xbc, 0xe, 0xd5, 0xa2, 0x2f, 0x1f, 0x9e, 0x65, 0x6a, 0xba, 0x14, 0x33, 0xae, 0x9d, 0x34, 0x28, 0x75, 0xd5, 0x1f, 0xa4, 0x45};
  lwmqtt_string_t client_id = {29, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x2d, 0x5c, 0x1f, 0xbf, 0x3e, 0x42, 0xd8, 0xaf, 0xb0, 0xd, 0xd1, 0x23, 0xbb, 0xa3};
  lwmqtt_string_t username = {14, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\232g\222\&1\254\EM\195}\FS\159h\255\DC4J\131:\250\139\243\245L\SYN\132\237\145\218l\149\147D", _password = Just "\216\SYN", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\RScg\195\250\136\246\225\255\166Lm\165\206\183\159", _willMsg = "\222\238\244.\139OJ", _willProps = []}), _cleanSession = True, _keepAlive = 24226, _connID = "\171!\155o/ F\SO\201\168\DLE~\DC4*", _properties = []}
TEST(Connect311QCTest, Encode18) {
uint8_t pkt[] = {0x10, 0x59, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xd6, 0x5e, 0xa2, 0x0, 0xe, 0xab, 0x21, 0x9b, 0x6f, 0x2f, 0x20, 0x46, 0xe, 0xc9, 0xa8, 0x10, 0x7e, 0x14, 0x2a, 0x0, 0x10, 0x1e, 0x63, 0x67, 0xc3, 0xfa, 0x88, 0xf6, 0xe1, 0xff, 0xa6, 0x4c, 0x6d, 0xa5, 0xce, 0xb7, 0x9f, 0x0, 0x7, 0xde, 0xee, 0xf4, 0x2e, 0x8b, 0x4f, 0x4a, 0x0, 0x1e, 0xe8, 0x67, 0xde, 0x31, 0xfe, 0x19, 0xc3, 0x7d, 0x1c, 0x9f, 0x68, 0xff, 0x14, 0x4a, 0x83, 0x3a, 0xfa, 0x8b, 0xf3, 0xf5, 0x4c, 0x16, 0x84, 0xed, 0x91, 0xda, 0x6c, 0x95, 0x93, 0x44, 0x0, 0x2, 0xd8, 0x16};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x1e, 0x63, 0x67, 0xc3, 0xfa, 0x88, 0xf6, 0xe1, 0xff, 0xa6, 0x4c, 0x6d, 0xa5, 0xce, 0xb7, 0x9f};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xde, 0xee, 0xf4, 0x2e, 0x8b, 0x4f, 0x4a};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 24226;
  uint8_t client_id_bytes[] = {0xab, 0x21, 0x9b, 0x6f, 0x2f, 0x20, 0x46, 0xe, 0xc9, 0xa8, 0x10, 0x7e, 0x14, 0x2a};
  lwmqtt_string_t client_id = {14, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xe8, 0x67, 0xde, 0x31, 0xfe, 0x19, 0xc3, 0x7d, 0x1c, 0x9f, 0x68, 0xff, 0x14, 0x4a, 0x83, 0x3a, 0xfa, 0x8b, 0xf3, 0xf5, 0x4c, 0x16, 0x84, 0xed, 0x91, 0xda, 0x6c, 0x95, 0x93, 0x44};
  lwmqtt_string_t username = {30, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xd8, 0x16};
  lwmqtt_string_t password = {2, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "'\216\163|\221m\165\171\236!\179M84\232bZ\149\154\234\158", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\184\185\180\202\170\173g\tsp\221\170\169{\210\160\247\SOH\tG\158N5", _willMsg = "\\\RS/%&ik\DC2\234\228\US\198.*o\190$\DC1\234\187\154\212\129", _willProps = []}), _cleanSession = False, _keepAlive = 10411, _connID = "V\EOTi\ETB\252n}!\239\188\234\&2;b\241\237$\230\184\167\154\163\NUL\206\175", _properties = []}
TEST(Connect311QCTest, Encode19) {
uint8_t pkt[] = {0x10, 0x6e, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xb4, 0x28, 0xab, 0x0, 0x19, 0x56, 0x4, 0x69, 0x17, 0xfc, 0x6e, 0x7d, 0x21, 0xef, 0xbc, 0xea, 0x32, 0x3b, 0x62, 0xf1, 0xed, 0x24, 0xe6, 0xb8, 0xa7, 0x9a, 0xa3, 0x0, 0xce, 0xaf, 0x0, 0x17, 0xb8, 0xb9, 0xb4, 0xca, 0xaa, 0xad, 0x67, 0x9, 0x73, 0x70, 0xdd, 0xaa, 0xa9, 0x7b, 0xd2, 0xa0, 0xf7, 0x1, 0x9, 0x47, 0x9e, 0x4e, 0x35, 0x0, 0x17, 0x5c, 0x1e, 0x2f, 0x25, 0x26, 0x69, 0x6b, 0x12, 0xea, 0xe4, 0x1f, 0xc6, 0x2e, 0x2a, 0x6f, 0xbe, 0x24, 0x11, 0xea, 0xbb, 0x9a, 0xd4, 0x81, 0x0, 0x15, 0x27, 0xd8, 0xa3, 0x7c, 0xdd, 0x6d, 0xa5, 0xab, 0xec, 0x21, 0xb3, 0x4d, 0x38, 0x34, 0xe8, 0x62, 0x5a, 0x95, 0x9a, 0xea, 0x9e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb8, 0xb9, 0xb4, 0xca, 0xaa, 0xad, 0x67, 0x9, 0x73, 0x70, 0xdd, 0xaa, 0xa9, 0x7b, 0xd2, 0xa0, 0xf7, 0x1, 0x9, 0x47, 0x9e, 0x4e, 0x35};
  lwmqtt_string_t will_topic = {23, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x5c, 0x1e, 0x2f, 0x25, 0x26, 0x69, 0x6b, 0x12, 0xea, 0xe4, 0x1f, 0xc6, 0x2e, 0x2a, 0x6f, 0xbe, 0x24, 0x11, 0xea, 0xbb, 0x9a, 0xd4, 0x81};
  lwmqtt_string_t will_payload = {23, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 10411;
  uint8_t client_id_bytes[] = {0x56, 0x4, 0x69, 0x17, 0xfc, 0x6e, 0x7d, 0x21, 0xef, 0xbc, 0xea, 0x32, 0x3b, 0x62, 0xf1, 0xed, 0x24, 0xe6, 0xb8, 0xa7, 0x9a, 0xa3, 0x0, 0xce, 0xaf};
  lwmqtt_string_t client_id = {25, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x27, 0xd8, 0xa3, 0x7c, 0xdd, 0x6d, 0xa5, 0xab, 0xec, 0x21, 0xb3, 0x4d, 0x38, 0x34, 0xe8, 0x62, 0x5a, 0x95, 0x9a, 0xea, 0x9e};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\238E\235\195\176i4\ETX\156\201\169\199m\192\SO\135|\184\247", _password = Just "\148!\GS\GS3\143\183\154J\SOF\207+\154$\189\201\133\152\220\230c\213i", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\176\187R!\190\252\137", _willMsg = "\CAN\202\249i\219", _willProps = []}), _cleanSession = True, _keepAlive = 11619, _connID = ")G\205}(\"\172\143lX\215\SYNQT\CAN7\194\138\RS\DELr3\144\SIn\185\210y", _properties = []}
TEST(Connect311QCTest, Encode20) {
uint8_t pkt[] = {0x10, 0x67, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xd6, 0x2d, 0x63, 0x0, 0x1c, 0x29, 0x47, 0xcd, 0x7d, 0x28, 0x22, 0xac, 0x8f, 0x6c, 0x58, 0xd7, 0x16, 0x51, 0x54, 0x18, 0x37, 0xc2, 0x8a, 0x1e, 0x7f, 0x72, 0x33, 0x90, 0xf, 0x6e, 0xb9, 0xd2, 0x79, 0x0, 0x7, 0xb0, 0xbb, 0x52, 0x21, 0xbe, 0xfc, 0x89, 0x0, 0x5, 0x18, 0xca, 0xf9, 0x69, 0xdb, 0x0, 0x13, 0xee, 0x45, 0xeb, 0xc3, 0xb0, 0x69, 0x34, 0x3, 0x9c, 0xc9, 0xa9, 0xc7, 0x6d, 0xc0, 0xe, 0x87, 0x7c, 0xb8, 0xf7, 0x0, 0x18, 0x94, 0x21, 0x1d, 0x1d, 0x33, 0x8f, 0xb7, 0x9a, 0x4a, 0xe, 0x46, 0xcf, 0x2b, 0x9a, 0x24, 0xbd, 0xc9, 0x85, 0x98, 0xdc, 0xe6, 0x63, 0xd5, 0x69};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb0, 0xbb, 0x52, 0x21, 0xbe, 0xfc, 0x89};
  lwmqtt_string_t will_topic = {7, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x18, 0xca, 0xf9, 0x69, 0xdb};
  lwmqtt_string_t will_payload = {5, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 11619;
  uint8_t client_id_bytes[] = {0x29, 0x47, 0xcd, 0x7d, 0x28, 0x22, 0xac, 0x8f, 0x6c, 0x58, 0xd7, 0x16, 0x51, 0x54, 0x18, 0x37, 0xc2, 0x8a, 0x1e, 0x7f, 0x72, 0x33, 0x90, 0xf, 0x6e, 0xb9, 0xd2, 0x79};
  lwmqtt_string_t client_id = {28, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xee, 0x45, 0xeb, 0xc3, 0xb0, 0x69, 0x34, 0x3, 0x9c, 0xc9, 0xa9, 0xc7, 0x6d, 0xc0, 0xe, 0x87, 0x7c, 0xb8, 0xf7};
  lwmqtt_string_t username = {19, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x94, 0x21, 0x1d, 0x1d, 0x33, 0x8f, 0xb7, 0x9a, 0x4a, 0xe, 0x46, 0xcf, 0x2b, 0x9a, 0x24, 0xbd, 0xc9, 0x85, 0x98, 0xdc, 0xe6, 0x63, 0xd5, 0x69};
  lwmqtt_string_t password = {24, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just ";\196\214\158d\DC1\NAK\SUB\139)\218\190\184\241\CANP\STX3V\208&);\255\169\182\226\231`", _password = Nothing, _lastWill = Nothing, _cleanSession = False, _keepAlive = 10023, _connID = "\158\&0\SO\215\199\&6&\NUL\172!u\226\224\240J\178nI", _properties = []}
TEST(Connect311QCTest, Encode21) {
uint8_t pkt[] = {0x10, 0x3d, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x80, 0x27, 0x27, 0x0, 0x12, 0x9e, 0x30, 0xe, 0xd7, 0xc7, 0x36, 0x26, 0x0, 0xac, 0x21, 0x75, 0xe2, 0xe0, 0xf0, 0x4a, 0xb2, 0x6e, 0x49, 0x0, 0x1d, 0x3b, 0xc4, 0xd6, 0x9e, 0x64, 0x11, 0x15, 0x1a, 0x8b, 0x29, 0xda, 0xbe, 0xb8, 0xf1, 0x18, 0x50, 0x2, 0x33, 0x56, 0xd0, 0x26, 0x29, 0x3b, 0xff, 0xa9, 0xb6, 0xe2, 0xe7, 0x60};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 10023;
  uint8_t client_id_bytes[] = {0x9e, 0x30, 0xe, 0xd7, 0xc7, 0x36, 0x26, 0x0, 0xac, 0x21, 0x75, 0xe2, 0xe0, 0xf0, 0x4a, 0xb2, 0x6e, 0x49};
  lwmqtt_string_t client_id = {18, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x3b, 0xc4, 0xd6, 0x9e, 0x64, 0x11, 0x15, 0x1a, 0x8b, 0x29, 0xda, 0xbe, 0xb8, 0xf1, 0x18, 0x50, 0x2, 0x33, 0x56, 0xd0, 0x26, 0x29, 0x3b, 0xff, 0xa9, 0xb6, 0xe2, 0xe7, 0x60};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, NULL);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "F\208\168\t~)z\vT8=\231\137\f\197\180\&5\169O\b\222\153\175\180H\193b\154%", _password = Just "\NAK^\RS\171Ce0\DLE\151\171\237L\167#", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\ESCn\STX\167<\196\189\197", _willMsg = "G\NAK\158\v\STX\173\140y\131", _willProps = []}), _cleanSession = True, _keepAlive = 17115, _connID = "\224\239\SYNj", _properties = []}
TEST(Connect311QCTest, Encode22) {
uint8_t pkt[] = {0x10, 0x54, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xd6, 0x42, 0xdb, 0x0, 0x4, 0xe0, 0xef, 0x16, 0x6a, 0x0, 0x8, 0x1b, 0x6e, 0x2, 0xa7, 0x3c, 0xc4, 0xbd, 0xc5, 0x0, 0x9, 0x47, 0x15, 0x9e, 0xb, 0x2, 0xad, 0x8c, 0x79, 0x83, 0x0, 0x1d, 0x46, 0xd0, 0xa8, 0x9, 0x7e, 0x29, 0x7a, 0xb, 0x54, 0x38, 0x3d, 0xe7, 0x89, 0xc, 0xc5, 0xb4, 0x35, 0xa9, 0x4f, 0x8, 0xde, 0x99, 0xaf, 0xb4, 0x48, 0xc1, 0x62, 0x9a, 0x25, 0x0, 0xe, 0x15, 0x5e, 0x1e, 0xab, 0x43, 0x65, 0x30, 0x10, 0x97, 0xab, 0xed, 0x4c, 0xa7, 0x23};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x1b, 0x6e, 0x2, 0xa7, 0x3c, 0xc4, 0xbd, 0xc5};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x47, 0x15, 0x9e, 0xb, 0x2, 0xad, 0x8c, 0x79, 0x83};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 17115;
  uint8_t client_id_bytes[] = {0xe0, 0xef, 0x16, 0x6a};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x46, 0xd0, 0xa8, 0x9, 0x7e, 0x29, 0x7a, 0xb, 0x54, 0x38, 0x3d, 0xe7, 0x89, 0xc, 0xc5, 0xb4, 0x35, 0xa9, 0x4f, 0x8, 0xde, 0x99, 0xaf, 0xb4, 0x48, 0xc1, 0x62, 0x9a, 0x25};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x15, 0x5e, 0x1e, 0xab, 0x43, 0x65, 0x30, 0x10, 0x97, 0xab, 0xed, 0x4c, 0xa7, 0x23};
  lwmqtt_string_t password = {14, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "_\181", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic = "\130\CANG\157\a\138\188H\194", _willMsg = "\131;\DEL\244\175\170\170\225\172", _willProps = []}), _cleanSession = True, _keepAlive = 18273, _connID = "\DLEX\181cI5\156\142^\212\200\ETX\254\162\223\136\ETB\142\251p\163", _properties = []}
TEST(Connect311QCTest, Encode23) {
uint8_t pkt[] = {0x10, 0x37, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x6, 0x47, 0x61, 0x0, 0x15, 0x10, 0x58, 0xb5, 0x63, 0x49, 0x35, 0x9c, 0x8e, 0x5e, 0xd4, 0xc8, 0x3, 0xfe, 0xa2, 0xdf, 0x88, 0x17, 0x8e, 0xfb, 0x70, 0xa3, 0x0, 0x9, 0x82, 0x18, 0x47, 0x9d, 0x7, 0x8a, 0xbc, 0x48, 0xc2, 0x0, 0x9, 0x83, 0x3b, 0x7f, 0xf4, 0xaf, 0xaa, 0xaa, 0xe1, 0xac};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x82, 0x18, 0x47, 0x9d, 0x7, 0x8a, 0xbc, 0x48, 0xc2};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x83, 0x3b, 0x7f, 0xf4, 0xaf, 0xaa, 0xaa, 0xe1, 0xac};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 18273;
  uint8_t client_id_bytes[] = {0x10, 0x58, 0xb5, 0x63, 0x49, 0x35, 0x9c, 0x8e, 0x5e, 0xd4, 0xc8, 0x3, 0xfe, 0xa2, 0xdf, 0x88, 0x17, 0x8e, 0xfb, 0x70, 0xa3};
  lwmqtt_string_t client_id = {21, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x5f, 0xb5};
  lwmqtt_string_t password = {2, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\212\138\190Q;W\148\195", _willMsg = "\213;", _willProps = []}), _cleanSession = True, _keepAlive = 31629, _connID = "\157f\DC3.", _properties = []}
TEST(Connect311QCTest, Encode24) {
uint8_t pkt[] = {0x10, 0x1e, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x36, 0x7b, 0x8d, 0x0, 0x4, 0x9d, 0x66, 0x13, 0x2e, 0x0, 0x8, 0xd4, 0x8a, 0xbe, 0x51, 0x3b, 0x57, 0x94, 0xc3, 0x0, 0x2, 0xd5, 0x3b};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xd4, 0x8a, 0xbe, 0x51, 0x3b, 0x57, 0x94, 0xc3};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd5, 0x3b};
  lwmqtt_string_t will_payload = {2, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 31629;
  uint8_t client_id_bytes[] = {0x9d, 0x66, 0x13, 0x2e};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\252\245y:\200\b\234\&6\225\SYN\158z\238&\CAN\175\138", _password = Just "|\218-vl\SYN\222f\159V\138\232\203", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "5Y\164\&1`u\255\252\&8\171&", _willMsg = "n\STX\DC2\DEL_\171\ENQ\171\145\175\ESC6\158\&2\246\f%h\190\233O\232\175\190\128\STX\178\210\245l", _willProps = []}), _cleanSession = False, _keepAlive = 21783, _connID = "56\NAK,s\168\165\247\235\SOP\239\239\194\155\NAK\181iBp\RS\239\ACK\131\a\157\SUB\150]", _properties = []}
TEST(Connect311QCTest, Encode25) {
uint8_t pkt[] = {0x10, 0x78, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xec, 0x55, 0x17, 0x0, 0x1d, 0x35, 0x36, 0x15, 0x2c, 0x73, 0xa8, 0xa5, 0xf7, 0xeb, 0xe, 0x50, 0xef, 0xef, 0xc2, 0x9b, 0x15, 0xb5, 0x69, 0x42, 0x70, 0x1e, 0xef, 0x6, 0x83, 0x7, 0x9d, 0x1a, 0x96, 0x5d, 0x0, 0xb, 0x35, 0x59, 0xa4, 0x31, 0x60, 0x75, 0xff, 0xfc, 0x38, 0xab, 0x26, 0x0, 0x1e, 0x6e, 0x2, 0x12, 0x7f, 0x5f, 0xab, 0x5, 0xab, 0x91, 0xaf, 0x1b, 0x36, 0x9e, 0x32, 0xf6, 0xc, 0x25, 0x68, 0xbe, 0xe9, 0x4f, 0xe8, 0xaf, 0xbe, 0x80, 0x2, 0xb2, 0xd2, 0xf5, 0x6c, 0x0, 0x11, 0xfc, 0xf5, 0x79, 0x3a, 0xc8, 0x8, 0xea, 0x36, 0xe1, 0x16, 0x9e, 0x7a, 0xee, 0x26, 0x18, 0xaf, 0x8a, 0x0, 0xd, 0x7c, 0xda, 0x2d, 0x76, 0x6c, 0x16, 0xde, 0x66, 0x9f, 0x56, 0x8a, 0xe8, 0xcb};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x35, 0x59, 0xa4, 0x31, 0x60, 0x75, 0xff, 0xfc, 0x38, 0xab, 0x26};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x6e, 0x2, 0x12, 0x7f, 0x5f, 0xab, 0x5, 0xab, 0x91, 0xaf, 0x1b, 0x36, 0x9e, 0x32, 0xf6, 0xc, 0x25, 0x68, 0xbe, 0xe9, 0x4f, 0xe8, 0xaf, 0xbe, 0x80, 0x2, 0xb2, 0xd2, 0xf5, 0x6c};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 21783;
  uint8_t client_id_bytes[] = {0x35, 0x36, 0x15, 0x2c, 0x73, 0xa8, 0xa5, 0xf7, 0xeb, 0xe, 0x50, 0xef, 0xef, 0xc2, 0x9b, 0x15, 0xb5, 0x69, 0x42, 0x70, 0x1e, 0xef, 0x6, 0x83, 0x7, 0x9d, 0x1a, 0x96, 0x5d};
  lwmqtt_string_t client_id = {29, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xfc, 0xf5, 0x79, 0x3a, 0xc8, 0x8, 0xea, 0x36, 0xe1, 0x16, 0x9e, 0x7a, 0xee, 0x26, 0x18, 0xaf, 0x8a};
  lwmqtt_string_t username = {17, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x7c, 0xda, 0x2d, 0x76, 0x6c, 0x16, 0xde, 0x66, 0x9f, 0x56, 0x8a, 0xe8, 0xcb};
  lwmqtt_string_t password = {13, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\223*\129F(\130\&4\142\220[3\138\202/U\241z\144\214\227\&9\162\164\149", _password = Just "k\177\238>\207X\198i\188\175\151\215\&4\250\DC2\133\DC3\208", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "", _willMsg = "O\f\163R\254G\172]\199\227#f/\147[\SI", _willProps = []}), _cleanSession = False, _keepAlive = 1168, _connID = "\t\208\CAN'\235Mek\SI\DC2;\237\GS\194~\SOH,", _properties = []}
TEST(Connect311QCTest, Encode26) {
uint8_t pkt[] = {0x10, 0x5f, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xd4, 0x4, 0x90, 0x0, 0x11, 0x9, 0xd0, 0x18, 0x27, 0xeb, 0x4d, 0x65, 0x6b, 0xf, 0x12, 0x3b, 0xed, 0x1d, 0xc2, 0x7e, 0x1, 0x2c, 0x0, 0x0, 0x0, 0x10, 0x4f, 0xc, 0xa3, 0x52, 0xfe, 0x47, 0xac, 0x5d, 0xc7, 0xe3, 0x23, 0x66, 0x2f, 0x93, 0x5b, 0xf, 0x0, 0x18, 0xdf, 0x2a, 0x81, 0x46, 0x28, 0x82, 0x34, 0x8e, 0xdc, 0x5b, 0x33, 0x8a, 0xca, 0x2f, 0x55, 0xf1, 0x7a, 0x90, 0xd6, 0xe3, 0x39, 0xa2, 0xa4, 0x95, 0x0, 0x12, 0x6b, 0xb1, 0xee, 0x3e, 0xcf, 0x58, 0xc6, 0x69, 0xbc, 0xaf, 0x97, 0xd7, 0x34, 0xfa, 0x12, 0x85, 0x13, 0xd0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0};
  lwmqtt_string_t will_topic = {0, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x4f, 0xc, 0xa3, 0x52, 0xfe, 0x47, 0xac, 0x5d, 0xc7, 0xe3, 0x23, 0x66, 0x2f, 0x93, 0x5b, 0xf};
  lwmqtt_string_t will_payload = {16, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 1168;
  uint8_t client_id_bytes[] = {0x9, 0xd0, 0x18, 0x27, 0xeb, 0x4d, 0x65, 0x6b, 0xf, 0x12, 0x3b, 0xed, 0x1d, 0xc2, 0x7e, 0x1, 0x2c};
  lwmqtt_string_t client_id = {17, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xdf, 0x2a, 0x81, 0x46, 0x28, 0x82, 0x34, 0x8e, 0xdc, 0x5b, 0x33, 0x8a, 0xca, 0x2f, 0x55, 0xf1, 0x7a, 0x90, 0xd6, 0xe3, 0x39, 0xa2, 0xa4, 0x95};
  lwmqtt_string_t username = {24, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x6b, 0xb1, 0xee, 0x3e, 0xcf, 0x58, 0xc6, 0x69, 0xbc, 0xaf, 0x97, 0xd7, 0x34, 0xfa, 0x12, 0x85, 0x13, 0xd0};
  lwmqtt_string_t password = {18, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\220\&2", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\174'\200lI", _willMsg = "\GS\ETXa\251\147I\r\201>\212r\195\DC1\164\SO!", _willProps = []}), _cleanSession = True, _keepAlive = 6357, _connID = "\200", _properties = []}
TEST(Connect311QCTest, Encode27) {
uint8_t pkt[] = {0x10, 0x2a, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xb6, 0x18, 0xd5, 0x0, 0x1, 0xc8, 0x0, 0x5, 0xae, 0x27, 0xc8, 0x6c, 0x49, 0x0, 0x10, 0x1d, 0x3, 0x61, 0xfb, 0x93, 0x49, 0xd, 0xc9, 0x3e, 0xd4, 0x72, 0xc3, 0x11, 0xa4, 0xe, 0x21, 0x0, 0x2, 0xdc, 0x32};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xae, 0x27, 0xc8, 0x6c, 0x49};
  lwmqtt_string_t will_topic = {5, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x1d, 0x3, 0x61, 0xfb, 0x93, 0x49, 0xd, 0xc9, 0x3e, 0xd4, 0x72, 0xc3, 0x11, 0xa4, 0xe, 0x21};
  lwmqtt_string_t will_payload = {16, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 6357;
  uint8_t client_id_bytes[] = {0xc8};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xdc, 0x32};
  lwmqtt_string_t username = {2, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\138P\246\r\139dV\214\134\172RuyQ\235d\SI&A\169\ETX\151\187swD", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "Q\190\197\213\216\168{>!\220\238\251Zm\n\219\233\RSM\158\210\250\228\168", _willMsg = "e\227;s\172;", _willProps = []}), _cleanSession = True, _keepAlive = 10491, _connID = "", _properties = []}
TEST(Connect311QCTest, Encode28) {
uint8_t pkt[] = {0x10, 0x2e, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0x36, 0x28, 0xfb, 0x0, 0x0, 0x0, 0x18, 0x51, 0xbe, 0xc5, 0xd5, 0xd8, 0xa8, 0x7b, 0x3e, 0x21, 0xdc, 0xee, 0xfb, 0x5a, 0x6d, 0xa, 0xdb, 0xe9, 0x1e, 0x4d, 0x9e, 0xd2, 0xfa, 0xe4, 0xa8, 0x0, 0x6, 0x65, 0xe3, 0x3b, 0x73, 0xac, 0x3b};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x51, 0xbe, 0xc5, 0xd5, 0xd8, 0xa8, 0x7b, 0x3e, 0x21, 0xdc, 0xee, 0xfb, 0x5a, 0x6d, 0xa, 0xdb, 0xe9, 0x1e, 0x4d, 0x9e, 0xd2, 0xfa, 0xe4, 0xa8};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x65, 0xe3, 0x3b, 0x73, 0xac, 0x3b};
  lwmqtt_string_t will_payload = {6, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 10491;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x8a, 0x50, 0xf6, 0xd, 0x8b, 0x64, 0x56, 0xd6, 0x86, 0xac, 0x52, 0x75, 0x79, 0x51, 0xeb, 0x64, 0xf, 0x26, 0x41, 0xa9, 0x3, 0x97, 0xbb, 0x73, 0x77, 0x44};
  lwmqtt_string_t password = {26, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\136\ETX\185\158{\133u\SUB]M\158\149j", _password = Just "\236\211\185\RS\166i\ENQ\145\208h\157\v\ESC!", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\224\ESC\"\DLEM\r\165\238\&9\230\141", _willMsg = "C\129\147\222\&7Q.1.", _willProps = []}), _cleanSession = True, _keepAlive = 12875, _connID = "j", _properties = []}
TEST(Connect311QCTest, Encode29) {
uint8_t pkt[] = {0x10, 0x44, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xf6, 0x32, 0x4b, 0x0, 0x1, 0x6a, 0x0, 0xb, 0xe0, 0x1b, 0x22, 0x10, 0x4d, 0xd, 0xa5, 0xee, 0x39, 0xe6, 0x8d, 0x0, 0x9, 0x43, 0x81, 0x93, 0xde, 0x37, 0x51, 0x2e, 0x31, 0x2e, 0x0, 0xd, 0x88, 0x3, 0xb9, 0x9e, 0x7b, 0x85, 0x75, 0x1a, 0x5d, 0x4d, 0x9e, 0x95, 0x6a, 0x0, 0xe, 0xec, 0xd3, 0xb9, 0x1e, 0xa6, 0x69, 0x5, 0x91, 0xd0, 0x68, 0x9d, 0xb, 0x1b, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe0, 0x1b, 0x22, 0x10, 0x4d, 0xd, 0xa5, 0xee, 0x39, 0xe6, 0x8d};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x43, 0x81, 0x93, 0xde, 0x37, 0x51, 0x2e, 0x31, 0x2e};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 12875;
  uint8_t client_id_bytes[] = {0x6a};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x88, 0x3, 0xb9, 0x9e, 0x7b, 0x85, 0x75, 0x1a, 0x5d, 0x4d, 0x9e, 0x95, 0x6a};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xec, 0xd3, 0xb9, 0x1e, 0xa6, 0x69, 0x5, 0x91, 0xd0, 0x68, 0x9d, 0xb, 0x1b, 0x21};
  lwmqtt_string_t password = {14, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\CAN`l\229\237\255", _password = Just "\192o\213\179\182\245\198(\236\EOT\NAK/", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\246\227\176\175_4\EOT{\143\204\150", _willMsg = "\209\190U\246\210\133\207\145\&9\229", _willProps = []}), _cleanSession = True, _keepAlive = 67, _connID = "\246Q\170N+\132\254\213*\162\243\n", _properties = []}
TEST(Connect311QCTest, Encode30) {
uint8_t pkt[] = {0x10, 0x47, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x4, 0xce, 0x0, 0x43, 0x0, 0xc, 0xf6, 0x51, 0xaa, 0x4e, 0x2b, 0x84, 0xfe, 0xd5, 0x2a, 0xa2, 0xf3, 0xa, 0x0, 0xb, 0xf6, 0xe3, 0xb0, 0xaf, 0x5f, 0x34, 0x4, 0x7b, 0x8f, 0xcc, 0x96, 0x0, 0xa, 0xd1, 0xbe, 0x55, 0xf6, 0xd2, 0x85, 0xcf, 0x91, 0x39, 0xe5, 0x0, 0x6, 0x18, 0x60, 0x6c, 0xe5, 0xed, 0xff, 0x0, 0xc, 0xc0, 0x6f, 0xd5, 0xb3, 0xb6, 0xf5, 0xc6, 0x28, 0xec, 0x4, 0x15, 0x2f};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  
  lwmqtt_property_t willpropslist[] = {
  };

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xf6, 0xe3, 0xb0, 0xaf, 0x5f, 0x34, 0x4, 0x7b, 0x8f, 0xcc, 0x96};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd1, 0xbe, 0x55, 0xf6, 0xd2, 0x85, 0xcf, 0x91, 0x39, 0xe5};
  lwmqtt_string_t will_payload = {10, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 67;
  uint8_t client_id_bytes[] = {0xf6, 0x51, 0xaa, 0x4e, 0x2b, 0x84, 0xfe, 0xd5, 0x2a, 0xa2, 0xf3, 0xa};
  lwmqtt_string_t client_id = {12, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x18, 0x60, 0x6c, 0xe5, 0xed, 0xff};
  lwmqtt_string_t username = {6, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xc0, 0x6f, 0xd5, 0xb3, 0xb6, 0xf5, 0xc6, 0x28, 0xec, 0x4, 0x15, 0x2f};
  lwmqtt_string_t password = {12, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "<\200\232q\179c\222\168\a\186M\US\251I\210\222w\195H8\NUL\242!X\199s\219\245\165i", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "e\166s3\SOH\158_\232u5y\249\184aJ\194\246\220\226\184\209\223\EM", _willMsg = "_\245\131\131I\205\b\225\ETB\152\SO\152\&0\ENQ\145<\158\t4:\135", _willProps = [PropTopicAliasMaximum 7039,PropSubscriptionIdentifierAvailable 245,PropAuthenticationData "KG\228\255L\167F",PropSubscriptionIdentifierAvailable 22,PropServerReference ".\206C\196\172 \EOT\159(\176\165Q",PropServerReference "f\DLEQ\253\131{d2\133[\199\nI\218\244\FS\191\202\&2\163\199\222\STX",PropRequestProblemInformation 23,PropWillDelayInterval 29502,PropSubscriptionIdentifier 10,PropWildcardSubscriptionAvailable 198,PropPayloadFormatIndicator 55,PropRequestResponseInformation 58,PropCorrelationData "yj4\159\SYN\184\133[\183p\173\DC2\205\US\241\224z\252\EOT\182\200\RS3",PropTopicAlias 31480,PropSubscriptionIdentifier 21,PropContentType "\232(\167f\165\"\ETB\151\CAN\172",PropMaximumPacketSize 18233,PropServerKeepAlive 27264,PropAuthenticationData "\168\CAN\190%\218\174p!\248\233\DC2\v\235\182\166s\ENQQ\143m\253\221\232",PropTopicAliasMaximum 11399,PropMaximumQoS 81,PropRequestProblemInformation 184,PropResponseInformation "\248.\192<\SYNJ 2\DC4\246+\166\FSah\DC1&j\SOHY\198\162\215",PropUserProperty "\182\236d\169o]" "O\250",PropServerKeepAlive 30187,PropSubscriptionIdentifier 32,PropMessageExpiryInterval 30375,PropSubscriptionIdentifierAvailable 114]}), _cleanSession = False, _keepAlive = 14400, _connID = "\NAK\178o-", _properties = [PropRequestProblemInformation 183]}
TEST(Connect5QCTest, Encode1) {
uint8_t pkt[] = {0x10, 0xb6, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x6c, 0x38, 0x40, 0x2, 0x17, 0xb7, 0x0, 0x4, 0x15, 0xb2, 0x6f, 0x2d, 0xd1, 0x1, 0x22, 0x1b, 0x7f, 0x29, 0xf5, 0x16, 0x0, 0x7, 0x4b, 0x47, 0xe4, 0xff, 0x4c, 0xa7, 0x46, 0x29, 0x16, 0x1c, 0x0, 0xc, 0x2e, 0xce, 0x43, 0xc4, 0xac, 0x20, 0x4, 0x9f, 0x28, 0xb0, 0xa5, 0x51, 0x1c, 0x0, 0x17, 0x66, 0x10, 0x51, 0xfd, 0x83, 0x7b, 0x64, 0x32, 0x85, 0x5b, 0xc7, 0xa, 0x49, 0xda, 0xf4, 0x1c, 0xbf, 0xca, 0x32, 0xa3, 0xc7, 0xde, 0x2, 0x17, 0x17, 0x18, 0x0, 0x0, 0x73, 0x3e, 0xb, 0xa, 0x28, 0xc6, 0x1, 0x37, 0x19, 0x3a, 0x9, 0x0, 0x17, 0x79, 0x6a, 0x34, 0x9f, 0x16, 0xb8, 0x85, 0x5b, 0xb7, 0x70, 0xad, 0x12, 0xcd, 0x1f, 0xf1, 0xe0, 0x7a, 0xfc, 0x4, 0xb6, 0xc8, 0x1e, 0x33, 0x23, 0x7a, 0xf8, 0xb, 0x15, 0x3, 0x0, 0xa, 0xe8, 0x28, 0xa7, 0x66, 0xa5, 0x22, 0x17, 0x97, 0x18, 0xac, 0x27, 0x0, 0x0, 0x47, 0x39, 0x13, 0x6a, 0x80, 0x16, 0x0, 0x17, 0xa8, 0x18, 0xbe, 0x25, 0xda, 0xae, 0x70, 0x21, 0xf8, 0xe9, 0x12, 0xb, 0xeb, 0xb6, 0xa6, 0x73, 0x5, 0x51, 0x8f, 0x6d, 0xfd, 0xdd, 0xe8, 0x22, 0x2c, 0x87, 0x24, 0x51, 0x17, 0xb8, 0x1a, 0x0, 0x17, 0xf8, 0x2e, 0xc0, 0x3c, 0x16, 0x4a, 0x20, 0x32, 0x14, 0xf6, 0x2b, 0xa6, 0x1c, 0x61, 0x68, 0x11, 0x26, 0x6a, 0x1, 0x59, 0xc6, 0xa2, 0xd7, 0x26, 0x0, 0x6, 0xb6, 0xec, 0x64, 0xa9, 0x6f, 0x5d, 0x0, 0x2, 0x4f, 0xfa, 0x13, 0x75, 0xeb, 0xb, 0x20, 0x2, 0x0, 0x0, 0x76, 0xa7, 0x29, 0x72, 0x0, 0x17, 0x65, 0xa6, 0x73, 0x33, 0x1, 0x9e, 0x5f, 0xe8, 0x75, 0x35, 0x79, 0xf9, 0xb8, 0x61, 0x4a, 0xc2, 0xf6, 0xdc, 0xe2, 0xb8, 0xd1, 0xdf, 0x19, 0x0, 0x15, 0x5f, 0xf5, 0x83, 0x83, 0x49, 0xcd, 0x8, 0xe1, 0x17, 0x98, 0xe, 0x98, 0x30, 0x5, 0x91, 0x3c, 0x9e, 0x9, 0x34, 0x3a, 0x87, 0x0, 0x1e, 0x3c, 0xc8, 0xe8, 0x71, 0xb3, 0x63, 0xde, 0xa8, 0x7, 0xba, 0x4d, 0x1f, 0xfb, 0x49, 0xd2, 0xde, 0x77, 0xc3, 0x48, 0x38, 0x0, 0xf2, 0x21, 0x58, 0xc7, 0x73, 0xdb, 0xf5, 0xa5, 0x69};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 183}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x4b, 0x47, 0xe4, 0xff, 0x4c, 0xa7, 0x46};
  uint8_t byteswillprops1[] = {0x2e, 0xce, 0x43, 0xc4, 0xac, 0x20, 0x4, 0x9f, 0x28, 0xb0, 0xa5, 0x51};
  uint8_t byteswillprops2[] = {0x66, 0x10, 0x51, 0xfd, 0x83, 0x7b, 0x64, 0x32, 0x85, 0x5b, 0xc7, 0xa, 0x49, 0xda, 0xf4, 0x1c, 0xbf, 0xca, 0x32, 0xa3, 0xc7, 0xde, 0x2};
  uint8_t byteswillprops3[] = {0x79, 0x6a, 0x34, 0x9f, 0x16, 0xb8, 0x85, 0x5b, 0xb7, 0x70, 0xad, 0x12, 0xcd, 0x1f, 0xf1, 0xe0, 0x7a, 0xfc, 0x4, 0xb6, 0xc8, 0x1e, 0x33};
  uint8_t byteswillprops4[] = {0xe8, 0x28, 0xa7, 0x66, 0xa5, 0x22, 0x17, 0x97, 0x18, 0xac};
  uint8_t byteswillprops5[] = {0xa8, 0x18, 0xbe, 0x25, 0xda, 0xae, 0x70, 0x21, 0xf8, 0xe9, 0x12, 0xb, 0xeb, 0xb6, 0xa6, 0x73, 0x5, 0x51, 0x8f, 0x6d, 0xfd, 0xdd, 0xe8};
  uint8_t byteswillprops6[] = {0xf8, 0x2e, 0xc0, 0x3c, 0x16, 0x4a, 0x20, 0x32, 0x14, 0xf6, 0x2b, 0xa6, 0x1c, 0x61, 0x68, 0x11, 0x26, 0x6a, 0x1, 0x59, 0xc6, 0xa2, 0xd7};
  uint8_t byteswillprops8[] = {0x4f, 0xfa};
  uint8_t byteswillprops7[] = {0xb6, 0xec, 0x64, 0xa9, 0x6f, 0x5d};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 7039}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 245}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 22}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {12, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 23}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29502}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 10}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 198}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 55}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 58}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {23, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 31480}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 21}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {10, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18233}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27264}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {23, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 11399}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 184}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {23, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={6, (char*)&byteswillprops7}, .v={2, (char*)&byteswillprops8}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 30187}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 32}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30375}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 114}},
  };

  lwmqtt_properties_t willprops = {28, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x65, 0xa6, 0x73, 0x33, 0x1, 0x9e, 0x5f, 0xe8, 0x75, 0x35, 0x79, 0xf9, 0xb8, 0x61, 0x4a, 0xc2, 0xf6, 0xdc, 0xe2, 0xb8, 0xd1, 0xdf, 0x19};
  lwmqtt_string_t will_topic = {23, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x5f, 0xf5, 0x83, 0x83, 0x49, 0xcd, 0x8, 0xe1, 0x17, 0x98, 0xe, 0x98, 0x30, 0x5, 0x91, 0x3c, 0x9e, 0x9, 0x34, 0x3a, 0x87};
  lwmqtt_string_t will_payload = {21, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 14400;
  uint8_t client_id_bytes[] = {0x15, 0xb2, 0x6f, 0x2d};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x3c, 0xc8, 0xe8, 0x71, 0xb3, 0x63, 0xde, 0xa8, 0x7, 0xba, 0x4d, 0x1f, 0xfb, 0x49, 0xd2, 0xde, 0x77, 0xc3, 0x48, 0x38, 0x0, 0xf2, 0x21, 0x58, 0xc7, 0x73, 0xdb, 0xf5, 0xa5, 0x69};
  lwmqtt_string_t password = {30, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\157\&7\160\&4!<\152o", _willMsg = "\207\206*\r\196x\199J", _willProps = [PropReasonString "\191\132\SUB\210l}\tp\172\203",PropCorrelationData "lg\184\168q$[\198\239h\CAN\255\200\246\177\148`\GS\155\SYN\156#\167\208x",PropSubscriptionIdentifier 1,PropContentType "\t\138\220%J\192P\139s\DELI\189E}\a\RS7\242\US\195\202\SOH\146",PropSharedSubscriptionAvailable 101,PropServerKeepAlive 32013,PropTopicAliasMaximum 29954]}), _cleanSession = False, _keepAlive = 22372, _connID = "\153\215g\142q\253\SUB\139\224jU\202Kb\220Q\233\DC2\137\&5", _properties = [PropPayloadFormatIndicator 102,PropAuthenticationMethod "^\139\ACK\ENQ]\198\245\245\249\233f\162\212\187\246?5U'\158V",PropRequestProblemInformation 63,PropAuthenticationMethod "J\232\225\186e\159",PropRetainAvailable 205,PropSessionExpiryInterval 7662,PropServerKeepAlive 30100,PropMaximumQoS 218,PropContentType "\198\&4C\185\252<\207@1\145",PropSessionExpiryInterval 18186,PropReasonString "{\136\214\vX\146\142\137\199\&8\216\bC\216\&2\243\241\193^\151}\DC1\238\246\150M\252\140\138\148",PropTopicAlias 14329,PropTopicAliasMaximum 24864,PropMaximumPacketSize 1959,PropAssignedClientIdentifier "\251\155GO\172\STX\164\DC1\236\SO\152+3\202\131:&1\155\220\197\&5\210>",PropSubscriptionIdentifier 20,PropRequestProblemInformation 235,PropTopicAlias 22057,PropContentType "\154O\FS\174\199T\236tb\202D",PropSharedSubscriptionAvailable 138,PropResponseTopic "\210\254\STX\186).\v]\145Y\tl\154oJ\STX\135\STXd\250\254",PropAssignedClientIdentifier "\RS\234-\177J7R\241\216\r\181Pc<&\ENQ\229\197",PropMessageExpiryInterval 9209,PropSharedSubscriptionAvailable 80,PropResponseTopic "f\220\GSj5|YH\"-\149:\210%",PropReasonString "\207Y\247",PropUserProperty "\fO" "\\\217\130\161`\204]\227nYDd\144(G.q\141\131 d\215\ETX8\164",PropAssignedClientIdentifier "\165\243\249m\158\221s\250s\199\237j\187&\168\DC4;Y\200\151u"]}
TEST(Connect5QCTest, Encode2) {
uint8_t pkt[] = {0x10, 0xa8, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xc, 0x57, 0x64, 0xa4, 0x2, 0x1, 0x66, 0x15, 0x0, 0x15, 0x5e, 0x8b, 0x6, 0x5, 0x5d, 0xc6, 0xf5, 0xf5, 0xf9, 0xe9, 0x66, 0xa2, 0xd4, 0xbb, 0xf6, 0x3f, 0x35, 0x55, 0x27, 0x9e, 0x56, 0x17, 0x3f, 0x15, 0x0, 0x6, 0x4a, 0xe8, 0xe1, 0xba, 0x65, 0x9f, 0x25, 0xcd, 0x11, 0x0, 0x0, 0x1d, 0xee, 0x13, 0x75, 0x94, 0x24, 0xda, 0x3, 0x0, 0xa, 0xc6, 0x34, 0x43, 0xb9, 0xfc, 0x3c, 0xcf, 0x40, 0x31, 0x91, 0x11, 0x0, 0x0, 0x47, 0xa, 0x1f, 0x0, 0x1e, 0x7b, 0x88, 0xd6, 0xb, 0x58, 0x92, 0x8e, 0x89, 0xc7, 0x38, 0xd8, 0x8, 0x43, 0xd8, 0x32, 0xf3, 0xf1, 0xc1, 0x5e, 0x97, 0x7d, 0x11, 0xee, 0xf6, 0x96, 0x4d, 0xfc, 0x8c, 0x8a, 0x94, 0x23, 0x37, 0xf9, 0x22, 0x61, 0x20, 0x27, 0x0, 0x0, 0x7, 0xa7, 0x12, 0x0, 0x18, 0xfb, 0x9b, 0x47, 0x4f, 0xac, 0x2, 0xa4, 0x11, 0xec, 0xe, 0x98, 0x2b, 0x33, 0xca, 0x83, 0x3a, 0x26, 0x31, 0x9b, 0xdc, 0xc5, 0x35, 0xd2, 0x3e, 0xb, 0x14, 0x17, 0xeb, 0x23, 0x56, 0x29, 0x3, 0x0, 0xb, 0x9a, 0x4f, 0x1c, 0xae, 0xc7, 0x54, 0xec, 0x74, 0x62, 0xca, 0x44, 0x2a, 0x8a, 0x8, 0x0, 0x15, 0xd2, 0xfe, 0x2, 0xba, 0x29, 0x2e, 0xb, 0x5d, 0x91, 0x59, 0x9, 0x6c, 0x9a, 0x6f, 0x4a, 0x2, 0x87, 0x2, 0x64, 0xfa, 0xfe, 0x12, 0x0, 0x12, 0x1e, 0xea, 0x2d, 0xb1, 0x4a, 0x37, 0x52, 0xf1, 0xd8, 0xd, 0xb5, 0x50, 0x63, 0x3c, 0x26, 0x5, 0xe5, 0xc5, 0x2, 0x0, 0x0, 0x23, 0xf9, 0x2a, 0x50, 0x8, 0x0, 0xe, 0x66, 0xdc, 0x1d, 0x6a, 0x35, 0x7c, 0x59, 0x48, 0x22, 0x2d, 0x95, 0x3a, 0xd2, 0x25, 0x1f, 0x0, 0x3, 0xcf, 0x59, 0xf7, 0x26, 0x0, 0x2, 0xc, 0x4f, 0x0, 0x19, 0x5c, 0xd9, 0x82, 0xa1, 0x60, 0xcc, 0x5d, 0xe3, 0x6e, 0x59, 0x44, 0x64, 0x90, 0x28, 0x47, 0x2e, 0x71, 0x8d, 0x83, 0x20, 0x64, 0xd7, 0x3, 0x38, 0xa4, 0x12, 0x0, 0x15, 0xa5, 0xf3, 0xf9, 0x6d, 0x9e, 0xdd, 0x73, 0xfa, 0x73, 0xc7, 0xed, 0x6a, 0xbb, 0x26, 0xa8, 0x14, 0x3b, 0x59, 0xc8, 0x97, 0x75, 0x0, 0x14, 0x99, 0xd7, 0x67, 0x8e, 0x71, 0xfd, 0x1a, 0x8b, 0xe0, 0x6a, 0x55, 0xca, 0x4b, 0x62, 0xdc, 0x51, 0xe9, 0x12, 0x89, 0x35, 0x4d, 0x1f, 0x0, 0xa, 0xbf, 0x84, 0x1a, 0xd2, 0x6c, 0x7d, 0x9, 0x70, 0xac, 0xcb, 0x9, 0x0, 0x19, 0x6c, 0x67, 0xb8, 0xa8, 0x71, 0x24, 0x5b, 0xc6, 0xef, 0x68, 0x18, 0xff, 0xc8, 0xf6, 0xb1, 0x94, 0x60, 0x1d, 0x9b, 0x16, 0x9c, 0x23, 0xa7, 0xd0, 0x78, 0xb, 0x1, 0x3, 0x0, 0x17, 0x9, 0x8a, 0xdc, 0x25, 0x4a, 0xc0, 0x50, 0x8b, 0x73, 0x7f, 0x49, 0xbd, 0x45, 0x7d, 0x7, 0x1e, 0x37, 0xf2, 0x1f, 0xc3, 0xca, 0x1, 0x92, 0x2a, 0x65, 0x13, 0x7d, 0xd, 0x22, 0x75, 0x2, 0x0, 0x8, 0x9d, 0x37, 0xa0, 0x34, 0x21, 0x3c, 0x98, 0x6f, 0x0, 0x8, 0xcf, 0xce, 0x2a, 0xd, 0xc4, 0x78, 0xc7, 0x4a};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x5e, 0x8b, 0x6, 0x5, 0x5d, 0xc6, 0xf5, 0xf5, 0xf9, 0xe9, 0x66, 0xa2, 0xd4, 0xbb, 0xf6, 0x3f, 0x35, 0x55, 0x27, 0x9e, 0x56};
  uint8_t bytesprops1[] = {0x4a, 0xe8, 0xe1, 0xba, 0x65, 0x9f};
  uint8_t bytesprops2[] = {0xc6, 0x34, 0x43, 0xb9, 0xfc, 0x3c, 0xcf, 0x40, 0x31, 0x91};
  uint8_t bytesprops3[] = {0x7b, 0x88, 0xd6, 0xb, 0x58, 0x92, 0x8e, 0x89, 0xc7, 0x38, 0xd8, 0x8, 0x43, 0xd8, 0x32, 0xf3, 0xf1, 0xc1, 0x5e, 0x97, 0x7d, 0x11, 0xee, 0xf6, 0x96, 0x4d, 0xfc, 0x8c, 0x8a, 0x94};
  uint8_t bytesprops4[] = {0xfb, 0x9b, 0x47, 0x4f, 0xac, 0x2, 0xa4, 0x11, 0xec, 0xe, 0x98, 0x2b, 0x33, 0xca, 0x83, 0x3a, 0x26, 0x31, 0x9b, 0xdc, 0xc5, 0x35, 0xd2, 0x3e};
  uint8_t bytesprops5[] = {0x9a, 0x4f, 0x1c, 0xae, 0xc7, 0x54, 0xec, 0x74, 0x62, 0xca, 0x44};
  uint8_t bytesprops6[] = {0xd2, 0xfe, 0x2, 0xba, 0x29, 0x2e, 0xb, 0x5d, 0x91, 0x59, 0x9, 0x6c, 0x9a, 0x6f, 0x4a, 0x2, 0x87, 0x2, 0x64, 0xfa, 0xfe};
  uint8_t bytesprops7[] = {0x1e, 0xea, 0x2d, 0xb1, 0x4a, 0x37, 0x52, 0xf1, 0xd8, 0xd, 0xb5, 0x50, 0x63, 0x3c, 0x26, 0x5, 0xe5, 0xc5};
  uint8_t bytesprops8[] = {0x66, 0xdc, 0x1d, 0x6a, 0x35, 0x7c, 0x59, 0x48, 0x22, 0x2d, 0x95, 0x3a, 0xd2, 0x25};
  uint8_t bytesprops9[] = {0xcf, 0x59, 0xf7};
  uint8_t bytesprops11[] = {0x5c, 0xd9, 0x82, 0xa1, 0x60, 0xcc, 0x5d, 0xe3, 0x6e, 0x59, 0x44, 0x64, 0x90, 0x28, 0x47, 0x2e, 0x71, 0x8d, 0x83, 0x20, 0x64, 0xd7, 0x3, 0x38, 0xa4};
  uint8_t bytesprops10[] = {0xc, 0x4f};
  uint8_t bytesprops12[] = {0xa5, 0xf3, 0xf9, 0x6d, 0x9e, 0xdd, 0x73, 0xfa, 0x73, 0xc7, 0xed, 0x6a, 0xbb, 0x26, 0xa8, 0x14, 0x3b, 0x59, 0xc8, 0x97, 0x75};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 102}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 63}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 205}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7662}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 30100}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 218}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {10, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18186}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {30, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14329}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24864}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1959}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 20}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 235}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22057}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 138}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {21, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {18, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9209}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 80}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {14, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={2, (char*)&bytesprops10}, .v={25, (char*)&bytesprops11}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops12}}},
  };

  lwmqtt_properties_t props = {28, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xbf, 0x84, 0x1a, 0xd2, 0x6c, 0x7d, 0x9, 0x70, 0xac, 0xcb};
  uint8_t byteswillprops1[] = {0x6c, 0x67, 0xb8, 0xa8, 0x71, 0x24, 0x5b, 0xc6, 0xef, 0x68, 0x18, 0xff, 0xc8, 0xf6, 0xb1, 0x94, 0x60, 0x1d, 0x9b, 0x16, 0x9c, 0x23, 0xa7, 0xd0, 0x78};
  uint8_t byteswillprops2[] = {0x9, 0x8a, 0xdc, 0x25, 0x4a, 0xc0, 0x50, 0x8b, 0x73, 0x7f, 0x49, 0xbd, 0x45, 0x7d, 0x7, 0x1e, 0x37, 0xf2, 0x1f, 0xc3, 0xca, 0x1, 0x92};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {25, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 1}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 101}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 32013}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29954}},
  };

  lwmqtt_properties_t willprops = {7, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x9d, 0x37, 0xa0, 0x34, 0x21, 0x3c, 0x98, 0x6f};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xcf, 0xce, 0x2a, 0xd, 0xc4, 0x78, 0xc7, 0x4a};
  lwmqtt_string_t will_payload = {8, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 22372;
  uint8_t client_id_bytes[] = {0x99, 0xd7, 0x67, 0x8e, 0x71, 0xfd, 0x1a, 0x8b, 0xe0, 0x6a, 0x55, 0xca, 0x4b, 0x62, 0xdc, 0x51, 0xe9, 0x12, 0x89, 0x35};
  lwmqtt_string_t client_id = {20, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\210\154\156`\157$\167\211\ACK|\EMc\FS\DC4;\244\132\247\250\DC1p\226", _password = Just "\250\211\178\rK\SUB\US\221G\171\f\202\222h\195\201\142\SOH\178\141\RS\179\234d\191G\245\249", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic = "\166\245E _4\192:\130\134\233", _willMsg = "\199!\216\227\149HhD#\178\nH@\210\185:C\147\183\168", _willProps = [PropRetainAvailable 201,PropSubscriptionIdentifier 28,PropCorrelationData "\193\bY",PropContentType "\DC1I\ACK\ACK\160\174#k\n+\194k#x.\185\166`\245\DELM\209dRs\SIC\240\&3\195",PropServerKeepAlive 8768,PropSharedSubscriptionAvailable 108,PropAssignedClientIdentifier "\202\SI\DC1\ESC\ETB\EM\SI\159a\173]\SUB\RST\241\NULX\243\139i\ENQ\241*\DC2#\135bQ\159",PropReasonString "\175\211\164",PropAuthenticationMethod "K\210\166",PropMaximumQoS 129,PropMessageExpiryInterval 5457,PropMessageExpiryInterval 28978,PropSharedSubscriptionAvailable 15,PropSessionExpiryInterval 17136]}), _cleanSession = False, _keepAlive = 11307, _connID = "\214\137\207{L;\190\191\172O\206z4\183", _properties = [PropAuthenticationMethod "\195\178\201+\211\146\r\182\&3z\204(\217\STX",PropRetainAvailable 112,PropMessageExpiryInterval 18289,PropSubscriptionIdentifier 11,PropCorrelationData "\227MN\223J\ETBa\218\179\156",PropAuthenticationData "\235V\247H*\ESCht\241\146\212:\172\250\149Q\156\205",PropResponseInformation "\250\ESC\fV\212\225\247(\EM\170\SOZ\209\142\188\218\154\EOT",PropPayloadFormatIndicator 209,PropSubscriptionIdentifierAvailable 203,PropRequestProblemInformation 213,PropRetainAvailable 99,PropWildcardSubscriptionAvailable 54,PropCorrelationData "\SYN:G\DC4\129\rb\159U\189\147",PropServerKeepAlive 19775,PropPayloadFormatIndicator 42,PropServerReference "yB\217",PropServerReference "S\204$oc\132WG\237\139\f|\158\207q",PropRetainAvailable 53,PropTopicAliasMaximum 8890,PropSubscriptionIdentifierAvailable 141,PropServerReference "\DLE\163\200\240\189\RS/J\SOH>\DC1\v\232h/o3$\FS\NULD\150\215\142&h\CAN\182\234",PropMaximumQoS 4,PropAuthenticationMethod "\ESC\175\r\230\167\232\253c\132GY",PropSharedSubscriptionAvailable 179,PropAssignedClientIdentifier "\239\CAN\154\181\NUL\SI$\221\247t\249hug/\STX\140qQ\155",PropSessionExpiryInterval 31964,PropReasonString "\US\ESCFm9\232vg\220X\148\b\231-",PropUserProperty "S\152\255\161\183g]\234" "",PropResponseInformation "\175\RS\210\129\"\230\175?\SO\ETXu\186\217)\201\136\SI\133!\160'\189\254\248\199r\159",PropTopicAlias 10779]}
TEST(Connect5QCTest, Encode3) {
uint8_t pkt[] = {0x10, 0xff, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xc4, 0x2c, 0x2b, 0x9a, 0x2, 0x15, 0x0, 0xe, 0xc3, 0xb2, 0xc9, 0x2b, 0xd3, 0x92, 0xd, 0xb6, 0x33, 0x7a, 0xcc, 0x28, 0xd9, 0x2, 0x25, 0x70, 0x2, 0x0, 0x0, 0x47, 0x71, 0xb, 0xb, 0x9, 0x0, 0xa, 0xe3, 0x4d, 0x4e, 0xdf, 0x4a, 0x17, 0x61, 0xda, 0xb3, 0x9c, 0x16, 0x0, 0x12, 0xeb, 0x56, 0xf7, 0x48, 0x2a, 0x1b, 0x68, 0x74, 0xf1, 0x92, 0xd4, 0x3a, 0xac, 0xfa, 0x95, 0x51, 0x9c, 0xcd, 0x1a, 0x0, 0x12, 0xfa, 0x1b, 0xc, 0x56, 0xd4, 0xe1, 0xf7, 0x28, 0x19, 0xaa, 0xe, 0x5a, 0xd1, 0x8e, 0xbc, 0xda, 0x9a, 0x4, 0x1, 0xd1, 0x29, 0xcb, 0x17, 0xd5, 0x25, 0x63, 0x28, 0x36, 0x9, 0x0, 0xb, 0x16, 0x3a, 0x47, 0x14, 0x81, 0xd, 0x62, 0x9f, 0x55, 0xbd, 0x93, 0x13, 0x4d, 0x3f, 0x1, 0x2a, 0x1c, 0x0, 0x3, 0x79, 0x42, 0xd9, 0x1c, 0x0, 0xf, 0x53, 0xcc, 0x24, 0x6f, 0x63, 0x84, 0x57, 0x47, 0xed, 0x8b, 0xc, 0x7c, 0x9e, 0xcf, 0x71, 0x25, 0x35, 0x22, 0x22, 0xba, 0x29, 0x8d, 0x1c, 0x0, 0x1d, 0x10, 0xa3, 0xc8, 0xf0, 0xbd, 0x1e, 0x2f, 0x4a, 0x1, 0x3e, 0x11, 0xb, 0xe8, 0x68, 0x2f, 0x6f, 0x33, 0x24, 0x1c, 0x0, 0x44, 0x96, 0xd7, 0x8e, 0x26, 0x68, 0x18, 0xb6, 0xea, 0x24, 0x4, 0x15, 0x0, 0xb, 0x1b, 0xaf, 0xd, 0xe6, 0xa7, 0xe8, 0xfd, 0x63, 0x84, 0x47, 0x59, 0x2a, 0xb3, 0x12, 0x0, 0x14, 0xef, 0x18, 0x9a, 0xb5, 0x0, 0xf, 0x24, 0xdd, 0xf7, 0x74, 0xf9, 0x68, 0x75, 0x67, 0x2f, 0x2, 0x8c, 0x71, 0x51, 0x9b, 0x11, 0x0, 0x0, 0x7c, 0xdc, 0x1f, 0x0, 0xe, 0x1f, 0x1b, 0x46, 0x6d, 0x39, 0xe8, 0x76, 0x67, 0xdc, 0x58, 0x94, 0x8, 0xe7, 0x2d, 0x26, 0x0, 0x8, 0x53, 0x98, 0xff, 0xa1, 0xb7, 0x67, 0x5d, 0xea, 0x0, 0x0, 0x1a, 0x0, 0x1b, 0xaf, 0x1e, 0xd2, 0x81, 0x22, 0xe6, 0xaf, 0x3f, 0xe, 0x3, 0x75, 0xba, 0xd9, 0x29, 0xc9, 0x88, 0xf, 0x85, 0x21, 0xa0, 0x27, 0xbd, 0xfe, 0xf8, 0xc7, 0x72, 0x9f, 0x23, 0x2a, 0x1b, 0x0, 0xe, 0xd6, 0x89, 0xcf, 0x7b, 0x4c, 0x3b, 0xbe, 0xbf, 0xac, 0x4f, 0xce, 0x7a, 0x34, 0xb7, 0x6f, 0x25, 0xc9, 0xb, 0x1c, 0x9, 0x0, 0x3, 0xc1, 0x8, 0x59, 0x3, 0x0, 0x1e, 0x11, 0x49, 0x6, 0x6, 0xa0, 0xae, 0x23, 0x6b, 0xa, 0x2b, 0xc2, 0x6b, 0x23, 0x78, 0x2e, 0xb9, 0xa6, 0x60, 0xf5, 0x7f, 0x4d, 0xd1, 0x64, 0x52, 0x73, 0xf, 0x43, 0xf0, 0x33, 0xc3, 0x13, 0x22, 0x40, 0x2a, 0x6c, 0x12, 0x0, 0x1d, 0xca, 0xf, 0x11, 0x1b, 0x17, 0x19, 0xf, 0x9f, 0x61, 0xad, 0x5d, 0x1a, 0x1e, 0x54, 0xf1, 0x0, 0x58, 0xf3, 0x8b, 0x69, 0x5, 0xf1, 0x2a, 0x12, 0x23, 0x87, 0x62, 0x51, 0x9f, 0x1f, 0x0, 0x3, 0xaf, 0xd3, 0xa4, 0x15, 0x0, 0x3, 0x4b, 0xd2, 0xa6, 0x24, 0x81, 0x2, 0x0, 0x0, 0x15, 0x51, 0x2, 0x0, 0x0, 0x71, 0x32, 0x2a, 0xf, 0x11, 0x0, 0x0, 0x42, 0xf0, 0x0, 0xb, 0xa6, 0xf5, 0x45, 0x20, 0x5f, 0x34, 0xc0, 0x3a, 0x82, 0x86, 0xe9, 0x0, 0x14, 0xc7, 0x21, 0xd8, 0xe3, 0x95, 0x48, 0x68, 0x44, 0x23, 0xb2, 0xa, 0x48, 0x40, 0xd2, 0xb9, 0x3a, 0x43, 0x93, 0xb7, 0xa8, 0x0, 0x16, 0xd2, 0x9a, 0x9c, 0x60, 0x9d, 0x24, 0xa7, 0xd3, 0x6, 0x7c, 0x19, 0x63, 0x1c, 0x14, 0x3b, 0xf4, 0x84, 0xf7, 0xfa, 0x11, 0x70, 0xe2, 0x0, 0x1c, 0xfa, 0xd3, 0xb2, 0xd, 0x4b, 0x1a, 0x1f, 0xdd, 0x47, 0xab, 0xc, 0xca, 0xde, 0x68, 0xc3, 0xc9, 0x8e, 0x1, 0xb2, 0x8d, 0x1e, 0xb3, 0xea, 0x64, 0xbf, 0x47, 0xf5, 0xf9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xc3, 0xb2, 0xc9, 0x2b, 0xd3, 0x92, 0xd, 0xb6, 0x33, 0x7a, 0xcc, 0x28, 0xd9, 0x2};
  uint8_t bytesprops1[] = {0xe3, 0x4d, 0x4e, 0xdf, 0x4a, 0x17, 0x61, 0xda, 0xb3, 0x9c};
  uint8_t bytesprops2[] = {0xeb, 0x56, 0xf7, 0x48, 0x2a, 0x1b, 0x68, 0x74, 0xf1, 0x92, 0xd4, 0x3a, 0xac, 0xfa, 0x95, 0x51, 0x9c, 0xcd};
  uint8_t bytesprops3[] = {0xfa, 0x1b, 0xc, 0x56, 0xd4, 0xe1, 0xf7, 0x28, 0x19, 0xaa, 0xe, 0x5a, 0xd1, 0x8e, 0xbc, 0xda, 0x9a, 0x4};
  uint8_t bytesprops4[] = {0x16, 0x3a, 0x47, 0x14, 0x81, 0xd, 0x62, 0x9f, 0x55, 0xbd, 0x93};
  uint8_t bytesprops5[] = {0x79, 0x42, 0xd9};
  uint8_t bytesprops6[] = {0x53, 0xcc, 0x24, 0x6f, 0x63, 0x84, 0x57, 0x47, 0xed, 0x8b, 0xc, 0x7c, 0x9e, 0xcf, 0x71};
  uint8_t bytesprops7[] = {0x10, 0xa3, 0xc8, 0xf0, 0xbd, 0x1e, 0x2f, 0x4a, 0x1, 0x3e, 0x11, 0xb, 0xe8, 0x68, 0x2f, 0x6f, 0x33, 0x24, 0x1c, 0x0, 0x44, 0x96, 0xd7, 0x8e, 0x26, 0x68, 0x18, 0xb6, 0xea};
  uint8_t bytesprops8[] = {0x1b, 0xaf, 0xd, 0xe6, 0xa7, 0xe8, 0xfd, 0x63, 0x84, 0x47, 0x59};
  uint8_t bytesprops9[] = {0xef, 0x18, 0x9a, 0xb5, 0x0, 0xf, 0x24, 0xdd, 0xf7, 0x74, 0xf9, 0x68, 0x75, 0x67, 0x2f, 0x2, 0x8c, 0x71, 0x51, 0x9b};
  uint8_t bytesprops10[] = {0x1f, 0x1b, 0x46, 0x6d, 0x39, 0xe8, 0x76, 0x67, 0xdc, 0x58, 0x94, 0x8, 0xe7, 0x2d};
  uint8_t bytesprops12[] = {0};
  uint8_t bytesprops11[] = {0x53, 0x98, 0xff, 0xa1, 0xb7, 0x67, 0x5d, 0xea};
  uint8_t bytesprops13[] = {0xaf, 0x1e, 0xd2, 0x81, 0x22, 0xe6, 0xaf, 0x3f, 0xe, 0x3, 0x75, 0xba, 0xd9, 0x29, 0xc9, 0x88, 0xf, 0x85, 0x21, 0xa0, 0x27, 0xbd, 0xfe, 0xf8, 0xc7, 0x72, 0x9f};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 112}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18289}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 11}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 209}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 203}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 213}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 99}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {11, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19775}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {15, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 53}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 8890}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {29, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 4}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 179}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31964}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={8, (char*)&bytesprops11}, .v={0, (char*)&bytesprops12}}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {27, (char*)&bytesprops13}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10779}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xc1, 0x8, 0x59};
  uint8_t byteswillprops1[] = {0x11, 0x49, 0x6, 0x6, 0xa0, 0xae, 0x23, 0x6b, 0xa, 0x2b, 0xc2, 0x6b, 0x23, 0x78, 0x2e, 0xb9, 0xa6, 0x60, 0xf5, 0x7f, 0x4d, 0xd1, 0x64, 0x52, 0x73, 0xf, 0x43, 0xf0, 0x33, 0xc3};
  uint8_t byteswillprops2[] = {0xca, 0xf, 0x11, 0x1b, 0x17, 0x19, 0xf, 0x9f, 0x61, 0xad, 0x5d, 0x1a, 0x1e, 0x54, 0xf1, 0x0, 0x58, 0xf3, 0x8b, 0x69, 0x5, 0xf1, 0x2a, 0x12, 0x23, 0x87, 0x62, 0x51, 0x9f};
  uint8_t byteswillprops3[] = {0xaf, 0xd3, 0xa4};
  uint8_t byteswillprops4[] = {0x4b, 0xd2, 0xa6};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 201}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 28}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {3, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 8768}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 108}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 129}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5457}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28978}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 15}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 17136}},
  };

  lwmqtt_properties_t willprops = {14, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa6, 0xf5, 0x45, 0x20, 0x5f, 0x34, 0xc0, 0x3a, 0x82, 0x86, 0xe9};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xc7, 0x21, 0xd8, 0xe3, 0x95, 0x48, 0x68, 0x44, 0x23, 0xb2, 0xa, 0x48, 0x40, 0xd2, 0xb9, 0x3a, 0x43, 0x93, 0xb7, 0xa8};
  lwmqtt_string_t will_payload = {20, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 11307;
  uint8_t client_id_bytes[] = {0xd6, 0x89, 0xcf, 0x7b, 0x4c, 0x3b, 0xbe, 0xbf, 0xac, 0x4f, 0xce, 0x7a, 0x34, 0xb7};
  lwmqtt_string_t client_id = {14, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xd2, 0x9a, 0x9c, 0x60, 0x9d, 0x24, 0xa7, 0xd3, 0x6, 0x7c, 0x19, 0x63, 0x1c, 0x14, 0x3b, 0xf4, 0x84, 0xf7, 0xfa, 0x11, 0x70, 0xe2};
  lwmqtt_string_t username = {22, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xfa, 0xd3, 0xb2, 0xd, 0x4b, 0x1a, 0x1f, 0xdd, 0x47, 0xab, 0xc, 0xca, 0xde, 0x68, 0xc3, 0xc9, 0x8e, 0x1, 0xb2, 0x8d, 0x1e, 0xb3, 0xea, 0x64, 0xbf, 0x47, 0xf5, 0xf9};
  lwmqtt_string_t password = {28, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\129&\239\168\247MW\197\EOT\DEL\231\f9.aTK,o\DC324I\149\171", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "\192\172\136", _willMsg = "W\132\155\204", _willProps = [PropPayloadFormatIndicator 155,PropMessageExpiryInterval 7104,PropSubscriptionIdentifierAvailable 240,PropWildcardSubscriptionAvailable 11,PropTopicAliasMaximum 6238,PropTopicAliasMaximum 29991,PropReceiveMaximum 26159,PropRetainAvailable 19,PropRetainAvailable 242,PropServerKeepAlive 28945,PropMaximumQoS 199,PropTopicAliasMaximum 29426,PropReasonString "z*\"w4\210\198\167lND\230\195\233\\\165\EMbqO\195\219\220\207!\140/\n\188",PropMaximumQoS 118,PropReasonString "\SYNHn\136\t\175f?\132",PropMessageExpiryInterval 13081,PropAuthenticationData "9\239\STXg\130G\212\245\186\154j\175\253\175 \183\167\164\135\202\247O",PropRequestResponseInformation 224,PropSubscriptionIdentifierAvailable 16,PropMessageExpiryInterval 19854,PropResponseTopic "\131\224G\170\&5\ETX\228\223\149",PropRetainAvailable 124,PropSubscriptionIdentifierAvailable 77]}), _cleanSession = True, _keepAlive = 16616, _connID = "f4\EOTKMC\199\173\161\251\151", _properties = [PropRequestProblemInformation 43,PropMessageExpiryInterval 1208,PropRetainAvailable 117,PropRequestResponseInformation 191,PropSharedSubscriptionAvailable 108,PropMaximumQoS 22,PropContentType "\171\234\131Ip)\rbbg\161\&5\148\209\t\223;\170\253\247\ETXi\131F\237pn",PropCorrelationData "",PropAuthenticationMethod " \SI\202\229",PropSharedSubscriptionAvailable 75]}
TEST(Connect5QCTest, Encode4) {
uint8_t pkt[] = {0x10, 0xfe, 0x1, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xa6, 0x40, 0xe8, 0x39, 0x17, 0x2b, 0x2, 0x0, 0x0, 0x4, 0xb8, 0x25, 0x75, 0x19, 0xbf, 0x2a, 0x6c, 0x24, 0x16, 0x3, 0x0, 0x1b, 0xab, 0xea, 0x83, 0x49, 0x70, 0x29, 0xd, 0x62, 0x62, 0x67, 0xa1, 0x35, 0x94, 0xd1, 0x9, 0xdf, 0x3b, 0xaa, 0xfd, 0xf7, 0x3, 0x69, 0x83, 0x46, 0xed, 0x70, 0x6e, 0x9, 0x0, 0x0, 0x15, 0x0, 0x4, 0x20, 0xf, 0xca, 0xe5, 0x2a, 0x4b, 0x0, 0xb, 0x66, 0x34, 0x4, 0x4b, 0x4d, 0x43, 0xc7, 0xad, 0xa1, 0xfb, 0x97, 0x85, 0x1, 0x1, 0x9b, 0x2, 0x0, 0x0, 0x1b, 0xc0, 0x29, 0xf0, 0x28, 0xb, 0x22, 0x18, 0x5e, 0x22, 0x75, 0x27, 0x21, 0x66, 0x2f, 0x25, 0x13, 0x25, 0xf2, 0x13, 0x71, 0x11, 0x24, 0xc7, 0x22, 0x72, 0xf2, 0x1f, 0x0, 0x1d, 0x7a, 0x2a, 0x22, 0x77, 0x34, 0xd2, 0xc6, 0xa7, 0x6c, 0x4e, 0x44, 0xe6, 0xc3, 0xe9, 0x5c, 0xa5, 0x19, 0x62, 0x71, 0x4f, 0xc3, 0xdb, 0xdc, 0xcf, 0x21, 0x8c, 0x2f, 0xa, 0xbc, 0x24, 0x76, 0x1f, 0x0, 0x9, 0x16, 0x48, 0x6e, 0x88, 0x9, 0xaf, 0x66, 0x3f, 0x84, 0x2, 0x0, 0x0, 0x33, 0x19, 0x16, 0x0, 0x16, 0x39, 0xef, 0x2, 0x67, 0x82, 0x47, 0xd4, 0xf5, 0xba, 0x9a, 0x6a, 0xaf, 0xfd, 0xaf, 0x20, 0xb7, 0xa7, 0xa4, 0x87, 0xca, 0xf7, 0x4f, 0x19, 0xe0, 0x29, 0x10, 0x2, 0x0, 0x0, 0x4d, 0x8e, 0x8, 0x0, 0x9, 0x83, 0xe0, 0x47, 0xaa, 0x35, 0x3, 0xe4, 0xdf, 0x95, 0x25, 0x7c, 0x29, 0x4d, 0x0, 0x3, 0xc0, 0xac, 0x88, 0x0, 0x4, 0x57, 0x84, 0x9b, 0xcc, 0x0, 0x19, 0x81, 0x26, 0xef, 0xa8, 0xf7, 0x4d, 0x57, 0xc5, 0x4, 0x7f, 0xe7, 0xc, 0x39, 0x2e, 0x61, 0x54, 0x4b, 0x2c, 0x6f, 0x13, 0x32, 0x34, 0x49, 0x95, 0xab};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xab, 0xea, 0x83, 0x49, 0x70, 0x29, 0xd, 0x62, 0x62, 0x67, 0xa1, 0x35, 0x94, 0xd1, 0x9, 0xdf, 0x3b, 0xaa, 0xfd, 0xf7, 0x3, 0x69, 0x83, 0x46, 0xed, 0x70, 0x6e};
  uint8_t bytesprops1[] = {0};
  uint8_t bytesprops2[] = {0x20, 0xf, 0xca, 0xe5};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 43}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 1208}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 191}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 108}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 22}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 75}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x7a, 0x2a, 0x22, 0x77, 0x34, 0xd2, 0xc6, 0xa7, 0x6c, 0x4e, 0x44, 0xe6, 0xc3, 0xe9, 0x5c, 0xa5, 0x19, 0x62, 0x71, 0x4f, 0xc3, 0xdb, 0xdc, 0xcf, 0x21, 0x8c, 0x2f, 0xa, 0xbc};
  uint8_t byteswillprops1[] = {0x16, 0x48, 0x6e, 0x88, 0x9, 0xaf, 0x66, 0x3f, 0x84};
  uint8_t byteswillprops2[] = {0x39, 0xef, 0x2, 0x67, 0x82, 0x47, 0xd4, 0xf5, 0xba, 0x9a, 0x6a, 0xaf, 0xfd, 0xaf, 0x20, 0xb7, 0xa7, 0xa4, 0x87, 0xca, 0xf7, 0x4f};
  uint8_t byteswillprops3[] = {0x83, 0xe0, 0x47, 0xaa, 0x35, 0x3, 0xe4, 0xdf, 0x95};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 155}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7104}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 240}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 11}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6238}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29991}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 26159}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 19}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 242}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 28945}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 199}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29426}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 118}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {9, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13081}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 224}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 16}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19854}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 124}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 77}},
  };

  lwmqtt_properties_t willprops = {23, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xc0, 0xac, 0x88};
  lwmqtt_string_t will_topic = {3, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x57, 0x84, 0x9b, 0xcc};
  lwmqtt_string_t will_payload = {4, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 16616;
  uint8_t client_id_bytes[] = {0x66, 0x34, 0x4, 0x4b, 0x4d, 0x43, 0xc7, 0xad, 0xa1, 0xfb, 0x97};
  lwmqtt_string_t client_id = {11, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x81, 0x26, 0xef, 0xa8, 0xf7, 0x4d, 0x57, 0xc5, 0x4, 0x7f, 0xe7, 0xc, 0x39, 0x2e, 0x61, 0x54, 0x4b, 0x2c, 0x6f, 0x13, 0x32, 0x34, 0x49, 0x95, 0xab};
  lwmqtt_string_t username = {25, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "?w\155e\220+\213:#.\196F<M\247", _willMsg = "\163\226:\244\SYN\132\149D_\239a\242x\167x\211-\215\219\144\148g\235i\239\246\143\204tK", _willProps = [PropReasonString "\NAK\240\232D^\248\137\148n\137\150\251\161\133\\\229\153\ETX\136\&3\SO\170E\DC4",PropSessionExpiryInterval 22700,PropRetainAvailable 155,PropAssignedClientIdentifier "\US\225\162NS\212\&7\141\SO{9)\228\154\230\177\233Ui\DC1\242X\149[n\194%o-\209",PropSubscriptionIdentifierAvailable 180,PropResponseTopic "\182\235\179\134eg\165Q\SI)\221|\RS\a#4\176\207mp\196}\139F\208S?a\193",PropUserProperty "\131T\156\EM%sg]\DC2\141\189 \251\162\251h" "<e9v_\188\240",PropTopicAlias 4004,PropRetainAvailable 14,PropRequestResponseInformation 104,PropServerKeepAlive 24648,PropRequestProblemInformation 251,PropSubscriptionIdentifier 9,PropRetainAvailable 221,PropResponseInformation "`[\220\180\STX\GSW5\149\241|x\249M\ETX\163\252\196s$P\136U\162\238\231\157",PropSessionExpiryInterval 2289,PropSubscriptionIdentifier 10,PropWildcardSubscriptionAvailable 3,PropRequestResponseInformation 177]}), _cleanSession = False, _keepAlive = 25316, _connID = "\b", _properties = [PropTopicAliasMaximum 16489,PropTopicAlias 17656,PropSubscriptionIdentifierAvailable 184,PropTopicAliasMaximum 29411,PropAuthenticationMethod "\148\&4O\163>1\243\198\178\&6\133\t\231\160c\FS\249\191\241\146\DC3H\175[x\229",PropMessageExpiryInterval 2953,PropServerReference "?7\176\173\&1P\147G\211\209\181\177\EOT\164A\247&\174\243\207\t\255(",PropRequestProblemInformation 97,PropReasonString "\SIL\192\248",PropAssignedClientIdentifier "\217\247j\247f\253k\188e\232\234\nB\247\253\213\142{3`"]}
TEST(Connect5QCTest, Encode5) {
uint8_t pkt[] = {0x10, 0xe2, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x2c, 0x62, 0xe4, 0x67, 0x22, 0x40, 0x69, 0x23, 0x44, 0xf8, 0x29, 0xb8, 0x22, 0x72, 0xe3, 0x15, 0x0, 0x1a, 0x94, 0x34, 0x4f, 0xa3, 0x3e, 0x31, 0xf3, 0xc6, 0xb2, 0x36, 0x85, 0x9, 0xe7, 0xa0, 0x63, 0x1c, 0xf9, 0xbf, 0xf1, 0x92, 0x13, 0x48, 0xaf, 0x5b, 0x78, 0xe5, 0x2, 0x0, 0x0, 0xb, 0x89, 0x1c, 0x0, 0x17, 0x3f, 0x37, 0xb0, 0xad, 0x31, 0x50, 0x93, 0x47, 0xd3, 0xd1, 0xb5, 0xb1, 0x4, 0xa4, 0x41, 0xf7, 0x26, 0xae, 0xf3, 0xcf, 0x9, 0xff, 0x28, 0x17, 0x61, 0x1f, 0x0, 0x4, 0xf, 0x4c, 0xc0, 0xf8, 0x12, 0x0, 0x14, 0xd9, 0xf7, 0x6a, 0xf7, 0x66, 0xfd, 0x6b, 0xbc, 0x65, 0xe8, 0xea, 0xa, 0x42, 0xf7, 0xfd, 0xd5, 0x8e, 0x7b, 0x33, 0x60, 0x0, 0x1, 0x8, 0xba, 0x1, 0x1f, 0x0, 0x18, 0x15, 0xf0, 0xe8, 0x44, 0x5e, 0xf8, 0x89, 0x94, 0x6e, 0x89, 0x96, 0xfb, 0xa1, 0x85, 0x5c, 0xe5, 0x99, 0x3, 0x88, 0x33, 0xe, 0xaa, 0x45, 0x14, 0x11, 0x0, 0x0, 0x58, 0xac, 0x25, 0x9b, 0x12, 0x0, 0x1e, 0x1f, 0xe1, 0xa2, 0x4e, 0x53, 0xd4, 0x37, 0x8d, 0xe, 0x7b, 0x39, 0x29, 0xe4, 0x9a, 0xe6, 0xb1, 0xe9, 0x55, 0x69, 0x11, 0xf2, 0x58, 0x95, 0x5b, 0x6e, 0xc2, 0x25, 0x6f, 0x2d, 0xd1, 0x29, 0xb4, 0x8, 0x0, 0x1d, 0xb6, 0xeb, 0xb3, 0x86, 0x65, 0x67, 0xa5, 0x51, 0xf, 0x29, 0xdd, 0x7c, 0x1e, 0x7, 0x23, 0x34, 0xb0, 0xcf, 0x6d, 0x70, 0xc4, 0x7d, 0x8b, 0x46, 0xd0, 0x53, 0x3f, 0x61, 0xc1, 0x26, 0x0, 0x10, 0x83, 0x54, 0x9c, 0x19, 0x25, 0x73, 0x67, 0x5d, 0x12, 0x8d, 0xbd, 0x20, 0xfb, 0xa2, 0xfb, 0x68, 0x0, 0x7, 0x3c, 0x65, 0x39, 0x76, 0x5f, 0xbc, 0xf0, 0x23, 0xf, 0xa4, 0x25, 0xe, 0x19, 0x68, 0x13, 0x60, 0x48, 0x17, 0xfb, 0xb, 0x9, 0x25, 0xdd, 0x1a, 0x0, 0x1b, 0x60, 0x5b, 0xdc, 0xb4, 0x2, 0x1d, 0x57, 0x35, 0x95, 0xf1, 0x7c, 0x78, 0xf9, 0x4d, 0x3, 0xa3, 0xfc, 0xc4, 0x73, 0x24, 0x50, 0x88, 0x55, 0xa2, 0xee, 0xe7, 0x9d, 0x11, 0x0, 0x0, 0x8, 0xf1, 0xb, 0xa, 0x28, 0x3, 0x19, 0xb1, 0x0, 0xf, 0x3f, 0x77, 0x9b, 0x65, 0xdc, 0x2b, 0xd5, 0x3a, 0x23, 0x2e, 0xc4, 0x46, 0x3c, 0x4d, 0xf7, 0x0, 0x1e, 0xa3, 0xe2, 0x3a, 0xf4, 0x16, 0x84, 0x95, 0x44, 0x5f, 0xef, 0x61, 0xf2, 0x78, 0xa7, 0x78, 0xd3, 0x2d, 0xd7, 0xdb, 0x90, 0x94, 0x67, 0xeb, 0x69, 0xef, 0xf6, 0x8f, 0xcc, 0x74, 0x4b};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x94, 0x34, 0x4f, 0xa3, 0x3e, 0x31, 0xf3, 0xc6, 0xb2, 0x36, 0x85, 0x9, 0xe7, 0xa0, 0x63, 0x1c, 0xf9, 0xbf, 0xf1, 0x92, 0x13, 0x48, 0xaf, 0x5b, 0x78, 0xe5};
  uint8_t bytesprops1[] = {0x3f, 0x37, 0xb0, 0xad, 0x31, 0x50, 0x93, 0x47, 0xd3, 0xd1, 0xb5, 0xb1, 0x4, 0xa4, 0x41, 0xf7, 0x26, 0xae, 0xf3, 0xcf, 0x9, 0xff, 0x28};
  uint8_t bytesprops2[] = {0xf, 0x4c, 0xc0, 0xf8};
  uint8_t bytesprops3[] = {0xd9, 0xf7, 0x6a, 0xf7, 0x66, 0xfd, 0x6b, 0xbc, 0x65, 0xe8, 0xea, 0xa, 0x42, 0xf7, 0xfd, 0xd5, 0x8e, 0x7b, 0x33, 0x60};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 16489}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 17656}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 184}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29411}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2953}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 97}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {4, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops3}}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x15, 0xf0, 0xe8, 0x44, 0x5e, 0xf8, 0x89, 0x94, 0x6e, 0x89, 0x96, 0xfb, 0xa1, 0x85, 0x5c, 0xe5, 0x99, 0x3, 0x88, 0x33, 0xe, 0xaa, 0x45, 0x14};
  uint8_t byteswillprops1[] = {0x1f, 0xe1, 0xa2, 0x4e, 0x53, 0xd4, 0x37, 0x8d, 0xe, 0x7b, 0x39, 0x29, 0xe4, 0x9a, 0xe6, 0xb1, 0xe9, 0x55, 0x69, 0x11, 0xf2, 0x58, 0x95, 0x5b, 0x6e, 0xc2, 0x25, 0x6f, 0x2d, 0xd1};
  uint8_t byteswillprops2[] = {0xb6, 0xeb, 0xb3, 0x86, 0x65, 0x67, 0xa5, 0x51, 0xf, 0x29, 0xdd, 0x7c, 0x1e, 0x7, 0x23, 0x34, 0xb0, 0xcf, 0x6d, 0x70, 0xc4, 0x7d, 0x8b, 0x46, 0xd0, 0x53, 0x3f, 0x61, 0xc1};
  uint8_t byteswillprops4[] = {0x3c, 0x65, 0x39, 0x76, 0x5f, 0xbc, 0xf0};
  uint8_t byteswillprops3[] = {0x83, 0x54, 0x9c, 0x19, 0x25, 0x73, 0x67, 0x5d, 0x12, 0x8d, 0xbd, 0x20, 0xfb, 0xa2, 0xfb, 0x68};
  uint8_t byteswillprops5[] = {0x60, 0x5b, 0xdc, 0xb4, 0x2, 0x1d, 0x57, 0x35, 0x95, 0xf1, 0x7c, 0x78, 0xf9, 0x4d, 0x3, 0xa3, 0xfc, 0xc4, 0x73, 0x24, 0x50, 0x88, 0x55, 0xa2, 0xee, 0xe7, 0x9d};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 22700}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 155}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {30, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 180}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={16, (char*)&byteswillprops3}, .v={7, (char*)&byteswillprops4}}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4004}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 14}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 24648}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 251}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 9}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 221}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {27, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 2289}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 10}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 3}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 177}},
  };

  lwmqtt_properties_t willprops = {19, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x3f, 0x77, 0x9b, 0x65, 0xdc, 0x2b, 0xd5, 0x3a, 0x23, 0x2e, 0xc4, 0x46, 0x3c, 0x4d, 0xf7};
  lwmqtt_string_t will_topic = {15, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xa3, 0xe2, 0x3a, 0xf4, 0x16, 0x84, 0x95, 0x44, 0x5f, 0xef, 0x61, 0xf2, 0x78, 0xa7, 0x78, 0xd3, 0x2d, 0xd7, 0xdb, 0x90, 0x94, 0x67, 0xeb, 0x69, 0xef, 0xf6, 0x8f, 0xcc, 0x74, 0x4b};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 25316;
  uint8_t client_id_bytes[] = {0x8};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\231\215\CAN\203\225\ETX1\228\EM$\170", _willMsg = "v\245\158;\210\154\234\241O\186u[,<\NAK'r>", _willProps = [PropResponseTopic "\225\DC1\207l\SUB\197\&123\178\143\ESC\NUL|\246c\176s\171\220PO\188\245\NUL\181",PropRequestResponseInformation 85,PropAuthenticationData "\136\132@d]\167l\146\STX>\173\165\167\128\132\CANzm\138\r\159\&0'C",PropReceiveMaximum 9284,PropContentType "iQ,\140\SI\NAK\235\188\v\134Q\218\213\143\RS",PropSharedSubscriptionAvailable 12]}), _cleanSession = True, _keepAlive = 30216, _connID = "\ETBtE\131\"\233<\193T\DLE", _properties = [PropWildcardSubscriptionAvailable 162,PropSubscriptionIdentifierAvailable 89,PropSessionExpiryInterval 5666,PropWillDelayInterval 1242,PropSubscriptionIdentifierAvailable 81,PropSubscriptionIdentifier 8,PropMaximumQoS 148,PropResponseInformation "p\SOH\140\134$X\131!`X`\ETB\141\229\196k\148\NAK",PropRequestResponseInformation 46,PropSubscriptionIdentifierAvailable 132,PropAssignedClientIdentifier "\206\&7\199\224\173\140C_]\157\246\159",PropMessageExpiryInterval 24801,PropAuthenticationData "\158\230\a\254\249",PropCorrelationData "\174\158\250\154\197\159nC\129\164",PropReasonString "jzM`*j\192\&31\137\t\DLEl\161\US\148-U\EOT\213C\212\146\212\201g\243",PropMaximumPacketSize 31605,PropAuthenticationMethod "\182\140\&4o\131\FSp\209\145\200\187\175\136k\EM=\186I'L",PropWillDelayInterval 21259,PropMaximumQoS 69,PropMaximumPacketSize 27562,PropPayloadFormatIndicator 66,PropResponseTopic "\198]\248\STX\135\248",PropWillDelayInterval 26956]}
TEST(Connect5QCTest, Encode6) {
uint8_t pkt[] = {0x10, 0xb7, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x16, 0x76, 0x8, 0xac, 0x1, 0x28, 0xa2, 0x29, 0x59, 0x11, 0x0, 0x0, 0x16, 0x22, 0x18, 0x0, 0x0, 0x4, 0xda, 0x29, 0x51, 0xb, 0x8, 0x24, 0x94, 0x1a, 0x0, 0x12, 0x70, 0x1, 0x8c, 0x86, 0x24, 0x58, 0x83, 0x21, 0x60, 0x58, 0x60, 0x17, 0x8d, 0xe5, 0xc4, 0x6b, 0x94, 0x15, 0x19, 0x2e, 0x29, 0x84, 0x12, 0x0, 0xc, 0xce, 0x37, 0xc7, 0xe0, 0xad, 0x8c, 0x43, 0x5f, 0x5d, 0x9d, 0xf6, 0x9f, 0x2, 0x0, 0x0, 0x60, 0xe1, 0x16, 0x0, 0x5, 0x9e, 0xe6, 0x7, 0xfe, 0xf9, 0x9, 0x0, 0xa, 0xae, 0x9e, 0xfa, 0x9a, 0xc5, 0x9f, 0x6e, 0x43, 0x81, 0xa4, 0x1f, 0x0, 0x1b, 0x6a, 0x7a, 0x4d, 0x60, 0x2a, 0x6a, 0xc0, 0x33, 0x31, 0x89, 0x9, 0x10, 0x6c, 0xa1, 0x1f, 0x94, 0x2d, 0x55, 0x4, 0xd5, 0x43, 0xd4, 0x92, 0xd4, 0xc9, 0x67, 0xf3, 0x27, 0x0, 0x0, 0x7b, 0x75, 0x15, 0x0, 0x14, 0xb6, 0x8c, 0x34, 0x6f, 0x83, 0x1c, 0x70, 0xd1, 0x91, 0xc8, 0xbb, 0xaf, 0x88, 0x6b, 0x19, 0x3d, 0xba, 0x49, 0x27, 0x4c, 0x18, 0x0, 0x0, 0x53, 0xb, 0x24, 0x45, 0x27, 0x0, 0x0, 0x6b, 0xaa, 0x1, 0x42, 0x8, 0x0, 0x6, 0xc6, 0x5d, 0xf8, 0x2, 0x87, 0xf8, 0x18, 0x0, 0x0, 0x69, 0x4c, 0x0, 0xa, 0x17, 0x74, 0x45, 0x83, 0x22, 0xe9, 0x3c, 0xc1, 0x54, 0x10, 0x51, 0x8, 0x0, 0x1a, 0xe1, 0x11, 0xcf, 0x6c, 0x1a, 0xc5, 0x31, 0x32, 0x33, 0xb2, 0x8f, 0x1b, 0x0, 0x7c, 0xf6, 0x63, 0xb0, 0x73, 0xab, 0xdc, 0x50, 0x4f, 0xbc, 0xf5, 0x0, 0xb5, 0x19, 0x55, 0x16, 0x0, 0x18, 0x88, 0x84, 0x40, 0x64, 0x5d, 0xa7, 0x6c, 0x92, 0x2, 0x3e, 0xad, 0xa5, 0xa7, 0x80, 0x84, 0x18, 0x7a, 0x6d, 0x8a, 0xd, 0x9f, 0x30, 0x27, 0x43, 0x21, 0x24, 0x44, 0x3, 0x0, 0xf, 0x69, 0x51, 0x2c, 0x8c, 0xf, 0x15, 0xeb, 0xbc, 0xb, 0x86, 0x51, 0xda, 0xd5, 0x8f, 0x1e, 0x2a, 0xc, 0x0, 0xb, 0xe7, 0xd7, 0x18, 0xcb, 0xe1, 0x3, 0x31, 0xe4, 0x19, 0x24, 0xaa, 0x0, 0x12, 0x76, 0xf5, 0x9e, 0x3b, 0xd2, 0x9a, 0xea, 0xf1, 0x4f, 0xba, 0x75, 0x5b, 0x2c, 0x3c, 0x15, 0x27, 0x72, 0x3e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x70, 0x1, 0x8c, 0x86, 0x24, 0x58, 0x83, 0x21, 0x60, 0x58, 0x60, 0x17, 0x8d, 0xe5, 0xc4, 0x6b, 0x94, 0x15};
  uint8_t bytesprops1[] = {0xce, 0x37, 0xc7, 0xe0, 0xad, 0x8c, 0x43, 0x5f, 0x5d, 0x9d, 0xf6, 0x9f};
  uint8_t bytesprops2[] = {0x9e, 0xe6, 0x7, 0xfe, 0xf9};
  uint8_t bytesprops3[] = {0xae, 0x9e, 0xfa, 0x9a, 0xc5, 0x9f, 0x6e, 0x43, 0x81, 0xa4};
  uint8_t bytesprops4[] = {0x6a, 0x7a, 0x4d, 0x60, 0x2a, 0x6a, 0xc0, 0x33, 0x31, 0x89, 0x9, 0x10, 0x6c, 0xa1, 0x1f, 0x94, 0x2d, 0x55, 0x4, 0xd5, 0x43, 0xd4, 0x92, 0xd4, 0xc9, 0x67, 0xf3};
  uint8_t bytesprops5[] = {0xb6, 0x8c, 0x34, 0x6f, 0x83, 0x1c, 0x70, 0xd1, 0x91, 0xc8, 0xbb, 0xaf, 0x88, 0x6b, 0x19, 0x3d, 0xba, 0x49, 0x27, 0x4c};
  uint8_t bytesprops6[] = {0xc6, 0x5d, 0xf8, 0x2, 0x87, 0xf8};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 162}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 89}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5666}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 1242}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 8}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 148}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 46}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 132}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24801}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {5, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {27, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31605}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21259}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 69}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27562}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 66}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26956}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe1, 0x11, 0xcf, 0x6c, 0x1a, 0xc5, 0x31, 0x32, 0x33, 0xb2, 0x8f, 0x1b, 0x0, 0x7c, 0xf6, 0x63, 0xb0, 0x73, 0xab, 0xdc, 0x50, 0x4f, 0xbc, 0xf5, 0x0, 0xb5};
  uint8_t byteswillprops1[] = {0x88, 0x84, 0x40, 0x64, 0x5d, 0xa7, 0x6c, 0x92, 0x2, 0x3e, 0xad, 0xa5, 0xa7, 0x80, 0x84, 0x18, 0x7a, 0x6d, 0x8a, 0xd, 0x9f, 0x30, 0x27, 0x43};
  uint8_t byteswillprops2[] = {0x69, 0x51, 0x2c, 0x8c, 0xf, 0x15, 0xeb, 0xbc, 0xb, 0x86, 0x51, 0xda, 0xd5, 0x8f, 0x1e};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {26, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {24, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 9284}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 12}},
  };

  lwmqtt_properties_t willprops = {6, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe7, 0xd7, 0x18, 0xcb, 0xe1, 0x3, 0x31, 0xe4, 0x19, 0x24, 0xaa};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x76, 0xf5, 0x9e, 0x3b, 0xd2, 0x9a, 0xea, 0xf1, 0x4f, 0xba, 0x75, 0x5b, 0x2c, 0x3c, 0x15, 0x27, 0x72, 0x3e};
  lwmqtt_string_t will_payload = {18, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 30216;
  uint8_t client_id_bytes[] = {0x17, 0x74, 0x45, 0x83, 0x22, 0xe9, 0x3c, 0xc1, 0x54, 0x10};
  lwmqtt_string_t client_id = {10, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\184\RS2\175$\t.Y\176C6\139.\188\209\208\199", _password = Nothing, _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "k_hun\216\209\212\219%\193\NAK[\175\250\232\STX\214\196)\SOH\135\SO\t", _willMsg = "\216\193J\242J\215\b\166\FS\181,u\246W&\128\245\STXbo\142d\186\234!\250\EM\219\136", _willProps = [PropReasonString "",PropMessageExpiryInterval 4624,PropResponseTopic "\213\DEL}kO\DEL\146",PropReasonString "\CAN-\226@y\"\CAN:\248\183[D\142\204\156\146UqcW\187\194y\166_",PropSubscriptionIdentifier 20,PropServerKeepAlive 2189,PropUserProperty "\215o\"\224" "r\232\167=4\234\&4KwD\234\165\rf\249\226d\ETX}\178\STX\250\220V\213\SYN",PropTopicAliasMaximum 16445,PropMessageExpiryInterval 10243,PropResponseTopic "g\163\135\157\132\136c\231",PropCorrelationData "",PropMaximumPacketSize 21568,PropMessageExpiryInterval 3075,PropRequestProblemInformation 212,PropContentType "\171\151S\147\US\171\134\150\200\CAN?J\142f\175\n\162O",PropSubscriptionIdentifier 12,PropWillDelayInterval 14729,PropSessionExpiryInterval 21067,PropSharedSubscriptionAvailable 108,PropAuthenticationMethod "\186%]\DC1\NUL\210c\248\SIgFOe\DC3\DC4\134a\DLE",PropResponseInformation "\130&\193\188k\150y\141\198~\196+",PropContentType "",PropServerReference "de\214OR\139\249",PropServerKeepAlive 2475,PropResponseInformation "jO",PropWillDelayInterval 6987,PropSubscriptionIdentifier 14,PropRequestProblemInformation 79,PropServerKeepAlive 7409]}), _cleanSession = True, _keepAlive = 12402, _connID = "\157\DC4\228=k\DLE5N\171\v+\185\227", _properties = [PropRetainAvailable 103,PropRetainAvailable 113,PropAssignedClientIdentifier "\154(\NAK\187\209\146y\252F\ACKo\143\157\229\217{\174\144\141{\224",PropAssignedClientIdentifier "\185/\163\236\252",PropPayloadFormatIndicator 77,PropPayloadFormatIndicator 49,PropReceiveMaximum 25543,PropMessageExpiryInterval 22717,PropWildcardSubscriptionAvailable 20,PropSubscriptionIdentifierAvailable 7,PropAuthenticationData "\129\245\EOT\240\STX\SO\138\133",PropRequestProblemInformation 10,PropResponseTopic "\178p\185P\147\147:L\r\153\152[\224\201~\187\ENQ",PropResponseInformation "\130\144\DC4\CAN\US\247\&0#$5\217\133\204\&7\155\141a9\DLE\vt4",PropServerKeepAlive 6182,PropTopicAliasMaximum 26231,PropSessionExpiryInterval 10906,PropSharedSubscriptionAvailable 79,PropSubscriptionIdentifierAvailable 173,PropSubscriptionIdentifier 32]}
TEST(Connect5QCTest, Encode7) {
uint8_t pkt[] = {0x10, 0xc7, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x8e, 0x30, 0x72, 0x7f, 0x25, 0x67, 0x25, 0x71, 0x12, 0x0, 0x15, 0x9a, 0x28, 0x15, 0xbb, 0xd1, 0x92, 0x79, 0xfc, 0x46, 0x6, 0x6f, 0x8f, 0x9d, 0xe5, 0xd9, 0x7b, 0xae, 0x90, 0x8d, 0x7b, 0xe0, 0x12, 0x0, 0x5, 0xb9, 0x2f, 0xa3, 0xec, 0xfc, 0x1, 0x4d, 0x1, 0x31, 0x21, 0x63, 0xc7, 0x2, 0x0, 0x0, 0x58, 0xbd, 0x28, 0x14, 0x29, 0x7, 0x16, 0x0, 0x8, 0x81, 0xf5, 0x4, 0xf0, 0x2, 0xe, 0x8a, 0x85, 0x17, 0xa, 0x8, 0x0, 0x11, 0xb2, 0x70, 0xb9, 0x50, 0x93, 0x93, 0x3a, 0x4c, 0xd, 0x99, 0x98, 0x5b, 0xe0, 0xc9, 0x7e, 0xbb, 0x5, 0x1a, 0x0, 0x16, 0x82, 0x90, 0x14, 0x18, 0x1f, 0xf7, 0x30, 0x23, 0x24, 0x35, 0xd9, 0x85, 0xcc, 0x37, 0x9b, 0x8d, 0x61, 0x39, 0x10, 0xb, 0x74, 0x34, 0x13, 0x18, 0x26, 0x22, 0x66, 0x77, 0x11, 0x0, 0x0, 0x2a, 0x9a, 0x2a, 0x4f, 0x29, 0xad, 0xb, 0x20, 0x0, 0xd, 0x9d, 0x14, 0xe4, 0x3d, 0x6b, 0x10, 0x35, 0x4e, 0xab, 0xb, 0x2b, 0xb9, 0xe3, 0xe0, 0x1, 0x1f, 0x0, 0x0, 0x2, 0x0, 0x0, 0x12, 0x10, 0x8, 0x0, 0x7, 0xd5, 0x7f, 0x7d, 0x6b, 0x4f, 0x7f, 0x92, 0x1f, 0x0, 0x19, 0x18, 0x2d, 0xe2, 0x40, 0x79, 0x22, 0x18, 0x3a, 0xf8, 0xb7, 0x5b, 0x44, 0x8e, 0xcc, 0x9c, 0x92, 0x55, 0x71, 0x63, 0x57, 0xbb, 0xc2, 0x79, 0xa6, 0x5f, 0xb, 0x14, 0x13, 0x8, 0x8d, 0x26, 0x0, 0x4, 0xd7, 0x6f, 0x22, 0xe0, 0x0, 0x1a, 0x72, 0xe8, 0xa7, 0x3d, 0x34, 0xea, 0x34, 0x4b, 0x77, 0x44, 0xea, 0xa5, 0xd, 0x66, 0xf9, 0xe2, 0x64, 0x3, 0x7d, 0xb2, 0x2, 0xfa, 0xdc, 0x56, 0xd5, 0x16, 0x22, 0x40, 0x3d, 0x2, 0x0, 0x0, 0x28, 0x3, 0x8, 0x0, 0x8, 0x67, 0xa3, 0x87, 0x9d, 0x84, 0x88, 0x63, 0xe7, 0x9, 0x0, 0x0, 0x27, 0x0, 0x0, 0x54, 0x40, 0x2, 0x0, 0x0, 0xc, 0x3, 0x17, 0xd4, 0x3, 0x0, 0x12, 0xab, 0x97, 0x53, 0x93, 0x1f, 0xab, 0x86, 0x96, 0xc8, 0x18, 0x3f, 0x4a, 0x8e, 0x66, 0xaf, 0xa, 0xa2, 0x4f, 0xb, 0xc, 0x18, 0x0, 0x0, 0x39, 0x89, 0x11, 0x0, 0x0, 0x52, 0x4b, 0x2a, 0x6c, 0x15, 0x0, 0x12, 0xba, 0x25, 0x5d, 0x11, 0x0, 0xd2, 0x63, 0xf8, 0xf, 0x67, 0x46, 0x4f, 0x65, 0x13, 0x14, 0x86, 0x61, 0x10, 0x1a, 0x0, 0xc, 0x82, 0x26, 0xc1, 0xbc, 0x6b, 0x96, 0x79, 0x8d, 0xc6, 0x7e, 0xc4, 0x2b, 0x3, 0x0, 0x0, 0x1c, 0x0, 0x7, 0x64, 0x65, 0xd6, 0x4f, 0x52, 0x8b, 0xf9, 0x13, 0x9, 0xab, 0x1a, 0x0, 0x2, 0x6a, 0x4f, 0x18, 0x0, 0x0, 0x1b, 0x4b, 0xb, 0xe, 0x17, 0x4f, 0x13, 0x1c, 0xf1, 0x0, 0x18, 0x6b, 0x5f, 0x68, 0x75, 0x6e, 0xd8, 0xd1, 0xd4, 0xdb, 0x25, 0xc1, 0x15, 0x5b, 0xaf, 0xfa, 0xe8, 0x2, 0xd6, 0xc4, 0x29, 0x1, 0x87, 0xe, 0x9, 0x0, 0x1d, 0xd8, 0xc1, 0x4a, 0xf2, 0x4a, 0xd7, 0x8, 0xa6, 0x1c, 0xb5, 0x2c, 0x75, 0xf6, 0x57, 0x26, 0x80, 0xf5, 0x2, 0x62, 0x6f, 0x8e, 0x64, 0xba, 0xea, 0x21, 0xfa, 0x19, 0xdb, 0x88, 0x0, 0x11, 0xb8, 0x1e, 0x32, 0xaf, 0x24, 0x9, 0x2e, 0x59, 0xb0, 0x43, 0x36, 0x8b, 0x2e, 0xbc, 0xd1, 0xd0, 0xc7};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x9a, 0x28, 0x15, 0xbb, 0xd1, 0x92, 0x79, 0xfc, 0x46, 0x6, 0x6f, 0x8f, 0x9d, 0xe5, 0xd9, 0x7b, 0xae, 0x90, 0x8d, 0x7b, 0xe0};
  uint8_t bytesprops1[] = {0xb9, 0x2f, 0xa3, 0xec, 0xfc};
  uint8_t bytesprops2[] = {0x81, 0xf5, 0x4, 0xf0, 0x2, 0xe, 0x8a, 0x85};
  uint8_t bytesprops3[] = {0xb2, 0x70, 0xb9, 0x50, 0x93, 0x93, 0x3a, 0x4c, 0xd, 0x99, 0x98, 0x5b, 0xe0, 0xc9, 0x7e, 0xbb, 0x5};
  uint8_t bytesprops4[] = {0x82, 0x90, 0x14, 0x18, 0x1f, 0xf7, 0x30, 0x23, 0x24, 0x35, 0xd9, 0x85, 0xcc, 0x37, 0x9b, 0x8d, 0x61, 0x39, 0x10, 0xb, 0x74, 0x34};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 103}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 113}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {5, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 77}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 49}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 25543}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22717}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 20}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 7}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {8, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 10}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 6182}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 26231}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 10906}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 79}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 173}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 32}},
  };

  lwmqtt_properties_t props = {20, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0};
  uint8_t byteswillprops1[] = {0xd5, 0x7f, 0x7d, 0x6b, 0x4f, 0x7f, 0x92};
  uint8_t byteswillprops2[] = {0x18, 0x2d, 0xe2, 0x40, 0x79, 0x22, 0x18, 0x3a, 0xf8, 0xb7, 0x5b, 0x44, 0x8e, 0xcc, 0x9c, 0x92, 0x55, 0x71, 0x63, 0x57, 0xbb, 0xc2, 0x79, 0xa6, 0x5f};
  uint8_t byteswillprops4[] = {0x72, 0xe8, 0xa7, 0x3d, 0x34, 0xea, 0x34, 0x4b, 0x77, 0x44, 0xea, 0xa5, 0xd, 0x66, 0xf9, 0xe2, 0x64, 0x3, 0x7d, 0xb2, 0x2, 0xfa, 0xdc, 0x56, 0xd5, 0x16};
  uint8_t byteswillprops3[] = {0xd7, 0x6f, 0x22, 0xe0};
  uint8_t byteswillprops5[] = {0x67, 0xa3, 0x87, 0x9d, 0x84, 0x88, 0x63, 0xe7};
  uint8_t byteswillprops6[] = {0};
  uint8_t byteswillprops7[] = {0xab, 0x97, 0x53, 0x93, 0x1f, 0xab, 0x86, 0x96, 0xc8, 0x18, 0x3f, 0x4a, 0x8e, 0x66, 0xaf, 0xa, 0xa2, 0x4f};
  uint8_t byteswillprops8[] = {0xba, 0x25, 0x5d, 0x11, 0x0, 0xd2, 0x63, 0xf8, 0xf, 0x67, 0x46, 0x4f, 0x65, 0x13, 0x14, 0x86, 0x61, 0x10};
  uint8_t byteswillprops9[] = {0x82, 0x26, 0xc1, 0xbc, 0x6b, 0x96, 0x79, 0x8d, 0xc6, 0x7e, 0xc4, 0x2b};
  uint8_t byteswillprops10[] = {0};
  uint8_t byteswillprops11[] = {0x64, 0x65, 0xd6, 0x4f, 0x52, 0x8b, 0xf9};
  uint8_t byteswillprops12[] = {0x6a, 0x4f};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {0, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4624}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {25, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 20}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2189}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={4, (char*)&byteswillprops3}, .v={26, (char*)&byteswillprops4}}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 16445}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10243}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 21568}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3075}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 212}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&byteswillprops7}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 12}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 14729}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21067}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 108}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {18, (char*)&byteswillprops8}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {12, (char*)&byteswillprops9}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {0, (char*)&byteswillprops10}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {7, (char*)&byteswillprops11}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2475}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&byteswillprops12}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 6987}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 14}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 79}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7409}},
  };

  lwmqtt_properties_t willprops = {29, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x6b, 0x5f, 0x68, 0x75, 0x6e, 0xd8, 0xd1, 0xd4, 0xdb, 0x25, 0xc1, 0x15, 0x5b, 0xaf, 0xfa, 0xe8, 0x2, 0xd6, 0xc4, 0x29, 0x1, 0x87, 0xe, 0x9};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd8, 0xc1, 0x4a, 0xf2, 0x4a, 0xd7, 0x8, 0xa6, 0x1c, 0xb5, 0x2c, 0x75, 0xf6, 0x57, 0x26, 0x80, 0xf5, 0x2, 0x62, 0x6f, 0x8e, 0x64, 0xba, 0xea, 0x21, 0xfa, 0x19, 0xdb, 0x88};
  lwmqtt_string_t will_payload = {29, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 12402;
  uint8_t client_id_bytes[] = {0x9d, 0x14, 0xe4, 0x3d, 0x6b, 0x10, 0x35, 0x4e, 0xab, 0xb, 0x2b, 0xb9, 0xe3};
  lwmqtt_string_t client_id = {13, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xb8, 0x1e, 0x32, 0xaf, 0x24, 0x9, 0x2e, 0x59, 0xb0, 0x43, 0x36, 0x8b, 0x2e, 0xbc, 0xd1, 0xd0, 0xc7};
  lwmqtt_string_t username = {17, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "W\DC2v\185\154.x\154\183R\236\DC4\SI\179\251\231", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\230,\132\194wK\251\ENQ\NUL\154\229\223\206\215", _willMsg = "\149\250\&2EL\189\206", _willProps = [PropRequestProblemInformation 105,PropCorrelationData "F\246\131!\f\227\t^\158\DLE\242\248P\166\NAK\255\211!\146f\214\EOT",PropSubscriptionIdentifier 20,PropPayloadFormatIndicator 148,PropTopicAlias 25005,PropMaximumPacketSize 5254,PropTopicAliasMaximum 28863,PropReceiveMaximum 30544,PropResponseTopic "\142\168\205-\r\RS\"\147\202\191\"\NAK\155,\199b/^E\246",PropMaximumPacketSize 26937,PropWildcardSubscriptionAvailable 96,PropSubscriptionIdentifier 28,PropRetainAvailable 124,PropWildcardSubscriptionAvailable 54,PropReceiveMaximum 10276]}), _cleanSession = True, _keepAlive = 4527, _connID = "\140Kc\DC2\DC2\249`", _properties = [PropRetainAvailable 190,PropAuthenticationData "k\216\130 ^j\226\EM,lM\135\195l\194\176\242\158\221\200\136",PropWillDelayInterval 25782,PropRetainAvailable 150,PropTopicAliasMaximum 4604,PropSubscriptionIdentifierAvailable 176,PropPayloadFormatIndicator 130,PropReceiveMaximum 9491,PropRequestProblemInformation 146,PropMessageExpiryInterval 23140,PropServerReference "\f\186",PropWildcardSubscriptionAvailable 114]}
TEST(Connect5QCTest, Encode8) {
uint8_t pkt[] = {0x10, 0xcd, 0x1, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x4e, 0x11, 0xaf, 0x39, 0x25, 0xbe, 0x16, 0x0, 0x15, 0x6b, 0xd8, 0x82, 0x20, 0x5e, 0x6a, 0xe2, 0x19, 0x2c, 0x6c, 0x4d, 0x87, 0xc3, 0x6c, 0xc2, 0xb0, 0xf2, 0x9e, 0xdd, 0xc8, 0x88, 0x18, 0x0, 0x0, 0x64, 0xb6, 0x25, 0x96, 0x22, 0x11, 0xfc, 0x29, 0xb0, 0x1, 0x82, 0x21, 0x25, 0x13, 0x17, 0x92, 0x2, 0x0, 0x0, 0x5a, 0x64, 0x1c, 0x0, 0x2, 0xc, 0xba, 0x28, 0x72, 0x0, 0x7, 0x8c, 0x4b, 0x63, 0x12, 0x12, 0xf9, 0x60, 0x54, 0x17, 0x69, 0x9, 0x0, 0x16, 0x46, 0xf6, 0x83, 0x21, 0xc, 0xe3, 0x9, 0x5e, 0x9e, 0x10, 0xf2, 0xf8, 0x50, 0xa6, 0x15, 0xff, 0xd3, 0x21, 0x92, 0x66, 0xd6, 0x4, 0xb, 0x14, 0x1, 0x94, 0x23, 0x61, 0xad, 0x27, 0x0, 0x0, 0x14, 0x86, 0x22, 0x70, 0xbf, 0x21, 0x77, 0x50, 0x8, 0x0, 0x14, 0x8e, 0xa8, 0xcd, 0x2d, 0xd, 0x1e, 0x22, 0x93, 0xca, 0xbf, 0x22, 0x15, 0x9b, 0x2c, 0xc7, 0x62, 0x2f, 0x5e, 0x45, 0xf6, 0x27, 0x0, 0x0, 0x69, 0x39, 0x28, 0x60, 0xb, 0x1c, 0x25, 0x7c, 0x28, 0x36, 0x21, 0x28, 0x24, 0x0, 0xe, 0xe6, 0x2c, 0x84, 0xc2, 0x77, 0x4b, 0xfb, 0x5, 0x0, 0x9a, 0xe5, 0xdf, 0xce, 0xd7, 0x0, 0x7, 0x95, 0xfa, 0x32, 0x45, 0x4c, 0xbd, 0xce, 0x0, 0x10, 0x57, 0x12, 0x76, 0xb9, 0x9a, 0x2e, 0x78, 0x9a, 0xb7, 0x52, 0xec, 0x14, 0xf, 0xb3, 0xfb, 0xe7};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x6b, 0xd8, 0x82, 0x20, 0x5e, 0x6a, 0xe2, 0x19, 0x2c, 0x6c, 0x4d, 0x87, 0xc3, 0x6c, 0xc2, 0xb0, 0xf2, 0x9e, 0xdd, 0xc8, 0x88};
  uint8_t bytesprops1[] = {0xc, 0xba};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 190}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {21, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 25782}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 150}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4604}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 176}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 130}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 9491}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 146}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23140}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {2, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 114}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x46, 0xf6, 0x83, 0x21, 0xc, 0xe3, 0x9, 0x5e, 0x9e, 0x10, 0xf2, 0xf8, 0x50, 0xa6, 0x15, 0xff, 0xd3, 0x21, 0x92, 0x66, 0xd6, 0x4};
  uint8_t byteswillprops1[] = {0x8e, 0xa8, 0xcd, 0x2d, 0xd, 0x1e, 0x22, 0x93, 0xca, 0xbf, 0x22, 0x15, 0x9b, 0x2c, 0xc7, 0x62, 0x2f, 0x5e, 0x45, 0xf6};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 105}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {22, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 20}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 148}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25005}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 5254}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28863}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30544}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 26937}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 96}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 28}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 124}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 10276}},
  };

  lwmqtt_properties_t willprops = {15, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe6, 0x2c, 0x84, 0xc2, 0x77, 0x4b, 0xfb, 0x5, 0x0, 0x9a, 0xe5, 0xdf, 0xce, 0xd7};
  lwmqtt_string_t will_topic = {14, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x95, 0xfa, 0x32, 0x45, 0x4c, 0xbd, 0xce};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 4527;
  uint8_t client_id_bytes[] = {0x8c, 0x4b, 0x63, 0x12, 0x12, 0xf9, 0x60};
  lwmqtt_string_t client_id = {7, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x57, 0x12, 0x76, 0xb9, 0x9a, 0x2e, 0x78, 0x9a, 0xb7, 0x52, 0xec, 0x14, 0xf, 0xb3, 0xfb, 0xe7};
  lwmqtt_string_t password = {16, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "A\ESC'\139\188\167\DEL0\247\183\225\230dn1\207\&4a+\229#\149s\233\178Lz\188B", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "1\210\DC3\DC47O", _willMsg = "M\176\215\\\188\144\&2\213\199\175\GS", _willProps = [PropMessageExpiryInterval 361,PropSubscriptionIdentifier 6,PropSubscriptionIdentifier 2,PropMessageExpiryInterval 19895,PropAuthenticationData "\SI_\168\181n\245\154%L",PropTopicAliasMaximum 1020]}), _cleanSession = False, _keepAlive = 26060, _connID = "'M\238\158*c\NUL\197&]T\231\237\226\255e=\SUB]&\188\246", _properties = [PropWillDelayInterval 11494,PropAssignedClientIdentifier ",/\244\&5\ENQ\132\247\241\134\177w\SUBT\255p\SI!\t\212]\131U",PropMessageExpiryInterval 30996,PropAuthenticationData "m':\SI:\142$",PropRequestResponseInformation 238,PropSubscriptionIdentifier 30,PropRequestResponseInformation 236,PropTopicAliasMaximum 14621,PropSharedSubscriptionAvailable 236,PropMessageExpiryInterval 1407,PropMessageExpiryInterval 30953,PropSessionExpiryInterval 968,PropMaximumQoS 254,PropContentType "\237\159X!\201\EOT\r\130Ml#\a*e\249\148\227m\248\ENQ\250\188\242:d\235\181\243j",PropTopicAlias 28456,PropAuthenticationData "<",PropRequestResponseInformation 12,PropSessionExpiryInterval 13244,PropRequestResponseInformation 44,PropTopicAliasMaximum 10093,PropAuthenticationMethod "|\235\"\144\&5\180\201\&6ra\159r\199A(Gol.\GS",PropSessionExpiryInterval 31640,PropMaximumQoS 21,PropMaximumPacketSize 27543]}
TEST(Connect5QCTest, Encode9) {
uint8_t pkt[] = {0x10, 0x95, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x74, 0x65, 0xcc, 0x9f, 0x1, 0x18, 0x0, 0x0, 0x2c, 0xe6, 0x12, 0x0, 0x16, 0x2c, 0x2f, 0xf4, 0x35, 0x5, 0x84, 0xf7, 0xf1, 0x86, 0xb1, 0x77, 0x1a, 0x54, 0xff, 0x70, 0xf, 0x21, 0x9, 0xd4, 0x5d, 0x83, 0x55, 0x2, 0x0, 0x0, 0x79, 0x14, 0x16, 0x0, 0x7, 0x6d, 0x27, 0x3a, 0xf, 0x3a, 0x8e, 0x24, 0x19, 0xee, 0xb, 0x1e, 0x19, 0xec, 0x22, 0x39, 0x1d, 0x2a, 0xec, 0x2, 0x0, 0x0, 0x5, 0x7f, 0x2, 0x0, 0x0, 0x78, 0xe9, 0x11, 0x0, 0x0, 0x3, 0xc8, 0x24, 0xfe, 0x3, 0x0, 0x1d, 0xed, 0x9f, 0x58, 0x21, 0xc9, 0x4, 0xd, 0x82, 0x4d, 0x6c, 0x23, 0x7, 0x2a, 0x65, 0xf9, 0x94, 0xe3, 0x6d, 0xf8, 0x5, 0xfa, 0xbc, 0xf2, 0x3a, 0x64, 0xeb, 0xb5, 0xf3, 0x6a, 0x23, 0x6f, 0x28, 0x16, 0x0, 0x1, 0x3c, 0x19, 0xc, 0x11, 0x0, 0x0, 0x33, 0xbc, 0x19, 0x2c, 0x22, 0x27, 0x6d, 0x15, 0x0, 0x14, 0x7c, 0xeb, 0x22, 0x90, 0x35, 0xb4, 0xc9, 0x36, 0x72, 0x61, 0x9f, 0x72, 0xc7, 0x41, 0x28, 0x47, 0x6f, 0x6c, 0x2e, 0x1d, 0x11, 0x0, 0x0, 0x7b, 0x98, 0x24, 0x15, 0x27, 0x0, 0x0, 0x6b, 0x97, 0x0, 0x16, 0x27, 0x4d, 0xee, 0x9e, 0x2a, 0x63, 0x0, 0xc5, 0x26, 0x5d, 0x54, 0xe7, 0xed, 0xe2, 0xff, 0x65, 0x3d, 0x1a, 0x5d, 0x26, 0xbc, 0xf6, 0x1d, 0x2, 0x0, 0x0, 0x1, 0x69, 0xb, 0x6, 0xb, 0x2, 0x2, 0x0, 0x0, 0x4d, 0xb7, 0x16, 0x0, 0x9, 0xf, 0x5f, 0xa8, 0xb5, 0x6e, 0xf5, 0x9a, 0x25, 0x4c, 0x22, 0x3, 0xfc, 0x0, 0x6, 0x31, 0xd2, 0x13, 0x14, 0x37, 0x4f, 0x0, 0xb, 0x4d, 0xb0, 0xd7, 0x5c, 0xbc, 0x90, 0x32, 0xd5, 0xc7, 0xaf, 0x1d, 0x0, 0x1d, 0x41, 0x1b, 0x27, 0x8b, 0xbc, 0xa7, 0x7f, 0x30, 0xf7, 0xb7, 0xe1, 0xe6, 0x64, 0x6e, 0x31, 0xcf, 0x34, 0x61, 0x2b, 0xe5, 0x23, 0x95, 0x73, 0xe9, 0xb2, 0x4c, 0x7a, 0xbc, 0x42};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x2c, 0x2f, 0xf4, 0x35, 0x5, 0x84, 0xf7, 0xf1, 0x86, 0xb1, 0x77, 0x1a, 0x54, 0xff, 0x70, 0xf, 0x21, 0x9, 0xd4, 0x5d, 0x83, 0x55};
  uint8_t bytesprops1[] = {0x6d, 0x27, 0x3a, 0xf, 0x3a, 0x8e, 0x24};
  uint8_t bytesprops2[] = {0xed, 0x9f, 0x58, 0x21, 0xc9, 0x4, 0xd, 0x82, 0x4d, 0x6c, 0x23, 0x7, 0x2a, 0x65, 0xf9, 0x94, 0xe3, 0x6d, 0xf8, 0x5, 0xfa, 0xbc, 0xf2, 0x3a, 0x64, 0xeb, 0xb5, 0xf3, 0x6a};
  uint8_t bytesprops3[] = {0x3c};
  uint8_t bytesprops4[] = {0x7c, 0xeb, 0x22, 0x90, 0x35, 0xb4, 0xc9, 0x36, 0x72, 0x61, 0x9f, 0x72, 0xc7, 0x41, 0x28, 0x47, 0x6f, 0x6c, 0x2e, 0x1d};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 11494}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30996}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 238}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 30}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 236}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 14621}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 236}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 1407}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30953}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 968}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 254}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {29, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 28456}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 12}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 13244}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 44}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 10093}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31640}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 21}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27543}},
  };

  lwmqtt_properties_t props = {24, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xf, 0x5f, 0xa8, 0xb5, 0x6e, 0xf5, 0x9a, 0x25, 0x4c};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 361}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 6}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 2}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19895}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {9, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1020}},
  };

  lwmqtt_properties_t willprops = {6, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x31, 0xd2, 0x13, 0x14, 0x37, 0x4f};
  lwmqtt_string_t will_topic = {6, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x4d, 0xb0, 0xd7, 0x5c, 0xbc, 0x90, 0x32, 0xd5, 0xc7, 0xaf, 0x1d};
  lwmqtt_string_t will_payload = {11, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 26060;
  uint8_t client_id_bytes[] = {0x27, 0x4d, 0xee, 0x9e, 0x2a, 0x63, 0x0, 0xc5, 0x26, 0x5d, 0x54, 0xe7, 0xed, 0xe2, 0xff, 0x65, 0x3d, 0x1a, 0x5d, 0x26, 0xbc, 0xf6};
  lwmqtt_string_t client_id = {22, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x41, 0x1b, 0x27, 0x8b, 0xbc, 0xa7, 0x7f, 0x30, 0xf7, 0xb7, 0xe1, 0xe6, 0x64, 0x6e, 0x31, 0xcf, 0x34, 0x61, 0x2b, 0xe5, 0x23, 0x95, 0x73, 0xe9, 0xb2, 0x4c, 0x7a, 0xbc, 0x42};
  lwmqtt_string_t password = {29, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\203\215'q\192;\253\158\131\"\185\255\168\f\227", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "\DC3]\143\242\EOT8\146", _willMsg = "\230\207C'/^Ln\SOH\ACK\239\208\&6\227\162B~\222\142", _willProps = [PropWillDelayInterval 17500,PropRequestResponseInformation 248,PropRetainAvailable 9,PropWildcardSubscriptionAvailable 55,PropMessageExpiryInterval 31929,PropSubscriptionIdentifierAvailable 9,PropRequestProblemInformation 73,PropResponseInformation "J\176]\182\141\ng\175\165\170\191\DEL\179\177\208>IH\r\201\182z\132\150\142\228",PropRetainAvailable 202,PropReceiveMaximum 14731,PropTopicAlias 17969,PropRetainAvailable 131,PropReasonString "\178",PropTopicAlias 22210,PropAuthenticationData "\216\&88\168tf",PropSubscriptionIdentifierAvailable 158]}), _cleanSession = False, _keepAlive = 18009, _connID = "\223\157;e\ACKs*\NUL\134N\151K\212g\170", _properties = [PropReceiveMaximum 1627,PropReasonString "X\161\197!\DC2?\214FK \195W~\199'b",PropServerReference "\US\135\141Xj\ESC\NUL\169\155\161*\143\156\177)\158> \148\DC4\173N\139\197\189B\198\170T",PropMaximumPacketSize 23850,PropSharedSubscriptionAvailable 158,PropMaximumQoS 85,PropServerKeepAlive 3440,PropResponseTopic "\134]\241\ENQ\243\&1\180l+\137\132\220\FSQ\243tky\EOTD@\216m\134Z<`\255G\149",PropSubscriptionIdentifier 7,PropMessageExpiryInterval 9423,PropSubscriptionIdentifier 16,PropMaximumPacketSize 31638,PropWildcardSubscriptionAvailable 226,PropServerReference "\145\128\137\173h\DC1s\129\251\210\184",PropReceiveMaximum 29008,PropMaximumPacketSize 9586,PropTopicAlias 11288,PropSubscriptionIdentifier 25,PropTopicAliasMaximum 16372,PropAuthenticationMethod "A\187\EOT\132\169]\244\205",PropWildcardSubscriptionAvailable 83]}
TEST(Connect5QCTest, Encode10) {
uint8_t pkt[] = {0x10, 0xb8, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xac, 0x46, 0x59, 0x9e, 0x1, 0x21, 0x6, 0x5b, 0x1f, 0x0, 0x10, 0x58, 0xa1, 0xc5, 0x21, 0x12, 0x3f, 0xd6, 0x46, 0x4b, 0x20, 0xc3, 0x57, 0x7e, 0xc7, 0x27, 0x62, 0x1c, 0x0, 0x1d, 0x1f, 0x87, 0x8d, 0x58, 0x6a, 0x1b, 0x0, 0xa9, 0x9b, 0xa1, 0x2a, 0x8f, 0x9c, 0xb1, 0x29, 0x9e, 0x3e, 0x20, 0x94, 0x14, 0xad, 0x4e, 0x8b, 0xc5, 0xbd, 0x42, 0xc6, 0xaa, 0x54, 0x27, 0x0, 0x0, 0x5d, 0x2a, 0x2a, 0x9e, 0x24, 0x55, 0x13, 0xd, 0x70, 0x8, 0x0, 0x1e, 0x86, 0x5d, 0xf1, 0x5, 0xf3, 0x31, 0xb4, 0x6c, 0x2b, 0x89, 0x84, 0xdc, 0x1c, 0x51, 0xf3, 0x74, 0x6b, 0x79, 0x4, 0x44, 0x40, 0xd8, 0x6d, 0x86, 0x5a, 0x3c, 0x60, 0xff, 0x47, 0x95, 0xb, 0x7, 0x2, 0x0, 0x0, 0x24, 0xcf, 0xb, 0x10, 0x27, 0x0, 0x0, 0x7b, 0x96, 0x28, 0xe2, 0x1c, 0x0, 0xb, 0x91, 0x80, 0x89, 0xad, 0x68, 0x11, 0x73, 0x81, 0xfb, 0xd2, 0xb8, 0x21, 0x71, 0x50, 0x27, 0x0, 0x0, 0x25, 0x72, 0x23, 0x2c, 0x18, 0xb, 0x19, 0x22, 0x3f, 0xf4, 0x15, 0x0, 0x8, 0x41, 0xbb, 0x4, 0x84, 0xa9, 0x5d, 0xf4, 0xcd, 0x28, 0x53, 0x0, 0xf, 0xdf, 0x9d, 0x3b, 0x65, 0x6, 0x73, 0x2a, 0x0, 0x86, 0x4e, 0x97, 0x4b, 0xd4, 0x67, 0xaa, 0x4d, 0x18, 0x0, 0x0, 0x44, 0x5c, 0x19, 0xf8, 0x25, 0x9, 0x28, 0x37, 0x2, 0x0, 0x0, 0x7c, 0xb9, 0x29, 0x9, 0x17, 0x49, 0x1a, 0x0, 0x1a, 0x4a, 0xb0, 0x5d, 0xb6, 0x8d, 0xa, 0x67, 0xaf, 0xa5, 0xaa, 0xbf, 0x7f, 0xb3, 0xb1, 0xd0, 0x3e, 0x49, 0x48, 0xd, 0xc9, 0xb6, 0x7a, 0x84, 0x96, 0x8e, 0xe4, 0x25, 0xca, 0x21, 0x39, 0x8b, 0x23, 0x46, 0x31, 0x25, 0x83, 0x1f, 0x0, 0x1, 0xb2, 0x23, 0x56, 0xc2, 0x16, 0x0, 0x6, 0xd8, 0x38, 0x38, 0xa8, 0x74, 0x66, 0x29, 0x9e, 0x0, 0x7, 0x13, 0x5d, 0x8f, 0xf2, 0x4, 0x38, 0x92, 0x0, 0x13, 0xe6, 0xcf, 0x43, 0x27, 0x2f, 0x5e, 0x4c, 0x6e, 0x1, 0x6, 0xef, 0xd0, 0x36, 0xe3, 0xa2, 0x42, 0x7e, 0xde, 0x8e, 0x0, 0xf, 0xcb, 0xd7, 0x27, 0x71, 0xc0, 0x3b, 0xfd, 0x9e, 0x83, 0x22, 0xb9, 0xff, 0xa8, 0xc, 0xe3};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x58, 0xa1, 0xc5, 0x21, 0x12, 0x3f, 0xd6, 0x46, 0x4b, 0x20, 0xc3, 0x57, 0x7e, 0xc7, 0x27, 0x62};
  uint8_t bytesprops1[] = {0x1f, 0x87, 0x8d, 0x58, 0x6a, 0x1b, 0x0, 0xa9, 0x9b, 0xa1, 0x2a, 0x8f, 0x9c, 0xb1, 0x29, 0x9e, 0x3e, 0x20, 0x94, 0x14, 0xad, 0x4e, 0x8b, 0xc5, 0xbd, 0x42, 0xc6, 0xaa, 0x54};
  uint8_t bytesprops2[] = {0x86, 0x5d, 0xf1, 0x5, 0xf3, 0x31, 0xb4, 0x6c, 0x2b, 0x89, 0x84, 0xdc, 0x1c, 0x51, 0xf3, 0x74, 0x6b, 0x79, 0x4, 0x44, 0x40, 0xd8, 0x6d, 0x86, 0x5a, 0x3c, 0x60, 0xff, 0x47, 0x95};
  uint8_t bytesprops3[] = {0x91, 0x80, 0x89, 0xad, 0x68, 0x11, 0x73, 0x81, 0xfb, 0xd2, 0xb8};
  uint8_t bytesprops4[] = {0x41, 0xbb, 0x4, 0x84, 0xa9, 0x5d, 0xf4, 0xcd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 1627}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {16, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {29, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 23850}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 158}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 3440}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {30, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 7}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9423}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 16}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31638}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 226}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {11, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29008}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 9586}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11288}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 16372}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 83}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x4a, 0xb0, 0x5d, 0xb6, 0x8d, 0xa, 0x67, 0xaf, 0xa5, 0xaa, 0xbf, 0x7f, 0xb3, 0xb1, 0xd0, 0x3e, 0x49, 0x48, 0xd, 0xc9, 0xb6, 0x7a, 0x84, 0x96, 0x8e, 0xe4};
  uint8_t byteswillprops1[] = {0xb2};
  uint8_t byteswillprops2[] = {0xd8, 0x38, 0x38, 0xa8, 0x74, 0x66};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17500}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 248}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 9}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 55}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31929}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 9}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 73}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 202}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 14731}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 17969}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 131}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {1, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22210}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {6, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 158}},
  };

  lwmqtt_properties_t willprops = {16, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x13, 0x5d, 0x8f, 0xf2, 0x4, 0x38, 0x92};
  lwmqtt_string_t will_topic = {7, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xe6, 0xcf, 0x43, 0x27, 0x2f, 0x5e, 0x4c, 0x6e, 0x1, 0x6, 0xef, 0xd0, 0x36, 0xe3, 0xa2, 0x42, 0x7e, 0xde, 0x8e};
  lwmqtt_string_t will_payload = {19, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 18009;
  uint8_t client_id_bytes[] = {0xdf, 0x9d, 0x3b, 0x65, 0x6, 0x73, 0x2a, 0x0, 0x86, 0x4e, 0x97, 0x4b, 0xd4, 0x67, 0xaa};
  lwmqtt_string_t client_id = {15, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xcb, 0xd7, 0x27, 0x71, 0xc0, 0x3b, 0xfd, 0x9e, 0x83, 0x22, 0xb9, 0xff, 0xa8, 0xc, 0xe3};
  lwmqtt_string_t username = {15, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\SOH\169\149X", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "\185\164\201\218\t\RS\138w4\237\150O\188z}W", _willMsg = "<\195\167\FSW", _willProps = [PropPayloadFormatIndicator 255,PropUserProperty "\215" "\STX\189\169",PropServerKeepAlive 27782,PropMaximumPacketSize 28886,PropRetainAvailable 47,PropReceiveMaximum 31815,PropRequestProblemInformation 167,PropServerKeepAlive 25282,PropRequestProblemInformation 12,PropServerKeepAlive 19094,PropReasonString "u\155\199\&5U-Z\181\184\151q\224qP'\239\b\DLE\227\209\na\170\STXaF=",PropServerKeepAlive 5566,PropCorrelationData "+\226l\248\162A\250\166\143dtz",PropSubscriptionIdentifier 14]}), _cleanSession = True, _keepAlive = 29930, _connID = "\b7o\203\f\197", _properties = [PropContentType "wK\207_@",PropMessageExpiryInterval 23707,PropSubscriptionIdentifier 25,PropMessageExpiryInterval 32685,PropSubscriptionIdentifierAvailable 45,PropResponseInformation "\160>dD=fT\232\180|\252^\209\181W\141\149\GS-F4b\247\EM\n\228",PropMaximumPacketSize 16566,PropPayloadFormatIndicator 169,PropPayloadFormatIndicator 237,PropAuthenticationData "\205\ESC\182N\221g.\ACK\155\143\221!}XZW\222\219\249\158=\176F1",PropSubscriptionIdentifierAvailable 210,PropServerKeepAlive 7363,PropWillDelayInterval 406,PropServerReference "Gc\rt\190\198\rv\184\245\SI\145C\NUL\240\219\SOj\230",PropSessionExpiryInterval 26332,PropResponseTopic "\226z\145r\204\214K\173\216\234H06",PropAuthenticationData "x\210\209C\129\r`\132",PropServerKeepAlive 16373,PropMaximumQoS 223,PropMaximumQoS 215,PropMessageExpiryInterval 12607,PropRetainAvailable 161,PropRequestProblemInformation 185]}
TEST(Connect5QCTest, Encode11) {
uint8_t pkt[] = {0x10, 0xaf, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x6e, 0x74, 0xea, 0xa7, 0x1, 0x3, 0x0, 0x5, 0x77, 0x4b, 0xcf, 0x5f, 0x40, 0x2, 0x0, 0x0, 0x5c, 0x9b, 0xb, 0x19, 0x2, 0x0, 0x0, 0x7f, 0xad, 0x29, 0x2d, 0x1a, 0x0, 0x1a, 0xa0, 0x3e, 0x64, 0x44, 0x3d, 0x66, 0x54, 0xe8, 0xb4, 0x7c, 0xfc, 0x5e, 0xd1, 0xb5, 0x57, 0x8d, 0x95, 0x1d, 0x2d, 0x46, 0x34, 0x62, 0xf7, 0x19, 0xa, 0xe4, 0x27, 0x0, 0x0, 0x40, 0xb6, 0x1, 0xa9, 0x1, 0xed, 0x16, 0x0, 0x18, 0xcd, 0x1b, 0xb6, 0x4e, 0xdd, 0x67, 0x2e, 0x6, 0x9b, 0x8f, 0xdd, 0x21, 0x7d, 0x58, 0x5a, 0x57, 0xde, 0xdb, 0xf9, 0x9e, 0x3d, 0xb0, 0x46, 0x31, 0x29, 0xd2, 0x13, 0x1c, 0xc3, 0x18, 0x0, 0x0, 0x1, 0x96, 0x1c, 0x0, 0x13, 0x47, 0x63, 0xd, 0x74, 0xbe, 0xc6, 0xd, 0x76, 0xb8, 0xf5, 0xf, 0x91, 0x43, 0x0, 0xf0, 0xdb, 0xe, 0x6a, 0xe6, 0x11, 0x0, 0x0, 0x66, 0xdc, 0x8, 0x0, 0xd, 0xe2, 0x7a, 0x91, 0x72, 0xcc, 0xd6, 0x4b, 0xad, 0xd8, 0xea, 0x48, 0x30, 0x36, 0x16, 0x0, 0x8, 0x78, 0xd2, 0xd1, 0x43, 0x81, 0xd, 0x60, 0x84, 0x13, 0x3f, 0xf5, 0x24, 0xdf, 0x24, 0xd7, 0x2, 0x0, 0x0, 0x31, 0x3f, 0x25, 0xa1, 0x17, 0xb9, 0x0, 0x6, 0x8, 0x37, 0x6f, 0xcb, 0xc, 0xc5, 0x54, 0x1, 0xff, 0x26, 0x0, 0x1, 0xd7, 0x0, 0x3, 0x2, 0xbd, 0xa9, 0x13, 0x6c, 0x86, 0x27, 0x0, 0x0, 0x70, 0xd6, 0x25, 0x2f, 0x21, 0x7c, 0x47, 0x17, 0xa7, 0x13, 0x62, 0xc2, 0x17, 0xc, 0x13, 0x4a, 0x96, 0x1f, 0x0, 0x1b, 0x75, 0x9b, 0xc7, 0x35, 0x55, 0x2d, 0x5a, 0xb5, 0xb8, 0x97, 0x71, 0xe0, 0x71, 0x50, 0x27, 0xef, 0x8, 0x10, 0xe3, 0xd1, 0xa, 0x61, 0xaa, 0x2, 0x61, 0x46, 0x3d, 0x13, 0x15, 0xbe, 0x9, 0x0, 0xc, 0x2b, 0xe2, 0x6c, 0xf8, 0xa2, 0x41, 0xfa, 0xa6, 0x8f, 0x64, 0x74, 0x7a, 0xb, 0xe, 0x0, 0x10, 0xb9, 0xa4, 0xc9, 0xda, 0x9, 0x1e, 0x8a, 0x77, 0x34, 0xed, 0x96, 0x4f, 0xbc, 0x7a, 0x7d, 0x57, 0x0, 0x5, 0x3c, 0xc3, 0xa7, 0x1c, 0x57, 0x0, 0x4, 0x1, 0xa9, 0x95, 0x58};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x77, 0x4b, 0xcf, 0x5f, 0x40};
  uint8_t bytesprops1[] = {0xa0, 0x3e, 0x64, 0x44, 0x3d, 0x66, 0x54, 0xe8, 0xb4, 0x7c, 0xfc, 0x5e, 0xd1, 0xb5, 0x57, 0x8d, 0x95, 0x1d, 0x2d, 0x46, 0x34, 0x62, 0xf7, 0x19, 0xa, 0xe4};
  uint8_t bytesprops2[] = {0xcd, 0x1b, 0xb6, 0x4e, 0xdd, 0x67, 0x2e, 0x6, 0x9b, 0x8f, 0xdd, 0x21, 0x7d, 0x58, 0x5a, 0x57, 0xde, 0xdb, 0xf9, 0x9e, 0x3d, 0xb0, 0x46, 0x31};
  uint8_t bytesprops3[] = {0x47, 0x63, 0xd, 0x74, 0xbe, 0xc6, 0xd, 0x76, 0xb8, 0xf5, 0xf, 0x91, 0x43, 0x0, 0xf0, 0xdb, 0xe, 0x6a, 0xe6};
  uint8_t bytesprops4[] = {0xe2, 0x7a, 0x91, 0x72, 0xcc, 0xd6, 0x4b, 0xad, 0xd8, 0xea, 0x48, 0x30, 0x36};
  uint8_t bytesprops5[] = {0x78, 0xd2, 0xd1, 0x43, 0x81, 0xd, 0x60, 0x84};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {5, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23707}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32685}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 45}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 16566}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 169}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 237}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {24, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7363}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 406}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 26332}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {13, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {8, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 16373}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 223}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 215}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12607}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 161}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 185}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops1[] = {0x2, 0xbd, 0xa9};
  uint8_t byteswillprops0[] = {0xd7};
  uint8_t byteswillprops2[] = {0x75, 0x9b, 0xc7, 0x35, 0x55, 0x2d, 0x5a, 0xb5, 0xb8, 0x97, 0x71, 0xe0, 0x71, 0x50, 0x27, 0xef, 0x8, 0x10, 0xe3, 0xd1, 0xa, 0x61, 0xaa, 0x2, 0x61, 0x46, 0x3d};
  uint8_t byteswillprops3[] = {0x2b, 0xe2, 0x6c, 0xf8, 0xa2, 0x41, 0xfa, 0xa6, 0x8f, 0x64, 0x74, 0x7a};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 255}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={1, (char*)&byteswillprops0}, .v={3, (char*)&byteswillprops1}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27782}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 28886}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 47}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 31815}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 167}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 25282}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 12}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19094}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {27, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 5566}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 14}},
  };

  lwmqtt_properties_t willprops = {14, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb9, 0xa4, 0xc9, 0xda, 0x9, 0x1e, 0x8a, 0x77, 0x34, 0xed, 0x96, 0x4f, 0xbc, 0x7a, 0x7d, 0x57};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x3c, 0xc3, 0xa7, 0x1c, 0x57};
  lwmqtt_string_t will_payload = {5, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 29930;
  uint8_t client_id_bytes[] = {0x8, 0x37, 0x6f, 0xcb, 0xc, 0xc5};
  lwmqtt_string_t client_id = {6, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x1, 0xa9, 0x95, 0x58};
  lwmqtt_string_t password = {4, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "xj\DC2d\147j\242\141\DC1\253\179o\188", _password = Just "\144\238/&m", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "\191\197a\194u\133\135\244\211\170\162\129\161\&6\225\&2", _willMsg = "\218\f", _willProps = [PropPayloadFormatIndicator 192,PropTopicAliasMaximum 11735,PropWildcardSubscriptionAvailable 161,PropWillDelayInterval 8437,PropRequestResponseInformation 154,PropRequestResponseInformation 0,PropRequestProblemInformation 121,PropTopicAlias 5703,PropMessageExpiryInterval 30855,PropServerKeepAlive 21347,PropAssignedClientIdentifier "\232\&70\185N\179E\n]\254b/fTX\DC1C\167Au{\f\234\137",PropRequestProblemInformation 98,PropPayloadFormatIndicator 8]}), _cleanSession = False, _keepAlive = 15412, _connID = "\176\143\160_\\\166\148\213\226\224\CAN>\238\v\168\163", _properties = [PropAssignedClientIdentifier "\146\ETB<\248$\206\222\226\t\163_",PropMessageExpiryInterval 5227,PropTopicAlias 787,PropMaximumQoS 108,PropResponseInformation "K\161qr\DC4\207\217\225\185\142A)\188\&9^\175\244\130&}\225\204d\b\184\167\225\STX\b\151",PropContentType "\189 ",PropMessageExpiryInterval 19245,PropRequestProblemInformation 210,PropSessionExpiryInterval 32723,PropRequestResponseInformation 208,PropTopicAliasMaximum 32403,PropSessionExpiryInterval 11781,PropMaximumPacketSize 27425,PropMessageExpiryInterval 21128,PropRequestProblemInformation 119,PropAuthenticationData "\249\DLE\224\255\SOH\171l.`\165O\179\&9\NUL\246\180\148\&9\221\STX\r\159",PropServerReference "_\218\138\225p\ETX\STX\202\157X",PropResponseTopic "\150\135\239hji\149\DC26\153\190\201\253Y/\252\167\242.J=z\161\200\DC3",PropPayloadFormatIndicator 251]}
TEST(Connect5QCTest, Encode12) {
uint8_t pkt[] = {0x10, 0xab, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xe4, 0x3c, 0x34, 0xa4, 0x1, 0x12, 0x0, 0xb, 0x92, 0x17, 0x3c, 0xf8, 0x24, 0xce, 0xde, 0xe2, 0x9, 0xa3, 0x5f, 0x2, 0x0, 0x0, 0x14, 0x6b, 0x23, 0x3, 0x13, 0x24, 0x6c, 0x1a, 0x0, 0x1e, 0x4b, 0xa1, 0x71, 0x72, 0x14, 0xcf, 0xd9, 0xe1, 0xb9, 0x8e, 0x41, 0x29, 0xbc, 0x39, 0x5e, 0xaf, 0xf4, 0x82, 0x26, 0x7d, 0xe1, 0xcc, 0x64, 0x8, 0xb8, 0xa7, 0xe1, 0x2, 0x8, 0x97, 0x3, 0x0, 0x2, 0xbd, 0x20, 0x2, 0x0, 0x0, 0x4b, 0x2d, 0x17, 0xd2, 0x11, 0x0, 0x0, 0x7f, 0xd3, 0x19, 0xd0, 0x22, 0x7e, 0x93, 0x11, 0x0, 0x0, 0x2e, 0x5, 0x27, 0x0, 0x0, 0x6b, 0x21, 0x2, 0x0, 0x0, 0x52, 0x88, 0x17, 0x77, 0x16, 0x0, 0x16, 0xf9, 0x10, 0xe0, 0xff, 0x1, 0xab, 0x6c, 0x2e, 0x60, 0xa5, 0x4f, 0xb3, 0x39, 0x0, 0xf6, 0xb4, 0x94, 0x39, 0xdd, 0x2, 0xd, 0x9f, 0x1c, 0x0, 0xa, 0x5f, 0xda, 0x8a, 0xe1, 0x70, 0x3, 0x2, 0xca, 0x9d, 0x58, 0x8, 0x0, 0x19, 0x96, 0x87, 0xef, 0x68, 0x6a, 0x69, 0x95, 0x12, 0x36, 0x99, 0xbe, 0xc9, 0xfd, 0x59, 0x2f, 0xfc, 0xa7, 0xf2, 0x2e, 0x4a, 0x3d, 0x7a, 0xa1, 0xc8, 0x13, 0x1, 0xfb, 0x0, 0x10, 0xb0, 0x8f, 0xa0, 0x5f, 0x5c, 0xa6, 0x94, 0xd5, 0xe2, 0xe0, 0x18, 0x3e, 0xee, 0xb, 0xa8, 0xa3, 0x3c, 0x1, 0xc0, 0x22, 0x2d, 0xd7, 0x28, 0xa1, 0x18, 0x0, 0x0, 0x20, 0xf5, 0x19, 0x9a, 0x19, 0x0, 0x17, 0x79, 0x23, 0x16, 0x47, 0x2, 0x0, 0x0, 0x78, 0x87, 0x13, 0x53, 0x63, 0x12, 0x0, 0x18, 0xe8, 0x37, 0x30, 0xb9, 0x4e, 0xb3, 0x45, 0xa, 0x5d, 0xfe, 0x62, 0x2f, 0x66, 0x54, 0x58, 0x11, 0x43, 0xa7, 0x41, 0x75, 0x7b, 0xc, 0xea, 0x89, 0x17, 0x62, 0x1, 0x8, 0x0, 0x10, 0xbf, 0xc5, 0x61, 0xc2, 0x75, 0x85, 0x87, 0xf4, 0xd3, 0xaa, 0xa2, 0x81, 0xa1, 0x36, 0xe1, 0x32, 0x0, 0x2, 0xda, 0xc, 0x0, 0xd, 0x78, 0x6a, 0x12, 0x64, 0x93, 0x6a, 0xf2, 0x8d, 0x11, 0xfd, 0xb3, 0x6f, 0xbc, 0x0, 0x5, 0x90, 0xee, 0x2f, 0x26, 0x6d};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x92, 0x17, 0x3c, 0xf8, 0x24, 0xce, 0xde, 0xe2, 0x9, 0xa3, 0x5f};
  uint8_t bytesprops1[] = {0x4b, 0xa1, 0x71, 0x72, 0x14, 0xcf, 0xd9, 0xe1, 0xb9, 0x8e, 0x41, 0x29, 0xbc, 0x39, 0x5e, 0xaf, 0xf4, 0x82, 0x26, 0x7d, 0xe1, 0xcc, 0x64, 0x8, 0xb8, 0xa7, 0xe1, 0x2, 0x8, 0x97};
  uint8_t bytesprops2[] = {0xbd, 0x20};
  uint8_t bytesprops3[] = {0xf9, 0x10, 0xe0, 0xff, 0x1, 0xab, 0x6c, 0x2e, 0x60, 0xa5, 0x4f, 0xb3, 0x39, 0x0, 0xf6, 0xb4, 0x94, 0x39, 0xdd, 0x2, 0xd, 0x9f};
  uint8_t bytesprops4[] = {0x5f, 0xda, 0x8a, 0xe1, 0x70, 0x3, 0x2, 0xca, 0x9d, 0x58};
  uint8_t bytesprops5[] = {0x96, 0x87, 0xef, 0x68, 0x6a, 0x69, 0x95, 0x12, 0x36, 0x99, 0xbe, 0xc9, 0xfd, 0x59, 0x2f, 0xfc, 0xa7, 0xf2, 0x2e, 0x4a, 0x3d, 0x7a, 0xa1, 0xc8, 0x13};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5227}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 787}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 108}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19245}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 32723}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 208}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32403}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11781}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27425}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21128}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 119}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 251}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe8, 0x37, 0x30, 0xb9, 0x4e, 0xb3, 0x45, 0xa, 0x5d, 0xfe, 0x62, 0x2f, 0x66, 0x54, 0x58, 0x11, 0x43, 0xa7, 0x41, 0x75, 0x7b, 0xc, 0xea, 0x89};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 192}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 11735}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 161}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8437}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 154}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 0}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 121}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 5703}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30855}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21347}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 98}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 8}},
  };

  lwmqtt_properties_t willprops = {13, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xbf, 0xc5, 0x61, 0xc2, 0x75, 0x85, 0x87, 0xf4, 0xd3, 0xaa, 0xa2, 0x81, 0xa1, 0x36, 0xe1, 0x32};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xda, 0xc};
  lwmqtt_string_t will_payload = {2, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 15412;
  uint8_t client_id_bytes[] = {0xb0, 0x8f, 0xa0, 0x5f, 0x5c, 0xa6, 0x94, 0xd5, 0xe2, 0xe0, 0x18, 0x3e, 0xee, 0xb, 0xa8, 0xa3};
  lwmqtt_string_t client_id = {16, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x78, 0x6a, 0x12, 0x64, 0x93, 0x6a, 0xf2, 0x8d, 0x11, 0xfd, 0xb3, 0x6f, 0xbc};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x90, 0xee, 0x2f, 0x26, 0x6d};
  lwmqtt_string_t password = {5, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\128p\220>r\201\195\&0\200", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\DC3l\244\169\203\EOT\129\173\&4\NUL\252\RS\184\133V\249z\191:P~GH\EM\193\SOH29\254e", _willMsg = "mvB", _willProps = [PropTopicAlias 32015,PropReceiveMaximum 20354,PropServerReference "a\230\147k\173c",PropRetainAvailable 141,PropContentType "\152\187&ci^\244\182{\166-\152\239\213 \216\242Z;nE~\235k\157\206",PropTopicAlias 4971,PropSharedSubscriptionAvailable 136,PropTopicAliasMaximum 21122,PropServerReference "\195%\SOo\170(\237",PropReceiveMaximum 30880,PropContentType " \237>Nx?\234\210\128\231\243\202\229\252r\191y\ETX9\214",PropTopicAliasMaximum 944,PropSessionExpiryInterval 4649,PropResponseTopic "0\DC4wb\235\170\196\188",PropSubscriptionIdentifier 5,PropPayloadFormatIndicator 92,PropSubscriptionIdentifier 23,PropMaximumQoS 170,PropCorrelationData "'",PropSubscriptionIdentifierAvailable 121,PropServerKeepAlive 11697,PropSessionExpiryInterval 32682,PropReceiveMaximum 10853,PropPayloadFormatIndicator 94,PropSubscriptionIdentifierAvailable 249]}), _cleanSession = True, _keepAlive = 30313, _connID = "\215\250VLG@\204B\"\166$HJ", _properties = [PropRequestResponseInformation 42,PropSubscriptionIdentifier 17,PropAuthenticationMethod "i\134\SO\230!|\133\173[O{6W&\161\175",PropReasonString "^@",PropMessageExpiryInterval 12544,PropServerReference "\SOH\168\246Bt\EOTQt,\158)\SYN\r=",PropAssignedClientIdentifier "a\212\EM\DC4H\239\196F\154QVS\157u\218\US\155<V\147\b\SI\224\156LS\147\238.",PropResponseTopic "\STX\216\155\162\236\SYN\171\242\204\204\185\148",PropMessageExpiryInterval 25395,PropContentType "\184(]\147\156\146\189g\146\RS\t\FS\183-\SYN!~n\249",PropPayloadFormatIndicator 64,PropAuthenticationData "\215\"\238i7\152\233\DC2T\GS^,\213\167\ACK\238\128\198,h\CANOU\FS\t\160",PropSubscriptionIdentifierAvailable 239,PropAuthenticationData "\216R*\NULr\CANm\246\208ABh/\232m\196K$\176\251 \196\STX\SI\206\145",PropMessageExpiryInterval 27606,PropSubscriptionIdentifier 22,PropRequestResponseInformation 148,PropReasonString "\143\224}%\212\221w$*J\SUBC\167\\z\169t\159\210%D\222\139\204\NAK\SYN\DC1PN\DEL",PropTopicAlias 7827]}
TEST(Connect5QCTest, Encode13) {
uint8_t pkt[] = {0x10, 0xbe, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x4e, 0x76, 0x69, 0xe7, 0x1, 0x19, 0x2a, 0xb, 0x11, 0x15, 0x0, 0x10, 0x69, 0x86, 0xe, 0xe6, 0x21, 0x7c, 0x85, 0xad, 0x5b, 0x4f, 0x7b, 0x36, 0x57, 0x26, 0xa1, 0xaf, 0x1f, 0x0, 0x2, 0x5e, 0x40, 0x2, 0x0, 0x0, 0x31, 0x0, 0x1c, 0x0, 0xe, 0x1, 0xa8, 0xf6, 0x42, 0x74, 0x4, 0x51, 0x74, 0x2c, 0x9e, 0x29, 0x16, 0xd, 0x3d, 0x12, 0x0, 0x1d, 0x61, 0xd4, 0x19, 0x14, 0x48, 0xef, 0xc4, 0x46, 0x9a, 0x51, 0x56, 0x53, 0x9d, 0x75, 0xda, 0x1f, 0x9b, 0x3c, 0x56, 0x93, 0x8, 0xf, 0xe0, 0x9c, 0x4c, 0x53, 0x93, 0xee, 0x2e, 0x8, 0x0, 0xc, 0x2, 0xd8, 0x9b, 0xa2, 0xec, 0x16, 0xab, 0xf2, 0xcc, 0xcc, 0xb9, 0x94, 0x2, 0x0, 0x0, 0x63, 0x33, 0x3, 0x0, 0x13, 0xb8, 0x28, 0x5d, 0x93, 0x9c, 0x92, 0xbd, 0x67, 0x92, 0x1e, 0x9, 0x1c, 0xb7, 0x2d, 0x16, 0x21, 0x7e, 0x6e, 0xf9, 0x1, 0x40, 0x16, 0x0, 0x1a, 0xd7, 0x22, 0xee, 0x69, 0x37, 0x98, 0xe9, 0x12, 0x54, 0x1d, 0x5e, 0x2c, 0xd5, 0xa7, 0x6, 0xee, 0x80, 0xc6, 0x2c, 0x68, 0x18, 0x4f, 0x55, 0x1c, 0x9, 0xa0, 0x29, 0xef, 0x16, 0x0, 0x1a, 0xd8, 0x52, 0x2a, 0x0, 0x72, 0x18, 0x6d, 0xf6, 0xd0, 0x41, 0x42, 0x68, 0x2f, 0xe8, 0x6d, 0xc4, 0x4b, 0x24, 0xb0, 0xfb, 0x20, 0xc4, 0x2, 0xf, 0xce, 0x91, 0x2, 0x0, 0x0, 0x6b, 0xd6, 0xb, 0x16, 0x19, 0x94, 0x1f, 0x0, 0x1e, 0x8f, 0xe0, 0x7d, 0x25, 0xd4, 0xdd, 0x77, 0x24, 0x2a, 0x4a, 0x1a, 0x43, 0xa7, 0x5c, 0x7a, 0xa9, 0x74, 0x9f, 0xd2, 0x25, 0x44, 0xde, 0x8b, 0xcc, 0x15, 0x16, 0x11, 0x50, 0x4e, 0x7f, 0x23, 0x1e, 0x93, 0x0, 0xd, 0xd7, 0xfa, 0x56, 0x4c, 0x47, 0x40, 0xcc, 0x42, 0x22, 0xa6, 0x24, 0x48, 0x4a, 0x8a, 0x1, 0x23, 0x7d, 0xf, 0x21, 0x4f, 0x82, 0x1c, 0x0, 0x6, 0x61, 0xe6, 0x93, 0x6b, 0xad, 0x63, 0x25, 0x8d, 0x3, 0x0, 0x1a, 0x98, 0xbb, 0x26, 0x63, 0x69, 0x5e, 0xf4, 0xb6, 0x7b, 0xa6, 0x2d, 0x98, 0xef, 0xd5, 0x20, 0xd8, 0xf2, 0x5a, 0x3b, 0x6e, 0x45, 0x7e, 0xeb, 0x6b, 0x9d, 0xce, 0x23, 0x13, 0x6b, 0x2a, 0x88, 0x22, 0x52, 0x82, 0x1c, 0x0, 0x7, 0xc3, 0x25, 0xe, 0x6f, 0xaa, 0x28, 0xed, 0x21, 0x78, 0xa0, 0x3, 0x0, 0x14, 0x20, 0xed, 0x3e, 0x4e, 0x78, 0x3f, 0xea, 0xd2, 0x80, 0xe7, 0xf3, 0xca, 0xe5, 0xfc, 0x72, 0xbf, 0x79, 0x3, 0x39, 0xd6, 0x22, 0x3, 0xb0, 0x11, 0x0, 0x0, 0x12, 0x29, 0x8, 0x0, 0x8, 0x30, 0x14, 0x77, 0x62, 0xeb, 0xaa, 0xc4, 0xbc, 0xb, 0x5, 0x1, 0x5c, 0xb, 0x17, 0x24, 0xaa, 0x9, 0x0, 0x1, 0x27, 0x29, 0x79, 0x13, 0x2d, 0xb1, 0x11, 0x0, 0x0, 0x7f, 0xaa, 0x21, 0x2a, 0x65, 0x1, 0x5e, 0x29, 0xf9, 0x0, 0x1e, 0x13, 0x6c, 0xf4, 0xa9, 0xcb, 0x4, 0x81, 0xad, 0x34, 0x0, 0xfc, 0x1e, 0xb8, 0x85, 0x56, 0xf9, 0x7a, 0xbf, 0x3a, 0x50, 0x7e, 0x47, 0x48, 0x19, 0xc1, 0x1, 0x32, 0x39, 0xfe, 0x65, 0x0, 0x3, 0x6d, 0x76, 0x42, 0x0, 0x9, 0x80, 0x70, 0xdc, 0x3e, 0x72, 0xc9, 0xc3, 0x30, 0xc8};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x69, 0x86, 0xe, 0xe6, 0x21, 0x7c, 0x85, 0xad, 0x5b, 0x4f, 0x7b, 0x36, 0x57, 0x26, 0xa1, 0xaf};
  uint8_t bytesprops1[] = {0x5e, 0x40};
  uint8_t bytesprops2[] = {0x1, 0xa8, 0xf6, 0x42, 0x74, 0x4, 0x51, 0x74, 0x2c, 0x9e, 0x29, 0x16, 0xd, 0x3d};
  uint8_t bytesprops3[] = {0x61, 0xd4, 0x19, 0x14, 0x48, 0xef, 0xc4, 0x46, 0x9a, 0x51, 0x56, 0x53, 0x9d, 0x75, 0xda, 0x1f, 0x9b, 0x3c, 0x56, 0x93, 0x8, 0xf, 0xe0, 0x9c, 0x4c, 0x53, 0x93, 0xee, 0x2e};
  uint8_t bytesprops4[] = {0x2, 0xd8, 0x9b, 0xa2, 0xec, 0x16, 0xab, 0xf2, 0xcc, 0xcc, 0xb9, 0x94};
  uint8_t bytesprops5[] = {0xb8, 0x28, 0x5d, 0x93, 0x9c, 0x92, 0xbd, 0x67, 0x92, 0x1e, 0x9, 0x1c, 0xb7, 0x2d, 0x16, 0x21, 0x7e, 0x6e, 0xf9};
  uint8_t bytesprops6[] = {0xd7, 0x22, 0xee, 0x69, 0x37, 0x98, 0xe9, 0x12, 0x54, 0x1d, 0x5e, 0x2c, 0xd5, 0xa7, 0x6, 0xee, 0x80, 0xc6, 0x2c, 0x68, 0x18, 0x4f, 0x55, 0x1c, 0x9, 0xa0};
  uint8_t bytesprops7[] = {0xd8, 0x52, 0x2a, 0x0, 0x72, 0x18, 0x6d, 0xf6, 0xd0, 0x41, 0x42, 0x68, 0x2f, 0xe8, 0x6d, 0xc4, 0x4b, 0x24, 0xb0, 0xfb, 0x20, 0xc4, 0x2, 0xf, 0xce, 0x91};
  uint8_t bytesprops8[] = {0x8f, 0xe0, 0x7d, 0x25, 0xd4, 0xdd, 0x77, 0x24, 0x2a, 0x4a, 0x1a, 0x43, 0xa7, 0x5c, 0x7a, 0xa9, 0x74, 0x9f, 0xd2, 0x25, 0x44, 0xde, 0x8b, 0xcc, 0x15, 0x16, 0x11, 0x50, 0x4e, 0x7f};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 17}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {16, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {2, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12544}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {14, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25395}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {19, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 64}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 239}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27606}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 148}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {30, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7827}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x61, 0xe6, 0x93, 0x6b, 0xad, 0x63};
  uint8_t byteswillprops1[] = {0x98, 0xbb, 0x26, 0x63, 0x69, 0x5e, 0xf4, 0xb6, 0x7b, 0xa6, 0x2d, 0x98, 0xef, 0xd5, 0x20, 0xd8, 0xf2, 0x5a, 0x3b, 0x6e, 0x45, 0x7e, 0xeb, 0x6b, 0x9d, 0xce};
  uint8_t byteswillprops2[] = {0xc3, 0x25, 0xe, 0x6f, 0xaa, 0x28, 0xed};
  uint8_t byteswillprops3[] = {0x20, 0xed, 0x3e, 0x4e, 0x78, 0x3f, 0xea, 0xd2, 0x80, 0xe7, 0xf3, 0xca, 0xe5, 0xfc, 0x72, 0xbf, 0x79, 0x3, 0x39, 0xd6};
  uint8_t byteswillprops4[] = {0x30, 0x14, 0x77, 0x62, 0xeb, 0xaa, 0xc4, 0xbc};
  uint8_t byteswillprops5[] = {0x27};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32015}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 20354}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {26, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4971}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 136}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 21122}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {7, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30880}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {20, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 944}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 4649}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 5}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 92}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 23}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 170}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {1, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 121}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 11697}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 32682}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 10853}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 94}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 249}},
  };

  lwmqtt_properties_t willprops = {25, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x13, 0x6c, 0xf4, 0xa9, 0xcb, 0x4, 0x81, 0xad, 0x34, 0x0, 0xfc, 0x1e, 0xb8, 0x85, 0x56, 0xf9, 0x7a, 0xbf, 0x3a, 0x50, 0x7e, 0x47, 0x48, 0x19, 0xc1, 0x1, 0x32, 0x39, 0xfe, 0x65};
  lwmqtt_string_t will_topic = {30, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x6d, 0x76, 0x42};
  lwmqtt_string_t will_payload = {3, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 30313;
  uint8_t client_id_bytes[] = {0xd7, 0xfa, 0x56, 0x4c, 0x47, 0x40, 0xcc, 0x42, 0x22, 0xa6, 0x24, 0x48, 0x4a};
  lwmqtt_string_t client_id = {13, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x80, 0x70, 0xdc, 0x3e, 0x72, 0xc9, 0xc3, 0x30, 0xc8};
  lwmqtt_string_t password = {9, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\b\247\147N", _password = Just "\158\238\145\147\144\128C\149\133Syv\234\ESC?", _lastWill = Nothing, _cleanSession = True, _keepAlive = 13836, _connID = "", _properties = [PropTopicAlias 26396,PropRequestProblemInformation 140,PropWildcardSubscriptionAvailable 142,PropRequestResponseInformation 80,PropSessionExpiryInterval 7383,PropSharedSubscriptionAvailable 147,PropAuthenticationData "\NAK\255\173\b-a\246\221\r&[\SUB\t&h\n\FS\144",PropPayloadFormatIndicator 224,PropAuthenticationData "\FS!\213H\DC4\241\180\ACK\171\&9\131#\185\170\253\&82\255\246+0\SUB2\ENQ\b)\ESC\218\135\190",PropRequestResponseInformation 232,PropMessageExpiryInterval 32527,PropRequestProblemInformation 64,PropSubscriptionIdentifierAvailable 231,PropWildcardSubscriptionAvailable 16,PropMaximumQoS 206,PropCorrelationData "W\156\ETB\180\220\249\161,\223\201\164\134\&6Q\174\212\243\230\&7\205\ENQ\137\212\DEL\233\165\ENQ:J\195",PropMaximumQoS 141,PropTopicAliasMaximum 24868,PropMessageExpiryInterval 22032,PropMessageExpiryInterval 21759,PropServerReference "y\195\168\200\241N=\131\ETX\207X\DLE(\184\169\190\ACK\163\216R\174",PropSubscriptionIdentifier 9,PropRetainAvailable 149]}
TEST(Connect5QCTest, Encode14) {
uint8_t pkt[] = {0x10, 0xc8, 0x1, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xc2, 0x36, 0xc, 0xa3, 0x1, 0x23, 0x67, 0x1c, 0x17, 0x8c, 0x28, 0x8e, 0x19, 0x50, 0x11, 0x0, 0x0, 0x1c, 0xd7, 0x2a, 0x93, 0x16, 0x0, 0x12, 0x15, 0xff, 0xad, 0x8, 0x2d, 0x61, 0xf6, 0xdd, 0xd, 0x26, 0x5b, 0x1a, 0x9, 0x26, 0x68, 0xa, 0x1c, 0x90, 0x1, 0xe0, 0x16, 0x0, 0x1e, 0x1c, 0x21, 0xd5, 0x48, 0x14, 0xf1, 0xb4, 0x6, 0xab, 0x39, 0x83, 0x23, 0xb9, 0xaa, 0xfd, 0x38, 0x32, 0xff, 0xf6, 0x2b, 0x30, 0x1a, 0x32, 0x5, 0x8, 0x29, 0x1b, 0xda, 0x87, 0xbe, 0x19, 0xe8, 0x2, 0x0, 0x0, 0x7f, 0xf, 0x17, 0x40, 0x29, 0xe7, 0x28, 0x10, 0x24, 0xce, 0x9, 0x0, 0x1e, 0x57, 0x9c, 0x17, 0xb4, 0xdc, 0xf9, 0xa1, 0x2c, 0xdf, 0xc9, 0xa4, 0x86, 0x36, 0x51, 0xae, 0xd4, 0xf3, 0xe6, 0x37, 0xcd, 0x5, 0x89, 0xd4, 0x7f, 0xe9, 0xa5, 0x5, 0x3a, 0x4a, 0xc3, 0x24, 0x8d, 0x22, 0x61, 0x24, 0x2, 0x0, 0x0, 0x56, 0x10, 0x2, 0x0, 0x0, 0x54, 0xff, 0x1c, 0x0, 0x15, 0x79, 0xc3, 0xa8, 0xc8, 0xf1, 0x4e, 0x3d, 0x83, 0x3, 0xcf, 0x58, 0x10, 0x28, 0xb8, 0xa9, 0xbe, 0x6, 0xa3, 0xd8, 0x52, 0xae, 0xb, 0x9, 0x25, 0x95, 0x0, 0x0, 0x0, 0x4, 0x8, 0xf7, 0x93, 0x4e, 0x0, 0xf, 0x9e, 0xee, 0x91, 0x93, 0x90, 0x80, 0x43, 0x95, 0x85, 0x53, 0x79, 0x76, 0xea, 0x1b, 0x3f};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x15, 0xff, 0xad, 0x8, 0x2d, 0x61, 0xf6, 0xdd, 0xd, 0x26, 0x5b, 0x1a, 0x9, 0x26, 0x68, 0xa, 0x1c, 0x90};
  uint8_t bytesprops1[] = {0x1c, 0x21, 0xd5, 0x48, 0x14, 0xf1, 0xb4, 0x6, 0xab, 0x39, 0x83, 0x23, 0xb9, 0xaa, 0xfd, 0x38, 0x32, 0xff, 0xf6, 0x2b, 0x30, 0x1a, 0x32, 0x5, 0x8, 0x29, 0x1b, 0xda, 0x87, 0xbe};
  uint8_t bytesprops2[] = {0x57, 0x9c, 0x17, 0xb4, 0xdc, 0xf9, 0xa1, 0x2c, 0xdf, 0xc9, 0xa4, 0x86, 0x36, 0x51, 0xae, 0xd4, 0xf3, 0xe6, 0x37, 0xcd, 0x5, 0x89, 0xd4, 0x7f, 0xe9, 0xa5, 0x5, 0x3a, 0x4a, 0xc3};
  uint8_t bytesprops3[] = {0x79, 0xc3, 0xa8, 0xc8, 0xf1, 0x4e, 0x3d, 0x83, 0x3, 0xcf, 0x58, 0x10, 0x28, 0xb8, 0xa9, 0xbe, 0x6, 0xa3, 0xd8, 0x52, 0xae};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 26396}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 140}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 142}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 80}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7383}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 147}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 224}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {30, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 232}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32527}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 64}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 231}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 16}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 206}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24868}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22032}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21759}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 9}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 149}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 13836;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x8, 0xf7, 0x93, 0x4e};
  lwmqtt_string_t username = {4, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x9e, 0xee, 0x91, 0x93, 0x90, 0x80, 0x43, 0x95, 0x85, 0x53, 0x79, 0x76, 0xea, 0x1b, 0x3f};
  lwmqtt_string_t password = {15, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, NULL);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "A;\168\224\240\237\DC1\US`k\228D\201 \211vE.\203\STX&", _password = Just "\229\SYN\236\252jrj\246\DLE=x", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\241\&5\180\235\133=\135\224", _willMsg = "+r\156\250\&3\164\138\npj\245=\238\182N^\ra\151\161", _willProps = [PropContentType "\ETX\195\135\212c\222F\224\188\202\239\185\143\236\176[\243\&4",PropCorrelationData "h%k\161\201\191",PropPayloadFormatIndicator 166,PropTopicAlias 22816,PropRequestResponseInformation 84,PropWillDelayInterval 18479,PropRequestResponseInformation 132,PropSubscriptionIdentifierAvailable 202,PropPayloadFormatIndicator 210,PropSubscriptionIdentifier 19,PropSessionExpiryInterval 2534,PropRetainAvailable 129]}), _cleanSession = False, _keepAlive = 4733, _connID = "\v\ETX,\204b\141\136r!r\DC3a-\138\249M7\afg\EOT\139\228W", _properties = [PropPayloadFormatIndicator 146,PropAuthenticationMethod "\SUB\150>'uB\245\152\SI",PropSessionExpiryInterval 2313,PropSharedSubscriptionAvailable 135,PropMessageExpiryInterval 6040,PropMessageExpiryInterval 14534,PropAssignedClientIdentifier "\DC4*\231\182",PropResponseTopic "F\r#\DC1\203\&23\132\ETX4l\199",PropWildcardSubscriptionAvailable 202,PropResponseInformation "\231\&5\130,\230\162\SYNO\184\CAN!?LV\SUB\155\200e\174\214\238",PropCorrelationData "Y\202\227\r",PropSessionExpiryInterval 239]}
TEST(Connect5QCTest, Encode15) {
uint8_t pkt[] = {0x10, 0xfe, 0x1, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xf4, 0x12, 0x7d, 0x5b, 0x1, 0x92, 0x15, 0x0, 0x9, 0x1a, 0x96, 0x3e, 0x27, 0x75, 0x42, 0xf5, 0x98, 0xf, 0x11, 0x0, 0x0, 0x9, 0x9, 0x2a, 0x87, 0x2, 0x0, 0x0, 0x17, 0x98, 0x2, 0x0, 0x0, 0x38, 0xc6, 0x12, 0x0, 0x4, 0x14, 0x2a, 0xe7, 0xb6, 0x8, 0x0, 0xc, 0x46, 0xd, 0x23, 0x11, 0xcb, 0x32, 0x33, 0x84, 0x3, 0x34, 0x6c, 0xc7, 0x28, 0xca, 0x1a, 0x0, 0x15, 0xe7, 0x35, 0x82, 0x2c, 0xe6, 0xa2, 0x16, 0x4f, 0xb8, 0x18, 0x21, 0x3f, 0x4c, 0x56, 0x1a, 0x9b, 0xc8, 0x65, 0xae, 0xd6, 0xee, 0x9, 0x0, 0x4, 0x59, 0xca, 0xe3, 0xd, 0x11, 0x0, 0x0, 0x0, 0xef, 0x0, 0x18, 0xb, 0x3, 0x2c, 0xcc, 0x62, 0x8d, 0x88, 0x72, 0x21, 0x72, 0x13, 0x61, 0x2d, 0x8a, 0xf9, 0x4d, 0x37, 0x7, 0x66, 0x67, 0x4, 0x8b, 0xe4, 0x57, 0x39, 0x3, 0x0, 0x12, 0x3, 0xc3, 0x87, 0xd4, 0x63, 0xde, 0x46, 0xe0, 0xbc, 0xca, 0xef, 0xb9, 0x8f, 0xec, 0xb0, 0x5b, 0xf3, 0x34, 0x9, 0x0, 0x6, 0x68, 0x25, 0x6b, 0xa1, 0xc9, 0xbf, 0x1, 0xa6, 0x23, 0x59, 0x20, 0x19, 0x54, 0x18, 0x0, 0x0, 0x48, 0x2f, 0x19, 0x84, 0x29, 0xca, 0x1, 0xd2, 0xb, 0x13, 0x11, 0x0, 0x0, 0x9, 0xe6, 0x25, 0x81, 0x0, 0x8, 0xf1, 0x35, 0xb4, 0xeb, 0x85, 0x3d, 0x87, 0xe0, 0x0, 0x14, 0x2b, 0x72, 0x9c, 0xfa, 0x33, 0xa4, 0x8a, 0xa, 0x70, 0x6a, 0xf5, 0x3d, 0xee, 0xb6, 0x4e, 0x5e, 0xd, 0x61, 0x97, 0xa1, 0x0, 0x15, 0x41, 0x3b, 0xa8, 0xe0, 0xf0, 0xed, 0x11, 0x1f, 0x60, 0x6b, 0xe4, 0x44, 0xc9, 0x20, 0xd3, 0x76, 0x45, 0x2e, 0xcb, 0x2, 0x26, 0x0, 0xb, 0xe5, 0x16, 0xec, 0xfc, 0x6a, 0x72, 0x6a, 0xf6, 0x10, 0x3d, 0x78};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x1a, 0x96, 0x3e, 0x27, 0x75, 0x42, 0xf5, 0x98, 0xf};
  uint8_t bytesprops1[] = {0x14, 0x2a, 0xe7, 0xb6};
  uint8_t bytesprops2[] = {0x46, 0xd, 0x23, 0x11, 0xcb, 0x32, 0x33, 0x84, 0x3, 0x34, 0x6c, 0xc7};
  uint8_t bytesprops3[] = {0xe7, 0x35, 0x82, 0x2c, 0xe6, 0xa2, 0x16, 0x4f, 0xb8, 0x18, 0x21, 0x3f, 0x4c, 0x56, 0x1a, 0x9b, 0xc8, 0x65, 0xae, 0xd6, 0xee};
  uint8_t bytesprops4[] = {0x59, 0xca, 0xe3, 0xd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 146}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {9, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 2313}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 135}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6040}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14534}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {4, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 202}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {21, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 239}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x3, 0xc3, 0x87, 0xd4, 0x63, 0xde, 0x46, 0xe0, 0xbc, 0xca, 0xef, 0xb9, 0x8f, 0xec, 0xb0, 0x5b, 0xf3, 0x34};
  uint8_t byteswillprops1[] = {0x68, 0x25, 0x6b, 0xa1, 0xc9, 0xbf};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 166}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22816}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 84}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18479}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 132}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 202}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 19}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 2534}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 129}},
  };

  lwmqtt_properties_t willprops = {12, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xf1, 0x35, 0xb4, 0xeb, 0x85, 0x3d, 0x87, 0xe0};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x2b, 0x72, 0x9c, 0xfa, 0x33, 0xa4, 0x8a, 0xa, 0x70, 0x6a, 0xf5, 0x3d, 0xee, 0xb6, 0x4e, 0x5e, 0xd, 0x61, 0x97, 0xa1};
  lwmqtt_string_t will_payload = {20, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 4733;
  uint8_t client_id_bytes[] = {0xb, 0x3, 0x2c, 0xcc, 0x62, 0x8d, 0x88, 0x72, 0x21, 0x72, 0x13, 0x61, 0x2d, 0x8a, 0xf9, 0x4d, 0x37, 0x7, 0x66, 0x67, 0x4, 0x8b, 0xe4, 0x57};
  lwmqtt_string_t client_id = {24, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x41, 0x3b, 0xa8, 0xe0, 0xf0, 0xed, 0x11, 0x1f, 0x60, 0x6b, 0xe4, 0x44, 0xc9, 0x20, 0xd3, 0x76, 0x45, 0x2e, 0xcb, 0x2, 0x26};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xe5, 0x16, 0xec, 0xfc, 0x6a, 0x72, 0x6a, 0xf6, 0x10, 0x3d, 0x78};
  lwmqtt_string_t password = {11, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\172\&0m\236P\216\191\220\208y\146\237\159\163\244Q\136\214\218\197\202\DC3(d\vm\142\GSO\DC3", _password = Just "\EM\a\ACKM\203i\200\227NY:", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\170\n\217\SO\CANI8\208\NAK", _willMsg = "", _willProps = [PropSharedSubscriptionAvailable 53,PropReasonString "\232\182\US_9\185\154\139\t\185\&9\187\225E*cC",PropResponseInformation "\206\DC4\SOH\251\&1M\232\134\129\145\251\t(",PropWildcardSubscriptionAvailable 94,PropSubscriptionIdentifier 11,PropWillDelayInterval 8513,PropSubscriptionIdentifierAvailable 166,PropRequestProblemInformation 92,PropMaximumQoS 16,PropSessionExpiryInterval 13745,PropServerReference "\182X\129:>\131\222\176vsk\255^\188\216\253\247X\142@\197\226u\164\NUL",PropServerKeepAlive 18267,PropResponseInformation "\132s\v\135\131\227\&9o;O\207,\129Al\241!u\222",PropTopicAlias 19785,PropUserProperty "\FS\177\SI-'\152\174\245\n\130\207\229\r\222 c4\188\196#" "\176o\253\216\DC4MT\140\NAK\129:\GS\146\\}`\n("]}), _cleanSession = True, _keepAlive = 25021, _connID = "h\216P$\178\190\228\190\138\FS", _properties = [PropMaximumQoS 85,PropReasonString "\205\229\152m\250\252hu\EOTu\135\230BP\199H\202)\220\RS\164\200\221\DC4",PropResponseTopic "<\212\221Um\DEL\133L8*\144\205\232\197w\231o\161\181\STX\208\232\SOH",PropSessionExpiryInterval 13715,PropMaximumQoS 51]}
TEST(Connect5QCTest, Encode16) {
uint8_t pkt[] = {0x10, 0xae, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xd6, 0x61, 0xbd, 0x3e, 0x24, 0x55, 0x1f, 0x0, 0x18, 0xcd, 0xe5, 0x98, 0x6d, 0xfa, 0xfc, 0x68, 0x75, 0x4, 0x75, 0x87, 0xe6, 0x42, 0x50, 0xc7, 0x48, 0xca, 0x29, 0xdc, 0x1e, 0xa4, 0xc8, 0xdd, 0x14, 0x8, 0x0, 0x17, 0x3c, 0xd4, 0xdd, 0x55, 0x6d, 0x7f, 0x85, 0x4c, 0x38, 0x2a, 0x90, 0xcd, 0xe8, 0xc5, 0x77, 0xe7, 0x6f, 0xa1, 0xb5, 0x2, 0xd0, 0xe8, 0x1, 0x11, 0x0, 0x0, 0x35, 0x93, 0x24, 0x33, 0x0, 0xa, 0x68, 0xd8, 0x50, 0x24, 0xb2, 0xbe, 0xe4, 0xbe, 0x8a, 0x1c, 0x9d, 0x1, 0x2a, 0x35, 0x1f, 0x0, 0x11, 0xe8, 0xb6, 0x1f, 0x5f, 0x39, 0xb9, 0x9a, 0x8b, 0x9, 0xb9, 0x39, 0xbb, 0xe1, 0x45, 0x2a, 0x63, 0x43, 0x1a, 0x0, 0xd, 0xce, 0x14, 0x1, 0xfb, 0x31, 0x4d, 0xe8, 0x86, 0x81, 0x91, 0xfb, 0x9, 0x28, 0x28, 0x5e, 0xb, 0xb, 0x18, 0x0, 0x0, 0x21, 0x41, 0x29, 0xa6, 0x17, 0x5c, 0x24, 0x10, 0x11, 0x0, 0x0, 0x35, 0xb1, 0x1c, 0x0, 0x19, 0xb6, 0x58, 0x81, 0x3a, 0x3e, 0x83, 0xde, 0xb0, 0x76, 0x73, 0x6b, 0xff, 0x5e, 0xbc, 0xd8, 0xfd, 0xf7, 0x58, 0x8e, 0x40, 0xc5, 0xe2, 0x75, 0xa4, 0x0, 0x13, 0x47, 0x5b, 0x1a, 0x0, 0x13, 0x84, 0x73, 0xb, 0x87, 0x83, 0xe3, 0x39, 0x6f, 0x3b, 0x4f, 0xcf, 0x2c, 0x81, 0x41, 0x6c, 0xf1, 0x21, 0x75, 0xde, 0x23, 0x4d, 0x49, 0x26, 0x0, 0x14, 0x1c, 0xb1, 0xf, 0x2d, 0x27, 0x98, 0xae, 0xf5, 0xa, 0x82, 0xcf, 0xe5, 0xd, 0xde, 0x20, 0x63, 0x34, 0xbc, 0xc4, 0x23, 0x0, 0x12, 0xb0, 0x6f, 0xfd, 0xd8, 0x14, 0x4d, 0x54, 0x8c, 0x15, 0x81, 0x3a, 0x1d, 0x92, 0x5c, 0x7d, 0x60, 0xa, 0x28, 0x0, 0x9, 0xaa, 0xa, 0xd9, 0xe, 0x18, 0x49, 0x38, 0xd0, 0x15, 0x0, 0x0, 0x0, 0x1e, 0xac, 0x30, 0x6d, 0xec, 0x50, 0xd8, 0xbf, 0xdc, 0xd0, 0x79, 0x92, 0xed, 0x9f, 0xa3, 0xf4, 0x51, 0x88, 0xd6, 0xda, 0xc5, 0xca, 0x13, 0x28, 0x64, 0xb, 0x6d, 0x8e, 0x1d, 0x4f, 0x13, 0x0, 0xb, 0x19, 0x7, 0x6, 0x4d, 0xcb, 0x69, 0xc8, 0xe3, 0x4e, 0x59, 0x3a};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xcd, 0xe5, 0x98, 0x6d, 0xfa, 0xfc, 0x68, 0x75, 0x4, 0x75, 0x87, 0xe6, 0x42, 0x50, 0xc7, 0x48, 0xca, 0x29, 0xdc, 0x1e, 0xa4, 0xc8, 0xdd, 0x14};
  uint8_t bytesprops1[] = {0x3c, 0xd4, 0xdd, 0x55, 0x6d, 0x7f, 0x85, 0x4c, 0x38, 0x2a, 0x90, 0xcd, 0xe8, 0xc5, 0x77, 0xe7, 0x6f, 0xa1, 0xb5, 0x2, 0xd0, 0xe8, 0x1};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 13715}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 51}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe8, 0xb6, 0x1f, 0x5f, 0x39, 0xb9, 0x9a, 0x8b, 0x9, 0xb9, 0x39, 0xbb, 0xe1, 0x45, 0x2a, 0x63, 0x43};
  uint8_t byteswillprops1[] = {0xce, 0x14, 0x1, 0xfb, 0x31, 0x4d, 0xe8, 0x86, 0x81, 0x91, 0xfb, 0x9, 0x28};
  uint8_t byteswillprops2[] = {0xb6, 0x58, 0x81, 0x3a, 0x3e, 0x83, 0xde, 0xb0, 0x76, 0x73, 0x6b, 0xff, 0x5e, 0xbc, 0xd8, 0xfd, 0xf7, 0x58, 0x8e, 0x40, 0xc5, 0xe2, 0x75, 0xa4, 0x0};
  uint8_t byteswillprops3[] = {0x84, 0x73, 0xb, 0x87, 0x83, 0xe3, 0x39, 0x6f, 0x3b, 0x4f, 0xcf, 0x2c, 0x81, 0x41, 0x6c, 0xf1, 0x21, 0x75, 0xde};
  uint8_t byteswillprops5[] = {0xb0, 0x6f, 0xfd, 0xd8, 0x14, 0x4d, 0x54, 0x8c, 0x15, 0x81, 0x3a, 0x1d, 0x92, 0x5c, 0x7d, 0x60, 0xa, 0x28};
  uint8_t byteswillprops4[] = {0x1c, 0xb1, 0xf, 0x2d, 0x27, 0x98, 0xae, 0xf5, 0xa, 0x82, 0xcf, 0xe5, 0xd, 0xde, 0x20, 0x63, 0x34, 0xbc, 0xc4, 0x23};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 53}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {17, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 94}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 11}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8513}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 166}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 92}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 16}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 13745}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 18267}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {19, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 19785}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={20, (char*)&byteswillprops4}, .v={18, (char*)&byteswillprops5}}}},
  };

  lwmqtt_properties_t willprops = {15, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xaa, 0xa, 0xd9, 0xe, 0x18, 0x49, 0x38, 0xd0, 0x15};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0};
  lwmqtt_string_t will_payload = {0, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 25021;
  uint8_t client_id_bytes[] = {0x68, 0xd8, 0x50, 0x24, 0xb2, 0xbe, 0xe4, 0xbe, 0x8a, 0x1c};
  lwmqtt_string_t client_id = {10, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xac, 0x30, 0x6d, 0xec, 0x50, 0xd8, 0xbf, 0xdc, 0xd0, 0x79, 0x92, 0xed, 0x9f, 0xa3, 0xf4, 0x51, 0x88, 0xd6, 0xda, 0xc5, 0xca, 0x13, 0x28, 0x64, 0xb, 0x6d, 0x8e, 0x1d, 0x4f, 0x13};
  lwmqtt_string_t username = {30, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x19, 0x7, 0x6, 0x4d, 0xcb, 0x69, 0xc8, 0xe3, 0x4e, 0x59, 0x3a};
  lwmqtt_string_t password = {11, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "-\\\US\191>B\216\175\176\r\209#\187\163", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = ",R\166,\231d\190T\\4\f\152s\ENQ\214\188\159\242\200\STX\212yX\237", _willMsg = "G\242R!yU\157\129c\166", _willProps = [PropAuthenticationData "\EMK\SOH\DC3\202\&3\154\145\145^\221\f+\134-\174\249t\214",PropResponseInformation "\252\FS*,m\EM\159fX\226\175)",PropSessionExpiryInterval 99,PropTopicAlias 29786,PropResponseInformation "-$\190u\208\f\179\133+i+\172\213\227q\220\FS\157\217~\162\DC2\194U\238\&9\bl\174/",PropPayloadFormatIndicator 186,PropContentType "6V\EM\155.\151@,\150\172\218\CANpA\129\DEL",PropResponseInformation "\DC2j\193\r9\225\SUB\151\242\182\&6\211\158\237\194Q\142\&8r\194\255\167\166\RS\219\245XZg\215",PropAuthenticationMethod "x",PropMessageExpiryInterval 8608,PropResponseTopic "a\ACK\168\EM\218\\u\STXQ\226\SI,AO\158_!\ENQ\203",PropSubscriptionIdentifierAvailable 157,PropMaximumQoS 60,PropServerKeepAlive 20958,PropSharedSubscriptionAvailable 131,PropUserProperty "\215\&7\250\fS-\SI" "\227\249\215\206\205h\143\132\&0O5\247(\197\168\128{x",PropReceiveMaximum 19818,PropAuthenticationMethod "\v\184\&1\136R\164\245\208z\143\214\143#\252\159\129\221*I\189\150",PropTopicAlias 17514,PropAuthenticationData "\150\200\nX.\180yZV`\220\154",PropResponseInformation "\215"]}), _cleanSession = True, _keepAlive = 13547, _connID = "r\251\173\&4c\162{\179\188\SO\213\162/\US\158ej\186\DC43\174\157\&4(u\213\US\164E", _properties = [PropAuthenticationData "\DC4\195\a\137\252\139\139\170",PropTopicAliasMaximum 20467,PropServerReference "~\210v\151\253ca\DLEz>\173\193\244\237\189\150\a\224 \ACK",PropTopicAlias 7863,PropSubscriptionIdentifier 19,PropPayloadFormatIndicator 248,PropRequestResponseInformation 182,PropResponseTopic "\236\131T7\252\&7\DC4\r\219\153\DC4jD\246\vr\224\158\229\248\136L?\187wL\167",PropPayloadFormatIndicator 88,PropMaximumPacketSize 32441]}
TEST(Connect5QCTest, Encode17) {
uint8_t pkt[] = {0x10, 0xb0, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xb6, 0x34, 0xeb, 0x53, 0x16, 0x0, 0x8, 0x14, 0xc3, 0x7, 0x89, 0xfc, 0x8b, 0x8b, 0xaa, 0x22, 0x4f, 0xf3, 0x1c, 0x0, 0x14, 0x7e, 0xd2, 0x76, 0x97, 0xfd, 0x63, 0x61, 0x10, 0x7a, 0x3e, 0xad, 0xc1, 0xf4, 0xed, 0xbd, 0x96, 0x7, 0xe0, 0x20, 0x6, 0x23, 0x1e, 0xb7, 0xb, 0x13, 0x1, 0xf8, 0x19, 0xb6, 0x8, 0x0, 0x1b, 0xec, 0x83, 0x54, 0x37, 0xfc, 0x37, 0x14, 0xd, 0xdb, 0x99, 0x14, 0x6a, 0x44, 0xf6, 0xb, 0x72, 0xe0, 0x9e, 0xe5, 0xf8, 0x88, 0x4c, 0x3f, 0xbb, 0x77, 0x4c, 0xa7, 0x1, 0x58, 0x27, 0x0, 0x0, 0x7e, 0xb9, 0x0, 0x1d, 0x72, 0xfb, 0xad, 0x34, 0x63, 0xa2, 0x7b, 0xb3, 0xbc, 0xe, 0xd5, 0xa2, 0x2f, 0x1f, 0x9e, 0x65, 0x6a, 0xba, 0x14, 0x33, 0xae, 0x9d, 0x34, 0x28, 0x75, 0xd5, 0x1f, 0xa4, 0x45, 0xfb, 0x1, 0x16, 0x0, 0x13, 0x19, 0x4b, 0x1, 0x13, 0xca, 0x33, 0x9a, 0x91, 0x91, 0x5e, 0xdd, 0xc, 0x2b, 0x86, 0x2d, 0xae, 0xf9, 0x74, 0xd6, 0x1a, 0x0, 0xc, 0xfc, 0x1c, 0x2a, 0x2c, 0x6d, 0x19, 0x9f, 0x66, 0x58, 0xe2, 0xaf, 0x29, 0x11, 0x0, 0x0, 0x0, 0x63, 0x23, 0x74, 0x5a, 0x1a, 0x0, 0x1e, 0x2d, 0x24, 0xbe, 0x75, 0xd0, 0xc, 0xb3, 0x85, 0x2b, 0x69, 0x2b, 0xac, 0xd5, 0xe3, 0x71, 0xdc, 0x1c, 0x9d, 0xd9, 0x7e, 0xa2, 0x12, 0xc2, 0x55, 0xee, 0x39, 0x8, 0x6c, 0xae, 0x2f, 0x1, 0xba, 0x3, 0x0, 0x10, 0x36, 0x56, 0x19, 0x9b, 0x2e, 0x97, 0x40, 0x2c, 0x96, 0xac, 0xda, 0x18, 0x70, 0x41, 0x81, 0x7f, 0x1a, 0x0, 0x1e, 0x12, 0x6a, 0xc1, 0xd, 0x39, 0xe1, 0x1a, 0x97, 0xf2, 0xb6, 0x36, 0xd3, 0x9e, 0xed, 0xc2, 0x51, 0x8e, 0x38, 0x72, 0xc2, 0xff, 0xa7, 0xa6, 0x1e, 0xdb, 0xf5, 0x58, 0x5a, 0x67, 0xd7, 0x15, 0x0, 0x1, 0x78, 0x2, 0x0, 0x0, 0x21, 0xa0, 0x8, 0x0, 0x13, 0x61, 0x6, 0xa8, 0x19, 0xda, 0x5c, 0x75, 0x2, 0x51, 0xe2, 0xf, 0x2c, 0x41, 0x4f, 0x9e, 0x5f, 0x21, 0x5, 0xcb, 0x29, 0x9d, 0x24, 0x3c, 0x13, 0x51, 0xde, 0x2a, 0x83, 0x26, 0x0, 0x7, 0xd7, 0x37, 0xfa, 0xc, 0x53, 0x2d, 0xf, 0x0, 0x12, 0xe3, 0xf9, 0xd7, 0xce, 0xcd, 0x68, 0x8f, 0x84, 0x30, 0x4f, 0x35, 0xf7, 0x28, 0xc5, 0xa8, 0x80, 0x7b, 0x78, 0x21, 0x4d, 0x6a, 0x15, 0x0, 0x15, 0xb, 0xb8, 0x31, 0x88, 0x52, 0xa4, 0xf5, 0xd0, 0x7a, 0x8f, 0xd6, 0x8f, 0x23, 0xfc, 0x9f, 0x81, 0xdd, 0x2a, 0x49, 0xbd, 0x96, 0x23, 0x44, 0x6a, 0x16, 0x0, 0xc, 0x96, 0xc8, 0xa, 0x58, 0x2e, 0xb4, 0x79, 0x5a, 0x56, 0x60, 0xdc, 0x9a, 0x1a, 0x0, 0x1, 0xd7, 0x0, 0x18, 0x2c, 0x52, 0xa6, 0x2c, 0xe7, 0x64, 0xbe, 0x54, 0x5c, 0x34, 0xc, 0x98, 0x73, 0x5, 0xd6, 0xbc, 0x9f, 0xf2, 0xc8, 0x2, 0xd4, 0x79, 0x58, 0xed, 0x0, 0xa, 0x47, 0xf2, 0x52, 0x21, 0x79, 0x55, 0x9d, 0x81, 0x63, 0xa6, 0x0, 0xe, 0x2d, 0x5c, 0x1f, 0xbf, 0x3e, 0x42, 0xd8, 0xaf, 0xb0, 0xd, 0xd1, 0x23, 0xbb, 0xa3};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x14, 0xc3, 0x7, 0x89, 0xfc, 0x8b, 0x8b, 0xaa};
  uint8_t bytesprops1[] = {0x7e, 0xd2, 0x76, 0x97, 0xfd, 0x63, 0x61, 0x10, 0x7a, 0x3e, 0xad, 0xc1, 0xf4, 0xed, 0xbd, 0x96, 0x7, 0xe0, 0x20, 0x6};
  uint8_t bytesprops2[] = {0xec, 0x83, 0x54, 0x37, 0xfc, 0x37, 0x14, 0xd, 0xdb, 0x99, 0x14, 0x6a, 0x44, 0xf6, 0xb, 0x72, 0xe0, 0x9e, 0xe5, 0xf8, 0x88, 0x4c, 0x3f, 0xbb, 0x77, 0x4c, 0xa7};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {8, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20467}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {20, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7863}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 19}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 248}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 182}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 88}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32441}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x19, 0x4b, 0x1, 0x13, 0xca, 0x33, 0x9a, 0x91, 0x91, 0x5e, 0xdd, 0xc, 0x2b, 0x86, 0x2d, 0xae, 0xf9, 0x74, 0xd6};
  uint8_t byteswillprops1[] = {0xfc, 0x1c, 0x2a, 0x2c, 0x6d, 0x19, 0x9f, 0x66, 0x58, 0xe2, 0xaf, 0x29};
  uint8_t byteswillprops2[] = {0x2d, 0x24, 0xbe, 0x75, 0xd0, 0xc, 0xb3, 0x85, 0x2b, 0x69, 0x2b, 0xac, 0xd5, 0xe3, 0x71, 0xdc, 0x1c, 0x9d, 0xd9, 0x7e, 0xa2, 0x12, 0xc2, 0x55, 0xee, 0x39, 0x8, 0x6c, 0xae, 0x2f};
  uint8_t byteswillprops3[] = {0x36, 0x56, 0x19, 0x9b, 0x2e, 0x97, 0x40, 0x2c, 0x96, 0xac, 0xda, 0x18, 0x70, 0x41, 0x81, 0x7f};
  uint8_t byteswillprops4[] = {0x12, 0x6a, 0xc1, 0xd, 0x39, 0xe1, 0x1a, 0x97, 0xf2, 0xb6, 0x36, 0xd3, 0x9e, 0xed, 0xc2, 0x51, 0x8e, 0x38, 0x72, 0xc2, 0xff, 0xa7, 0xa6, 0x1e, 0xdb, 0xf5, 0x58, 0x5a, 0x67, 0xd7};
  uint8_t byteswillprops5[] = {0x78};
  uint8_t byteswillprops6[] = {0x61, 0x6, 0xa8, 0x19, 0xda, 0x5c, 0x75, 0x2, 0x51, 0xe2, 0xf, 0x2c, 0x41, 0x4f, 0x9e, 0x5f, 0x21, 0x5, 0xcb};
  uint8_t byteswillprops8[] = {0xe3, 0xf9, 0xd7, 0xce, 0xcd, 0x68, 0x8f, 0x84, 0x30, 0x4f, 0x35, 0xf7, 0x28, 0xc5, 0xa8, 0x80, 0x7b, 0x78};
  uint8_t byteswillprops7[] = {0xd7, 0x37, 0xfa, 0xc, 0x53, 0x2d, 0xf};
  uint8_t byteswillprops9[] = {0xb, 0xb8, 0x31, 0x88, 0x52, 0xa4, 0xf5, 0xd0, 0x7a, 0x8f, 0xd6, 0x8f, 0x23, 0xfc, 0x9f, 0x81, 0xdd, 0x2a, 0x49, 0xbd, 0x96};
  uint8_t byteswillprops10[] = {0x96, 0xc8, 0xa, 0x58, 0x2e, 0xb4, 0x79, 0x5a, 0x56, 0x60, 0xdc, 0x9a};
  uint8_t byteswillprops11[] = {0xd7};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {12, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 99}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29786}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 186}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {16, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {1, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8608}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 157}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 60}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20958}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 131}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={7, (char*)&byteswillprops7}, .v={18, (char*)&byteswillprops8}}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19818}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&byteswillprops9}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 17514}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&byteswillprops10}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&byteswillprops11}}},
  };

  lwmqtt_properties_t willprops = {21, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x2c, 0x52, 0xa6, 0x2c, 0xe7, 0x64, 0xbe, 0x54, 0x5c, 0x34, 0xc, 0x98, 0x73, 0x5, 0xd6, 0xbc, 0x9f, 0xf2, 0xc8, 0x2, 0xd4, 0x79, 0x58, 0xed};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x47, 0xf2, 0x52, 0x21, 0x79, 0x55, 0x9d, 0x81, 0x63, 0xa6};
  lwmqtt_string_t will_payload = {10, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 13547;
  uint8_t client_id_bytes[] = {0x72, 0xfb, 0xad, 0x34, 0x63, 0xa2, 0x7b, 0xb3, 0xbc, 0xe, 0xd5, 0xa2, 0x2f, 0x1f, 0x9e, 0x65, 0x6a, 0xba, 0x14, 0x33, 0xae, 0x9d, 0x34, 0x28, 0x75, 0xd5, 0x1f, 0xa4, 0x45};
  lwmqtt_string_t client_id = {29, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x2d, 0x5c, 0x1f, 0xbf, 0x3e, 0x42, 0xd8, 0xaf, 0xb0, 0xd, 0xd1, 0x23, 0xbb, 0xa3};
  lwmqtt_string_t username = {14, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\232g\222\&1\254\EM\195}\FS\159h\255\DC4J\131:\250\139\243\245L\SYN\132\237\145\218l\149\147D", _password = Just "\216\SYN", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\RScg\195\250\136\246\225\255\166Lm\165\206\183\159", _willMsg = "\222\238\244.\139OJ", _willProps = [PropAuthenticationMethod "\226\222\ENQ\183\159\153{\172",PropMessageExpiryInterval 27045,PropServerReference "\EM\215\133",PropWillDelayInterval 27246,PropRequestResponseInformation 32,PropMaximumPacketSize 5739,PropContentType "\ETB\200\133}\199\192\185\154\215\189zH\208\200\148\DLEef",PropSubscriptionIdentifierAvailable 126,PropWillDelayInterval 27782,PropAssignedClientIdentifier "\SUB\200\204\249\153\NAK\208\160&\DC2|\t{I\220}\174",PropWillDelayInterval 2942,PropServerReference "|\137f\208\164Y"]}), _cleanSession = True, _keepAlive = 24226, _connID = "\171!\155o/ F\SO\201\168\DLE~\DC4*", _properties = [PropSharedSubscriptionAvailable 193,PropServerReference "|>\135\195Ne\DC4\rZ\195\149\\M+\222\229\233Z\205\250!\166\203\ENQ;H\163\237\160\193",PropReasonString "",PropServerKeepAlive 13435,PropResponseInformation "G^|\US,",PropRequestResponseInformation 100,PropMessageExpiryInterval 16479,PropMaximumQoS 141,PropSharedSubscriptionAvailable 7,PropResponseInformation "%",PropAssignedClientIdentifier "G\143e\243\ENQ\140v\130\184\GS\166ZP\165\167\ETX",PropMaximumPacketSize 4489,PropAssignedClientIdentifier "\SOH{8\SI\SOH\145\198\189\n",PropUserProperty "\FS\a(\221\vhE\SYN\171\203\&6w\130\RS<" "\ETX\205\187\187\219\&8\159$\153\DC20^\253u\198\149\176\DLE\203I&\241\250\197\171\176",PropReasonString "\223\227\225",PropSessionExpiryInterval 2978,PropUserProperty "\226\225\229\235\CANlF\139\194\129\218uo" "\SI\197t\226\173m^#\217*+\141\153\236\GS\185/\166\242&\167d\152,\216\a\245\231\&2",PropWillDelayInterval 21460,PropContentType "[h",PropMessageExpiryInterval 21321,PropWillDelayInterval 26395,PropPayloadFormatIndicator 242,PropContentType "\RS`"]}
TEST(Connect5QCTest, Encode18) {
uint8_t pkt[] = {0x10, 0xa3, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xd6, 0x5e, 0xa2, 0xe7, 0x1, 0x2a, 0xc1, 0x1c, 0x0, 0x1e, 0x7c, 0x3e, 0x87, 0xc3, 0x4e, 0x65, 0x14, 0xd, 0x5a, 0xc3, 0x95, 0x5c, 0x4d, 0x2b, 0xde, 0xe5, 0xe9, 0x5a, 0xcd, 0xfa, 0x21, 0xa6, 0xcb, 0x5, 0x3b, 0x48, 0xa3, 0xed, 0xa0, 0xc1, 0x1f, 0x0, 0x0, 0x13, 0x34, 0x7b, 0x1a, 0x0, 0x5, 0x47, 0x5e, 0x7c, 0x1f, 0x2c, 0x19, 0x64, 0x2, 0x0, 0x0, 0x40, 0x5f, 0x24, 0x8d, 0x2a, 0x7, 0x1a, 0x0, 0x1, 0x25, 0x12, 0x0, 0x10, 0x47, 0x8f, 0x65, 0xf3, 0x5, 0x8c, 0x76, 0x82, 0xb8, 0x1d, 0xa6, 0x5a, 0x50, 0xa5, 0xa7, 0x3, 0x27, 0x0, 0x0, 0x11, 0x89, 0x12, 0x0, 0x9, 0x1, 0x7b, 0x38, 0xf, 0x1, 0x91, 0xc6, 0xbd, 0xa, 0x26, 0x0, 0xf, 0x1c, 0x7, 0x28, 0xdd, 0xb, 0x68, 0x45, 0x16, 0xab, 0xcb, 0x36, 0x77, 0x82, 0x1e, 0x3c, 0x0, 0x1a, 0x3, 0xcd, 0xbb, 0xbb, 0xdb, 0x38, 0x9f, 0x24, 0x99, 0x12, 0x30, 0x5e, 0xfd, 0x75, 0xc6, 0x95, 0xb0, 0x10, 0xcb, 0x49, 0x26, 0xf1, 0xfa, 0xc5, 0xab, 0xb0, 0x1f, 0x0, 0x3, 0xdf, 0xe3, 0xe1, 0x11, 0x0, 0x0, 0xb, 0xa2, 0x26, 0x0, 0xd, 0xe2, 0xe1, 0xe5, 0xeb, 0x18, 0x6c, 0x46, 0x8b, 0xc2, 0x81, 0xda, 0x75, 0x6f, 0x0, 0x1d, 0xf, 0xc5, 0x74, 0xe2, 0xad, 0x6d, 0x5e, 0x23, 0xd9, 0x2a, 0x2b, 0x8d, 0x99, 0xec, 0x1d, 0xb9, 0x2f, 0xa6, 0xf2, 0x26, 0xa7, 0x64, 0x98, 0x2c, 0xd8, 0x7, 0xf5, 0xe7, 0x32, 0x18, 0x0, 0x0, 0x53, 0xd4, 0x3, 0x0, 0x2, 0x5b, 0x68, 0x2, 0x0, 0x0, 0x53, 0x49, 0x18, 0x0, 0x0, 0x67, 0x1b, 0x1, 0xf2, 0x3, 0x0, 0x2, 0x1e, 0x60, 0x0, 0xe, 0xab, 0x21, 0x9b, 0x6f, 0x2f, 0x20, 0x46, 0xe, 0xc9, 0xa8, 0x10, 0x7e, 0x14, 0x2a, 0x60, 0x15, 0x0, 0x8, 0xe2, 0xde, 0x5, 0xb7, 0x9f, 0x99, 0x7b, 0xac, 0x2, 0x0, 0x0, 0x69, 0xa5, 0x1c, 0x0, 0x3, 0x19, 0xd7, 0x85, 0x18, 0x0, 0x0, 0x6a, 0x6e, 0x19, 0x20, 0x27, 0x0, 0x0, 0x16, 0x6b, 0x3, 0x0, 0x12, 0x17, 0xc8, 0x85, 0x7d, 0xc7, 0xc0, 0xb9, 0x9a, 0xd7, 0xbd, 0x7a, 0x48, 0xd0, 0xc8, 0x94, 0x10, 0x65, 0x66, 0x29, 0x7e, 0x18, 0x0, 0x0, 0x6c, 0x86, 0x12, 0x0, 0x11, 0x1a, 0xc8, 0xcc, 0xf9, 0x99, 0x15, 0xd0, 0xa0, 0x26, 0x12, 0x7c, 0x9, 0x7b, 0x49, 0xdc, 0x7d, 0xae, 0x18, 0x0, 0x0, 0xb, 0x7e, 0x1c, 0x0, 0x6, 0x7c, 0x89, 0x66, 0xd0, 0xa4, 0x59, 0x0, 0x10, 0x1e, 0x63, 0x67, 0xc3, 0xfa, 0x88, 0xf6, 0xe1, 0xff, 0xa6, 0x4c, 0x6d, 0xa5, 0xce, 0xb7, 0x9f, 0x0, 0x7, 0xde, 0xee, 0xf4, 0x2e, 0x8b, 0x4f, 0x4a, 0x0, 0x1e, 0xe8, 0x67, 0xde, 0x31, 0xfe, 0x19, 0xc3, 0x7d, 0x1c, 0x9f, 0x68, 0xff, 0x14, 0x4a, 0x83, 0x3a, 0xfa, 0x8b, 0xf3, 0xf5, 0x4c, 0x16, 0x84, 0xed, 0x91, 0xda, 0x6c, 0x95, 0x93, 0x44, 0x0, 0x2, 0xd8, 0x16};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x7c, 0x3e, 0x87, 0xc3, 0x4e, 0x65, 0x14, 0xd, 0x5a, 0xc3, 0x95, 0x5c, 0x4d, 0x2b, 0xde, 0xe5, 0xe9, 0x5a, 0xcd, 0xfa, 0x21, 0xa6, 0xcb, 0x5, 0x3b, 0x48, 0xa3, 0xed, 0xa0, 0xc1};
  uint8_t bytesprops1[] = {0};
  uint8_t bytesprops2[] = {0x47, 0x5e, 0x7c, 0x1f, 0x2c};
  uint8_t bytesprops3[] = {0x25};
  uint8_t bytesprops4[] = {0x47, 0x8f, 0x65, 0xf3, 0x5, 0x8c, 0x76, 0x82, 0xb8, 0x1d, 0xa6, 0x5a, 0x50, 0xa5, 0xa7, 0x3};
  uint8_t bytesprops5[] = {0x1, 0x7b, 0x38, 0xf, 0x1, 0x91, 0xc6, 0xbd, 0xa};
  uint8_t bytesprops7[] = {0x3, 0xcd, 0xbb, 0xbb, 0xdb, 0x38, 0x9f, 0x24, 0x99, 0x12, 0x30, 0x5e, 0xfd, 0x75, 0xc6, 0x95, 0xb0, 0x10, 0xcb, 0x49, 0x26, 0xf1, 0xfa, 0xc5, 0xab, 0xb0};
  uint8_t bytesprops6[] = {0x1c, 0x7, 0x28, 0xdd, 0xb, 0x68, 0x45, 0x16, 0xab, 0xcb, 0x36, 0x77, 0x82, 0x1e, 0x3c};
  uint8_t bytesprops8[] = {0xdf, 0xe3, 0xe1};
  uint8_t bytesprops10[] = {0xf, 0xc5, 0x74, 0xe2, 0xad, 0x6d, 0x5e, 0x23, 0xd9, 0x2a, 0x2b, 0x8d, 0x99, 0xec, 0x1d, 0xb9, 0x2f, 0xa6, 0xf2, 0x26, 0xa7, 0x64, 0x98, 0x2c, 0xd8, 0x7, 0xf5, 0xe7, 0x32};
  uint8_t bytesprops9[] = {0xe2, 0xe1, 0xe5, 0xeb, 0x18, 0x6c, 0x46, 0x8b, 0xc2, 0x81, 0xda, 0x75, 0x6f};
  uint8_t bytesprops11[] = {0x5b, 0x68};
  uint8_t bytesprops12[] = {0x1e, 0x60};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 193}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {0, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13435}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {5, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16479}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 7}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {1, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4489}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {9, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={15, (char*)&bytesprops6}, .v={26, (char*)&bytesprops7}}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 2978}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={13, (char*)&bytesprops9}, .v={29, (char*)&bytesprops10}}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21460}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21321}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26395}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 242}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops12}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe2, 0xde, 0x5, 0xb7, 0x9f, 0x99, 0x7b, 0xac};
  uint8_t byteswillprops1[] = {0x19, 0xd7, 0x85};
  uint8_t byteswillprops2[] = {0x17, 0xc8, 0x85, 0x7d, 0xc7, 0xc0, 0xb9, 0x9a, 0xd7, 0xbd, 0x7a, 0x48, 0xd0, 0xc8, 0x94, 0x10, 0x65, 0x66};
  uint8_t byteswillprops3[] = {0x1a, 0xc8, 0xcc, 0xf9, 0x99, 0x15, 0xd0, 0xa0, 0x26, 0x12, 0x7c, 0x9, 0x7b, 0x49, 0xdc, 0x7d, 0xae};
  uint8_t byteswillprops4[] = {0x7c, 0x89, 0x66, 0xd0, 0xa4, 0x59};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27045}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 27246}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 32}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 5739}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 126}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 27782}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 2942}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&byteswillprops4}}},
  };

  lwmqtt_properties_t willprops = {12, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x1e, 0x63, 0x67, 0xc3, 0xfa, 0x88, 0xf6, 0xe1, 0xff, 0xa6, 0x4c, 0x6d, 0xa5, 0xce, 0xb7, 0x9f};
  lwmqtt_string_t will_topic = {16, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xde, 0xee, 0xf4, 0x2e, 0x8b, 0x4f, 0x4a};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 24226;
  uint8_t client_id_bytes[] = {0xab, 0x21, 0x9b, 0x6f, 0x2f, 0x20, 0x46, 0xe, 0xc9, 0xa8, 0x10, 0x7e, 0x14, 0x2a};
  lwmqtt_string_t client_id = {14, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xe8, 0x67, 0xde, 0x31, 0xfe, 0x19, 0xc3, 0x7d, 0x1c, 0x9f, 0x68, 0xff, 0x14, 0x4a, 0x83, 0x3a, 0xfa, 0x8b, 0xf3, 0xf5, 0x4c, 0x16, 0x84, 0xed, 0x91, 0xda, 0x6c, 0x95, 0x93, 0x44};
  lwmqtt_string_t username = {30, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xd8, 0x16};
  lwmqtt_string_t password = {2, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "'\216\163|\221m\165\171\236!\179M84\232bZ\149\154\234\158", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\184\185\180\202\170\173g\tsp\221\170\169{\210\160\247\SOH\tG\158N5", _willMsg = "\\\RS/%&ik\DC2\234\228\US\198.*o\190$\DC1\234\187\154\212\129", _willProps = [PropMessageExpiryInterval 13124,PropSharedSubscriptionAvailable 96,PropServerKeepAlive 28528,PropRequestProblemInformation 20,PropTopicAliasMaximum 15600,PropRequestProblemInformation 130,PropRequestProblemInformation 69,PropAuthenticationData "QMO\210\152\135d\221Rk\200\241\164\230\252\179L\t%^\223\&0\240\201\n\180\209\ACK\196\191",PropMaximumQoS 38,PropWillDelayInterval 26473,PropServerKeepAlive 30083,PropResponseInformation "b\183\173\146\223d\203Gv\180\a\SI\254\SOHS",PropServerKeepAlive 29179,PropReasonString ",\173\232\203\190\DC4\138\244\162\&7\r\189\206",PropTopicAliasMaximum 17148,PropSubscriptionIdentifier 0,PropWildcardSubscriptionAvailable 52,PropSharedSubscriptionAvailable 9,PropContentType "Yk\252k\SOHn\142T\173l'\202s;fp0\153",PropSessionExpiryInterval 25517,PropPayloadFormatIndicator 54,PropSessionExpiryInterval 8919,PropRequestResponseInformation 201,PropAuthenticationMethod ")\DC2\239\174$\181\&3\246@`\187\229h\235&(S\152\215\a\188\177o",PropRequestResponseInformation 29,PropPayloadFormatIndicator 220,PropTopicAliasMaximum 28976]}), _cleanSession = False, _keepAlive = 10411, _connID = "V\EOTi\ETB\252n}!\239\188\234\&2;b\241\237$\230\184\167\154\163\NUL\206\175", _properties = [PropMessageExpiryInterval 4653,PropAuthenticationData "\ENQ\ESC}e\202\ACK\137J3$S\193J\212\226\SI5#\241",PropTopicAliasMaximum 6022,PropSharedSubscriptionAvailable 85,PropSubscriptionIdentifierAvailable 115,PropTopicAlias 6097,PropCorrelationData "#\205q\132\210k",PropReasonString "\ETX\183\132Ls\182\237\NULq\133\237\150\217\\\249",PropReasonString "\244~Qi\140\239\180\217PF\DC1%8u\159z\142\153\&9\186\202",PropUserProperty "a" "\227\166];6JQ]\225K\ETX\ACK\206\SUBv\250\171\238\169",PropMaximumPacketSize 12838,PropTopicAlias 30479,PropRequestResponseInformation 136,PropServerReference "\184\222\254\166\226M\154\133\134\RSKr\SOH\151\206jJ%p\SIz\188\211\222",PropPayloadFormatIndicator 93,PropRetainAvailable 101,PropMaximumQoS 51,PropAuthenticationMethod "z\US\215\164\243U\ESC\243\150\251\"\243-\196\245\DLE\203\SI\144\r",PropAssignedClientIdentifier "\170V\SO\242'\ETX2\GS\215\aN\133\184\ETXI\245\157\131\137\139\STX1\201\167\129\230\n\129",PropReasonString "#\v\167\201X=\229gs{",PropUserProperty "*]}\189\211<P|" "\CAN}\134\SI\147\247!\237\189\252\&7\159\&6\129\250R3F\f\133X\255\194\&1",PropCorrelationData "\204$\226\&6O\ACK\148\225\249\205\233\152\189",PropMaximumPacketSize 31683,PropSessionExpiryInterval 20378]}
TEST(Connect5QCTest, Encode19) {
uint8_t pkt[] = {0x10, 0xc0, 0x4, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xb4, 0x28, 0xab, 0x9e, 0x2, 0x2, 0x0, 0x0, 0x12, 0x2d, 0x16, 0x0, 0x13, 0x5, 0x1b, 0x7d, 0x65, 0xca, 0x6, 0x89, 0x4a, 0x33, 0x24, 0x53, 0xc1, 0x4a, 0xd4, 0xe2, 0xf, 0x35, 0x23, 0xf1, 0x22, 0x17, 0x86, 0x2a, 0x55, 0x29, 0x73, 0x23, 0x17, 0xd1, 0x9, 0x0, 0x6, 0x23, 0xcd, 0x71, 0x84, 0xd2, 0x6b, 0x1f, 0x0, 0xf, 0x3, 0xb7, 0x84, 0x4c, 0x73, 0xb6, 0xed, 0x0, 0x71, 0x85, 0xed, 0x96, 0xd9, 0x5c, 0xf9, 0x1f, 0x0, 0x15, 0xf4, 0x7e, 0x51, 0x69, 0x8c, 0xef, 0xb4, 0xd9, 0x50, 0x46, 0x11, 0x25, 0x38, 0x75, 0x9f, 0x7a, 0x8e, 0x99, 0x39, 0xba, 0xca, 0x26, 0x0, 0x1, 0x61, 0x0, 0x13, 0xe3, 0xa6, 0x5d, 0x3b, 0x36, 0x4a, 0x51, 0x5d, 0xe1, 0x4b, 0x3, 0x6, 0xce, 0x1a, 0x76, 0xfa, 0xab, 0xee, 0xa9, 0x27, 0x0, 0x0, 0x32, 0x26, 0x23, 0x77, 0xf, 0x19, 0x88, 0x1c, 0x0, 0x18, 0xb8, 0xde, 0xfe, 0xa6, 0xe2, 0x4d, 0x9a, 0x85, 0x86, 0x1e, 0x4b, 0x72, 0x1, 0x97, 0xce, 0x6a, 0x4a, 0x25, 0x70, 0xf, 0x7a, 0xbc, 0xd3, 0xde, 0x1, 0x5d, 0x25, 0x65, 0x24, 0x33, 0x15, 0x0, 0x14, 0x7a, 0x1f, 0xd7, 0xa4, 0xf3, 0x55, 0x1b, 0xf3, 0x96, 0xfb, 0x22, 0xf3, 0x2d, 0xc4, 0xf5, 0x10, 0xcb, 0xf, 0x90, 0xd, 0x12, 0x0, 0x1c, 0xaa, 0x56, 0xe, 0xf2, 0x27, 0x3, 0x32, 0x1d, 0xd7, 0x7, 0x4e, 0x85, 0xb8, 0x3, 0x49, 0xf5, 0x9d, 0x83, 0x89, 0x8b, 0x2, 0x31, 0xc9, 0xa7, 0x81, 0xe6, 0xa, 0x81, 0x1f, 0x0, 0xa, 0x23, 0xb, 0xa7, 0xc9, 0x58, 0x3d, 0xe5, 0x67, 0x73, 0x7b, 0x26, 0x0, 0x8, 0x2a, 0x5d, 0x7d, 0xbd, 0xd3, 0x3c, 0x50, 0x7c, 0x0, 0x18, 0x18, 0x7d, 0x86, 0xf, 0x93, 0xf7, 0x21, 0xed, 0xbd, 0xfc, 0x37, 0x9f, 0x36, 0x81, 0xfa, 0x52, 0x33, 0x46, 0xc, 0x85, 0x58, 0xff, 0xc2, 0x31, 0x9, 0x0, 0xd, 0xcc, 0x24, 0xe2, 0x36, 0x4f, 0x6, 0x94, 0xe1, 0xf9, 0xcd, 0xe9, 0x98, 0xbd, 0x27, 0x0, 0x0, 0x7b, 0xc3, 0x11, 0x0, 0x0, 0x4f, 0x9a, 0x0, 0x19, 0x56, 0x4, 0x69, 0x17, 0xfc, 0x6e, 0x7d, 0x21, 0xef, 0xbc, 0xea, 0x32, 0x3b, 0x62, 0xf1, 0xed, 0x24, 0xe6, 0xb8, 0xa7, 0x9a, 0xa3, 0x0, 0xce, 0xaf, 0xb0, 0x1, 0x2, 0x0, 0x0, 0x33, 0x44, 0x2a, 0x60, 0x13, 0x6f, 0x70, 0x17, 0x14, 0x22, 0x3c, 0xf0, 0x17, 0x82, 0x17, 0x45, 0x16, 0x0, 0x1e, 0x51, 0x4d, 0x4f, 0xd2, 0x98, 0x87, 0x64, 0xdd, 0x52, 0x6b, 0xc8, 0xf1, 0xa4, 0xe6, 0xfc, 0xb3, 0x4c, 0x9, 0x25, 0x5e, 0xdf, 0x30, 0xf0, 0xc9, 0xa, 0xb4, 0xd1, 0x6, 0xc4, 0xbf, 0x24, 0x26, 0x18, 0x0, 0x0, 0x67, 0x69, 0x13, 0x75, 0x83, 0x1a, 0x0, 0xf, 0x62, 0xb7, 0xad, 0x92, 0xdf, 0x64, 0xcb, 0x47, 0x76, 0xb4, 0x7, 0xf, 0xfe, 0x1, 0x53, 0x13, 0x71, 0xfb, 0x1f, 0x0, 0xd, 0x2c, 0xad, 0xe8, 0xcb, 0xbe, 0x14, 0x8a, 0xf4, 0xa2, 0x37, 0xd, 0xbd, 0xce, 0x22, 0x42, 0xfc, 0xb, 0x0, 0x28, 0x34, 0x2a, 0x9, 0x3, 0x0, 0x12, 0x59, 0x6b, 0xfc, 0x6b, 0x1, 0x6e, 0x8e, 0x54, 0xad, 0x6c, 0x27, 0xca, 0x73, 0x3b, 0x66, 0x70, 0x30, 0x99, 0x11, 0x0, 0x0, 0x63, 0xad, 0x1, 0x36, 0x11, 0x0, 0x0, 0x22, 0xd7, 0x19, 0xc9, 0x15, 0x0, 0x17, 0x29, 0x12, 0xef, 0xae, 0x24, 0xb5, 0x33, 0xf6, 0x40, 0x60, 0xbb, 0xe5, 0x68, 0xeb, 0x26, 0x28, 0x53, 0x98, 0xd7, 0x7, 0xbc, 0xb1, 0x6f, 0x19, 0x1d, 0x1, 0xdc, 0x22, 0x71, 0x30, 0x0, 0x17, 0xb8, 0xb9, 0xb4, 0xca, 0xaa, 0xad, 0x67, 0x9, 0x73, 0x70, 0xdd, 0xaa, 0xa9, 0x7b, 0xd2, 0xa0, 0xf7, 0x1, 0x9, 0x47, 0x9e, 0x4e, 0x35, 0x0, 0x17, 0x5c, 0x1e, 0x2f, 0x25, 0x26, 0x69, 0x6b, 0x12, 0xea, 0xe4, 0x1f, 0xc6, 0x2e, 0x2a, 0x6f, 0xbe, 0x24, 0x11, 0xea, 0xbb, 0x9a, 0xd4, 0x81, 0x0, 0x15, 0x27, 0xd8, 0xa3, 0x7c, 0xdd, 0x6d, 0xa5, 0xab, 0xec, 0x21, 0xb3, 0x4d, 0x38, 0x34, 0xe8, 0x62, 0x5a, 0x95, 0x9a, 0xea, 0x9e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x5, 0x1b, 0x7d, 0x65, 0xca, 0x6, 0x89, 0x4a, 0x33, 0x24, 0x53, 0xc1, 0x4a, 0xd4, 0xe2, 0xf, 0x35, 0x23, 0xf1};
  uint8_t bytesprops1[] = {0x23, 0xcd, 0x71, 0x84, 0xd2, 0x6b};
  uint8_t bytesprops2[] = {0x3, 0xb7, 0x84, 0x4c, 0x73, 0xb6, 0xed, 0x0, 0x71, 0x85, 0xed, 0x96, 0xd9, 0x5c, 0xf9};
  uint8_t bytesprops3[] = {0xf4, 0x7e, 0x51, 0x69, 0x8c, 0xef, 0xb4, 0xd9, 0x50, 0x46, 0x11, 0x25, 0x38, 0x75, 0x9f, 0x7a, 0x8e, 0x99, 0x39, 0xba, 0xca};
  uint8_t bytesprops5[] = {0xe3, 0xa6, 0x5d, 0x3b, 0x36, 0x4a, 0x51, 0x5d, 0xe1, 0x4b, 0x3, 0x6, 0xce, 0x1a, 0x76, 0xfa, 0xab, 0xee, 0xa9};
  uint8_t bytesprops4[] = {0x61};
  uint8_t bytesprops6[] = {0xb8, 0xde, 0xfe, 0xa6, 0xe2, 0x4d, 0x9a, 0x85, 0x86, 0x1e, 0x4b, 0x72, 0x1, 0x97, 0xce, 0x6a, 0x4a, 0x25, 0x70, 0xf, 0x7a, 0xbc, 0xd3, 0xde};
  uint8_t bytesprops7[] = {0x7a, 0x1f, 0xd7, 0xa4, 0xf3, 0x55, 0x1b, 0xf3, 0x96, 0xfb, 0x22, 0xf3, 0x2d, 0xc4, 0xf5, 0x10, 0xcb, 0xf, 0x90, 0xd};
  uint8_t bytesprops8[] = {0xaa, 0x56, 0xe, 0xf2, 0x27, 0x3, 0x32, 0x1d, 0xd7, 0x7, 0x4e, 0x85, 0xb8, 0x3, 0x49, 0xf5, 0x9d, 0x83, 0x89, 0x8b, 0x2, 0x31, 0xc9, 0xa7, 0x81, 0xe6, 0xa, 0x81};
  uint8_t bytesprops9[] = {0x23, 0xb, 0xa7, 0xc9, 0x58, 0x3d, 0xe5, 0x67, 0x73, 0x7b};
  uint8_t bytesprops11[] = {0x18, 0x7d, 0x86, 0xf, 0x93, 0xf7, 0x21, 0xed, 0xbd, 0xfc, 0x37, 0x9f, 0x36, 0x81, 0xfa, 0x52, 0x33, 0x46, 0xc, 0x85, 0x58, 0xff, 0xc2, 0x31};
  uint8_t bytesprops10[] = {0x2a, 0x5d, 0x7d, 0xbd, 0xd3, 0x3c, 0x50, 0x7c};
  uint8_t bytesprops12[] = {0xcc, 0x24, 0xe2, 0x36, 0x4f, 0x6, 0x94, 0xe1, 0xf9, 0xcd, 0xe9, 0x98, 0xbd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4653}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6022}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 115}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6097}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {21, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={1, (char*)&bytesprops4}, .v={19, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 12838}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30479}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 136}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 93}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 101}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 51}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {28, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={8, (char*)&bytesprops10}, .v={24, (char*)&bytesprops11}}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31683}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 20378}},
  };

  lwmqtt_properties_t props = {24, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x51, 0x4d, 0x4f, 0xd2, 0x98, 0x87, 0x64, 0xdd, 0x52, 0x6b, 0xc8, 0xf1, 0xa4, 0xe6, 0xfc, 0xb3, 0x4c, 0x9, 0x25, 0x5e, 0xdf, 0x30, 0xf0, 0xc9, 0xa, 0xb4, 0xd1, 0x6, 0xc4, 0xbf};
  uint8_t byteswillprops1[] = {0x62, 0xb7, 0xad, 0x92, 0xdf, 0x64, 0xcb, 0x47, 0x76, 0xb4, 0x7, 0xf, 0xfe, 0x1, 0x53};
  uint8_t byteswillprops2[] = {0x2c, 0xad, 0xe8, 0xcb, 0xbe, 0x14, 0x8a, 0xf4, 0xa2, 0x37, 0xd, 0xbd, 0xce};
  uint8_t byteswillprops3[] = {0x59, 0x6b, 0xfc, 0x6b, 0x1, 0x6e, 0x8e, 0x54, 0xad, 0x6c, 0x27, 0xca, 0x73, 0x3b, 0x66, 0x70, 0x30, 0x99};
  uint8_t byteswillprops4[] = {0x29, 0x12, 0xef, 0xae, 0x24, 0xb5, 0x33, 0xf6, 0x40, 0x60, 0xbb, 0xe5, 0x68, 0xeb, 0x26, 0x28, 0x53, 0x98, 0xd7, 0x7, 0xbc, 0xb1, 0x6f};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13124}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 96}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 28528}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 20}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 15600}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 130}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 69}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {30, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 38}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26473}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 30083}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {15, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 29179}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {13, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17148}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 0}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 52}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 9}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 25517}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 8919}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 201}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {23, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 29}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 220}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28976}},
  };

  lwmqtt_properties_t willprops = {27, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb8, 0xb9, 0xb4, 0xca, 0xaa, 0xad, 0x67, 0x9, 0x73, 0x70, 0xdd, 0xaa, 0xa9, 0x7b, 0xd2, 0xa0, 0xf7, 0x1, 0x9, 0x47, 0x9e, 0x4e, 0x35};
  lwmqtt_string_t will_topic = {23, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x5c, 0x1e, 0x2f, 0x25, 0x26, 0x69, 0x6b, 0x12, 0xea, 0xe4, 0x1f, 0xc6, 0x2e, 0x2a, 0x6f, 0xbe, 0x24, 0x11, 0xea, 0xbb, 0x9a, 0xd4, 0x81};
  lwmqtt_string_t will_payload = {23, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 10411;
  uint8_t client_id_bytes[] = {0x56, 0x4, 0x69, 0x17, 0xfc, 0x6e, 0x7d, 0x21, 0xef, 0xbc, 0xea, 0x32, 0x3b, 0x62, 0xf1, 0xed, 0x24, 0xe6, 0xb8, 0xa7, 0x9a, 0xa3, 0x0, 0xce, 0xaf};
  lwmqtt_string_t client_id = {25, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x27, 0xd8, 0xa3, 0x7c, 0xdd, 0x6d, 0xa5, 0xab, 0xec, 0x21, 0xb3, 0x4d, 0x38, 0x34, 0xe8, 0x62, 0x5a, 0x95, 0x9a, 0xea, 0x9e};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\238E\235\195\176i4\ETX\156\201\169\199m\192\SO\135|\184\247", _password = Just "\148!\GS\GS3\143\183\154J\SOF\207+\154$\189\201\133\152\220\230c\213i", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\176\187R!\190\252\137", _willMsg = "\CAN\202\249i\219", _willProps = [PropAuthenticationData "\a\167\247[w%\132",PropMaximumPacketSize 7772,PropRetainAvailable 12,PropUserProperty "W\184\249=-\141\255O\171\135" "\"sR\193",PropWildcardSubscriptionAvailable 189,PropSessionExpiryInterval 32113,PropRequestProblemInformation 100,PropContentType "*",PropPayloadFormatIndicator 34,PropSubscriptionIdentifier 23,PropMessageExpiryInterval 14823,PropSharedSubscriptionAvailable 28,PropPayloadFormatIndicator 105,PropWillDelayInterval 25676,PropSubscriptionIdentifierAvailable 19,PropSubscriptionIdentifierAvailable 139,PropServerReference "\168\226\184UW\a\247u\SOH\189\168\GS\208x\DELr\238\&2\131\136\252\DC1wb@\253\187\216",PropResponseTopic "\139\&3\222\139u\151\EOT\197\227\FS\229\RS&)\228\203.\146\134"]}), _cleanSession = True, _keepAlive = 11619, _connID = ")G\205}(\"\172\143lX\215\SYNQT\CAN7\194\138\RS\DELr3\144\SIn\185\210y", _properties = [PropWillDelayInterval 12505,PropTopicAlias 25947,PropSubscriptionIdentifier 27,PropAuthenticationMethod "\245\232\ENQ\165\ETX_\"M\202^\131\NAK",PropReasonString "5\248\&0`O)Yc\SUB\193%\213k&\194\222\228\162K\CAN\ENQ\rYU\175",PropResponseInformation "\202A\DC3\NUL\183R(\251\165",PropSubscriptionIdentifierAvailable 112,PropMessageExpiryInterval 32467,PropMaximumQoS 119,PropTopicAliasMaximum 1295,PropRequestResponseInformation 31,PropUserProperty "p~\202\210\160\r\232\207\139\190\185Q\\\184\216\EM\205b\206E[C\203U\231R$" "\203\253\162HA\ETB!",PropMessageExpiryInterval 14912,PropResponseTopic "\EOT^\DC4\187\166\157\NAK\SUB\168#\160\FS\192\f\164=\201b",PropReasonString "\RS\ACK\170W",PropSubscriptionIdentifierAvailable 181,PropAuthenticationMethod "p\b\FSb\rR\162\SO\241\212\&4\252\155\141\187\183m\182",PropCorrelationData "",PropReceiveMaximum 13177,PropResponseInformation "{\240\147\201uL\197\198\225\201\163\139\161&\197\SYN\NUL",PropReasonString "9)I7\165\177\139",PropAssignedClientIdentifier "\163Li\247\216\205=\219;\166\186\170\234\186\181\153",PropSubscriptionIdentifier 25,PropReceiveMaximum 31829,PropPayloadFormatIndicator 122,PropCorrelationData "\EM\168M`\160\142j",PropContentType "\194\217\DC4c\131\142\217\205",PropServerKeepAlive 7189,PropMessageExpiryInterval 22850,PropServerKeepAlive 32407]}
TEST(Connect5QCTest, Encode20) {
uint8_t pkt[] = {0x10, 0xf2, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xd6, 0x2d, 0x63, 0x8c, 0x2, 0x18, 0x0, 0x0, 0x30, 0xd9, 0x23, 0x65, 0x5b, 0xb, 0x1b, 0x15, 0x0, 0xc, 0xf5, 0xe8, 0x5, 0xa5, 0x3, 0x5f, 0x22, 0x4d, 0xca, 0x5e, 0x83, 0x15, 0x1f, 0x0, 0x19, 0x35, 0xf8, 0x30, 0x60, 0x4f, 0x29, 0x59, 0x63, 0x1a, 0xc1, 0x25, 0xd5, 0x6b, 0x26, 0xc2, 0xde, 0xe4, 0xa2, 0x4b, 0x18, 0x5, 0xd, 0x59, 0x55, 0xaf, 0x1a, 0x0, 0x9, 0xca, 0x41, 0x13, 0x0, 0xb7, 0x52, 0x28, 0xfb, 0xa5, 0x29, 0x70, 0x2, 0x0, 0x0, 0x7e, 0xd3, 0x24, 0x77, 0x22, 0x5, 0xf, 0x19, 0x1f, 0x26, 0x0, 0x1b, 0x70, 0x7e, 0xca, 0xd2, 0xa0, 0xd, 0xe8, 0xcf, 0x8b, 0xbe, 0xb9, 0x51, 0x5c, 0xb8, 0xd8, 0x19, 0xcd, 0x62, 0xce, 0x45, 0x5b, 0x43, 0xcb, 0x55, 0xe7, 0x52, 0x24, 0x0, 0x7, 0xcb, 0xfd, 0xa2, 0x48, 0x41, 0x17, 0x21, 0x2, 0x0, 0x0, 0x3a, 0x40, 0x8, 0x0, 0x12, 0x4, 0x5e, 0x14, 0xbb, 0xa6, 0x9d, 0x15, 0x1a, 0xa8, 0x23, 0xa0, 0x1c, 0xc0, 0xc, 0xa4, 0x3d, 0xc9, 0x62, 0x1f, 0x0, 0x4, 0x1e, 0x6, 0xaa, 0x57, 0x29, 0xb5, 0x15, 0x0, 0x12, 0x70, 0x8, 0x1c, 0x62, 0xd, 0x52, 0xa2, 0xe, 0xf1, 0xd4, 0x34, 0xfc, 0x9b, 0x8d, 0xbb, 0xb7, 0x6d, 0xb6, 0x9, 0x0, 0x0, 0x21, 0x33, 0x79, 0x1a, 0x0, 0x11, 0x7b, 0xf0, 0x93, 0xc9, 0x75, 0x4c, 0xc5, 0xc6, 0xe1, 0xc9, 0xa3, 0x8b, 0xa1, 0x26, 0xc5, 0x16, 0x0, 0x1f, 0x0, 0x7, 0x39, 0x29, 0x49, 0x37, 0xa5, 0xb1, 0x8b, 0x12, 0x0, 0x10, 0xa3, 0x4c, 0x69, 0xf7, 0xd8, 0xcd, 0x3d, 0xdb, 0x3b, 0xa6, 0xba, 0xaa, 0xea, 0xba, 0xb5, 0x99, 0xb, 0x19, 0x21, 0x7c, 0x55, 0x1, 0x7a, 0x9, 0x0, 0x7, 0x19, 0xa8, 0x4d, 0x60, 0xa0, 0x8e, 0x6a, 0x3, 0x0, 0x8, 0xc2, 0xd9, 0x14, 0x63, 0x83, 0x8e, 0xd9, 0xcd, 0x13, 0x1c, 0x15, 0x2, 0x0, 0x0, 0x59, 0x42, 0x13, 0x7e, 0x97, 0x0, 0x1c, 0x29, 0x47, 0xcd, 0x7d, 0x28, 0x22, 0xac, 0x8f, 0x6c, 0x58, 0xd7, 0x16, 0x51, 0x54, 0x18, 0x37, 0xc2, 0x8a, 0x1e, 0x7f, 0x72, 0x33, 0x90, 0xf, 0x6e, 0xb9, 0xd2, 0x79, 0x7c, 0x16, 0x0, 0x7, 0x7, 0xa7, 0xf7, 0x5b, 0x77, 0x25, 0x84, 0x27, 0x0, 0x0, 0x1e, 0x5c, 0x25, 0xc, 0x26, 0x0, 0xa, 0x57, 0xb8, 0xf9, 0x3d, 0x2d, 0x8d, 0xff, 0x4f, 0xab, 0x87, 0x0, 0x4, 0x22, 0x73, 0x52, 0xc1, 0x28, 0xbd, 0x11, 0x0, 0x0, 0x7d, 0x71, 0x17, 0x64, 0x3, 0x0, 0x1, 0x2a, 0x1, 0x22, 0xb, 0x17, 0x2, 0x0, 0x0, 0x39, 0xe7, 0x2a, 0x1c, 0x1, 0x69, 0x18, 0x0, 0x0, 0x64, 0x4c, 0x29, 0x13, 0x29, 0x8b, 0x1c, 0x0, 0x1c, 0xa8, 0xe2, 0xb8, 0x55, 0x57, 0x7, 0xf7, 0x75, 0x1, 0xbd, 0xa8, 0x1d, 0xd0, 0x78, 0x7f, 0x72, 0xee, 0x32, 0x83, 0x88, 0xfc, 0x11, 0x77, 0x62, 0x40, 0xfd, 0xbb, 0xd8, 0x8, 0x0, 0x13, 0x8b, 0x33, 0xde, 0x8b, 0x75, 0x97, 0x4, 0xc5, 0xe3, 0x1c, 0xe5, 0x1e, 0x26, 0x29, 0xe4, 0xcb, 0x2e, 0x92, 0x86, 0x0, 0x7, 0xb0, 0xbb, 0x52, 0x21, 0xbe, 0xfc, 0x89, 0x0, 0x5, 0x18, 0xca, 0xf9, 0x69, 0xdb, 0x0, 0x13, 0xee, 0x45, 0xeb, 0xc3, 0xb0, 0x69, 0x34, 0x3, 0x9c, 0xc9, 0xa9, 0xc7, 0x6d, 0xc0, 0xe, 0x87, 0x7c, 0xb8, 0xf7, 0x0, 0x18, 0x94, 0x21, 0x1d, 0x1d, 0x33, 0x8f, 0xb7, 0x9a, 0x4a, 0xe, 0x46, 0xcf, 0x2b, 0x9a, 0x24, 0xbd, 0xc9, 0x85, 0x98, 0xdc, 0xe6, 0x63, 0xd5, 0x69};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xf5, 0xe8, 0x5, 0xa5, 0x3, 0x5f, 0x22, 0x4d, 0xca, 0x5e, 0x83, 0x15};
  uint8_t bytesprops1[] = {0x35, 0xf8, 0x30, 0x60, 0x4f, 0x29, 0x59, 0x63, 0x1a, 0xc1, 0x25, 0xd5, 0x6b, 0x26, 0xc2, 0xde, 0xe4, 0xa2, 0x4b, 0x18, 0x5, 0xd, 0x59, 0x55, 0xaf};
  uint8_t bytesprops2[] = {0xca, 0x41, 0x13, 0x0, 0xb7, 0x52, 0x28, 0xfb, 0xa5};
  uint8_t bytesprops4[] = {0xcb, 0xfd, 0xa2, 0x48, 0x41, 0x17, 0x21};
  uint8_t bytesprops3[] = {0x70, 0x7e, 0xca, 0xd2, 0xa0, 0xd, 0xe8, 0xcf, 0x8b, 0xbe, 0xb9, 0x51, 0x5c, 0xb8, 0xd8, 0x19, 0xcd, 0x62, 0xce, 0x45, 0x5b, 0x43, 0xcb, 0x55, 0xe7, 0x52, 0x24};
  uint8_t bytesprops5[] = {0x4, 0x5e, 0x14, 0xbb, 0xa6, 0x9d, 0x15, 0x1a, 0xa8, 0x23, 0xa0, 0x1c, 0xc0, 0xc, 0xa4, 0x3d, 0xc9, 0x62};
  uint8_t bytesprops6[] = {0x1e, 0x6, 0xaa, 0x57};
  uint8_t bytesprops7[] = {0x70, 0x8, 0x1c, 0x62, 0xd, 0x52, 0xa2, 0xe, 0xf1, 0xd4, 0x34, 0xfc, 0x9b, 0x8d, 0xbb, 0xb7, 0x6d, 0xb6};
  uint8_t bytesprops8[] = {0};
  uint8_t bytesprops9[] = {0x7b, 0xf0, 0x93, 0xc9, 0x75, 0x4c, 0xc5, 0xc6, 0xe1, 0xc9, 0xa3, 0x8b, 0xa1, 0x26, 0xc5, 0x16, 0x0};
  uint8_t bytesprops10[] = {0x39, 0x29, 0x49, 0x37, 0xa5, 0xb1, 0x8b};
  uint8_t bytesprops11[] = {0xa3, 0x4c, 0x69, 0xf7, 0xd8, 0xcd, 0x3d, 0xdb, 0x3b, 0xa6, 0xba, 0xaa, 0xea, 0xba, 0xb5, 0x99};
  uint8_t bytesprops12[] = {0x19, 0xa8, 0x4d, 0x60, 0xa0, 0x8e, 0x6a};
  uint8_t bytesprops13[] = {0xc2, 0xd9, 0x14, 0x63, 0x83, 0x8e, 0xd9, 0xcd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 12505}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25947}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 27}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {25, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {9, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 112}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32467}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 119}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1295}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 31}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={27, (char*)&bytesprops3}, .v={7, (char*)&bytesprops4}}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14912}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {18, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {4, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 181}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {18, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13177}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {17, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {7, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 31829}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 122}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops13}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7189}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22850}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 32407}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x7, 0xa7, 0xf7, 0x5b, 0x77, 0x25, 0x84};
  uint8_t byteswillprops2[] = {0x22, 0x73, 0x52, 0xc1};
  uint8_t byteswillprops1[] = {0x57, 0xb8, 0xf9, 0x3d, 0x2d, 0x8d, 0xff, 0x4f, 0xab, 0x87};
  uint8_t byteswillprops3[] = {0x2a};
  uint8_t byteswillprops4[] = {0xa8, 0xe2, 0xb8, 0x55, 0x57, 0x7, 0xf7, 0x75, 0x1, 0xbd, 0xa8, 0x1d, 0xd0, 0x78, 0x7f, 0x72, 0xee, 0x32, 0x83, 0x88, 0xfc, 0x11, 0x77, 0x62, 0x40, 0xfd, 0xbb, 0xd8};
  uint8_t byteswillprops5[] = {0x8b, 0x33, 0xde, 0x8b, 0x75, 0x97, 0x4, 0xc5, 0xe3, 0x1c, 0xe5, 0x1e, 0x26, 0x29, 0xe4, 0xcb, 0x2e, 0x92, 0x86};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7772}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 12}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={10, (char*)&byteswillprops1}, .v={4, (char*)&byteswillprops2}}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 189}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 32113}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {1, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 34}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 23}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14823}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 28}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 105}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 25676}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 19}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 139}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {28, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&byteswillprops5}}},
  };

  lwmqtt_properties_t willprops = {18, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xb0, 0xbb, 0x52, 0x21, 0xbe, 0xfc, 0x89};
  lwmqtt_string_t will_topic = {7, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x18, 0xca, 0xf9, 0x69, 0xdb};
  lwmqtt_string_t will_payload = {5, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 11619;
  uint8_t client_id_bytes[] = {0x29, 0x47, 0xcd, 0x7d, 0x28, 0x22, 0xac, 0x8f, 0x6c, 0x58, 0xd7, 0x16, 0x51, 0x54, 0x18, 0x37, 0xc2, 0x8a, 0x1e, 0x7f, 0x72, 0x33, 0x90, 0xf, 0x6e, 0xb9, 0xd2, 0x79};
  lwmqtt_string_t client_id = {28, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xee, 0x45, 0xeb, 0xc3, 0xb0, 0x69, 0x34, 0x3, 0x9c, 0xc9, 0xa9, 0xc7, 0x6d, 0xc0, 0xe, 0x87, 0x7c, 0xb8, 0xf7};
  lwmqtt_string_t username = {19, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x94, 0x21, 0x1d, 0x1d, 0x33, 0x8f, 0xb7, 0x9a, 0x4a, 0xe, 0x46, 0xcf, 0x2b, 0x9a, 0x24, 0xbd, 0xc9, 0x85, 0x98, 0xdc, 0xe6, 0x63, 0xd5, 0x69};
  lwmqtt_string_t password = {24, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just ";\196\214\158d\DC1\NAK\SUB\139)\218\190\184\241\CANP\STX3V\208&);\255\169\182\226\231`", _password = Nothing, _lastWill = Nothing, _cleanSession = False, _keepAlive = 10023, _connID = "\158\&0\SO\215\199\&6&\NUL\172!u\226\224\240J\178nI", _properties = [PropWildcardSubscriptionAvailable 29,PropRequestProblemInformation 46,PropSharedSubscriptionAvailable 126,PropPayloadFormatIndicator 254,PropWillDelayInterval 20124,PropMessageExpiryInterval 27963]}
TEST(Connect5QCTest, Encode21) {
uint8_t pkt[] = {0x10, 0x50, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x80, 0x27, 0x27, 0x12, 0x28, 0x1d, 0x17, 0x2e, 0x2a, 0x7e, 0x1, 0xfe, 0x18, 0x0, 0x0, 0x4e, 0x9c, 0x2, 0x0, 0x0, 0x6d, 0x3b, 0x0, 0x12, 0x9e, 0x30, 0xe, 0xd7, 0xc7, 0x36, 0x26, 0x0, 0xac, 0x21, 0x75, 0xe2, 0xe0, 0xf0, 0x4a, 0xb2, 0x6e, 0x49, 0x0, 0x1d, 0x3b, 0xc4, 0xd6, 0x9e, 0x64, 0x11, 0x15, 0x1a, 0x8b, 0x29, 0xda, 0xbe, 0xb8, 0xf1, 0x18, 0x50, 0x2, 0x33, 0x56, 0xd0, 0x26, 0x29, 0x3b, 0xff, 0xa9, 0xb6, 0xe2, 0xe7, 0x60};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 29}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 46}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 126}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 254}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 20124}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27963}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 10023;
  uint8_t client_id_bytes[] = {0x9e, 0x30, 0xe, 0xd7, 0xc7, 0x36, 0x26, 0x0, 0xac, 0x21, 0x75, 0xe2, 0xe0, 0xf0, 0x4a, 0xb2, 0x6e, 0x49};
  lwmqtt_string_t client_id = {18, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x3b, 0xc4, 0xd6, 0x9e, 0x64, 0x11, 0x15, 0x1a, 0x8b, 0x29, 0xda, 0xbe, 0xb8, 0xf1, 0x18, 0x50, 0x2, 0x33, 0x56, 0xd0, 0x26, 0x29, 0x3b, 0xff, 0xa9, 0xb6, 0xe2, 0xe7, 0x60};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, NULL);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "F\208\168\t~)z\vT8=\231\137\f\197\180\&5\169O\b\222\153\175\180H\193b\154%", _password = Just "\NAK^\RS\171Ce0\DLE\151\171\237L\167#", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "\ESCn\STX\167<\196\189\197", _willMsg = "G\NAK\158\v\STX\173\140y\131", _willProps = [PropReasonString "\173)\174\184\DC1\238\&9!\155\158\137%F\172\\\170\226",PropTopicAlias 27587,PropResponseTopic "\204)\152\174\216\139SN\195\157o\176A\166n\165H\229x\225\213",PropContentType "\222\135\SUB\213]d\245\199\DC2\137\190\163\STX^{\152\232\199\&6\141\246\227\199\144",PropUserProperty "\145\US\168\139n0\243dF" "\178LO\128\199",PropSharedSubscriptionAvailable 81,PropResponseTopic "u\ACK\234#\136<\251Lj\200]\143\CAN\t\131\242zy\145\138r\196\\*e\171\b\145\239",PropAuthenticationMethod "m\167\219\175\t\219\175\254efh\210\211D\198F\130qH\206\209"]}), _cleanSession = True, _keepAlive = 17115, _connID = "\224\239\SYNj", _properties = [PropSubscriptionIdentifierAvailable 168,PropAssignedClientIdentifier "\154\245\&7\STXZ\tW",PropMessageExpiryInterval 9213,PropTopicAliasMaximum 20311,PropResponseInformation "\ENQ\246R\134\192\&5",PropMaximumQoS 232,PropSubscriptionIdentifier 22]}
TEST(Connect5QCTest, Encode22) {
uint8_t pkt[] = {0x10, 0x8f, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xd6, 0x42, 0xdb, 0x21, 0x29, 0xa8, 0x12, 0x0, 0x7, 0x9a, 0xf5, 0x37, 0x2, 0x5a, 0x9, 0x57, 0x2, 0x0, 0x0, 0x23, 0xfd, 0x22, 0x4f, 0x57, 0x1a, 0x0, 0x6, 0x5, 0xf6, 0x52, 0x86, 0xc0, 0x35, 0x24, 0xe8, 0xb, 0x16, 0x0, 0x4, 0xe0, 0xef, 0x16, 0x6a, 0x97, 0x1, 0x1f, 0x0, 0x11, 0xad, 0x29, 0xae, 0xb8, 0x11, 0xee, 0x39, 0x21, 0x9b, 0x9e, 0x89, 0x25, 0x46, 0xac, 0x5c, 0xaa, 0xe2, 0x23, 0x6b, 0xc3, 0x8, 0x0, 0x15, 0xcc, 0x29, 0x98, 0xae, 0xd8, 0x8b, 0x53, 0x4e, 0xc3, 0x9d, 0x6f, 0xb0, 0x41, 0xa6, 0x6e, 0xa5, 0x48, 0xe5, 0x78, 0xe1, 0xd5, 0x3, 0x0, 0x18, 0xde, 0x87, 0x1a, 0xd5, 0x5d, 0x64, 0xf5, 0xc7, 0x12, 0x89, 0xbe, 0xa3, 0x2, 0x5e, 0x7b, 0x98, 0xe8, 0xc7, 0x36, 0x8d, 0xf6, 0xe3, 0xc7, 0x90, 0x26, 0x0, 0x9, 0x91, 0x1f, 0xa8, 0x8b, 0x6e, 0x30, 0xf3, 0x64, 0x46, 0x0, 0x5, 0xb2, 0x4c, 0x4f, 0x80, 0xc7, 0x2a, 0x51, 0x8, 0x0, 0x1d, 0x75, 0x6, 0xea, 0x23, 0x88, 0x3c, 0xfb, 0x4c, 0x6a, 0xc8, 0x5d, 0x8f, 0x18, 0x9, 0x83, 0xf2, 0x7a, 0x79, 0x91, 0x8a, 0x72, 0xc4, 0x5c, 0x2a, 0x65, 0xab, 0x8, 0x91, 0xef, 0x15, 0x0, 0x15, 0x6d, 0xa7, 0xdb, 0xaf, 0x9, 0xdb, 0xaf, 0xfe, 0x65, 0x66, 0x68, 0xd2, 0xd3, 0x44, 0xc6, 0x46, 0x82, 0x71, 0x48, 0xce, 0xd1, 0x0, 0x8, 0x1b, 0x6e, 0x2, 0xa7, 0x3c, 0xc4, 0xbd, 0xc5, 0x0, 0x9, 0x47, 0x15, 0x9e, 0xb, 0x2, 0xad, 0x8c, 0x79, 0x83, 0x0, 0x1d, 0x46, 0xd0, 0xa8, 0x9, 0x7e, 0x29, 0x7a, 0xb, 0x54, 0x38, 0x3d, 0xe7, 0x89, 0xc, 0xc5, 0xb4, 0x35, 0xa9, 0x4f, 0x8, 0xde, 0x99, 0xaf, 0xb4, 0x48, 0xc1, 0x62, 0x9a, 0x25, 0x0, 0xe, 0x15, 0x5e, 0x1e, 0xab, 0x43, 0x65, 0x30, 0x10, 0x97, 0xab, 0xed, 0x4c, 0xa7, 0x23};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x9a, 0xf5, 0x37, 0x2, 0x5a, 0x9, 0x57};
  uint8_t bytesprops1[] = {0x5, 0xf6, 0x52, 0x86, 0xc0, 0x35};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 168}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {7, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9213}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20311}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 232}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xad, 0x29, 0xae, 0xb8, 0x11, 0xee, 0x39, 0x21, 0x9b, 0x9e, 0x89, 0x25, 0x46, 0xac, 0x5c, 0xaa, 0xe2};
  uint8_t byteswillprops1[] = {0xcc, 0x29, 0x98, 0xae, 0xd8, 0x8b, 0x53, 0x4e, 0xc3, 0x9d, 0x6f, 0xb0, 0x41, 0xa6, 0x6e, 0xa5, 0x48, 0xe5, 0x78, 0xe1, 0xd5};
  uint8_t byteswillprops2[] = {0xde, 0x87, 0x1a, 0xd5, 0x5d, 0x64, 0xf5, 0xc7, 0x12, 0x89, 0xbe, 0xa3, 0x2, 0x5e, 0x7b, 0x98, 0xe8, 0xc7, 0x36, 0x8d, 0xf6, 0xe3, 0xc7, 0x90};
  uint8_t byteswillprops4[] = {0xb2, 0x4c, 0x4f, 0x80, 0xc7};
  uint8_t byteswillprops3[] = {0x91, 0x1f, 0xa8, 0x8b, 0x6e, 0x30, 0xf3, 0x64, 0x46};
  uint8_t byteswillprops5[] = {0x75, 0x6, 0xea, 0x23, 0x88, 0x3c, 0xfb, 0x4c, 0x6a, 0xc8, 0x5d, 0x8f, 0x18, 0x9, 0x83, 0xf2, 0x7a, 0x79, 0x91, 0x8a, 0x72, 0xc4, 0x5c, 0x2a, 0x65, 0xab, 0x8, 0x91, 0xef};
  uint8_t byteswillprops6[] = {0x6d, 0xa7, 0xdb, 0xaf, 0x9, 0xdb, 0xaf, 0xfe, 0x65, 0x66, 0x68, 0xd2, 0xd3, 0x44, 0xc6, 0x46, 0x82, 0x71, 0x48, 0xce, 0xd1};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {17, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 27587}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {21, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {24, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={9, (char*)&byteswillprops3}, .v={5, (char*)&byteswillprops4}}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&byteswillprops6}}},
  };

  lwmqtt_properties_t willprops = {8, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x1b, 0x6e, 0x2, 0xa7, 0x3c, 0xc4, 0xbd, 0xc5};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x47, 0x15, 0x9e, 0xb, 0x2, 0xad, 0x8c, 0x79, 0x83};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 17115;
  uint8_t client_id_bytes[] = {0xe0, 0xef, 0x16, 0x6a};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x46, 0xd0, 0xa8, 0x9, 0x7e, 0x29, 0x7a, 0xb, 0x54, 0x38, 0x3d, 0xe7, 0x89, 0xc, 0xc5, 0xb4, 0x35, 0xa9, 0x4f, 0x8, 0xde, 0x99, 0xaf, 0xb4, 0x48, 0xc1, 0x62, 0x9a, 0x25};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x15, 0x5e, 0x1e, 0xab, 0x43, 0x65, 0x30, 0x10, 0x97, 0xab, 0xed, 0x4c, 0xa7, 0x23};
  lwmqtt_string_t password = {14, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "_\181", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic = "\130\CANG\157\a\138\188H\194", _willMsg = "\131;\DEL\244\175\170\170\225\172", _willProps = [PropAuthenticationMethod "\233\128E\an\188`"]}), _cleanSession = True, _keepAlive = 18273, _connID = "\DLEX\181cI5\156\142^\212\200\ETX\254\162\223\136\ETB\142\251p\163", _properties = [PropReasonString "i\231\190\203.\209#\225\135\199\205\137\FSfFpvw\163\250",PropSessionExpiryInterval 1250,PropWildcardSubscriptionAvailable 81,PropSessionExpiryInterval 5483,PropWillDelayInterval 888,PropAuthenticationData "e\t7\236\157\207\230",PropSharedSubscriptionAvailable 216,PropRequestProblemInformation 171,PropTopicAlias 15760,PropSubscriptionIdentifierAvailable 181,PropTopicAlias 7274,PropSubscriptionIdentifierAvailable 117,PropSubscriptionIdentifier 1,PropAssignedClientIdentifier "\129\219<\175\235\149\199Q\213\237\&5\172\232\159\"",PropRetainAvailable 42,PropTopicAliasMaximum 20244,PropTopicAliasMaximum 20476,PropTopicAlias 14196,PropMaximumQoS 225,PropRequestProblemInformation 103,PropPayloadFormatIndicator 124,PropAssignedClientIdentifier "\174\143\DLE\RS\251,\251\233BMg",PropReasonString ";IY\242s\198A\245\191\ETX",PropWillDelayInterval 7562,PropSessionExpiryInterval 24082,PropSubscriptionIdentifier 4,PropMessageExpiryInterval 30805,PropTopicAliasMaximum 20501,PropRetainAvailable 120]}
TEST(Connect5QCTest, Encode23) {
uint8_t pkt[] = {0x10, 0xde, 0x1, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x46, 0x47, 0x61, 0x96, 0x1, 0x1f, 0x0, 0x14, 0x69, 0xe7, 0xbe, 0xcb, 0x2e, 0xd1, 0x23, 0xe1, 0x87, 0xc7, 0xcd, 0x89, 0x1c, 0x66, 0x46, 0x70, 0x76, 0x77, 0xa3, 0xfa, 0x11, 0x0, 0x0, 0x4, 0xe2, 0x28, 0x51, 0x11, 0x0, 0x0, 0x15, 0x6b, 0x18, 0x0, 0x0, 0x3, 0x78, 0x16, 0x0, 0x7, 0x65, 0x9, 0x37, 0xec, 0x9d, 0xcf, 0xe6, 0x2a, 0xd8, 0x17, 0xab, 0x23, 0x3d, 0x90, 0x29, 0xb5, 0x23, 0x1c, 0x6a, 0x29, 0x75, 0xb, 0x1, 0x12, 0x0, 0xf, 0x81, 0xdb, 0x3c, 0xaf, 0xeb, 0x95, 0xc7, 0x51, 0xd5, 0xed, 0x35, 0xac, 0xe8, 0x9f, 0x22, 0x25, 0x2a, 0x22, 0x4f, 0x14, 0x22, 0x4f, 0xfc, 0x23, 0x37, 0x74, 0x24, 0xe1, 0x17, 0x67, 0x1, 0x7c, 0x12, 0x0, 0xb, 0xae, 0x8f, 0x10, 0x1e, 0xfb, 0x2c, 0xfb, 0xe9, 0x42, 0x4d, 0x67, 0x1f, 0x0, 0xa, 0x3b, 0x49, 0x59, 0xf2, 0x73, 0xc6, 0x41, 0xf5, 0xbf, 0x3, 0x18, 0x0, 0x0, 0x1d, 0x8a, 0x11, 0x0, 0x0, 0x5e, 0x12, 0xb, 0x4, 0x2, 0x0, 0x0, 0x78, 0x55, 0x22, 0x50, 0x15, 0x25, 0x78, 0x0, 0x15, 0x10, 0x58, 0xb5, 0x63, 0x49, 0x35, 0x9c, 0x8e, 0x5e, 0xd4, 0xc8, 0x3, 0xfe, 0xa2, 0xdf, 0x88, 0x17, 0x8e, 0xfb, 0x70, 0xa3, 0xa, 0x15, 0x0, 0x7, 0xe9, 0x80, 0x45, 0x7, 0x6e, 0xbc, 0x60, 0x0, 0x9, 0x82, 0x18, 0x47, 0x9d, 0x7, 0x8a, 0xbc, 0x48, 0xc2, 0x0, 0x9, 0x83, 0x3b, 0x7f, 0xf4, 0xaf, 0xaa, 0xaa, 0xe1, 0xac, 0x0, 0x2, 0x5f, 0xb5};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x69, 0xe7, 0xbe, 0xcb, 0x2e, 0xd1, 0x23, 0xe1, 0x87, 0xc7, 0xcd, 0x89, 0x1c, 0x66, 0x46, 0x70, 0x76, 0x77, 0xa3, 0xfa};
  uint8_t bytesprops1[] = {0x65, 0x9, 0x37, 0xec, 0x9d, 0xcf, 0xe6};
  uint8_t bytesprops2[] = {0x81, 0xdb, 0x3c, 0xaf, 0xeb, 0x95, 0xc7, 0x51, 0xd5, 0xed, 0x35, 0xac, 0xe8, 0x9f, 0x22};
  uint8_t bytesprops3[] = {0xae, 0x8f, 0x10, 0x1e, 0xfb, 0x2c, 0xfb, 0xe9, 0x42, 0x4d, 0x67};
  uint8_t bytesprops4[] = {0x3b, 0x49, 0x59, 0xf2, 0x73, 0xc6, 0x41, 0xf5, 0xbf, 0x3};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1250}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 81}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5483}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 888}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 216}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15760}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 181}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7274}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 1}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20244}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20476}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14196}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 225}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 103}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 124}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 7562}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 24082}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 4}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30805}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20501}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 120}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe9, 0x80, 0x45, 0x7, 0x6e, 0xbc, 0x60};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&byteswillprops0}}},
  };

  lwmqtt_properties_t willprops = {1, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x82, 0x18, 0x47, 0x9d, 0x7, 0x8a, 0xbc, 0x48, 0xc2};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x83, 0x3b, 0x7f, 0xf4, 0xaf, 0xaa, 0xaa, 0xe1, 0xac};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS0;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 18273;
  uint8_t client_id_bytes[] = {0x10, 0x58, 0xb5, 0x63, 0x49, 0x35, 0x9c, 0x8e, 0x5e, 0xd4, 0xc8, 0x3, 0xfe, 0xa2, 0xdf, 0x88, 0x17, 0x8e, 0xfb, 0x70, 0xa3};
  lwmqtt_string_t client_id = {21, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x5f, 0xb5};
  lwmqtt_string_t password = {2, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\212\138\190Q;W\148\195", _willMsg = "\213;", _willProps = [PropRequestResponseInformation 2,PropMessageExpiryInterval 22680,PropResponseTopic "\204\192\149\210\EOT)f\201\214\244\148\177Lv\196\128)\244D\ETX",PropCorrelationData "\EM\140\SUB\SI\168\CAN\144V1\t\US\223",PropTopicAlias 1847,PropResponseInformation "\252\165\241\SO~\228a\245?\160\199\172\216",PropSessionExpiryInterval 5571,PropWildcardSubscriptionAvailable 194,PropReasonString "&\189\DC4Rt\133\199\251\DC1\155h\240*\252%\167\\\229g\ETB\227\253\223\232\162\177",PropCorrelationData "a#\150\220D\147\v\221\140.|.\155\t#\140\&5\143P",PropTopicAliasMaximum 18078,PropSessionExpiryInterval 28214,PropWillDelayInterval 17859,PropPayloadFormatIndicator 221,PropAssignedClientIdentifier "\DC1\188H\ETX\196\187V\SYN{\155\FS`\190\185\236{\RS\247\197\234",PropCorrelationData "\153(\182\&6\248'\187\192pQ_\190",PropMessageExpiryInterval 10563,PropSharedSubscriptionAvailable 99,PropWildcardSubscriptionAvailable 171,PropMessageExpiryInterval 18957,PropWillDelayInterval 9477]}), _cleanSession = True, _keepAlive = 31629, _connID = "\157f\DC3.", _properties = [PropAuthenticationMethod "1\n\210\129\DLE\ETX\164\NUL",PropTopicAliasMaximum 10014,PropSessionExpiryInterval 18349,PropContentType "H\167\200\\\131\189\EOT#",PropReasonString "}\142\164:\156\189\239\194\222\139v\184\164\132\248|@\135\247\&3\201UU\200",PropAuthenticationData "\136\254\243X\ACK\DC2\f",PropUserProperty "\CAN\223T\156\133\157\136\SOH\213\133\199" "\253pj\128\188\230\179i\165C",PropAuthenticationData "\251\235\CAN\255,X\ESC\FS\v\150\ETBW7\ACK\214",PropAssignedClientIdentifier "\212\238\130\t\STXH\169e\176\&9\182\251\143r\147gcp\187\202\166\128",PropAssignedClientIdentifier "g\231\214\157\243\207_\129?\CANbF\199\DC1\131\229\252\157\US\135\adv\192w"]}
TEST(Connect5QCTest, Encode24) {
uint8_t pkt[] = {0x10, 0x88, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x36, 0x7b, 0x8d, 0xa4, 0x1, 0x15, 0x0, 0x8, 0x31, 0xa, 0xd2, 0x81, 0x10, 0x3, 0xa4, 0x0, 0x22, 0x27, 0x1e, 0x11, 0x0, 0x0, 0x47, 0xad, 0x3, 0x0, 0x8, 0x48, 0xa7, 0xc8, 0x5c, 0x83, 0xbd, 0x4, 0x23, 0x1f, 0x0, 0x18, 0x7d, 0x8e, 0xa4, 0x3a, 0x9c, 0xbd, 0xef, 0xc2, 0xde, 0x8b, 0x76, 0xb8, 0xa4, 0x84, 0xf8, 0x7c, 0x40, 0x87, 0xf7, 0x33, 0xc9, 0x55, 0x55, 0xc8, 0x16, 0x0, 0x7, 0x88, 0xfe, 0xf3, 0x58, 0x6, 0x12, 0xc, 0x26, 0x0, 0xb, 0x18, 0xdf, 0x54, 0x9c, 0x85, 0x9d, 0x88, 0x1, 0xd5, 0x85, 0xc7, 0x0, 0xa, 0xfd, 0x70, 0x6a, 0x80, 0xbc, 0xe6, 0xb3, 0x69, 0xa5, 0x43, 0x16, 0x0, 0xf, 0xfb, 0xeb, 0x18, 0xff, 0x2c, 0x58, 0x1b, 0x1c, 0xb, 0x96, 0x17, 0x57, 0x37, 0x6, 0xd6, 0x12, 0x0, 0x16, 0xd4, 0xee, 0x82, 0x9, 0x2, 0x48, 0xa9, 0x65, 0xb0, 0x39, 0xb6, 0xfb, 0x8f, 0x72, 0x93, 0x67, 0x63, 0x70, 0xbb, 0xca, 0xa6, 0x80, 0x12, 0x0, 0x19, 0x67, 0xe7, 0xd6, 0x9d, 0xf3, 0xcf, 0x5f, 0x81, 0x3f, 0x18, 0x62, 0x46, 0xc7, 0x11, 0x83, 0xe5, 0xfc, 0x9d, 0x1f, 0x87, 0x7, 0x64, 0x76, 0xc0, 0x77, 0x0, 0x4, 0x9d, 0x66, 0x13, 0x2e, 0xc2, 0x1, 0x19, 0x2, 0x2, 0x0, 0x0, 0x58, 0x98, 0x8, 0x0, 0x14, 0xcc, 0xc0, 0x95, 0xd2, 0x4, 0x29, 0x66, 0xc9, 0xd6, 0xf4, 0x94, 0xb1, 0x4c, 0x76, 0xc4, 0x80, 0x29, 0xf4, 0x44, 0x3, 0x9, 0x0, 0xc, 0x19, 0x8c, 0x1a, 0xf, 0xa8, 0x18, 0x90, 0x56, 0x31, 0x9, 0x1f, 0xdf, 0x23, 0x7, 0x37, 0x1a, 0x0, 0xd, 0xfc, 0xa5, 0xf1, 0xe, 0x7e, 0xe4, 0x61, 0xf5, 0x3f, 0xa0, 0xc7, 0xac, 0xd8, 0x11, 0x0, 0x0, 0x15, 0xc3, 0x28, 0xc2, 0x1f, 0x0, 0x1a, 0x26, 0xbd, 0x14, 0x52, 0x74, 0x85, 0xc7, 0xfb, 0x11, 0x9b, 0x68, 0xf0, 0x2a, 0xfc, 0x25, 0xa7, 0x5c, 0xe5, 0x67, 0x17, 0xe3, 0xfd, 0xdf, 0xe8, 0xa2, 0xb1, 0x9, 0x0, 0x13, 0x61, 0x23, 0x96, 0xdc, 0x44, 0x93, 0xb, 0xdd, 0x8c, 0x2e, 0x7c, 0x2e, 0x9b, 0x9, 0x23, 0x8c, 0x35, 0x8f, 0x50, 0x22, 0x46, 0x9e, 0x11, 0x0, 0x0, 0x6e, 0x36, 0x18, 0x0, 0x0, 0x45, 0xc3, 0x1, 0xdd, 0x12, 0x0, 0x14, 0x11, 0xbc, 0x48, 0x3, 0xc4, 0xbb, 0x56, 0x16, 0x7b, 0x9b, 0x1c, 0x60, 0xbe, 0xb9, 0xec, 0x7b, 0x1e, 0xf7, 0xc5, 0xea, 0x9, 0x0, 0xc, 0x99, 0x28, 0xb6, 0x36, 0xf8, 0x27, 0xbb, 0xc0, 0x70, 0x51, 0x5f, 0xbe, 0x2, 0x0, 0x0, 0x29, 0x43, 0x2a, 0x63, 0x28, 0xab, 0x2, 0x0, 0x0, 0x4a, 0xd, 0x18, 0x0, 0x0, 0x25, 0x5, 0x0, 0x8, 0xd4, 0x8a, 0xbe, 0x51, 0x3b, 0x57, 0x94, 0xc3, 0x0, 0x2, 0xd5, 0x3b};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x31, 0xa, 0xd2, 0x81, 0x10, 0x3, 0xa4, 0x0};
  uint8_t bytesprops1[] = {0x48, 0xa7, 0xc8, 0x5c, 0x83, 0xbd, 0x4, 0x23};
  uint8_t bytesprops2[] = {0x7d, 0x8e, 0xa4, 0x3a, 0x9c, 0xbd, 0xef, 0xc2, 0xde, 0x8b, 0x76, 0xb8, 0xa4, 0x84, 0xf8, 0x7c, 0x40, 0x87, 0xf7, 0x33, 0xc9, 0x55, 0x55, 0xc8};
  uint8_t bytesprops3[] = {0x88, 0xfe, 0xf3, 0x58, 0x6, 0x12, 0xc};
  uint8_t bytesprops5[] = {0xfd, 0x70, 0x6a, 0x80, 0xbc, 0xe6, 0xb3, 0x69, 0xa5, 0x43};
  uint8_t bytesprops4[] = {0x18, 0xdf, 0x54, 0x9c, 0x85, 0x9d, 0x88, 0x1, 0xd5, 0x85, 0xc7};
  uint8_t bytesprops6[] = {0xfb, 0xeb, 0x18, 0xff, 0x2c, 0x58, 0x1b, 0x1c, 0xb, 0x96, 0x17, 0x57, 0x37, 0x6, 0xd6};
  uint8_t bytesprops7[] = {0xd4, 0xee, 0x82, 0x9, 0x2, 0x48, 0xa9, 0x65, 0xb0, 0x39, 0xb6, 0xfb, 0x8f, 0x72, 0x93, 0x67, 0x63, 0x70, 0xbb, 0xca, 0xa6, 0x80};
  uint8_t bytesprops8[] = {0x67, 0xe7, 0xd6, 0x9d, 0xf3, 0xcf, 0x5f, 0x81, 0x3f, 0x18, 0x62, 0x46, 0xc7, 0x11, 0x83, 0xe5, 0xfc, 0x9d, 0x1f, 0x87, 0x7, 0x64, 0x76, 0xc0, 0x77};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 10014}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18349}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={11, (char*)&bytesprops4}, .v={10, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {15, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xcc, 0xc0, 0x95, 0xd2, 0x4, 0x29, 0x66, 0xc9, 0xd6, 0xf4, 0x94, 0xb1, 0x4c, 0x76, 0xc4, 0x80, 0x29, 0xf4, 0x44, 0x3};
  uint8_t byteswillprops1[] = {0x19, 0x8c, 0x1a, 0xf, 0xa8, 0x18, 0x90, 0x56, 0x31, 0x9, 0x1f, 0xdf};
  uint8_t byteswillprops2[] = {0xfc, 0xa5, 0xf1, 0xe, 0x7e, 0xe4, 0x61, 0xf5, 0x3f, 0xa0, 0xc7, 0xac, 0xd8};
  uint8_t byteswillprops3[] = {0x26, 0xbd, 0x14, 0x52, 0x74, 0x85, 0xc7, 0xfb, 0x11, 0x9b, 0x68, 0xf0, 0x2a, 0xfc, 0x25, 0xa7, 0x5c, 0xe5, 0x67, 0x17, 0xe3, 0xfd, 0xdf, 0xe8, 0xa2, 0xb1};
  uint8_t byteswillprops4[] = {0x61, 0x23, 0x96, 0xdc, 0x44, 0x93, 0xb, 0xdd, 0x8c, 0x2e, 0x7c, 0x2e, 0x9b, 0x9, 0x23, 0x8c, 0x35, 0x8f, 0x50};
  uint8_t byteswillprops5[] = {0x11, 0xbc, 0x48, 0x3, 0xc4, 0xbb, 0x56, 0x16, 0x7b, 0x9b, 0x1c, 0x60, 0xbe, 0xb9, 0xec, 0x7b, 0x1e, 0xf7, 0xc5, 0xea};
  uint8_t byteswillprops6[] = {0x99, 0x28, 0xb6, 0x36, 0xf8, 0x27, 0xbb, 0xc0, 0x70, 0x51, 0x5f, 0xbe};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 2}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22680}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1847}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5571}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 194}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {26, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 18078}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28214}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17859}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 221}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10563}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 99}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18957}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 9477}},
  };

  lwmqtt_properties_t willprops = {21, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xd4, 0x8a, 0xbe, 0x51, 0x3b, 0x57, 0x94, 0xc3};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd5, 0x3b};
  lwmqtt_string_t will_payload = {2, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 31629;
  uint8_t client_id_bytes[] = {0x9d, 0x66, 0x13, 0x2e};
  lwmqtt_string_t client_id = {4, (char*)&client_id_bytes};
opts.client_id = client_id;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\252\245y:\200\b\234\&6\225\SYN\158z\238&\CAN\175\138", _password = Just "|\218-vl\SYN\222f\159V\138\232\203", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS1, _willTopic = "5Y\164\&1`u\255\252\&8\171&", _willMsg = "n\STX\DC2\DEL_\171\ENQ\171\145\175\ESC6\158\&2\246\f%h\190\233O\232\175\190\128\STX\178\210\245l", _willProps = [PropContentType "\228;\253g4\186^\190Y\132L3El",PropSubscriptionIdentifierAvailable 36,PropUserProperty "<=\160\146\223\164\219\191\202\ENQ\DEL\154=H\217m\137\160\187" "\162\171=\164<B\252\206\208\&6\182\198\230\r\131",PropPayloadFormatIndicator 137,PropRequestResponseInformation 219,PropSubscriptionIdentifierAvailable 82,PropReceiveMaximum 14646,PropWillDelayInterval 27331,PropWildcardSubscriptionAvailable 29,PropCorrelationData "T\242\b,\131\198\&7\156\211FP\140\237[\215i\236P\168,\207\&4O?\137'",PropAssignedClientIdentifier "\189\175\197e\151\171 r\130\210\218\&0\143\224\&8n"]}), _cleanSession = False, _keepAlive = 21783, _connID = "56\NAK,s\168\165\247\235\SOP\239\239\194\155\NAK\181iBp\RS\239\ACK\131\a\157\SUB\150]", _properties = [PropWillDelayInterval 8117,PropRequestProblemInformation 75,PropAuthenticationMethod "\225B\tL-L\247\201~",PropRequestProblemInformation 4]}
TEST(Connect5QCTest, Encode25) {
uint8_t pkt[] = {0x10, 0x89, 0x2, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xec, 0x55, 0x17, 0x15, 0x18, 0x0, 0x0, 0x1f, 0xb5, 0x17, 0x4b, 0x15, 0x0, 0x9, 0xe1, 0x42, 0x9, 0x4c, 0x2d, 0x4c, 0xf7, 0xc9, 0x7e, 0x17, 0x4, 0x0, 0x1d, 0x35, 0x36, 0x15, 0x2c, 0x73, 0xa8, 0xa5, 0xf7, 0xeb, 0xe, 0x50, 0xef, 0xef, 0xc2, 0x9b, 0x15, 0xb5, 0x69, 0x42, 0x70, 0x1e, 0xef, 0x6, 0x83, 0x7, 0x9d, 0x1a, 0x96, 0x5d, 0x7a, 0x3, 0x0, 0xe, 0xe4, 0x3b, 0xfd, 0x67, 0x34, 0xba, 0x5e, 0xbe, 0x59, 0x84, 0x4c, 0x33, 0x45, 0x6c, 0x29, 0x24, 0x26, 0x0, 0x13, 0x3c, 0x3d, 0xa0, 0x92, 0xdf, 0xa4, 0xdb, 0xbf, 0xca, 0x5, 0x7f, 0x9a, 0x3d, 0x48, 0xd9, 0x6d, 0x89, 0xa0, 0xbb, 0x0, 0xf, 0xa2, 0xab, 0x3d, 0xa4, 0x3c, 0x42, 0xfc, 0xce, 0xd0, 0x36, 0xb6, 0xc6, 0xe6, 0xd, 0x83, 0x1, 0x89, 0x19, 0xdb, 0x29, 0x52, 0x21, 0x39, 0x36, 0x18, 0x0, 0x0, 0x6a, 0xc3, 0x28, 0x1d, 0x9, 0x0, 0x1a, 0x54, 0xf2, 0x8, 0x2c, 0x83, 0xc6, 0x37, 0x9c, 0xd3, 0x46, 0x50, 0x8c, 0xed, 0x5b, 0xd7, 0x69, 0xec, 0x50, 0xa8, 0x2c, 0xcf, 0x34, 0x4f, 0x3f, 0x89, 0x27, 0x12, 0x0, 0x10, 0xbd, 0xaf, 0xc5, 0x65, 0x97, 0xab, 0x20, 0x72, 0x82, 0xd2, 0xda, 0x30, 0x8f, 0xe0, 0x38, 0x6e, 0x0, 0xb, 0x35, 0x59, 0xa4, 0x31, 0x60, 0x75, 0xff, 0xfc, 0x38, 0xab, 0x26, 0x0, 0x1e, 0x6e, 0x2, 0x12, 0x7f, 0x5f, 0xab, 0x5, 0xab, 0x91, 0xaf, 0x1b, 0x36, 0x9e, 0x32, 0xf6, 0xc, 0x25, 0x68, 0xbe, 0xe9, 0x4f, 0xe8, 0xaf, 0xbe, 0x80, 0x2, 0xb2, 0xd2, 0xf5, 0x6c, 0x0, 0x11, 0xfc, 0xf5, 0x79, 0x3a, 0xc8, 0x8, 0xea, 0x36, 0xe1, 0x16, 0x9e, 0x7a, 0xee, 0x26, 0x18, 0xaf, 0x8a, 0x0, 0xd, 0x7c, 0xda, 0x2d, 0x76, 0x6c, 0x16, 0xde, 0x66, 0x9f, 0x56, 0x8a, 0xe8, 0xcb};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xe1, 0x42, 0x9, 0x4c, 0x2d, 0x4c, 0xf7, 0xc9, 0x7e};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8117}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 75}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {9, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 4}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xe4, 0x3b, 0xfd, 0x67, 0x34, 0xba, 0x5e, 0xbe, 0x59, 0x84, 0x4c, 0x33, 0x45, 0x6c};
  uint8_t byteswillprops2[] = {0xa2, 0xab, 0x3d, 0xa4, 0x3c, 0x42, 0xfc, 0xce, 0xd0, 0x36, 0xb6, 0xc6, 0xe6, 0xd, 0x83};
  uint8_t byteswillprops1[] = {0x3c, 0x3d, 0xa0, 0x92, 0xdf, 0xa4, 0xdb, 0xbf, 0xca, 0x5, 0x7f, 0x9a, 0x3d, 0x48, 0xd9, 0x6d, 0x89, 0xa0, 0xbb};
  uint8_t byteswillprops3[] = {0x54, 0xf2, 0x8, 0x2c, 0x83, 0xc6, 0x37, 0x9c, 0xd3, 0x46, 0x50, 0x8c, 0xed, 0x5b, 0xd7, 0x69, 0xec, 0x50, 0xa8, 0x2c, 0xcf, 0x34, 0x4f, 0x3f, 0x89, 0x27};
  uint8_t byteswillprops4[] = {0xbd, 0xaf, 0xc5, 0x65, 0x97, 0xab, 0x20, 0x72, 0x82, 0xd2, 0xda, 0x30, 0x8f, 0xe0, 0x38, 0x6e};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={19, (char*)&byteswillprops1}, .v={15, (char*)&byteswillprops2}}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 137}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 219}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 82}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 14646}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 27331}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 29}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&byteswillprops4}}},
  };

  lwmqtt_properties_t willprops = {11, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x35, 0x59, 0xa4, 0x31, 0x60, 0x75, 0xff, 0xfc, 0x38, 0xab, 0x26};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x6e, 0x2, 0x12, 0x7f, 0x5f, 0xab, 0x5, 0xab, 0x91, 0xaf, 0x1b, 0x36, 0x9e, 0x32, 0xf6, 0xc, 0x25, 0x68, 0xbe, 0xe9, 0x4f, 0xe8, 0xaf, 0xbe, 0x80, 0x2, 0xb2, 0xd2, 0xf5, 0x6c};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 21783;
  uint8_t client_id_bytes[] = {0x35, 0x36, 0x15, 0x2c, 0x73, 0xa8, 0xa5, 0xf7, 0xeb, 0xe, 0x50, 0xef, 0xef, 0xc2, 0x9b, 0x15, 0xb5, 0x69, 0x42, 0x70, 0x1e, 0xef, 0x6, 0x83, 0x7, 0x9d, 0x1a, 0x96, 0x5d};
  lwmqtt_string_t client_id = {29, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xfc, 0xf5, 0x79, 0x3a, 0xc8, 0x8, 0xea, 0x36, 0xe1, 0x16, 0x9e, 0x7a, 0xee, 0x26, 0x18, 0xaf, 0x8a};
  lwmqtt_string_t username = {17, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x7c, 0xda, 0x2d, 0x76, 0x6c, 0x16, 0xde, 0x66, 0x9f, 0x56, 0x8a, 0xe8, 0xcb};
  lwmqtt_string_t password = {13, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\223*\129F(\130\&4\142\220[3\138\202/U\241z\144\214\227\&9\162\164\149", _password = Just "k\177\238>\207X\198i\188\175\151\215\&4\250\DC2\133\DC3\208", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS2, _willTopic = "", _willMsg = "O\f\163R\254G\172]\199\227#f/\147[\SI", _willProps = [PropSubscriptionIdentifier 22,PropMessageExpiryInterval 29484,PropSubscriptionIdentifierAvailable 190,PropMaximumPacketSize 24579,PropTopicAliasMaximum 5448,PropMaximumQoS 22,PropCorrelationData "\209\204\165\223\218\222\200N#\207",PropContentType "\227F\ACKS\147\240=\219\SUBa|\213w\227`",PropMaximumPacketSize 30812,PropMaximumPacketSize 12528,PropPayloadFormatIndicator 190,PropSubscriptionIdentifier 25,PropTopicAlias 30923,PropServerReference "\233W\US\136\152\174T\192\209C\253\158\226\161\146rp\172\DEL\205r\211wE\221\145\147",PropAuthenticationMethod "\n~\180\194v\180\181-\226\&3r\165\142.\229\229n\138\&0L\FS\205!;^",PropSharedSubscriptionAvailable 136,PropWildcardSubscriptionAvailable 41,PropSharedSubscriptionAvailable 117,PropTopicAlias 25089,PropMaximumQoS 67]}), _cleanSession = False, _keepAlive = 1168, _connID = "\t\208\CAN'\235Mek\SI\DC2;\237\GS\194~\SOH,", _properties = [PropAssignedClientIdentifier "\222d\SYN;4\DELQt~#2s\SO\171\146t'I\231\ACK\n\242\128\244\173\219s-\FS",PropRequestResponseInformation 138,PropReasonString "\186E\DEL\DC3\223o\251vX7\245\179\197\157",PropRetainAvailable 242,PropRequestProblemInformation 122,PropResponseInformation "\135b\EM\248\205\&9\197\134'\205\237Z\202\175\SUB,",PropReasonString "\252z\244n\166\153dEG*\221Yt\213\132",PropResponseInformation "\203\253\173]",PropServerReference ")\198\236\207\&8",PropSubscriptionIdentifier 28,PropMaximumQoS 187,PropMaximumPacketSize 31216,PropRetainAvailable 158,PropSessionExpiryInterval 28,PropResponseTopic "\142\239\FS\211\&8\151\240\n\156\205\146\137\253\v\130/\GS\131\234/\fit#\171\221\155\ETX\148}",PropRequestResponseInformation 182,PropResponseTopic "\139\255\158\207&\128\252A\DC3\180hl\149\b",PropSessionExpiryInterval 12368,PropMaximumPacketSize 2358,PropPayloadFormatIndicator 99,PropResponseTopic "\209\183\&1\168\EM\169\&4",PropWillDelayInterval 190,PropAssignedClientIdentifier "w\204\DC2\180\245\133\186\225L\DC1\182\248\GS\190\137V\223\189\246\254",PropMaximumQoS 123,PropMessageExpiryInterval 11858,PropWillDelayInterval 24601]}
TEST(Connect5QCTest, Encode26) {
uint8_t pkt[] = {0x10, 0xd8, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xd4, 0x4, 0x90, 0xed, 0x1, 0x12, 0x0, 0x1d, 0xde, 0x64, 0x16, 0x3b, 0x34, 0x7f, 0x51, 0x74, 0x7e, 0x23, 0x32, 0x73, 0xe, 0xab, 0x92, 0x74, 0x27, 0x49, 0xe7, 0x6, 0xa, 0xf2, 0x80, 0xf4, 0xad, 0xdb, 0x73, 0x2d, 0x1c, 0x19, 0x8a, 0x1f, 0x0, 0xe, 0xba, 0x45, 0x7f, 0x13, 0xdf, 0x6f, 0xfb, 0x76, 0x58, 0x37, 0xf5, 0xb3, 0xc5, 0x9d, 0x25, 0xf2, 0x17, 0x7a, 0x1a, 0x0, 0x10, 0x87, 0x62, 0x19, 0xf8, 0xcd, 0x39, 0xc5, 0x86, 0x27, 0xcd, 0xed, 0x5a, 0xca, 0xaf, 0x1a, 0x2c, 0x1f, 0x0, 0xf, 0xfc, 0x7a, 0xf4, 0x6e, 0xa6, 0x99, 0x64, 0x45, 0x47, 0x2a, 0xdd, 0x59, 0x74, 0xd5, 0x84, 0x1a, 0x0, 0x4, 0xcb, 0xfd, 0xad, 0x5d, 0x1c, 0x0, 0x5, 0x29, 0xc6, 0xec, 0xcf, 0x38, 0xb, 0x1c, 0x24, 0xbb, 0x27, 0x0, 0x0, 0x79, 0xf0, 0x25, 0x9e, 0x11, 0x0, 0x0, 0x0, 0x1c, 0x8, 0x0, 0x1e, 0x8e, 0xef, 0x1c, 0xd3, 0x38, 0x97, 0xf0, 0xa, 0x9c, 0xcd, 0x92, 0x89, 0xfd, 0xb, 0x82, 0x2f, 0x1d, 0x83, 0xea, 0x2f, 0xc, 0x69, 0x74, 0x23, 0xab, 0xdd, 0x9b, 0x3, 0x94, 0x7d, 0x19, 0xb6, 0x8, 0x0, 0xe, 0x8b, 0xff, 0x9e, 0xcf, 0x26, 0x80, 0xfc, 0x41, 0x13, 0xb4, 0x68, 0x6c, 0x95, 0x8, 0x11, 0x0, 0x0, 0x30, 0x50, 0x27, 0x0, 0x0, 0x9, 0x36, 0x1, 0x63, 0x8, 0x0, 0x7, 0xd1, 0xb7, 0x31, 0xa8, 0x19, 0xa9, 0x34, 0x18, 0x0, 0x0, 0x0, 0xbe, 0x12, 0x0, 0x14, 0x77, 0xcc, 0x12, 0xb4, 0xf5, 0x85, 0xba, 0xe1, 0x4c, 0x11, 0xb6, 0xf8, 0x1d, 0xbe, 0x89, 0x56, 0xdf, 0xbd, 0xf6, 0xfe, 0x24, 0x7b, 0x2, 0x0, 0x0, 0x2e, 0x52, 0x18, 0x0, 0x0, 0x60, 0x19, 0x0, 0x11, 0x9, 0xd0, 0x18, 0x27, 0xeb, 0x4d, 0x65, 0x6b, 0xf, 0x12, 0x3b, 0xed, 0x1d, 0xc2, 0x7e, 0x1, 0x2c, 0x88, 0x1, 0xb, 0x16, 0x2, 0x0, 0x0, 0x73, 0x2c, 0x29, 0xbe, 0x27, 0x0, 0x0, 0x60, 0x3, 0x22, 0x15, 0x48, 0x24, 0x16, 0x9, 0x0, 0xa, 0xd1, 0xcc, 0xa5, 0xdf, 0xda, 0xde, 0xc8, 0x4e, 0x23, 0xcf, 0x3, 0x0, 0xf, 0xe3, 0x46, 0x6, 0x53, 0x93, 0xf0, 0x3d, 0xdb, 0x1a, 0x61, 0x7c, 0xd5, 0x77, 0xe3, 0x60, 0x27, 0x0, 0x0, 0x78, 0x5c, 0x27, 0x0, 0x0, 0x30, 0xf0, 0x1, 0xbe, 0xb, 0x19, 0x23, 0x78, 0xcb, 0x1c, 0x0, 0x1b, 0xe9, 0x57, 0x1f, 0x88, 0x98, 0xae, 0x54, 0xc0, 0xd1, 0x43, 0xfd, 0x9e, 0xe2, 0xa1, 0x92, 0x72, 0x70, 0xac, 0x7f, 0xcd, 0x72, 0xd3, 0x77, 0x45, 0xdd, 0x91, 0x93, 0x15, 0x0, 0x19, 0xa, 0x7e, 0xb4, 0xc2, 0x76, 0xb4, 0xb5, 0x2d, 0xe2, 0x33, 0x72, 0xa5, 0x8e, 0x2e, 0xe5, 0xe5, 0x6e, 0x8a, 0x30, 0x4c, 0x1c, 0xcd, 0x21, 0x3b, 0x5e, 0x2a, 0x88, 0x28, 0x29, 0x2a, 0x75, 0x23, 0x62, 0x1, 0x24, 0x43, 0x0, 0x0, 0x0, 0x10, 0x4f, 0xc, 0xa3, 0x52, 0xfe, 0x47, 0xac, 0x5d, 0xc7, 0xe3, 0x23, 0x66, 0x2f, 0x93, 0x5b, 0xf, 0x0, 0x18, 0xdf, 0x2a, 0x81, 0x46, 0x28, 0x82, 0x34, 0x8e, 0xdc, 0x5b, 0x33, 0x8a, 0xca, 0x2f, 0x55, 0xf1, 0x7a, 0x90, 0xd6, 0xe3, 0x39, 0xa2, 0xa4, 0x95, 0x0, 0x12, 0x6b, 0xb1, 0xee, 0x3e, 0xcf, 0x58, 0xc6, 0x69, 0xbc, 0xaf, 0x97, 0xd7, 0x34, 0xfa, 0x12, 0x85, 0x13, 0xd0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xde, 0x64, 0x16, 0x3b, 0x34, 0x7f, 0x51, 0x74, 0x7e, 0x23, 0x32, 0x73, 0xe, 0xab, 0x92, 0x74, 0x27, 0x49, 0xe7, 0x6, 0xa, 0xf2, 0x80, 0xf4, 0xad, 0xdb, 0x73, 0x2d, 0x1c};
  uint8_t bytesprops1[] = {0xba, 0x45, 0x7f, 0x13, 0xdf, 0x6f, 0xfb, 0x76, 0x58, 0x37, 0xf5, 0xb3, 0xc5, 0x9d};
  uint8_t bytesprops2[] = {0x87, 0x62, 0x19, 0xf8, 0xcd, 0x39, 0xc5, 0x86, 0x27, 0xcd, 0xed, 0x5a, 0xca, 0xaf, 0x1a, 0x2c};
  uint8_t bytesprops3[] = {0xfc, 0x7a, 0xf4, 0x6e, 0xa6, 0x99, 0x64, 0x45, 0x47, 0x2a, 0xdd, 0x59, 0x74, 0xd5, 0x84};
  uint8_t bytesprops4[] = {0xcb, 0xfd, 0xad, 0x5d};
  uint8_t bytesprops5[] = {0x29, 0xc6, 0xec, 0xcf, 0x38};
  uint8_t bytesprops6[] = {0x8e, 0xef, 0x1c, 0xd3, 0x38, 0x97, 0xf0, 0xa, 0x9c, 0xcd, 0x92, 0x89, 0xfd, 0xb, 0x82, 0x2f, 0x1d, 0x83, 0xea, 0x2f, 0xc, 0x69, 0x74, 0x23, 0xab, 0xdd, 0x9b, 0x3, 0x94, 0x7d};
  uint8_t bytesprops7[] = {0x8b, 0xff, 0x9e, 0xcf, 0x26, 0x80, 0xfc, 0x41, 0x13, 0xb4, 0x68, 0x6c, 0x95, 0x8};
  uint8_t bytesprops8[] = {0xd1, 0xb7, 0x31, 0xa8, 0x19, 0xa9, 0x34};
  uint8_t bytesprops9[] = {0x77, 0xcc, 0x12, 0xb4, 0xf5, 0x85, 0xba, 0xe1, 0x4c, 0x11, 0xb6, 0xf8, 0x1d, 0xbe, 0x89, 0x56, 0xdf, 0xbd, 0xf6, 0xfe};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 138}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 242}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 122}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {16, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {4, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 28}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 187}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31216}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 158}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {30, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 182}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {14, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 12368}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2358}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 99}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 190}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 123}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11858}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 24601}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xd1, 0xcc, 0xa5, 0xdf, 0xda, 0xde, 0xc8, 0x4e, 0x23, 0xcf};
  uint8_t byteswillprops1[] = {0xe3, 0x46, 0x6, 0x53, 0x93, 0xf0, 0x3d, 0xdb, 0x1a, 0x61, 0x7c, 0xd5, 0x77, 0xe3, 0x60};
  uint8_t byteswillprops2[] = {0xe9, 0x57, 0x1f, 0x88, 0x98, 0xae, 0x54, 0xc0, 0xd1, 0x43, 0xfd, 0x9e, 0xe2, 0xa1, 0x92, 0x72, 0x70, 0xac, 0x7f, 0xcd, 0x72, 0xd3, 0x77, 0x45, 0xdd, 0x91, 0x93};
  uint8_t byteswillprops3[] = {0xa, 0x7e, 0xb4, 0xc2, 0x76, 0xb4, 0xb5, 0x2d, 0xe2, 0x33, 0x72, 0xa5, 0x8e, 0x2e, 0xe5, 0xe5, 0x6e, 0x8a, 0x30, 0x4c, 0x1c, 0xcd, 0x21, 0x3b, 0x5e};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29484}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 190}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 24579}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 5448}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 22}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 30812}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 12528}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 190}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30923}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 136}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 41}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25089}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 67}},
  };

  lwmqtt_properties_t willprops = {20, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0};
  lwmqtt_string_t will_topic = {0, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x4f, 0xc, 0xa3, 0x52, 0xfe, 0x47, 0xac, 0x5d, 0xc7, 0xe3, 0x23, 0x66, 0x2f, 0x93, 0x5b, 0xf};
  lwmqtt_string_t will_payload = {16, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = false;
opts.keep_alive = 1168;
  uint8_t client_id_bytes[] = {0x9, 0xd0, 0x18, 0x27, 0xeb, 0x4d, 0x65, 0x6b, 0xf, 0x12, 0x3b, 0xed, 0x1d, 0xc2, 0x7e, 0x1, 0x2c};
  lwmqtt_string_t client_id = {17, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xdf, 0x2a, 0x81, 0x46, 0x28, 0x82, 0x34, 0x8e, 0xdc, 0x5b, 0x33, 0x8a, 0xca, 0x2f, 0x55, 0xf1, 0x7a, 0x90, 0xd6, 0xe3, 0x39, 0xa2, 0xa4, 0x95};
  lwmqtt_string_t username = {24, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0x6b, 0xb1, 0xee, 0x3e, 0xcf, 0x58, 0xc6, 0x69, 0xbc, 0xaf, 0x97, 0xd7, 0x34, 0xfa, 0x12, 0x85, 0x13, 0xd0};
  lwmqtt_string_t password = {18, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\220\&2", _password = Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\174'\200lI", _willMsg = "\GS\ETXa\251\147I\r\201>\212r\195\DC1\164\SO!", _willProps = [PropCorrelationData "\213\240\188\235\211q\133\230\201c|\186#/c \216@\152\207\247qx\154",PropReasonString "",PropWildcardSubscriptionAvailable 115,PropRequestProblemInformation 42,PropPayloadFormatIndicator 100,PropResponseTopic "\ESC\202\134\192\EOT\136D\176\195Re\162\130\176H$\219T\GS\140\206\213\244\DC2.'s",PropPayloadFormatIndicator 234,PropCorrelationData "\220\RS-\147\218\a\201-\200",PropServerReference "\b\246H\240\NULVy\131\188\239\208\159J\242\EM\185\193v\166\&8\EOT\ENQ<\NUL#\209",PropServerKeepAlive 21725,PropPayloadFormatIndicator 67,PropReceiveMaximum 20662,PropWillDelayInterval 3391,PropResponseTopic "\187\235\SO\205\188\214u;}%2\171z\168\179\255\150\f\NAK\193_\192\174t",PropSubscriptionIdentifier 19,PropWildcardSubscriptionAvailable 231,PropMaximumPacketSize 10332,PropAuthenticationData "\CANt!K=c$\169\181\138\233Q\200#\156Q\210\153\EOT}5|\241\193v\t\149\214-",PropMaximumQoS 239,PropAssignedClientIdentifier "\249\&0=\193S\184\SI\225\139\141\152A(\204c\195y\ESCuR\177\145j\128\149",PropWildcardSubscriptionAvailable 226]}), _cleanSession = True, _keepAlive = 6357, _connID = "\200", _properties = [PropUserProperty "\193\162\129\r\170q\170\236\201\f\155\ETX\144:" "\159\158\STX)\141Q\217\237\236k\DLE",PropPayloadFormatIndicator 247,PropAssignedClientIdentifier "T(\218\253\246\215\f\205\ENQ\159\193\ETBX\DC1\215 \236\222gw\157\r \237\178",PropPayloadFormatIndicator 98,PropRequestResponseInformation 123,PropSubscriptionIdentifierAvailable 14,PropReceiveMaximum 3111,PropMaximumPacketSize 10786,PropRequestResponseInformation 127,PropSubscriptionIdentifierAvailable 109,PropRetainAvailable 43,PropMessageExpiryInterval 27459,PropWillDelayInterval 1445,PropWildcardSubscriptionAvailable 190,PropCorrelationData "9=\212a\137\DC3\SI~\225\208\241\214\157E\f\249\&3",PropMaximumQoS 232,PropMessageExpiryInterval 2828,PropTopicAliasMaximum 31253,PropAssignedClientIdentifier "y.\194\255G\SUB",PropAuthenticationData "\204K(\235\164\167 ?\165\STX=>P\143\246\239\164\197\&8\r\219\165\CAN\129Be",PropPayloadFormatIndicator 36,PropSessionExpiryInterval 30771,PropReasonString "g\201",PropRetainAvailable 233,PropResponseTopic "\246\200",PropAuthenticationMethod "\161\215{",PropMessageExpiryInterval 6761,PropSubscriptionIdentifier 13,PropSubscriptionIdentifierAvailable 86,PropSharedSubscriptionAvailable 210]}
TEST(Connect5QCTest, Encode27) {
uint8_t pkt[] = {0x10, 0xd0, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xb6, 0x18, 0xd5, 0xc4, 0x1, 0x26, 0x0, 0xe, 0xc1, 0xa2, 0x81, 0xd, 0xaa, 0x71, 0xaa, 0xec, 0xc9, 0xc, 0x9b, 0x3, 0x90, 0x3a, 0x0, 0xb, 0x9f, 0x9e, 0x2, 0x29, 0x8d, 0x51, 0xd9, 0xed, 0xec, 0x6b, 0x10, 0x1, 0xf7, 0x12, 0x0, 0x19, 0x54, 0x28, 0xda, 0xfd, 0xf6, 0xd7, 0xc, 0xcd, 0x5, 0x9f, 0xc1, 0x17, 0x58, 0x11, 0xd7, 0x20, 0xec, 0xde, 0x67, 0x77, 0x9d, 0xd, 0x20, 0xed, 0xb2, 0x1, 0x62, 0x19, 0x7b, 0x29, 0xe, 0x21, 0xc, 0x27, 0x27, 0x0, 0x0, 0x2a, 0x22, 0x19, 0x7f, 0x29, 0x6d, 0x25, 0x2b, 0x2, 0x0, 0x0, 0x6b, 0x43, 0x18, 0x0, 0x0, 0x5, 0xa5, 0x28, 0xbe, 0x9, 0x0, 0x11, 0x39, 0x3d, 0xd4, 0x61, 0x89, 0x13, 0xf, 0x7e, 0xe1, 0xd0, 0xf1, 0xd6, 0x9d, 0x45, 0xc, 0xf9, 0x33, 0x24, 0xe8, 0x2, 0x0, 0x0, 0xb, 0xc, 0x22, 0x7a, 0x15, 0x12, 0x0, 0x6, 0x79, 0x2e, 0xc2, 0xff, 0x47, 0x1a, 0x16, 0x0, 0x1a, 0xcc, 0x4b, 0x28, 0xeb, 0xa4, 0xa7, 0x20, 0x3f, 0xa5, 0x2, 0x3d, 0x3e, 0x50, 0x8f, 0xf6, 0xef, 0xa4, 0xc5, 0x38, 0xd, 0xdb, 0xa5, 0x18, 0x81, 0x42, 0x65, 0x1, 0x24, 0x11, 0x0, 0x0, 0x78, 0x33, 0x1f, 0x0, 0x2, 0x67, 0xc9, 0x25, 0xe9, 0x8, 0x0, 0x2, 0xf6, 0xc8, 0x15, 0x0, 0x3, 0xa1, 0xd7, 0x7b, 0x2, 0x0, 0x0, 0x1a, 0x69, 0xb, 0xd, 0x29, 0x56, 0x2a, 0xd2, 0x0, 0x1, 0xc8, 0xde, 0x1, 0x9, 0x0, 0x18, 0xd5, 0xf0, 0xbc, 0xeb, 0xd3, 0x71, 0x85, 0xe6, 0xc9, 0x63, 0x7c, 0xba, 0x23, 0x2f, 0x63, 0x20, 0xd8, 0x40, 0x98, 0xcf, 0xf7, 0x71, 0x78, 0x9a, 0x1f, 0x0, 0x0, 0x28, 0x73, 0x17, 0x2a, 0x1, 0x64, 0x8, 0x0, 0x1b, 0x1b, 0xca, 0x86, 0xc0, 0x4, 0x88, 0x44, 0xb0, 0xc3, 0x52, 0x65, 0xa2, 0x82, 0xb0, 0x48, 0x24, 0xdb, 0x54, 0x1d, 0x8c, 0xce, 0xd5, 0xf4, 0x12, 0x2e, 0x27, 0x73, 0x1, 0xea, 0x9, 0x0, 0x9, 0xdc, 0x1e, 0x2d, 0x93, 0xda, 0x7, 0xc9, 0x2d, 0xc8, 0x1c, 0x0, 0x1a, 0x8, 0xf6, 0x48, 0xf0, 0x0, 0x56, 0x79, 0x83, 0xbc, 0xef, 0xd0, 0x9f, 0x4a, 0xf2, 0x19, 0xb9, 0xc1, 0x76, 0xa6, 0x38, 0x4, 0x5, 0x3c, 0x0, 0x23, 0xd1, 0x13, 0x54, 0xdd, 0x1, 0x43, 0x21, 0x50, 0xb6, 0x18, 0x0, 0x0, 0xd, 0x3f, 0x8, 0x0, 0x18, 0xbb, 0xeb, 0xe, 0xcd, 0xbc, 0xd6, 0x75, 0x3b, 0x7d, 0x25, 0x32, 0xab, 0x7a, 0xa8, 0xb3, 0xff, 0x96, 0xc, 0x15, 0xc1, 0x5f, 0xc0, 0xae, 0x74, 0xb, 0x13, 0x28, 0xe7, 0x27, 0x0, 0x0, 0x28, 0x5c, 0x16, 0x0, 0x1d, 0x18, 0x74, 0x21, 0x4b, 0x3d, 0x63, 0x24, 0xa9, 0xb5, 0x8a, 0xe9, 0x51, 0xc8, 0x23, 0x9c, 0x51, 0xd2, 0x99, 0x4, 0x7d, 0x35, 0x7c, 0xf1, 0xc1, 0x76, 0x9, 0x95, 0xd6, 0x2d, 0x24, 0xef, 0x12, 0x0, 0x19, 0xf9, 0x30, 0x3d, 0xc1, 0x53, 0xb8, 0xf, 0xe1, 0x8b, 0x8d, 0x98, 0x41, 0x28, 0xcc, 0x63, 0xc3, 0x79, 0x1b, 0x75, 0x52, 0xb1, 0x91, 0x6a, 0x80, 0x95, 0x28, 0xe2, 0x0, 0x5, 0xae, 0x27, 0xc8, 0x6c, 0x49, 0x0, 0x10, 0x1d, 0x3, 0x61, 0xfb, 0x93, 0x49, 0xd, 0xc9, 0x3e, 0xd4, 0x72, 0xc3, 0x11, 0xa4, 0xe, 0x21, 0x0, 0x2, 0xdc, 0x32};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops1[] = {0x9f, 0x9e, 0x2, 0x29, 0x8d, 0x51, 0xd9, 0xed, 0xec, 0x6b, 0x10};
  uint8_t bytesprops0[] = {0xc1, 0xa2, 0x81, 0xd, 0xaa, 0x71, 0xaa, 0xec, 0xc9, 0xc, 0x9b, 0x3, 0x90, 0x3a};
  uint8_t bytesprops2[] = {0x54, 0x28, 0xda, 0xfd, 0xf6, 0xd7, 0xc, 0xcd, 0x5, 0x9f, 0xc1, 0x17, 0x58, 0x11, 0xd7, 0x20, 0xec, 0xde, 0x67, 0x77, 0x9d, 0xd, 0x20, 0xed, 0xb2};
  uint8_t bytesprops3[] = {0x39, 0x3d, 0xd4, 0x61, 0x89, 0x13, 0xf, 0x7e, 0xe1, 0xd0, 0xf1, 0xd6, 0x9d, 0x45, 0xc, 0xf9, 0x33};
  uint8_t bytesprops4[] = {0x79, 0x2e, 0xc2, 0xff, 0x47, 0x1a};
  uint8_t bytesprops5[] = {0xcc, 0x4b, 0x28, 0xeb, 0xa4, 0xa7, 0x20, 0x3f, 0xa5, 0x2, 0x3d, 0x3e, 0x50, 0x8f, 0xf6, 0xef, 0xa4, 0xc5, 0x38, 0xd, 0xdb, 0xa5, 0x18, 0x81, 0x42, 0x65};
  uint8_t bytesprops6[] = {0x67, 0xc9};
  uint8_t bytesprops7[] = {0xf6, 0xc8};
  uint8_t bytesprops8[] = {0xa1, 0xd7, 0x7b};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={14, (char*)&bytesprops0}, .v={11, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 247}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 98}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 123}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 14}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3111}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10786}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 127}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 109}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 43}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27459}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 1445}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 190}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {17, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 232}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2828}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 31253}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {6, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 30771}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {2, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 233}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6761}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 13}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 86}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 210}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xd5, 0xf0, 0xbc, 0xeb, 0xd3, 0x71, 0x85, 0xe6, 0xc9, 0x63, 0x7c, 0xba, 0x23, 0x2f, 0x63, 0x20, 0xd8, 0x40, 0x98, 0xcf, 0xf7, 0x71, 0x78, 0x9a};
  uint8_t byteswillprops1[] = {0};
  uint8_t byteswillprops2[] = {0x1b, 0xca, 0x86, 0xc0, 0x4, 0x88, 0x44, 0xb0, 0xc3, 0x52, 0x65, 0xa2, 0x82, 0xb0, 0x48, 0x24, 0xdb, 0x54, 0x1d, 0x8c, 0xce, 0xd5, 0xf4, 0x12, 0x2e, 0x27, 0x73};
  uint8_t byteswillprops3[] = {0xdc, 0x1e, 0x2d, 0x93, 0xda, 0x7, 0xc9, 0x2d, 0xc8};
  uint8_t byteswillprops4[] = {0x8, 0xf6, 0x48, 0xf0, 0x0, 0x56, 0x79, 0x83, 0xbc, 0xef, 0xd0, 0x9f, 0x4a, 0xf2, 0x19, 0xb9, 0xc1, 0x76, 0xa6, 0x38, 0x4, 0x5, 0x3c, 0x0, 0x23, 0xd1};
  uint8_t byteswillprops5[] = {0xbb, 0xeb, 0xe, 0xcd, 0xbc, 0xd6, 0x75, 0x3b, 0x7d, 0x25, 0x32, 0xab, 0x7a, 0xa8, 0xb3, 0xff, 0x96, 0xc, 0x15, 0xc1, 0x5f, 0xc0, 0xae, 0x74};
  uint8_t byteswillprops6[] = {0x18, 0x74, 0x21, 0x4b, 0x3d, 0x63, 0x24, 0xa9, 0xb5, 0x8a, 0xe9, 0x51, 0xc8, 0x23, 0x9c, 0x51, 0xd2, 0x99, 0x4, 0x7d, 0x35, 0x7c, 0xf1, 0xc1, 0x76, 0x9, 0x95, 0xd6, 0x2d};
  uint8_t byteswillprops7[] = {0xf9, 0x30, 0x3d, 0xc1, 0x53, 0xb8, 0xf, 0xe1, 0x8b, 0x8d, 0x98, 0x41, 0x28, 0xcc, 0x63, 0xc3, 0x79, 0x1b, 0x75, 0x52, 0xb1, 0x91, 0x6a, 0x80, 0x95};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {0, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 115}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 234}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21725}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 67}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 20662}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 3391}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {24, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 19}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 231}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10332}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 239}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&byteswillprops7}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 226}},
  };

  lwmqtt_properties_t willprops = {21, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xae, 0x27, 0xc8, 0x6c, 0x49};
  lwmqtt_string_t will_topic = {5, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x1d, 0x3, 0x61, 0xfb, 0x93, 0x49, 0xd, 0xc9, 0x3e, 0xd4, 0x72, 0xc3, 0x11, 0xa4, 0xe, 0x21};
  lwmqtt_string_t will_payload = {16, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 6357;
  uint8_t client_id_bytes[] = {0xc8};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0xdc, 0x32};
  lwmqtt_string_t username = {2, (char*)&username_bytes};
opts.username = username;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Nothing, _password = Just "\138P\246\r\139dV\214\134\172RuyQ\235d\SI&A\169\ETX\151\187swD", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "Q\190\197\213\216\168{>!\220\238\251Zm\n\219\233\RSM\158\210\250\228\168", _willMsg = "e\227;s\172;", _willProps = [PropWildcardSubscriptionAvailable 135,PropUserProperty "H;\237\136\172Z\223\243\194G\162\189\b\253\185\147\&6\191\178\220\144d" "\233\r\133\ENQ7|\219\241m/\133\166D\155\DC2?i\SI\168\NULH\248\247\196\176",PropMessageExpiryInterval 23691,PropUserProperty "\212\220\r\SYN=)!K\200\146\177\210+\146gE\EOT\r\204)}\n\128\253\152\EOT\SO" "\183o\129n\154\160\141\FS\253\221\&3",PropServerReference "\199\&3\160\228\158\159/:\214g\248o\190\154T\199l\SOH\SO\183\142'\158\aX",PropAssignedClientIdentifier "\225\138",PropMessageExpiryInterval 16206,PropTopicAliasMaximum 12753,PropRequestResponseInformation 221,PropMaximumQoS 41,PropMaximumQoS 48,PropSubscriptionIdentifierAvailable 187,PropAuthenticationData "S\132\252\128\234\206\190!\227\163U]\160 \144\150\252)\n_",PropWildcardSubscriptionAvailable 10,PropWildcardSubscriptionAvailable 178,PropRetainAvailable 10,PropMaximumPacketSize 28852,PropAuthenticationMethod "\156vp6\253\160\172\226\221K\219z\224\SUB",PropRetainAvailable 246,PropServerKeepAlive 21476]}), _cleanSession = True, _keepAlive = 10491, _connID = "", _properties = [PropRequestProblemInformation 88,PropTopicAliasMaximum 26258,PropResponseInformation "\SOH\210\EOTt\180>\196\184\r!\200\243\237\241!w\197\183\&6 \239\NAK$B~\158zh",PropResponseTopic "A\222y\r\177d\221\241\195\130\233@\163\150?\153\130\153.Y\136\233\253",PropCorrelationData "\229\243\255X\176\208uq<}\180\145\211\235#",PropAssignedClientIdentifier "\240\227\229\SI\129K\198L\US|\244\220-K\202e/\ESC\155",PropResponseInformation "\215\192r\218T^\204\155#\175\NUL\FS\133\184U\174\145\177\STX>{\205",PropSubscriptionIdentifierAvailable 56,PropWillDelayInterval 11136,PropPayloadFormatIndicator 30,PropWillDelayInterval 5641,PropAuthenticationMethod "\171",PropResponseInformation "\176\133\\Lqu\161\ESC\232\237",PropAuthenticationMethod "\204Y\132\SOH\DEL\153C\218\164I\214\140:IC",PropMessageExpiryInterval 6360,PropRequestResponseInformation 48,PropServerReference "\134\180\170\207\172\233\149\163\210\ENQe\205\164\226:\211\143\ENQ\195\232\159",PropRetainAvailable 248,PropSubscriptionIdentifier 14,PropReceiveMaximum 13659,PropSessionExpiryInterval 23673,PropSharedSubscriptionAvailable 205,PropServerKeepAlive 19558]}
TEST(Connect5QCTest, Encode28) {
uint8_t pkt[] = {0x10, 0xfd, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0x76, 0x28, 0xfb, 0xe0, 0x1, 0x17, 0x58, 0x22, 0x66, 0x92, 0x1a, 0x0, 0x1c, 0x1, 0xd2, 0x4, 0x74, 0xb4, 0x3e, 0xc4, 0xb8, 0xd, 0x21, 0xc8, 0xf3, 0xed, 0xf1, 0x21, 0x77, 0xc5, 0xb7, 0x36, 0x20, 0xef, 0x15, 0x24, 0x42, 0x7e, 0x9e, 0x7a, 0x68, 0x8, 0x0, 0x17, 0x41, 0xde, 0x79, 0xd, 0xb1, 0x64, 0xdd, 0xf1, 0xc3, 0x82, 0xe9, 0x40, 0xa3, 0x96, 0x3f, 0x99, 0x82, 0x99, 0x2e, 0x59, 0x88, 0xe9, 0xfd, 0x9, 0x0, 0xf, 0xe5, 0xf3, 0xff, 0x58, 0xb0, 0xd0, 0x75, 0x71, 0x3c, 0x7d, 0xb4, 0x91, 0xd3, 0xeb, 0x23, 0x12, 0x0, 0x13, 0xf0, 0xe3, 0xe5, 0xf, 0x81, 0x4b, 0xc6, 0x4c, 0x1f, 0x7c, 0xf4, 0xdc, 0x2d, 0x4b, 0xca, 0x65, 0x2f, 0x1b, 0x9b, 0x1a, 0x0, 0x16, 0xd7, 0xc0, 0x72, 0xda, 0x54, 0x5e, 0xcc, 0x9b, 0x23, 0xaf, 0x0, 0x1c, 0x85, 0xb8, 0x55, 0xae, 0x91, 0xb1, 0x2, 0x3e, 0x7b, 0xcd, 0x29, 0x38, 0x18, 0x0, 0x0, 0x2b, 0x80, 0x1, 0x1e, 0x18, 0x0, 0x0, 0x16, 0x9, 0x15, 0x0, 0x1, 0xab, 0x1a, 0x0, 0xa, 0xb0, 0x85, 0x5c, 0x4c, 0x71, 0x75, 0xa1, 0x1b, 0xe8, 0xed, 0x15, 0x0, 0xf, 0xcc, 0x59, 0x84, 0x1, 0x7f, 0x99, 0x43, 0xda, 0xa4, 0x49, 0xd6, 0x8c, 0x3a, 0x49, 0x43, 0x2, 0x0, 0x0, 0x18, 0xd8, 0x19, 0x30, 0x1c, 0x0, 0x15, 0x86, 0xb4, 0xaa, 0xcf, 0xac, 0xe9, 0x95, 0xa3, 0xd2, 0x5, 0x65, 0xcd, 0xa4, 0xe2, 0x3a, 0xd3, 0x8f, 0x5, 0xc3, 0xe8, 0x9f, 0x25, 0xf8, 0xb, 0xe, 0x21, 0x35, 0x5b, 0x11, 0x0, 0x0, 0x5c, 0x79, 0x2a, 0xcd, 0x13, 0x4c, 0x66, 0x0, 0x0, 0xcf, 0x1, 0x28, 0x87, 0x26, 0x0, 0x16, 0x48, 0x3b, 0xed, 0x88, 0xac, 0x5a, 0xdf, 0xf3, 0xc2, 0x47, 0xa2, 0xbd, 0x8, 0xfd, 0xb9, 0x93, 0x36, 0xbf, 0xb2, 0xdc, 0x90, 0x64, 0x0, 0x19, 0xe9, 0xd, 0x85, 0x5, 0x37, 0x7c, 0xdb, 0xf1, 0x6d, 0x2f, 0x85, 0xa6, 0x44, 0x9b, 0x12, 0x3f, 0x69, 0xf, 0xa8, 0x0, 0x48, 0xf8, 0xf7, 0xc4, 0xb0, 0x2, 0x0, 0x0, 0x5c, 0x8b, 0x26, 0x0, 0x1b, 0xd4, 0xdc, 0xd, 0x16, 0x3d, 0x29, 0x21, 0x4b, 0xc8, 0x92, 0xb1, 0xd2, 0x2b, 0x92, 0x67, 0x45, 0x4, 0xd, 0xcc, 0x29, 0x7d, 0xa, 0x80, 0xfd, 0x98, 0x4, 0xe, 0x0, 0xb, 0xb7, 0x6f, 0x81, 0x6e, 0x9a, 0xa0, 0x8d, 0x1c, 0xfd, 0xdd, 0x33, 0x1c, 0x0, 0x19, 0xc7, 0x33, 0xa0, 0xe4, 0x9e, 0x9f, 0x2f, 0x3a, 0xd6, 0x67, 0xf8, 0x6f, 0xbe, 0x9a, 0x54, 0xc7, 0x6c, 0x1, 0xe, 0xb7, 0x8e, 0x27, 0x9e, 0x7, 0x58, 0x12, 0x0, 0x2, 0xe1, 0x8a, 0x2, 0x0, 0x0, 0x3f, 0x4e, 0x22, 0x31, 0xd1, 0x19, 0xdd, 0x24, 0x29, 0x24, 0x30, 0x29, 0xbb, 0x16, 0x0, 0x14, 0x53, 0x84, 0xfc, 0x80, 0xea, 0xce, 0xbe, 0x21, 0xe3, 0xa3, 0x55, 0x5d, 0xa0, 0x20, 0x90, 0x96, 0xfc, 0x29, 0xa, 0x5f, 0x28, 0xa, 0x28, 0xb2, 0x25, 0xa, 0x27, 0x0, 0x0, 0x70, 0xb4, 0x15, 0x0, 0xe, 0x9c, 0x76, 0x70, 0x36, 0xfd, 0xa0, 0xac, 0xe2, 0xdd, 0x4b, 0xdb, 0x7a, 0xe0, 0x1a, 0x25, 0xf6, 0x13, 0x53, 0xe4, 0x0, 0x18, 0x51, 0xbe, 0xc5, 0xd5, 0xd8, 0xa8, 0x7b, 0x3e, 0x21, 0xdc, 0xee, 0xfb, 0x5a, 0x6d, 0xa, 0xdb, 0xe9, 0x1e, 0x4d, 0x9e, 0xd2, 0xfa, 0xe4, 0xa8, 0x0, 0x6, 0x65, 0xe3, 0x3b, 0x73, 0xac, 0x3b, 0x0, 0x1a, 0x8a, 0x50, 0xf6, 0xd, 0x8b, 0x64, 0x56, 0xd6, 0x86, 0xac, 0x52, 0x75, 0x79, 0x51, 0xeb, 0x64, 0xf, 0x26, 0x41, 0xa9, 0x3, 0x97, 0xbb, 0x73, 0x77, 0x44};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x1, 0xd2, 0x4, 0x74, 0xb4, 0x3e, 0xc4, 0xb8, 0xd, 0x21, 0xc8, 0xf3, 0xed, 0xf1, 0x21, 0x77, 0xc5, 0xb7, 0x36, 0x20, 0xef, 0x15, 0x24, 0x42, 0x7e, 0x9e, 0x7a, 0x68};
  uint8_t bytesprops1[] = {0x41, 0xde, 0x79, 0xd, 0xb1, 0x64, 0xdd, 0xf1, 0xc3, 0x82, 0xe9, 0x40, 0xa3, 0x96, 0x3f, 0x99, 0x82, 0x99, 0x2e, 0x59, 0x88, 0xe9, 0xfd};
  uint8_t bytesprops2[] = {0xe5, 0xf3, 0xff, 0x58, 0xb0, 0xd0, 0x75, 0x71, 0x3c, 0x7d, 0xb4, 0x91, 0xd3, 0xeb, 0x23};
  uint8_t bytesprops3[] = {0xf0, 0xe3, 0xe5, 0xf, 0x81, 0x4b, 0xc6, 0x4c, 0x1f, 0x7c, 0xf4, 0xdc, 0x2d, 0x4b, 0xca, 0x65, 0x2f, 0x1b, 0x9b};
  uint8_t bytesprops4[] = {0xd7, 0xc0, 0x72, 0xda, 0x54, 0x5e, 0xcc, 0x9b, 0x23, 0xaf, 0x0, 0x1c, 0x85, 0xb8, 0x55, 0xae, 0x91, 0xb1, 0x2, 0x3e, 0x7b, 0xcd};
  uint8_t bytesprops5[] = {0xab};
  uint8_t bytesprops6[] = {0xb0, 0x85, 0x5c, 0x4c, 0x71, 0x75, 0xa1, 0x1b, 0xe8, 0xed};
  uint8_t bytesprops7[] = {0xcc, 0x59, 0x84, 0x1, 0x7f, 0x99, 0x43, 0xda, 0xa4, 0x49, 0xd6, 0x8c, 0x3a, 0x49, 0x43};
  uint8_t bytesprops8[] = {0x86, 0xb4, 0xaa, 0xcf, 0xac, 0xe9, 0x95, 0xa3, 0xd2, 0x5, 0x65, 0xcd, 0xa4, 0xe2, 0x3a, 0xd3, 0x8f, 0x5, 0xc3, 0xe8, 0x9f};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 88}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 26258}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 56}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 11136}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 30}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5641}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {1, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {15, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6360}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 48}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 248}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 14}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13659}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 23673}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 205}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19558}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops1[] = {0xe9, 0xd, 0x85, 0x5, 0x37, 0x7c, 0xdb, 0xf1, 0x6d, 0x2f, 0x85, 0xa6, 0x44, 0x9b, 0x12, 0x3f, 0x69, 0xf, 0xa8, 0x0, 0x48, 0xf8, 0xf7, 0xc4, 0xb0};
  uint8_t byteswillprops0[] = {0x48, 0x3b, 0xed, 0x88, 0xac, 0x5a, 0xdf, 0xf3, 0xc2, 0x47, 0xa2, 0xbd, 0x8, 0xfd, 0xb9, 0x93, 0x36, 0xbf, 0xb2, 0xdc, 0x90, 0x64};
  uint8_t byteswillprops3[] = {0xb7, 0x6f, 0x81, 0x6e, 0x9a, 0xa0, 0x8d, 0x1c, 0xfd, 0xdd, 0x33};
  uint8_t byteswillprops2[] = {0xd4, 0xdc, 0xd, 0x16, 0x3d, 0x29, 0x21, 0x4b, 0xc8, 0x92, 0xb1, 0xd2, 0x2b, 0x92, 0x67, 0x45, 0x4, 0xd, 0xcc, 0x29, 0x7d, 0xa, 0x80, 0xfd, 0x98, 0x4, 0xe};
  uint8_t byteswillprops4[] = {0xc7, 0x33, 0xa0, 0xe4, 0x9e, 0x9f, 0x2f, 0x3a, 0xd6, 0x67, 0xf8, 0x6f, 0xbe, 0x9a, 0x54, 0xc7, 0x6c, 0x1, 0xe, 0xb7, 0x8e, 0x27, 0x9e, 0x7, 0x58};
  uint8_t byteswillprops5[] = {0xe1, 0x8a};
  uint8_t byteswillprops6[] = {0x53, 0x84, 0xfc, 0x80, 0xea, 0xce, 0xbe, 0x21, 0xe3, 0xa3, 0x55, 0x5d, 0xa0, 0x20, 0x90, 0x96, 0xfc, 0x29, 0xa, 0x5f};
  uint8_t byteswillprops7[] = {0x9c, 0x76, 0x70, 0x36, 0xfd, 0xa0, 0xac, 0xe2, 0xdd, 0x4b, 0xdb, 0x7a, 0xe0, 0x1a};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 135}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={22, (char*)&byteswillprops0}, .v={25, (char*)&byteswillprops1}}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23691}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={27, (char*)&byteswillprops2}, .v={11, (char*)&byteswillprops3}}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {2, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16206}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 12753}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 221}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 41}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 48}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 187}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 10}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 178}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 10}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 28852}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&byteswillprops7}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 246}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21476}},
  };

  lwmqtt_properties_t willprops = {20, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x51, 0xbe, 0xc5, 0xd5, 0xd8, 0xa8, 0x7b, 0x3e, 0x21, 0xdc, 0xee, 0xfb, 0x5a, 0x6d, 0xa, 0xdb, 0xe9, 0x1e, 0x4d, 0x9e, 0xd2, 0xfa, 0xe4, 0xa8};
  lwmqtt_string_t will_topic = {24, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x65, 0xe3, 0x3b, 0x73, 0xac, 0x3b};
  lwmqtt_string_t will_payload = {6, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 10491;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t password_bytes[] = {0x8a, 0x50, 0xf6, 0xd, 0x8b, 0x64, 0x56, 0xd6, 0x86, 0xac, 0x52, 0x75, 0x79, 0x51, 0xeb, 0x64, 0xf, 0x26, 0x41, 0xa9, 0x3, 0x97, 0xbb, 0x73, 0x77, 0x44};
  lwmqtt_string_t password = {26, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\136\ETX\185\158{\133u\SUB]M\158\149j", _password = Just "\236\211\185\RS\166i\ENQ\145\208h\157\v\ESC!", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS2, _willTopic = "\224\ESC\"\DLEM\r\165\238\&9\230\141", _willMsg = "C\129\147\222\&7Q.1.", _willProps = [PropResponseTopic "\197\166\166lRU\205",PropServerKeepAlive 12229,PropSubscriptionIdentifier 12,PropContentType "\ax\186g!H\DC3\138\247Gs\228=z\162n\195$N\196&\182fj\181c\132y",PropTopicAlias 25969,PropUserProperty "ib\148\149.\202Z \ACK\140\136N\130L\199I\138" "\175\171\198\204\161P\222K\141\DC2%Bp\237\135O\rE\165\t",PropTopicAlias 29830,PropUserProperty "@l\248\ETX\221\SOH\169\192\ETB\192k\205>Z\207\186\&6c.\200\179+3\"$J\ACK\DC3c\DLE" "\158Ck5\ESC\173\175\\\130\v/\176\209\128K\NAK\n\156)\173",PropTopicAliasMaximum 30754,PropSubscriptionIdentifier 6,PropCorrelationData "\STXf\232\146\b\188\224\253\227M\236\&0v\ETB\135<\160\164\234\US%\202\DC1s",PropTopicAlias 21576,PropPayloadFormatIndicator 191,PropSubscriptionIdentifierAvailable 85,PropRequestProblemInformation 105,PropRetainAvailable 36,PropResponseInformation "2\254\146\215\ESCW,\142Wz\171\\#\vZ4\240\146\209&)\SYN\140N\169v",PropTopicAlias 19080,PropServerReference "\\\132\162(8\DC2\163\188\138A\244\243lJ[\DELu\160J",PropUserProperty "\DC4\186\217x\NULB\148\235UE v-" "\154T\166\235\DC2\NUL`\141\188\\\aeo\190\249"]}), _cleanSession = True, _keepAlive = 12875, _connID = "j", _properties = [PropServerReference "\164\DC4\181\229",PropWildcardSubscriptionAvailable 34,PropTopicAlias 25379,PropResponseInformation "\173X\157#Y\239Z\170\161\145D_\159r\227<\246%\252\237h\230G\EM\158\191\129\NUL\142V"]}
TEST(Connect5QCTest, Encode29) {
uint8_t pkt[] = {0x10, 0x8b, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xf6, 0x32, 0x4b, 0x2d, 0x1c, 0x0, 0x4, 0xa4, 0x14, 0xb5, 0xe5, 0x28, 0x22, 0x23, 0x63, 0x23, 0x1a, 0x0, 0x1e, 0xad, 0x58, 0x9d, 0x23, 0x59, 0xef, 0x5a, 0xaa, 0xa1, 0x91, 0x44, 0x5f, 0x9f, 0x72, 0xe3, 0x3c, 0xf6, 0x25, 0xfc, 0xed, 0x68, 0xe6, 0x47, 0x19, 0x9e, 0xbf, 0x81, 0x0, 0x8e, 0x56, 0x0, 0x1, 0x6a, 0x97, 0x2, 0x8, 0x0, 0x7, 0xc5, 0xa6, 0xa6, 0x6c, 0x52, 0x55, 0xcd, 0x13, 0x2f, 0xc5, 0xb, 0xc, 0x3, 0x0, 0x1c, 0x7, 0x78, 0xba, 0x67, 0x21, 0x48, 0x13, 0x8a, 0xf7, 0x47, 0x73, 0xe4, 0x3d, 0x7a, 0xa2, 0x6e, 0xc3, 0x24, 0x4e, 0xc4, 0x26, 0xb6, 0x66, 0x6a, 0xb5, 0x63, 0x84, 0x79, 0x23, 0x65, 0x71, 0x26, 0x0, 0x11, 0x69, 0x62, 0x94, 0x95, 0x2e, 0xca, 0x5a, 0x20, 0x6, 0x8c, 0x88, 0x4e, 0x82, 0x4c, 0xc7, 0x49, 0x8a, 0x0, 0x14, 0xaf, 0xab, 0xc6, 0xcc, 0xa1, 0x50, 0xde, 0x4b, 0x8d, 0x12, 0x25, 0x42, 0x70, 0xed, 0x87, 0x4f, 0xd, 0x45, 0xa5, 0x9, 0x23, 0x74, 0x86, 0x26, 0x0, 0x1e, 0x40, 0x6c, 0xf8, 0x3, 0xdd, 0x1, 0xa9, 0xc0, 0x17, 0xc0, 0x6b, 0xcd, 0x3e, 0x5a, 0xcf, 0xba, 0x36, 0x63, 0x2e, 0xc8, 0xb3, 0x2b, 0x33, 0x22, 0x24, 0x4a, 0x6, 0x13, 0x63, 0x10, 0x0, 0x14, 0x9e, 0x43, 0x6b, 0x35, 0x1b, 0xad, 0xaf, 0x5c, 0x82, 0xb, 0x2f, 0xb0, 0xd1, 0x80, 0x4b, 0x15, 0xa, 0x9c, 0x29, 0xad, 0x22, 0x78, 0x22, 0xb, 0x6, 0x9, 0x0, 0x18, 0x2, 0x66, 0xe8, 0x92, 0x8, 0xbc, 0xe0, 0xfd, 0xe3, 0x4d, 0xec, 0x30, 0x76, 0x17, 0x87, 0x3c, 0xa0, 0xa4, 0xea, 0x1f, 0x25, 0xca, 0x11, 0x73, 0x23, 0x54, 0x48, 0x1, 0xbf, 0x29, 0x55, 0x17, 0x69, 0x25, 0x24, 0x1a, 0x0, 0x1a, 0x32, 0xfe, 0x92, 0xd7, 0x1b, 0x57, 0x2c, 0x8e, 0x57, 0x7a, 0xab, 0x5c, 0x23, 0xb, 0x5a, 0x34, 0xf0, 0x92, 0xd1, 0x26, 0x29, 0x16, 0x8c, 0x4e, 0xa9, 0x76, 0x23, 0x4a, 0x88, 0x1c, 0x0, 0x13, 0x5c, 0x84, 0xa2, 0x28, 0x38, 0x12, 0xa3, 0xbc, 0x8a, 0x41, 0xf4, 0xf3, 0x6c, 0x4a, 0x5b, 0x7f, 0x75, 0xa0, 0x4a, 0x26, 0x0, 0xd, 0x14, 0xba, 0xd9, 0x78, 0x0, 0x42, 0x94, 0xeb, 0x55, 0x45, 0x20, 0x76, 0x2d, 0x0, 0xf, 0x9a, 0x54, 0xa6, 0xeb, 0x12, 0x0, 0x60, 0x8d, 0xbc, 0x5c, 0x7, 0x65, 0x6f, 0xbe, 0xf9, 0x0, 0xb, 0xe0, 0x1b, 0x22, 0x10, 0x4d, 0xd, 0xa5, 0xee, 0x39, 0xe6, 0x8d, 0x0, 0x9, 0x43, 0x81, 0x93, 0xde, 0x37, 0x51, 0x2e, 0x31, 0x2e, 0x0, 0xd, 0x88, 0x3, 0xb9, 0x9e, 0x7b, 0x85, 0x75, 0x1a, 0x5d, 0x4d, 0x9e, 0x95, 0x6a, 0x0, 0xe, 0xec, 0xd3, 0xb9, 0x1e, 0xa6, 0x69, 0x5, 0x91, 0xd0, 0x68, 0x9d, 0xb, 0x1b, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xa4, 0x14, 0xb5, 0xe5};
  uint8_t bytesprops1[] = {0xad, 0x58, 0x9d, 0x23, 0x59, 0xef, 0x5a, 0xaa, 0xa1, 0x91, 0x44, 0x5f, 0x9f, 0x72, 0xe3, 0x3c, 0xf6, 0x25, 0xfc, 0xed, 0x68, 0xe6, 0x47, 0x19, 0x9e, 0xbf, 0x81, 0x0, 0x8e, 0x56};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 34}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25379}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&bytesprops1}}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xc5, 0xa6, 0xa6, 0x6c, 0x52, 0x55, 0xcd};
  uint8_t byteswillprops1[] = {0x7, 0x78, 0xba, 0x67, 0x21, 0x48, 0x13, 0x8a, 0xf7, 0x47, 0x73, 0xe4, 0x3d, 0x7a, 0xa2, 0x6e, 0xc3, 0x24, 0x4e, 0xc4, 0x26, 0xb6, 0x66, 0x6a, 0xb5, 0x63, 0x84, 0x79};
  uint8_t byteswillprops3[] = {0xaf, 0xab, 0xc6, 0xcc, 0xa1, 0x50, 0xde, 0x4b, 0x8d, 0x12, 0x25, 0x42, 0x70, 0xed, 0x87, 0x4f, 0xd, 0x45, 0xa5, 0x9};
  uint8_t byteswillprops2[] = {0x69, 0x62, 0x94, 0x95, 0x2e, 0xca, 0x5a, 0x20, 0x6, 0x8c, 0x88, 0x4e, 0x82, 0x4c, 0xc7, 0x49, 0x8a};
  uint8_t byteswillprops5[] = {0x9e, 0x43, 0x6b, 0x35, 0x1b, 0xad, 0xaf, 0x5c, 0x82, 0xb, 0x2f, 0xb0, 0xd1, 0x80, 0x4b, 0x15, 0xa, 0x9c, 0x29, 0xad};
  uint8_t byteswillprops4[] = {0x40, 0x6c, 0xf8, 0x3, 0xdd, 0x1, 0xa9, 0xc0, 0x17, 0xc0, 0x6b, 0xcd, 0x3e, 0x5a, 0xcf, 0xba, 0x36, 0x63, 0x2e, 0xc8, 0xb3, 0x2b, 0x33, 0x22, 0x24, 0x4a, 0x6, 0x13, 0x63, 0x10};
  uint8_t byteswillprops6[] = {0x2, 0x66, 0xe8, 0x92, 0x8, 0xbc, 0xe0, 0xfd, 0xe3, 0x4d, 0xec, 0x30, 0x76, 0x17, 0x87, 0x3c, 0xa0, 0xa4, 0xea, 0x1f, 0x25, 0xca, 0x11, 0x73};
  uint8_t byteswillprops7[] = {0x32, 0xfe, 0x92, 0xd7, 0x1b, 0x57, 0x2c, 0x8e, 0x57, 0x7a, 0xab, 0x5c, 0x23, 0xb, 0x5a, 0x34, 0xf0, 0x92, 0xd1, 0x26, 0x29, 0x16, 0x8c, 0x4e, 0xa9, 0x76};
  uint8_t byteswillprops8[] = {0x5c, 0x84, 0xa2, 0x28, 0x38, 0x12, 0xa3, 0xbc, 0x8a, 0x41, 0xf4, 0xf3, 0x6c, 0x4a, 0x5b, 0x7f, 0x75, 0xa0, 0x4a};
  uint8_t byteswillprops10[] = {0x9a, 0x54, 0xa6, 0xeb, 0x12, 0x0, 0x60, 0x8d, 0xbc, 0x5c, 0x7, 0x65, 0x6f, 0xbe, 0xf9};
  uint8_t byteswillprops9[] = {0x14, 0xba, 0xd9, 0x78, 0x0, 0x42, 0x94, 0xeb, 0x55, 0x45, 0x20, 0x76, 0x2d};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12229}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 12}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25969}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={17, (char*)&byteswillprops2}, .v={20, (char*)&byteswillprops3}}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29830}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={30, (char*)&byteswillprops4}, .v={20, (char*)&byteswillprops5}}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 30754}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 6}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21576}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 191}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 105}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&byteswillprops7}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 19080}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&byteswillprops8}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={13, (char*)&byteswillprops9}, .v={15, (char*)&byteswillprops10}}}},
  };

  lwmqtt_properties_t willprops = {20, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe0, 0x1b, 0x22, 0x10, 0x4d, 0xd, 0xa5, 0xee, 0x39, 0xe6, 0x8d};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x43, 0x81, 0x93, 0xde, 0x37, 0x51, 0x2e, 0x31, 0x2e};
  lwmqtt_string_t will_payload = {9, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS2;
will.retained = true;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 12875;
  uint8_t client_id_bytes[] = {0x6a};
  lwmqtt_string_t client_id = {1, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x88, 0x3, 0xb9, 0x9e, 0x7b, 0x85, 0x75, 0x1a, 0x5d, 0x4d, 0x9e, 0x95, 0x6a};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xec, 0xd3, 0xb9, 0x1e, 0xa6, 0x69, 0x5, 0x91, 0xd0, 0x68, 0x9d, 0xb, 0x1b, 0x21};
  lwmqtt_string_t password = {14, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// ConnectRequest {_username = Just "\CAN`l\229\237\255", _password = Just "\192o\213\179\182\245\198(\236\EOT\NAK/", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic = "\246\227\176\175_4\EOT{\143\204\150", _willMsg = "\209\190U\246\210\133\207\145\&9\229", _willProps = [PropWillDelayInterval 4001,PropMaximumQoS 57,PropCorrelationData "\244f7$\202%B\243\ACK\163\234F",PropPayloadFormatIndicator 247,PropMessageExpiryInterval 25320,PropAssignedClientIdentifier "G\182\246T\225\187d\CAN\153P\185\135\t\171",PropContentType "B\ETBg-oJN*\196\DEL\246>Cx\173zb\DC1",PropMaximumPacketSize 29438,PropTopicAliasMaximum 27453,PropMaximumPacketSize 28785,PropTopicAlias 12980,PropCorrelationData "\154t?\190\192\210\&8\149[x\151\241d&O1\176\\\205\170*k\193~\DEL\144\201\252",PropMaximumQoS 20,PropSharedSubscriptionAvailable 167,PropSessionExpiryInterval 29157,PropAuthenticationMethod "\206C(\DC4",PropResponseTopic "\167\STX\176Aj\150\&4\NAK\197\212;\228m\225\v\217\189\248\STXS",PropMessageExpiryInterval 27021,PropContentType "\201\DC3}x[~S\163r,\204?\SI\173\221\&9*X+?\137",PropContentType "\\M",PropWillDelayInterval 5654,PropCorrelationData "\137V\239}\209\243n$\204\196\201\GS\211\218",PropWillDelayInterval 15136,PropSharedSubscriptionAvailable 79]}), _cleanSession = True, _keepAlive = 67, _connID = "\246Q\170N+\132\254\213*\162\243\n", _properties = [PropReceiveMaximum 28097,PropReceiveMaximum 3524,PropWillDelayInterval 14155,PropServerKeepAlive 22395,PropCorrelationData "\DC1M\188\&6\200O\161U",PropSharedSubscriptionAvailable 152,PropAuthenticationData "\176zC\EOT\fn\166\175\153\fo\182\196?\183\244\237\199\202\234\254\152",PropCorrelationData "@\238\194\STX\226\SO-",PropSessionExpiryInterval 15111,PropPayloadFormatIndicator 144,PropAuthenticationData "\173\209\193\158\222\186\192e\DC4\182\136\DC4=5 \171\239y\190\224`\150",PropPayloadFormatIndicator 83]}
TEST(Connect5QCTest, Encode30) {
uint8_t pkt[] = {0x10, 0x82, 0x3, 0x0, 0x4, 0x4d, 0x51, 0x54, 0x54, 0x5, 0xce, 0x0, 0x43, 0x60, 0x21, 0x6d, 0xc1, 0x21, 0xd, 0xc4, 0x18, 0x0, 0x0, 0x37, 0x4b, 0x13, 0x57, 0x7b, 0x9, 0x0, 0x8, 0x11, 0x4d, 0xbc, 0x36, 0xc8, 0x4f, 0xa1, 0x55, 0x2a, 0x98, 0x16, 0x0, 0x16, 0xb0, 0x7a, 0x43, 0x4, 0xc, 0x6e, 0xa6, 0xaf, 0x99, 0xc, 0x6f, 0xb6, 0xc4, 0x3f, 0xb7, 0xf4, 0xed, 0xc7, 0xca, 0xea, 0xfe, 0x98, 0x9, 0x0, 0x7, 0x40, 0xee, 0xc2, 0x2, 0xe2, 0xe, 0x2d, 0x11, 0x0, 0x0, 0x3b, 0x7, 0x1, 0x90, 0x16, 0x0, 0x16, 0xad, 0xd1, 0xc1, 0x9e, 0xde, 0xba, 0xc0, 0x65, 0x14, 0xb6, 0x88, 0x14, 0x3d, 0x35, 0x20, 0xab, 0xef, 0x79, 0xbe, 0xe0, 0x60, 0x96, 0x1, 0x53, 0x0, 0xc, 0xf6, 0x51, 0xaa, 0x4e, 0x2b, 0x84, 0xfe, 0xd5, 0x2a, 0xa2, 0xf3, 0xa, 0xd8, 0x1, 0x18, 0x0, 0x0, 0xf, 0xa1, 0x24, 0x39, 0x9, 0x0, 0xc, 0xf4, 0x66, 0x37, 0x24, 0xca, 0x25, 0x42, 0xf3, 0x6, 0xa3, 0xea, 0x46, 0x1, 0xf7, 0x2, 0x0, 0x0, 0x62, 0xe8, 0x12, 0x0, 0xe, 0x47, 0xb6, 0xf6, 0x54, 0xe1, 0xbb, 0x64, 0x18, 0x99, 0x50, 0xb9, 0x87, 0x9, 0xab, 0x3, 0x0, 0x12, 0x42, 0x17, 0x67, 0x2d, 0x6f, 0x4a, 0x4e, 0x2a, 0xc4, 0x7f, 0xf6, 0x3e, 0x43, 0x78, 0xad, 0x7a, 0x62, 0x11, 0x27, 0x0, 0x0, 0x72, 0xfe, 0x22, 0x6b, 0x3d, 0x27, 0x0, 0x0, 0x70, 0x71, 0x23, 0x32, 0xb4, 0x9, 0x0, 0x1c, 0x9a, 0x74, 0x3f, 0xbe, 0xc0, 0xd2, 0x38, 0x95, 0x5b, 0x78, 0x97, 0xf1, 0x64, 0x26, 0x4f, 0x31, 0xb0, 0x5c, 0xcd, 0xaa, 0x2a, 0x6b, 0xc1, 0x7e, 0x7f, 0x90, 0xc9, 0xfc, 0x24, 0x14, 0x2a, 0xa7, 0x11, 0x0, 0x0, 0x71, 0xe5, 0x15, 0x0, 0x4, 0xce, 0x43, 0x28, 0x14, 0x8, 0x0, 0x14, 0xa7, 0x2, 0xb0, 0x41, 0x6a, 0x96, 0x34, 0x15, 0xc5, 0xd4, 0x3b, 0xe4, 0x6d, 0xe1, 0xb, 0xd9, 0xbd, 0xf8, 0x2, 0x53, 0x2, 0x0, 0x0, 0x69, 0x8d, 0x3, 0x0, 0x15, 0xc9, 0x13, 0x7d, 0x78, 0x5b, 0x7e, 0x53, 0xa3, 0x72, 0x2c, 0xcc, 0x3f, 0xf, 0xad, 0xdd, 0x39, 0x2a, 0x58, 0x2b, 0x3f, 0x89, 0x3, 0x0, 0x2, 0x5c, 0x4d, 0x18, 0x0, 0x0, 0x16, 0x16, 0x9, 0x0, 0xe, 0x89, 0x56, 0xef, 0x7d, 0xd1, 0xf3, 0x6e, 0x24, 0xcc, 0xc4, 0xc9, 0x1d, 0xd3, 0xda, 0x18, 0x0, 0x0, 0x3b, 0x20, 0x2a, 0x4f, 0x0, 0xb, 0xf6, 0xe3, 0xb0, 0xaf, 0x5f, 0x34, 0x4, 0x7b, 0x8f, 0xcc, 0x96, 0x0, 0xa, 0xd1, 0xbe, 0x55, 0xf6, 0xd2, 0x85, 0xcf, 0x91, 0x39, 0xe5, 0x0, 0x6, 0x18, 0x60, 0x6c, 0xe5, 0xed, 0xff, 0x0, 0xc, 0xc0, 0x6f, 0xd5, 0xb3, 0xb6, 0xf5, 0xc6, 0x28, 0xec, 0x4, 0x15, 0x2f};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x11, 0x4d, 0xbc, 0x36, 0xc8, 0x4f, 0xa1, 0x55};
  uint8_t bytesprops1[] = {0xb0, 0x7a, 0x43, 0x4, 0xc, 0x6e, 0xa6, 0xaf, 0x99, 0xc, 0x6f, 0xb6, 0xc4, 0x3f, 0xb7, 0xf4, 0xed, 0xc7, 0xca, 0xea, 0xfe, 0x98};
  uint8_t bytesprops2[] = {0x40, 0xee, 0xc2, 0x2, 0xe2, 0xe, 0x2d};
  uint8_t bytesprops3[] = {0xad, 0xd1, 0xc1, 0x9e, 0xde, 0xba, 0xc0, 0x65, 0x14, 0xb6, 0x88, 0x14, 0x3d, 0x35, 0x20, 0xab, 0xef, 0x79, 0xbe, 0xe0, 0x60, 0x96};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 28097}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3524}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 14155}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22395}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {8, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 152}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 15111}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 144}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 83}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xf4, 0x66, 0x37, 0x24, 0xca, 0x25, 0x42, 0xf3, 0x6, 0xa3, 0xea, 0x46};
  uint8_t byteswillprops1[] = {0x47, 0xb6, 0xf6, 0x54, 0xe1, 0xbb, 0x64, 0x18, 0x99, 0x50, 0xb9, 0x87, 0x9, 0xab};
  uint8_t byteswillprops2[] = {0x42, 0x17, 0x67, 0x2d, 0x6f, 0x4a, 0x4e, 0x2a, 0xc4, 0x7f, 0xf6, 0x3e, 0x43, 0x78, 0xad, 0x7a, 0x62, 0x11};
  uint8_t byteswillprops3[] = {0x9a, 0x74, 0x3f, 0xbe, 0xc0, 0xd2, 0x38, 0x95, 0x5b, 0x78, 0x97, 0xf1, 0x64, 0x26, 0x4f, 0x31, 0xb0, 0x5c, 0xcd, 0xaa, 0x2a, 0x6b, 0xc1, 0x7e, 0x7f, 0x90, 0xc9, 0xfc};
  uint8_t byteswillprops4[] = {0xce, 0x43, 0x28, 0x14};
  uint8_t byteswillprops5[] = {0xa7, 0x2, 0xb0, 0x41, 0x6a, 0x96, 0x34, 0x15, 0xc5, 0xd4, 0x3b, 0xe4, 0x6d, 0xe1, 0xb, 0xd9, 0xbd, 0xf8, 0x2, 0x53};
  uint8_t byteswillprops6[] = {0xc9, 0x13, 0x7d, 0x78, 0x5b, 0x7e, 0x53, 0xa3, 0x72, 0x2c, 0xcc, 0x3f, 0xf, 0xad, 0xdd, 0x39, 0x2a, 0x58, 0x2b, 0x3f, 0x89};
  uint8_t byteswillprops7[] = {0x5c, 0x4d};
  uint8_t byteswillprops8[] = {0x89, 0x56, 0xef, 0x7d, 0xd1, 0xf3, 0x6e, 0x24, 0xcc, 0xc4, 0xc9, 0x1d, 0xd3, 0xda};
  
  lwmqtt_property_t willpropslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4001}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 57}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&byteswillprops0}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 247}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25320}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {14, (char*)&byteswillprops1}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&byteswillprops2}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 29438}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 27453}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 28785}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 12980}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {28, (char*)&byteswillprops3}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 20}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 167}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 29157}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&byteswillprops4}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&byteswillprops5}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27021}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&byteswillprops6}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&byteswillprops7}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5654}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&byteswillprops8}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 15136}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 79}},
  };

  lwmqtt_properties_t willprops = {24, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xf6, 0xe3, 0xb0, 0xaf, 0x5f, 0x34, 0x4, 0x7b, 0x8f, 0xcc, 0x96};
  lwmqtt_string_t will_topic = {11, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xd1, 0xbe, 0x55, 0xf6, 0xd2, 0x85, 0xcf, 0x91, 0x39, 0xe5};
  lwmqtt_string_t will_payload = {10, (char*)&will_payload_bytes};
will.topic = will_topic;
will.payload   = will_payload;
will.qos = LWMQTT_QOS1;
will.retained = false;
will.properties = willprops;
lwmqtt_options_t opts = lwmqtt_default_options;
opts.properties = props;
opts.clean_session = true;
opts.keep_alive = 67;
  uint8_t client_id_bytes[] = {0xf6, 0x51, 0xaa, 0x4e, 0x2b, 0x84, 0xfe, 0xd5, 0x2a, 0xa2, 0xf3, 0xa};
  lwmqtt_string_t client_id = {12, (char*)&client_id_bytes};
opts.client_id = client_id;
  uint8_t username_bytes[] = {0x18, 0x60, 0x6c, 0xe5, 0xed, 0xff};
  lwmqtt_string_t username = {6, (char*)&username_bytes};
opts.username = username;
  uint8_t password_bytes[] = {0xc0, 0x6f, 0xd5, 0xb3, 0xb6, 0xf5, 0xc6, 0x28, 0xec, 0x4, 0x15, 0x2f};
  lwmqtt_string_t password = {12, (char*)&password_bytes};
opts.password = password;
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 2235 [("\ETB\166",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode1) {
uint8_t pkt[] = {0x82, 0x7, 0x8, 0xbb, 0x0, 0x2, 0x17, 0xa6, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x17, 0xa6};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2235, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 29400 [("\212\DELo=\194\186\&8\213\&6\b,\218\ENQ\155\244\161a\159\ACK\242\223\233\ACK\SYN6",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\174~\129qh",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("]\227w\FS\n\152\156\253\203\254\v\GS\210(\226\v\EM3[\242\222\232\132Q\168",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\128\&1\237)\RS\197\ETX\206~I\228\227\&6\250\192",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\243\&8\184<\190N\253\&8W\223\234Fz\221`\148\176\134\&0",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\222\162\216\&7\t",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("9\EM\253\233\240M\232\ACK\223^|\r\141\205",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\147\255\160\143\132\225\&4\223\147\145\161\211\149\230\&4p\181",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\140\167\v\DLE\221\215\250;d}?\220\&0\"\DC2\178 \169,*\172\131HV\174",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\149\SI\158\RS\147\170\156\220\146",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode2) {
uint8_t pkt[] = {0x82, 0xc2, 0x1, 0x72, 0xd8, 0x0, 0x19, 0xd4, 0x7f, 0x6f, 0x3d, 0xc2, 0xba, 0x38, 0xd5, 0x36, 0x8, 0x2c, 0xda, 0x5, 0x9b, 0xf4, 0xa1, 0x61, 0x9f, 0x6, 0xf2, 0xdf, 0xe9, 0x6, 0x16, 0x36, 0x2, 0x0, 0x5, 0xae, 0x7e, 0x81, 0x71, 0x68, 0x0, 0x0, 0x19, 0x5d, 0xe3, 0x77, 0x1c, 0xa, 0x98, 0x9c, 0xfd, 0xcb, 0xfe, 0xb, 0x1d, 0xd2, 0x28, 0xe2, 0xb, 0x19, 0x33, 0x5b, 0xf2, 0xde, 0xe8, 0x84, 0x51, 0xa8, 0x2, 0x0, 0xf, 0x80, 0x31, 0xed, 0x29, 0x1e, 0xc5, 0x3, 0xce, 0x7e, 0x49, 0xe4, 0xe3, 0x36, 0xfa, 0xc0, 0x1, 0x0, 0x13, 0xf3, 0x38, 0xb8, 0x3c, 0xbe, 0x4e, 0xfd, 0x38, 0x57, 0xdf, 0xea, 0x46, 0x7a, 0xdd, 0x60, 0x94, 0xb0, 0x86, 0x30, 0x0, 0x0, 0x5, 0xde, 0xa2, 0xd8, 0x37, 0x9, 0x2, 0x0, 0xe, 0x39, 0x19, 0xfd, 0xe9, 0xf0, 0x4d, 0xe8, 0x6, 0xdf, 0x5e, 0x7c, 0xd, 0x8d, 0xcd, 0x2, 0x0, 0x0, 0x1, 0x0, 0x11, 0x93, 0xff, 0xa0, 0x8f, 0x84, 0xe1, 0x34, 0xdf, 0x93, 0x91, 0xa1, 0xd3, 0x95, 0xe6, 0x34, 0x70, 0xb5, 0x0, 0x0, 0x19, 0x8c, 0xa7, 0xb, 0x10, 0xdd, 0xd7, 0xfa, 0x3b, 0x64, 0x7d, 0x3f, 0xdc, 0x30, 0x22, 0x12, 0xb2, 0x20, 0xa9, 0x2c, 0x2a, 0xac, 0x83, 0x48, 0x56, 0xae, 0x0, 0x0, 0x9, 0x95, 0xf, 0x9e, 0x1e, 0x93, 0xaa, 0x9c, 0xdc, 0x92, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xd4, 0x7f, 0x6f, 0x3d, 0xc2, 0xba, 0x38, 0xd5, 0x36, 0x8, 0x2c, 0xda, 0x5, 0x9b, 0xf4, 0xa1, 0x61, 0x9f, 0x6, 0xf2, 0xdf, 0xe9, 0x6, 0x16, 0x36};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0x7e, 0x81, 0x71, 0x68};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5d, 0xe3, 0x77, 0x1c, 0xa, 0x98, 0x9c, 0xfd, 0xcb, 0xfe, 0xb, 0x1d, 0xd2, 0x28, 0xe2, 0xb, 0x19, 0x33, 0x5b, 0xf2, 0xde, 0xe8, 0x84, 0x51, 0xa8};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x80, 0x31, 0xed, 0x29, 0x1e, 0xc5, 0x3, 0xce, 0x7e, 0x49, 0xe4, 0xe3, 0x36, 0xfa, 0xc0};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf3, 0x38, 0xb8, 0x3c, 0xbe, 0x4e, 0xfd, 0x38, 0x57, 0xdf, 0xea, 0x46, 0x7a, 0xdd, 0x60, 0x94, 0xb0, 0x86, 0x30};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xde, 0xa2, 0xd8, 0x37, 0x9};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x39, 0x19, 0xfd, 0xe9, 0xf0, 0x4d, 0xe8, 0x6, 0xdf, 0x5e, 0x7c, 0xd, 0x8d, 0xcd};
  lwmqtt_string_t topic_filter_s6 = {14, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x93, 0xff, 0xa0, 0x8f, 0x84, 0xe1, 0x34, 0xdf, 0x93, 0x91, 0xa1, 0xd3, 0x95, 0xe6, 0x34, 0x70, 0xb5};
  lwmqtt_string_t topic_filter_s8 = {17, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x8c, 0xa7, 0xb, 0x10, 0xdd, 0xd7, 0xfa, 0x3b, 0x64, 0x7d, 0x3f, 0xdc, 0x30, 0x22, 0x12, 0xb2, 0x20, 0xa9, 0x2c, 0x2a, 0xac, 0x83, 0x48, 0x56, 0xae};
  lwmqtt_string_t topic_filter_s9 = {25, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x95, 0xf, 0x9e, 0x1e, 0x93, 0xaa, 0x9c, 0xdc, 0x92};
  lwmqtt_string_t topic_filter_s10 = {9, (char*)&topic_filter_s10_bytes};
topic_filters[10] = topic_filter_s10;
lwmqtt_sub_options_t sub_opts[11];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS1;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS0;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
sub_opts[9].qos = LWMQTT_QOS0;
sub_opts[9].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[9].retain_as_published = false;
sub_opts[9].no_local = false;
sub_opts[10].qos = LWMQTT_QOS2;
sub_opts[10].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[10].retain_as_published = false;
sub_opts[10].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 29400, 11, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 11000 [("\154\198\171-\233\SYNUL\216%\n\196\&6\192\157\&0\159\216\186k\249\227>K\DC3\236",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("w7jl\r\b\213",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\EOT\185\158\227\RSDU",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("6U",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\141\150T,\250\229\217f\217\SO\239FB\251\CAN",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),(")\254=\198'J\DC1\DC1$\210av\158m\162)\146\132\224\191\n\232\145",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("BK\228\209\196\156\140\244?2\144\USP3z2..\DC2`\129D",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\SO\154",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode3) {
uint8_t pkt[] = {0x82, 0x85, 0x1, 0x2a, 0xf8, 0x0, 0x1a, 0x9a, 0xc6, 0xab, 0x2d, 0xe9, 0x16, 0x55, 0x4c, 0xd8, 0x25, 0xa, 0xc4, 0x36, 0xc0, 0x9d, 0x30, 0x9f, 0xd8, 0xba, 0x6b, 0xf9, 0xe3, 0x3e, 0x4b, 0x13, 0xec, 0x0, 0x0, 0x7, 0x77, 0x37, 0x6a, 0x6c, 0xd, 0x8, 0xd5, 0x2, 0x0, 0x7, 0x4, 0xb9, 0x9e, 0xe3, 0x1e, 0x44, 0x55, 0x0, 0x0, 0x2, 0x36, 0x55, 0x1, 0x0, 0xf, 0x8d, 0x96, 0x54, 0x2c, 0xfa, 0xe5, 0xd9, 0x66, 0xd9, 0xe, 0xef, 0x46, 0x42, 0xfb, 0x18, 0x0, 0x0, 0x0, 0x0, 0x0, 0x17, 0x29, 0xfe, 0x3d, 0xc6, 0x27, 0x4a, 0x11, 0x11, 0x24, 0xd2, 0x61, 0x76, 0x9e, 0x6d, 0xa2, 0x29, 0x92, 0x84, 0xe0, 0xbf, 0xa, 0xe8, 0x91, 0x0, 0x0, 0x16, 0x42, 0x4b, 0xe4, 0xd1, 0xc4, 0x9c, 0x8c, 0xf4, 0x3f, 0x32, 0x90, 0x1f, 0x50, 0x33, 0x7a, 0x32, 0x2e, 0x2e, 0x12, 0x60, 0x81, 0x44, 0x0, 0x0, 0x2, 0xe, 0x9a, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x9a, 0xc6, 0xab, 0x2d, 0xe9, 0x16, 0x55, 0x4c, 0xd8, 0x25, 0xa, 0xc4, 0x36, 0xc0, 0x9d, 0x30, 0x9f, 0xd8, 0xba, 0x6b, 0xf9, 0xe3, 0x3e, 0x4b, 0x13, 0xec};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x77, 0x37, 0x6a, 0x6c, 0xd, 0x8, 0xd5};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4, 0xb9, 0x9e, 0xe3, 0x1e, 0x44, 0x55};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x36, 0x55};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8d, 0x96, 0x54, 0x2c, 0xfa, 0xe5, 0xd9, 0x66, 0xd9, 0xe, 0xef, 0x46, 0x42, 0xfb, 0x18};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x29, 0xfe, 0x3d, 0xc6, 0x27, 0x4a, 0x11, 0x11, 0x24, 0xd2, 0x61, 0x76, 0x9e, 0x6d, 0xa2, 0x29, 0x92, 0x84, 0xe0, 0xbf, 0xa, 0xe8, 0x91};
  lwmqtt_string_t topic_filter_s6 = {23, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x42, 0x4b, 0xe4, 0xd1, 0xc4, 0x9c, 0x8c, 0xf4, 0x3f, 0x32, 0x90, 0x1f, 0x50, 0x33, 0x7a, 0x32, 0x2e, 0x2e, 0x12, 0x60, 0x81, 0x44};
  lwmqtt_string_t topic_filter_s7 = {22, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xe, 0x9a};
  lwmqtt_string_t topic_filter_s8 = {2, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 11000, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21792 [("6\208Y0\251\199\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("GX\147{(\182\223\141\GSB;\164\153/\133\DC2s",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode4) {
uint8_t pkt[] = {0x82, 0x20, 0x55, 0x20, 0x0, 0x7, 0x36, 0xd0, 0x59, 0x30, 0xfb, 0xc7, 0x19, 0x1, 0x0, 0x11, 0x47, 0x58, 0x93, 0x7b, 0x28, 0xb6, 0xdf, 0x8d, 0x1d, 0x42, 0x3b, 0xa4, 0x99, 0x2f, 0x85, 0x12, 0x73, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x36, 0xd0, 0x59, 0x30, 0xfb, 0xc7, 0x19};
  lwmqtt_string_t topic_filter_s0 = {7, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x47, 0x58, 0x93, 0x7b, 0x28, 0xb6, 0xdf, 0x8d, 0x1d, 0x42, 0x3b, 0xa4, 0x99, 0x2f, 0x85, 0x12, 0x73};
  lwmqtt_string_t topic_filter_s1 = {17, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
lwmqtt_sub_options_t sub_opts[2];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21792, 2, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 20269 [("\220\133\254]\185%\213_\189\199t$[\170m\232m\SOf3c\226",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode5) {
uint8_t pkt[] = {0x82, 0x1b, 0x4f, 0x2d, 0x0, 0x16, 0xdc, 0x85, 0xfe, 0x5d, 0xb9, 0x25, 0xd5, 0x5f, 0xbd, 0xc7, 0x74, 0x24, 0x5b, 0xaa, 0x6d, 0xe8, 0x6d, 0xe, 0x66, 0x33, 0x63, 0xe2, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xdc, 0x85, 0xfe, 0x5d, 0xb9, 0x25, 0xd5, 0x5f, 0xbd, 0xc7, 0x74, 0x24, 0x5b, 0xaa, 0x6d, 0xe8, 0x6d, 0xe, 0x66, 0x33, 0x63, 0xe2};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 20269, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 27793 [("\175\175\230\214\&2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),(",\DEL[\SO\253\205\b\135j\ESC\217",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\224\206y\244\197V\182\157Q\232\248H\131\180\228B\FS\DC2\SO\159\243w",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\197\204\211\195h[\RSa&\150PL\SO\231\187\173\192P|q\240\r\139-\232\197",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\164\169|\199\van\145$\211<3\180)>\173Xgz:\225\DC4\163\212\141\177h",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\SUBl",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode6) {
uint8_t pkt[] = {0x82, 0x71, 0x6c, 0x91, 0x0, 0x5, 0xaf, 0xaf, 0xe6, 0xd6, 0x32, 0x1, 0x0, 0xb, 0x2c, 0x7f, 0x5b, 0xe, 0xfd, 0xcd, 0x8, 0x87, 0x6a, 0x1b, 0xd9, 0x0, 0x0, 0x16, 0xe0, 0xce, 0x79, 0xf4, 0xc5, 0x56, 0xb6, 0x9d, 0x51, 0xe8, 0xf8, 0x48, 0x83, 0xb4, 0xe4, 0x42, 0x1c, 0x12, 0xe, 0x9f, 0xf3, 0x77, 0x1, 0x0, 0x1a, 0xc5, 0xcc, 0xd3, 0xc3, 0x68, 0x5b, 0x1e, 0x61, 0x26, 0x96, 0x50, 0x4c, 0xe, 0xe7, 0xbb, 0xad, 0xc0, 0x50, 0x7c, 0x71, 0xf0, 0xd, 0x8b, 0x2d, 0xe8, 0xc5, 0x0, 0x0, 0x1b, 0xa4, 0xa9, 0x7c, 0xc7, 0xb, 0x61, 0x6e, 0x91, 0x24, 0xd3, 0x3c, 0x33, 0xb4, 0x29, 0x3e, 0xad, 0x58, 0x67, 0x7a, 0x3a, 0xe1, 0x14, 0xa3, 0xd4, 0x8d, 0xb1, 0x68, 0x1, 0x0, 0x2, 0x1a, 0x6c, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0xaf, 0xaf, 0xe6, 0xd6, 0x32};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2c, 0x7f, 0x5b, 0xe, 0xfd, 0xcd, 0x8, 0x87, 0x6a, 0x1b, 0xd9};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe0, 0xce, 0x79, 0xf4, 0xc5, 0x56, 0xb6, 0x9d, 0x51, 0xe8, 0xf8, 0x48, 0x83, 0xb4, 0xe4, 0x42, 0x1c, 0x12, 0xe, 0x9f, 0xf3, 0x77};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc5, 0xcc, 0xd3, 0xc3, 0x68, 0x5b, 0x1e, 0x61, 0x26, 0x96, 0x50, 0x4c, 0xe, 0xe7, 0xbb, 0xad, 0xc0, 0x50, 0x7c, 0x71, 0xf0, 0xd, 0x8b, 0x2d, 0xe8, 0xc5};
  lwmqtt_string_t topic_filter_s3 = {26, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xa4, 0xa9, 0x7c, 0xc7, 0xb, 0x61, 0x6e, 0x91, 0x24, 0xd3, 0x3c, 0x33, 0xb4, 0x29, 0x3e, 0xad, 0x58, 0x67, 0x7a, 0x3a, 0xe1, 0x14, 0xa3, 0xd4, 0x8d, 0xb1, 0x68};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x1a, 0x6c};
  lwmqtt_string_t topic_filter_s5 = {2, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
lwmqtt_sub_options_t sub_opts[6];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 27793, 6, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 30311 [("a\220\187\230\175\184\177\131\&8n\180}\229Z",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\234\199\181\DC1N\b",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode7) {
uint8_t pkt[] = {0x82, 0x1f, 0x76, 0x67, 0x0, 0xe, 0x61, 0xdc, 0xbb, 0xe6, 0xaf, 0xb8, 0xb1, 0x83, 0x38, 0x6e, 0xb4, 0x7d, 0xe5, 0x5a, 0x0, 0x0, 0x6, 0xea, 0xc7, 0xb5, 0x11, 0x4e, 0x8, 0x2, 0x0, 0x0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x61, 0xdc, 0xbb, 0xe6, 0xaf, 0xb8, 0xb1, 0x83, 0x38, 0x6e, 0xb4, 0x7d, 0xe5, 0x5a};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xea, 0xc7, 0xb5, 0x11, 0x4e, 0x8};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 30311, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 32651 [("\168U\NULn\148",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k\141i\169",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\ESC\250F\175_R",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\187\219|!\193M\251\187\176h\ETB",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\155m$\224\202\136\212\255\150=\242\197\195P\SUB\211",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\193\143\128\SOH5\150K6\STX",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode8) {
uint8_t pkt[] = {0x82, 0x47, 0x7f, 0x8b, 0x0, 0x5, 0xa8, 0x55, 0x0, 0x6e, 0x94, 0x0, 0x0, 0x4, 0x6b, 0x8d, 0x69, 0xa9, 0x1, 0x0, 0x6, 0x1b, 0xfa, 0x46, 0xaf, 0x5f, 0x52, 0x2, 0x0, 0xb, 0xbb, 0xdb, 0x7c, 0x21, 0xc1, 0x4d, 0xfb, 0xbb, 0xb0, 0x68, 0x17, 0x0, 0x0, 0x10, 0x9b, 0x6d, 0x24, 0xe0, 0xca, 0x88, 0xd4, 0xff, 0x96, 0x3d, 0xf2, 0xc5, 0xc3, 0x50, 0x1a, 0xd3, 0x2, 0x0, 0x9, 0xc1, 0x8f, 0x80, 0x1, 0x35, 0x96, 0x4b, 0x36, 0x2, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0xa8, 0x55, 0x0, 0x6e, 0x94};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6b, 0x8d, 0x69, 0xa9};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1b, 0xfa, 0x46, 0xaf, 0x5f, 0x52};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xbb, 0xdb, 0x7c, 0x21, 0xc1, 0x4d, 0xfb, 0xbb, 0xb0, 0x68, 0x17};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0x6d, 0x24, 0xe0, 0xca, 0x88, 0xd4, 0xff, 0x96, 0x3d, 0xf2, 0xc5, 0xc3, 0x50, 0x1a, 0xd3};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xc1, 0x8f, 0x80, 0x1, 0x35, 0x96, 0x4b, 0x36, 0x2};
  lwmqtt_string_t topic_filter_s5 = {9, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
lwmqtt_sub_options_t sub_opts[6];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 32651, 6, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 15465 [("\234y<\176R ]*\193\136",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\DC3v\b\SOH9",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("6'\ACK}p\CAN\144g\147~\200\182&\173\176\128%ev\142\SIT\254\138\&1h\US\169\210R",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode9) {
uint8_t pkt[] = {0x82, 0x38, 0x3c, 0x69, 0x0, 0xa, 0xea, 0x79, 0x3c, 0xb0, 0x52, 0x20, 0x5d, 0x2a, 0xc1, 0x88, 0x1, 0x0, 0x5, 0x13, 0x76, 0x8, 0x1, 0x39, 0x1, 0x0, 0x1e, 0x36, 0x27, 0x6, 0x7d, 0x70, 0x18, 0x90, 0x67, 0x93, 0x7e, 0xc8, 0xb6, 0x26, 0xad, 0xb0, 0x80, 0x25, 0x65, 0x76, 0x8e, 0xf, 0x54, 0xfe, 0x8a, 0x31, 0x68, 0x1f, 0xa9, 0xd2, 0x52, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xea, 0x79, 0x3c, 0xb0, 0x52, 0x20, 0x5d, 0x2a, 0xc1, 0x88};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x13, 0x76, 0x8, 0x1, 0x39};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x36, 0x27, 0x6, 0x7d, 0x70, 0x18, 0x90, 0x67, 0x93, 0x7e, 0xc8, 0xb6, 0x26, 0xad, 0xb0, 0x80, 0x25, 0x65, 0x76, 0x8e, 0xf, 0x54, 0xfe, 0x8a, 0x31, 0x68, 0x1f, 0xa9, 0xd2, 0x52};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 15465, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 31381 [("\230\234.\186\229\249Tuf\222\188\DC4 \193J\t\DLE}\156<\255\150\156\146\136\132\a",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\143\&6\250ODD\155\192\210\157\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\240ni\SUB}\189/\167\&4\ACK\213\129o\150",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode10) {
uint8_t pkt[] = {0x82, 0x3f, 0x7a, 0x95, 0x0, 0x1b, 0xe6, 0xea, 0x2e, 0xba, 0xe5, 0xf9, 0x54, 0x75, 0x66, 0xde, 0xbc, 0x14, 0x20, 0xc1, 0x4a, 0x9, 0x10, 0x7d, 0x9c, 0x3c, 0xff, 0x96, 0x9c, 0x92, 0x88, 0x84, 0x7, 0x2, 0x0, 0xb, 0x8f, 0x36, 0xfa, 0x4f, 0x44, 0x44, 0x9b, 0xc0, 0xd2, 0x9d, 0x98, 0x1, 0x0, 0xe, 0xf0, 0x6e, 0x69, 0x1a, 0x7d, 0xbd, 0x2f, 0xa7, 0x34, 0x6, 0xd5, 0x81, 0x6f, 0x96, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xe6, 0xea, 0x2e, 0xba, 0xe5, 0xf9, 0x54, 0x75, 0x66, 0xde, 0xbc, 0x14, 0x20, 0xc1, 0x4a, 0x9, 0x10, 0x7d, 0x9c, 0x3c, 0xff, 0x96, 0x9c, 0x92, 0x88, 0x84, 0x7};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8f, 0x36, 0xfa, 0x4f, 0x44, 0x44, 0x9b, 0xc0, 0xd2, 0x9d, 0x98};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf0, 0x6e, 0x69, 0x1a, 0x7d, 0xbd, 0x2f, 0xa7, 0x34, 0x6, 0xd5, 0x81, 0x6f, 0x96};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 31381, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 25357 [("+\142\146\175\bU\244B\225\175s\255)",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode11) {
uint8_t pkt[] = {0x82, 0x12, 0x63, 0xd, 0x0, 0xd, 0x2b, 0x8e, 0x92, 0xaf, 0x8, 0x55, 0xf4, 0x42, 0xe1, 0xaf, 0x73, 0xff, 0x29, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x2b, 0x8e, 0x92, 0xaf, 0x8, 0x55, 0xf4, 0x42, 0xe1, 0xaf, 0x73, 0xff, 0x29};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25357, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21412 [("w\218]r\ESC\143<q\242L",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode12) {
uint8_t pkt[] = {0x82, 0xf, 0x53, 0xa4, 0x0, 0xa, 0x77, 0xda, 0x5d, 0x72, 0x1b, 0x8f, 0x3c, 0x71, 0xf2, 0x4c, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x77, 0xda, 0x5d, 0x72, 0x1b, 0x8f, 0x3c, 0x71, 0xf2, 0x4c};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21412, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 10276 [("\SYN\144\218\230l\154\217\219\225\DLE\150m\141\195\222\183#N\DC1\219)\226\a\206y\204\150\RS\214\178",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("R\229\195\208\168\199\145\206\150\202|l\251\139`[\165@GL\SI\229\191!\183s\t\184\153",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode13) {
uint8_t pkt[] = {0x82, 0x43, 0x28, 0x24, 0x0, 0x1e, 0x16, 0x90, 0xda, 0xe6, 0x6c, 0x9a, 0xd9, 0xdb, 0xe1, 0x10, 0x96, 0x6d, 0x8d, 0xc3, 0xde, 0xb7, 0x23, 0x4e, 0x11, 0xdb, 0x29, 0xe2, 0x7, 0xce, 0x79, 0xcc, 0x96, 0x1e, 0xd6, 0xb2, 0x0, 0x0, 0x1d, 0x52, 0xe5, 0xc3, 0xd0, 0xa8, 0xc7, 0x91, 0xce, 0x96, 0xca, 0x7c, 0x6c, 0xfb, 0x8b, 0x60, 0x5b, 0xa5, 0x40, 0x47, 0x4c, 0xf, 0xe5, 0xbf, 0x21, 0xb7, 0x73, 0x9, 0xb8, 0x99, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x16, 0x90, 0xda, 0xe6, 0x6c, 0x9a, 0xd9, 0xdb, 0xe1, 0x10, 0x96, 0x6d, 0x8d, 0xc3, 0xde, 0xb7, 0x23, 0x4e, 0x11, 0xdb, 0x29, 0xe2, 0x7, 0xce, 0x79, 0xcc, 0x96, 0x1e, 0xd6, 0xb2};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x52, 0xe5, 0xc3, 0xd0, 0xa8, 0xc7, 0x91, 0xce, 0x96, 0xca, 0x7c, 0x6c, 0xfb, 0x8b, 0x60, 0x5b, 0xa5, 0x40, 0x47, 0x4c, 0xf, 0xe5, 0xbf, 0x21, 0xb7, 0x73, 0x9, 0xb8, 0x99};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
lwmqtt_sub_options_t sub_opts[2];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10276, 2, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 7750 [("\191\131\229\247n\DC4\170]A\183\163\132",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\209U\"`\185\222\252RC|G\202#\161P\240\SYN\DLE;@\172\251\188dV",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\188t\246J\ETX\174",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\154<\139\";}\250\187\&0pG\224\173\148\216\238#R\187\168\142\190",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("}\146\176\ncE\212\185:\132-\DLE9\ETB[r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("m\DC3\169\GSX\164\&5\158\RS\153\235W8\CANp",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\151\209",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("$U\214\224\143\199M\166v\143\&6\241\STX\DC2U\245\144\153\135n\161\146\SOH",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\247\ACK\228'\209\245\RS\\\148\ACK\254\187\255gl\215",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\229rp:\145\167\ACK\191\188\195\US\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode14) {
uint8_t pkt[] = {0x82, 0xb5, 0x1, 0x1e, 0x46, 0x0, 0xc, 0xbf, 0x83, 0xe5, 0xf7, 0x6e, 0x14, 0xaa, 0x5d, 0x41, 0xb7, 0xa3, 0x84, 0x2, 0x0, 0x19, 0xd1, 0x55, 0x22, 0x60, 0xb9, 0xde, 0xfc, 0x52, 0x43, 0x7c, 0x47, 0xca, 0x23, 0xa1, 0x50, 0xf0, 0x16, 0x10, 0x3b, 0x40, 0xac, 0xfb, 0xbc, 0x64, 0x56, 0x1, 0x0, 0x6, 0xbc, 0x74, 0xf6, 0x4a, 0x3, 0xae, 0x1, 0x0, 0x16, 0x9a, 0x3c, 0x8b, 0x22, 0x3b, 0x7d, 0xfa, 0xbb, 0x30, 0x70, 0x47, 0xe0, 0xad, 0x94, 0xd8, 0xee, 0x23, 0x52, 0xbb, 0xa8, 0x8e, 0xbe, 0x2, 0x0, 0x10, 0x7d, 0x92, 0xb0, 0xa, 0x63, 0x45, 0xd4, 0xb9, 0x3a, 0x84, 0x2d, 0x10, 0x39, 0x17, 0x5b, 0x72, 0x2, 0x0, 0xf, 0x6d, 0x13, 0xa9, 0x1d, 0x58, 0xa4, 0x35, 0x9e, 0x1e, 0x99, 0xeb, 0x57, 0x38, 0x18, 0x70, 0x0, 0x0, 0x2, 0x97, 0xd1, 0x0, 0x0, 0x17, 0x24, 0x55, 0xd6, 0xe0, 0x8f, 0xc7, 0x4d, 0xa6, 0x76, 0x8f, 0x36, 0xf1, 0x2, 0x12, 0x55, 0xf5, 0x90, 0x99, 0x87, 0x6e, 0xa1, 0x92, 0x1, 0x2, 0x0, 0x10, 0xf7, 0x6, 0xe4, 0x27, 0xd1, 0xf5, 0x1e, 0x5c, 0x94, 0x6, 0xfe, 0xbb, 0xff, 0x67, 0x6c, 0xd7, 0x1, 0x0, 0xc, 0xe5, 0x72, 0x70, 0x3a, 0x91, 0xa7, 0x6, 0xbf, 0xbc, 0xc3, 0x1f, 0x5c, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0xbf, 0x83, 0xe5, 0xf7, 0x6e, 0x14, 0xaa, 0x5d, 0x41, 0xb7, 0xa3, 0x84};
  lwmqtt_string_t topic_filter_s0 = {12, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd1, 0x55, 0x22, 0x60, 0xb9, 0xde, 0xfc, 0x52, 0x43, 0x7c, 0x47, 0xca, 0x23, 0xa1, 0x50, 0xf0, 0x16, 0x10, 0x3b, 0x40, 0xac, 0xfb, 0xbc, 0x64, 0x56};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbc, 0x74, 0xf6, 0x4a, 0x3, 0xae};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x9a, 0x3c, 0x8b, 0x22, 0x3b, 0x7d, 0xfa, 0xbb, 0x30, 0x70, 0x47, 0xe0, 0xad, 0x94, 0xd8, 0xee, 0x23, 0x52, 0xbb, 0xa8, 0x8e, 0xbe};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x7d, 0x92, 0xb0, 0xa, 0x63, 0x45, 0xd4, 0xb9, 0x3a, 0x84, 0x2d, 0x10, 0x39, 0x17, 0x5b, 0x72};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6d, 0x13, 0xa9, 0x1d, 0x58, 0xa4, 0x35, 0x9e, 0x1e, 0x99, 0xeb, 0x57, 0x38, 0x18, 0x70};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x97, 0xd1};
  lwmqtt_string_t topic_filter_s6 = {2, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x24, 0x55, 0xd6, 0xe0, 0x8f, 0xc7, 0x4d, 0xa6, 0x76, 0x8f, 0x36, 0xf1, 0x2, 0x12, 0x55, 0xf5, 0x90, 0x99, 0x87, 0x6e, 0xa1, 0x92, 0x1};
  lwmqtt_string_t topic_filter_s7 = {23, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xf7, 0x6, 0xe4, 0x27, 0xd1, 0xf5, 0x1e, 0x5c, 0x94, 0x6, 0xfe, 0xbb, 0xff, 0x67, 0x6c, 0xd7};
  lwmqtt_string_t topic_filter_s8 = {16, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xe5, 0x72, 0x70, 0x3a, 0x91, 0xa7, 0x6, 0xbf, 0xbc, 0xc3, 0x1f, 0x5c};
  lwmqtt_string_t topic_filter_s9 = {12, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
lwmqtt_sub_options_t sub_opts[10];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
sub_opts[9].qos = LWMQTT_QOS1;
sub_opts[9].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[9].retain_as_published = false;
sub_opts[9].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 7750, 10, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 6922 [("\176\131\178\223z\196\&7\244P\255\198\182\182Y\250e&\173\215\129\SOH\185\nQ7\NULK\SOH*",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("Xv\191Qn\146\ACK\CAN\159\&1\251U\202\233B\r\158\234\237",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\142\196\245\228Y{#1\n\227\151\215>O\213\131",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("l\232\254\201\210\146\&9\138\199\199?\n`~(#\223\NUL\152\142\194\&0\227\213>",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\183Gl\161\243g%\128",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode15) {
uint8_t pkt[] = {0x82, 0x72, 0x1b, 0xa, 0x0, 0x1d, 0xb0, 0x83, 0xb2, 0xdf, 0x7a, 0xc4, 0x37, 0xf4, 0x50, 0xff, 0xc6, 0xb6, 0xb6, 0x59, 0xfa, 0x65, 0x26, 0xad, 0xd7, 0x81, 0x1, 0xb9, 0xa, 0x51, 0x37, 0x0, 0x4b, 0x1, 0x2a, 0x1, 0x0, 0x13, 0x58, 0x76, 0xbf, 0x51, 0x6e, 0x92, 0x6, 0x18, 0x9f, 0x31, 0xfb, 0x55, 0xca, 0xe9, 0x42, 0xd, 0x9e, 0xea, 0xed, 0x1, 0x0, 0x10, 0x8e, 0xc4, 0xf5, 0xe4, 0x59, 0x7b, 0x23, 0x31, 0xa, 0xe3, 0x97, 0xd7, 0x3e, 0x4f, 0xd5, 0x83, 0x1, 0x0, 0x19, 0x6c, 0xe8, 0xfe, 0xc9, 0xd2, 0x92, 0x39, 0x8a, 0xc7, 0xc7, 0x3f, 0xa, 0x60, 0x7e, 0x28, 0x23, 0xdf, 0x0, 0x98, 0x8e, 0xc2, 0x30, 0xe3, 0xd5, 0x3e, 0x2, 0x0, 0x8, 0xb7, 0x47, 0x6c, 0xa1, 0xf3, 0x67, 0x25, 0x80, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xb0, 0x83, 0xb2, 0xdf, 0x7a, 0xc4, 0x37, 0xf4, 0x50, 0xff, 0xc6, 0xb6, 0xb6, 0x59, 0xfa, 0x65, 0x26, 0xad, 0xd7, 0x81, 0x1, 0xb9, 0xa, 0x51, 0x37, 0x0, 0x4b, 0x1, 0x2a};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x58, 0x76, 0xbf, 0x51, 0x6e, 0x92, 0x6, 0x18, 0x9f, 0x31, 0xfb, 0x55, 0xca, 0xe9, 0x42, 0xd, 0x9e, 0xea, 0xed};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8e, 0xc4, 0xf5, 0xe4, 0x59, 0x7b, 0x23, 0x31, 0xa, 0xe3, 0x97, 0xd7, 0x3e, 0x4f, 0xd5, 0x83};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6c, 0xe8, 0xfe, 0xc9, 0xd2, 0x92, 0x39, 0x8a, 0xc7, 0xc7, 0x3f, 0xa, 0x60, 0x7e, 0x28, 0x23, 0xdf, 0x0, 0x98, 0x8e, 0xc2, 0x30, 0xe3, 0xd5, 0x3e};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xb7, 0x47, 0x6c, 0xa1, 0xf3, 0x67, 0x25, 0x80};
  lwmqtt_string_t topic_filter_s4 = {8, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 6922, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26316 [("\229\199\211Bm\186\243W\161\139O{A ^F\180,!5y\243\EOT\166\226opy\131\ESC",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("Z\153\&6\215(\215\EM\137\140\252",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("U\\N\255a\146",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\174\\\247w\175\SYN\148o\191E\n[\197\SO\197a\175\227\236",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\DC2\180\170\148L1[`@[\253\159,\136`\ESC\229\DEL5\210\193\ESC@\131\152\212",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\141\&8\227\131\152p\224\162\146\228\175V \142\191QR\139g\188\165vf",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("N\240`q\204\255|\b\156A\227\238",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode16) {
uint8_t pkt[] = {0x82, 0x98, 0x1, 0x66, 0xcc, 0x0, 0x1e, 0xe5, 0xc7, 0xd3, 0x42, 0x6d, 0xba, 0xf3, 0x57, 0xa1, 0x8b, 0x4f, 0x7b, 0x41, 0x20, 0x5e, 0x46, 0xb4, 0x2c, 0x21, 0x35, 0x79, 0xf3, 0x4, 0xa6, 0xe2, 0x6f, 0x70, 0x79, 0x83, 0x1b, 0x2, 0x0, 0xa, 0x5a, 0x99, 0x36, 0xd7, 0x28, 0xd7, 0x19, 0x89, 0x8c, 0xfc, 0x2, 0x0, 0x6, 0x55, 0x5c, 0x4e, 0xff, 0x61, 0x92, 0x0, 0x0, 0x13, 0xae, 0x5c, 0xf7, 0x77, 0xaf, 0x16, 0x94, 0x6f, 0xbf, 0x45, 0xa, 0x5b, 0xc5, 0xe, 0xc5, 0x61, 0xaf, 0xe3, 0xec, 0x1, 0x0, 0x1a, 0x12, 0xb4, 0xaa, 0x94, 0x4c, 0x31, 0x5b, 0x60, 0x40, 0x5b, 0xfd, 0x9f, 0x2c, 0x88, 0x60, 0x1b, 0xe5, 0x7f, 0x35, 0xd2, 0xc1, 0x1b, 0x40, 0x83, 0x98, 0xd4, 0x2, 0x0, 0x0, 0x0, 0x0, 0x17, 0x8d, 0x38, 0xe3, 0x83, 0x98, 0x70, 0xe0, 0xa2, 0x92, 0xe4, 0xaf, 0x56, 0x20, 0x8e, 0xbf, 0x51, 0x52, 0x8b, 0x67, 0xbc, 0xa5, 0x76, 0x66, 0x2, 0x0, 0xc, 0x4e, 0xf0, 0x60, 0x71, 0xcc, 0xff, 0x7c, 0x8, 0x9c, 0x41, 0xe3, 0xee, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xe5, 0xc7, 0xd3, 0x42, 0x6d, 0xba, 0xf3, 0x57, 0xa1, 0x8b, 0x4f, 0x7b, 0x41, 0x20, 0x5e, 0x46, 0xb4, 0x2c, 0x21, 0x35, 0x79, 0xf3, 0x4, 0xa6, 0xe2, 0x6f, 0x70, 0x79, 0x83, 0x1b};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x5a, 0x99, 0x36, 0xd7, 0x28, 0xd7, 0x19, 0x89, 0x8c, 0xfc};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x55, 0x5c, 0x4e, 0xff, 0x61, 0x92};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xae, 0x5c, 0xf7, 0x77, 0xaf, 0x16, 0x94, 0x6f, 0xbf, 0x45, 0xa, 0x5b, 0xc5, 0xe, 0xc5, 0x61, 0xaf, 0xe3, 0xec};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x12, 0xb4, 0xaa, 0x94, 0x4c, 0x31, 0x5b, 0x60, 0x40, 0x5b, 0xfd, 0x9f, 0x2c, 0x88, 0x60, 0x1b, 0xe5, 0x7f, 0x35, 0xd2, 0xc1, 0x1b, 0x40, 0x83, 0x98, 0xd4};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8d, 0x38, 0xe3, 0x83, 0x98, 0x70, 0xe0, 0xa2, 0x92, 0xe4, 0xaf, 0x56, 0x20, 0x8e, 0xbf, 0x51, 0x52, 0x8b, 0x67, 0xbc, 0xa5, 0x76, 0x66};
  lwmqtt_string_t topic_filter_s6 = {23, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x4e, 0xf0, 0x60, 0x71, 0xcc, 0xff, 0x7c, 0x8, 0x9c, 0x41, 0xe3, 0xee};
  lwmqtt_string_t topic_filter_s7 = {12, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
lwmqtt_sub_options_t sub_opts[8];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 26316, 8, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 3621 [("7\186\177\153l\246\228+]4\237O$\165\135q\230\DC3b\180\SI\194\248\ACK\t",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("+\SO\164",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\152\172d3k\243}\216\210y\232\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\208'\165Pi\\8\EOT*/\191\202\180A\237\164",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("Z\152\229",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\227a\230",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\178\254\234\\\139\236\222\v\188\159\236\DLE\215\254\SO.\128\250\160\128",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode17) {
uint8_t pkt[] = {0x82, 0x69, 0xe, 0x25, 0x0, 0x19, 0x37, 0xba, 0xb1, 0x99, 0x6c, 0xf6, 0xe4, 0x2b, 0x5d, 0x34, 0xed, 0x4f, 0x24, 0xa5, 0x87, 0x71, 0xe6, 0x13, 0x62, 0xb4, 0xf, 0xc2, 0xf8, 0x6, 0x9, 0x2, 0x0, 0x3, 0x2b, 0xe, 0xa4, 0x2, 0x0, 0xc, 0x98, 0xac, 0x64, 0x33, 0x6b, 0xf3, 0x7d, 0xd8, 0xd2, 0x79, 0xe8, 0x98, 0x1, 0x0, 0x10, 0xd0, 0x27, 0xa5, 0x50, 0x69, 0x5c, 0x38, 0x4, 0x2a, 0x2f, 0xbf, 0xca, 0xb4, 0x41, 0xed, 0xa4, 0x2, 0x0, 0x3, 0x5a, 0x98, 0xe5, 0x1, 0x0, 0x3, 0xe3, 0x61, 0xe6, 0x2, 0x0, 0x14, 0xb2, 0xfe, 0xea, 0x5c, 0x8b, 0xec, 0xde, 0xb, 0xbc, 0x9f, 0xec, 0x10, 0xd7, 0xfe, 0xe, 0x2e, 0x80, 0xfa, 0xa0, 0x80, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x37, 0xba, 0xb1, 0x99, 0x6c, 0xf6, 0xe4, 0x2b, 0x5d, 0x34, 0xed, 0x4f, 0x24, 0xa5, 0x87, 0x71, 0xe6, 0x13, 0x62, 0xb4, 0xf, 0xc2, 0xf8, 0x6, 0x9};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2b, 0xe, 0xa4};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x98, 0xac, 0x64, 0x33, 0x6b, 0xf3, 0x7d, 0xd8, 0xd2, 0x79, 0xe8, 0x98};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd0, 0x27, 0xa5, 0x50, 0x69, 0x5c, 0x38, 0x4, 0x2a, 0x2f, 0xbf, 0xca, 0xb4, 0x41, 0xed, 0xa4};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5a, 0x98, 0xe5};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe3, 0x61, 0xe6};
  lwmqtt_string_t topic_filter_s5 = {3, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb2, 0xfe, 0xea, 0x5c, 0x8b, 0xec, 0xde, 0xb, 0xbc, 0x9f, 0xec, 0x10, 0xd7, 0xfe, 0xe, 0x2e, 0x80, 0xfa, 0xa0, 0x80};
  lwmqtt_string_t topic_filter_s6 = {20, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
lwmqtt_sub_options_t sub_opts[7];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 3621, 7, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17519 [("\237*\219:\226s\140\&8K \188\244l\243f\DC2|\184\193/\SYN\148\187\SOH\137\228:\ACK",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\223\254xc\242\211\169\140",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("4\144\223\145\225\223\164[Kn\246\237}J,z\141\238",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode18) {
uint8_t pkt[] = {0x82, 0x41, 0x44, 0x6f, 0x0, 0x1c, 0xed, 0x2a, 0xdb, 0x3a, 0xe2, 0x73, 0x8c, 0x38, 0x4b, 0x20, 0xbc, 0xf4, 0x6c, 0xf3, 0x66, 0x12, 0x7c, 0xb8, 0xc1, 0x2f, 0x16, 0x94, 0xbb, 0x1, 0x89, 0xe4, 0x3a, 0x6, 0x1, 0x0, 0x8, 0xdf, 0xfe, 0x78, 0x63, 0xf2, 0xd3, 0xa9, 0x8c, 0x2, 0x0, 0x12, 0x34, 0x90, 0xdf, 0x91, 0xe1, 0xdf, 0xa4, 0x5b, 0x4b, 0x6e, 0xf6, 0xed, 0x7d, 0x4a, 0x2c, 0x7a, 0x8d, 0xee, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xed, 0x2a, 0xdb, 0x3a, 0xe2, 0x73, 0x8c, 0x38, 0x4b, 0x20, 0xbc, 0xf4, 0x6c, 0xf3, 0x66, 0x12, 0x7c, 0xb8, 0xc1, 0x2f, 0x16, 0x94, 0xbb, 0x1, 0x89, 0xe4, 0x3a, 0x6};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xdf, 0xfe, 0x78, 0x63, 0xf2, 0xd3, 0xa9, 0x8c};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x34, 0x90, 0xdf, 0x91, 0xe1, 0xdf, 0xa4, 0x5b, 0x4b, 0x6e, 0xf6, 0xed, 0x7d, 0x4a, 0x2c, 0x7a, 0x8d, 0xee};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 17519, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 3152 [("\221jG\162A\208>\210\170r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\198\138\161\233\v\180\STX\241\207\221\150\234\128)\130\nF\209\ETX\GSVdb",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\148y\243\207\167\176HiA\209\148mB\219\169\138\169c\r\173b\150Q\247\153}\221F",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\243\171\216\165!\EOT,g\235G\164 2\206\211-\b-D\218",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode19) {
uint8_t pkt[] = {0x82, 0x62, 0xc, 0x50, 0x0, 0xa, 0xdd, 0x6a, 0x47, 0xa2, 0x41, 0xd0, 0x3e, 0xd2, 0xaa, 0x72, 0x0, 0x0, 0x0, 0x0, 0x0, 0x17, 0xc6, 0x8a, 0xa1, 0xe9, 0xb, 0xb4, 0x2, 0xf1, 0xcf, 0xdd, 0x96, 0xea, 0x80, 0x29, 0x82, 0xa, 0x46, 0xd1, 0x3, 0x1d, 0x56, 0x64, 0x62, 0x0, 0x0, 0x1c, 0x94, 0x79, 0xf3, 0xcf, 0xa7, 0xb0, 0x48, 0x69, 0x41, 0xd1, 0x94, 0x6d, 0x42, 0xdb, 0xa9, 0x8a, 0xa9, 0x63, 0xd, 0xad, 0x62, 0x96, 0x51, 0xf7, 0x99, 0x7d, 0xdd, 0x46, 0x1, 0x0, 0x14, 0xf3, 0xab, 0xd8, 0xa5, 0x21, 0x4, 0x2c, 0x67, 0xeb, 0x47, 0xa4, 0x20, 0x32, 0xce, 0xd3, 0x2d, 0x8, 0x2d, 0x44, 0xda, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xdd, 0x6a, 0x47, 0xa2, 0x41, 0xd0, 0x3e, 0xd2, 0xaa, 0x72};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc6, 0x8a, 0xa1, 0xe9, 0xb, 0xb4, 0x2, 0xf1, 0xcf, 0xdd, 0x96, 0xea, 0x80, 0x29, 0x82, 0xa, 0x46, 0xd1, 0x3, 0x1d, 0x56, 0x64, 0x62};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x94, 0x79, 0xf3, 0xcf, 0xa7, 0xb0, 0x48, 0x69, 0x41, 0xd1, 0x94, 0x6d, 0x42, 0xdb, 0xa9, 0x8a, 0xa9, 0x63, 0xd, 0xad, 0x62, 0x96, 0x51, 0xf7, 0x99, 0x7d, 0xdd, 0x46};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf3, 0xab, 0xd8, 0xa5, 0x21, 0x4, 0x2c, 0x67, 0xeb, 0x47, 0xa4, 0x20, 0x32, 0xce, 0xd3, 0x2d, 0x8, 0x2d, 0x44, 0xda};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 3152, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17142 [("e0\211\n(1\a[m\192\250\134\179R\156:\DEL\217\&3\143Z\228\186\224\US\128\164\194\167\223",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\236^:\SYNW\249\182\&7>\191\130\SUB\146'",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),(":\200\140\238\238\173\241A\v\155\186\&9#m$\204\SUBe?Qr\214<3Q9O\214",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),(" \139\195\231G\f\SOHqD*F\221%F\SYN\142\&7\207\252",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("@\217Q\249+\DLE\152\DLE\237\v\180[",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\207\SI\195\138W\141H2\157b?\147N\147# a%\239\181G\236[m\NULx",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\226>An\226G\185\FS",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\131\189l\133\133\tg\128\139\&9<\151y<\197o\204\221\132\&6\151\253\213\196\&3\221i",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode20) {
uint8_t pkt[] = {0x82, 0xbe, 0x1, 0x42, 0xf6, 0x0, 0x1e, 0x65, 0x30, 0xd3, 0xa, 0x28, 0x31, 0x7, 0x5b, 0x6d, 0xc0, 0xfa, 0x86, 0xb3, 0x52, 0x9c, 0x3a, 0x7f, 0xd9, 0x33, 0x8f, 0x5a, 0xe4, 0xba, 0xe0, 0x1f, 0x80, 0xa4, 0xc2, 0xa7, 0xdf, 0x2, 0x0, 0xe, 0xec, 0x5e, 0x3a, 0x16, 0x57, 0xf9, 0xb6, 0x37, 0x3e, 0xbf, 0x82, 0x1a, 0x92, 0x27, 0x0, 0x0, 0x1c, 0x3a, 0xc8, 0x8c, 0xee, 0xee, 0xad, 0xf1, 0x41, 0xb, 0x9b, 0xba, 0x39, 0x23, 0x6d, 0x24, 0xcc, 0x1a, 0x65, 0x3f, 0x51, 0x72, 0xd6, 0x3c, 0x33, 0x51, 0x39, 0x4f, 0xd6, 0x2, 0x0, 0x13, 0x20, 0x8b, 0xc3, 0xe7, 0x47, 0xc, 0x1, 0x71, 0x44, 0x2a, 0x46, 0xdd, 0x25, 0x46, 0x16, 0x8e, 0x37, 0xcf, 0xfc, 0x0, 0x0, 0xc, 0x40, 0xd9, 0x51, 0xf9, 0x2b, 0x10, 0x98, 0x10, 0xed, 0xb, 0xb4, 0x5b, 0x1, 0x0, 0x1a, 0xcf, 0xf, 0xc3, 0x8a, 0x57, 0x8d, 0x48, 0x32, 0x9d, 0x62, 0x3f, 0x93, 0x4e, 0x93, 0x23, 0x20, 0x61, 0x25, 0xef, 0xb5, 0x47, 0xec, 0x5b, 0x6d, 0x0, 0x78, 0x1, 0x0, 0x8, 0xe2, 0x3e, 0x41, 0x6e, 0xe2, 0x47, 0xb9, 0x1c, 0x0, 0x0, 0x1b, 0x83, 0xbd, 0x6c, 0x85, 0x85, 0x9, 0x67, 0x80, 0x8b, 0x39, 0x3c, 0x97, 0x79, 0x3c, 0xc5, 0x6f, 0xcc, 0xdd, 0x84, 0x36, 0x97, 0xfd, 0xd5, 0xc4, 0x33, 0xdd, 0x69, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x65, 0x30, 0xd3, 0xa, 0x28, 0x31, 0x7, 0x5b, 0x6d, 0xc0, 0xfa, 0x86, 0xb3, 0x52, 0x9c, 0x3a, 0x7f, 0xd9, 0x33, 0x8f, 0x5a, 0xe4, 0xba, 0xe0, 0x1f, 0x80, 0xa4, 0xc2, 0xa7, 0xdf};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xec, 0x5e, 0x3a, 0x16, 0x57, 0xf9, 0xb6, 0x37, 0x3e, 0xbf, 0x82, 0x1a, 0x92, 0x27};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3a, 0xc8, 0x8c, 0xee, 0xee, 0xad, 0xf1, 0x41, 0xb, 0x9b, 0xba, 0x39, 0x23, 0x6d, 0x24, 0xcc, 0x1a, 0x65, 0x3f, 0x51, 0x72, 0xd6, 0x3c, 0x33, 0x51, 0x39, 0x4f, 0xd6};
  lwmqtt_string_t topic_filter_s2 = {28, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x20, 0x8b, 0xc3, 0xe7, 0x47, 0xc, 0x1, 0x71, 0x44, 0x2a, 0x46, 0xdd, 0x25, 0x46, 0x16, 0x8e, 0x37, 0xcf, 0xfc};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x40, 0xd9, 0x51, 0xf9, 0x2b, 0x10, 0x98, 0x10, 0xed, 0xb, 0xb4, 0x5b};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xcf, 0xf, 0xc3, 0x8a, 0x57, 0x8d, 0x48, 0x32, 0x9d, 0x62, 0x3f, 0x93, 0x4e, 0x93, 0x23, 0x20, 0x61, 0x25, 0xef, 0xb5, 0x47, 0xec, 0x5b, 0x6d, 0x0, 0x78};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xe2, 0x3e, 0x41, 0x6e, 0xe2, 0x47, 0xb9, 0x1c};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x83, 0xbd, 0x6c, 0x85, 0x85, 0x9, 0x67, 0x80, 0x8b, 0x39, 0x3c, 0x97, 0x79, 0x3c, 0xc5, 0x6f, 0xcc, 0xdd, 0x84, 0x36, 0x97, 0xfd, 0xd5, 0xc4, 0x33, 0xdd, 0x69};
  lwmqtt_string_t topic_filter_s7 = {27, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
lwmqtt_sub_options_t sub_opts[8];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS1;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS1;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 17142, 8, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 12736 [("\145r:&\180\185\191_\191\EOT\159&\193$\205",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\188'\DEL\156\SOV\198\162e\166U0\163\197\181\t\230\&9z\213\135=I",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("fp bI\176\162\r\137\188\NUL\247\ETXy\143s\221q\232\153ff\RS\ESC",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\240\180\DC4+'\SOHP\138y\131!=Z\134\SO2+\169\ETB*",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\201-r-|\180\149qF\242?\234\163\191|m#q\150\CANB\189",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("a)(\167\186\SOH\206\180\ETB\151\150\136hl\212l\187t.\160\189n\165{",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\198\158\243\SYNL\SI\160e\196Y\225\249\234\200\237\136\225\255l\240\tH\250\170\235\223",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),(",`6V\143_\180\169\246\186\185\141\138\NAK\ACKIq\130\173?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\b4\247",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode21) {
uint8_t pkt[] = {0x82, 0xce, 0x1, 0x31, 0xc0, 0x0, 0xf, 0x91, 0x72, 0x3a, 0x26, 0xb4, 0xb9, 0xbf, 0x5f, 0xbf, 0x4, 0x9f, 0x26, 0xc1, 0x24, 0xcd, 0x2, 0x0, 0x17, 0xbc, 0x27, 0x7f, 0x9c, 0xe, 0x56, 0xc6, 0xa2, 0x65, 0xa6, 0x55, 0x30, 0xa3, 0xc5, 0xb5, 0x9, 0xe6, 0x39, 0x7a, 0xd5, 0x87, 0x3d, 0x49, 0x0, 0x0, 0x18, 0x66, 0x70, 0x20, 0x62, 0x49, 0xb0, 0xa2, 0xd, 0x89, 0xbc, 0x0, 0xf7, 0x3, 0x79, 0x8f, 0x73, 0xdd, 0x71, 0xe8, 0x99, 0x66, 0x66, 0x1e, 0x1b, 0x1, 0x0, 0x14, 0xf0, 0xb4, 0x14, 0x2b, 0x27, 0x1, 0x50, 0x8a, 0x79, 0x83, 0x21, 0x3d, 0x5a, 0x86, 0xe, 0x32, 0x2b, 0xa9, 0x17, 0x2a, 0x1, 0x0, 0x16, 0xc9, 0x2d, 0x72, 0x2d, 0x7c, 0xb4, 0x95, 0x71, 0x46, 0xf2, 0x3f, 0xea, 0xa3, 0xbf, 0x7c, 0x6d, 0x23, 0x71, 0x96, 0x18, 0x42, 0xbd, 0x1, 0x0, 0x18, 0x61, 0x29, 0x28, 0xa7, 0xba, 0x1, 0xce, 0xb4, 0x17, 0x97, 0x96, 0x88, 0x68, 0x6c, 0xd4, 0x6c, 0xbb, 0x74, 0x2e, 0xa0, 0xbd, 0x6e, 0xa5, 0x7b, 0x1, 0x0, 0x1a, 0xc6, 0x9e, 0xf3, 0x16, 0x4c, 0xf, 0xa0, 0x65, 0xc4, 0x59, 0xe1, 0xf9, 0xea, 0xc8, 0xed, 0x88, 0xe1, 0xff, 0x6c, 0xf0, 0x9, 0x48, 0xfa, 0xaa, 0xeb, 0xdf, 0x2, 0x0, 0x14, 0x2c, 0x60, 0x36, 0x56, 0x8f, 0x5f, 0xb4, 0xa9, 0xf6, 0xba, 0xb9, 0x8d, 0x8a, 0x15, 0x6, 0x49, 0x71, 0x82, 0xad, 0x3f, 0x2, 0x0, 0x3, 0x8, 0x34, 0xf7, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x91, 0x72, 0x3a, 0x26, 0xb4, 0xb9, 0xbf, 0x5f, 0xbf, 0x4, 0x9f, 0x26, 0xc1, 0x24, 0xcd};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xbc, 0x27, 0x7f, 0x9c, 0xe, 0x56, 0xc6, 0xa2, 0x65, 0xa6, 0x55, 0x30, 0xa3, 0xc5, 0xb5, 0x9, 0xe6, 0x39, 0x7a, 0xd5, 0x87, 0x3d, 0x49};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x66, 0x70, 0x20, 0x62, 0x49, 0xb0, 0xa2, 0xd, 0x89, 0xbc, 0x0, 0xf7, 0x3, 0x79, 0x8f, 0x73, 0xdd, 0x71, 0xe8, 0x99, 0x66, 0x66, 0x1e, 0x1b};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf0, 0xb4, 0x14, 0x2b, 0x27, 0x1, 0x50, 0x8a, 0x79, 0x83, 0x21, 0x3d, 0x5a, 0x86, 0xe, 0x32, 0x2b, 0xa9, 0x17, 0x2a};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc9, 0x2d, 0x72, 0x2d, 0x7c, 0xb4, 0x95, 0x71, 0x46, 0xf2, 0x3f, 0xea, 0xa3, 0xbf, 0x7c, 0x6d, 0x23, 0x71, 0x96, 0x18, 0x42, 0xbd};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x61, 0x29, 0x28, 0xa7, 0xba, 0x1, 0xce, 0xb4, 0x17, 0x97, 0x96, 0x88, 0x68, 0x6c, 0xd4, 0x6c, 0xbb, 0x74, 0x2e, 0xa0, 0xbd, 0x6e, 0xa5, 0x7b};
  lwmqtt_string_t topic_filter_s5 = {24, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc6, 0x9e, 0xf3, 0x16, 0x4c, 0xf, 0xa0, 0x65, 0xc4, 0x59, 0xe1, 0xf9, 0xea, 0xc8, 0xed, 0x88, 0xe1, 0xff, 0x6c, 0xf0, 0x9, 0x48, 0xfa, 0xaa, 0xeb, 0xdf};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x2c, 0x60, 0x36, 0x56, 0x8f, 0x5f, 0xb4, 0xa9, 0xf6, 0xba, 0xb9, 0x8d, 0x8a, 0x15, 0x6, 0x49, 0x71, 0x82, 0xad, 0x3f};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x8, 0x34, 0xf7};
  lwmqtt_string_t topic_filter_s8 = {3, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS1;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS2;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12736, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26425 [("\145\NAK7\199",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\GSs0\DC1\171V\137\&9\159w\132\ESC\169\234\155\213",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\\\142Z\247\242sCn\US\191q!\148^!i\196\133\n\205\140Ar\136\133",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\235e\220\167>\DLE*\133\128\145\180\DC3t\129\&8",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\218\188\137$}\EOT4\238\239\232|~\185\169R\141\196\189R\151",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\173\US{0hp\194\172Up\210?\133\204\227\&0\160\137\183\158\212\217z\228\208\130\164\213\ACK\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\217\199\165J\206\133\254\160,k\ETB\144\186\EOT\ETXKN=\160\SYN\200K\f\208\155%\180",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\DEL\210\186",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\211\225\228\234\188g\203A\222\NUL!\191\194\&0\194\&0\144@(A\232\&8\176N",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode22) {
uint8_t pkt[] = {0x82, 0xc1, 0x1, 0x67, 0x39, 0x0, 0x4, 0x91, 0x15, 0x37, 0xc7, 0x1, 0x0, 0x10, 0x1d, 0x73, 0x30, 0x11, 0xab, 0x56, 0x89, 0x39, 0x9f, 0x77, 0x84, 0x1b, 0xa9, 0xea, 0x9b, 0xd5, 0x2, 0x0, 0x19, 0x5c, 0x8e, 0x5a, 0xf7, 0xf2, 0x73, 0x43, 0x6e, 0x1f, 0xbf, 0x71, 0x21, 0x94, 0x5e, 0x21, 0x69, 0xc4, 0x85, 0xa, 0xcd, 0x8c, 0x41, 0x72, 0x88, 0x85, 0x0, 0x0, 0xf, 0xeb, 0x65, 0xdc, 0xa7, 0x3e, 0x10, 0x2a, 0x85, 0x80, 0x91, 0xb4, 0x13, 0x74, 0x81, 0x38, 0x1, 0x0, 0x14, 0xda, 0xbc, 0x89, 0x24, 0x7d, 0x4, 0x34, 0xee, 0xef, 0xe8, 0x7c, 0x7e, 0xb9, 0xa9, 0x52, 0x8d, 0xc4, 0xbd, 0x52, 0x97, 0x0, 0x0, 0x1e, 0xad, 0x1f, 0x7b, 0x30, 0x68, 0x70, 0xc2, 0xac, 0x55, 0x70, 0xd2, 0x3f, 0x85, 0xcc, 0xe3, 0x30, 0xa0, 0x89, 0xb7, 0x9e, 0xd4, 0xd9, 0x7a, 0xe4, 0xd0, 0x82, 0xa4, 0xd5, 0x6, 0xd2, 0x0, 0x0, 0x1b, 0xd9, 0xc7, 0xa5, 0x4a, 0xce, 0x85, 0xfe, 0xa0, 0x2c, 0x6b, 0x17, 0x90, 0xba, 0x4, 0x3, 0x4b, 0x4e, 0x3d, 0xa0, 0x16, 0xc8, 0x4b, 0xc, 0xd0, 0x9b, 0x25, 0xb4, 0x1, 0x0, 0x3, 0x7f, 0xd2, 0xba, 0x2, 0x0, 0x18, 0xd3, 0xe1, 0xe4, 0xea, 0xbc, 0x67, 0xcb, 0x41, 0xde, 0x0, 0x21, 0xbf, 0xc2, 0x30, 0xc2, 0x30, 0x90, 0x40, 0x28, 0x41, 0xe8, 0x38, 0xb0, 0x4e, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x91, 0x15, 0x37, 0xc7};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1d, 0x73, 0x30, 0x11, 0xab, 0x56, 0x89, 0x39, 0x9f, 0x77, 0x84, 0x1b, 0xa9, 0xea, 0x9b, 0xd5};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5c, 0x8e, 0x5a, 0xf7, 0xf2, 0x73, 0x43, 0x6e, 0x1f, 0xbf, 0x71, 0x21, 0x94, 0x5e, 0x21, 0x69, 0xc4, 0x85, 0xa, 0xcd, 0x8c, 0x41, 0x72, 0x88, 0x85};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xeb, 0x65, 0xdc, 0xa7, 0x3e, 0x10, 0x2a, 0x85, 0x80, 0x91, 0xb4, 0x13, 0x74, 0x81, 0x38};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xda, 0xbc, 0x89, 0x24, 0x7d, 0x4, 0x34, 0xee, 0xef, 0xe8, 0x7c, 0x7e, 0xb9, 0xa9, 0x52, 0x8d, 0xc4, 0xbd, 0x52, 0x97};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xad, 0x1f, 0x7b, 0x30, 0x68, 0x70, 0xc2, 0xac, 0x55, 0x70, 0xd2, 0x3f, 0x85, 0xcc, 0xe3, 0x30, 0xa0, 0x89, 0xb7, 0x9e, 0xd4, 0xd9, 0x7a, 0xe4, 0xd0, 0x82, 0xa4, 0xd5, 0x6, 0xd2};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd9, 0xc7, 0xa5, 0x4a, 0xce, 0x85, 0xfe, 0xa0, 0x2c, 0x6b, 0x17, 0x90, 0xba, 0x4, 0x3, 0x4b, 0x4e, 0x3d, 0xa0, 0x16, 0xc8, 0x4b, 0xc, 0xd0, 0x9b, 0x25, 0xb4};
  lwmqtt_string_t topic_filter_s6 = {27, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x7f, 0xd2, 0xba};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xd3, 0xe1, 0xe4, 0xea, 0xbc, 0x67, 0xcb, 0x41, 0xde, 0x0, 0x21, 0xbf, 0xc2, 0x30, 0xc2, 0x30, 0x90, 0x40, 0x28, 0x41, 0xe8, 0x38, 0xb0, 0x4e};
  lwmqtt_string_t topic_filter_s8 = {24, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS1;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 26425, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17320 [("\144\175\&0\194y\215$\SO<G\160\164\218\ACK\212\176\137d\253\198",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("F+i\212\224",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\DC4\200\DC2lh\179@\DEL\157,\"-\181PJI\212\GS/\216C\135\ACK\255\177\130\190F\229",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode23) {
uint8_t pkt[] = {0x82, 0x44, 0x43, 0xa8, 0x0, 0x14, 0x90, 0xaf, 0x30, 0xc2, 0x79, 0xd7, 0x24, 0xe, 0x3c, 0x47, 0xa0, 0xa4, 0xda, 0x6, 0xd4, 0xb0, 0x89, 0x64, 0xfd, 0xc6, 0x2, 0x0, 0x5, 0x46, 0x2b, 0x69, 0xd4, 0xe0, 0x2, 0x0, 0x0, 0x1, 0x0, 0x1d, 0x14, 0xc8, 0x12, 0x6c, 0x68, 0xb3, 0x40, 0x7f, 0x9d, 0x2c, 0x22, 0x2d, 0xb5, 0x50, 0x4a, 0x49, 0xd4, 0x1d, 0x2f, 0xd8, 0x43, 0x87, 0x6, 0xff, 0xb1, 0x82, 0xbe, 0x46, 0xe5, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x90, 0xaf, 0x30, 0xc2, 0x79, 0xd7, 0x24, 0xe, 0x3c, 0x47, 0xa0, 0xa4, 0xda, 0x6, 0xd4, 0xb0, 0x89, 0x64, 0xfd, 0xc6};
  lwmqtt_string_t topic_filter_s0 = {20, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x46, 0x2b, 0x69, 0xd4, 0xe0};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x14, 0xc8, 0x12, 0x6c, 0x68, 0xb3, 0x40, 0x7f, 0x9d, 0x2c, 0x22, 0x2d, 0xb5, 0x50, 0x4a, 0x49, 0xd4, 0x1d, 0x2f, 0xd8, 0x43, 0x87, 0x6, 0xff, 0xb1, 0x82, 0xbe, 0x46, 0xe5};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
lwmqtt_sub_options_t sub_opts[4];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 17320, 4, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 9349 [("D\161",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\147\GS\140\221\194\249\&2H$\160\&9Z\247\201\&7\235\133\210M{r\146uJY\ESC",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\234\216\197\146-.:|#\186\SUB}\134",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("]/.\208\EOT\195\224Ig\238x\219\254 \178",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\168\232\NAK\137\231\230}~\178]6\246",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("V\129f)\206Y\b\216\222\223*\132k\193\163\213\&2)",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\249\201\EMx\233\208\197*\228\149\179\213\158,\166q\253>\US",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\140\252\NAKZ\ENQ\201\234\204\151\235\251\198\234\190\DC2\NULi\211\201",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode24) {
uint8_t pkt[] = {0x82, 0x99, 0x1, 0x24, 0x85, 0x0, 0x2, 0x44, 0xa1, 0x0, 0x0, 0x1a, 0x93, 0x1d, 0x8c, 0xdd, 0xc2, 0xf9, 0x32, 0x48, 0x24, 0xa0, 0x39, 0x5a, 0xf7, 0xc9, 0x37, 0xeb, 0x85, 0xd2, 0x4d, 0x7b, 0x72, 0x92, 0x75, 0x4a, 0x59, 0x1b, 0x1, 0x0, 0xd, 0xea, 0xd8, 0xc5, 0x92, 0x2d, 0x2e, 0x3a, 0x7c, 0x23, 0xba, 0x1a, 0x7d, 0x86, 0x2, 0x0, 0x0, 0x2, 0x0, 0xf, 0x5d, 0x2f, 0x2e, 0xd0, 0x4, 0xc3, 0xe0, 0x49, 0x67, 0xee, 0x78, 0xdb, 0xfe, 0x20, 0xb2, 0x2, 0x0, 0xc, 0xa8, 0xe8, 0x15, 0x89, 0xe7, 0xe6, 0x7d, 0x7e, 0xb2, 0x5d, 0x36, 0xf6, 0x2, 0x0, 0x12, 0x56, 0x81, 0x66, 0x29, 0xce, 0x59, 0x8, 0xd8, 0xde, 0xdf, 0x2a, 0x84, 0x6b, 0xc1, 0xa3, 0xd5, 0x32, 0x29, 0x0, 0x0, 0x13, 0xf9, 0xc9, 0x19, 0x78, 0xe9, 0xd0, 0xc5, 0x2a, 0xe4, 0x95, 0xb3, 0xd5, 0x9e, 0x2c, 0xa6, 0x71, 0xfd, 0x3e, 0x1f, 0x2, 0x0, 0x13, 0x8c, 0xfc, 0x15, 0x5a, 0x5, 0xc9, 0xea, 0xcc, 0x97, 0xeb, 0xfb, 0xc6, 0xea, 0xbe, 0x12, 0x0, 0x69, 0xd3, 0xc9, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x44, 0xa1};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x93, 0x1d, 0x8c, 0xdd, 0xc2, 0xf9, 0x32, 0x48, 0x24, 0xa0, 0x39, 0x5a, 0xf7, 0xc9, 0x37, 0xeb, 0x85, 0xd2, 0x4d, 0x7b, 0x72, 0x92, 0x75, 0x4a, 0x59, 0x1b};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xea, 0xd8, 0xc5, 0x92, 0x2d, 0x2e, 0x3a, 0x7c, 0x23, 0xba, 0x1a, 0x7d, 0x86};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0};
  lwmqtt_string_t topic_filter_s3 = {0, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5d, 0x2f, 0x2e, 0xd0, 0x4, 0xc3, 0xe0, 0x49, 0x67, 0xee, 0x78, 0xdb, 0xfe, 0x20, 0xb2};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa8, 0xe8, 0x15, 0x89, 0xe7, 0xe6, 0x7d, 0x7e, 0xb2, 0x5d, 0x36, 0xf6};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x56, 0x81, 0x66, 0x29, 0xce, 0x59, 0x8, 0xd8, 0xde, 0xdf, 0x2a, 0x84, 0x6b, 0xc1, 0xa3, 0xd5, 0x32, 0x29};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xf9, 0xc9, 0x19, 0x78, 0xe9, 0xd0, 0xc5, 0x2a, 0xe4, 0x95, 0xb3, 0xd5, 0x9e, 0x2c, 0xa6, 0x71, 0xfd, 0x3e, 0x1f};
  lwmqtt_string_t topic_filter_s7 = {19, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x8c, 0xfc, 0x15, 0x5a, 0x5, 0xc9, 0xea, 0xcc, 0x97, 0xeb, 0xfb, 0xc6, 0xea, 0xbe, 0x12, 0x0, 0x69, 0xd3, 0xc9};
  lwmqtt_string_t topic_filter_s8 = {19, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 9349, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26963 [("\222\194M\DEL\152\197,\190??\b\237\DELK\244.\212\133\159\247{\238\US7[\151\DC1",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\171\141\177\173\n\EM\129,\143\DC4\167\162\191<,",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("{\146\138\133s9`\172\155`\205#\CAN\160\193h\188\DC3K\205\253<\255g\DC4c\246",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("'\170\221]\SIq\189\192\ESCH\r5\163\154D",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("i",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode25) {
uint8_t pkt[] = {0x82, 0x66, 0x69, 0x53, 0x0, 0x1b, 0xde, 0xc2, 0x4d, 0x7f, 0x98, 0xc5, 0x2c, 0xbe, 0x3f, 0x3f, 0x8, 0xed, 0x7f, 0x4b, 0xf4, 0x2e, 0xd4, 0x85, 0x9f, 0xf7, 0x7b, 0xee, 0x1f, 0x37, 0x5b, 0x97, 0x11, 0x2, 0x0, 0xf, 0xab, 0x8d, 0xb1, 0xad, 0xa, 0x19, 0x81, 0x2c, 0x8f, 0x14, 0xa7, 0xa2, 0xbf, 0x3c, 0x2c, 0x2, 0x0, 0x1b, 0x7b, 0x92, 0x8a, 0x85, 0x73, 0x39, 0x60, 0xac, 0x9b, 0x60, 0xcd, 0x23, 0x18, 0xa0, 0xc1, 0x68, 0xbc, 0x13, 0x4b, 0xcd, 0xfd, 0x3c, 0xff, 0x67, 0x14, 0x63, 0xf6, 0x1, 0x0, 0xf, 0x27, 0xaa, 0xdd, 0x5d, 0xf, 0x71, 0xbd, 0xc0, 0x1b, 0x48, 0xd, 0x35, 0xa3, 0x9a, 0x44, 0x1, 0x0, 0x1, 0x69, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xde, 0xc2, 0x4d, 0x7f, 0x98, 0xc5, 0x2c, 0xbe, 0x3f, 0x3f, 0x8, 0xed, 0x7f, 0x4b, 0xf4, 0x2e, 0xd4, 0x85, 0x9f, 0xf7, 0x7b, 0xee, 0x1f, 0x37, 0x5b, 0x97, 0x11};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x8d, 0xb1, 0xad, 0xa, 0x19, 0x81, 0x2c, 0x8f, 0x14, 0xa7, 0xa2, 0xbf, 0x3c, 0x2c};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x7b, 0x92, 0x8a, 0x85, 0x73, 0x39, 0x60, 0xac, 0x9b, 0x60, 0xcd, 0x23, 0x18, 0xa0, 0xc1, 0x68, 0xbc, 0x13, 0x4b, 0xcd, 0xfd, 0x3c, 0xff, 0x67, 0x14, 0x63, 0xf6};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x27, 0xaa, 0xdd, 0x5d, 0xf, 0x71, 0xbd, 0xc0, 0x1b, 0x48, 0xd, 0x35, 0xa3, 0x9a, 0x44};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x69};
  lwmqtt_string_t topic_filter_s4 = {1, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 26963, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21870 [("@\DC1\168\&4q^o\128\193 R\129Q\n\SO \156\223\234\178\252\158\217=",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\v\202\226\206G",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\159W\DC30=\CAN%",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\138O\209\212z\EOTK",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("3\240\148o\129\n\158\&8\NULd\193\134\132\129z\132z\219`{\235W\144_",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode26) {
uint8_t pkt[] = {0x82, 0x54, 0x55, 0x6e, 0x0, 0x18, 0x40, 0x11, 0xa8, 0x34, 0x71, 0x5e, 0x6f, 0x80, 0xc1, 0x20, 0x52, 0x81, 0x51, 0xa, 0xe, 0x20, 0x9c, 0xdf, 0xea, 0xb2, 0xfc, 0x9e, 0xd9, 0x3d, 0x2, 0x0, 0x5, 0xb, 0xca, 0xe2, 0xce, 0x47, 0x2, 0x0, 0x7, 0x9f, 0x57, 0x13, 0x30, 0x3d, 0x18, 0x25, 0x2, 0x0, 0x7, 0x8a, 0x4f, 0xd1, 0xd4, 0x7a, 0x4, 0x4b, 0x2, 0x0, 0x18, 0x33, 0xf0, 0x94, 0x6f, 0x81, 0xa, 0x9e, 0x38, 0x0, 0x64, 0xc1, 0x86, 0x84, 0x81, 0x7a, 0x84, 0x7a, 0xdb, 0x60, 0x7b, 0xeb, 0x57, 0x90, 0x5f, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x40, 0x11, 0xa8, 0x34, 0x71, 0x5e, 0x6f, 0x80, 0xc1, 0x20, 0x52, 0x81, 0x51, 0xa, 0xe, 0x20, 0x9c, 0xdf, 0xea, 0xb2, 0xfc, 0x9e, 0xd9, 0x3d};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb, 0xca, 0xe2, 0xce, 0x47};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9f, 0x57, 0x13, 0x30, 0x3d, 0x18, 0x25};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8a, 0x4f, 0xd1, 0xd4, 0x7a, 0x4, 0x4b};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x33, 0xf0, 0x94, 0x6f, 0x81, 0xa, 0x9e, 0x38, 0x0, 0x64, 0xc1, 0x86, 0x84, 0x81, 0x7a, 0x84, 0x7a, 0xdb, 0x60, 0x7b, 0xeb, 0x57, 0x90, 0x5f};
  lwmqtt_string_t topic_filter_s4 = {24, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21870, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 6154 [("\DEL\244\227\193\248L\DC2\249\249h\217u_u",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\146\226X\227zoKZ\172C$\DC1>",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\USpH\130\\\EOT\ESCo\r\205\249d\215\243\246\EM\243\\Oy\195\147\&9<\249A\230\&5\ETX.",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\186Uah\251?\236m\133\v\215",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\f\193y\211\&9\163\188\237\SYN8\198\DC34\130\218\203\&3~\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\255+\137v\184\215Pix\170R\252{l\130\254\212yQ\223@l\SI\130i",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\137\236\&92",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("{\"\202\130",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\221u\223w",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\249\137\219n\139\f\238\208lT0\201\209\SI\135\237\182\212\185\190\244\220\177\180B\229",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\\([*\EOTn\145\175\236G\176\&8\240\STX\170\SUB[c",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode27) {
uint8_t pkt[] = {0x82, 0xcb, 0x1, 0x18, 0xa, 0x0, 0xe, 0x7f, 0xf4, 0xe3, 0xc1, 0xf8, 0x4c, 0x12, 0xf9, 0xf9, 0x68, 0xd9, 0x75, 0x5f, 0x75, 0x1, 0x0, 0xd, 0x92, 0xe2, 0x58, 0xe3, 0x7a, 0x6f, 0x4b, 0x5a, 0xac, 0x43, 0x24, 0x11, 0x3e, 0x2, 0x0, 0x1e, 0x1f, 0x70, 0x48, 0x82, 0x5c, 0x4, 0x1b, 0x6f, 0xd, 0xcd, 0xf9, 0x64, 0xd7, 0xf3, 0xf6, 0x19, 0xf3, 0x5c, 0x4f, 0x79, 0xc3, 0x93, 0x39, 0x3c, 0xf9, 0x41, 0xe6, 0x35, 0x3, 0x2e, 0x1, 0x0, 0xb, 0xba, 0x55, 0x61, 0x68, 0xfb, 0x3f, 0xec, 0x6d, 0x85, 0xb, 0xd7, 0x1, 0x0, 0x13, 0xc, 0xc1, 0x79, 0xd3, 0x39, 0xa3, 0xbc, 0xed, 0x16, 0x38, 0xc6, 0x13, 0x34, 0x82, 0xda, 0xcb, 0x33, 0x7e, 0x5c, 0x0, 0x0, 0x19, 0xff, 0x2b, 0x89, 0x76, 0xb8, 0xd7, 0x50, 0x69, 0x78, 0xaa, 0x52, 0xfc, 0x7b, 0x6c, 0x82, 0xfe, 0xd4, 0x79, 0x51, 0xdf, 0x40, 0x6c, 0xf, 0x82, 0x69, 0x0, 0x0, 0x4, 0x89, 0xec, 0x39, 0x32, 0x2, 0x0, 0x4, 0x7b, 0x22, 0xca, 0x82, 0x0, 0x0, 0x4, 0xdd, 0x75, 0xdf, 0x77, 0x1, 0x0, 0x1a, 0xf9, 0x89, 0xdb, 0x6e, 0x8b, 0xc, 0xee, 0xd0, 0x6c, 0x54, 0x30, 0xc9, 0xd1, 0xf, 0x87, 0xed, 0xb6, 0xd4, 0xb9, 0xbe, 0xf4, 0xdc, 0xb1, 0xb4, 0x42, 0xe5, 0x2, 0x0, 0x12, 0x5c, 0x28, 0x5b, 0x2a, 0x4, 0x6e, 0x91, 0xaf, 0xec, 0x47, 0xb0, 0x38, 0xf0, 0x2, 0xaa, 0x1a, 0x5b, 0x63, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x7f, 0xf4, 0xe3, 0xc1, 0xf8, 0x4c, 0x12, 0xf9, 0xf9, 0x68, 0xd9, 0x75, 0x5f, 0x75};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x92, 0xe2, 0x58, 0xe3, 0x7a, 0x6f, 0x4b, 0x5a, 0xac, 0x43, 0x24, 0x11, 0x3e};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1f, 0x70, 0x48, 0x82, 0x5c, 0x4, 0x1b, 0x6f, 0xd, 0xcd, 0xf9, 0x64, 0xd7, 0xf3, 0xf6, 0x19, 0xf3, 0x5c, 0x4f, 0x79, 0xc3, 0x93, 0x39, 0x3c, 0xf9, 0x41, 0xe6, 0x35, 0x3, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xba, 0x55, 0x61, 0x68, 0xfb, 0x3f, 0xec, 0x6d, 0x85, 0xb, 0xd7};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc, 0xc1, 0x79, 0xd3, 0x39, 0xa3, 0xbc, 0xed, 0x16, 0x38, 0xc6, 0x13, 0x34, 0x82, 0xda, 0xcb, 0x33, 0x7e, 0x5c};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xff, 0x2b, 0x89, 0x76, 0xb8, 0xd7, 0x50, 0x69, 0x78, 0xaa, 0x52, 0xfc, 0x7b, 0x6c, 0x82, 0xfe, 0xd4, 0x79, 0x51, 0xdf, 0x40, 0x6c, 0xf, 0x82, 0x69};
  lwmqtt_string_t topic_filter_s5 = {25, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x89, 0xec, 0x39, 0x32};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x7b, 0x22, 0xca, 0x82};
  lwmqtt_string_t topic_filter_s7 = {4, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdd, 0x75, 0xdf, 0x77};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf9, 0x89, 0xdb, 0x6e, 0x8b, 0xc, 0xee, 0xd0, 0x6c, 0x54, 0x30, 0xc9, 0xd1, 0xf, 0x87, 0xed, 0xb6, 0xd4, 0xb9, 0xbe, 0xf4, 0xdc, 0xb1, 0xb4, 0x42, 0xe5};
  lwmqtt_string_t topic_filter_s9 = {26, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x5c, 0x28, 0x5b, 0x2a, 0x4, 0x6e, 0x91, 0xaf, 0xec, 0x47, 0xb0, 0x38, 0xf0, 0x2, 0xaa, 0x1a, 0x5b, 0x63};
  lwmqtt_string_t topic_filter_s10 = {18, (char*)&topic_filter_s10_bytes};
topic_filters[10] = topic_filter_s10;
lwmqtt_sub_options_t sub_opts[11];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
sub_opts[9].qos = LWMQTT_QOS2;
sub_opts[9].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[9].retain_as_published = false;
sub_opts[9].no_local = false;
sub_opts[10].qos = LWMQTT_QOS1;
sub_opts[10].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[10].retain_as_published = false;
sub_opts[10].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 6154, 11, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 7912 [("\182\167\151\163VQ\156;\242Q\187<\193\&4\145-\243Y\208\152E?\200&\SYN\US",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\FS?\153\174\206\185MuW\176b\183\172\134",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\223\224s\US\169\&0bC\ENQQ\200\221\248qE\235\255B\n",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode28) {
uint8_t pkt[] = {0x82, 0x46, 0x1e, 0xe8, 0x0, 0x1a, 0xb6, 0xa7, 0x97, 0xa3, 0x56, 0x51, 0x9c, 0x3b, 0xf2, 0x51, 0xbb, 0x3c, 0xc1, 0x34, 0x91, 0x2d, 0xf3, 0x59, 0xd0, 0x98, 0x45, 0x3f, 0xc8, 0x26, 0x16, 0x1f, 0x1, 0x0, 0xe, 0x1c, 0x3f, 0x99, 0xae, 0xce, 0xb9, 0x4d, 0x75, 0x57, 0xb0, 0x62, 0xb7, 0xac, 0x86, 0x0, 0x0, 0x13, 0xdf, 0xe0, 0x73, 0x1f, 0xa9, 0x30, 0x62, 0x43, 0x5, 0x51, 0xc8, 0xdd, 0xf8, 0x71, 0x45, 0xeb, 0xff, 0x42, 0xa, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xb6, 0xa7, 0x97, 0xa3, 0x56, 0x51, 0x9c, 0x3b, 0xf2, 0x51, 0xbb, 0x3c, 0xc1, 0x34, 0x91, 0x2d, 0xf3, 0x59, 0xd0, 0x98, 0x45, 0x3f, 0xc8, 0x26, 0x16, 0x1f};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1c, 0x3f, 0x99, 0xae, 0xce, 0xb9, 0x4d, 0x75, 0x57, 0xb0, 0x62, 0xb7, 0xac, 0x86};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xdf, 0xe0, 0x73, 0x1f, 0xa9, 0x30, 0x62, 0x43, 0x5, 0x51, 0xc8, 0xdd, 0xf8, 0x71, 0x45, 0xeb, 0xff, 0x42, 0xa};
  lwmqtt_string_t topic_filter_s2 = {19, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 7912, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 1410 [("\146)\134\170\232\238\169\149\192\144\173`=4\225}\DC2\181\176\234\SUB-\173\SI\204",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\157\225\208\231:\189\b\244\171\243J\204\GS\233\177\CAN\210v\FS\NUL\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\DC3\166\143e\196",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode29) {
uint8_t pkt[] = {0x82, 0x3e, 0x5, 0x82, 0x0, 0x19, 0x92, 0x29, 0x86, 0xaa, 0xe8, 0xee, 0xa9, 0x95, 0xc0, 0x90, 0xad, 0x60, 0x3d, 0x34, 0xe1, 0x7d, 0x12, 0xb5, 0xb0, 0xea, 0x1a, 0x2d, 0xad, 0xf, 0xcc, 0x0, 0x0, 0x15, 0x9d, 0xe1, 0xd0, 0xe7, 0x3a, 0xbd, 0x8, 0xf4, 0xab, 0xf3, 0x4a, 0xcc, 0x1d, 0xe9, 0xb1, 0x18, 0xd2, 0x76, 0x1c, 0x0, 0x19, 0x2, 0x0, 0x5, 0x13, 0xa6, 0x8f, 0x65, 0xc4, 0x1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x92, 0x29, 0x86, 0xaa, 0xe8, 0xee, 0xa9, 0x95, 0xc0, 0x90, 0xad, 0x60, 0x3d, 0x34, 0xe1, 0x7d, 0x12, 0xb5, 0xb0, 0xea, 0x1a, 0x2d, 0xad, 0xf, 0xcc};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x9d, 0xe1, 0xd0, 0xe7, 0x3a, 0xbd, 0x8, 0xf4, 0xab, 0xf3, 0x4a, 0xcc, 0x1d, 0xe9, 0xb1, 0x18, 0xd2, 0x76, 0x1c, 0x0, 0x19};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x13, 0xa6, 0x8f, 0x65, 0xc4};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1410, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21007 [("K\148\168\SOH",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("r\233o\161\151.",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("a\216\169\218\&7\t\173\212\208C|\f\221",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\209\136\244\253\211\NAK\191-\a\196\188\224\129\178_\238\170[\218\131$jr\220U\162:",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode30) {
uint8_t pkt[] = {0x82, 0x40, 0x52, 0xf, 0x0, 0x4, 0x4b, 0x94, 0xa8, 0x1, 0x2, 0x0, 0x6, 0x72, 0xe9, 0x6f, 0xa1, 0x97, 0x2e, 0x2, 0x0, 0xd, 0x61, 0xd8, 0xa9, 0xda, 0x37, 0x9, 0xad, 0xd4, 0xd0, 0x43, 0x7c, 0xc, 0xdd, 0x0, 0x0, 0x1b, 0xd1, 0x88, 0xf4, 0xfd, 0xd3, 0x15, 0xbf, 0x2d, 0x7, 0xc4, 0xbc, 0xe0, 0x81, 0xb2, 0x5f, 0xee, 0xaa, 0x5b, 0xda, 0x83, 0x24, 0x6a, 0x72, 0xdc, 0x55, 0xa2, 0x3a, 0x2};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x4b, 0x94, 0xa8, 0x1};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x72, 0xe9, 0x6f, 0xa1, 0x97, 0x2e};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x61, 0xd8, 0xa9, 0xda, 0x37, 0x9, 0xad, 0xd4, 0xd0, 0x43, 0x7c, 0xc, 0xdd};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd1, 0x88, 0xf4, 0xfd, 0xd3, 0x15, 0xbf, 0x2d, 0x7, 0xc4, 0xbc, 0xe0, 0x81, 0xb2, 0x5f, 0xee, 0xaa, 0x5b, 0xda, 0x83, 0x24, 0x6a, 0x72, 0xdc, 0x55, 0xa2, 0x3a};
  lwmqtt_string_t topic_filter_s3 = {27, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
lwmqtt_sub_options_t sub_opts[4];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21007, 4, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 2235 [("\ETB\166",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0})] [PropResponseInformation "\212\ETB\233\246\147\144G\DEL",PropSessionExpiryInterval 21137,PropUserProperty "\SYN\191\240\CANC" "p[",PropServerKeepAlive 12069,PropAssignedClientIdentifier "\130E\SUB >\SI\216\230R\235\ACK\FS\133jfq7/\210\198\210\161ys#",PropResponseTopic "\152\r\178\143\233\ACK0Ke\148\190\169Q4.]\130n\180\138\128\238\184=",PropAuthenticationMethod "4\167\136t\196\ESC\236\GS,3\188\aV\132\&2\192^\NUL\182\154\NAK'\a\130",PropSessionExpiryInterval 25074,PropSharedSubscriptionAvailable 100,PropRequestResponseInformation 36,PropSubscriptionIdentifier 18,PropMessageExpiryInterval 9123,PropUserProperty "\228\250F\165=\137\176\213Z\248\154ho\187\ENQ\176\184\136m\f\DC2\224\130\149A|\215\186\185" "\210q\217@\219;%\aB\196",PropTopicAlias 27031,PropUserProperty "y\135\164\169\250\159" "\247A\SO\DC3\147\182\240C|\f\129R\129\156/\SYN\160\216\244\ETB2\160\134\245}\132",PropWillDelayInterval 2441,PropMaximumQoS 72,PropAssignedClientIdentifier "o\SUB\239\t\r\SOH\245\134gu\GS\131b\SOH\"\208\177\164\&0\192V"]
TEST(Subscribe5QCTest, Encode1) {
uint8_t pkt[] = {0x82, 0xfd, 0x1, 0x8, 0xbb, 0xf4, 0x1, 0x1a, 0x0, 0x8, 0xd4, 0x17, 0xe9, 0xf6, 0x93, 0x90, 0x47, 0x7f, 0x11, 0x0, 0x0, 0x52, 0x91, 0x26, 0x0, 0x5, 0x16, 0xbf, 0xf0, 0x18, 0x43, 0x0, 0x2, 0x70, 0x5b, 0x13, 0x2f, 0x25, 0x12, 0x0, 0x19, 0x82, 0x45, 0x1a, 0x20, 0x3e, 0xf, 0xd8, 0xe6, 0x52, 0xeb, 0x6, 0x1c, 0x85, 0x6a, 0x66, 0x71, 0x37, 0x2f, 0xd2, 0xc6, 0xd2, 0xa1, 0x79, 0x73, 0x23, 0x8, 0x0, 0x18, 0x98, 0xd, 0xb2, 0x8f, 0xe9, 0x6, 0x30, 0x4b, 0x65, 0x94, 0xbe, 0xa9, 0x51, 0x34, 0x2e, 0x5d, 0x82, 0x6e, 0xb4, 0x8a, 0x80, 0xee, 0xb8, 0x3d, 0x15, 0x0, 0x18, 0x34, 0xa7, 0x88, 0x74, 0xc4, 0x1b, 0xec, 0x1d, 0x2c, 0x33, 0xbc, 0x7, 0x56, 0x84, 0x32, 0xc0, 0x5e, 0x0, 0xb6, 0x9a, 0x15, 0x27, 0x7, 0x82, 0x11, 0x0, 0x0, 0x61, 0xf2, 0x2a, 0x64, 0x19, 0x24, 0xb, 0x12, 0x2, 0x0, 0x0, 0x23, 0xa3, 0x26, 0x0, 0x1d, 0xe4, 0xfa, 0x46, 0xa5, 0x3d, 0x89, 0xb0, 0xd5, 0x5a, 0xf8, 0x9a, 0x68, 0x6f, 0xbb, 0x5, 0xb0, 0xb8, 0x88, 0x6d, 0xc, 0x12, 0xe0, 0x82, 0x95, 0x41, 0x7c, 0xd7, 0xba, 0xb9, 0x0, 0xa, 0xd2, 0x71, 0xd9, 0x40, 0xdb, 0x3b, 0x25, 0x7, 0x42, 0xc4, 0x23, 0x69, 0x97, 0x26, 0x0, 0x6, 0x79, 0x87, 0xa4, 0xa9, 0xfa, 0x9f, 0x0, 0x1a, 0xf7, 0x41, 0xe, 0x13, 0x93, 0xb6, 0xf0, 0x43, 0x7c, 0xc, 0x81, 0x52, 0x81, 0x9c, 0x2f, 0x16, 0xa0, 0xd8, 0xf4, 0x17, 0x32, 0xa0, 0x86, 0xf5, 0x7d, 0x84, 0x18, 0x0, 0x0, 0x9, 0x89, 0x24, 0x48, 0x12, 0x0, 0x15, 0x6f, 0x1a, 0xef, 0x9, 0xd, 0x1, 0xf5, 0x86, 0x67, 0x75, 0x1d, 0x83, 0x62, 0x1, 0x22, 0xd0, 0xb1, 0xa4, 0x30, 0xc0, 0x56, 0x0, 0x2, 0x17, 0xa6, 0x28};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x17, 0xa6};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
  uint8_t bytesprops0[] = {0xd4, 0x17, 0xe9, 0xf6, 0x93, 0x90, 0x47, 0x7f};
  uint8_t bytesprops2[] = {0x70, 0x5b};
  uint8_t bytesprops1[] = {0x16, 0xbf, 0xf0, 0x18, 0x43};
  uint8_t bytesprops3[] = {0x82, 0x45, 0x1a, 0x20, 0x3e, 0xf, 0xd8, 0xe6, 0x52, 0xeb, 0x6, 0x1c, 0x85, 0x6a, 0x66, 0x71, 0x37, 0x2f, 0xd2, 0xc6, 0xd2, 0xa1, 0x79, 0x73, 0x23};
  uint8_t bytesprops4[] = {0x98, 0xd, 0xb2, 0x8f, 0xe9, 0x6, 0x30, 0x4b, 0x65, 0x94, 0xbe, 0xa9, 0x51, 0x34, 0x2e, 0x5d, 0x82, 0x6e, 0xb4, 0x8a, 0x80, 0xee, 0xb8, 0x3d};
  uint8_t bytesprops5[] = {0x34, 0xa7, 0x88, 0x74, 0xc4, 0x1b, 0xec, 0x1d, 0x2c, 0x33, 0xbc, 0x7, 0x56, 0x84, 0x32, 0xc0, 0x5e, 0x0, 0xb6, 0x9a, 0x15, 0x27, 0x7, 0x82};
  uint8_t bytesprops7[] = {0xd2, 0x71, 0xd9, 0x40, 0xdb, 0x3b, 0x25, 0x7, 0x42, 0xc4};
  uint8_t bytesprops6[] = {0xe4, 0xfa, 0x46, 0xa5, 0x3d, 0x89, 0xb0, 0xd5, 0x5a, 0xf8, 0x9a, 0x68, 0x6f, 0xbb, 0x5, 0xb0, 0xb8, 0x88, 0x6d, 0xc, 0x12, 0xe0, 0x82, 0x95, 0x41, 0x7c, 0xd7, 0xba, 0xb9};
  uint8_t bytesprops9[] = {0xf7, 0x41, 0xe, 0x13, 0x93, 0xb6, 0xf0, 0x43, 0x7c, 0xc, 0x81, 0x52, 0x81, 0x9c, 0x2f, 0x16, 0xa0, 0xd8, 0xf4, 0x17, 0x32, 0xa0, 0x86, 0xf5, 0x7d, 0x84};
  uint8_t bytesprops8[] = {0x79, 0x87, 0xa4, 0xa9, 0xfa, 0x9f};
  uint8_t bytesprops10[] = {0x6f, 0x1a, 0xef, 0x9, 0xd, 0x1, 0xf5, 0x86, 0x67, 0x75, 0x1d, 0x83, 0x62, 0x1, 0x22, 0xd0, 0xb1, 0xa4, 0x30, 0xc0, 0x56};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {8, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21137}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={5, (char*)&bytesprops1}, .v={2, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12069}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {24, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {24, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 25074}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 18}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9123}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={29, (char*)&bytesprops6}, .v={10, (char*)&bytesprops7}}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 27031}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={6, (char*)&bytesprops8}, .v={26, (char*)&bytesprops9}}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 2441}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 72}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2235, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 29400 [("\212\DELo=\194\186\&8\213\&6\b,\218\ENQ\155\244\161a\159\ACK\242\223\233\ACK\SYN6",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\174~\129qh",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("]\227w\FS\n\152\156\253\203\254\v\GS\210(\226\v\EM3[\242\222\232\132Q\168",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\128\&1\237)\RS\197\ETX\206~I\228\227\&6\250\192",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\243\&8\184<\190N\253\&8W\223\234Fz\221`\148\176\134\&0",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\222\162\216\&7\t",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("9\EM\253\233\240M\232\ACK\223^|\r\141\205",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\147\255\160\143\132\225\&4\223\147\145\161\211\149\230\&4p\181",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\140\167\v\DLE\221\215\250;d}?\220\&0\"\DC2\178 \169,*\172\131HV\174",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\149\SI\158\RS\147\170\156\220\146",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropMaximumQoS 22,PropAuthenticationMethod "{\223\177\DC4\ESCh\201w\NAK{ze@`<\192\147",PropWildcardSubscriptionAvailable 8,PropRequestProblemInformation 132,PropAuthenticationMethod "\135\182R v<\191\220\236\234\164\ETX\231.\135\210kNU\DLE\208'\SOyft\132\234",PropRetainAvailable 242,PropAuthenticationMethod "\220}\DC3}\SUB\235\153j5\151\239\146\184\183vB\208\251\229\180\168\159\DC3\220\149\DEL\US9",PropServerKeepAlive 5174,PropAuthenticationData "m\184\200\237\GS\186l$L\bE\227vC\215\227",PropWildcardSubscriptionAvailable 31,PropAuthenticationMethod "9\164\208\US\r\b\217|D\NAK\160qZqrx",PropMaximumQoS 30,PropSessionExpiryInterval 6804,PropPayloadFormatIndicator 122,PropPayloadFormatIndicator 142,PropRequestResponseInformation 169,PropSubscriptionIdentifier 22,PropSubscriptionIdentifierAvailable 218,PropRequestProblemInformation 214,PropRequestProblemInformation 244,PropWildcardSubscriptionAvailable 204,PropWildcardSubscriptionAvailable 157,PropTopicAlias 9159,PropAuthenticationMethod "\147\&9u\160!",PropAuthenticationMethod "\139\168\247\237\203\184\133\250^\216\215\239\"\149\CAN\DEL\184'\159r\146I",PropSharedSubscriptionAvailable 182,PropMaximumQoS 182,PropSubscriptionIdentifier 16,PropAuthenticationMethod "\151\164\135\&8@\DLE;\\\145\&5\217",PropResponseTopic "\DC4;\173q\ENQ\226$\"\215_n\183"]
TEST(Subscribe5QCTest, Encode2) {
uint8_t pkt[] = {0x82, 0xa9, 0x3, 0x72, 0xd8, 0xe5, 0x1, 0x24, 0x16, 0x15, 0x0, 0x11, 0x7b, 0xdf, 0xb1, 0x14, 0x1b, 0x68, 0xc9, 0x77, 0x15, 0x7b, 0x7a, 0x65, 0x40, 0x60, 0x3c, 0xc0, 0x93, 0x28, 0x8, 0x17, 0x84, 0x15, 0x0, 0x1c, 0x87, 0xb6, 0x52, 0x20, 0x76, 0x3c, 0xbf, 0xdc, 0xec, 0xea, 0xa4, 0x3, 0xe7, 0x2e, 0x87, 0xd2, 0x6b, 0x4e, 0x55, 0x10, 0xd0, 0x27, 0xe, 0x79, 0x66, 0x74, 0x84, 0xea, 0x25, 0xf2, 0x15, 0x0, 0x1c, 0xdc, 0x7d, 0x13, 0x7d, 0x1a, 0xeb, 0x99, 0x6a, 0x35, 0x97, 0xef, 0x92, 0xb8, 0xb7, 0x76, 0x42, 0xd0, 0xfb, 0xe5, 0xb4, 0xa8, 0x9f, 0x13, 0xdc, 0x95, 0x7f, 0x1f, 0x39, 0x13, 0x14, 0x36, 0x16, 0x0, 0x10, 0x6d, 0xb8, 0xc8, 0xed, 0x1d, 0xba, 0x6c, 0x24, 0x4c, 0x8, 0x45, 0xe3, 0x76, 0x43, 0xd7, 0xe3, 0x28, 0x1f, 0x15, 0x0, 0x10, 0x39, 0xa4, 0xd0, 0x1f, 0xd, 0x8, 0xd9, 0x7c, 0x44, 0x15, 0xa0, 0x71, 0x5a, 0x71, 0x72, 0x78, 0x24, 0x1e, 0x11, 0x0, 0x0, 0x1a, 0x94, 0x1, 0x7a, 0x1, 0x8e, 0x19, 0xa9, 0xb, 0x16, 0x29, 0xda, 0x17, 0xd6, 0x17, 0xf4, 0x28, 0xcc, 0x28, 0x9d, 0x23, 0x23, 0xc7, 0x15, 0x0, 0x5, 0x93, 0x39, 0x75, 0xa0, 0x21, 0x15, 0x0, 0x16, 0x8b, 0xa8, 0xf7, 0xed, 0xcb, 0xb8, 0x85, 0xfa, 0x5e, 0xd8, 0xd7, 0xef, 0x22, 0x95, 0x18, 0x7f, 0xb8, 0x27, 0x9f, 0x72, 0x92, 0x49, 0x2a, 0xb6, 0x24, 0xb6, 0xb, 0x10, 0x15, 0x0, 0xb, 0x97, 0xa4, 0x87, 0x38, 0x40, 0x10, 0x3b, 0x5c, 0x91, 0x35, 0xd9, 0x8, 0x0, 0xc, 0x14, 0x3b, 0xad, 0x71, 0x5, 0xe2, 0x24, 0x22, 0xd7, 0x5f, 0x6e, 0xb7, 0x0, 0x19, 0xd4, 0x7f, 0x6f, 0x3d, 0xc2, 0xba, 0x38, 0xd5, 0x36, 0x8, 0x2c, 0xda, 0x5, 0x9b, 0xf4, 0xa1, 0x61, 0x9f, 0x6, 0xf2, 0xdf, 0xe9, 0x6, 0x16, 0x36, 0x16, 0x0, 0x5, 0xae, 0x7e, 0x81, 0x71, 0x68, 0xc, 0x0, 0x19, 0x5d, 0xe3, 0x77, 0x1c, 0xa, 0x98, 0x9c, 0xfd, 0xcb, 0xfe, 0xb, 0x1d, 0xd2, 0x28, 0xe2, 0xb, 0x19, 0x33, 0x5b, 0xf2, 0xde, 0xe8, 0x84, 0x51, 0xa8, 0x6, 0x0, 0xf, 0x80, 0x31, 0xed, 0x29, 0x1e, 0xc5, 0x3, 0xce, 0x7e, 0x49, 0xe4, 0xe3, 0x36, 0xfa, 0xc0, 0x19, 0x0, 0x13, 0xf3, 0x38, 0xb8, 0x3c, 0xbe, 0x4e, 0xfd, 0x38, 0x57, 0xdf, 0xea, 0x46, 0x7a, 0xdd, 0x60, 0x94, 0xb0, 0x86, 0x30, 0x14, 0x0, 0x5, 0xde, 0xa2, 0xd8, 0x37, 0x9, 0x1e, 0x0, 0xe, 0x39, 0x19, 0xfd, 0xe9, 0xf0, 0x4d, 0xe8, 0x6, 0xdf, 0x5e, 0x7c, 0xd, 0x8d, 0xcd, 0x1a, 0x0, 0x0, 0xd, 0x0, 0x11, 0x93, 0xff, 0xa0, 0x8f, 0x84, 0xe1, 0x34, 0xdf, 0x93, 0x91, 0xa1, 0xd3, 0x95, 0xe6, 0x34, 0x70, 0xb5, 0x20, 0x0, 0x19, 0x8c, 0xa7, 0xb, 0x10, 0xdd, 0xd7, 0xfa, 0x3b, 0x64, 0x7d, 0x3f, 0xdc, 0x30, 0x22, 0x12, 0xb2, 0x20, 0xa9, 0x2c, 0x2a, 0xac, 0x83, 0x48, 0x56, 0xae, 0x20, 0x0, 0x9, 0x95, 0xf, 0x9e, 0x1e, 0x93, 0xaa, 0x9c, 0xdc, 0x92, 0x22};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xd4, 0x7f, 0x6f, 0x3d, 0xc2, 0xba, 0x38, 0xd5, 0x36, 0x8, 0x2c, 0xda, 0x5, 0x9b, 0xf4, 0xa1, 0x61, 0x9f, 0x6, 0xf2, 0xdf, 0xe9, 0x6, 0x16, 0x36};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0x7e, 0x81, 0x71, 0x68};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5d, 0xe3, 0x77, 0x1c, 0xa, 0x98, 0x9c, 0xfd, 0xcb, 0xfe, 0xb, 0x1d, 0xd2, 0x28, 0xe2, 0xb, 0x19, 0x33, 0x5b, 0xf2, 0xde, 0xe8, 0x84, 0x51, 0xa8};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x80, 0x31, 0xed, 0x29, 0x1e, 0xc5, 0x3, 0xce, 0x7e, 0x49, 0xe4, 0xe3, 0x36, 0xfa, 0xc0};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf3, 0x38, 0xb8, 0x3c, 0xbe, 0x4e, 0xfd, 0x38, 0x57, 0xdf, 0xea, 0x46, 0x7a, 0xdd, 0x60, 0x94, 0xb0, 0x86, 0x30};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xde, 0xa2, 0xd8, 0x37, 0x9};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x39, 0x19, 0xfd, 0xe9, 0xf0, 0x4d, 0xe8, 0x6, 0xdf, 0x5e, 0x7c, 0xd, 0x8d, 0xcd};
  lwmqtt_string_t topic_filter_s6 = {14, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x93, 0xff, 0xa0, 0x8f, 0x84, 0xe1, 0x34, 0xdf, 0x93, 0x91, 0xa1, 0xd3, 0x95, 0xe6, 0x34, 0x70, 0xb5};
  lwmqtt_string_t topic_filter_s8 = {17, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x8c, 0xa7, 0xb, 0x10, 0xdd, 0xd7, 0xfa, 0x3b, 0x64, 0x7d, 0x3f, 0xdc, 0x30, 0x22, 0x12, 0xb2, 0x20, 0xa9, 0x2c, 0x2a, 0xac, 0x83, 0x48, 0x56, 0xae};
  lwmqtt_string_t topic_filter_s9 = {25, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x95, 0xf, 0x9e, 0x1e, 0x93, 0xaa, 0x9c, 0xdc, 0x92};
  lwmqtt_string_t topic_filter_s10 = {9, (char*)&topic_filter_s10_bytes};
topic_filters[10] = topic_filter_s10;
lwmqtt_sub_options_t sub_opts[11];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[5].retain_as_published = true;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS1;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = true;
sub_opts[8].qos = LWMQTT_QOS0;
sub_opts[8].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
sub_opts[9].qos = LWMQTT_QOS0;
sub_opts[9].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[9].retain_as_published = false;
sub_opts[9].no_local = false;
sub_opts[10].qos = LWMQTT_QOS2;
sub_opts[10].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[10].retain_as_published = false;
sub_opts[10].no_local = false;
  uint8_t bytesprops0[] = {0x7b, 0xdf, 0xb1, 0x14, 0x1b, 0x68, 0xc9, 0x77, 0x15, 0x7b, 0x7a, 0x65, 0x40, 0x60, 0x3c, 0xc0, 0x93};
  uint8_t bytesprops1[] = {0x87, 0xb6, 0x52, 0x20, 0x76, 0x3c, 0xbf, 0xdc, 0xec, 0xea, 0xa4, 0x3, 0xe7, 0x2e, 0x87, 0xd2, 0x6b, 0x4e, 0x55, 0x10, 0xd0, 0x27, 0xe, 0x79, 0x66, 0x74, 0x84, 0xea};
  uint8_t bytesprops2[] = {0xdc, 0x7d, 0x13, 0x7d, 0x1a, 0xeb, 0x99, 0x6a, 0x35, 0x97, 0xef, 0x92, 0xb8, 0xb7, 0x76, 0x42, 0xd0, 0xfb, 0xe5, 0xb4, 0xa8, 0x9f, 0x13, 0xdc, 0x95, 0x7f, 0x1f, 0x39};
  uint8_t bytesprops3[] = {0x6d, 0xb8, 0xc8, 0xed, 0x1d, 0xba, 0x6c, 0x24, 0x4c, 0x8, 0x45, 0xe3, 0x76, 0x43, 0xd7, 0xe3};
  uint8_t bytesprops4[] = {0x39, 0xa4, 0xd0, 0x1f, 0xd, 0x8, 0xd9, 0x7c, 0x44, 0x15, 0xa0, 0x71, 0x5a, 0x71, 0x72, 0x78};
  uint8_t bytesprops5[] = {0x93, 0x39, 0x75, 0xa0, 0x21};
  uint8_t bytesprops6[] = {0x8b, 0xa8, 0xf7, 0xed, 0xcb, 0xb8, 0x85, 0xfa, 0x5e, 0xd8, 0xd7, 0xef, 0x22, 0x95, 0x18, 0x7f, 0xb8, 0x27, 0x9f, 0x72, 0x92, 0x49};
  uint8_t bytesprops7[] = {0x97, 0xa4, 0x87, 0x38, 0x40, 0x10, 0x3b, 0x5c, 0x91, 0x35, 0xd9};
  uint8_t bytesprops8[] = {0x14, 0x3b, 0xad, 0x71, 0x5, 0xe2, 0x24, 0x22, 0xd7, 0x5f, 0x6e, 0xb7};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 22}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 8}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 132}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 242}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 5174}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {16, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 31}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {16, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 30}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 6804}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 122}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 142}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 169}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 218}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 214}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 244}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 204}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 157}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 9159}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {5, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {22, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 182}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 182}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 16}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 29400, 11, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 11000 [("\154\198\171-\233\SYNUL\216%\n\196\&6\192\157\&0\159\216\186k\249\227>K\DC3\236",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("w7jl\r\b\213",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\EOT\185\158\227\RSDU",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("6U",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\141\150T,\250\229\217f\217\SO\239FB\251\CAN",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),(")\254=\198'J\DC1\DC1$\210av\158m\162)\146\132\224\191\n\232\145",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("BK\228\209\196\156\140\244?2\144\USP3z2..\DC2`\129D",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("\SO\154",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1})] [PropAssignedClientIdentifier "\185K\r\236v1\206\""]
TEST(Subscribe5QCTest, Encode3) {
uint8_t pkt[] = {0x82, 0x91, 0x1, 0x2a, 0xf8, 0xb, 0x12, 0x0, 0x8, 0xb9, 0x4b, 0xd, 0xec, 0x76, 0x31, 0xce, 0x22, 0x0, 0x1a, 0x9a, 0xc6, 0xab, 0x2d, 0xe9, 0x16, 0x55, 0x4c, 0xd8, 0x25, 0xa, 0xc4, 0x36, 0xc0, 0x9d, 0x30, 0x9f, 0xd8, 0xba, 0x6b, 0xf9, 0xe3, 0x3e, 0x4b, 0x13, 0xec, 0x18, 0x0, 0x7, 0x77, 0x37, 0x6a, 0x6c, 0xd, 0x8, 0xd5, 0x22, 0x0, 0x7, 0x4, 0xb9, 0x9e, 0xe3, 0x1e, 0x44, 0x55, 0x0, 0x0, 0x2, 0x36, 0x55, 0x5, 0x0, 0xf, 0x8d, 0x96, 0x54, 0x2c, 0xfa, 0xe5, 0xd9, 0x66, 0xd9, 0xe, 0xef, 0x46, 0x42, 0xfb, 0x18, 0x18, 0x0, 0x0, 0x4, 0x0, 0x17, 0x29, 0xfe, 0x3d, 0xc6, 0x27, 0x4a, 0x11, 0x11, 0x24, 0xd2, 0x61, 0x76, 0x9e, 0x6d, 0xa2, 0x29, 0x92, 0x84, 0xe0, 0xbf, 0xa, 0xe8, 0x91, 0x4, 0x0, 0x16, 0x42, 0x4b, 0xe4, 0xd1, 0xc4, 0x9c, 0x8c, 0xf4, 0x3f, 0x32, 0x90, 0x1f, 0x50, 0x33, 0x7a, 0x32, 0x2e, 0x2e, 0x12, 0x60, 0x81, 0x44, 0x8, 0x0, 0x2, 0xe, 0x9a, 0x19};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x9a, 0xc6, 0xab, 0x2d, 0xe9, 0x16, 0x55, 0x4c, 0xd8, 0x25, 0xa, 0xc4, 0x36, 0xc0, 0x9d, 0x30, 0x9f, 0xd8, 0xba, 0x6b, 0xf9, 0xe3, 0x3e, 0x4b, 0x13, 0xec};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x77, 0x37, 0x6a, 0x6c, 0xd, 0x8, 0xd5};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4, 0xb9, 0x9e, 0xe3, 0x1e, 0x44, 0x55};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x36, 0x55};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8d, 0x96, 0x54, 0x2c, 0xfa, 0xe5, 0xd9, 0x66, 0xd9, 0xe, 0xef, 0x46, 0x42, 0xfb, 0x18};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x29, 0xfe, 0x3d, 0xc6, 0x27, 0x4a, 0x11, 0x11, 0x24, 0xd2, 0x61, 0x76, 0x9e, 0x6d, 0xa2, 0x29, 0x92, 0x84, 0xe0, 0xbf, 0xa, 0xe8, 0x91};
  lwmqtt_string_t topic_filter_s6 = {23, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x42, 0x4b, 0xe4, 0xd1, 0xc4, 0x9c, 0x8c, 0xf4, 0x3f, 0x32, 0x90, 0x1f, 0x50, 0x33, 0x7a, 0x32, 0x2e, 0x2e, 0x12, 0x60, 0x81, 0x44};
  lwmqtt_string_t topic_filter_s7 = {22, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xe, 0x9a};
  lwmqtt_string_t topic_filter_s8 = {2, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = true;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[8].retain_as_published = true;
sub_opts[8].no_local = false;
  uint8_t bytesprops0[] = {0xb9, 0x4b, 0xd, 0xec, 0x76, 0x31, 0xce, 0x22};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {8, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 11000, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21792 [("6\208Y0\251\199\EM",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("GX\147{(\182\223\141\GSB;\164\153/\133\DC2s",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropSubscriptionIdentifier 6,PropTopicAliasMaximum 11050,PropAssignedClientIdentifier "\GS\236\&8\194\187\187\209\221\&2S\177J\231\&7\ESC\177s\CAN\134\158H\136\229\215\t\EM\RS\r\STX"]
TEST(Subscribe5QCTest, Encode4) {
uint8_t pkt[] = {0x82, 0x46, 0x55, 0x20, 0x25, 0xb, 0x6, 0x22, 0x2b, 0x2a, 0x12, 0x0, 0x1d, 0x1d, 0xec, 0x38, 0xc2, 0xbb, 0xbb, 0xd1, 0xdd, 0x32, 0x53, 0xb1, 0x4a, 0xe7, 0x37, 0x1b, 0xb1, 0x73, 0x18, 0x86, 0x9e, 0x48, 0x88, 0xe5, 0xd7, 0x9, 0x19, 0x1e, 0xd, 0x2, 0x0, 0x7, 0x36, 0xd0, 0x59, 0x30, 0xfb, 0xc7, 0x19, 0x21, 0x0, 0x11, 0x47, 0x58, 0x93, 0x7b, 0x28, 0xb6, 0xdf, 0x8d, 0x1d, 0x42, 0x3b, 0xa4, 0x99, 0x2f, 0x85, 0x12, 0x73, 0x11};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x36, 0xd0, 0x59, 0x30, 0xfb, 0xc7, 0x19};
  lwmqtt_string_t topic_filter_s0 = {7, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x47, 0x58, 0x93, 0x7b, 0x28, 0xb6, 0xdf, 0x8d, 0x1d, 0x42, 0x3b, 0xa4, 0x99, 0x2f, 0x85, 0x12, 0x73};
  lwmqtt_string_t topic_filter_s1 = {17, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
lwmqtt_sub_options_t sub_opts[2];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
  uint8_t bytesprops0[] = {0x1d, 0xec, 0x38, 0xc2, 0xbb, 0xbb, 0xd1, 0xdd, 0x32, 0x53, 0xb1, 0x4a, 0xe7, 0x37, 0x1b, 0xb1, 0x73, 0x18, 0x86, 0x9e, 0x48, 0x88, 0xe5, 0xd7, 0x9, 0x19, 0x1e, 0xd, 0x2};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 6}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 11050}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {3, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21792, 2, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 20269 [("\220\133\254]\185%\213_\189\199t$[\170m\232m\SOf3c\226",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1})] [PropAssignedClientIdentifier "\194n\183\206\180\237Qv\155\133\NAKGE\158\135\"Dn\200\RSe\246\224N>N\217k",PropAssignedClientIdentifier "w\ETXh\244\160\&3\234\205\235Bq",PropMaximumPacketSize 15446,PropSessionExpiryInterval 5053,PropContentType "F\216GO\237\212\244#",PropAuthenticationMethod "",PropSubscriptionIdentifierAvailable 116,PropReceiveMaximum 19775,PropSubscriptionIdentifierAvailable 85,PropWildcardSubscriptionAvailable 61,PropResponseTopic "\t",PropRequestResponseInformation 152,PropServerKeepAlive 7792,PropAssignedClientIdentifier "\195\201\132",PropRequestResponseInformation 241,PropServerKeepAlive 9998,PropMaximumPacketSize 7241,PropSessionExpiryInterval 9777,PropSubscriptionIdentifierAvailable 184,PropResponseTopic "\142F\DC1\212\ESC\236j8",PropRequestResponseInformation 237,PropContentType "\DC2\US\RS\178\US\152\DC1\225\205\n\140\191\153\188q\159\152\174\&9\132\208\235\196\ESC\199\NUL",PropResponseInformation "$\211\243#\n:)L\169S",PropMaximumPacketSize 13967,PropRequestProblemInformation 31,PropAuthenticationData "\tgj\146\166\193\&9\212LhA{\b>",PropReceiveMaximum 17429,PropAuthenticationData "#\203>\CANSd\205+\CAN",PropSessionExpiryInterval 1396]
TEST(Subscribe5QCTest, Encode5) {
uint8_t pkt[] = {0x82, 0xee, 0x1, 0x4f, 0x2d, 0xd1, 0x1, 0x12, 0x0, 0x1c, 0xc2, 0x6e, 0xb7, 0xce, 0xb4, 0xed, 0x51, 0x76, 0x9b, 0x85, 0x15, 0x47, 0x45, 0x9e, 0x87, 0x22, 0x44, 0x6e, 0xc8, 0x1e, 0x65, 0xf6, 0xe0, 0x4e, 0x3e, 0x4e, 0xd9, 0x6b, 0x12, 0x0, 0xb, 0x77, 0x3, 0x68, 0xf4, 0xa0, 0x33, 0xea, 0xcd, 0xeb, 0x42, 0x71, 0x27, 0x0, 0x0, 0x3c, 0x56, 0x11, 0x0, 0x0, 0x13, 0xbd, 0x3, 0x0, 0x8, 0x46, 0xd8, 0x47, 0x4f, 0xed, 0xd4, 0xf4, 0x23, 0x15, 0x0, 0x0, 0x29, 0x74, 0x21, 0x4d, 0x3f, 0x29, 0x55, 0x28, 0x3d, 0x8, 0x0, 0x1, 0x9, 0x19, 0x98, 0x13, 0x1e, 0x70, 0x12, 0x0, 0x3, 0xc3, 0xc9, 0x84, 0x19, 0xf1, 0x13, 0x27, 0xe, 0x27, 0x0, 0x0, 0x1c, 0x49, 0x11, 0x0, 0x0, 0x26, 0x31, 0x29, 0xb8, 0x8, 0x0, 0x8, 0x8e, 0x46, 0x11, 0xd4, 0x1b, 0xec, 0x6a, 0x38, 0x19, 0xed, 0x3, 0x0, 0x1a, 0x12, 0x1f, 0x1e, 0xb2, 0x1f, 0x98, 0x11, 0xe1, 0xcd, 0xa, 0x8c, 0xbf, 0x99, 0xbc, 0x71, 0x9f, 0x98, 0xae, 0x39, 0x84, 0xd0, 0xeb, 0xc4, 0x1b, 0xc7, 0x0, 0x1a, 0x0, 0xa, 0x24, 0xd3, 0xf3, 0x23, 0xa, 0x3a, 0x29, 0x4c, 0xa9, 0x53, 0x27, 0x0, 0x0, 0x36, 0x8f, 0x17, 0x1f, 0x16, 0x0, 0xe, 0x9, 0x67, 0x6a, 0x92, 0xa6, 0xc1, 0x39, 0xd4, 0x4c, 0x68, 0x41, 0x7b, 0x8, 0x3e, 0x21, 0x44, 0x15, 0x16, 0x0, 0x9, 0x23, 0xcb, 0x3e, 0x18, 0x53, 0x64, 0xcd, 0x2b, 0x18, 0x11, 0x0, 0x0, 0x5, 0x74, 0x0, 0x16, 0xdc, 0x85, 0xfe, 0x5d, 0xb9, 0x25, 0xd5, 0x5f, 0xbd, 0xc7, 0x74, 0x24, 0x5b, 0xaa, 0x6d, 0xe8, 0x6d, 0xe, 0x66, 0x33, 0x63, 0xe2, 0x29};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xdc, 0x85, 0xfe, 0x5d, 0xb9, 0x25, 0xd5, 0x5f, 0xbd, 0xc7, 0x74, 0x24, 0x5b, 0xaa, 0x6d, 0xe8, 0x6d, 0xe, 0x66, 0x33, 0x63, 0xe2};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
  uint8_t bytesprops0[] = {0xc2, 0x6e, 0xb7, 0xce, 0xb4, 0xed, 0x51, 0x76, 0x9b, 0x85, 0x15, 0x47, 0x45, 0x9e, 0x87, 0x22, 0x44, 0x6e, 0xc8, 0x1e, 0x65, 0xf6, 0xe0, 0x4e, 0x3e, 0x4e, 0xd9, 0x6b};
  uint8_t bytesprops1[] = {0x77, 0x3, 0x68, 0xf4, 0xa0, 0x33, 0xea, 0xcd, 0xeb, 0x42, 0x71};
  uint8_t bytesprops2[] = {0x46, 0xd8, 0x47, 0x4f, 0xed, 0xd4, 0xf4, 0x23};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0x9};
  uint8_t bytesprops5[] = {0xc3, 0xc9, 0x84};
  uint8_t bytesprops6[] = {0x8e, 0x46, 0x11, 0xd4, 0x1b, 0xec, 0x6a, 0x38};
  uint8_t bytesprops7[] = {0x12, 0x1f, 0x1e, 0xb2, 0x1f, 0x98, 0x11, 0xe1, 0xcd, 0xa, 0x8c, 0xbf, 0x99, 0xbc, 0x71, 0x9f, 0x98, 0xae, 0x39, 0x84, 0xd0, 0xeb, 0xc4, 0x1b, 0xc7, 0x0};
  uint8_t bytesprops8[] = {0x24, 0xd3, 0xf3, 0x23, 0xa, 0x3a, 0x29, 0x4c, 0xa9, 0x53};
  uint8_t bytesprops9[] = {0x9, 0x67, 0x6a, 0x92, 0xa6, 0xc1, 0x39, 0xd4, 0x4c, 0x68, 0x41, 0x7b, 0x8, 0x3e};
  uint8_t bytesprops10[] = {0x23, 0xcb, 0x3e, 0x18, 0x53, 0x64, 0xcd, 0x2b, 0x18};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {28, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 15446}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5053}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {0, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 116}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19775}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 85}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 61}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {1, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 152}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7792}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {3, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 241}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 9998}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7241}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9777}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 184}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 237}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {26, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 13967}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 31}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {14, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 17429}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {9, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1396}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 20269, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 27793 [("\175\175\230\214\&2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),(",\DEL[\SO\253\205\b\135j\ESC\217",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\224\206y\244\197V\182\157Q\232\248H\131\180\228B\FS\DC2\SO\159\243w",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\197\204\211\195h[\RSa&\150PL\SO\231\187\173\192P|q\240\r\139-\232\197",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("\164\169|\199\van\145$\211<3\180)>\173Xgz:\225\DC4\163\212\141\177h",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\SUBl",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationMethod "\179\199:G\128yB\161hQ\USb",PropSubscriptionIdentifierAvailable 146,PropAssignedClientIdentifier "!\241\231\174Y\STX\178\245\"\182",PropServerReference "\243At\249\DC24\139\128\130\161\224\189\183Q\244<*R\142\134\129",PropReceiveMaximum 11764,PropTopicAlias 11978,PropServerReference "\144\ETX\210\153\r\v\163 \SI\247\234\208{2\160\&4\142\165K\"a\NAK",PropMessageExpiryInterval 7709,PropTopicAlias 11119,PropWillDelayInterval 11679,PropWildcardSubscriptionAvailable 21,PropTopicAliasMaximum 3192]
TEST(Subscribe5QCTest, Encode6) {
uint8_t pkt[] = {0x82, 0xd9, 0x1, 0x6c, 0x91, 0x67, 0x15, 0x0, 0xc, 0xb3, 0xc7, 0x3a, 0x47, 0x80, 0x79, 0x42, 0xa1, 0x68, 0x51, 0x1f, 0x62, 0x29, 0x92, 0x12, 0x0, 0xa, 0x21, 0xf1, 0xe7, 0xae, 0x59, 0x2, 0xb2, 0xf5, 0x22, 0xb6, 0x1c, 0x0, 0x15, 0xf3, 0x41, 0x74, 0xf9, 0x12, 0x34, 0x8b, 0x80, 0x82, 0xa1, 0xe0, 0xbd, 0xb7, 0x51, 0xf4, 0x3c, 0x2a, 0x52, 0x8e, 0x86, 0x81, 0x21, 0x2d, 0xf4, 0x23, 0x2e, 0xca, 0x1c, 0x0, 0x16, 0x90, 0x3, 0xd2, 0x99, 0xd, 0xb, 0xa3, 0x20, 0xf, 0xf7, 0xea, 0xd0, 0x7b, 0x32, 0xa0, 0x34, 0x8e, 0xa5, 0x4b, 0x22, 0x61, 0x15, 0x2, 0x0, 0x0, 0x1e, 0x1d, 0x23, 0x2b, 0x6f, 0x18, 0x0, 0x0, 0x2d, 0x9f, 0x28, 0x15, 0x22, 0xc, 0x78, 0x0, 0x5, 0xaf, 0xaf, 0xe6, 0xd6, 0x32, 0xd, 0x0, 0xb, 0x2c, 0x7f, 0x5b, 0xe, 0xfd, 0xcd, 0x8, 0x87, 0x6a, 0x1b, 0xd9, 0x14, 0x0, 0x16, 0xe0, 0xce, 0x79, 0xf4, 0xc5, 0x56, 0xb6, 0x9d, 0x51, 0xe8, 0xf8, 0x48, 0x83, 0xb4, 0xe4, 0x42, 0x1c, 0x12, 0xe, 0x9f, 0xf3, 0x77, 0x1, 0x0, 0x1a, 0xc5, 0xcc, 0xd3, 0xc3, 0x68, 0x5b, 0x1e, 0x61, 0x26, 0x96, 0x50, 0x4c, 0xe, 0xe7, 0xbb, 0xad, 0xc0, 0x50, 0x7c, 0x71, 0xf0, 0xd, 0x8b, 0x2d, 0xe8, 0xc5, 0x8, 0x0, 0x1b, 0xa4, 0xa9, 0x7c, 0xc7, 0xb, 0x61, 0x6e, 0x91, 0x24, 0xd3, 0x3c, 0x33, 0xb4, 0x29, 0x3e, 0xad, 0x58, 0x67, 0x7a, 0x3a, 0xe1, 0x14, 0xa3, 0xd4, 0x8d, 0xb1, 0x68, 0x1, 0x0, 0x2, 0x1a, 0x6c, 0x28};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0xaf, 0xaf, 0xe6, 0xd6, 0x32};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2c, 0x7f, 0x5b, 0xe, 0xfd, 0xcd, 0x8, 0x87, 0x6a, 0x1b, 0xd9};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe0, 0xce, 0x79, 0xf4, 0xc5, 0x56, 0xb6, 0x9d, 0x51, 0xe8, 0xf8, 0x48, 0x83, 0xb4, 0xe4, 0x42, 0x1c, 0x12, 0xe, 0x9f, 0xf3, 0x77};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc5, 0xcc, 0xd3, 0xc3, 0x68, 0x5b, 0x1e, 0x61, 0x26, 0x96, 0x50, 0x4c, 0xe, 0xe7, 0xbb, 0xad, 0xc0, 0x50, 0x7c, 0x71, 0xf0, 0xd, 0x8b, 0x2d, 0xe8, 0xc5};
  lwmqtt_string_t topic_filter_s3 = {26, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xa4, 0xa9, 0x7c, 0xc7, 0xb, 0x61, 0x6e, 0x91, 0x24, 0xd3, 0x3c, 0x33, 0xb4, 0x29, 0x3e, 0xad, 0x58, 0x67, 0x7a, 0x3a, 0xe1, 0x14, 0xa3, 0xd4, 0x8d, 0xb1, 0x68};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x1a, 0x6c};
  lwmqtt_string_t topic_filter_s5 = {2, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
lwmqtt_sub_options_t sub_opts[6];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[5].retain_as_published = true;
sub_opts[5].no_local = false;
  uint8_t bytesprops0[] = {0xb3, 0xc7, 0x3a, 0x47, 0x80, 0x79, 0x42, 0xa1, 0x68, 0x51, 0x1f, 0x62};
  uint8_t bytesprops1[] = {0x21, 0xf1, 0xe7, 0xae, 0x59, 0x2, 0xb2, 0xf5, 0x22, 0xb6};
  uint8_t bytesprops2[] = {0xf3, 0x41, 0x74, 0xf9, 0x12, 0x34, 0x8b, 0x80, 0x82, 0xa1, 0xe0, 0xbd, 0xb7, 0x51, 0xf4, 0x3c, 0x2a, 0x52, 0x8e, 0x86, 0x81};
  uint8_t bytesprops3[] = {0x90, 0x3, 0xd2, 0x99, 0xd, 0xb, 0xa3, 0x20, 0xf, 0xf7, 0xea, 0xd0, 0x7b, 0x32, 0xa0, 0x34, 0x8e, 0xa5, 0x4b, 0x22, 0x61, 0x15};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 146}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {10, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 11764}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11978}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {22, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7709}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11119}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 11679}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 21}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 3192}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 27793, 6, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 30311 [("a\220\187\230\175\184\177\131\&8n\180}\229Z",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\234\199\181\DC1N\b",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropMaximumQoS 66,PropMaximumPacketSize 1305,PropUserProperty "\DEL\DC4#\197Y\192k\218\246D\208\177\&2`\SYN\158\177\153\251\205/##Yq" "\187z\212\171\b]\146Q\190X\193\SOH\140\&1aw \219\200",PropReceiveMaximum 19885]
TEST(Subscribe5QCTest, Encode7) {
uint8_t pkt[] = {0x82, 0x5b, 0x76, 0x67, 0x3b, 0x24, 0x42, 0x27, 0x0, 0x0, 0x5, 0x19, 0x26, 0x0, 0x19, 0x7f, 0x14, 0x23, 0xc5, 0x59, 0xc0, 0x6b, 0xda, 0xf6, 0x44, 0xd0, 0xb1, 0x32, 0x60, 0x16, 0x9e, 0xb1, 0x99, 0xfb, 0xcd, 0x2f, 0x23, 0x23, 0x59, 0x71, 0x0, 0x13, 0xbb, 0x7a, 0xd4, 0xab, 0x8, 0x5d, 0x92, 0x51, 0xbe, 0x58, 0xc1, 0x1, 0x8c, 0x31, 0x61, 0x77, 0x20, 0xdb, 0xc8, 0x21, 0x4d, 0xad, 0x0, 0xe, 0x61, 0xdc, 0xbb, 0xe6, 0xaf, 0xb8, 0xb1, 0x83, 0x38, 0x6e, 0xb4, 0x7d, 0xe5, 0x5a, 0x10, 0x0, 0x6, 0xea, 0xc7, 0xb5, 0x11, 0x4e, 0x8, 0x2a, 0x0, 0x0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x61, 0xdc, 0xbb, 0xe6, 0xaf, 0xb8, 0xb1, 0x83, 0x38, 0x6e, 0xb4, 0x7d, 0xe5, 0x5a};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xea, 0xc7, 0xb5, 0x11, 0x4e, 0x8};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  uint8_t bytesprops1[] = {0xbb, 0x7a, 0xd4, 0xab, 0x8, 0x5d, 0x92, 0x51, 0xbe, 0x58, 0xc1, 0x1, 0x8c, 0x31, 0x61, 0x77, 0x20, 0xdb, 0xc8};
  uint8_t bytesprops0[] = {0x7f, 0x14, 0x23, 0xc5, 0x59, 0xc0, 0x6b, 0xda, 0xf6, 0x44, 0xd0, 0xb1, 0x32, 0x60, 0x16, 0x9e, 0xb1, 0x99, 0xfb, 0xcd, 0x2f, 0x23, 0x23, 0x59, 0x71};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 66}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1305}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={25, (char*)&bytesprops0}, .v={19, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19885}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 30311, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 32651 [("\168U\NULn\148",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k\141i\169",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\ESC\250F\175_R",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\187\219|!\193M\251\187\176h\ETB",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\155m$\224\202\136\212\255\150=\242\197\195P\SUB\211",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\193\143\128\SOH5\150K6\STX",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0})] [PropReceiveMaximum 4662,PropServerReference "\185\147*\251\135\214-i\235X\131\150N\212\218WAt;f\178\154\151\134\196\201\ACK",PropRequestResponseInformation 121,PropSharedSubscriptionAvailable 183,PropTopicAliasMaximum 1031,PropWildcardSubscriptionAvailable 176,PropWillDelayInterval 19156,PropAuthenticationData "@\236w\239\151\215\165dQ\146\ETBlx\DELr\150\SIP/\ACK\182\DLEf\224\155/\DC3\SO\NAK",PropSubscriptionIdentifierAvailable 108,PropSessionExpiryInterval 24703,PropSessionExpiryInterval 14135,PropReasonString "\183b\177\178E\239?\243\EOT\166\160\215QXm\ETB",PropSessionExpiryInterval 448,PropPayloadFormatIndicator 126]
TEST(Subscribe5QCTest, Encode8) {
uint8_t pkt[] = {0x82, 0xbd, 0x1, 0x7f, 0x8b, 0x75, 0x21, 0x12, 0x36, 0x1c, 0x0, 0x1b, 0xb9, 0x93, 0x2a, 0xfb, 0x87, 0xd6, 0x2d, 0x69, 0xeb, 0x58, 0x83, 0x96, 0x4e, 0xd4, 0xda, 0x57, 0x41, 0x74, 0x3b, 0x66, 0xb2, 0x9a, 0x97, 0x86, 0xc4, 0xc9, 0x6, 0x19, 0x79, 0x2a, 0xb7, 0x22, 0x4, 0x7, 0x28, 0xb0, 0x18, 0x0, 0x0, 0x4a, 0xd4, 0x16, 0x0, 0x1d, 0x40, 0xec, 0x77, 0xef, 0x97, 0xd7, 0xa5, 0x64, 0x51, 0x92, 0x17, 0x6c, 0x78, 0x7f, 0x72, 0x96, 0xf, 0x50, 0x2f, 0x6, 0xb6, 0x10, 0x66, 0xe0, 0x9b, 0x2f, 0x13, 0xe, 0x15, 0x29, 0x6c, 0x11, 0x0, 0x0, 0x60, 0x7f, 0x11, 0x0, 0x0, 0x37, 0x37, 0x1f, 0x0, 0x10, 0xb7, 0x62, 0xb1, 0xb2, 0x45, 0xef, 0x3f, 0xf3, 0x4, 0xa6, 0xa0, 0xd7, 0x51, 0x58, 0x6d, 0x17, 0x11, 0x0, 0x0, 0x1, 0xc0, 0x1, 0x7e, 0x0, 0x5, 0xa8, 0x55, 0x0, 0x6e, 0x94, 0x20, 0x0, 0x4, 0x6b, 0x8d, 0x69, 0xa9, 0x29, 0x0, 0x6, 0x1b, 0xfa, 0x46, 0xaf, 0x5f, 0x52, 0x22, 0x0, 0xb, 0xbb, 0xdb, 0x7c, 0x21, 0xc1, 0x4d, 0xfb, 0xbb, 0xb0, 0x68, 0x17, 0x24, 0x0, 0x10, 0x9b, 0x6d, 0x24, 0xe0, 0xca, 0x88, 0xd4, 0xff, 0x96, 0x3d, 0xf2, 0xc5, 0xc3, 0x50, 0x1a, 0xd3, 0x12, 0x0, 0x9, 0xc1, 0x8f, 0x80, 0x1, 0x35, 0x96, 0x4b, 0x36, 0x2, 0x8};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0xa8, 0x55, 0x0, 0x6e, 0x94};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6b, 0x8d, 0x69, 0xa9};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1b, 0xfa, 0x46, 0xaf, 0x5f, 0x52};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xbb, 0xdb, 0x7c, 0x21, 0xc1, 0x4d, 0xfb, 0xbb, 0xb0, 0x68, 0x17};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0x6d, 0x24, 0xe0, 0xca, 0x88, 0xd4, 0xff, 0x96, 0x3d, 0xf2, 0xc5, 0xc3, 0x50, 0x1a, 0xd3};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xc1, 0x8f, 0x80, 0x1, 0x35, 0x96, 0x4b, 0x36, 0x2};
  lwmqtt_string_t topic_filter_s5 = {9, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
lwmqtt_sub_options_t sub_opts[6];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = true;
sub_opts[5].no_local = false;
  uint8_t bytesprops0[] = {0xb9, 0x93, 0x2a, 0xfb, 0x87, 0xd6, 0x2d, 0x69, 0xeb, 0x58, 0x83, 0x96, 0x4e, 0xd4, 0xda, 0x57, 0x41, 0x74, 0x3b, 0x66, 0xb2, 0x9a, 0x97, 0x86, 0xc4, 0xc9, 0x6};
  uint8_t bytesprops1[] = {0x40, 0xec, 0x77, 0xef, 0x97, 0xd7, 0xa5, 0x64, 0x51, 0x92, 0x17, 0x6c, 0x78, 0x7f, 0x72, 0x96, 0xf, 0x50, 0x2f, 0x6, 0xb6, 0x10, 0x66, 0xe0, 0x9b, 0x2f, 0x13, 0xe, 0x15};
  uint8_t bytesprops2[] = {0xb7, 0x62, 0xb1, 0xb2, 0x45, 0xef, 0x3f, 0xf3, 0x4, 0xa6, 0xa0, 0xd7, 0x51, 0x58, 0x6d, 0x17};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 4662}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 121}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 183}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1031}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 176}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 19156}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 108}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 24703}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 14135}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {16, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 448}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 126}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 32651, 6, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 15465 [("\234y<\176R ]*\193\136",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\DC3v\b\SOH9",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("6'\ACK}p\CAN\144g\147~\200\182&\173\176\128%ev\142\SIT\254\138\&1h\US\169\210R",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0})] [PropWillDelayInterval 2288,PropCorrelationData "\211\FS\ACK&\a\251\EOT\184RW\193l8K\249",PropAuthenticationMethod "\158N2 qL\156\209\141.\218{\137\206\234\159F(\187\195\215\246k2\139\177",PropCorrelationData "\251\\\SYN\244\&7\208\199\248\t\170\&5\146\155\172j\231\177\137\211\ETBK\136\SOH\133",PropPayloadFormatIndicator 176,PropMaximumPacketSize 8470,PropCorrelationData "^\243\179\128\DC4M.bt\r\186.",PropAuthenticationData "K\185\137\&9\155Sa\FS\199k\200R.\142y\158\158]\220\188\STX\r=\RS\185"]
TEST(Subscribe5QCTest, Encode9) {
uint8_t pkt[] = {0x82, 0xbb, 0x1, 0x3c, 0x69, 0x81, 0x1, 0x18, 0x0, 0x0, 0x8, 0xf0, 0x9, 0x0, 0xf, 0xd3, 0x1c, 0x6, 0x26, 0x7, 0xfb, 0x4, 0xb8, 0x52, 0x57, 0xc1, 0x6c, 0x38, 0x4b, 0xf9, 0x15, 0x0, 0x1a, 0x9e, 0x4e, 0x32, 0x20, 0x71, 0x4c, 0x9c, 0xd1, 0x8d, 0x2e, 0xda, 0x7b, 0x89, 0xce, 0xea, 0x9f, 0x46, 0x28, 0xbb, 0xc3, 0xd7, 0xf6, 0x6b, 0x32, 0x8b, 0xb1, 0x9, 0x0, 0x18, 0xfb, 0x5c, 0x16, 0xf4, 0x37, 0xd0, 0xc7, 0xf8, 0x9, 0xaa, 0x35, 0x92, 0x9b, 0xac, 0x6a, 0xe7, 0xb1, 0x89, 0xd3, 0x17, 0x4b, 0x88, 0x1, 0x85, 0x1, 0xb0, 0x27, 0x0, 0x0, 0x21, 0x16, 0x9, 0x0, 0xc, 0x5e, 0xf3, 0xb3, 0x80, 0x14, 0x4d, 0x2e, 0x62, 0x74, 0xd, 0xba, 0x2e, 0x16, 0x0, 0x19, 0x4b, 0xb9, 0x89, 0x39, 0x9b, 0x53, 0x61, 0x1c, 0xc7, 0x6b, 0xc8, 0x52, 0x2e, 0x8e, 0x79, 0x9e, 0x9e, 0x5d, 0xdc, 0xbc, 0x2, 0xd, 0x3d, 0x1e, 0xb9, 0x0, 0xa, 0xea, 0x79, 0x3c, 0xb0, 0x52, 0x20, 0x5d, 0x2a, 0xc1, 0x88, 0x11, 0x0, 0x5, 0x13, 0x76, 0x8, 0x1, 0x39, 0x25, 0x0, 0x1e, 0x36, 0x27, 0x6, 0x7d, 0x70, 0x18, 0x90, 0x67, 0x93, 0x7e, 0xc8, 0xb6, 0x26, 0xad, 0xb0, 0x80, 0x25, 0x65, 0x76, 0x8e, 0xf, 0x54, 0xfe, 0x8a, 0x31, 0x68, 0x1f, 0xa9, 0xd2, 0x52, 0x1c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xea, 0x79, 0x3c, 0xb0, 0x52, 0x20, 0x5d, 0x2a, 0xc1, 0x88};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x13, 0x76, 0x8, 0x1, 0x39};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x36, 0x27, 0x6, 0x7d, 0x70, 0x18, 0x90, 0x67, 0x93, 0x7e, 0xc8, 0xb6, 0x26, 0xad, 0xb0, 0x80, 0x25, 0x65, 0x76, 0x8e, 0xf, 0x54, 0xfe, 0x8a, 0x31, 0x68, 0x1f, 0xa9, 0xd2, 0x52};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
  uint8_t bytesprops0[] = {0xd3, 0x1c, 0x6, 0x26, 0x7, 0xfb, 0x4, 0xb8, 0x52, 0x57, 0xc1, 0x6c, 0x38, 0x4b, 0xf9};
  uint8_t bytesprops1[] = {0x9e, 0x4e, 0x32, 0x20, 0x71, 0x4c, 0x9c, 0xd1, 0x8d, 0x2e, 0xda, 0x7b, 0x89, 0xce, 0xea, 0x9f, 0x46, 0x28, 0xbb, 0xc3, 0xd7, 0xf6, 0x6b, 0x32, 0x8b, 0xb1};
  uint8_t bytesprops2[] = {0xfb, 0x5c, 0x16, 0xf4, 0x37, 0xd0, 0xc7, 0xf8, 0x9, 0xaa, 0x35, 0x92, 0x9b, 0xac, 0x6a, 0xe7, 0xb1, 0x89, 0xd3, 0x17, 0x4b, 0x88, 0x1, 0x85};
  uint8_t bytesprops3[] = {0x5e, 0xf3, 0xb3, 0x80, 0x14, 0x4d, 0x2e, 0x62, 0x74, 0xd, 0xba, 0x2e};
  uint8_t bytesprops4[] = {0x4b, 0xb9, 0x89, 0x39, 0x9b, 0x53, 0x61, 0x1c, 0xc7, 0x6b, 0xc8, 0x52, 0x2e, 0x8e, 0x79, 0x9e, 0x9e, 0x5d, 0xdc, 0xbc, 0x2, 0xd, 0x3d, 0x1e, 0xb9};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 2288}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {15, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 176}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 8470}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 15465, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 31381 [("\230\234.\186\229\249Tuf\222\188\DC4 \193J\t\DLE}\156<\255\150\156\146\136\132\a",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\143\&6\250ODD\155\192\210\157\152",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\240ni\SUB}\189/\167\&4\ACK\213\129o\150",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropWildcardSubscriptionAvailable 59]
TEST(Subscribe5QCTest, Encode10) {
uint8_t pkt[] = {0x82, 0x42, 0x7a, 0x95, 0x2, 0x28, 0x3b, 0x0, 0x1b, 0xe6, 0xea, 0x2e, 0xba, 0xe5, 0xf9, 0x54, 0x75, 0x66, 0xde, 0xbc, 0x14, 0x20, 0xc1, 0x4a, 0x9, 0x10, 0x7d, 0x9c, 0x3c, 0xff, 0x96, 0x9c, 0x92, 0x88, 0x84, 0x7, 0xe, 0x0, 0xb, 0x8f, 0x36, 0xfa, 0x4f, 0x44, 0x44, 0x9b, 0xc0, 0xd2, 0x9d, 0x98, 0x1d, 0x0, 0xe, 0xf0, 0x6e, 0x69, 0x1a, 0x7d, 0xbd, 0x2f, 0xa7, 0x34, 0x6, 0xd5, 0x81, 0x6f, 0x96, 0x20};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xe6, 0xea, 0x2e, 0xba, 0xe5, 0xf9, 0x54, 0x75, 0x66, 0xde, 0xbc, 0x14, 0x20, 0xc1, 0x4a, 0x9, 0x10, 0x7d, 0x9c, 0x3c, 0xff, 0x96, 0x9c, 0x92, 0x88, 0x84, 0x7};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8f, 0x36, 0xfa, 0x4f, 0x44, 0x44, 0x9b, 0xc0, 0xd2, 0x9d, 0x98};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf0, 0x6e, 0x69, 0x1a, 0x7d, 0xbd, 0x2f, 0xa7, 0x34, 0x6, 0xd5, 0x81, 0x6f, 0x96};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 59}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 31381, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 25357 [("+\142\146\175\bU\244B\225\175s\255)",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationMethod "\236\175\129\179\DC4\166\179eCC\159\132\217\US\196\243\158\232h\208\148\236\&6c",PropMaximumQoS 88,PropMaximumQoS 51,PropAssignedClientIdentifier "\254",PropAuthenticationMethod "\243_td\f\NAK\v\205\253\237^\155\217i\225V\STX8\134\218\176\205",PropSubscriptionIdentifierAvailable 137,PropRequestProblemInformation 79,PropServerReference "(\153U\SO\202\SI]94",PropResponseInformation "\DEL\179%W\177+\f\141\155\243@%\199X\241\133V/-\173\t_\137'",PropRequestResponseInformation 175,PropMessageExpiryInterval 24849,PropTopicAliasMaximum 8185,PropWildcardSubscriptionAvailable 101,PropServerKeepAlive 23055,PropServerReference "\236\254R\169\GS\134\197X\215k\163\187\t\237\&2\205\227\167\227`",PropAuthenticationData "!\233L8T\128\191\&8\DC1\182\134\147\134\224\208I={*\246\252\205L[%\131",PropCorrelationData "\211CJ\205b\130`b\179\225\f\DEL\188\&1\136Y\204$!n\233\ESC\197\130\FS\222\202\144s\194",PropAuthenticationData "\DLE\DLEt\164\135\&4\182\134l\192wt\NAKwx\138\163\157\175\240J\228\130E\230",PropServerReference "\163\DC1\175&|\177\&7I\210\196u\227\US\204\168Y",PropSubscriptionIdentifier 23]
TEST(Subscribe5QCTest, Encode11) {
uint8_t pkt[] = {0x82, 0x90, 0x2, 0x63, 0xd, 0xfc, 0x1, 0x15, 0x0, 0x18, 0xec, 0xaf, 0x81, 0xb3, 0x14, 0xa6, 0xb3, 0x65, 0x43, 0x43, 0x9f, 0x84, 0xd9, 0x1f, 0xc4, 0xf3, 0x9e, 0xe8, 0x68, 0xd0, 0x94, 0xec, 0x36, 0x63, 0x24, 0x58, 0x24, 0x33, 0x12, 0x0, 0x1, 0xfe, 0x15, 0x0, 0x16, 0xf3, 0x5f, 0x74, 0x64, 0xc, 0x15, 0xb, 0xcd, 0xfd, 0xed, 0x5e, 0x9b, 0xd9, 0x69, 0xe1, 0x56, 0x2, 0x38, 0x86, 0xda, 0xb0, 0xcd, 0x29, 0x89, 0x17, 0x4f, 0x1c, 0x0, 0x9, 0x28, 0x99, 0x55, 0xe, 0xca, 0xf, 0x5d, 0x39, 0x34, 0x1a, 0x0, 0x18, 0x7f, 0xb3, 0x25, 0x57, 0xb1, 0x2b, 0xc, 0x8d, 0x9b, 0xf3, 0x40, 0x25, 0xc7, 0x58, 0xf1, 0x85, 0x56, 0x2f, 0x2d, 0xad, 0x9, 0x5f, 0x89, 0x27, 0x19, 0xaf, 0x2, 0x0, 0x0, 0x61, 0x11, 0x22, 0x1f, 0xf9, 0x28, 0x65, 0x13, 0x5a, 0xf, 0x1c, 0x0, 0x14, 0xec, 0xfe, 0x52, 0xa9, 0x1d, 0x86, 0xc5, 0x58, 0xd7, 0x6b, 0xa3, 0xbb, 0x9, 0xed, 0x32, 0xcd, 0xe3, 0xa7, 0xe3, 0x60, 0x16, 0x0, 0x1a, 0x21, 0xe9, 0x4c, 0x38, 0x54, 0x80, 0xbf, 0x38, 0x11, 0xb6, 0x86, 0x93, 0x86, 0xe0, 0xd0, 0x49, 0x3d, 0x7b, 0x2a, 0xf6, 0xfc, 0xcd, 0x4c, 0x5b, 0x25, 0x83, 0x9, 0x0, 0x1e, 0xd3, 0x43, 0x4a, 0xcd, 0x62, 0x82, 0x60, 0x62, 0xb3, 0xe1, 0xc, 0x7f, 0xbc, 0x31, 0x88, 0x59, 0xcc, 0x24, 0x21, 0x6e, 0xe9, 0x1b, 0xc5, 0x82, 0x1c, 0xde, 0xca, 0x90, 0x73, 0xc2, 0x16, 0x0, 0x19, 0x10, 0x10, 0x74, 0xa4, 0x87, 0x34, 0xb6, 0x86, 0x6c, 0xc0, 0x77, 0x74, 0x15, 0x77, 0x78, 0x8a, 0xa3, 0x9d, 0xaf, 0xf0, 0x4a, 0xe4, 0x82, 0x45, 0xe6, 0x1c, 0x0, 0x10, 0xa3, 0x11, 0xaf, 0x26, 0x7c, 0xb1, 0x37, 0x49, 0xd2, 0xc4, 0x75, 0xe3, 0x1f, 0xcc, 0xa8, 0x59, 0xb, 0x17, 0x0, 0xd, 0x2b, 0x8e, 0x92, 0xaf, 0x8, 0x55, 0xf4, 0x42, 0xe1, 0xaf, 0x73, 0xff, 0x29, 0x20};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x2b, 0x8e, 0x92, 0xaf, 0x8, 0x55, 0xf4, 0x42, 0xe1, 0xaf, 0x73, 0xff, 0x29};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
  uint8_t bytesprops0[] = {0xec, 0xaf, 0x81, 0xb3, 0x14, 0xa6, 0xb3, 0x65, 0x43, 0x43, 0x9f, 0x84, 0xd9, 0x1f, 0xc4, 0xf3, 0x9e, 0xe8, 0x68, 0xd0, 0x94, 0xec, 0x36, 0x63};
  uint8_t bytesprops1[] = {0xfe};
  uint8_t bytesprops2[] = {0xf3, 0x5f, 0x74, 0x64, 0xc, 0x15, 0xb, 0xcd, 0xfd, 0xed, 0x5e, 0x9b, 0xd9, 0x69, 0xe1, 0x56, 0x2, 0x38, 0x86, 0xda, 0xb0, 0xcd};
  uint8_t bytesprops3[] = {0x28, 0x99, 0x55, 0xe, 0xca, 0xf, 0x5d, 0x39, 0x34};
  uint8_t bytesprops4[] = {0x7f, 0xb3, 0x25, 0x57, 0xb1, 0x2b, 0xc, 0x8d, 0x9b, 0xf3, 0x40, 0x25, 0xc7, 0x58, 0xf1, 0x85, 0x56, 0x2f, 0x2d, 0xad, 0x9, 0x5f, 0x89, 0x27};
  uint8_t bytesprops5[] = {0xec, 0xfe, 0x52, 0xa9, 0x1d, 0x86, 0xc5, 0x58, 0xd7, 0x6b, 0xa3, 0xbb, 0x9, 0xed, 0x32, 0xcd, 0xe3, 0xa7, 0xe3, 0x60};
  uint8_t bytesprops6[] = {0x21, 0xe9, 0x4c, 0x38, 0x54, 0x80, 0xbf, 0x38, 0x11, 0xb6, 0x86, 0x93, 0x86, 0xe0, 0xd0, 0x49, 0x3d, 0x7b, 0x2a, 0xf6, 0xfc, 0xcd, 0x4c, 0x5b, 0x25, 0x83};
  uint8_t bytesprops7[] = {0xd3, 0x43, 0x4a, 0xcd, 0x62, 0x82, 0x60, 0x62, 0xb3, 0xe1, 0xc, 0x7f, 0xbc, 0x31, 0x88, 0x59, 0xcc, 0x24, 0x21, 0x6e, 0xe9, 0x1b, 0xc5, 0x82, 0x1c, 0xde, 0xca, 0x90, 0x73, 0xc2};
  uint8_t bytesprops8[] = {0x10, 0x10, 0x74, 0xa4, 0x87, 0x34, 0xb6, 0x86, 0x6c, 0xc0, 0x77, 0x74, 0x15, 0x77, 0x78, 0x8a, 0xa3, 0x9d, 0xaf, 0xf0, 0x4a, 0xe4, 0x82, 0x45, 0xe6};
  uint8_t bytesprops9[] = {0xa3, 0x11, 0xaf, 0x26, 0x7c, 0xb1, 0x37, 0x49, 0xd2, 0xc4, 0x75, 0xe3, 0x1f, 0xcc, 0xa8, 0x59};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {24, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 88}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 51}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {1, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {22, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 137}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 79}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {9, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {24, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 175}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24849}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 8185}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 101}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 23055}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {20, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {16, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 23}},
  };

  lwmqtt_properties_t props = {20, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25357, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21412 [("w\218]r\ESC\143<q\242L",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0})] [PropMaximumQoS 153,PropAuthenticationMethod "\207\&0:\165O",PropAuthenticationMethod "a\n)+o\128O\223\ETX\243\EOT>}\r\199\224\149",PropMessageExpiryInterval 8464,PropRequestResponseInformation 192,PropAssignedClientIdentifier "\212\215\253#\214$\160\&0\163\237\128\134\US?\180\212\219"]
TEST(Subscribe5QCTest, Encode12) {
uint8_t pkt[] = {0x82, 0x49, 0x53, 0xa4, 0x39, 0x24, 0x99, 0x15, 0x0, 0x5, 0xcf, 0x30, 0x3a, 0xa5, 0x4f, 0x15, 0x0, 0x11, 0x61, 0xa, 0x29, 0x2b, 0x6f, 0x80, 0x4f, 0xdf, 0x3, 0xf3, 0x4, 0x3e, 0x7d, 0xd, 0xc7, 0xe0, 0x95, 0x2, 0x0, 0x0, 0x21, 0x10, 0x19, 0xc0, 0x12, 0x0, 0x11, 0xd4, 0xd7, 0xfd, 0x23, 0xd6, 0x24, 0xa0, 0x30, 0xa3, 0xed, 0x80, 0x86, 0x1f, 0x3f, 0xb4, 0xd4, 0xdb, 0x0, 0xa, 0x77, 0xda, 0x5d, 0x72, 0x1b, 0x8f, 0x3c, 0x71, 0xf2, 0x4c, 0x4};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x77, 0xda, 0x5d, 0x72, 0x1b, 0x8f, 0x3c, 0x71, 0xf2, 0x4c};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
lwmqtt_sub_options_t sub_opts[1];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = true;
  uint8_t bytesprops0[] = {0xcf, 0x30, 0x3a, 0xa5, 0x4f};
  uint8_t bytesprops1[] = {0x61, 0xa, 0x29, 0x2b, 0x6f, 0x80, 0x4f, 0xdf, 0x3, 0xf3, 0x4, 0x3e, 0x7d, 0xd, 0xc7, 0xe0, 0x95};
  uint8_t bytesprops2[] = {0xd4, 0xd7, 0xfd, 0x23, 0xd6, 0x24, 0xa0, 0x30, 0xa3, 0xed, 0x80, 0x86, 0x1f, 0x3f, 0xb4, 0xd4, 0xdb};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 153}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {5, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8464}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 192}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&bytesprops2}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21412, 1, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 10276 [("\SYN\144\218\230l\154\217\219\225\DLE\150m\141\195\222\183#N\DC1\219)\226\a\206y\204\150\RS\214\178",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("R\229\195\208\168\199\145\206\150\202|l\251\139`[\165@GL\SI\229\191!\183s\t\184\153",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationMethod "\\\238\220\219NN_\DELm(\138\183\164O\215q\195n\231#\208\182\DC3\RSJ",PropAuthenticationMethod "\DC3\156",PropTopicAlias 26024,PropResponseTopic "2\n0\139\212\176\255\&8\243b)\a\222n\233N\222\149\208]s\154\147",PropRequestResponseInformation 121,PropAuthenticationData "\162\140\203\163\170\250\194\153\144O4\162;\137\215\168\129\216S\244v\251\&0V\ACKL6",PropMaximumPacketSize 9941,PropResponseInformation "\235\208g\251\DLEO\192\&1\201\STX\ESC\238\183",PropPayloadFormatIndicator 104,PropSessionExpiryInterval 25608,PropAuthenticationMethod "\239",PropWildcardSubscriptionAvailable 163,PropTopicAliasMaximum 2138,PropAuthenticationMethod "+\189\240\243\152G-\185\254\v\152\161\146\&6",PropAuthenticationMethod "7\\)",PropMessageExpiryInterval 9959,PropWillDelayInterval 14260,PropMaximumQoS 41,PropServerReference "4",PropReasonString "\200\215\155\212\DC4\144\239\244\247q",PropWildcardSubscriptionAvailable 249,PropMaximumPacketSize 13691,PropTopicAlias 25895,PropReceiveMaximum 13454]
TEST(Subscribe5QCTest, Encode13) {
uint8_t pkt[] = {0x82, 0x89, 0x2, 0x28, 0x24, 0xc4, 0x1, 0x15, 0x0, 0x19, 0x5c, 0xee, 0xdc, 0xdb, 0x4e, 0x4e, 0x5f, 0x7f, 0x6d, 0x28, 0x8a, 0xb7, 0xa4, 0x4f, 0xd7, 0x71, 0xc3, 0x6e, 0xe7, 0x23, 0xd0, 0xb6, 0x13, 0x1e, 0x4a, 0x15, 0x0, 0x2, 0x13, 0x9c, 0x23, 0x65, 0xa8, 0x8, 0x0, 0x17, 0x32, 0xa, 0x30, 0x8b, 0xd4, 0xb0, 0xff, 0x38, 0xf3, 0x62, 0x29, 0x7, 0xde, 0x6e, 0xe9, 0x4e, 0xde, 0x95, 0xd0, 0x5d, 0x73, 0x9a, 0x93, 0x19, 0x79, 0x16, 0x0, 0x1b, 0xa2, 0x8c, 0xcb, 0xa3, 0xaa, 0xfa, 0xc2, 0x99, 0x90, 0x4f, 0x34, 0xa2, 0x3b, 0x89, 0xd7, 0xa8, 0x81, 0xd8, 0x53, 0xf4, 0x76, 0xfb, 0x30, 0x56, 0x6, 0x4c, 0x36, 0x27, 0x0, 0x0, 0x26, 0xd5, 0x1a, 0x0, 0xd, 0xeb, 0xd0, 0x67, 0xfb, 0x10, 0x4f, 0xc0, 0x31, 0xc9, 0x2, 0x1b, 0xee, 0xb7, 0x1, 0x68, 0x11, 0x0, 0x0, 0x64, 0x8, 0x15, 0x0, 0x1, 0xef, 0x28, 0xa3, 0x22, 0x8, 0x5a, 0x15, 0x0, 0xe, 0x2b, 0xbd, 0xf0, 0xf3, 0x98, 0x47, 0x2d, 0xb9, 0xfe, 0xb, 0x98, 0xa1, 0x92, 0x36, 0x15, 0x0, 0x3, 0x37, 0x5c, 0x29, 0x2, 0x0, 0x0, 0x26, 0xe7, 0x18, 0x0, 0x0, 0x37, 0xb4, 0x24, 0x29, 0x1c, 0x0, 0x1, 0x34, 0x1f, 0x0, 0xa, 0xc8, 0xd7, 0x9b, 0xd4, 0x14, 0x90, 0xef, 0xf4, 0xf7, 0x71, 0x28, 0xf9, 0x27, 0x0, 0x0, 0x35, 0x7b, 0x23, 0x65, 0x27, 0x21, 0x34, 0x8e, 0x0, 0x1e, 0x16, 0x90, 0xda, 0xe6, 0x6c, 0x9a, 0xd9, 0xdb, 0xe1, 0x10, 0x96, 0x6d, 0x8d, 0xc3, 0xde, 0xb7, 0x23, 0x4e, 0x11, 0xdb, 0x29, 0xe2, 0x7, 0xce, 0x79, 0xcc, 0x96, 0x1e, 0xd6, 0xb2, 0x10, 0x0, 0x1d, 0x52, 0xe5, 0xc3, 0xd0, 0xa8, 0xc7, 0x91, 0xce, 0x96, 0xca, 0x7c, 0x6c, 0xfb, 0x8b, 0x60, 0x5b, 0xa5, 0x40, 0x47, 0x4c, 0xf, 0xe5, 0xbf, 0x21, 0xb7, 0x73, 0x9, 0xb8, 0x99, 0x10};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x16, 0x90, 0xda, 0xe6, 0x6c, 0x9a, 0xd9, 0xdb, 0xe1, 0x10, 0x96, 0x6d, 0x8d, 0xc3, 0xde, 0xb7, 0x23, 0x4e, 0x11, 0xdb, 0x29, 0xe2, 0x7, 0xce, 0x79, 0xcc, 0x96, 0x1e, 0xd6, 0xb2};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x52, 0xe5, 0xc3, 0xd0, 0xa8, 0xc7, 0x91, 0xce, 0x96, 0xca, 0x7c, 0x6c, 0xfb, 0x8b, 0x60, 0x5b, 0xa5, 0x40, 0x47, 0x4c, 0xf, 0xe5, 0xbf, 0x21, 0xb7, 0x73, 0x9, 0xb8, 0x99};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
lwmqtt_sub_options_t sub_opts[2];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
  uint8_t bytesprops0[] = {0x5c, 0xee, 0xdc, 0xdb, 0x4e, 0x4e, 0x5f, 0x7f, 0x6d, 0x28, 0x8a, 0xb7, 0xa4, 0x4f, 0xd7, 0x71, 0xc3, 0x6e, 0xe7, 0x23, 0xd0, 0xb6, 0x13, 0x1e, 0x4a};
  uint8_t bytesprops1[] = {0x13, 0x9c};
  uint8_t bytesprops2[] = {0x32, 0xa, 0x30, 0x8b, 0xd4, 0xb0, 0xff, 0x38, 0xf3, 0x62, 0x29, 0x7, 0xde, 0x6e, 0xe9, 0x4e, 0xde, 0x95, 0xd0, 0x5d, 0x73, 0x9a, 0x93};
  uint8_t bytesprops3[] = {0xa2, 0x8c, 0xcb, 0xa3, 0xaa, 0xfa, 0xc2, 0x99, 0x90, 0x4f, 0x34, 0xa2, 0x3b, 0x89, 0xd7, 0xa8, 0x81, 0xd8, 0x53, 0xf4, 0x76, 0xfb, 0x30, 0x56, 0x6, 0x4c, 0x36};
  uint8_t bytesprops4[] = {0xeb, 0xd0, 0x67, 0xfb, 0x10, 0x4f, 0xc0, 0x31, 0xc9, 0x2, 0x1b, 0xee, 0xb7};
  uint8_t bytesprops5[] = {0xef};
  uint8_t bytesprops6[] = {0x2b, 0xbd, 0xf0, 0xf3, 0x98, 0x47, 0x2d, 0xb9, 0xfe, 0xb, 0x98, 0xa1, 0x92, 0x36};
  uint8_t bytesprops7[] = {0x37, 0x5c, 0x29};
  uint8_t bytesprops8[] = {0x34};
  uint8_t bytesprops9[] = {0xc8, 0xd7, 0x9b, 0xd4, 0x14, 0x90, 0xef, 0xf4, 0xf7, 0x71};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 26024}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 121}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {27, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 9941}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 25608}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {1, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 163}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 2138}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9959}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 14260}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 41}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 249}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 13691}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25895}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13454}},
  };

  lwmqtt_properties_t props = {24, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10276, 2, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 7750 [("\191\131\229\247n\DC4\170]A\183\163\132",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\209U\"`\185\222\252RC|G\202#\161P\240\SYN\DLE;@\172\251\188dV",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\188t\246J\ETX\174",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\154<\139\";}\250\187\&0pG\224\173\148\216\238#R\187\168\142\190",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("}\146\176\ncE\212\185:\132-\DLE9\ETB[r",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("m\DC3\169\GSX\164\&5\158\RS\153\235W8\CANp",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\151\209",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("$U\214\224\143\199M\166v\143\&6\241\STX\DC2U\245\144\153\135n\161\146\SOH",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\247\ACK\228'\209\245\RS\\\148\ACK\254\187\255gl\215",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\229rp:\145\167\ACK\191\188\195\US\\",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1})] [PropWillDelayInterval 882,PropReasonString "1\ENQ\r\238\181 \ACK\ag\200\196j\157{c\173",PropWillDelayInterval 16738,PropAuthenticationData "\CAN\231",PropReasonString ".\161\&5g\NUL\183\147\197#k\157\GSz1)",PropMaximumQoS 208,PropRequestProblemInformation 104,PropUserProperty "\\\188t\\+Vg\177\139\206 \211\236=AU\161;\199f}\153-z\DC3\156\177\159\132\248" ":\138\203\NAKa\NUL\178\130\160(\SYN^\223\226:U\DC3\215\155\129\160\ETB",PropAssignedClientIdentifier "\225",PropRetainAvailable 233,PropAssignedClientIdentifier "\161S\232K\203",PropRequestProblemInformation 70,PropContentType "\192M\"greI\199\177}Z])",PropTopicAliasMaximum 692,PropMaximumQoS 117,PropRequestResponseInformation 183,PropTopicAliasMaximum 2828,PropReceiveMaximum 13055,PropReceiveMaximum 14438,PropWildcardSubscriptionAvailable 164,PropPayloadFormatIndicator 120,PropResponseInformation "\SYN\DEL%\222\178u\248\132\247\212\229u\155Iu\217\182@I\ETB\"X",PropTopicAlias 26576]
TEST(Subscribe5QCTest, Encode14) {
uint8_t pkt[] = {0x82, 0xf8, 0x2, 0x1e, 0x46, 0xc1, 0x1, 0x18, 0x0, 0x0, 0x3, 0x72, 0x1f, 0x0, 0x10, 0x31, 0x5, 0xd, 0xee, 0xb5, 0x20, 0x6, 0x7, 0x67, 0xc8, 0xc4, 0x6a, 0x9d, 0x7b, 0x63, 0xad, 0x18, 0x0, 0x0, 0x41, 0x62, 0x16, 0x0, 0x2, 0x18, 0xe7, 0x1f, 0x0, 0xf, 0x2e, 0xa1, 0x35, 0x67, 0x0, 0xb7, 0x93, 0xc5, 0x23, 0x6b, 0x9d, 0x1d, 0x7a, 0x31, 0x29, 0x24, 0xd0, 0x17, 0x68, 0x26, 0x0, 0x1e, 0x5c, 0xbc, 0x74, 0x5c, 0x2b, 0x56, 0x67, 0xb1, 0x8b, 0xce, 0x20, 0xd3, 0xec, 0x3d, 0x41, 0x55, 0xa1, 0x3b, 0xc7, 0x66, 0x7d, 0x99, 0x2d, 0x7a, 0x13, 0x9c, 0xb1, 0x9f, 0x84, 0xf8, 0x0, 0x16, 0x3a, 0x8a, 0xcb, 0x15, 0x61, 0x0, 0xb2, 0x82, 0xa0, 0x28, 0x16, 0x5e, 0xdf, 0xe2, 0x3a, 0x55, 0x13, 0xd7, 0x9b, 0x81, 0xa0, 0x17, 0x12, 0x0, 0x1, 0xe1, 0x25, 0xe9, 0x12, 0x0, 0x5, 0xa1, 0x53, 0xe8, 0x4b, 0xcb, 0x17, 0x46, 0x3, 0x0, 0xd, 0xc0, 0x4d, 0x22, 0x67, 0x72, 0x65, 0x49, 0xc7, 0xb1, 0x7d, 0x5a, 0x5d, 0x29, 0x22, 0x2, 0xb4, 0x24, 0x75, 0x19, 0xb7, 0x22, 0xb, 0xc, 0x21, 0x32, 0xff, 0x21, 0x38, 0x66, 0x28, 0xa4, 0x1, 0x78, 0x1a, 0x0, 0x16, 0x16, 0x7f, 0x25, 0xde, 0xb2, 0x75, 0xf8, 0x84, 0xf7, 0xd4, 0xe5, 0x75, 0x9b, 0x49, 0x75, 0xd9, 0xb6, 0x40, 0x49, 0x17, 0x22, 0x58, 0x23, 0x67, 0xd0, 0x0, 0xc, 0xbf, 0x83, 0xe5, 0xf7, 0x6e, 0x14, 0xaa, 0x5d, 0x41, 0xb7, 0xa3, 0x84, 0x22, 0x0, 0x19, 0xd1, 0x55, 0x22, 0x60, 0xb9, 0xde, 0xfc, 0x52, 0x43, 0x7c, 0x47, 0xca, 0x23, 0xa1, 0x50, 0xf0, 0x16, 0x10, 0x3b, 0x40, 0xac, 0xfb, 0xbc, 0x64, 0x56, 0x11, 0x0, 0x6, 0xbc, 0x74, 0xf6, 0x4a, 0x3, 0xae, 0x9, 0x0, 0x16, 0x9a, 0x3c, 0x8b, 0x22, 0x3b, 0x7d, 0xfa, 0xbb, 0x30, 0x70, 0x47, 0xe0, 0xad, 0x94, 0xd8, 0xee, 0x23, 0x52, 0xbb, 0xa8, 0x8e, 0xbe, 0x12, 0x0, 0x10, 0x7d, 0x92, 0xb0, 0xa, 0x63, 0x45, 0xd4, 0xb9, 0x3a, 0x84, 0x2d, 0x10, 0x39, 0x17, 0x5b, 0x72, 0x2e, 0x0, 0xf, 0x6d, 0x13, 0xa9, 0x1d, 0x58, 0xa4, 0x35, 0x9e, 0x1e, 0x99, 0xeb, 0x57, 0x38, 0x18, 0x70, 0x1c, 0x0, 0x2, 0x97, 0xd1, 0xc, 0x0, 0x17, 0x24, 0x55, 0xd6, 0xe0, 0x8f, 0xc7, 0x4d, 0xa6, 0x76, 0x8f, 0x36, 0xf1, 0x2, 0x12, 0x55, 0xf5, 0x90, 0x99, 0x87, 0x6e, 0xa1, 0x92, 0x1, 0x6, 0x0, 0x10, 0xf7, 0x6, 0xe4, 0x27, 0xd1, 0xf5, 0x1e, 0x5c, 0x94, 0x6, 0xfe, 0xbb, 0xff, 0x67, 0x6c, 0xd7, 0x29, 0x0, 0xc, 0xe5, 0x72, 0x70, 0x3a, 0x91, 0xa7, 0x6, 0xbf, 0xbc, 0xc3, 0x1f, 0x5c, 0x1d};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0xbf, 0x83, 0xe5, 0xf7, 0x6e, 0x14, 0xaa, 0x5d, 0x41, 0xb7, 0xa3, 0x84};
  lwmqtt_string_t topic_filter_s0 = {12, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd1, 0x55, 0x22, 0x60, 0xb9, 0xde, 0xfc, 0x52, 0x43, 0x7c, 0x47, 0xca, 0x23, 0xa1, 0x50, 0xf0, 0x16, 0x10, 0x3b, 0x40, 0xac, 0xfb, 0xbc, 0x64, 0x56};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbc, 0x74, 0xf6, 0x4a, 0x3, 0xae};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x9a, 0x3c, 0x8b, 0x22, 0x3b, 0x7d, 0xfa, 0xbb, 0x30, 0x70, 0x47, 0xe0, 0xad, 0x94, 0xd8, 0xee, 0x23, 0x52, 0xbb, 0xa8, 0x8e, 0xbe};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x7d, 0x92, 0xb0, 0xa, 0x63, 0x45, 0xd4, 0xb9, 0x3a, 0x84, 0x2d, 0x10, 0x39, 0x17, 0x5b, 0x72};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6d, 0x13, 0xa9, 0x1d, 0x58, 0xa4, 0x35, 0x9e, 0x1e, 0x99, 0xeb, 0x57, 0x38, 0x18, 0x70};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x97, 0xd1};
  lwmqtt_string_t topic_filter_s6 = {2, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x24, 0x55, 0xd6, 0xe0, 0x8f, 0xc7, 0x4d, 0xa6, 0x76, 0x8f, 0x36, 0xf1, 0x2, 0x12, 0x55, 0xf5, 0x90, 0x99, 0x87, 0x6e, 0xa1, 0x92, 0x1};
  lwmqtt_string_t topic_filter_s7 = {23, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xf7, 0x6, 0xe4, 0x27, 0xd1, 0xf5, 0x1e, 0x5c, 0x94, 0x6, 0xfe, 0xbb, 0xff, 0x67, 0x6c, 0xd7};
  lwmqtt_string_t topic_filter_s8 = {16, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xe5, 0x72, 0x70, 0x3a, 0x91, 0xa7, 0x6, 0xbf, 0xbc, 0xc3, 0x1f, 0x5c};
  lwmqtt_string_t topic_filter_s9 = {12, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
lwmqtt_sub_options_t sub_opts[10];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[5].retain_as_published = true;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = true;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = true;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[8].retain_as_published = true;
sub_opts[8].no_local = false;
sub_opts[9].qos = LWMQTT_QOS1;
sub_opts[9].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[9].retain_as_published = true;
sub_opts[9].no_local = true;
  uint8_t bytesprops0[] = {0x31, 0x5, 0xd, 0xee, 0xb5, 0x20, 0x6, 0x7, 0x67, 0xc8, 0xc4, 0x6a, 0x9d, 0x7b, 0x63, 0xad};
  uint8_t bytesprops1[] = {0x18, 0xe7};
  uint8_t bytesprops2[] = {0x2e, 0xa1, 0x35, 0x67, 0x0, 0xb7, 0x93, 0xc5, 0x23, 0x6b, 0x9d, 0x1d, 0x7a, 0x31, 0x29};
  uint8_t bytesprops4[] = {0x3a, 0x8a, 0xcb, 0x15, 0x61, 0x0, 0xb2, 0x82, 0xa0, 0x28, 0x16, 0x5e, 0xdf, 0xe2, 0x3a, 0x55, 0x13, 0xd7, 0x9b, 0x81, 0xa0, 0x17};
  uint8_t bytesprops3[] = {0x5c, 0xbc, 0x74, 0x5c, 0x2b, 0x56, 0x67, 0xb1, 0x8b, 0xce, 0x20, 0xd3, 0xec, 0x3d, 0x41, 0x55, 0xa1, 0x3b, 0xc7, 0x66, 0x7d, 0x99, 0x2d, 0x7a, 0x13, 0x9c, 0xb1, 0x9f, 0x84, 0xf8};
  uint8_t bytesprops5[] = {0xe1};
  uint8_t bytesprops6[] = {0xa1, 0x53, 0xe8, 0x4b, 0xcb};
  uint8_t bytesprops7[] = {0xc0, 0x4d, 0x22, 0x67, 0x72, 0x65, 0x49, 0xc7, 0xb1, 0x7d, 0x5a, 0x5d, 0x29};
  uint8_t bytesprops8[] = {0x16, 0x7f, 0x25, 0xde, 0xb2, 0x75, 0xf8, 0x84, 0xf7, 0xd4, 0xe5, 0x75, 0x9b, 0x49, 0x75, 0xd9, 0xb6, 0x40, 0x49, 0x17, 0x22, 0x58};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 882}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {16, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 16738}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {2, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 208}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 104}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={30, (char*)&bytesprops3}, .v={22, (char*)&bytesprops4}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {1, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 233}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {5, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 70}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {13, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 692}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 183}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 2828}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13055}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 14438}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 164}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 120}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 26576}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 7750, 10, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 6922 [("\176\131\178\223z\196\&7\244P\255\198\182\182Y\250e&\173\215\129\SOH\185\nQ7\NULK\SOH*",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("Xv\191Qn\146\ACK\CAN\159\&1\251U\202\233B\r\158\234\237",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\142\196\245\228Y{#1\n\227\151\215>O\213\131",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("l\232\254\201\210\146\&9\138\199\199?\n`~(#\223\NUL\152\142\194\&0\227\213>",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\183Gl\161\243g%\128",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1})] [PropResponseInformation "\175iA^\225\203\ACK\FSE\175e\DLE\NAK\189\253\249\194J\181^\134\158\ETBQ\ESC\EOT",PropTopicAlias 2462,PropAssignedClientIdentifier "\251\171*\164\251Q\158\154q\214\194\144\239v\217\200\220\CAN\201\SI\a\192\255\FS",PropReceiveMaximum 11788,PropWillDelayInterval 4283,PropAuthenticationData "=B\238\177b\179\162\DC3\246\254\228s",PropSubscriptionIdentifierAvailable 66,PropTopicAlias 11878,PropMessageExpiryInterval 17512,PropServerKeepAlive 19493,PropAuthenticationMethod "\149\217\196\177z\245\161\240[\169\FSZ1z\SUBH\EOT\166\250\193\197\218",PropTopicAliasMaximum 16410,PropMessageExpiryInterval 8324,PropCorrelationData "\206\247\&5\148\231\220z\179\&6\169l7\235\237\161\241\t\208\152 \158\&9\179\240\136\188h"]
TEST(Subscribe5QCTest, Encode15) {
uint8_t pkt[] = {0x82, 0x92, 0x2, 0x1b, 0xa, 0x9e, 0x1, 0x1a, 0x0, 0x1a, 0xaf, 0x69, 0x41, 0x5e, 0xe1, 0xcb, 0x6, 0x1c, 0x45, 0xaf, 0x65, 0x10, 0x15, 0xbd, 0xfd, 0xf9, 0xc2, 0x4a, 0xb5, 0x5e, 0x86, 0x9e, 0x17, 0x51, 0x1b, 0x4, 0x23, 0x9, 0x9e, 0x12, 0x0, 0x18, 0xfb, 0xab, 0x2a, 0xa4, 0xfb, 0x51, 0x9e, 0x9a, 0x71, 0xd6, 0xc2, 0x90, 0xef, 0x76, 0xd9, 0xc8, 0xdc, 0x18, 0xc9, 0xf, 0x7, 0xc0, 0xff, 0x1c, 0x21, 0x2e, 0xc, 0x18, 0x0, 0x0, 0x10, 0xbb, 0x16, 0x0, 0xc, 0x3d, 0x42, 0xee, 0xb1, 0x62, 0xb3, 0xa2, 0x13, 0xf6, 0xfe, 0xe4, 0x73, 0x29, 0x42, 0x23, 0x2e, 0x66, 0x2, 0x0, 0x0, 0x44, 0x68, 0x13, 0x4c, 0x25, 0x15, 0x0, 0x16, 0x95, 0xd9, 0xc4, 0xb1, 0x7a, 0xf5, 0xa1, 0xf0, 0x5b, 0xa9, 0x1c, 0x5a, 0x31, 0x7a, 0x1a, 0x48, 0x4, 0xa6, 0xfa, 0xc1, 0xc5, 0xda, 0x22, 0x40, 0x1a, 0x2, 0x0, 0x0, 0x20, 0x84, 0x9, 0x0, 0x1b, 0xce, 0xf7, 0x35, 0x94, 0xe7, 0xdc, 0x7a, 0xb3, 0x36, 0xa9, 0x6c, 0x37, 0xeb, 0xed, 0xa1, 0xf1, 0x9, 0xd0, 0x98, 0x20, 0x9e, 0x39, 0xb3, 0xf0, 0x88, 0xbc, 0x68, 0x0, 0x1d, 0xb0, 0x83, 0xb2, 0xdf, 0x7a, 0xc4, 0x37, 0xf4, 0x50, 0xff, 0xc6, 0xb6, 0xb6, 0x59, 0xfa, 0x65, 0x26, 0xad, 0xd7, 0x81, 0x1, 0xb9, 0xa, 0x51, 0x37, 0x0, 0x4b, 0x1, 0x2a, 0x15, 0x0, 0x13, 0x58, 0x76, 0xbf, 0x51, 0x6e, 0x92, 0x6, 0x18, 0x9f, 0x31, 0xfb, 0x55, 0xca, 0xe9, 0x42, 0xd, 0x9e, 0xea, 0xed, 0x5, 0x0, 0x10, 0x8e, 0xc4, 0xf5, 0xe4, 0x59, 0x7b, 0x23, 0x31, 0xa, 0xe3, 0x97, 0xd7, 0x3e, 0x4f, 0xd5, 0x83, 0xd, 0x0, 0x19, 0x6c, 0xe8, 0xfe, 0xc9, 0xd2, 0x92, 0x39, 0x8a, 0xc7, 0xc7, 0x3f, 0xa, 0x60, 0x7e, 0x28, 0x23, 0xdf, 0x0, 0x98, 0x8e, 0xc2, 0x30, 0xe3, 0xd5, 0x3e, 0x26, 0x0, 0x8, 0xb7, 0x47, 0x6c, 0xa1, 0xf3, 0x67, 0x25, 0x80, 0xd};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xb0, 0x83, 0xb2, 0xdf, 0x7a, 0xc4, 0x37, 0xf4, 0x50, 0xff, 0xc6, 0xb6, 0xb6, 0x59, 0xfa, 0x65, 0x26, 0xad, 0xd7, 0x81, 0x1, 0xb9, 0xa, 0x51, 0x37, 0x0, 0x4b, 0x1, 0x2a};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x58, 0x76, 0xbf, 0x51, 0x6e, 0x92, 0x6, 0x18, 0x9f, 0x31, 0xfb, 0x55, 0xca, 0xe9, 0x42, 0xd, 0x9e, 0xea, 0xed};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8e, 0xc4, 0xf5, 0xe4, 0x59, 0x7b, 0x23, 0x31, 0xa, 0xe3, 0x97, 0xd7, 0x3e, 0x4f, 0xd5, 0x83};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6c, 0xe8, 0xfe, 0xc9, 0xd2, 0x92, 0x39, 0x8a, 0xc7, 0xc7, 0x3f, 0xa, 0x60, 0x7e, 0x28, 0x23, 0xdf, 0x0, 0x98, 0x8e, 0xc2, 0x30, 0xe3, 0xd5, 0x3e};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xb7, 0x47, 0x6c, 0xa1, 0xf3, 0x67, 0x25, 0x80};
  lwmqtt_string_t topic_filter_s4 = {8, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
  uint8_t bytesprops0[] = {0xaf, 0x69, 0x41, 0x5e, 0xe1, 0xcb, 0x6, 0x1c, 0x45, 0xaf, 0x65, 0x10, 0x15, 0xbd, 0xfd, 0xf9, 0xc2, 0x4a, 0xb5, 0x5e, 0x86, 0x9e, 0x17, 0x51, 0x1b, 0x4};
  uint8_t bytesprops1[] = {0xfb, 0xab, 0x2a, 0xa4, 0xfb, 0x51, 0x9e, 0x9a, 0x71, 0xd6, 0xc2, 0x90, 0xef, 0x76, 0xd9, 0xc8, 0xdc, 0x18, 0xc9, 0xf, 0x7, 0xc0, 0xff, 0x1c};
  uint8_t bytesprops2[] = {0x3d, 0x42, 0xee, 0xb1, 0x62, 0xb3, 0xa2, 0x13, 0xf6, 0xfe, 0xe4, 0x73};
  uint8_t bytesprops3[] = {0x95, 0xd9, 0xc4, 0xb1, 0x7a, 0xf5, 0xa1, 0xf0, 0x5b, 0xa9, 0x1c, 0x5a, 0x31, 0x7a, 0x1a, 0x48, 0x4, 0xa6, 0xfa, 0xc1, 0xc5, 0xda};
  uint8_t bytesprops4[] = {0xce, 0xf7, 0x35, 0x94, 0xe7, 0xdc, 0x7a, 0xb3, 0x36, 0xa9, 0x6c, 0x37, 0xeb, 0xed, 0xa1, 0xf1, 0x9, 0xd0, 0x98, 0x20, 0x9e, 0x39, 0xb3, 0xf0, 0x88, 0xbc, 0x68};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 2462}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 11788}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4283}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 66}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11878}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 17512}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19493}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {22, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 16410}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8324}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {27, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 6922, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26316 [("\229\199\211Bm\186\243W\161\139O{A ^F\180,!5y\243\EOT\166\226opy\131\ESC",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("Z\153\&6\215(\215\EM\137\140\252",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("U\\N\255a\146",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\174\\\247w\175\SYN\148o\191E\n[\197\SO\197a\175\227\236",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\DC2\180\170\148L1[`@[\253\159,\136`\ESC\229\DEL5\210\193\ESC@\131\152\212",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\141\&8\227\131\152p\224\162\146\228\175V \142\191QR\139g\188\165vf",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("N\240`q\204\255|\b\156A\227\238",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0})] [PropMaximumPacketSize 17342,PropPayloadFormatIndicator 202,PropRequestProblemInformation 206,PropTopicAlias 20086,PropWildcardSubscriptionAvailable 171,PropMaximumQoS 190,PropMaximumQoS 87,PropMessageExpiryInterval 29692,PropUserProperty "m\165\210)cD" "\158c\252?'\245\170R*\146\200\208\FS\202p\ENQ",PropServerReference "\201\220\231\219\214\200\231T1\229c\171\238\143\133n\228gd(@\213\SUB",PropMessageExpiryInterval 6551,PropAssignedClientIdentifier "ki\218\160DW=\241\172\244\207\198\STX\130Zm'",PropAssignedClientIdentifier "\212\173\r\148\SOH`\169\241\138\214%\176\239\190\158\&1\160\128\&6Z\SO#\145T\145A]\224\v",PropSessionExpiryInterval 20280,PropPayloadFormatIndicator 72,PropMessageExpiryInterval 21059,PropContentType "\155\221\158",PropTopicAlias 14,PropContentType "W\149`w,f\206\ETXx\184~\142\201\214O\FS",PropSubscriptionIdentifier 0,PropTopicAliasMaximum 15849,PropRetainAvailable 48,PropMessageExpiryInterval 25313]
TEST(Subscribe5QCTest, Encode16) {
uint8_t pkt[] = {0x82, 0xd3, 0x2, 0x66, 0xcc, 0xb9, 0x1, 0x27, 0x0, 0x0, 0x43, 0xbe, 0x1, 0xca, 0x17, 0xce, 0x23, 0x4e, 0x76, 0x28, 0xab, 0x24, 0xbe, 0x24, 0x57, 0x2, 0x0, 0x0, 0x73, 0xfc, 0x26, 0x0, 0x6, 0x6d, 0xa5, 0xd2, 0x29, 0x63, 0x44, 0x0, 0x10, 0x9e, 0x63, 0xfc, 0x3f, 0x27, 0xf5, 0xaa, 0x52, 0x2a, 0x92, 0xc8, 0xd0, 0x1c, 0xca, 0x70, 0x5, 0x1c, 0x0, 0x17, 0xc9, 0xdc, 0xe7, 0xdb, 0xd6, 0xc8, 0xe7, 0x54, 0x31, 0xe5, 0x63, 0xab, 0xee, 0x8f, 0x85, 0x6e, 0xe4, 0x67, 0x64, 0x28, 0x40, 0xd5, 0x1a, 0x2, 0x0, 0x0, 0x19, 0x97, 0x12, 0x0, 0x11, 0x6b, 0x69, 0xda, 0xa0, 0x44, 0x57, 0x3d, 0xf1, 0xac, 0xf4, 0xcf, 0xc6, 0x2, 0x82, 0x5a, 0x6d, 0x27, 0x12, 0x0, 0x1d, 0xd4, 0xad, 0xd, 0x94, 0x1, 0x60, 0xa9, 0xf1, 0x8a, 0xd6, 0x25, 0xb0, 0xef, 0xbe, 0x9e, 0x31, 0xa0, 0x80, 0x36, 0x5a, 0xe, 0x23, 0x91, 0x54, 0x91, 0x41, 0x5d, 0xe0, 0xb, 0x11, 0x0, 0x0, 0x4f, 0x38, 0x1, 0x48, 0x2, 0x0, 0x0, 0x52, 0x43, 0x3, 0x0, 0x3, 0x9b, 0xdd, 0x9e, 0x23, 0x0, 0xe, 0x3, 0x0, 0x10, 0x57, 0x95, 0x60, 0x77, 0x2c, 0x66, 0xce, 0x3, 0x78, 0xb8, 0x7e, 0x8e, 0xc9, 0xd6, 0x4f, 0x1c, 0xb, 0x0, 0x22, 0x3d, 0xe9, 0x25, 0x30, 0x2, 0x0, 0x0, 0x62, 0xe1, 0x0, 0x1e, 0xe5, 0xc7, 0xd3, 0x42, 0x6d, 0xba, 0xf3, 0x57, 0xa1, 0x8b, 0x4f, 0x7b, 0x41, 0x20, 0x5e, 0x46, 0xb4, 0x2c, 0x21, 0x35, 0x79, 0xf3, 0x4, 0xa6, 0xe2, 0x6f, 0x70, 0x79, 0x83, 0x1b, 0x2, 0x0, 0xa, 0x5a, 0x99, 0x36, 0xd7, 0x28, 0xd7, 0x19, 0x89, 0x8c, 0xfc, 0xe, 0x0, 0x6, 0x55, 0x5c, 0x4e, 0xff, 0x61, 0x92, 0x4, 0x0, 0x13, 0xae, 0x5c, 0xf7, 0x77, 0xaf, 0x16, 0x94, 0x6f, 0xbf, 0x45, 0xa, 0x5b, 0xc5, 0xe, 0xc5, 0x61, 0xaf, 0xe3, 0xec, 0x2d, 0x0, 0x1a, 0x12, 0xb4, 0xaa, 0x94, 0x4c, 0x31, 0x5b, 0x60, 0x40, 0x5b, 0xfd, 0x9f, 0x2c, 0x88, 0x60, 0x1b, 0xe5, 0x7f, 0x35, 0xd2, 0xc1, 0x1b, 0x40, 0x83, 0x98, 0xd4, 0x22, 0x0, 0x0, 0x0, 0x0, 0x17, 0x8d, 0x38, 0xe3, 0x83, 0x98, 0x70, 0xe0, 0xa2, 0x92, 0xe4, 0xaf, 0x56, 0x20, 0x8e, 0xbf, 0x51, 0x52, 0x8b, 0x67, 0xbc, 0xa5, 0x76, 0x66, 0x1e, 0x0, 0xc, 0x4e, 0xf0, 0x60, 0x71, 0xcc, 0xff, 0x7c, 0x8, 0x9c, 0x41, 0xe3, 0xee, 0x28};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xe5, 0xc7, 0xd3, 0x42, 0x6d, 0xba, 0xf3, 0x57, 0xa1, 0x8b, 0x4f, 0x7b, 0x41, 0x20, 0x5e, 0x46, 0xb4, 0x2c, 0x21, 0x35, 0x79, 0xf3, 0x4, 0xa6, 0xe2, 0x6f, 0x70, 0x79, 0x83, 0x1b};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x5a, 0x99, 0x36, 0xd7, 0x28, 0xd7, 0x19, 0x89, 0x8c, 0xfc};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x55, 0x5c, 0x4e, 0xff, 0x61, 0x92};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xae, 0x5c, 0xf7, 0x77, 0xaf, 0x16, 0x94, 0x6f, 0xbf, 0x45, 0xa, 0x5b, 0xc5, 0xe, 0xc5, 0x61, 0xaf, 0xe3, 0xec};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x12, 0xb4, 0xaa, 0x94, 0x4c, 0x31, 0x5b, 0x60, 0x40, 0x5b, 0xfd, 0x9f, 0x2c, 0x88, 0x60, 0x1b, 0xe5, 0x7f, 0x35, 0xd2, 0xc1, 0x1b, 0x40, 0x83, 0x98, 0xd4};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8d, 0x38, 0xe3, 0x83, 0x98, 0x70, 0xe0, 0xa2, 0x92, 0xe4, 0xaf, 0x56, 0x20, 0x8e, 0xbf, 0x51, 0x52, 0x8b, 0x67, 0xbc, 0xa5, 0x76, 0x66};
  lwmqtt_string_t topic_filter_s6 = {23, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x4e, 0xf0, 0x60, 0x71, 0xcc, 0xff, 0x7c, 0x8, 0x9c, 0x41, 0xe3, 0xee};
  lwmqtt_string_t topic_filter_s7 = {12, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
lwmqtt_sub_options_t sub_opts[8];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = true;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = false;
  uint8_t bytesprops1[] = {0x9e, 0x63, 0xfc, 0x3f, 0x27, 0xf5, 0xaa, 0x52, 0x2a, 0x92, 0xc8, 0xd0, 0x1c, 0xca, 0x70, 0x5};
  uint8_t bytesprops0[] = {0x6d, 0xa5, 0xd2, 0x29, 0x63, 0x44};
  uint8_t bytesprops2[] = {0xc9, 0xdc, 0xe7, 0xdb, 0xd6, 0xc8, 0xe7, 0x54, 0x31, 0xe5, 0x63, 0xab, 0xee, 0x8f, 0x85, 0x6e, 0xe4, 0x67, 0x64, 0x28, 0x40, 0xd5, 0x1a};
  uint8_t bytesprops3[] = {0x6b, 0x69, 0xda, 0xa0, 0x44, 0x57, 0x3d, 0xf1, 0xac, 0xf4, 0xcf, 0xc6, 0x2, 0x82, 0x5a, 0x6d, 0x27};
  uint8_t bytesprops4[] = {0xd4, 0xad, 0xd, 0x94, 0x1, 0x60, 0xa9, 0xf1, 0x8a, 0xd6, 0x25, 0xb0, 0xef, 0xbe, 0x9e, 0x31, 0xa0, 0x80, 0x36, 0x5a, 0xe, 0x23, 0x91, 0x54, 0x91, 0x41, 0x5d, 0xe0, 0xb};
  uint8_t bytesprops5[] = {0x9b, 0xdd, 0x9e};
  uint8_t bytesprops6[] = {0x57, 0x95, 0x60, 0x77, 0x2c, 0x66, 0xce, 0x3, 0x78, 0xb8, 0x7e, 0x8e, 0xc9, 0xd6, 0x4f, 0x1c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 17342}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 202}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 206}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 20086}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 190}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 87}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29692}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={6, (char*)&bytesprops0}, .v={16, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6551}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 20280}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 72}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21059}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {3, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {16, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 0}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 15849}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 48}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25313}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 26316, 8, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 3621 [("7\186\177\153l\246\228+]4\237O$\165\135q\230\DC3b\180\SI\194\248\ACK\t",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("+\SO\164",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\152\172d3k\243}\216\210y\232\152",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\208'\165Pi\\8\EOT*/\191\202\180A\237\164",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("Z\152\229",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\227a\230",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\178\254\234\\\139\236\222\v\188\159\236\DLE\215\254\SO.\128\250\160\128",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2})] [PropRequestResponseInformation 86,PropTopicAliasMaximum 24273,PropTopicAliasMaximum 7199]
TEST(Subscribe5QCTest, Encode17) {
uint8_t pkt[] = {0x82, 0x72, 0xe, 0x25, 0x8, 0x19, 0x56, 0x22, 0x5e, 0xd1, 0x22, 0x1c, 0x1f, 0x0, 0x19, 0x37, 0xba, 0xb1, 0x99, 0x6c, 0xf6, 0xe4, 0x2b, 0x5d, 0x34, 0xed, 0x4f, 0x24, 0xa5, 0x87, 0x71, 0xe6, 0x13, 0x62, 0xb4, 0xf, 0xc2, 0xf8, 0x6, 0x9, 0x2a, 0x0, 0x3, 0x2b, 0xe, 0xa4, 0x1e, 0x0, 0xc, 0x98, 0xac, 0x64, 0x33, 0x6b, 0xf3, 0x7d, 0xd8, 0xd2, 0x79, 0xe8, 0x98, 0x25, 0x0, 0x10, 0xd0, 0x27, 0xa5, 0x50, 0x69, 0x5c, 0x38, 0x4, 0x2a, 0x2f, 0xbf, 0xca, 0xb4, 0x41, 0xed, 0xa4, 0xa, 0x0, 0x3, 0x5a, 0x98, 0xe5, 0x29, 0x0, 0x3, 0xe3, 0x61, 0xe6, 0x6, 0x0, 0x14, 0xb2, 0xfe, 0xea, 0x5c, 0x8b, 0xec, 0xde, 0xb, 0xbc, 0x9f, 0xec, 0x10, 0xd7, 0xfe, 0xe, 0x2e, 0x80, 0xfa, 0xa0, 0x80, 0x1e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x37, 0xba, 0xb1, 0x99, 0x6c, 0xf6, 0xe4, 0x2b, 0x5d, 0x34, 0xed, 0x4f, 0x24, 0xa5, 0x87, 0x71, 0xe6, 0x13, 0x62, 0xb4, 0xf, 0xc2, 0xf8, 0x6, 0x9};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2b, 0xe, 0xa4};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x98, 0xac, 0x64, 0x33, 0x6b, 0xf3, 0x7d, 0xd8, 0xd2, 0x79, 0xe8, 0x98};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd0, 0x27, 0xa5, 0x50, 0x69, 0x5c, 0x38, 0x4, 0x2a, 0x2f, 0xbf, 0xca, 0xb4, 0x41, 0xed, 0xa4};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5a, 0x98, 0xe5};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe3, 0x61, 0xe6};
  lwmqtt_string_t topic_filter_s5 = {3, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb2, 0xfe, 0xea, 0x5c, 0x8b, 0xec, 0xde, 0xb, 0xbc, 0x9f, 0xec, 0x10, 0xd7, 0xfe, 0xe, 0x2e, 0x80, 0xfa, 0xa0, 0x80};
  lwmqtt_string_t topic_filter_s6 = {20, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
lwmqtt_sub_options_t sub_opts[7];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = true;
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 86}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24273}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 7199}},
  };

  lwmqtt_properties_t props = {3, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 3621, 7, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17519 [("\237*\219:\226s\140\&8K \188\244l\243f\DC2|\184\193/\SYN\148\187\SOH\137\228:\ACK",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\223\254xc\242\211\169\140",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("4\144\223\145\225\223\164[Kn\246\237}J,z\141\238",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2})] [PropMaximumQoS 197,PropMaximumPacketSize 3676,PropCorrelationData "\146\181\224\ACK\186\202\DC4v$\195\148bT\SUB\181\239t\205\182\161\&0\154\RSw'\ACKn",PropRequestProblemInformation 117,PropSharedSubscriptionAvailable 47,PropWillDelayInterval 12249,PropSubscriptionIdentifier 2,PropRequestResponseInformation 90,PropMessageExpiryInterval 4001,PropRetainAvailable 182,PropCorrelationData "\223\NUL\227\&8\140\DEL",PropRequestResponseInformation 223,PropReasonString "w\146\NAK\STX\245\161\148\159\193\152\201A,:\181\230\DC3\158L\164",PropMaximumPacketSize 4942,PropMessageExpiryInterval 29241,PropCorrelationData "\216*\128",PropContentType "\ETB\140e6\165\192U.\250\161\133f\214\173\198\135\128\204u\\\f\186S\148\129-5\STX\188:",PropAssignedClientIdentifier "hq+\134'\245\132bx\199\255\143\142\223{\241 \169\227\199\FS\178\NAK\150\208",PropSubscriptionIdentifier 25,PropTopicAlias 3143,PropMessageExpiryInterval 30304,PropWillDelayInterval 25711,PropWillDelayInterval 5752,PropSharedSubscriptionAvailable 68,PropPayloadFormatIndicator 153,PropResponseTopic "J\234<\228\191\206\247CD\213G\167",PropSubscriptionIdentifierAvailable 118,PropResponseTopic "w\222=\175_\DLE"]
TEST(Subscribe5QCTest, Encode18) {
uint8_t pkt[] = {0x82, 0x9d, 0x2, 0x44, 0x6f, 0xda, 0x1, 0x24, 0xc5, 0x27, 0x0, 0x0, 0xe, 0x5c, 0x9, 0x0, 0x1b, 0x92, 0xb5, 0xe0, 0x6, 0xba, 0xca, 0x14, 0x76, 0x24, 0xc3, 0x94, 0x62, 0x54, 0x1a, 0xb5, 0xef, 0x74, 0xcd, 0xb6, 0xa1, 0x30, 0x9a, 0x1e, 0x77, 0x27, 0x6, 0x6e, 0x17, 0x75, 0x2a, 0x2f, 0x18, 0x0, 0x0, 0x2f, 0xd9, 0xb, 0x2, 0x19, 0x5a, 0x2, 0x0, 0x0, 0xf, 0xa1, 0x25, 0xb6, 0x9, 0x0, 0x6, 0xdf, 0x0, 0xe3, 0x38, 0x8c, 0x7f, 0x19, 0xdf, 0x1f, 0x0, 0x14, 0x77, 0x92, 0x15, 0x2, 0xf5, 0xa1, 0x94, 0x9f, 0xc1, 0x98, 0xc9, 0x41, 0x2c, 0x3a, 0xb5, 0xe6, 0x13, 0x9e, 0x4c, 0xa4, 0x27, 0x0, 0x0, 0x13, 0x4e, 0x2, 0x0, 0x0, 0x72, 0x39, 0x9, 0x0, 0x3, 0xd8, 0x2a, 0x80, 0x3, 0x0, 0x1e, 0x17, 0x8c, 0x65, 0x36, 0xa5, 0xc0, 0x55, 0x2e, 0xfa, 0xa1, 0x85, 0x66, 0xd6, 0xad, 0xc6, 0x87, 0x80, 0xcc, 0x75, 0x5c, 0xc, 0xba, 0x53, 0x94, 0x81, 0x2d, 0x35, 0x2, 0xbc, 0x3a, 0x12, 0x0, 0x19, 0x68, 0x71, 0x2b, 0x86, 0x27, 0xf5, 0x84, 0x62, 0x78, 0xc7, 0xff, 0x8f, 0x8e, 0xdf, 0x7b, 0xf1, 0x20, 0xa9, 0xe3, 0xc7, 0x1c, 0xb2, 0x15, 0x96, 0xd0, 0xb, 0x19, 0x23, 0xc, 0x47, 0x2, 0x0, 0x0, 0x76, 0x60, 0x18, 0x0, 0x0, 0x64, 0x6f, 0x18, 0x0, 0x0, 0x16, 0x78, 0x2a, 0x44, 0x1, 0x99, 0x8, 0x0, 0xc, 0x4a, 0xea, 0x3c, 0xe4, 0xbf, 0xce, 0xf7, 0x43, 0x44, 0xd5, 0x47, 0xa7, 0x29, 0x76, 0x8, 0x0, 0x6, 0x77, 0xde, 0x3d, 0xaf, 0x5f, 0x10, 0x0, 0x1c, 0xed, 0x2a, 0xdb, 0x3a, 0xe2, 0x73, 0x8c, 0x38, 0x4b, 0x20, 0xbc, 0xf4, 0x6c, 0xf3, 0x66, 0x12, 0x7c, 0xb8, 0xc1, 0x2f, 0x16, 0x94, 0xbb, 0x1, 0x89, 0xe4, 0x3a, 0x6, 0x29, 0x0, 0x8, 0xdf, 0xfe, 0x78, 0x63, 0xf2, 0xd3, 0xa9, 0x8c, 0x2a, 0x0, 0x12, 0x34, 0x90, 0xdf, 0x91, 0xe1, 0xdf, 0xa4, 0x5b, 0x4b, 0x6e, 0xf6, 0xed, 0x7d, 0x4a, 0x2c, 0x7a, 0x8d, 0xee, 0x6};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xed, 0x2a, 0xdb, 0x3a, 0xe2, 0x73, 0x8c, 0x38, 0x4b, 0x20, 0xbc, 0xf4, 0x6c, 0xf3, 0x66, 0x12, 0x7c, 0xb8, 0xc1, 0x2f, 0x16, 0x94, 0xbb, 0x1, 0x89, 0xe4, 0x3a, 0x6};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xdf, 0xfe, 0x78, 0x63, 0xf2, 0xd3, 0xa9, 0x8c};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x34, 0x90, 0xdf, 0x91, 0xe1, 0xdf, 0xa4, 0x5b, 0x4b, 0x6e, 0xf6, 0xed, 0x7d, 0x4a, 0x2c, 0x7a, 0x8d, 0xee};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
  uint8_t bytesprops0[] = {0x92, 0xb5, 0xe0, 0x6, 0xba, 0xca, 0x14, 0x76, 0x24, 0xc3, 0x94, 0x62, 0x54, 0x1a, 0xb5, 0xef, 0x74, 0xcd, 0xb6, 0xa1, 0x30, 0x9a, 0x1e, 0x77, 0x27, 0x6, 0x6e};
  uint8_t bytesprops1[] = {0xdf, 0x0, 0xe3, 0x38, 0x8c, 0x7f};
  uint8_t bytesprops2[] = {0x77, 0x92, 0x15, 0x2, 0xf5, 0xa1, 0x94, 0x9f, 0xc1, 0x98, 0xc9, 0x41, 0x2c, 0x3a, 0xb5, 0xe6, 0x13, 0x9e, 0x4c, 0xa4};
  uint8_t bytesprops3[] = {0xd8, 0x2a, 0x80};
  uint8_t bytesprops4[] = {0x17, 0x8c, 0x65, 0x36, 0xa5, 0xc0, 0x55, 0x2e, 0xfa, 0xa1, 0x85, 0x66, 0xd6, 0xad, 0xc6, 0x87, 0x80, 0xcc, 0x75, 0x5c, 0xc, 0xba, 0x53, 0x94, 0x81, 0x2d, 0x35, 0x2, 0xbc, 0x3a};
  uint8_t bytesprops5[] = {0x68, 0x71, 0x2b, 0x86, 0x27, 0xf5, 0x84, 0x62, 0x78, 0xc7, 0xff, 0x8f, 0x8e, 0xdf, 0x7b, 0xf1, 0x20, 0xa9, 0xe3, 0xc7, 0x1c, 0xb2, 0x15, 0x96, 0xd0};
  uint8_t bytesprops6[] = {0x4a, 0xea, 0x3c, 0xe4, 0xbf, 0xce, 0xf7, 0x43, 0x44, 0xd5, 0x47, 0xa7};
  uint8_t bytesprops7[] = {0x77, 0xde, 0x3d, 0xaf, 0x5f, 0x10};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 197}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 3676}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 117}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 47}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 12249}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 2}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 90}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4001}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 182}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 223}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4942}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29241}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {3, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 25}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 3143}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30304}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 25711}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5752}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 68}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 153}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 118}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {28, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 17519, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 3152 [("\221jG\162A\208>\210\170r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\198\138\161\233\v\180\STX\241\207\221\150\234\128)\130\nF\209\ETX\GSVdb",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\148y\243\207\167\176HiA\209\148mB\219\169\138\169c\r\173b\150Q\247\153}\221F",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\243\171\216\165!\EOT,g\235G\164 2\206\211-\b-D\218",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropPayloadFormatIndicator 48,PropTopicAlias 5835,PropMessageExpiryInterval 29048,PropResponseInformation "\188\164\EM\205@\235\tL6\213\238\233A\EM\194\\\229\247 \ESC&\211(\ETB",PropSubscriptionIdentifierAvailable 228,PropContentType "S\171\ETX\b\139\191Y\219\234\&3j]\193\195u2\215\153",PropResponseTopic "\167\225N{\142\r\163\214\133\155\188\EOT\231\151<\DLE\SUB",PropMaximumPacketSize 13133,PropRequestResponseInformation 229,PropRequestProblemInformation 75]
TEST(Subscribe5QCTest, Encode19) {
uint8_t pkt[] = {0x82, 0xbc, 0x1, 0xc, 0x50, 0x59, 0x1, 0x30, 0x23, 0x16, 0xcb, 0x2, 0x0, 0x0, 0x71, 0x78, 0x1a, 0x0, 0x18, 0xbc, 0xa4, 0x19, 0xcd, 0x40, 0xeb, 0x9, 0x4c, 0x36, 0xd5, 0xee, 0xe9, 0x41, 0x19, 0xc2, 0x5c, 0xe5, 0xf7, 0x20, 0x1b, 0x26, 0xd3, 0x28, 0x17, 0x29, 0xe4, 0x3, 0x0, 0x12, 0x53, 0xab, 0x3, 0x8, 0x8b, 0xbf, 0x59, 0xdb, 0xea, 0x33, 0x6a, 0x5d, 0xc1, 0xc3, 0x75, 0x32, 0xd7, 0x99, 0x8, 0x0, 0x11, 0xa7, 0xe1, 0x4e, 0x7b, 0x8e, 0xd, 0xa3, 0xd6, 0x85, 0x9b, 0xbc, 0x4, 0xe7, 0x97, 0x3c, 0x10, 0x1a, 0x27, 0x0, 0x0, 0x33, 0x4d, 0x19, 0xe5, 0x17, 0x4b, 0x0, 0xa, 0xdd, 0x6a, 0x47, 0xa2, 0x41, 0xd0, 0x3e, 0xd2, 0xaa, 0x72, 0x8, 0x0, 0x0, 0x0, 0x0, 0x17, 0xc6, 0x8a, 0xa1, 0xe9, 0xb, 0xb4, 0x2, 0xf1, 0xcf, 0xdd, 0x96, 0xea, 0x80, 0x29, 0x82, 0xa, 0x46, 0xd1, 0x3, 0x1d, 0x56, 0x64, 0x62, 0x0, 0x0, 0x1c, 0x94, 0x79, 0xf3, 0xcf, 0xa7, 0xb0, 0x48, 0x69, 0x41, 0xd1, 0x94, 0x6d, 0x42, 0xdb, 0xa9, 0x8a, 0xa9, 0x63, 0xd, 0xad, 0x62, 0x96, 0x51, 0xf7, 0x99, 0x7d, 0xdd, 0x46, 0x15, 0x0, 0x14, 0xf3, 0xab, 0xd8, 0xa5, 0x21, 0x4, 0x2c, 0x67, 0xeb, 0x47, 0xa4, 0x20, 0x32, 0xce, 0xd3, 0x2d, 0x8, 0x2d, 0x44, 0xda, 0x11};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xdd, 0x6a, 0x47, 0xa2, 0x41, 0xd0, 0x3e, 0xd2, 0xaa, 0x72};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc6, 0x8a, 0xa1, 0xe9, 0xb, 0xb4, 0x2, 0xf1, 0xcf, 0xdd, 0x96, 0xea, 0x80, 0x29, 0x82, 0xa, 0x46, 0xd1, 0x3, 0x1d, 0x56, 0x64, 0x62};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x94, 0x79, 0xf3, 0xcf, 0xa7, 0xb0, 0x48, 0x69, 0x41, 0xd1, 0x94, 0x6d, 0x42, 0xdb, 0xa9, 0x8a, 0xa9, 0x63, 0xd, 0xad, 0x62, 0x96, 0x51, 0xf7, 0x99, 0x7d, 0xdd, 0x46};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf3, 0xab, 0xd8, 0xa5, 0x21, 0x4, 0x2c, 0x67, 0xeb, 0x47, 0xa4, 0x20, 0x32, 0xce, 0xd3, 0x2d, 0x8, 0x2d, 0x44, 0xda};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = false;
  uint8_t bytesprops0[] = {0xbc, 0xa4, 0x19, 0xcd, 0x40, 0xeb, 0x9, 0x4c, 0x36, 0xd5, 0xee, 0xe9, 0x41, 0x19, 0xc2, 0x5c, 0xe5, 0xf7, 0x20, 0x1b, 0x26, 0xd3, 0x28, 0x17};
  uint8_t bytesprops1[] = {0x53, 0xab, 0x3, 0x8, 0x8b, 0xbf, 0x59, 0xdb, 0xea, 0x33, 0x6a, 0x5d, 0xc1, 0xc3, 0x75, 0x32, 0xd7, 0x99};
  uint8_t bytesprops2[] = {0xa7, 0xe1, 0x4e, 0x7b, 0x8e, 0xd, 0xa3, 0xd6, 0x85, 0x9b, 0xbc, 0x4, 0xe7, 0x97, 0x3c, 0x10, 0x1a};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 48}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 5835}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29048}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {24, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 228}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 13133}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 229}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 75}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 3152, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17142 [("e0\211\n(1\a[m\192\250\134\179R\156:\DEL\217\&3\143Z\228\186\224\US\128\164\194\167\223",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\236^:\SYNW\249\182\&7>\191\130\SUB\146'",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),(":\200\140\238\238\173\241A\v\155\186\&9#m$\204\SUBe?Qr\214<3Q9O\214",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),(" \139\195\231G\f\SOHqD*F\221%F\SYN\142\&7\207\252",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("@\217Q\249+\DLE\152\DLE\237\v\180[",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\207\SI\195\138W\141H2\157b?\147N\147# a%\239\181G\236[m\NULx",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\226>An\226G\185\FS",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\131\189l\133\133\tg\128\139\&9<\151y<\197o\204\221\132\&6\151\253\213\196\&3\221i",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropResponseTopic "=\250i{\136y\SUB\224.\228\&8GLxb\151\171>N\NAK\243",PropCorrelationData "=v2\173n\EOT\FS\170s\182",PropTopicAliasMaximum 26880,PropTopicAlias 15262,PropMaximumQoS 40,PropSubscriptionIdentifierAvailable 189,PropServerReference "V\ETX\203\218\214\138\&14n7\172oZ\135\234\210\237\143\SO",PropRequestProblemInformation 46,PropTopicAlias 24607,PropSubscriptionIdentifier 7,PropServerKeepAlive 27192,PropSessionExpiryInterval 623,PropReceiveMaximum 27376,PropReasonString "B!\188\137'\FSL\213",PropSubscriptionIdentifierAvailable 49,PropAuthenticationMethod "\249Jo\182\210\182\168p>\ENQ&S\155\189P\DEL\179\239\&5\160\163iaGi\218<\159\240v",PropMessageExpiryInterval 2499,PropTopicAliasMaximum 12723]
TEST(Subscribe5QCTest, Encode20) {
uint8_t pkt[] = {0x82, 0xcd, 0x2, 0x42, 0xf6, 0x8d, 0x1, 0x8, 0x0, 0x15, 0x3d, 0xfa, 0x69, 0x7b, 0x88, 0x79, 0x1a, 0xe0, 0x2e, 0xe4, 0x38, 0x47, 0x4c, 0x78, 0x62, 0x97, 0xab, 0x3e, 0x4e, 0x15, 0xf3, 0x9, 0x0, 0xa, 0x3d, 0x76, 0x32, 0xad, 0x6e, 0x4, 0x1c, 0xaa, 0x73, 0xb6, 0x22, 0x69, 0x0, 0x23, 0x3b, 0x9e, 0x24, 0x28, 0x29, 0xbd, 0x1c, 0x0, 0x13, 0x56, 0x3, 0xcb, 0xda, 0xd6, 0x8a, 0x31, 0x34, 0x6e, 0x37, 0xac, 0x6f, 0x5a, 0x87, 0xea, 0xd2, 0xed, 0x8f, 0xe, 0x17, 0x2e, 0x23, 0x60, 0x1f, 0xb, 0x7, 0x13, 0x6a, 0x38, 0x11, 0x0, 0x0, 0x2, 0x6f, 0x21, 0x6a, 0xf0, 0x1f, 0x0, 0x8, 0x42, 0x21, 0xbc, 0x89, 0x27, 0x1c, 0x4c, 0xd5, 0x29, 0x31, 0x15, 0x0, 0x1e, 0xf9, 0x4a, 0x6f, 0xb6, 0xd2, 0xb6, 0xa8, 0x70, 0x3e, 0x5, 0x26, 0x53, 0x9b, 0xbd, 0x50, 0x7f, 0xb3, 0xef, 0x35, 0xa0, 0xa3, 0x69, 0x61, 0x47, 0x69, 0xda, 0x3c, 0x9f, 0xf0, 0x76, 0x2, 0x0, 0x0, 0x9, 0xc3, 0x22, 0x31, 0xb3, 0x0, 0x1e, 0x65, 0x30, 0xd3, 0xa, 0x28, 0x31, 0x7, 0x5b, 0x6d, 0xc0, 0xfa, 0x86, 0xb3, 0x52, 0x9c, 0x3a, 0x7f, 0xd9, 0x33, 0x8f, 0x5a, 0xe4, 0xba, 0xe0, 0x1f, 0x80, 0xa4, 0xc2, 0xa7, 0xdf, 0x2e, 0x0, 0xe, 0xec, 0x5e, 0x3a, 0x16, 0x57, 0xf9, 0xb6, 0x37, 0x3e, 0xbf, 0x82, 0x1a, 0x92, 0x27, 0x0, 0x0, 0x1c, 0x3a, 0xc8, 0x8c, 0xee, 0xee, 0xad, 0xf1, 0x41, 0xb, 0x9b, 0xba, 0x39, 0x23, 0x6d, 0x24, 0xcc, 0x1a, 0x65, 0x3f, 0x51, 0x72, 0xd6, 0x3c, 0x33, 0x51, 0x39, 0x4f, 0xd6, 0xa, 0x0, 0x13, 0x20, 0x8b, 0xc3, 0xe7, 0x47, 0xc, 0x1, 0x71, 0x44, 0x2a, 0x46, 0xdd, 0x25, 0x46, 0x16, 0x8e, 0x37, 0xcf, 0xfc, 0x14, 0x0, 0xc, 0x40, 0xd9, 0x51, 0xf9, 0x2b, 0x10, 0x98, 0x10, 0xed, 0xb, 0xb4, 0x5b, 0x2d, 0x0, 0x1a, 0xcf, 0xf, 0xc3, 0x8a, 0x57, 0x8d, 0x48, 0x32, 0x9d, 0x62, 0x3f, 0x93, 0x4e, 0x93, 0x23, 0x20, 0x61, 0x25, 0xef, 0xb5, 0x47, 0xec, 0x5b, 0x6d, 0x0, 0x78, 0x5, 0x0, 0x8, 0xe2, 0x3e, 0x41, 0x6e, 0xe2, 0x47, 0xb9, 0x1c, 0x2c, 0x0, 0x1b, 0x83, 0xbd, 0x6c, 0x85, 0x85, 0x9, 0x67, 0x80, 0x8b, 0x39, 0x3c, 0x97, 0x79, 0x3c, 0xc5, 0x6f, 0xcc, 0xdd, 0x84, 0x36, 0x97, 0xfd, 0xd5, 0xc4, 0x33, 0xdd, 0x69, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x65, 0x30, 0xd3, 0xa, 0x28, 0x31, 0x7, 0x5b, 0x6d, 0xc0, 0xfa, 0x86, 0xb3, 0x52, 0x9c, 0x3a, 0x7f, 0xd9, 0x33, 0x8f, 0x5a, 0xe4, 0xba, 0xe0, 0x1f, 0x80, 0xa4, 0xc2, 0xa7, 0xdf};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xec, 0x5e, 0x3a, 0x16, 0x57, 0xf9, 0xb6, 0x37, 0x3e, 0xbf, 0x82, 0x1a, 0x92, 0x27};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3a, 0xc8, 0x8c, 0xee, 0xee, 0xad, 0xf1, 0x41, 0xb, 0x9b, 0xba, 0x39, 0x23, 0x6d, 0x24, 0xcc, 0x1a, 0x65, 0x3f, 0x51, 0x72, 0xd6, 0x3c, 0x33, 0x51, 0x39, 0x4f, 0xd6};
  lwmqtt_string_t topic_filter_s2 = {28, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x20, 0x8b, 0xc3, 0xe7, 0x47, 0xc, 0x1, 0x71, 0x44, 0x2a, 0x46, 0xdd, 0x25, 0x46, 0x16, 0x8e, 0x37, 0xcf, 0xfc};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x40, 0xd9, 0x51, 0xf9, 0x2b, 0x10, 0x98, 0x10, 0xed, 0xb, 0xb4, 0x5b};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xcf, 0xf, 0xc3, 0x8a, 0x57, 0x8d, 0x48, 0x32, 0x9d, 0x62, 0x3f, 0x93, 0x4e, 0x93, 0x23, 0x20, 0x61, 0x25, 0xef, 0xb5, 0x47, 0xec, 0x5b, 0x6d, 0x0, 0x78};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xe2, 0x3e, 0x41, 0x6e, 0xe2, 0x47, 0xb9, 0x1c};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x83, 0xbd, 0x6c, 0x85, 0x85, 0x9, 0x67, 0x80, 0x8b, 0x39, 0x3c, 0x97, 0x79, 0x3c, 0xc5, 0x6f, 0xcc, 0xdd, 0x84, 0x36, 0x97, 0xfd, 0xd5, 0xc4, 0x33, 0xdd, 0x69};
  lwmqtt_string_t topic_filter_s7 = {27, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
lwmqtt_sub_options_t sub_opts[8];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS1;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = true;
sub_opts[7].qos = LWMQTT_QOS1;
sub_opts[7].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
  uint8_t bytesprops0[] = {0x3d, 0xfa, 0x69, 0x7b, 0x88, 0x79, 0x1a, 0xe0, 0x2e, 0xe4, 0x38, 0x47, 0x4c, 0x78, 0x62, 0x97, 0xab, 0x3e, 0x4e, 0x15, 0xf3};
  uint8_t bytesprops1[] = {0x3d, 0x76, 0x32, 0xad, 0x6e, 0x4, 0x1c, 0xaa, 0x73, 0xb6};
  uint8_t bytesprops2[] = {0x56, 0x3, 0xcb, 0xda, 0xd6, 0x8a, 0x31, 0x34, 0x6e, 0x37, 0xac, 0x6f, 0x5a, 0x87, 0xea, 0xd2, 0xed, 0x8f, 0xe};
  uint8_t bytesprops3[] = {0x42, 0x21, 0xbc, 0x89, 0x27, 0x1c, 0x4c, 0xd5};
  uint8_t bytesprops4[] = {0xf9, 0x4a, 0x6f, 0xb6, 0xd2, 0xb6, 0xa8, 0x70, 0x3e, 0x5, 0x26, 0x53, 0x9b, 0xbd, 0x50, 0x7f, 0xb3, 0xef, 0x35, 0xa0, 0xa3, 0x69, 0x61, 0x47, 0x69, 0xda, 0x3c, 0x9f, 0xf0, 0x76};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {21, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 26880}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15262}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 40}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 189}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 46}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 24607}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 7}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27192}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 623}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 27376}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {8, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 49}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {30, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2499}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 12723}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 17142, 8, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 12736 [("\145r:&\180\185\191_\191\EOT\159&\193$\205",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("\188'\DEL\156\SOV\198\162e\166U0\163\197\181\t\230\&9z\213\135=I",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("fp bI\176\162\r\137\188\NUL\247\ETXy\143s\221q\232\153ff\RS\ESC",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\240\180\DC4+'\SOHP\138y\131!=Z\134\SO2+\169\ETB*",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\201-r-|\180\149qF\242?\234\163\191|m#q\150\CANB\189",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("a)(\167\186\SOH\206\180\ETB\151\150\136hl\212l\187t.\160\189n\165{",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\198\158\243\SYNL\SI\160e\196Y\225\249\234\200\237\136\225\255l\240\tH\250\170\235\223",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),(",`6V\143_\180\169\246\186\185\141\138\NAK\ACKIq\130\173?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\b4\247",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropMaximumPacketSize 32469,PropTopicAlias 714,PropTopicAliasMaximum 31220,PropAuthenticationData "\225\"\r",PropContentType "\DC4\DC4\255$\176\216\174\152K\197f\192\165RN\ACKS\219\n<L\DEL"]
TEST(Subscribe5QCTest, Encode21) {
uint8_t pkt[] = {0x82, 0xf9, 0x1, 0x31, 0xc0, 0x2a, 0x27, 0x0, 0x0, 0x7e, 0xd5, 0x23, 0x2, 0xca, 0x22, 0x79, 0xf4, 0x16, 0x0, 0x3, 0xe1, 0x22, 0xd, 0x3, 0x0, 0x16, 0x14, 0x14, 0xff, 0x24, 0xb0, 0xd8, 0xae, 0x98, 0x4b, 0xc5, 0x66, 0xc0, 0xa5, 0x52, 0x4e, 0x6, 0x53, 0xdb, 0xa, 0x3c, 0x4c, 0x7f, 0x0, 0xf, 0x91, 0x72, 0x3a, 0x26, 0xb4, 0xb9, 0xbf, 0x5f, 0xbf, 0x4, 0x9f, 0x26, 0xc1, 0x24, 0xcd, 0x1a, 0x0, 0x17, 0xbc, 0x27, 0x7f, 0x9c, 0xe, 0x56, 0xc6, 0xa2, 0x65, 0xa6, 0x55, 0x30, 0xa3, 0xc5, 0xb5, 0x9, 0xe6, 0x39, 0x7a, 0xd5, 0x87, 0x3d, 0x49, 0x14, 0x0, 0x18, 0x66, 0x70, 0x20, 0x62, 0x49, 0xb0, 0xa2, 0xd, 0x89, 0xbc, 0x0, 0xf7, 0x3, 0x79, 0x8f, 0x73, 0xdd, 0x71, 0xe8, 0x99, 0x66, 0x66, 0x1e, 0x1b, 0x19, 0x0, 0x14, 0xf0, 0xb4, 0x14, 0x2b, 0x27, 0x1, 0x50, 0x8a, 0x79, 0x83, 0x21, 0x3d, 0x5a, 0x86, 0xe, 0x32, 0x2b, 0xa9, 0x17, 0x2a, 0x15, 0x0, 0x16, 0xc9, 0x2d, 0x72, 0x2d, 0x7c, 0xb4, 0x95, 0x71, 0x46, 0xf2, 0x3f, 0xea, 0xa3, 0xbf, 0x7c, 0x6d, 0x23, 0x71, 0x96, 0x18, 0x42, 0xbd, 0x15, 0x0, 0x18, 0x61, 0x29, 0x28, 0xa7, 0xba, 0x1, 0xce, 0xb4, 0x17, 0x97, 0x96, 0x88, 0x68, 0x6c, 0xd4, 0x6c, 0xbb, 0x74, 0x2e, 0xa0, 0xbd, 0x6e, 0xa5, 0x7b, 0x5, 0x0, 0x1a, 0xc6, 0x9e, 0xf3, 0x16, 0x4c, 0xf, 0xa0, 0x65, 0xc4, 0x59, 0xe1, 0xf9, 0xea, 0xc8, 0xed, 0x88, 0xe1, 0xff, 0x6c, 0xf0, 0x9, 0x48, 0xfa, 0xaa, 0xeb, 0xdf, 0x12, 0x0, 0x14, 0x2c, 0x60, 0x36, 0x56, 0x8f, 0x5f, 0xb4, 0xa9, 0xf6, 0xba, 0xb9, 0x8d, 0x8a, 0x15, 0x6, 0x49, 0x71, 0x82, 0xad, 0x3f, 0xe, 0x0, 0x3, 0x8, 0x34, 0xf7, 0x12};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x91, 0x72, 0x3a, 0x26, 0xb4, 0xb9, 0xbf, 0x5f, 0xbf, 0x4, 0x9f, 0x26, 0xc1, 0x24, 0xcd};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xbc, 0x27, 0x7f, 0x9c, 0xe, 0x56, 0xc6, 0xa2, 0x65, 0xa6, 0x55, 0x30, 0xa3, 0xc5, 0xb5, 0x9, 0xe6, 0x39, 0x7a, 0xd5, 0x87, 0x3d, 0x49};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x66, 0x70, 0x20, 0x62, 0x49, 0xb0, 0xa2, 0xd, 0x89, 0xbc, 0x0, 0xf7, 0x3, 0x79, 0x8f, 0x73, 0xdd, 0x71, 0xe8, 0x99, 0x66, 0x66, 0x1e, 0x1b};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf0, 0xb4, 0x14, 0x2b, 0x27, 0x1, 0x50, 0x8a, 0x79, 0x83, 0x21, 0x3d, 0x5a, 0x86, 0xe, 0x32, 0x2b, 0xa9, 0x17, 0x2a};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc9, 0x2d, 0x72, 0x2d, 0x7c, 0xb4, 0x95, 0x71, 0x46, 0xf2, 0x3f, 0xea, 0xa3, 0xbf, 0x7c, 0x6d, 0x23, 0x71, 0x96, 0x18, 0x42, 0xbd};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x61, 0x29, 0x28, 0xa7, 0xba, 0x1, 0xce, 0xb4, 0x17, 0x97, 0x96, 0x88, 0x68, 0x6c, 0xd4, 0x6c, 0xbb, 0x74, 0x2e, 0xa0, 0xbd, 0x6e, 0xa5, 0x7b};
  lwmqtt_string_t topic_filter_s5 = {24, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc6, 0x9e, 0xf3, 0x16, 0x4c, 0xf, 0xa0, 0x65, 0xc4, 0x59, 0xe1, 0xf9, 0xea, 0xc8, 0xed, 0x88, 0xe1, 0xff, 0x6c, 0xf0, 0x9, 0x48, 0xfa, 0xaa, 0xeb, 0xdf};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x2c, 0x60, 0x36, 0x56, 0x8f, 0x5f, 0xb4, 0xa9, 0xf6, 0xba, 0xb9, 0x8d, 0x8a, 0x15, 0x6, 0x49, 0x71, 0x82, 0xad, 0x3f};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x8, 0x34, 0xf7};
  lwmqtt_string_t topic_filter_s8 = {3, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS1;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS1;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = false;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = true;
sub_opts[8].qos = LWMQTT_QOS2;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  uint8_t bytesprops0[] = {0xe1, 0x22, 0xd};
  uint8_t bytesprops1[] = {0x14, 0x14, 0xff, 0x24, 0xb0, 0xd8, 0xae, 0x98, 0x4b, 0xc5, 0x66, 0xc0, 0xa5, 0x52, 0x4e, 0x6, 0x53, 0xdb, 0xa, 0x3c, 0x4c, 0x7f};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32469}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 714}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 31220}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {3, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops1}}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12736, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26425 [("\145\NAK7\199",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1}),("\GSs0\DC1\171V\137\&9\159w\132\ESC\169\234\155\213",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\\\142Z\247\242sCn\US\191q!\148^!i\196\133\n\205\140Ar\136\133",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\235e\220\167>\DLE*\133\128\145\180\DC3t\129\&8",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\218\188\137$}\EOT4\238\239\232|~\185\169R\141\196\189R\151",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\173\US{0hp\194\172Up\210?\133\204\227\&0\160\137\183\158\212\217z\228\208\130\164\213\ACK\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\217\199\165J\206\133\254\160,k\ETB\144\186\EOT\ETXKN=\160\SYN\200K\f\208\155%\180",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\DEL\210\186",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\211\225\228\234\188g\203A\222\NUL!\191\194\&0\194\&0\144@(A\232\&8\176N",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1})] [PropReasonString "\163\196\DC1\US\DC4\186sL\238L",PropTopicAlias 7143,PropWildcardSubscriptionAvailable 82,PropMessageExpiryInterval 15875,PropSharedSubscriptionAvailable 168,PropSubscriptionIdentifier 4,PropCorrelationData "r\174\213\240w\SYN\252\\'",PropReasonString "@\181\143\177\163\176\192\169\183\215\231z\170O\DLEy\246\176\223W?\156\rx\DC3\154\201\140",PropAuthenticationData "`1p\163\252\SI\202\233\247\130]7\ENQ\f\RSW+dp\233]3\fr\197\233\SO\130\ENQ",PropRequestProblemInformation 2,PropCorrelationData "[\172\179=",PropSessionExpiryInterval 20694,PropSessionExpiryInterval 19861,PropRequestProblemInformation 17,PropMessageExpiryInterval 26061,PropRequestResponseInformation 228,PropWildcardSubscriptionAvailable 202,PropPayloadFormatIndicator 193,PropWildcardSubscriptionAvailable 120,PropRetainAvailable 37,PropMessageExpiryInterval 28337,PropRetainAvailable 100,PropTopicAlias 2850]
TEST(Subscribe5QCTest, Encode22) {
uint8_t pkt[] = {0x82, 0xd7, 0x2, 0x67, 0x39, 0x94, 0x1, 0x1f, 0x0, 0xa, 0xa3, 0xc4, 0x11, 0x1f, 0x14, 0xba, 0x73, 0x4c, 0xee, 0x4c, 0x23, 0x1b, 0xe7, 0x28, 0x52, 0x2, 0x0, 0x0, 0x3e, 0x3, 0x2a, 0xa8, 0xb, 0x4, 0x9, 0x0, 0x9, 0x72, 0xae, 0xd5, 0xf0, 0x77, 0x16, 0xfc, 0x5c, 0x27, 0x1f, 0x0, 0x1c, 0x40, 0xb5, 0x8f, 0xb1, 0xa3, 0xb0, 0xc0, 0xa9, 0xb7, 0xd7, 0xe7, 0x7a, 0xaa, 0x4f, 0x10, 0x79, 0xf6, 0xb0, 0xdf, 0x57, 0x3f, 0x9c, 0xd, 0x78, 0x13, 0x9a, 0xc9, 0x8c, 0x16, 0x0, 0x1d, 0x60, 0x31, 0x70, 0xa3, 0xfc, 0xf, 0xca, 0xe9, 0xf7, 0x82, 0x5d, 0x37, 0x5, 0xc, 0x1e, 0x57, 0x2b, 0x64, 0x70, 0xe9, 0x5d, 0x33, 0xc, 0x72, 0xc5, 0xe9, 0xe, 0x82, 0x5, 0x17, 0x2, 0x9, 0x0, 0x4, 0x5b, 0xac, 0xb3, 0x3d, 0x11, 0x0, 0x0, 0x50, 0xd6, 0x11, 0x0, 0x0, 0x4d, 0x95, 0x17, 0x11, 0x2, 0x0, 0x0, 0x65, 0xcd, 0x19, 0xe4, 0x28, 0xca, 0x1, 0xc1, 0x28, 0x78, 0x25, 0x25, 0x2, 0x0, 0x0, 0x6e, 0xb1, 0x25, 0x64, 0x23, 0xb, 0x22, 0x0, 0x4, 0x91, 0x15, 0x37, 0xc7, 0x9, 0x0, 0x10, 0x1d, 0x73, 0x30, 0x11, 0xab, 0x56, 0x89, 0x39, 0x9f, 0x77, 0x84, 0x1b, 0xa9, 0xea, 0x9b, 0xd5, 0x2, 0x0, 0x19, 0x5c, 0x8e, 0x5a, 0xf7, 0xf2, 0x73, 0x43, 0x6e, 0x1f, 0xbf, 0x71, 0x21, 0x94, 0x5e, 0x21, 0x69, 0xc4, 0x85, 0xa, 0xcd, 0x8c, 0x41, 0x72, 0x88, 0x85, 0x1c, 0x0, 0xf, 0xeb, 0x65, 0xdc, 0xa7, 0x3e, 0x10, 0x2a, 0x85, 0x80, 0x91, 0xb4, 0x13, 0x74, 0x81, 0x38, 0x25, 0x0, 0x14, 0xda, 0xbc, 0x89, 0x24, 0x7d, 0x4, 0x34, 0xee, 0xef, 0xe8, 0x7c, 0x7e, 0xb9, 0xa9, 0x52, 0x8d, 0xc4, 0xbd, 0x52, 0x97, 0x1c, 0x0, 0x1e, 0xad, 0x1f, 0x7b, 0x30, 0x68, 0x70, 0xc2, 0xac, 0x55, 0x70, 0xd2, 0x3f, 0x85, 0xcc, 0xe3, 0x30, 0xa0, 0x89, 0xb7, 0x9e, 0xd4, 0xd9, 0x7a, 0xe4, 0xd0, 0x82, 0xa4, 0xd5, 0x6, 0xd2, 0xc, 0x0, 0x1b, 0xd9, 0xc7, 0xa5, 0x4a, 0xce, 0x85, 0xfe, 0xa0, 0x2c, 0x6b, 0x17, 0x90, 0xba, 0x4, 0x3, 0x4b, 0x4e, 0x3d, 0xa0, 0x16, 0xc8, 0x4b, 0xc, 0xd0, 0x9b, 0x25, 0xb4, 0xd, 0x0, 0x3, 0x7f, 0xd2, 0xba, 0x2, 0x0, 0x18, 0xd3, 0xe1, 0xe4, 0xea, 0xbc, 0x67, 0xcb, 0x41, 0xde, 0x0, 0x21, 0xbf, 0xc2, 0x30, 0xc2, 0x30, 0x90, 0x40, 0x28, 0x41, 0xe8, 0x38, 0xb0, 0x4e, 0x29};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x91, 0x15, 0x37, 0xc7};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1d, 0x73, 0x30, 0x11, 0xab, 0x56, 0x89, 0x39, 0x9f, 0x77, 0x84, 0x1b, 0xa9, 0xea, 0x9b, 0xd5};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5c, 0x8e, 0x5a, 0xf7, 0xf2, 0x73, 0x43, 0x6e, 0x1f, 0xbf, 0x71, 0x21, 0x94, 0x5e, 0x21, 0x69, 0xc4, 0x85, 0xa, 0xcd, 0x8c, 0x41, 0x72, 0x88, 0x85};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xeb, 0x65, 0xdc, 0xa7, 0x3e, 0x10, 0x2a, 0x85, 0x80, 0x91, 0xb4, 0x13, 0x74, 0x81, 0x38};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xda, 0xbc, 0x89, 0x24, 0x7d, 0x4, 0x34, 0xee, 0xef, 0xe8, 0x7c, 0x7e, 0xb9, 0xa9, 0x52, 0x8d, 0xc4, 0xbd, 0x52, 0x97};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xad, 0x1f, 0x7b, 0x30, 0x68, 0x70, 0xc2, 0xac, 0x55, 0x70, 0xd2, 0x3f, 0x85, 0xcc, 0xe3, 0x30, 0xa0, 0x89, 0xb7, 0x9e, 0xd4, 0xd9, 0x7a, 0xe4, 0xd0, 0x82, 0xa4, 0xd5, 0x6, 0xd2};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd9, 0xc7, 0xa5, 0x4a, 0xce, 0x85, 0xfe, 0xa0, 0x2c, 0x6b, 0x17, 0x90, 0xba, 0x4, 0x3, 0x4b, 0x4e, 0x3d, 0xa0, 0x16, 0xc8, 0x4b, 0xc, 0xd0, 0x9b, 0x25, 0xb4};
  lwmqtt_string_t topic_filter_s6 = {27, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x7f, 0xd2, 0xba};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xd3, 0xe1, 0xe4, 0xea, 0xbc, 0x67, 0xcb, 0x41, 0xde, 0x0, 0x21, 0xbf, 0xc2, 0x30, 0xc2, 0x30, 0x90, 0x40, 0x28, 0x41, 0xe8, 0x38, 0xb0, 0x4e};
  lwmqtt_string_t topic_filter_s8 = {24, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[5].retain_as_published = true;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS1;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = true;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[7].retain_as_published = false;
sub_opts[7].no_local = false;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[8].retain_as_published = true;
sub_opts[8].no_local = false;
  uint8_t bytesprops0[] = {0xa3, 0xc4, 0x11, 0x1f, 0x14, 0xba, 0x73, 0x4c, 0xee, 0x4c};
  uint8_t bytesprops1[] = {0x72, 0xae, 0xd5, 0xf0, 0x77, 0x16, 0xfc, 0x5c, 0x27};
  uint8_t bytesprops2[] = {0x40, 0xb5, 0x8f, 0xb1, 0xa3, 0xb0, 0xc0, 0xa9, 0xb7, 0xd7, 0xe7, 0x7a, 0xaa, 0x4f, 0x10, 0x79, 0xf6, 0xb0, 0xdf, 0x57, 0x3f, 0x9c, 0xd, 0x78, 0x13, 0x9a, 0xc9, 0x8c};
  uint8_t bytesprops3[] = {0x60, 0x31, 0x70, 0xa3, 0xfc, 0xf, 0xca, 0xe9, 0xf7, 0x82, 0x5d, 0x37, 0x5, 0xc, 0x1e, 0x57, 0x2b, 0x64, 0x70, 0xe9, 0x5d, 0x33, 0xc, 0x72, 0xc5, 0xe9, 0xe, 0x82, 0x5};
  uint8_t bytesprops4[] = {0x5b, 0xac, 0xb3, 0x3d};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7143}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 82}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15875}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 168}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 4}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {28, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 2}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 20694}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19861}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 17}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 26061}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 228}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 202}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 193}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 120}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 37}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28337}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 2850}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 26425, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 17320 [("\144\175\&0\194y\215$\SO<G\160\164\218\ACK\212\176\137d\253\198",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("F+i\212\224",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\DC4\200\DC2lh\179@\DEL\157,\"-\181PJI\212\GS/\216C\135\ACK\255\177\130\190F\229",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0})] [PropReceiveMaximum 7257,PropRequestResponseInformation 149,PropSharedSubscriptionAvailable 47,PropResponseTopic "@\158IU",PropContentType "\SO\191\179\222\".\162\EM2\189\231<\159n\216Q\168\133\242\185Zx\206",PropAuthenticationMethod "B\161\165p\128\145\213l\131\156\&7$\254\193y|&\DC3M\177\241",PropSharedSubscriptionAvailable 12,PropCorrelationData "\204\a\ETB\249\DC2\195\r2\247HPix\180\128\216t\202?f\SI7\154\133",PropMaximumQoS 127,PropUserProperty "\222\&99\215@\134\DEL\205\132\240/(r\254\191\255\150[\215B\234I\201\SUBN" "3,\176\233in\182\153\DC2`\212~\207\204:",PropAuthenticationData "D\159(\160k)\152\143$\192\222y,\178",PropMessageExpiryInterval 14453,PropReasonString "",PropResponseInformation "\r\DC4\240\182K\SO\212\tV\244`/`\CAN\213\219\CAN%\149"]
TEST(Subscribe5QCTest, Encode23) {
uint8_t pkt[] = {0x82, 0x81, 0x2, 0x43, 0xa8, 0xbb, 0x1, 0x21, 0x1c, 0x59, 0x19, 0x95, 0x2a, 0x2f, 0x8, 0x0, 0x4, 0x40, 0x9e, 0x49, 0x55, 0x3, 0x0, 0x17, 0xe, 0xbf, 0xb3, 0xde, 0x22, 0x2e, 0xa2, 0x19, 0x32, 0xbd, 0xe7, 0x3c, 0x9f, 0x6e, 0xd8, 0x51, 0xa8, 0x85, 0xf2, 0xb9, 0x5a, 0x78, 0xce, 0x15, 0x0, 0x15, 0x42, 0xa1, 0xa5, 0x70, 0x80, 0x91, 0xd5, 0x6c, 0x83, 0x9c, 0x37, 0x24, 0xfe, 0xc1, 0x79, 0x7c, 0x26, 0x13, 0x4d, 0xb1, 0xf1, 0x2a, 0xc, 0x9, 0x0, 0x18, 0xcc, 0x7, 0x17, 0xf9, 0x12, 0xc3, 0xd, 0x32, 0xf7, 0x48, 0x50, 0x69, 0x78, 0xb4, 0x80, 0xd8, 0x74, 0xca, 0x3f, 0x66, 0xf, 0x37, 0x9a, 0x85, 0x24, 0x7f, 0x26, 0x0, 0x19, 0xde, 0x39, 0x39, 0xd7, 0x40, 0x86, 0x7f, 0xcd, 0x84, 0xf0, 0x2f, 0x28, 0x72, 0xfe, 0xbf, 0xff, 0x96, 0x5b, 0xd7, 0x42, 0xea, 0x49, 0xc9, 0x1a, 0x4e, 0x0, 0xf, 0x33, 0x2c, 0xb0, 0xe9, 0x69, 0x6e, 0xb6, 0x99, 0x12, 0x60, 0xd4, 0x7e, 0xcf, 0xcc, 0x3a, 0x16, 0x0, 0xe, 0x44, 0x9f, 0x28, 0xa0, 0x6b, 0x29, 0x98, 0x8f, 0x24, 0xc0, 0xde, 0x79, 0x2c, 0xb2, 0x2, 0x0, 0x0, 0x38, 0x75, 0x1f, 0x0, 0x0, 0x1a, 0x0, 0x13, 0xd, 0x14, 0xf0, 0xb6, 0x4b, 0xe, 0xd4, 0x9, 0x56, 0xf4, 0x60, 0x2f, 0x60, 0x18, 0xd5, 0xdb, 0x18, 0x25, 0x95, 0x0, 0x14, 0x90, 0xaf, 0x30, 0xc2, 0x79, 0xd7, 0x24, 0xe, 0x3c, 0x47, 0xa0, 0xa4, 0xda, 0x6, 0xd4, 0xb0, 0x89, 0x64, 0xfd, 0xc6, 0x1e, 0x0, 0x5, 0x46, 0x2b, 0x69, 0xd4, 0xe0, 0xa, 0x0, 0x0, 0x1d, 0x0, 0x1d, 0x14, 0xc8, 0x12, 0x6c, 0x68, 0xb3, 0x40, 0x7f, 0x9d, 0x2c, 0x22, 0x2d, 0xb5, 0x50, 0x4a, 0x49, 0xd4, 0x1d, 0x2f, 0xd8, 0x43, 0x87, 0x6, 0xff, 0xb1, 0x82, 0xbe, 0x46, 0xe5, 0x8};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x90, 0xaf, 0x30, 0xc2, 0x79, 0xd7, 0x24, 0xe, 0x3c, 0x47, 0xa0, 0xa4, 0xda, 0x6, 0xd4, 0xb0, 0x89, 0x64, 0xfd, 0xc6};
  lwmqtt_string_t topic_filter_s0 = {20, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x46, 0x2b, 0x69, 0xd4, 0xe0};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x14, 0xc8, 0x12, 0x6c, 0x68, 0xb3, 0x40, 0x7f, 0x9d, 0x2c, 0x22, 0x2d, 0xb5, 0x50, 0x4a, 0x49, 0xd4, 0x1d, 0x2f, 0xd8, 0x43, 0x87, 0x6, 0xff, 0xb1, 0x82, 0xbe, 0x46, 0xe5};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
lwmqtt_sub_options_t sub_opts[4];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS0;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = false;
  uint8_t bytesprops0[] = {0x40, 0x9e, 0x49, 0x55};
  uint8_t bytesprops1[] = {0xe, 0xbf, 0xb3, 0xde, 0x22, 0x2e, 0xa2, 0x19, 0x32, 0xbd, 0xe7, 0x3c, 0x9f, 0x6e, 0xd8, 0x51, 0xa8, 0x85, 0xf2, 0xb9, 0x5a, 0x78, 0xce};
  uint8_t bytesprops2[] = {0x42, 0xa1, 0xa5, 0x70, 0x80, 0x91, 0xd5, 0x6c, 0x83, 0x9c, 0x37, 0x24, 0xfe, 0xc1, 0x79, 0x7c, 0x26, 0x13, 0x4d, 0xb1, 0xf1};
  uint8_t bytesprops3[] = {0xcc, 0x7, 0x17, 0xf9, 0x12, 0xc3, 0xd, 0x32, 0xf7, 0x48, 0x50, 0x69, 0x78, 0xb4, 0x80, 0xd8, 0x74, 0xca, 0x3f, 0x66, 0xf, 0x37, 0x9a, 0x85};
  uint8_t bytesprops5[] = {0x33, 0x2c, 0xb0, 0xe9, 0x69, 0x6e, 0xb6, 0x99, 0x12, 0x60, 0xd4, 0x7e, 0xcf, 0xcc, 0x3a};
  uint8_t bytesprops4[] = {0xde, 0x39, 0x39, 0xd7, 0x40, 0x86, 0x7f, 0xcd, 0x84, 0xf0, 0x2f, 0x28, 0x72, 0xfe, 0xbf, 0xff, 0x96, 0x5b, 0xd7, 0x42, 0xea, 0x49, 0xc9, 0x1a, 0x4e};
  uint8_t bytesprops6[] = {0x44, 0x9f, 0x28, 0xa0, 0x6b, 0x29, 0x98, 0x8f, 0x24, 0xc0, 0xde, 0x79, 0x2c, 0xb2};
  uint8_t bytesprops7[] = {0};
  uint8_t bytesprops8[] = {0xd, 0x14, 0xf0, 0xb6, 0x4b, 0xe, 0xd4, 0x9, 0x56, 0xf4, 0x60, 0x2f, 0x60, 0x18, 0xd5, 0xdb, 0x18, 0x25, 0x95};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 7257}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 149}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 47}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 12}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 127}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={25, (char*)&bytesprops4}, .v={15, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {14, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14453}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {0, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {19, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 17320, 4, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 9349 [("D\161",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\147\GS\140\221\194\249\&2H$\160\&9Z\247\201\&7\235\133\210M{r\146uJY\ESC",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\234\216\197\146-.:|#\186\SUB}\134",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("]/.\208\EOT\195\224Ig\238x\219\254 \178",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("\168\232\NAK\137\231\230}~\178]6\246",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("V\129f)\206Y\b\216\222\223*\132k\193\163\213\&2)",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS0}),("\249\201\EMx\233\208\197*\228\149\179\213\158,\166q\253>\US",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\140\252\NAKZ\ENQ\201\234\204\151\235\251\198\234\190\DC2\NULi\211\201",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropReceiveMaximum 28279,PropMaximumQoS 210,PropMaximumQoS 185,PropWildcardSubscriptionAvailable 25]
TEST(Subscribe5QCTest, Encode24) {
uint8_t pkt[] = {0x82, 0xa3, 0x1, 0x24, 0x85, 0x9, 0x21, 0x6e, 0x77, 0x24, 0xd2, 0x24, 0xb9, 0x28, 0x19, 0x0, 0x2, 0x44, 0xa1, 0x2c, 0x0, 0x1a, 0x93, 0x1d, 0x8c, 0xdd, 0xc2, 0xf9, 0x32, 0x48, 0x24, 0xa0, 0x39, 0x5a, 0xf7, 0xc9, 0x37, 0xeb, 0x85, 0xd2, 0x4d, 0x7b, 0x72, 0x92, 0x75, 0x4a, 0x59, 0x1b, 0x1, 0x0, 0xd, 0xea, 0xd8, 0xc5, 0x92, 0x2d, 0x2e, 0x3a, 0x7c, 0x23, 0xba, 0x1a, 0x7d, 0x86, 0x16, 0x0, 0x0, 0x22, 0x0, 0xf, 0x5d, 0x2f, 0x2e, 0xd0, 0x4, 0xc3, 0xe0, 0x49, 0x67, 0xee, 0x78, 0xdb, 0xfe, 0x20, 0xb2, 0x1a, 0x0, 0xc, 0xa8, 0xe8, 0x15, 0x89, 0xe7, 0xe6, 0x7d, 0x7e, 0xb2, 0x5d, 0x36, 0xf6, 0x22, 0x0, 0x12, 0x56, 0x81, 0x66, 0x29, 0xce, 0x59, 0x8, 0xd8, 0xde, 0xdf, 0x2a, 0x84, 0x6b, 0xc1, 0xa3, 0xd5, 0x32, 0x29, 0x18, 0x0, 0x13, 0xf9, 0xc9, 0x19, 0x78, 0xe9, 0xd0, 0xc5, 0x2a, 0xe4, 0x95, 0xb3, 0xd5, 0x9e, 0x2c, 0xa6, 0x71, 0xfd, 0x3e, 0x1f, 0x2e, 0x0, 0x13, 0x8c, 0xfc, 0x15, 0x5a, 0x5, 0xc9, 0xea, 0xcc, 0x97, 0xeb, 0xfb, 0xc6, 0xea, 0xbe, 0x12, 0x0, 0x69, 0xd3, 0xc9, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x44, 0xa1};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x93, 0x1d, 0x8c, 0xdd, 0xc2, 0xf9, 0x32, 0x48, 0x24, 0xa0, 0x39, 0x5a, 0xf7, 0xc9, 0x37, 0xeb, 0x85, 0xd2, 0x4d, 0x7b, 0x72, 0x92, 0x75, 0x4a, 0x59, 0x1b};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xea, 0xd8, 0xc5, 0x92, 0x2d, 0x2e, 0x3a, 0x7c, 0x23, 0xba, 0x1a, 0x7d, 0x86};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0};
  lwmqtt_string_t topic_filter_s3 = {0, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5d, 0x2f, 0x2e, 0xd0, 0x4, 0xc3, 0xe0, 0x49, 0x67, 0xee, 0x78, 0xdb, 0xfe, 0x20, 0xb2};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa8, 0xe8, 0x15, 0x89, 0xe7, 0xe6, 0x7d, 0x7e, 0xb2, 0x5d, 0x36, 0xf6};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x56, 0x81, 0x66, 0x29, 0xce, 0x59, 0x8, 0xd8, 0xde, 0xdf, 0x2a, 0x84, 0x6b, 0xc1, 0xa3, 0xd5, 0x32, 0x29};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xf9, 0xc9, 0x19, 0x78, 0xe9, 0xd0, 0xc5, 0x2a, 0xe4, 0x95, 0xb3, 0xd5, 0x9e, 0x2c, 0xa6, 0x71, 0xfd, 0x3e, 0x1f};
  lwmqtt_string_t topic_filter_s7 = {19, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x8c, 0xfc, 0x15, 0x5a, 0x5, 0xc9, 0xea, 0xcc, 0x97, 0xeb, 0xfb, 0xc6, 0xea, 0xbe, 0x12, 0x0, 0x69, 0xd3, 0xc9};
  lwmqtt_string_t topic_filter_s8 = {19, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
lwmqtt_sub_options_t sub_opts[9];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS1;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = false;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = false;
sub_opts[5].qos = LWMQTT_QOS2;
sub_opts[5].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = false;
sub_opts[6].qos = LWMQTT_QOS0;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS2;
sub_opts[7].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = true;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[8].retain_as_published = false;
sub_opts[8].no_local = false;
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 28279}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 185}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 25}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 9349, 9, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 26963 [("\222\194M\DEL\152\197,\190??\b\237\DELK\244.\212\133\159\247{\238\US7[\151\DC1",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\171\141\177\173\n\EM\129,\143\DC4\167\162\191<,",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("{\146\138\133s9`\172\155`\205#\CAN\160\193h\188\DC3K\205\253<\255g\DC4c\246",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("'\170\221]\SIq\189\192\ESCH\r5\163\154D",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("i",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2})] [PropResponseTopic "\206P'i\t\136\192:l&Zd\184\154#\231\219Y^\253\238\173\181\133\210\247",PropReasonString "\245vtLJE\244CgT\155cZH\190\ETB\254Y\144\EM;Y",PropTopicAlias 31490,PropRetainAvailable 238,PropServerReference "\155\170W",PropAssignedClientIdentifier "\208\208\234\STX|\165",PropTopicAliasMaximum 6467,PropSubscriptionIdentifierAvailable 0,PropSubscriptionIdentifier 20,PropReceiveMaximum 26960,PropUserProperty "\129n\150" "Eh\215\&8\219\fl6\133\170}\248\237\189\228\&6\175\144u",PropResponseInformation "",PropWildcardSubscriptionAvailable 215,PropWildcardSubscriptionAvailable 129,PropSessionExpiryInterval 26931,PropWillDelayInterval 21110,PropResponseTopic "9Y\156\204\202\242\DC1*\161\234\175\178i\SOHT\213\DC3\NAK\217?p\US\160p\143\151\142\167",PropCorrelationData "\SUBV\204\247\&7q\222\220\217\244\129\&9o\DC1\175=\255\128\GS5\DC2d",PropReceiveMaximum 30889,PropMaximumPacketSize 6880,PropServerKeepAlive 4124,PropServerReference "\204\CANI3Ql\168\181\218\DEL",PropMessageExpiryInterval 3510,PropPayloadFormatIndicator 8,PropSubscriptionIdentifierAvailable 139,PropMaximumQoS 173,PropAuthenticationData "\128\173}\DLE\165\&8\227c\EOT$\157\235z\DC2\171"]
TEST(Subscribe5QCTest, Encode25) {
uint8_t pkt[] = {0x82, 0xd5, 0x2, 0x69, 0x53, 0xed, 0x1, 0x8, 0x0, 0x1a, 0xce, 0x50, 0x27, 0x69, 0x9, 0x88, 0xc0, 0x3a, 0x6c, 0x26, 0x5a, 0x64, 0xb8, 0x9a, 0x23, 0xe7, 0xdb, 0x59, 0x5e, 0xfd, 0xee, 0xad, 0xb5, 0x85, 0xd2, 0xf7, 0x1f, 0x0, 0x16, 0xf5, 0x76, 0x74, 0x4c, 0x4a, 0x45, 0xf4, 0x43, 0x67, 0x54, 0x9b, 0x63, 0x5a, 0x48, 0xbe, 0x17, 0xfe, 0x59, 0x90, 0x19, 0x3b, 0x59, 0x23, 0x7b, 0x2, 0x25, 0xee, 0x1c, 0x0, 0x3, 0x9b, 0xaa, 0x57, 0x12, 0x0, 0x6, 0xd0, 0xd0, 0xea, 0x2, 0x7c, 0xa5, 0x22, 0x19, 0x43, 0x29, 0x0, 0xb, 0x14, 0x21, 0x69, 0x50, 0x26, 0x0, 0x3, 0x81, 0x6e, 0x96, 0x0, 0x13, 0x45, 0x68, 0xd7, 0x38, 0xdb, 0xc, 0x6c, 0x36, 0x85, 0xaa, 0x7d, 0xf8, 0xed, 0xbd, 0xe4, 0x36, 0xaf, 0x90, 0x75, 0x1a, 0x0, 0x0, 0x28, 0xd7, 0x28, 0x81, 0x11, 0x0, 0x0, 0x69, 0x33, 0x18, 0x0, 0x0, 0x52, 0x76, 0x8, 0x0, 0x1c, 0x39, 0x59, 0x9c, 0xcc, 0xca, 0xf2, 0x11, 0x2a, 0xa1, 0xea, 0xaf, 0xb2, 0x69, 0x1, 0x54, 0xd5, 0x13, 0x15, 0xd9, 0x3f, 0x70, 0x1f, 0xa0, 0x70, 0x8f, 0x97, 0x8e, 0xa7, 0x9, 0x0, 0x16, 0x1a, 0x56, 0xcc, 0xf7, 0x37, 0x71, 0xde, 0xdc, 0xd9, 0xf4, 0x81, 0x39, 0x6f, 0x11, 0xaf, 0x3d, 0xff, 0x80, 0x1d, 0x35, 0x12, 0x64, 0x21, 0x78, 0xa9, 0x27, 0x0, 0x0, 0x1a, 0xe0, 0x13, 0x10, 0x1c, 0x1c, 0x0, 0xa, 0xcc, 0x18, 0x49, 0x33, 0x51, 0x6c, 0xa8, 0xb5, 0xda, 0x7f, 0x2, 0x0, 0x0, 0xd, 0xb6, 0x1, 0x8, 0x29, 0x8b, 0x24, 0xad, 0x16, 0x0, 0xf, 0x80, 0xad, 0x7d, 0x10, 0xa5, 0x38, 0xe3, 0x63, 0x4, 0x24, 0x9d, 0xeb, 0x7a, 0x12, 0xab, 0x0, 0x1b, 0xde, 0xc2, 0x4d, 0x7f, 0x98, 0xc5, 0x2c, 0xbe, 0x3f, 0x3f, 0x8, 0xed, 0x7f, 0x4b, 0xf4, 0x2e, 0xd4, 0x85, 0x9f, 0xf7, 0x7b, 0xee, 0x1f, 0x37, 0x5b, 0x97, 0x11, 0x12, 0x0, 0xf, 0xab, 0x8d, 0xb1, 0xad, 0xa, 0x19, 0x81, 0x2c, 0x8f, 0x14, 0xa7, 0xa2, 0xbf, 0x3c, 0x2c, 0x16, 0x0, 0x1b, 0x7b, 0x92, 0x8a, 0x85, 0x73, 0x39, 0x60, 0xac, 0x9b, 0x60, 0xcd, 0x23, 0x18, 0xa0, 0xc1, 0x68, 0xbc, 0x13, 0x4b, 0xcd, 0xfd, 0x3c, 0xff, 0x67, 0x14, 0x63, 0xf6, 0x11, 0x0, 0xf, 0x27, 0xaa, 0xdd, 0x5d, 0xf, 0x71, 0xbd, 0xc0, 0x1b, 0x48, 0xd, 0x35, 0xa3, 0x9a, 0x44, 0x1d, 0x0, 0x1, 0x69, 0x1e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xde, 0xc2, 0x4d, 0x7f, 0x98, 0xc5, 0x2c, 0xbe, 0x3f, 0x3f, 0x8, 0xed, 0x7f, 0x4b, 0xf4, 0x2e, 0xd4, 0x85, 0x9f, 0xf7, 0x7b, 0xee, 0x1f, 0x37, 0x5b, 0x97, 0x11};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x8d, 0xb1, 0xad, 0xa, 0x19, 0x81, 0x2c, 0x8f, 0x14, 0xa7, 0xa2, 0xbf, 0x3c, 0x2c};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x7b, 0x92, 0x8a, 0x85, 0x73, 0x39, 0x60, 0xac, 0x9b, 0x60, 0xcd, 0x23, 0x18, 0xa0, 0xc1, 0x68, 0xbc, 0x13, 0x4b, 0xcd, 0xfd, 0x3c, 0xff, 0x67, 0x14, 0x63, 0xf6};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x27, 0xaa, 0xdd, 0x5d, 0xf, 0x71, 0xbd, 0xc0, 0x1b, 0x48, 0xd, 0x35, 0xa3, 0x9a, 0x44};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x69};
  lwmqtt_string_t topic_filter_s4 = {1, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
  uint8_t bytesprops0[] = {0xce, 0x50, 0x27, 0x69, 0x9, 0x88, 0xc0, 0x3a, 0x6c, 0x26, 0x5a, 0x64, 0xb8, 0x9a, 0x23, 0xe7, 0xdb, 0x59, 0x5e, 0xfd, 0xee, 0xad, 0xb5, 0x85, 0xd2, 0xf7};
  uint8_t bytesprops1[] = {0xf5, 0x76, 0x74, 0x4c, 0x4a, 0x45, 0xf4, 0x43, 0x67, 0x54, 0x9b, 0x63, 0x5a, 0x48, 0xbe, 0x17, 0xfe, 0x59, 0x90, 0x19, 0x3b, 0x59};
  uint8_t bytesprops2[] = {0x9b, 0xaa, 0x57};
  uint8_t bytesprops3[] = {0xd0, 0xd0, 0xea, 0x2, 0x7c, 0xa5};
  uint8_t bytesprops5[] = {0x45, 0x68, 0xd7, 0x38, 0xdb, 0xc, 0x6c, 0x36, 0x85, 0xaa, 0x7d, 0xf8, 0xed, 0xbd, 0xe4, 0x36, 0xaf, 0x90, 0x75};
  uint8_t bytesprops4[] = {0x81, 0x6e, 0x96};
  uint8_t bytesprops6[] = {0};
  uint8_t bytesprops7[] = {0x39, 0x59, 0x9c, 0xcc, 0xca, 0xf2, 0x11, 0x2a, 0xa1, 0xea, 0xaf, 0xb2, 0x69, 0x1, 0x54, 0xd5, 0x13, 0x15, 0xd9, 0x3f, 0x70, 0x1f, 0xa0, 0x70, 0x8f, 0x97, 0x8e, 0xa7};
  uint8_t bytesprops8[] = {0x1a, 0x56, 0xcc, 0xf7, 0x37, 0x71, 0xde, 0xdc, 0xd9, 0xf4, 0x81, 0x39, 0x6f, 0x11, 0xaf, 0x3d, 0xff, 0x80, 0x1d, 0x35, 0x12, 0x64};
  uint8_t bytesprops9[] = {0xcc, 0x18, 0x49, 0x33, 0x51, 0x6c, 0xa8, 0xb5, 0xda, 0x7f};
  uint8_t bytesprops10[] = {0x80, 0xad, 0x7d, 0x10, 0xa5, 0x38, 0xe3, 0x63, 0x4, 0x24, 0x9d, 0xeb, 0x7a, 0x12, 0xab};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {26, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 31490}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 238}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {6, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6467}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 0}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 20}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 26960}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={3, (char*)&bytesprops4}, .v={19, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {0, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 215}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 129}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 26931}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21110}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {28, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {22, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30889}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 6880}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 4124}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3510}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 8}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 139}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 173}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {15, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 26963, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21870 [("@\DC1\168\&4q^o\128\193 R\129Q\n\SO \156\223\234\178\252\158\217=",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\v\202\226\206G",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\159W\DC30=\CAN%",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("\138O\209\212z\EOTK",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2}),("3\240\148o\129\n\158\&8\NULd\193\134\132\129z\132z\219`{\235W\144_",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS2})] [PropReceiveMaximum 18596,PropMaximumPacketSize 20980,PropMessageExpiryInterval 5884,PropReasonString "H\243Jo{\STX\232\242\171\EOT2\150\146\144c\EOT\172p",PropMaximumPacketSize 4083]
TEST(Subscribe5QCTest, Encode26) {
uint8_t pkt[] = {0x82, 0x7c, 0x55, 0x6e, 0x27, 0x21, 0x48, 0xa4, 0x27, 0x0, 0x0, 0x51, 0xf4, 0x2, 0x0, 0x0, 0x16, 0xfc, 0x1f, 0x0, 0x12, 0x48, 0xf3, 0x4a, 0x6f, 0x7b, 0x2, 0xe8, 0xf2, 0xab, 0x4, 0x32, 0x96, 0x92, 0x90, 0x63, 0x4, 0xac, 0x70, 0x27, 0x0, 0x0, 0xf, 0xf3, 0x0, 0x18, 0x40, 0x11, 0xa8, 0x34, 0x71, 0x5e, 0x6f, 0x80, 0xc1, 0x20, 0x52, 0x81, 0x51, 0xa, 0xe, 0x20, 0x9c, 0xdf, 0xea, 0xb2, 0xfc, 0x9e, 0xd9, 0x3d, 0x2e, 0x0, 0x5, 0xb, 0xca, 0xe2, 0xce, 0x47, 0x1e, 0x0, 0x7, 0x9f, 0x57, 0x13, 0x30, 0x3d, 0x18, 0x25, 0x2e, 0x0, 0x7, 0x8a, 0x4f, 0xd1, 0xd4, 0x7a, 0x4, 0x4b, 0xe, 0x0, 0x18, 0x33, 0xf0, 0x94, 0x6f, 0x81, 0xa, 0x9e, 0x38, 0x0, 0x64, 0xc1, 0x86, 0x84, 0x81, 0x7a, 0x84, 0x7a, 0xdb, 0x60, 0x7b, 0xeb, 0x57, 0x90, 0x5f, 0xe};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x40, 0x11, 0xa8, 0x34, 0x71, 0x5e, 0x6f, 0x80, 0xc1, 0x20, 0x52, 0x81, 0x51, 0xa, 0xe, 0x20, 0x9c, 0xdf, 0xea, 0xb2, 0xfc, 0x9e, 0xd9, 0x3d};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb, 0xca, 0xe2, 0xce, 0x47};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9f, 0x57, 0x13, 0x30, 0x3d, 0x18, 0x25};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8a, 0x4f, 0xd1, 0xd4, 0x7a, 0x4, 0x4b};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x33, 0xf0, 0x94, 0x6f, 0x81, 0xa, 0x9e, 0x38, 0x0, 0x64, 0xc1, 0x86, 0x84, 0x81, 0x7a, 0x84, 0x7a, 0xdb, 0x60, 0x7b, 0xeb, 0x57, 0x90, 0x5f};
  lwmqtt_string_t topic_filter_s4 = {24, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
lwmqtt_sub_options_t sub_opts[5];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS2;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS2;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = true;
sub_opts[4].no_local = true;
  uint8_t bytesprops0[] = {0x48, 0xf3, 0x4a, 0x6f, 0x7b, 0x2, 0xe8, 0xf2, 0xab, 0x4, 0x32, 0x96, 0x92, 0x90, 0x63, 0x4, 0xac, 0x70};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 18596}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20980}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5884}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {18, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4083}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21870, 5, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 6154 [("\DEL\244\227\193\248L\DC2\249\249h\217u_u",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\146\226X\227zoKZ\172C$\DC1>",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("\USpH\130\\\EOT\ESCo\r\205\249d\215\243\246\EM\243\\Oy\195\147\&9<\249A\230\&5\ETX.",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\186Uah\251?\236m\133\v\215",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\f\193y\211\&9\163\188\237\SYN8\198\DC34\130\218\203\&3~\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\255+\137v\184\215Pix\170R\252{l\130\254\212yQ\223@l\SI\130i",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\137\236\&92",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("{\"\202\130",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS0}),("\221u\223w",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1}),("\249\137\219n\139\f\238\208lT0\201\209\SI\135\237\182\212\185\190\244\220\177\180B\229",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2}),("\\([*\EOTn\145\175\236G\176\&8\240\STX\170\SUB[c",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = True, _subQoS = QoS1})] [PropWillDelayInterval 18072,PropRequestProblemInformation 247,PropWildcardSubscriptionAvailable 13,PropAssignedClientIdentifier "pq\141\159\215]}S\235!qs",PropRequestResponseInformation 251,PropReasonString "\219\251S\148",PropUserProperty "\US\228\156\DC1\240`p%\137\140\230\164\\R\196\224" "\SO\250{\SUB\159\191\213\185",PropRequestResponseInformation 24,PropAuthenticationMethod "",PropServerReference "\SOH\176\197K\191\185\142>\244\DC13e9\201\253\183\DEL\249&\187\191\222\150D",PropTopicAlias 32300,PropPayloadFormatIndicator 3,PropWildcardSubscriptionAvailable 185,PropAuthenticationData "/",PropMaximumQoS 220,PropServerKeepAlive 4339,PropTopicAliasMaximum 14185,PropSessionExpiryInterval 886,PropUserProperty "<\245\DELf\142\168\168\154\243\184\DC1\189\CAN\146\197k\226\235?rc\170E:" "p\214\176\DC2\129",PropRequestResponseInformation 207,PropCorrelationData "@\212\214d\236`\143q\DELW\DC1\t\\p+\a\179\DC2\240]IW\GS\"",PropResponseTopic "",PropContentType "\176\181c\ETX)\179w?$a\248\250$\247=\n\159\151\156\135",PropUserProperty "O\132" "u\232\177\ACK;\191\&2\164\144.\158\135\194ho\251\153:\n\240\200\FSu",PropWildcardSubscriptionAvailable 59,PropMessageExpiryInterval 6310,PropServerReference "z\v\DLE\239h\129\&3\204%\254\NULF!\228bS>",PropRequestResponseInformation 10,PropTopicAliasMaximum 8987,PropUserProperty "R\GS9>f" "^\ETX\174\173K\197c\221\132L\249CY\179\208\207\154-\223"]
TEST(Subscribe5QCTest, Encode27) {
uint8_t pkt[] = {0x82, 0xf7, 0x3, 0x18, 0xa, 0xaa, 0x2, 0x18, 0x0, 0x0, 0x46, 0x98, 0x17, 0xf7, 0x28, 0xd, 0x12, 0x0, 0xc, 0x70, 0x71, 0x8d, 0x9f, 0xd7, 0x5d, 0x7d, 0x53, 0xeb, 0x21, 0x71, 0x73, 0x19, 0xfb, 0x1f, 0x0, 0x4, 0xdb, 0xfb, 0x53, 0x94, 0x26, 0x0, 0x10, 0x1f, 0xe4, 0x9c, 0x11, 0xf0, 0x60, 0x70, 0x25, 0x89, 0x8c, 0xe6, 0xa4, 0x5c, 0x52, 0xc4, 0xe0, 0x0, 0x8, 0xe, 0xfa, 0x7b, 0x1a, 0x9f, 0xbf, 0xd5, 0xb9, 0x19, 0x18, 0x15, 0x0, 0x0, 0x1c, 0x0, 0x18, 0x1, 0xb0, 0xc5, 0x4b, 0xbf, 0xb9, 0x8e, 0x3e, 0xf4, 0x11, 0x33, 0x65, 0x39, 0xc9, 0xfd, 0xb7, 0x7f, 0xf9, 0x26, 0xbb, 0xbf, 0xde, 0x96, 0x44, 0x23, 0x7e, 0x2c, 0x1, 0x3, 0x28, 0xb9, 0x16, 0x0, 0x1, 0x2f, 0x24, 0xdc, 0x13, 0x10, 0xf3, 0x22, 0x37, 0x69, 0x11, 0x0, 0x0, 0x3, 0x76, 0x26, 0x0, 0x18, 0x3c, 0xf5, 0x7f, 0x66, 0x8e, 0xa8, 0xa8, 0x9a, 0xf3, 0xb8, 0x11, 0xbd, 0x18, 0x92, 0xc5, 0x6b, 0xe2, 0xeb, 0x3f, 0x72, 0x63, 0xaa, 0x45, 0x3a, 0x0, 0x5, 0x70, 0xd6, 0xb0, 0x12, 0x81, 0x19, 0xcf, 0x9, 0x0, 0x18, 0x40, 0xd4, 0xd6, 0x64, 0xec, 0x60, 0x8f, 0x71, 0x7f, 0x57, 0x11, 0x9, 0x5c, 0x70, 0x2b, 0x7, 0xb3, 0x12, 0xf0, 0x5d, 0x49, 0x57, 0x1d, 0x22, 0x8, 0x0, 0x0, 0x3, 0x0, 0x14, 0xb0, 0xb5, 0x63, 0x3, 0x29, 0xb3, 0x77, 0x3f, 0x24, 0x61, 0xf8, 0xfa, 0x24, 0xf7, 0x3d, 0xa, 0x9f, 0x97, 0x9c, 0x87, 0x26, 0x0, 0x2, 0x4f, 0x84, 0x0, 0x17, 0x75, 0xe8, 0xb1, 0x6, 0x3b, 0xbf, 0x32, 0xa4, 0x90, 0x2e, 0x9e, 0x87, 0xc2, 0x68, 0x6f, 0xfb, 0x99, 0x3a, 0xa, 0xf0, 0xc8, 0x1c, 0x75, 0x28, 0x3b, 0x2, 0x0, 0x0, 0x18, 0xa6, 0x1c, 0x0, 0x11, 0x7a, 0xb, 0x10, 0xef, 0x68, 0x81, 0x33, 0xcc, 0x25, 0xfe, 0x0, 0x46, 0x21, 0xe4, 0x62, 0x53, 0x3e, 0x19, 0xa, 0x22, 0x23, 0x1b, 0x26, 0x0, 0x5, 0x52, 0x1d, 0x39, 0x3e, 0x66, 0x0, 0x13, 0x5e, 0x3, 0xae, 0xad, 0x4b, 0xc5, 0x63, 0xdd, 0x84, 0x4c, 0xf9, 0x43, 0x59, 0xb3, 0xd0, 0xcf, 0x9a, 0x2d, 0xdf, 0x0, 0xe, 0x7f, 0xf4, 0xe3, 0xc1, 0xf8, 0x4c, 0x12, 0xf9, 0xf9, 0x68, 0xd9, 0x75, 0x5f, 0x75, 0x2d, 0x0, 0xd, 0x92, 0xe2, 0x58, 0xe3, 0x7a, 0x6f, 0x4b, 0x5a, 0xac, 0x43, 0x24, 0x11, 0x3e, 0x2a, 0x0, 0x1e, 0x1f, 0x70, 0x48, 0x82, 0x5c, 0x4, 0x1b, 0x6f, 0xd, 0xcd, 0xf9, 0x64, 0xd7, 0xf3, 0xf6, 0x19, 0xf3, 0x5c, 0x4f, 0x79, 0xc3, 0x93, 0x39, 0x3c, 0xf9, 0x41, 0xe6, 0x35, 0x3, 0x2e, 0x2d, 0x0, 0xb, 0xba, 0x55, 0x61, 0x68, 0xfb, 0x3f, 0xec, 0x6d, 0x85, 0xb, 0xd7, 0x1d, 0x0, 0x13, 0xc, 0xc1, 0x79, 0xd3, 0x39, 0xa3, 0xbc, 0xed, 0x16, 0x38, 0xc6, 0x13, 0x34, 0x82, 0xda, 0xcb, 0x33, 0x7e, 0x5c, 0x4, 0x0, 0x19, 0xff, 0x2b, 0x89, 0x76, 0xb8, 0xd7, 0x50, 0x69, 0x78, 0xaa, 0x52, 0xfc, 0x7b, 0x6c, 0x82, 0xfe, 0xd4, 0x79, 0x51, 0xdf, 0x40, 0x6c, 0xf, 0x82, 0x69, 0x14, 0x0, 0x4, 0x89, 0xec, 0x39, 0x32, 0x1a, 0x0, 0x4, 0x7b, 0x22, 0xca, 0x82, 0x1c, 0x0, 0x4, 0xdd, 0x75, 0xdf, 0x77, 0x1d, 0x0, 0x1a, 0xf9, 0x89, 0xdb, 0x6e, 0x8b, 0xc, 0xee, 0xd0, 0x6c, 0x54, 0x30, 0xc9, 0xd1, 0xf, 0x87, 0xed, 0xb6, 0xd4, 0xb9, 0xbe, 0xf4, 0xdc, 0xb1, 0xb4, 0x42, 0xe5, 0x6, 0x0, 0x12, 0x5c, 0x28, 0x5b, 0x2a, 0x4, 0x6e, 0x91, 0xaf, 0xec, 0x47, 0xb0, 0x38, 0xf0, 0x2, 0xaa, 0x1a, 0x5b, 0x63, 0xd};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x7f, 0xf4, 0xe3, 0xc1, 0xf8, 0x4c, 0x12, 0xf9, 0xf9, 0x68, 0xd9, 0x75, 0x5f, 0x75};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x92, 0xe2, 0x58, 0xe3, 0x7a, 0x6f, 0x4b, 0x5a, 0xac, 0x43, 0x24, 0x11, 0x3e};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1f, 0x70, 0x48, 0x82, 0x5c, 0x4, 0x1b, 0x6f, 0xd, 0xcd, 0xf9, 0x64, 0xd7, 0xf3, 0xf6, 0x19, 0xf3, 0x5c, 0x4f, 0x79, 0xc3, 0x93, 0x39, 0x3c, 0xf9, 0x41, 0xe6, 0x35, 0x3, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xba, 0x55, 0x61, 0x68, 0xfb, 0x3f, 0xec, 0x6d, 0x85, 0xb, 0xd7};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc, 0xc1, 0x79, 0xd3, 0x39, 0xa3, 0xbc, 0xed, 0x16, 0x38, 0xc6, 0x13, 0x34, 0x82, 0xda, 0xcb, 0x33, 0x7e, 0x5c};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xff, 0x2b, 0x89, 0x76, 0xb8, 0xd7, 0x50, 0x69, 0x78, 0xaa, 0x52, 0xfc, 0x7b, 0x6c, 0x82, 0xfe, 0xd4, 0x79, 0x51, 0xdf, 0x40, 0x6c, 0xf, 0x82, 0x69};
  lwmqtt_string_t topic_filter_s5 = {25, (char*)&topic_filter_s5_bytes};
topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x89, 0xec, 0x39, 0x32};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x7b, 0x22, 0xca, 0x82};
  lwmqtt_string_t topic_filter_s7 = {4, (char*)&topic_filter_s7_bytes};
topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdd, 0x75, 0xdf, 0x77};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf9, 0x89, 0xdb, 0x6e, 0x8b, 0xc, 0xee, 0xd0, 0x6c, 0x54, 0x30, 0xc9, 0xd1, 0xf, 0x87, 0xed, 0xb6, 0xd4, 0xb9, 0xbe, 0xf4, 0xdc, 0xb1, 0xb4, 0x42, 0xe5};
  lwmqtt_string_t topic_filter_s9 = {26, (char*)&topic_filter_s9_bytes};
topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x5c, 0x28, 0x5b, 0x2a, 0x4, 0x6e, 0x91, 0xaf, 0xec, 0x47, 0xb0, 0x38, 0xf0, 0x2, 0xaa, 0x1a, 0x5b, 0x63};
  lwmqtt_string_t topic_filter_s10 = {18, (char*)&topic_filter_s10_bytes};
topic_filters[10] = topic_filter_s10;
lwmqtt_sub_options_t sub_opts[11];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[0].retain_as_published = true;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS1;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = true;
sub_opts[3].no_local = true;
sub_opts[4].qos = LWMQTT_QOS0;
sub_opts[4].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[4].retain_as_published = false;
sub_opts[4].no_local = true;
sub_opts[5].qos = LWMQTT_QOS0;
sub_opts[5].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[5].retain_as_published = false;
sub_opts[5].no_local = true;
sub_opts[6].qos = LWMQTT_QOS2;
sub_opts[6].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[6].retain_as_published = true;
sub_opts[6].no_local = false;
sub_opts[7].qos = LWMQTT_QOS0;
sub_opts[7].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[7].retain_as_published = true;
sub_opts[7].no_local = true;
sub_opts[8].qos = LWMQTT_QOS1;
sub_opts[8].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[8].retain_as_published = true;
sub_opts[8].no_local = true;
sub_opts[9].qos = LWMQTT_QOS2;
sub_opts[9].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[9].retain_as_published = false;
sub_opts[9].no_local = true;
sub_opts[10].qos = LWMQTT_QOS1;
sub_opts[10].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[10].retain_as_published = true;
sub_opts[10].no_local = true;
  uint8_t bytesprops0[] = {0x70, 0x71, 0x8d, 0x9f, 0xd7, 0x5d, 0x7d, 0x53, 0xeb, 0x21, 0x71, 0x73};
  uint8_t bytesprops1[] = {0xdb, 0xfb, 0x53, 0x94};
  uint8_t bytesprops3[] = {0xe, 0xfa, 0x7b, 0x1a, 0x9f, 0xbf, 0xd5, 0xb9};
  uint8_t bytesprops2[] = {0x1f, 0xe4, 0x9c, 0x11, 0xf0, 0x60, 0x70, 0x25, 0x89, 0x8c, 0xe6, 0xa4, 0x5c, 0x52, 0xc4, 0xe0};
  uint8_t bytesprops4[] = {0};
  uint8_t bytesprops5[] = {0x1, 0xb0, 0xc5, 0x4b, 0xbf, 0xb9, 0x8e, 0x3e, 0xf4, 0x11, 0x33, 0x65, 0x39, 0xc9, 0xfd, 0xb7, 0x7f, 0xf9, 0x26, 0xbb, 0xbf, 0xde, 0x96, 0x44};
  uint8_t bytesprops6[] = {0x2f};
  uint8_t bytesprops8[] = {0x70, 0xd6, 0xb0, 0x12, 0x81};
  uint8_t bytesprops7[] = {0x3c, 0xf5, 0x7f, 0x66, 0x8e, 0xa8, 0xa8, 0x9a, 0xf3, 0xb8, 0x11, 0xbd, 0x18, 0x92, 0xc5, 0x6b, 0xe2, 0xeb, 0x3f, 0x72, 0x63, 0xaa, 0x45, 0x3a};
  uint8_t bytesprops9[] = {0x40, 0xd4, 0xd6, 0x64, 0xec, 0x60, 0x8f, 0x71, 0x7f, 0x57, 0x11, 0x9, 0x5c, 0x70, 0x2b, 0x7, 0xb3, 0x12, 0xf0, 0x5d, 0x49, 0x57, 0x1d, 0x22};
  uint8_t bytesprops10[] = {0};
  uint8_t bytesprops11[] = {0xb0, 0xb5, 0x63, 0x3, 0x29, 0xb3, 0x77, 0x3f, 0x24, 0x61, 0xf8, 0xfa, 0x24, 0xf7, 0x3d, 0xa, 0x9f, 0x97, 0x9c, 0x87};
  uint8_t bytesprops13[] = {0x75, 0xe8, 0xb1, 0x6, 0x3b, 0xbf, 0x32, 0xa4, 0x90, 0x2e, 0x9e, 0x87, 0xc2, 0x68, 0x6f, 0xfb, 0x99, 0x3a, 0xa, 0xf0, 0xc8, 0x1c, 0x75};
  uint8_t bytesprops12[] = {0x4f, 0x84};
  uint8_t bytesprops14[] = {0x7a, 0xb, 0x10, 0xef, 0x68, 0x81, 0x33, 0xcc, 0x25, 0xfe, 0x0, 0x46, 0x21, 0xe4, 0x62, 0x53, 0x3e};
  uint8_t bytesprops16[] = {0x5e, 0x3, 0xae, 0xad, 0x4b, 0xc5, 0x63, 0xdd, 0x84, 0x4c, 0xf9, 0x43, 0x59, 0xb3, 0xd0, 0xcf, 0x9a, 0x2d, 0xdf};
  uint8_t bytesprops15[] = {0x52, 0x1d, 0x39, 0x3e, 0x66};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18072}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 247}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 13}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 251}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {4, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={16, (char*)&bytesprops2}, .v={8, (char*)&bytesprops3}}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 24}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {0, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32300}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 3}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 185}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 220}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 4339}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 14185}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 886}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={24, (char*)&bytesprops7}, .v={5, (char*)&bytesprops8}}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 207}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {0, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {20, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={2, (char*)&bytesprops12}, .v={23, (char*)&bytesprops13}}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 59}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6310}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {17, (char*)&bytesprops14}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 10}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 8987}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={5, (char*)&bytesprops15}, .v={19, (char*)&bytesprops16}}}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 6154, 11, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 7912 [("\182\167\151\163VQ\156;\242Q\187<\193\&4\145-\243Y\208\152E?\200&\SYN\US",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS1}),("\FS?\153\174\206\185MuW\176b\183\172\134",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\223\224s\US\169\&0bC\ENQQ\200\221\248qE\235\255B\n",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropServerReference "\152\224[5B",PropTopicAlias 477,PropUserProperty "\130\CANs\f4-\245\227" "46\200\238\DLEf\176\GS\192j#\183r\CAN\234\ENQ\133\249",PropResponseTopic "\GS\200\&9\209\216\182\137<\185\170\147\234\&2\132\171\181rh\137",PropReceiveMaximum 30574,PropRequestProblemInformation 32]
TEST(Subscribe5QCTest, Encode28) {
uint8_t pkt[] = {0x82, 0x8c, 0x1, 0x1e, 0xe8, 0x45, 0x1c, 0x0, 0x5, 0x98, 0xe0, 0x5b, 0x35, 0x42, 0x23, 0x1, 0xdd, 0x26, 0x0, 0x8, 0x82, 0x18, 0x73, 0xc, 0x34, 0x2d, 0xf5, 0xe3, 0x0, 0x12, 0x34, 0x36, 0xc8, 0xee, 0x10, 0x66, 0xb0, 0x1d, 0xc0, 0x6a, 0x23, 0xb7, 0x72, 0x18, 0xea, 0x5, 0x85, 0xf9, 0x8, 0x0, 0x13, 0x1d, 0xc8, 0x39, 0xd1, 0xd8, 0xb6, 0x89, 0x3c, 0xb9, 0xaa, 0x93, 0xea, 0x32, 0x84, 0xab, 0xb5, 0x72, 0x68, 0x89, 0x21, 0x77, 0x6e, 0x17, 0x20, 0x0, 0x1a, 0xb6, 0xa7, 0x97, 0xa3, 0x56, 0x51, 0x9c, 0x3b, 0xf2, 0x51, 0xbb, 0x3c, 0xc1, 0x34, 0x91, 0x2d, 0xf3, 0x59, 0xd0, 0x98, 0x45, 0x3f, 0xc8, 0x26, 0x16, 0x1f, 0x15, 0x0, 0xe, 0x1c, 0x3f, 0x99, 0xae, 0xce, 0xb9, 0x4d, 0x75, 0x57, 0xb0, 0x62, 0xb7, 0xac, 0x86, 0x24, 0x0, 0x13, 0xdf, 0xe0, 0x73, 0x1f, 0xa9, 0x30, 0x62, 0x43, 0x5, 0x51, 0xc8, 0xdd, 0xf8, 0x71, 0x45, 0xeb, 0xff, 0x42, 0xa, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xb6, 0xa7, 0x97, 0xa3, 0x56, 0x51, 0x9c, 0x3b, 0xf2, 0x51, 0xbb, 0x3c, 0xc1, 0x34, 0x91, 0x2d, 0xf3, 0x59, 0xd0, 0x98, 0x45, 0x3f, 0xc8, 0x26, 0x16, 0x1f};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1c, 0x3f, 0x99, 0xae, 0xce, 0xb9, 0x4d, 0x75, 0x57, 0xb0, 0x62, 0xb7, 0xac, 0x86};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xdf, 0xe0, 0x73, 0x1f, 0xa9, 0x30, 0x62, 0x43, 0x5, 0x51, 0xc8, 0xdd, 0xf8, 0x71, 0x45, 0xeb, 0xff, 0x42, 0xa};
  lwmqtt_string_t topic_filter_s2 = {19, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS1;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS0;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = true;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = false;
  uint8_t bytesprops0[] = {0x98, 0xe0, 0x5b, 0x35, 0x42};
  uint8_t bytesprops2[] = {0x34, 0x36, 0xc8, 0xee, 0x10, 0x66, 0xb0, 0x1d, 0xc0, 0x6a, 0x23, 0xb7, 0x72, 0x18, 0xea, 0x5, 0x85, 0xf9};
  uint8_t bytesprops1[] = {0x82, 0x18, 0x73, 0xc, 0x34, 0x2d, 0xf5, 0xe3};
  uint8_t bytesprops3[] = {0x1d, 0xc8, 0x39, 0xd1, 0xd8, 0xb6, 0x89, 0x3c, 0xb9, 0xaa, 0x93, 0xea, 0x32, 0x84, 0xab, 0xb5, 0x72, 0x68, 0x89};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 477}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={8, (char*)&bytesprops1}, .v={18, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30574}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 32}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 7912, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 1410 [("\146)\134\170\232\238\169\149\192\144\173`=4\225}\DC2\181\176\234\SUB-\173\SI\204",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\157\225\208\231:\189\b\244\171\243J\204\GS\233\177\CAN\210v\FS\NUL\EM",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\DC3\166\143e\196",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS1})] [PropRequestProblemInformation 29,PropTopicAlias 657,PropSessionExpiryInterval 1894,PropResponseTopic "$S",PropRequestResponseInformation 124,PropTopicAlias 1690,PropUserProperty "N\136xM3\136\222ru\f\176\175\DC1\230\NAK=\v\166\163\DELN\145X\210\215~\STXJz" "\220_x\128;I\ENQ\219\229\217\&7\198+\175\169\196\&7\233E^\210\198\146\ETB.]\RS\"q",PropPayloadFormatIndicator 229,PropRequestResponseInformation 121,PropRequestProblemInformation 171,PropPayloadFormatIndicator 152,PropMessageExpiryInterval 13952,PropServerReference "Q\225\246\218\234\194\NAKbVF^\f\214",PropAuthenticationData ")\254\245\174&:r!\160\SUB\218Y",PropUserProperty "\243\255y" "I",PropServerKeepAlive 9699,PropTopicAlias 857,PropServerKeepAlive 16613,PropServerKeepAlive 21324,PropMaximumQoS 131,PropRequestResponseInformation 48]
TEST(Subscribe5QCTest, Encode29) {
uint8_t pkt[] = {0x82, 0xd8, 0x1, 0x5, 0x82, 0x98, 0x1, 0x17, 0x1d, 0x23, 0x2, 0x91, 0x11, 0x0, 0x0, 0x7, 0x66, 0x8, 0x0, 0x2, 0x24, 0x53, 0x19, 0x7c, 0x23, 0x6, 0x9a, 0x26, 0x0, 0x1d, 0x4e, 0x88, 0x78, 0x4d, 0x33, 0x88, 0xde, 0x72, 0x75, 0xc, 0xb0, 0xaf, 0x11, 0xe6, 0x15, 0x3d, 0xb, 0xa6, 0xa3, 0x7f, 0x4e, 0x91, 0x58, 0xd2, 0xd7, 0x7e, 0x2, 0x4a, 0x7a, 0x0, 0x1d, 0xdc, 0x5f, 0x78, 0x80, 0x3b, 0x49, 0x5, 0xdb, 0xe5, 0xd9, 0x37, 0xc6, 0x2b, 0xaf, 0xa9, 0xc4, 0x37, 0xe9, 0x45, 0x5e, 0xd2, 0xc6, 0x92, 0x17, 0x2e, 0x5d, 0x1e, 0x22, 0x71, 0x1, 0xe5, 0x19, 0x79, 0x17, 0xab, 0x1, 0x98, 0x2, 0x0, 0x0, 0x36, 0x80, 0x1c, 0x0, 0xd, 0x51, 0xe1, 0xf6, 0xda, 0xea, 0xc2, 0x15, 0x62, 0x56, 0x46, 0x5e, 0xc, 0xd6, 0x16, 0x0, 0xc, 0x29, 0xfe, 0xf5, 0xae, 0x26, 0x3a, 0x72, 0x21, 0xa0, 0x1a, 0xda, 0x59, 0x26, 0x0, 0x3, 0xf3, 0xff, 0x79, 0x0, 0x1, 0x49, 0x13, 0x25, 0xe3, 0x23, 0x3, 0x59, 0x13, 0x40, 0xe5, 0x13, 0x53, 0x4c, 0x24, 0x83, 0x19, 0x30, 0x0, 0x19, 0x92, 0x29, 0x86, 0xaa, 0xe8, 0xee, 0xa9, 0x95, 0xc0, 0x90, 0xad, 0x60, 0x3d, 0x34, 0xe1, 0x7d, 0x12, 0xb5, 0xb0, 0xea, 0x1a, 0x2d, 0xad, 0xf, 0xcc, 0x14, 0x0, 0x15, 0x9d, 0xe1, 0xd0, 0xe7, 0x3a, 0xbd, 0x8, 0xf4, 0xab, 0xf3, 0x4a, 0xcc, 0x1d, 0xe9, 0xb1, 0x18, 0xd2, 0x76, 0x1c, 0x0, 0x19, 0x22, 0x0, 0x5, 0x13, 0xa6, 0x8f, 0x65, 0xc4, 0x9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x92, 0x29, 0x86, 0xaa, 0xe8, 0xee, 0xa9, 0x95, 0xc0, 0x90, 0xad, 0x60, 0x3d, 0x34, 0xe1, 0x7d, 0x12, 0xb5, 0xb0, 0xea, 0x1a, 0x2d, 0xad, 0xf, 0xcc};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x9d, 0xe1, 0xd0, 0xe7, 0x3a, 0xbd, 0x8, 0xf4, 0xab, 0xf3, 0x4a, 0xcc, 0x1d, 0xe9, 0xb1, 0x18, 0xd2, 0x76, 0x1c, 0x0, 0x19};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x13, 0xa6, 0x8f, 0x65, 0xc4};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
lwmqtt_sub_options_t sub_opts[3];
sub_opts[0].qos = LWMQTT_QOS0;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = true;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = false;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS1;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = true;
sub_opts[2].no_local = false;
  uint8_t bytesprops0[] = {0x24, 0x53};
  uint8_t bytesprops2[] = {0xdc, 0x5f, 0x78, 0x80, 0x3b, 0x49, 0x5, 0xdb, 0xe5, 0xd9, 0x37, 0xc6, 0x2b, 0xaf, 0xa9, 0xc4, 0x37, 0xe9, 0x45, 0x5e, 0xd2, 0xc6, 0x92, 0x17, 0x2e, 0x5d, 0x1e, 0x22, 0x71};
  uint8_t bytesprops1[] = {0x4e, 0x88, 0x78, 0x4d, 0x33, 0x88, 0xde, 0x72, 0x75, 0xc, 0xb0, 0xaf, 0x11, 0xe6, 0x15, 0x3d, 0xb, 0xa6, 0xa3, 0x7f, 0x4e, 0x91, 0x58, 0xd2, 0xd7, 0x7e, 0x2, 0x4a, 0x7a};
  uint8_t bytesprops3[] = {0x51, 0xe1, 0xf6, 0xda, 0xea, 0xc2, 0x15, 0x62, 0x56, 0x46, 0x5e, 0xc, 0xd6};
  uint8_t bytesprops4[] = {0x29, 0xfe, 0xf5, 0xae, 0x26, 0x3a, 0x72, 0x21, 0xa0, 0x1a, 0xda, 0x59};
  uint8_t bytesprops6[] = {0x49};
  uint8_t bytesprops5[] = {0xf3, 0xff, 0x79};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 29}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 657}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1894}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 124}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1690}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={29, (char*)&bytesprops1}, .v={29, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 229}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 121}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 152}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13952}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {13, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={3, (char*)&bytesprops5}, .v={1, (char*)&bytesprops6}}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 9699}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 857}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 16613}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21324}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 131}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 48}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1410, 3, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeRequest 21007 [("K\148\168\SOH",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("r\233o\161\151.",SubOptions {_retainHandling = DoNotSendOnSubscribe, _retainAsPublished = True, _noLocal = False, _subQoS = QoS2}),("a\216\169\218\&7\t\173\212\208C|\f\221",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = True, _subQoS = QoS0}),("\209\136\244\253\211\NAK\191-\a\196\188\224\129\178_\238\170[\218\131$jr\220U\162:",SubOptions {_retainHandling = SendOnSubscribeNew, _retainAsPublished = False, _noLocal = True, _subQoS = QoS2})] [PropAssignedClientIdentifier ")\152\165PL!\SOH\237s\235"]
TEST(Subscribe5QCTest, Encode30) {
uint8_t pkt[] = {0x82, 0x4e, 0x52, 0xf, 0xd, 0x12, 0x0, 0xa, 0x29, 0x98, 0xa5, 0x50, 0x4c, 0x21, 0x1, 0xed, 0x73, 0xeb, 0x0, 0x4, 0x4b, 0x94, 0xa8, 0x1, 0x2, 0x0, 0x6, 0x72, 0xe9, 0x6f, 0xa1, 0x97, 0x2e, 0x2a, 0x0, 0xd, 0x61, 0xd8, 0xa9, 0xda, 0x37, 0x9, 0xad, 0xd4, 0xd0, 0x43, 0x7c, 0xc, 0xdd, 0x4, 0x0, 0x1b, 0xd1, 0x88, 0xf4, 0xfd, 0xd3, 0x15, 0xbf, 0x2d, 0x7, 0xc4, 0xbc, 0xe0, 0x81, 0xb2, 0x5f, 0xee, 0xaa, 0x5b, 0xda, 0x83, 0x24, 0x6a, 0x72, 0xdc, 0x55, 0xa2, 0x3a, 0x16};
uint8_t buf[sizeof(pkt)+10] = { 0 };
lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x4b, 0x94, 0xa8, 0x1};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x72, 0xe9, 0x6f, 0xa1, 0x97, 0x2e};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x61, 0xd8, 0xa9, 0xda, 0x37, 0x9, 0xad, 0xd4, 0xd0, 0x43, 0x7c, 0xc, 0xdd};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd1, 0x88, 0xf4, 0xfd, 0xd3, 0x15, 0xbf, 0x2d, 0x7, 0xc4, 0xbc, 0xe0, 0x81, 0xb2, 0x5f, 0xee, 0xaa, 0x5b, 0xda, 0x83, 0x24, 0x6a, 0x72, 0xdc, 0x55, 0xa2, 0x3a};
  lwmqtt_string_t topic_filter_s3 = {27, (char*)&topic_filter_s3_bytes};
topic_filters[3] = topic_filter_s3;
lwmqtt_sub_options_t sub_opts[4];
sub_opts[0].qos = LWMQTT_QOS2;
sub_opts[0].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[0].retain_as_published = false;
sub_opts[0].no_local = false;
sub_opts[1].qos = LWMQTT_QOS2;
sub_opts[1].retain_handling = LWMQTT_SUB_NO_SEND_ON_SUB;
sub_opts[1].retain_as_published = true;
sub_opts[1].no_local = false;
sub_opts[2].qos = LWMQTT_QOS0;
sub_opts[2].retain_handling = LWMQTT_SUB_SEND_ON_SUB;
sub_opts[2].retain_as_published = false;
sub_opts[2].no_local = true;
sub_opts[3].qos = LWMQTT_QOS2;
sub_opts[3].retain_handling = LWMQTT_SUB_SEND_ON_SUB_NEW;
sub_opts[3].retain_as_published = false;
sub_opts[3].no_local = true;
  uint8_t bytesprops0[] = {0x29, 0x98, 0xa5, 0x50, 0x4c, 0x21, 0x1, 0xed, 0x73, 0xeb};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {10, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {1, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21007, 4, topic_filters, sub_opts, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);

}


// SubscribeResponse 6377 [Right QoS0,Right QoS0,Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS0] []
TEST(SubACK311QCTest, Decode1) {
uint8_t pkt[] = {0x90, 0x7, 0x18, 0xe9, 0x0, 0x0, 0x1, 0xa1, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 6377);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);

}


// SubscribeResponse 22342 [Left SubErrQuotaExceeded,Right QoS2,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrSharedSubscriptionsNotSupported,Right QoS1,Left SubErrTopicFilterInvalid,Right QoS0,Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS1,Right QoS0] []
TEST(SubACK311QCTest, Decode2) {
uint8_t pkt[] = {0x90, 0xd, 0x57, 0x46, 0x97, 0x2, 0xa1, 0x9e, 0x1, 0x8f, 0x0, 0x91, 0x0, 0x1, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22342);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[5], 0x80);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[7], 0x80);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[10], LWMQTT_QOS0);

}


// SubscribeResponse 20403 [Left SubErrImplementationSpecificError,Left SubErrNotAuthorized,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS1] []
TEST(SubACK311QCTest, Decode3) {
uint8_t pkt[] = {0x90, 0x6, 0x4f, 0xb3, 0x83, 0x87, 0xa1, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[4];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 4, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 20403);
EXPECT_EQ(count, 4);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);

}


// SubscribeResponse 8789 [Left SubErrUnspecifiedError,Left SubErrSharedSubscriptionsNotSupported,Left SubErrQuotaExceeded,Right QoS1,Left SubErrWildcardSubscriptionsNotSupported] []
TEST(SubACK311QCTest, Decode4) {
uint8_t pkt[] = {0x90, 0x7, 0x22, 0x55, 0x80, 0x9e, 0x97, 0x1, 0xa2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 8789);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], 0x80);

}


// SubscribeResponse 2708 [Right QoS1,Right QoS2,Right QoS0,Right QoS0,Left SubErrTopicFilterInvalid,Left SubErrWildcardSubscriptionsNotSupported,Right QoS2,Right QoS1,Right QoS1,Right QoS0,Right QoS1] []
TEST(SubACK311QCTest, Decode5) {
uint8_t pkt[] = {0x90, 0xd, 0xa, 0x94, 0x1, 0x2, 0x0, 0x0, 0x8f, 0xa2, 0x2, 0x1, 0x1, 0x0, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 2708);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], 0x80);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[10], LWMQTT_QOS1);

}


// SubscribeResponse 12793 [Left SubErrTopicFilterInvalid,Right QoS0,Right QoS0,Right QoS2,Left SubErrTopicFilterInvalid,Left SubErrWildcardSubscriptionsNotSupported,Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported] []
TEST(SubACK311QCTest, Decode6) {
uint8_t pkt[] = {0x90, 0xa, 0x31, 0xf9, 0x8f, 0x0, 0x0, 0x2, 0x8f, 0xa2, 0x1, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[8];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 8, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12793);
EXPECT_EQ(count, 8);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], 0x80);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[7], 0x80);

}


// SubscribeResponse 16851 [Left SubErrNotAuthorized] []
TEST(SubACK311QCTest, Decode7) {
uint8_t pkt[] = {0x90, 0x3, 0x41, 0xd3, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 16851);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], 0x80);

}


// SubscribeResponse 23680 [Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrTopicFilterInvalid,Left SubErrUnspecifiedError,Right QoS2,Right QoS2,Right QoS2,Right QoS1,Right QoS0,Right QoS0,Left SubErrImplementationSpecificError,Left SubErrTopicFilterInvalid] []
TEST(SubACK311QCTest, Decode8) {
uint8_t pkt[] = {0x90, 0xd, 0x5c, 0x80, 0xa1, 0x8f, 0x80, 0x2, 0x2, 0x2, 0x1, 0x0, 0x0, 0x83, 0x8f};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 23680);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[9], 0x80);
EXPECT_EQ(granted_qos_levels[10], 0x80);

}


// SubscribeResponse 7955 [Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrImplementationSpecificError,Right QoS2,Right QoS2,Left SubErrQuotaExceeded,Left SubErrImplementationSpecificError,Left SubErrNotAuthorized] []
TEST(SubACK311QCTest, Decode9) {
uint8_t pkt[] = {0x90, 0xa, 0x1f, 0x13, 0x1, 0xa1, 0x83, 0x2, 0x2, 0x97, 0x83, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[8];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 8, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 7955);
EXPECT_EQ(count, 8);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x80);
EXPECT_EQ(granted_qos_levels[6], 0x80);
EXPECT_EQ(granted_qos_levels[7], 0x80);

}


// SubscribeResponse 29704 [Right QoS2,Right QoS0,Right QoS1,Left SubErrSharedSubscriptionsNotSupported,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS0,Left SubErrSharedSubscriptionsNotSupported,Right QoS0,Right QoS2] []
TEST(SubACK311QCTest, Decode10) {
uint8_t pkt[] = {0x90, 0xb, 0x74, 0x8, 0x2, 0x0, 0x1, 0x9e, 0xa1, 0x0, 0x9e, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[9];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 9, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 29704);
EXPECT_EQ(count, 9);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[6], 0x80);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS2);

}


// SubscribeResponse 251 [Left SubErrNotAuthorized,Left SubErrNotAuthorized,Left SubErrUnspecifiedError,Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded,Right QoS2,Right QoS2] []
TEST(SubACK311QCTest, Decode11) {
uint8_t pkt[] = {0x90, 0x9, 0x0, 0xfb, 0x87, 0x87, 0x80, 0x91, 0x97, 0x2, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[7];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 7, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 251);
EXPECT_EQ(count, 7);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);

}


// SubscribeResponse 4144 [Right QoS2] []
TEST(SubACK311QCTest, Decode12) {
uint8_t pkt[] = {0x90, 0x3, 0x10, 0x30, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 4144);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);

}


// SubscribeResponse 22442 [Left SubErrWildcardSubscriptionsNotSupported,Right QoS0] []
TEST(SubACK311QCTest, Decode13) {
uint8_t pkt[] = {0x90, 0x4, 0x57, 0xaa, 0xa2, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[2];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 2, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22442);
EXPECT_EQ(count, 2);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);

}


// SubscribeResponse 5149 [Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS2,Right QoS2,Right QoS2,Left SubErrImplementationSpecificError] []
TEST(SubACK311QCTest, Decode14) {
uint8_t pkt[] = {0x90, 0x8, 0x14, 0x1d, 0x91, 0x0, 0x2, 0x2, 0x2, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 5149);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x80);

}


// SubscribeResponse 27317 [Left SubErrPacketIdentifierInUse,Left SubErrTopicFilterInvalid,Right QoS2,Right QoS0,Right QoS0,Right QoS2] []
TEST(SubACK311QCTest, Decode15) {
uint8_t pkt[] = {0x90, 0x8, 0x6a, 0xb5, 0x91, 0x8f, 0x2, 0x0, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 27317);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);

}


// SubscribeResponse 30611 [Left SubErrSubscriptionIdentifiersNotSupported,Right QoS2,Right QoS0,Right QoS2,Right QoS1] []
TEST(SubACK311QCTest, Decode16) {
uint8_t pkt[] = {0x90, 0x7, 0x77, 0x93, 0xa1, 0x2, 0x0, 0x2, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 30611);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS1);

}


// SubscribeResponse 14554 [Right QoS0,Right QoS2,Left SubErrUnspecifiedError,Right QoS0] []
TEST(SubACK311QCTest, Decode17) {
uint8_t pkt[] = {0x90, 0x6, 0x38, 0xda, 0x0, 0x2, 0x80, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[4];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 4, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 14554);
EXPECT_EQ(count, 4);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);

}


// SubscribeResponse 22626 [Right QoS2,Right QoS1,Left SubErrImplementationSpecificError,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported] []
TEST(SubACK311QCTest, Decode18) {
uint8_t pkt[] = {0x90, 0x8, 0x58, 0x62, 0x2, 0x1, 0x83, 0x2, 0x2, 0x9e};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22626);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x80);

}


// SubscribeResponse 22779 [Right QoS0] []
TEST(SubACK311QCTest, Decode19) {
uint8_t pkt[] = {0x90, 0x3, 0x58, 0xfb, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22779);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);

}


// SubscribeResponse 12719 [Left SubErrNotAuthorized,Right QoS0] []
TEST(SubACK311QCTest, Decode20) {
uint8_t pkt[] = {0x90, 0x4, 0x31, 0xaf, 0x87, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[2];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 2, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12719);
EXPECT_EQ(count, 2);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);

}


// SubscribeResponse 18524 [Right QoS2] []
TEST(SubACK311QCTest, Decode21) {
uint8_t pkt[] = {0x90, 0x3, 0x48, 0x5c, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 18524);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);

}


// SubscribeResponse 12697 [Left SubErrPacketIdentifierInUse,Left SubErrPacketIdentifierInUse,Left SubErrWildcardSubscriptionsNotSupported,Left SubErrSharedSubscriptionsNotSupported,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrNotAuthorized] []
TEST(SubACK311QCTest, Decode22) {
uint8_t pkt[] = {0x90, 0x8, 0x31, 0x99, 0x91, 0x91, 0xa2, 0x9e, 0xa1, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12697);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], 0x80);

}


// SubscribeResponse 1694 [Left SubErrSubscriptionIdentifiersNotSupported] []
TEST(SubACK311QCTest, Decode23) {
uint8_t pkt[] = {0x90, 0x3, 0x6, 0x9e, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 1694);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], 0x80);

}


// SubscribeResponse 30899 [Right QoS1] []
TEST(SubACK311QCTest, Decode24) {
uint8_t pkt[] = {0x90, 0x3, 0x78, 0xb3, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 30899);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);

}


// SubscribeResponse 15 [Left SubErrSubscriptionIdentifiersNotSupported,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported,Right QoS0,Right QoS2] []
TEST(SubACK311QCTest, Decode25) {
uint8_t pkt[] = {0x90, 0x8, 0x0, 0xf, 0xa1, 0x2, 0x2, 0x9e, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 15);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);

}


// SubscribeResponse 13923 [Right QoS2,Left SubErrNotAuthorized,Right QoS1,Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded] []
TEST(SubACK311QCTest, Decode26) {
uint8_t pkt[] = {0x90, 0x7, 0x36, 0x63, 0x2, 0x87, 0x1, 0x91, 0x97};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 13923);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0x80);
EXPECT_EQ(granted_qos_levels[4], 0x80);

}


// SubscribeResponse 6677 [Right QoS0,Right QoS1,Left SubErrImplementationSpecificError,Right QoS1,Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported,Right QoS1,Left SubErrImplementationSpecificError] []
TEST(SubACK311QCTest, Decode27) {
uint8_t pkt[] = {0x90, 0xd, 0x1a, 0x15, 0x0, 0x1, 0x83, 0x1, 0x91, 0x0, 0x2, 0x2, 0x9e, 0x1, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 6677);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], 0x80);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[8], 0x80);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[10], 0x80);

}


// SubscribeResponse 12919 [Right QoS2,Left SubErrPacketIdentifierInUse,Right QoS1,Right QoS0,Left SubErrSubscriptionIdentifiersNotSupported] []
TEST(SubACK311QCTest, Decode28) {
uint8_t pkt[] = {0x90, 0x7, 0x32, 0x77, 0x2, 0x91, 0x1, 0x0, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12919);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0x80);

}


// SubscribeResponse 20520 [Right QoS1,Right QoS0,Left SubErrNotAuthorized,Right QoS0,Left SubErrImplementationSpecificError] []
TEST(SubACK311QCTest, Decode29) {
uint8_t pkt[] = {0x90, 0x7, 0x50, 0x28, 0x1, 0x0, 0x87, 0x0, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 20520);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0x80);

}


// SubscribeResponse 2699 [Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded,Left SubErrQuotaExceeded,Right QoS1,Right QoS0,Left SubErrQuotaExceeded] []
TEST(SubACK311QCTest, Decode30) {
uint8_t pkt[] = {0x90, 0x8, 0xa, 0x8b, 0x91, 0x97, 0x97, 0x1, 0x0, 0x97};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT311, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 2699);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x80);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], 0x80);

}


// SubscribeResponse 6377 [Right QoS0,Right QoS0,Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS0] [PropWillDelayInterval 21552,PropWildcardSubscriptionAvailable 199,PropSubscriptionIdentifier 16,PropReasonString "~\139kfO\DLE\184\199\&5\177\154\234\203\188\163\206",PropServerReference "\ETBh\139\164\232\250",PropRequestResponseInformation 83,PropWildcardSubscriptionAvailable 103,PropServerReference "\159Y\158\204\&7\ESC\236\228\151\187",PropTopicAlias 32755,PropTopicAlias 18713,PropServerKeepAlive 19773,PropContentType "\255\FSX9Vv\192\v#\v\245\226\219\162\254~\144$@\168?\214rb\222\DC3\155G\246!",PropRequestProblemInformation 125,PropAuthenticationData "z\190G`?\204\173\184\237\209\162y,\242\ESC\141\EMU\144\243\211\222\243@",PropCorrelationData "\249\164B\149\210H\177D\179\170\219\174\254\171\249\193>\235S1L",PropServerKeepAlive 25850,PropRequestProblemInformation 60,PropAuthenticationMethod "\230\241\255QY-\t\214\EOTR#CsI\246\140\158T\140\235\186\DC4\CAN\n<\ACK",PropResponseInformation "n\223/\ETX({\SO\v\203\"\189\234Bi1\239\STX",PropMessageExpiryInterval 13351,PropReasonString "\181\239D\145%\195.n\163P)\199\142\205\206\246P\STX\204B\246\222\169\219",PropWillDelayInterval 28861,PropReasonString "(\SI\239\225\129\231>\136r\214.\190",PropSubscriptionIdentifierAvailable 235,PropMessageExpiryInterval 16397,PropResponseTopic "\US\NAK\163\143",PropAuthenticationMethod "yx6%\165|\156\129\215\DLE\FSe\208|\128\146C\198",PropMaximumQoS 172]
TEST(SubACK5QCTest, Decode1) {
uint8_t pkt[] = {0x90, 0xad, 0x2, 0x18, 0xe9, 0xa4, 0x2, 0x18, 0x0, 0x0, 0x54, 0x30, 0x28, 0xc7, 0xb, 0x10, 0x1f, 0x0, 0x10, 0x7e, 0x8b, 0x6b, 0x66, 0x4f, 0x10, 0xb8, 0xc7, 0x35, 0xb1, 0x9a, 0xea, 0xcb, 0xbc, 0xa3, 0xce, 0x1c, 0x0, 0x6, 0x17, 0x68, 0x8b, 0xa4, 0xe8, 0xfa, 0x19, 0x53, 0x28, 0x67, 0x1c, 0x0, 0xa, 0x9f, 0x59, 0x9e, 0xcc, 0x37, 0x1b, 0xec, 0xe4, 0x97, 0xbb, 0x23, 0x7f, 0xf3, 0x23, 0x49, 0x19, 0x13, 0x4d, 0x3d, 0x3, 0x0, 0x1e, 0xff, 0x1c, 0x58, 0x39, 0x56, 0x76, 0xc0, 0xb, 0x23, 0xb, 0xf5, 0xe2, 0xdb, 0xa2, 0xfe, 0x7e, 0x90, 0x24, 0x40, 0xa8, 0x3f, 0xd6, 0x72, 0x62, 0xde, 0x13, 0x9b, 0x47, 0xf6, 0x21, 0x17, 0x7d, 0x16, 0x0, 0x18, 0x7a, 0xbe, 0x47, 0x60, 0x3f, 0xcc, 0xad, 0xb8, 0xed, 0xd1, 0xa2, 0x79, 0x2c, 0xf2, 0x1b, 0x8d, 0x19, 0x55, 0x90, 0xf3, 0xd3, 0xde, 0xf3, 0x40, 0x9, 0x0, 0x15, 0xf9, 0xa4, 0x42, 0x95, 0xd2, 0x48, 0xb1, 0x44, 0xb3, 0xaa, 0xdb, 0xae, 0xfe, 0xab, 0xf9, 0xc1, 0x3e, 0xeb, 0x53, 0x31, 0x4c, 0x13, 0x64, 0xfa, 0x17, 0x3c, 0x15, 0x0, 0x1a, 0xe6, 0xf1, 0xff, 0x51, 0x59, 0x2d, 0x9, 0xd6, 0x4, 0x52, 0x23, 0x43, 0x73, 0x49, 0xf6, 0x8c, 0x9e, 0x54, 0x8c, 0xeb, 0xba, 0x14, 0x18, 0xa, 0x3c, 0x6, 0x1a, 0x0, 0x11, 0x6e, 0xdf, 0x2f, 0x3, 0x28, 0x7b, 0xe, 0xb, 0xcb, 0x22, 0xbd, 0xea, 0x42, 0x69, 0x31, 0xef, 0x2, 0x2, 0x0, 0x0, 0x34, 0x27, 0x1f, 0x0, 0x18, 0xb5, 0xef, 0x44, 0x91, 0x25, 0xc3, 0x2e, 0x6e, 0xa3, 0x50, 0x29, 0xc7, 0x8e, 0xcd, 0xce, 0xf6, 0x50, 0x2, 0xcc, 0x42, 0xf6, 0xde, 0xa9, 0xdb, 0x18, 0x0, 0x0, 0x70, 0xbd, 0x1f, 0x0, 0xc, 0x28, 0xf, 0xef, 0xe1, 0x81, 0xe7, 0x3e, 0x88, 0x72, 0xd6, 0x2e, 0xbe, 0x29, 0xeb, 0x2, 0x0, 0x0, 0x40, 0xd, 0x8, 0x0, 0x4, 0x1f, 0x15, 0xa3, 0x8f, 0x15, 0x0, 0x12, 0x79, 0x78, 0x36, 0x25, 0xa5, 0x7c, 0x9c, 0x81, 0xd7, 0x10, 0x1c, 0x65, 0xd0, 0x7c, 0x80, 0x92, 0x43, 0xc6, 0x24, 0xac, 0x0, 0x0, 0x1, 0xa1, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 6377);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0xA1);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);

}


// SubscribeResponse 22342 [Left SubErrQuotaExceeded,Right QoS2,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrSharedSubscriptionsNotSupported,Right QoS1,Left SubErrTopicFilterInvalid,Right QoS0,Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS1,Right QoS0] [PropRetainAvailable 40,PropMessageExpiryInterval 30950,PropServerKeepAlive 31863,PropResponseTopic "\222x\188\&6!\172\253\138\155%\239(l8\147#\175\&4\195*\155l\240",PropAssignedClientIdentifier "\164w\200(\168Z\134\186\138\&1\254>\236\234\212E\151\215\144\142",PropPayloadFormatIndicator 49,PropUserProperty "f\250\132\NUL\229q\185\172 \132" "$\US",PropReasonString "*!\201\223\197s\135\213k\156\190\186H\SUB\164o\242\&2\ACK\221\SOH[U}\183\179\232\239\172",PropSessionExpiryInterval 12524,PropResponseInformation "\224\155\178\155\234f",PropTopicAlias 25820,PropMessageExpiryInterval 11088,PropUserProperty "\173!\US\234\f#j32" "\GSJ+I\189]\206\240\160\156D"]
TEST(SubACK5QCTest, Decode2) {
uint8_t pkt[] = {0x90, 0xac, 0x1, 0x57, 0x46, 0x9d, 0x1, 0x25, 0x28, 0x2, 0x0, 0x0, 0x78, 0xe6, 0x13, 0x7c, 0x77, 0x8, 0x0, 0x17, 0xde, 0x78, 0xbc, 0x36, 0x21, 0xac, 0xfd, 0x8a, 0x9b, 0x25, 0xef, 0x28, 0x6c, 0x38, 0x93, 0x23, 0xaf, 0x34, 0xc3, 0x2a, 0x9b, 0x6c, 0xf0, 0x12, 0x0, 0x14, 0xa4, 0x77, 0xc8, 0x28, 0xa8, 0x5a, 0x86, 0xba, 0x8a, 0x31, 0xfe, 0x3e, 0xec, 0xea, 0xd4, 0x45, 0x97, 0xd7, 0x90, 0x8e, 0x1, 0x31, 0x26, 0x0, 0xa, 0x66, 0xfa, 0x84, 0x0, 0xe5, 0x71, 0xb9, 0xac, 0x20, 0x84, 0x0, 0x2, 0x24, 0x1f, 0x1f, 0x0, 0x1d, 0x2a, 0x21, 0xc9, 0xdf, 0xc5, 0x73, 0x87, 0xd5, 0x6b, 0x9c, 0xbe, 0xba, 0x48, 0x1a, 0xa4, 0x6f, 0xf2, 0x32, 0x6, 0xdd, 0x1, 0x5b, 0x55, 0x7d, 0xb7, 0xb3, 0xe8, 0xef, 0xac, 0x11, 0x0, 0x0, 0x30, 0xec, 0x1a, 0x0, 0x6, 0xe0, 0x9b, 0xb2, 0x9b, 0xea, 0x66, 0x23, 0x64, 0xdc, 0x2, 0x0, 0x0, 0x2b, 0x50, 0x26, 0x0, 0x9, 0xad, 0x21, 0x1f, 0xea, 0xc, 0x23, 0x6a, 0x33, 0x32, 0x0, 0xb, 0x1d, 0x4a, 0x2b, 0x49, 0xbd, 0x5d, 0xce, 0xf0, 0xa0, 0x9c, 0x44, 0x97, 0x2, 0xa1, 0x9e, 0x1, 0x8f, 0x0, 0x91, 0x0, 0x1, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22342);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], 0x97);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], 0xA1);
EXPECT_EQ(granted_qos_levels[3], 0x9E);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[5], 0x8F);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[7], 0x91);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[10], LWMQTT_QOS0);

}


// SubscribeResponse 20403 [Left SubErrImplementationSpecificError,Left SubErrNotAuthorized,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS1] [PropSharedSubscriptionAvailable 232,PropRequestProblemInformation 75,PropResponseInformation "\201\208\FS0\215\215~\DC1\141\142^\214s\202z\245rb\246\240//",PropReceiveMaximum 32008,PropSubscriptionIdentifierAvailable 248,PropReasonString "]\205Ugu\148\255i\230\195C\240",PropCorrelationData "\132'\nD\vRv\141\&1\224\220\233;\145\&1eJI\164\225\144\148\230\131\231\&7",PropUserProperty "\160\213\RS-S\171\171W\241\206\239\137\ENQ\b\229\&8\229r\182\ESC+\157\\\148m5\227@g\142" "\STX?nttV\255C<%\SUB\135\225\237",PropAuthenticationMethod "\SUB\223\177\189x\208\194\164\&1f_\ETB3\168VOx\157\172",PropReceiveMaximum 9817,PropSubscriptionIdentifierAvailable 127,PropAuthenticationMethod "\253e\EMx+\147K+u\RSQU\173\194\145x7d+(\241\152\CANmk\NUL\179",PropMaximumQoS 70,PropSessionExpiryInterval 14477,PropAssignedClientIdentifier "Y\141\ENQ\251\160\244f\154\&8yv\174\177\DEL/\202\"\189\143\185J",PropPayloadFormatIndicator 111,PropMessageExpiryInterval 21491,PropRequestProblemInformation 109,PropSessionExpiryInterval 24691,PropCorrelationData "",PropMaximumPacketSize 10757,PropContentType "",PropWildcardSubscriptionAvailable 136]
TEST(SubACK5QCTest, Decode3) {
uint8_t pkt[] = {0x90, 0xfa, 0x1, 0x4f, 0xb3, 0xf2, 0x1, 0x2a, 0xe8, 0x17, 0x4b, 0x1a, 0x0, 0x16, 0xc9, 0xd0, 0x1c, 0x30, 0xd7, 0xd7, 0x7e, 0x11, 0x8d, 0x8e, 0x5e, 0xd6, 0x73, 0xca, 0x7a, 0xf5, 0x72, 0x62, 0xf6, 0xf0, 0x2f, 0x2f, 0x21, 0x7d, 0x8, 0x29, 0xf8, 0x1f, 0x0, 0xc, 0x5d, 0xcd, 0x55, 0x67, 0x75, 0x94, 0xff, 0x69, 0xe6, 0xc3, 0x43, 0xf0, 0x9, 0x0, 0x1a, 0x84, 0x27, 0xa, 0x44, 0xb, 0x52, 0x76, 0x8d, 0x31, 0xe0, 0xdc, 0xe9, 0x3b, 0x91, 0x31, 0x65, 0x4a, 0x49, 0xa4, 0xe1, 0x90, 0x94, 0xe6, 0x83, 0xe7, 0x37, 0x26, 0x0, 0x1e, 0xa0, 0xd5, 0x1e, 0x2d, 0x53, 0xab, 0xab, 0x57, 0xf1, 0xce, 0xef, 0x89, 0x5, 0x8, 0xe5, 0x38, 0xe5, 0x72, 0xb6, 0x1b, 0x2b, 0x9d, 0x5c, 0x94, 0x6d, 0x35, 0xe3, 0x40, 0x67, 0x8e, 0x0, 0xe, 0x2, 0x3f, 0x6e, 0x74, 0x74, 0x56, 0xff, 0x43, 0x3c, 0x25, 0x1a, 0x87, 0xe1, 0xed, 0x15, 0x0, 0x13, 0x1a, 0xdf, 0xb1, 0xbd, 0x78, 0xd0, 0xc2, 0xa4, 0x31, 0x66, 0x5f, 0x17, 0x33, 0xa8, 0x56, 0x4f, 0x78, 0x9d, 0xac, 0x21, 0x26, 0x59, 0x29, 0x7f, 0x15, 0x0, 0x1b, 0xfd, 0x65, 0x19, 0x78, 0x2b, 0x93, 0x4b, 0x2b, 0x75, 0x1e, 0x51, 0x55, 0xad, 0xc2, 0x91, 0x78, 0x37, 0x64, 0x2b, 0x28, 0xf1, 0x98, 0x18, 0x6d, 0x6b, 0x0, 0xb3, 0x24, 0x46, 0x11, 0x0, 0x0, 0x38, 0x8d, 0x12, 0x0, 0x15, 0x59, 0x8d, 0x5, 0xfb, 0xa0, 0xf4, 0x66, 0x9a, 0x38, 0x79, 0x76, 0xae, 0xb1, 0x7f, 0x2f, 0xca, 0x22, 0xbd, 0x8f, 0xb9, 0x4a, 0x1, 0x6f, 0x2, 0x0, 0x0, 0x53, 0xf3, 0x17, 0x6d, 0x11, 0x0, 0x0, 0x60, 0x73, 0x9, 0x0, 0x0, 0x27, 0x0, 0x0, 0x2a, 0x5, 0x3, 0x0, 0x0, 0x28, 0x88, 0x83, 0x87, 0xa1, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[4];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 4, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 20403);
EXPECT_EQ(count, 4);
EXPECT_EQ(granted_qos_levels[0], 0x83);
EXPECT_EQ(granted_qos_levels[1], 0x87);
EXPECT_EQ(granted_qos_levels[2], 0xA1);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);

}


// SubscribeResponse 8789 [Left SubErrUnspecifiedError,Left SubErrSharedSubscriptionsNotSupported,Left SubErrQuotaExceeded,Right QoS1,Left SubErrWildcardSubscriptionsNotSupported] [PropPayloadFormatIndicator 151,PropAssignedClientIdentifier "I\177\215\239\226q",PropServerReference "\RS\SYNE/\157m\NUL\133/l\ETB\138\168Spf\129,\133",PropAuthenticationData "\192\219\tc;\217,r\245V Z\190)\239\232\185\160w\SO\170\n\189\217\214sk\SUB\ETB?",PropSharedSubscriptionAvailable 245,PropResponseInformation "~R9\"\244fY\203\182\137:\194\183\&3`\ACK\170\245\226\164",PropMaximumPacketSize 26769,PropReasonString "R\206\163\GS,\DC4\170\247\249\139\174\188\138\147I\180\&5\t\b\143\250\134\132\255b\180\223c\211\238",PropContentType "\\\215\138\196\229hF%=\246\152\168e\138\a'P}\227rA#\211n\156",PropUserProperty "|f\176\f\162\196\168s\148\182+\171<C\245\SUB\CAN\151\b.\177'\157,\239\244W\188U\227" ";yK\234'\254\&6\154>\183\208\142\224\157x+ z\217\US\128\159\215u\NAK",PropRequestProblemInformation 184,PropMessageExpiryInterval 21818,PropReasonString "\"\245\214\SI\147\180nJUX\205O\231\144\155\CAN)\184\205c\157P\US\234\246\n\203\235bn",PropAuthenticationMethod "A^o\DEL/6\180\163(\248\242\153y\218\STXp\201-\n",PropRequestProblemInformation 184,PropResponseInformation ""]
TEST(SubACK5QCTest, Decode4) {
uint8_t pkt[] = {0x90, 0xa5, 0x2, 0x22, 0x55, 0x9c, 0x2, 0x1, 0x97, 0x12, 0x0, 0x6, 0x49, 0xb1, 0xd7, 0xef, 0xe2, 0x71, 0x1c, 0x0, 0x13, 0x1e, 0x16, 0x45, 0x2f, 0x9d, 0x6d, 0x0, 0x85, 0x2f, 0x6c, 0x17, 0x8a, 0xa8, 0x53, 0x70, 0x66, 0x81, 0x2c, 0x85, 0x16, 0x0, 0x1e, 0xc0, 0xdb, 0x9, 0x63, 0x3b, 0xd9, 0x2c, 0x72, 0xf5, 0x56, 0x20, 0x5a, 0xbe, 0x29, 0xef, 0xe8, 0xb9, 0xa0, 0x77, 0xe, 0xaa, 0xa, 0xbd, 0xd9, 0xd6, 0x73, 0x6b, 0x1a, 0x17, 0x3f, 0x2a, 0xf5, 0x1a, 0x0, 0x14, 0x7e, 0x52, 0x39, 0x22, 0xf4, 0x66, 0x59, 0xcb, 0xb6, 0x89, 0x3a, 0xc2, 0xb7, 0x33, 0x60, 0x6, 0xaa, 0xf5, 0xe2, 0xa4, 0x27, 0x0, 0x0, 0x68, 0x91, 0x1f, 0x0, 0x1e, 0x52, 0xce, 0xa3, 0x1d, 0x2c, 0x14, 0xaa, 0xf7, 0xf9, 0x8b, 0xae, 0xbc, 0x8a, 0x93, 0x49, 0xb4, 0x35, 0x9, 0x8, 0x8f, 0xfa, 0x86, 0x84, 0xff, 0x62, 0xb4, 0xdf, 0x63, 0xd3, 0xee, 0x3, 0x0, 0x19, 0x5c, 0xd7, 0x8a, 0xc4, 0xe5, 0x68, 0x46, 0x25, 0x3d, 0xf6, 0x98, 0xa8, 0x65, 0x8a, 0x7, 0x27, 0x50, 0x7d, 0xe3, 0x72, 0x41, 0x23, 0xd3, 0x6e, 0x9c, 0x26, 0x0, 0x1e, 0x7c, 0x66, 0xb0, 0xc, 0xa2, 0xc4, 0xa8, 0x73, 0x94, 0xb6, 0x2b, 0xab, 0x3c, 0x43, 0xf5, 0x1a, 0x18, 0x97, 0x8, 0x2e, 0xb1, 0x27, 0x9d, 0x2c, 0xef, 0xf4, 0x57, 0xbc, 0x55, 0xe3, 0x0, 0x19, 0x3b, 0x79, 0x4b, 0xea, 0x27, 0xfe, 0x36, 0x9a, 0x3e, 0xb7, 0xd0, 0x8e, 0xe0, 0x9d, 0x78, 0x2b, 0x20, 0x7a, 0xd9, 0x1f, 0x80, 0x9f, 0xd7, 0x75, 0x15, 0x17, 0xb8, 0x2, 0x0, 0x0, 0x55, 0x3a, 0x1f, 0x0, 0x1e, 0x22, 0xf5, 0xd6, 0xf, 0x93, 0xb4, 0x6e, 0x4a, 0x55, 0x58, 0xcd, 0x4f, 0xe7, 0x90, 0x9b, 0x18, 0x29, 0xb8, 0xcd, 0x63, 0x9d, 0x50, 0x1f, 0xea, 0xf6, 0xa, 0xcb, 0xeb, 0x62, 0x6e, 0x15, 0x0, 0x13, 0x41, 0x5e, 0x6f, 0x7f, 0x2f, 0x36, 0xb4, 0xa3, 0x28, 0xf8, 0xf2, 0x99, 0x79, 0xda, 0x2, 0x70, 0xc9, 0x2d, 0xa, 0x17, 0xb8, 0x1a, 0x0, 0x0, 0x80, 0x9e, 0x97, 0x1, 0xa2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 8789);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], 0x80);
EXPECT_EQ(granted_qos_levels[1], 0x9E);
EXPECT_EQ(granted_qos_levels[2], 0x97);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], 0xA2);

}


// SubscribeResponse 2708 [Right QoS1,Right QoS2,Right QoS0,Right QoS0,Left SubErrTopicFilterInvalid,Left SubErrWildcardSubscriptionsNotSupported,Right QoS2,Right QoS1,Right QoS1,Right QoS0,Right QoS1] [PropAuthenticationData "\137&t\240\241\CAN\201\212\173\255t\tyG\245\189\157!@\193Y\ENQ%a\237\133",PropMaximumPacketSize 1523]
TEST(SubACK5QCTest, Decode5) {
uint8_t pkt[] = {0x90, 0x30, 0xa, 0x94, 0x22, 0x16, 0x0, 0x1a, 0x89, 0x26, 0x74, 0xf0, 0xf1, 0x18, 0xc9, 0xd4, 0xad, 0xff, 0x74, 0x9, 0x79, 0x47, 0xf5, 0xbd, 0x9d, 0x21, 0x40, 0xc1, 0x59, 0x5, 0x25, 0x61, 0xed, 0x85, 0x27, 0x0, 0x0, 0x5, 0xf3, 0x1, 0x2, 0x0, 0x0, 0x8f, 0xa2, 0x2, 0x1, 0x1, 0x0, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 2708);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0x8F);
EXPECT_EQ(granted_qos_levels[5], 0xA2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[10], LWMQTT_QOS1);

}


// SubscribeResponse 12793 [Left SubErrTopicFilterInvalid,Right QoS0,Right QoS0,Right QoS2,Left SubErrTopicFilterInvalid,Left SubErrWildcardSubscriptionsNotSupported,Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported] [PropUserProperty "\SO3\200y\203\r\DC2\208\DLE9v\r\152Q-\167\&8\187}\ACK\NUL" "\129\&5",PropCorrelationData "\139f\SOH\245\STX\169\238^r\229hV\206\180",PropWillDelayInterval 16972,PropSubscriptionIdentifier 27,PropRequestProblemInformation 54,PropAuthenticationMethod "J\175\145\EOT\225L\241f`GZ\US\CANnj\129s\139+\238\245R",PropUserProperty "\146\226\170\198\238\ETX\216\191M\203\236l\131\217x7J\150\226" "|\244\ETBe#\CAN\206\173\168\250\245\SO\221J\SI\248b\248\232\177;\242\155",PropRequestResponseInformation 193,PropResponseTopic "`\132\189\196\203\224\128\252\SO\166\252`f\GS\172\SOQ\DC2\216\220\SO<u\227\\\128\156\238",PropAuthenticationMethod "\158Dd\SI\DC2_20\SO\138\n\222\DC2\241\229^i\177\DC3",PropResponseTopic "H",PropRequestProblemInformation 121,PropMaximumQoS 93,PropTopicAliasMaximum 28716,PropResponseInformation "\249\SUB\252\214$\156[|L\224HX\f+\DC2%c",PropRequestResponseInformation 227,PropAuthenticationData "\181\215R$\216u4\NULT\138\216\146\201#\210J\222\178,J\242",PropAuthenticationData "\200\177I\172mW\142\222"]
TEST(SubACK5QCTest, Decode6) {
uint8_t pkt[] = {0x90, 0x85, 0x2, 0x31, 0xf9, 0xf9, 0x1, 0x26, 0x0, 0x15, 0xe, 0x33, 0xc8, 0x79, 0xcb, 0xd, 0x12, 0xd0, 0x10, 0x39, 0x76, 0xd, 0x98, 0x51, 0x2d, 0xa7, 0x38, 0xbb, 0x7d, 0x6, 0x0, 0x0, 0x2, 0x81, 0x35, 0x9, 0x0, 0xe, 0x8b, 0x66, 0x1, 0xf5, 0x2, 0xa9, 0xee, 0x5e, 0x72, 0xe5, 0x68, 0x56, 0xce, 0xb4, 0x18, 0x0, 0x0, 0x42, 0x4c, 0xb, 0x1b, 0x17, 0x36, 0x15, 0x0, 0x16, 0x4a, 0xaf, 0x91, 0x4, 0xe1, 0x4c, 0xf1, 0x66, 0x60, 0x47, 0x5a, 0x1f, 0x18, 0x6e, 0x6a, 0x81, 0x73, 0x8b, 0x2b, 0xee, 0xf5, 0x52, 0x26, 0x0, 0x13, 0x92, 0xe2, 0xaa, 0xc6, 0xee, 0x3, 0xd8, 0xbf, 0x4d, 0xcb, 0xec, 0x6c, 0x83, 0xd9, 0x78, 0x37, 0x4a, 0x96, 0xe2, 0x0, 0x17, 0x7c, 0xf4, 0x17, 0x65, 0x23, 0x18, 0xce, 0xad, 0xa8, 0xfa, 0xf5, 0xe, 0xdd, 0x4a, 0xf, 0xf8, 0x62, 0xf8, 0xe8, 0xb1, 0x3b, 0xf2, 0x9b, 0x19, 0xc1, 0x8, 0x0, 0x1c, 0x60, 0x84, 0xbd, 0xc4, 0xcb, 0xe0, 0x80, 0xfc, 0xe, 0xa6, 0xfc, 0x60, 0x66, 0x1d, 0xac, 0xe, 0x51, 0x12, 0xd8, 0xdc, 0xe, 0x3c, 0x75, 0xe3, 0x5c, 0x80, 0x9c, 0xee, 0x15, 0x0, 0x13, 0x9e, 0x44, 0x64, 0xf, 0x12, 0x5f, 0x32, 0x30, 0xe, 0x8a, 0xa, 0xde, 0x12, 0xf1, 0xe5, 0x5e, 0x69, 0xb1, 0x13, 0x8, 0x0, 0x1, 0x48, 0x17, 0x79, 0x24, 0x5d, 0x22, 0x70, 0x2c, 0x1a, 0x0, 0x11, 0xf9, 0x1a, 0xfc, 0xd6, 0x24, 0x9c, 0x5b, 0x7c, 0x4c, 0xe0, 0x48, 0x58, 0xc, 0x2b, 0x12, 0x25, 0x63, 0x19, 0xe3, 0x16, 0x0, 0x15, 0xb5, 0xd7, 0x52, 0x24, 0xd8, 0x75, 0x34, 0x0, 0x54, 0x8a, 0xd8, 0x92, 0xc9, 0x23, 0xd2, 0x4a, 0xde, 0xb2, 0x2c, 0x4a, 0xf2, 0x16, 0x0, 0x8, 0xc8, 0xb1, 0x49, 0xac, 0x6d, 0x57, 0x8e, 0xde, 0x8f, 0x0, 0x0, 0x2, 0x8f, 0xa2, 0x1, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[8];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 8, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12793);
EXPECT_EQ(count, 8);
EXPECT_EQ(granted_qos_levels[0], 0x8F);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], 0x8F);
EXPECT_EQ(granted_qos_levels[5], 0xA2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[7], 0xA1);

}


// SubscribeResponse 16851 [Left SubErrNotAuthorized] []
TEST(SubACK5QCTest, Decode7) {
uint8_t pkt[] = {0x90, 0x4, 0x41, 0xd3, 0x0, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 16851);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], 0x87);

}


// SubscribeResponse 23680 [Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrTopicFilterInvalid,Left SubErrUnspecifiedError,Right QoS2,Right QoS2,Right QoS2,Right QoS1,Right QoS0,Right QoS0,Left SubErrImplementationSpecificError,Left SubErrTopicFilterInvalid] [PropMaximumPacketSize 17575,PropPayloadFormatIndicator 63,PropRequestResponseInformation 132,PropRetainAvailable 56,PropAuthenticationMethod "c\158{L\FS\156\205\FS\DC4\211z\DC1M{\228\176\217\240\250\253\DC3",PropAssignedClientIdentifier " +\249\238\206$\183{-\US\137\141\168\230\207\195h\r\213n\152\136\191\148\156\141\236]",PropMaximumQoS 99,PropMessageExpiryInterval 4989,PropAuthenticationMethod "B\242M\ENQ\213U\142\ESCi\225RI'\165\229\to\137\141nC\ETX\DC2dx\146j9\161\DC4",PropMaximumPacketSize 25575,PropWildcardSubscriptionAvailable 52,PropTopicAliasMaximum 24375,PropMaximumQoS 77,PropRetainAvailable 133,PropRequestProblemInformation 26,PropAuthenticationMethod "\160H\211\SUB\250\r\DC3\184\192\178\149W\163\tE\RS\163\143\237\202\247T\129\240M\177",PropMessageExpiryInterval 18725,PropServerReference "\168\138Y^w\"\rs?\209S@\243\194\185\233\183@\154T ",PropMessageExpiryInterval 27739,PropRequestProblemInformation 32,PropSubscriptionIdentifier 10,PropPayloadFormatIndicator 115,PropAssignedClientIdentifier "\185R\255\NAK\231",PropReceiveMaximum 24855,PropMessageExpiryInterval 21157,PropContentType "r)\216\186\176\248\128\188R)h\142",PropWillDelayInterval 23367,PropAssignedClientIdentifier "\152i\142\214BZ!\r-\251\147\164#\246\157\208e\156\146\199\EM\227E8\234\GS",PropRequestProblemInformation 37,PropResponseTopic "\255\ETX\229\247rw\SIf\DC3\201\172\228\139\191s\223\240\US\NUL7\\{"]
TEST(SubACK5QCTest, Decode8) {
uint8_t pkt[] = {0x90, 0xaa, 0x2, 0x5c, 0x80, 0x9b, 0x2, 0x27, 0x0, 0x0, 0x44, 0xa7, 0x1, 0x3f, 0x19, 0x84, 0x25, 0x38, 0x15, 0x0, 0x15, 0x63, 0x9e, 0x7b, 0x4c, 0x1c, 0x9c, 0xcd, 0x1c, 0x14, 0xd3, 0x7a, 0x11, 0x4d, 0x7b, 0xe4, 0xb0, 0xd9, 0xf0, 0xfa, 0xfd, 0x13, 0x12, 0x0, 0x1c, 0x20, 0x2b, 0xf9, 0xee, 0xce, 0x24, 0xb7, 0x7b, 0x2d, 0x1f, 0x89, 0x8d, 0xa8, 0xe6, 0xcf, 0xc3, 0x68, 0xd, 0xd5, 0x6e, 0x98, 0x88, 0xbf, 0x94, 0x9c, 0x8d, 0xec, 0x5d, 0x24, 0x63, 0x2, 0x0, 0x0, 0x13, 0x7d, 0x15, 0x0, 0x1e, 0x42, 0xf2, 0x4d, 0x5, 0xd5, 0x55, 0x8e, 0x1b, 0x69, 0xe1, 0x52, 0x49, 0x27, 0xa5, 0xe5, 0x9, 0x6f, 0x89, 0x8d, 0x6e, 0x43, 0x3, 0x12, 0x64, 0x78, 0x92, 0x6a, 0x39, 0xa1, 0x14, 0x27, 0x0, 0x0, 0x63, 0xe7, 0x28, 0x34, 0x22, 0x5f, 0x37, 0x24, 0x4d, 0x25, 0x85, 0x17, 0x1a, 0x15, 0x0, 0x1a, 0xa0, 0x48, 0xd3, 0x1a, 0xfa, 0xd, 0x13, 0xb8, 0xc0, 0xb2, 0x95, 0x57, 0xa3, 0x9, 0x45, 0x1e, 0xa3, 0x8f, 0xed, 0xca, 0xf7, 0x54, 0x81, 0xf0, 0x4d, 0xb1, 0x2, 0x0, 0x0, 0x49, 0x25, 0x1c, 0x0, 0x15, 0xa8, 0x8a, 0x59, 0x5e, 0x77, 0x22, 0xd, 0x73, 0x3f, 0xd1, 0x53, 0x40, 0xf3, 0xc2, 0xb9, 0xe9, 0xb7, 0x40, 0x9a, 0x54, 0x20, 0x2, 0x0, 0x0, 0x6c, 0x5b, 0x17, 0x20, 0xb, 0xa, 0x1, 0x73, 0x12, 0x0, 0x5, 0xb9, 0x52, 0xff, 0x15, 0xe7, 0x21, 0x61, 0x17, 0x2, 0x0, 0x0, 0x52, 0xa5, 0x3, 0x0, 0xc, 0x72, 0x29, 0xd8, 0xba, 0xb0, 0xf8, 0x80, 0xbc, 0x52, 0x29, 0x68, 0x8e, 0x18, 0x0, 0x0, 0x5b, 0x47, 0x12, 0x0, 0x1a, 0x98, 0x69, 0x8e, 0xd6, 0x42, 0x5a, 0x21, 0xd, 0x2d, 0xfb, 0x93, 0xa4, 0x23, 0xf6, 0x9d, 0xd0, 0x65, 0x9c, 0x92, 0xc7, 0x19, 0xe3, 0x45, 0x38, 0xea, 0x1d, 0x17, 0x25, 0x8, 0x0, 0x16, 0xff, 0x3, 0xe5, 0xf7, 0x72, 0x77, 0xf, 0x66, 0x13, 0xc9, 0xac, 0xe4, 0x8b, 0xbf, 0x73, 0xdf, 0xf0, 0x1f, 0x0, 0x37, 0x5c, 0x7b, 0xa1, 0x8f, 0x80, 0x2, 0x2, 0x2, 0x1, 0x0, 0x0, 0x83, 0x8f};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 23680);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], 0xA1);
EXPECT_EQ(granted_qos_levels[1], 0x8F);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[9], 0x83);
EXPECT_EQ(granted_qos_levels[10], 0x8F);

}


// SubscribeResponse 7955 [Right QoS1,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrImplementationSpecificError,Right QoS2,Right QoS2,Left SubErrQuotaExceeded,Left SubErrImplementationSpecificError,Left SubErrNotAuthorized] [PropMaximumQoS 6,PropReasonString "o6\153\STX;\ETB\253\235\&5\SOx\164oGpw$\200\SO\199\234\154\220`\246\249\139"]
TEST(SubACK5QCTest, Decode9) {
uint8_t pkt[] = {0x90, 0x2b, 0x1f, 0x13, 0x20, 0x24, 0x6, 0x1f, 0x0, 0x1b, 0x6f, 0x36, 0x99, 0x2, 0x3b, 0x17, 0xfd, 0xeb, 0x35, 0xe, 0x78, 0xa4, 0x6f, 0x47, 0x70, 0x77, 0x24, 0xc8, 0xe, 0xc7, 0xea, 0x9a, 0xdc, 0x60, 0xf6, 0xf9, 0x8b, 0x1, 0xa1, 0x83, 0x2, 0x2, 0x97, 0x83, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[8];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 8, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 7955);
EXPECT_EQ(count, 8);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], 0xA1);
EXPECT_EQ(granted_qos_levels[2], 0x83);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x97);
EXPECT_EQ(granted_qos_levels[6], 0x83);
EXPECT_EQ(granted_qos_levels[7], 0x87);

}


// SubscribeResponse 29704 [Right QoS2,Right QoS0,Right QoS1,Left SubErrSharedSubscriptionsNotSupported,Left SubErrSubscriptionIdentifiersNotSupported,Right QoS0,Left SubErrSharedSubscriptionsNotSupported,Right QoS0,Right QoS2] [PropPayloadFormatIndicator 87,PropResponseTopic "N@\239\NUL\194\178\150\SUB\200>\182\255\SYN",PropServerKeepAlive 19627,PropMaximumPacketSize 8916,PropSubscriptionIdentifier 21,PropAssignedClientIdentifier "\158\t\SYN)H\153\&0\230?\NAK\DC4",PropPayloadFormatIndicator 209,PropAssignedClientIdentifier "\185\162+\152JG\200(\162&",PropServerReference "\164\195\DC2\249J\NUL\191\136\138_\137r\241\\\211\236'\n8\200\160Wb\147\172\196\SYN\221",PropSessionExpiryInterval 28997,PropMessageExpiryInterval 8313,PropUserProperty "\200\189\192\FS\240\DC29\138\249\238\NULX\165" "\SYN\STX\233I\245s\183\232xW\207\&5\254\139\228O\SOH\CAN>\138&\244\vy\226\155#\DC1\165",PropTopicAliasMaximum 24813,PropRequestProblemInformation 181,PropResponseTopic "\DC28\202\175\242\US\226\166\244\142\DEL\144\234}",PropSessionExpiryInterval 19284,PropMaximumQoS 251,PropResponseInformation "q\242\NUL -\210?@lk",PropUserProperty "\STX\211\252\225\139\&7\159\198\fl7i\132\254:$\249\153\237^\221L\194Sq\"\t\DC1" "\129`m\145\225\252-",PropWillDelayInterval 11295,PropMaximumQoS 2]
TEST(SubACK5QCTest, Decode10) {
uint8_t pkt[] = {0x90, 0xf7, 0x1, 0x74, 0x8, 0xea, 0x1, 0x1, 0x57, 0x8, 0x0, 0xd, 0x4e, 0x40, 0xef, 0x0, 0xc2, 0xb2, 0x96, 0x1a, 0xc8, 0x3e, 0xb6, 0xff, 0x16, 0x13, 0x4c, 0xab, 0x27, 0x0, 0x0, 0x22, 0xd4, 0xb, 0x15, 0x12, 0x0, 0xb, 0x9e, 0x9, 0x16, 0x29, 0x48, 0x99, 0x30, 0xe6, 0x3f, 0x15, 0x14, 0x1, 0xd1, 0x12, 0x0, 0xa, 0xb9, 0xa2, 0x2b, 0x98, 0x4a, 0x47, 0xc8, 0x28, 0xa2, 0x26, 0x1c, 0x0, 0x1c, 0xa4, 0xc3, 0x12, 0xf9, 0x4a, 0x0, 0xbf, 0x88, 0x8a, 0x5f, 0x89, 0x72, 0xf1, 0x5c, 0xd3, 0xec, 0x27, 0xa, 0x38, 0xc8, 0xa0, 0x57, 0x62, 0x93, 0xac, 0xc4, 0x16, 0xdd, 0x11, 0x0, 0x0, 0x71, 0x45, 0x2, 0x0, 0x0, 0x20, 0x79, 0x26, 0x0, 0xd, 0xc8, 0xbd, 0xc0, 0x1c, 0xf0, 0x12, 0x39, 0x8a, 0xf9, 0xee, 0x0, 0x58, 0xa5, 0x0, 0x1d, 0x16, 0x2, 0xe9, 0x49, 0xf5, 0x73, 0xb7, 0xe8, 0x78, 0x57, 0xcf, 0x35, 0xfe, 0x8b, 0xe4, 0x4f, 0x1, 0x18, 0x3e, 0x8a, 0x26, 0xf4, 0xb, 0x79, 0xe2, 0x9b, 0x23, 0x11, 0xa5, 0x22, 0x60, 0xed, 0x17, 0xb5, 0x8, 0x0, 0xe, 0x12, 0x38, 0xca, 0xaf, 0xf2, 0x1f, 0xe2, 0xa6, 0xf4, 0x8e, 0x7f, 0x90, 0xea, 0x7d, 0x11, 0x0, 0x0, 0x4b, 0x54, 0x24, 0xfb, 0x1a, 0x0, 0xa, 0x71, 0xf2, 0x0, 0x20, 0x2d, 0xd2, 0x3f, 0x40, 0x6c, 0x6b, 0x26, 0x0, 0x1c, 0x2, 0xd3, 0xfc, 0xe1, 0x8b, 0x37, 0x9f, 0xc6, 0xc, 0x6c, 0x37, 0x69, 0x84, 0xfe, 0x3a, 0x24, 0xf9, 0x99, 0xed, 0x5e, 0xdd, 0x4c, 0xc2, 0x53, 0x71, 0x22, 0x9, 0x11, 0x0, 0x7, 0x81, 0x60, 0x6d, 0x91, 0xe1, 0xfc, 0x2d, 0x18, 0x0, 0x0, 0x2c, 0x1f, 0x24, 0x2, 0x2, 0x0, 0x1, 0x9e, 0xa1, 0x0, 0x9e, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[9];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 9, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 29704);
EXPECT_EQ(count, 9);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0x9E);
EXPECT_EQ(granted_qos_levels[4], 0xA1);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[6], 0x9E);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[8], LWMQTT_QOS2);

}


// SubscribeResponse 251 [Left SubErrNotAuthorized,Left SubErrNotAuthorized,Left SubErrUnspecifiedError,Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded,Right QoS2,Right QoS2] [PropTopicAliasMaximum 26597,PropAuthenticationData ";&f\172H\211\249W\230\186.\239\NUL\196X\133\&4vN\184cd\DEL\SIy\164\ETX",PropPayloadFormatIndicator 65]
TEST(SubACK5QCTest, Decode11) {
uint8_t pkt[] = {0x90, 0x2d, 0x0, 0xfb, 0x23, 0x22, 0x67, 0xe5, 0x16, 0x0, 0x1b, 0x3b, 0x26, 0x66, 0xac, 0x48, 0xd3, 0xf9, 0x57, 0xe6, 0xba, 0x2e, 0xef, 0x0, 0xc4, 0x58, 0x85, 0x34, 0x76, 0x4e, 0xb8, 0x63, 0x64, 0x7f, 0xf, 0x79, 0xa4, 0x3, 0x1, 0x41, 0x87, 0x87, 0x80, 0x91, 0x97, 0x2, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[7];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 7, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 251);
EXPECT_EQ(count, 7);
EXPECT_EQ(granted_qos_levels[0], 0x87);
EXPECT_EQ(granted_qos_levels[1], 0x87);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], 0x91);
EXPECT_EQ(granted_qos_levels[4], 0x97);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);

}


// SubscribeResponse 4144 [Right QoS2] [PropSharedSubscriptionAvailable 170,PropSubscriptionIdentifierAvailable 172,PropContentType "\ACK\248zEH\223lpU\198\180",PropWildcardSubscriptionAvailable 74,PropUserProperty ":`'\245\164a'\178N\SI\227r,+KX\203\179\142\242\219\140\144Rv\145\170" "G\245\152\&6\143G\157",PropRequestResponseInformation 116,PropSubscriptionIdentifier 29,PropSubscriptionIdentifier 19,PropResponseTopic "\130{Fz\SI\215\227\STX",PropWillDelayInterval 28450,PropSubscriptionIdentifierAvailable 70,PropWildcardSubscriptionAvailable 18]
TEST(SubACK5QCTest, Decode12) {
uint8_t pkt[] = {0x90, 0x59, 0x10, 0x30, 0x55, 0x2a, 0xaa, 0x29, 0xac, 0x3, 0x0, 0xb, 0x6, 0xf8, 0x7a, 0x45, 0x48, 0xdf, 0x6c, 0x70, 0x55, 0xc6, 0xb4, 0x28, 0x4a, 0x26, 0x0, 0x1b, 0x3a, 0x60, 0x27, 0xf5, 0xa4, 0x61, 0x27, 0xb2, 0x4e, 0xf, 0xe3, 0x72, 0x2c, 0x2b, 0x4b, 0x58, 0xcb, 0xb3, 0x8e, 0xf2, 0xdb, 0x8c, 0x90, 0x52, 0x76, 0x91, 0xaa, 0x0, 0x7, 0x47, 0xf5, 0x98, 0x36, 0x8f, 0x47, 0x9d, 0x19, 0x74, 0xb, 0x1d, 0xb, 0x13, 0x8, 0x0, 0x8, 0x82, 0x7b, 0x46, 0x7a, 0xf, 0xd7, 0xe3, 0x2, 0x18, 0x0, 0x0, 0x6f, 0x22, 0x29, 0x46, 0x28, 0x12, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 4144);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);

}


// SubscribeResponse 22442 [Left SubErrWildcardSubscriptionsNotSupported,Right QoS0] [PropSessionExpiryInterval 17170,PropWildcardSubscriptionAvailable 171,PropMessageExpiryInterval 26968,PropMaximumPacketSize 20851,PropMessageExpiryInterval 9049,PropReceiveMaximum 3743,PropSubscriptionIdentifier 9,PropServerReference "\139@D\SO\248\243",PropServerKeepAlive 24258,PropMessageExpiryInterval 23855,PropWildcardSubscriptionAvailable 9,PropWildcardSubscriptionAvailable 233,PropMaximumQoS 77,PropWillDelayInterval 4264,PropMaximumPacketSize 18411,PropSessionExpiryInterval 13140,PropServerKeepAlive 20787]
TEST(SubACK5QCTest, Decode13) {
uint8_t pkt[] = {0x90, 0x49, 0x57, 0xaa, 0x44, 0x11, 0x0, 0x0, 0x43, 0x12, 0x28, 0xab, 0x2, 0x0, 0x0, 0x69, 0x58, 0x27, 0x0, 0x0, 0x51, 0x73, 0x2, 0x0, 0x0, 0x23, 0x59, 0x21, 0xe, 0x9f, 0xb, 0x9, 0x1c, 0x0, 0x6, 0x8b, 0x40, 0x44, 0xe, 0xf8, 0xf3, 0x13, 0x5e, 0xc2, 0x2, 0x0, 0x0, 0x5d, 0x2f, 0x28, 0x9, 0x28, 0xe9, 0x24, 0x4d, 0x18, 0x0, 0x0, 0x10, 0xa8, 0x27, 0x0, 0x0, 0x47, 0xeb, 0x11, 0x0, 0x0, 0x33, 0x54, 0x13, 0x51, 0x33, 0xa2, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[2];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 2, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22442);
EXPECT_EQ(count, 2);
EXPECT_EQ(granted_qos_levels[0], 0xA2);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);

}


// SubscribeResponse 5149 [Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS2,Right QoS2,Right QoS2,Left SubErrImplementationSpecificError] [PropMessageExpiryInterval 8080,PropSubscriptionIdentifier 23,PropAuthenticationData "",PropResponseInformation "\SOH\STX\216\178>\219n\233\158-\165\148\166O\168\226\EMk\206\NUL\229",PropRequestProblemInformation 124]
TEST(SubACK5QCTest, Decode14) {
uint8_t pkt[] = {0x90, 0x2d, 0x14, 0x1d, 0x24, 0x2, 0x0, 0x0, 0x1f, 0x90, 0xb, 0x17, 0x16, 0x0, 0x0, 0x1a, 0x0, 0x15, 0x1, 0x2, 0xd8, 0xb2, 0x3e, 0xdb, 0x6e, 0xe9, 0x9e, 0x2d, 0xa5, 0x94, 0xa6, 0x4f, 0xa8, 0xe2, 0x19, 0x6b, 0xce, 0x0, 0xe5, 0x17, 0x7c, 0x91, 0x0, 0x2, 0x2, 0x2, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 5149);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x91);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x83);

}


// SubscribeResponse 27317 [Left SubErrPacketIdentifierInUse,Left SubErrTopicFilterInvalid,Right QoS2,Right QoS0,Right QoS0,Right QoS2] [PropContentType "?\DC4\SI\172~\166\149dp\182\170F\165\163i\150\ENQ\no",PropPayloadFormatIndicator 192,PropSessionExpiryInterval 26985,PropUserProperty "\246)\SI\242c" "?\US\166\SOH\187\250\&3\183\&1O\247\&7Hq",PropTopicAlias 26253,PropWillDelayInterval 23496,PropAuthenticationMethod "\245\189\184\180$D\170\208\v\206\168\SUB\145f\212",PropContentType "qS+",PropTopicAliasMaximum 12139,PropTopicAlias 28751,PropContentType "W\219\180\DC3\144\230"]
TEST(SubACK5QCTest, Decode15) {
uint8_t pkt[] = {0x90, 0x6d, 0x6a, 0xb5, 0x64, 0x3, 0x0, 0x13, 0x3f, 0x14, 0xf, 0xac, 0x7e, 0xa6, 0x95, 0x64, 0x70, 0xb6, 0xaa, 0x46, 0xa5, 0xa3, 0x69, 0x96, 0x5, 0xa, 0x6f, 0x1, 0xc0, 0x11, 0x0, 0x0, 0x69, 0x69, 0x26, 0x0, 0x5, 0xf6, 0x29, 0xf, 0xf2, 0x63, 0x0, 0xe, 0x3f, 0x1f, 0xa6, 0x1, 0xbb, 0xfa, 0x33, 0xb7, 0x31, 0x4f, 0xf7, 0x37, 0x48, 0x71, 0x23, 0x66, 0x8d, 0x18, 0x0, 0x0, 0x5b, 0xc8, 0x15, 0x0, 0xf, 0xf5, 0xbd, 0xb8, 0xb4, 0x24, 0x44, 0xaa, 0xd0, 0xb, 0xce, 0xa8, 0x1a, 0x91, 0x66, 0xd4, 0x3, 0x0, 0x3, 0x71, 0x53, 0x2b, 0x22, 0x2f, 0x6b, 0x23, 0x70, 0x4f, 0x3, 0x0, 0x6, 0x57, 0xdb, 0xb4, 0x13, 0x90, 0xe6, 0x91, 0x8f, 0x2, 0x0, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 27317);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x91);
EXPECT_EQ(granted_qos_levels[1], 0x8F);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);

}


// SubscribeResponse 30611 [Left SubErrSubscriptionIdentifiersNotSupported,Right QoS2,Right QoS0,Right QoS2,Right QoS1] [PropMessageExpiryInterval 27493,PropSharedSubscriptionAvailable 220,PropAssignedClientIdentifier "\236\DEL\\\204\242k0\152N\206\215\132@\148\155\177\133'\167"]
TEST(SubACK5QCTest, Decode16) {
uint8_t pkt[] = {0x90, 0x25, 0x77, 0x93, 0x1d, 0x2, 0x0, 0x0, 0x6b, 0x65, 0x2a, 0xdc, 0x12, 0x0, 0x13, 0xec, 0x7f, 0x5c, 0xcc, 0xf2, 0x6b, 0x30, 0x98, 0x4e, 0xce, 0xd7, 0x84, 0x40, 0x94, 0x9b, 0xb1, 0x85, 0x27, 0xa7, 0xa1, 0x2, 0x0, 0x2, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 30611);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], 0xA1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS1);

}


// SubscribeResponse 14554 [Right QoS0,Right QoS2,Left SubErrUnspecifiedError,Right QoS0] [PropTopicAlias 11229,PropMessageExpiryInterval 32396,PropResponseInformation "\183\153$\145\176\192ng\231nM\b\160\147\253U\243\ACKA-\165#\EOT\159\DC1\US",PropAuthenticationData "'n\159d\176?3\204k\217&%\197",PropRetainAvailable 250,PropMessageExpiryInterval 5575,PropAuthenticationData "\136\177\162\173\241\152\"\173\204\DELO\DLE",PropTopicAliasMaximum 27880,PropWillDelayInterval 235,PropSubscriptionIdentifierAvailable 3,PropMaximumQoS 55,PropSharedSubscriptionAvailable 5,PropRequestProblemInformation 163,PropSubscriptionIdentifier 8,PropSubscriptionIdentifier 22,PropUserProperty "\\I.D<\143\213\195\147\157)\CANK\149\138\255/a\226\196\184<\169\201\227\\\132\188b_" "\DC1\SYN\217z\203}\ETX\187;\\",PropWillDelayInterval 11365,PropPayloadFormatIndicator 116,PropServerReference "\211\237\176\193\SYN",PropResponseInformation "\\v\SUBGzm\185\162\157)\200@!\235#\243I\237\146\NUL\132X",PropCorrelationData "\251\174.\203c\245c\ACKT\CAN\154\174)\224{\138\214#\251p:\210c\161",PropTopicAliasMaximum 23726,PropRetainAvailable 113,PropRequestResponseInformation 121,PropAuthenticationData "5\248\&1\239td\129\183\143\\",PropSessionExpiryInterval 15701,PropRequestResponseInformation 200,PropTopicAliasMaximum 14994,PropServerReference "y\166\163i\EMq|\DC1",PropAuthenticationData ")\213\253\152q\243FH\211\ENQm\135\188\&9\232\146\176\189H\CAN\227"]
TEST(SubACK5QCTest, Decode17) {
uint8_t pkt[] = {0x90, 0x98, 0x2, 0x38, 0xda, 0x90, 0x2, 0x23, 0x2b, 0xdd, 0x2, 0x0, 0x0, 0x7e, 0x8c, 0x1a, 0x0, 0x1a, 0xb7, 0x99, 0x24, 0x91, 0xb0, 0xc0, 0x6e, 0x67, 0xe7, 0x6e, 0x4d, 0x8, 0xa0, 0x93, 0xfd, 0x55, 0xf3, 0x6, 0x41, 0x2d, 0xa5, 0x23, 0x4, 0x9f, 0x11, 0x1f, 0x16, 0x0, 0xd, 0x27, 0x6e, 0x9f, 0x64, 0xb0, 0x3f, 0x33, 0xcc, 0x6b, 0xd9, 0x26, 0x25, 0xc5, 0x25, 0xfa, 0x2, 0x0, 0x0, 0x15, 0xc7, 0x16, 0x0, 0xc, 0x88, 0xb1, 0xa2, 0xad, 0xf1, 0x98, 0x22, 0xad, 0xcc, 0x7f, 0x4f, 0x10, 0x22, 0x6c, 0xe8, 0x18, 0x0, 0x0, 0x0, 0xeb, 0x29, 0x3, 0x24, 0x37, 0x2a, 0x5, 0x17, 0xa3, 0xb, 0x8, 0xb, 0x16, 0x26, 0x0, 0x1e, 0x5c, 0x49, 0x2e, 0x44, 0x3c, 0x8f, 0xd5, 0xc3, 0x93, 0x9d, 0x29, 0x18, 0x4b, 0x95, 0x8a, 0xff, 0x2f, 0x61, 0xe2, 0xc4, 0xb8, 0x3c, 0xa9, 0xc9, 0xe3, 0x5c, 0x84, 0xbc, 0x62, 0x5f, 0x0, 0xa, 0x11, 0x16, 0xd9, 0x7a, 0xcb, 0x7d, 0x3, 0xbb, 0x3b, 0x5c, 0x18, 0x0, 0x0, 0x2c, 0x65, 0x1, 0x74, 0x1c, 0x0, 0x5, 0xd3, 0xed, 0xb0, 0xc1, 0x16, 0x1a, 0x0, 0x16, 0x5c, 0x76, 0x1a, 0x47, 0x7a, 0x6d, 0xb9, 0xa2, 0x9d, 0x29, 0xc8, 0x40, 0x21, 0xeb, 0x23, 0xf3, 0x49, 0xed, 0x92, 0x0, 0x84, 0x58, 0x9, 0x0, 0x18, 0xfb, 0xae, 0x2e, 0xcb, 0x63, 0xf5, 0x63, 0x6, 0x54, 0x18, 0x9a, 0xae, 0x29, 0xe0, 0x7b, 0x8a, 0xd6, 0x23, 0xfb, 0x70, 0x3a, 0xd2, 0x63, 0xa1, 0x22, 0x5c, 0xae, 0x25, 0x71, 0x19, 0x79, 0x16, 0x0, 0xa, 0x35, 0xf8, 0x31, 0xef, 0x74, 0x64, 0x81, 0xb7, 0x8f, 0x5c, 0x11, 0x0, 0x0, 0x3d, 0x55, 0x19, 0xc8, 0x22, 0x3a, 0x92, 0x1c, 0x0, 0x8, 0x79, 0xa6, 0xa3, 0x69, 0x19, 0x71, 0x7c, 0x11, 0x16, 0x0, 0x15, 0x29, 0xd5, 0xfd, 0x98, 0x71, 0xf3, 0x46, 0x48, 0xd3, 0x5, 0x6d, 0x87, 0xbc, 0x39, 0xe8, 0x92, 0xb0, 0xbd, 0x48, 0x18, 0xe3, 0x0, 0x2, 0x80, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[4];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 4, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 14554);
EXPECT_EQ(count, 4);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], 0x80);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);

}


// SubscribeResponse 22626 [Right QoS2,Right QoS1,Left SubErrImplementationSpecificError,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported] [PropContentType "\NAKQs\155\134\195\&7\191\171",PropResponseTopic "z\151",PropWildcardSubscriptionAvailable 95,PropCorrelationData "Y\180\142\DC2\249\235\141\137\v_\b\166\197\176\n\174k/\237\175\181{\190",PropServerReference "Xd\225\NUL\190jz\r\187\247\ETX[;\221\210\168\241l*\216\ACK\GS",PropWildcardSubscriptionAvailable 46,PropSharedSubscriptionAvailable 119,PropContentType "\247\173\146D\186\166s\171\EMs\171\233\140aE\188z.bQ\DEL\140\226",PropWildcardSubscriptionAvailable 21,PropContentType "\ETB\187\202\162\212q\DC2\214^\176\131\128X$}\185F",PropMaximumPacketSize 16829,PropReasonString "j\146z\153",PropSharedSubscriptionAvailable 43,PropRequestResponseInformation 33,PropMessageExpiryInterval 11523,PropAuthenticationMethod "\213\SO\191\202",PropContentType "\GS\131\DC3\233\213pd\242\131A@\146E\199",PropResponseInformation "\150\241\SI\SYN[\196",PropReasonString "\206Ck\149\215\221",PropReasonString "\223\DC45\167\185\177jw)\164\221:\252\199\147\245\239\147\SOH\v",PropServerKeepAlive 2942]
TEST(SubACK5QCTest, Decode18) {
uint8_t pkt[] = {0x90, 0xdd, 0x1, 0x58, 0x62, 0xd3, 0x1, 0x3, 0x0, 0x9, 0x15, 0x51, 0x73, 0x9b, 0x86, 0xc3, 0x37, 0xbf, 0xab, 0x8, 0x0, 0x2, 0x7a, 0x97, 0x28, 0x5f, 0x9, 0x0, 0x17, 0x59, 0xb4, 0x8e, 0x12, 0xf9, 0xeb, 0x8d, 0x89, 0xb, 0x5f, 0x8, 0xa6, 0xc5, 0xb0, 0xa, 0xae, 0x6b, 0x2f, 0xed, 0xaf, 0xb5, 0x7b, 0xbe, 0x1c, 0x0, 0x16, 0x58, 0x64, 0xe1, 0x0, 0xbe, 0x6a, 0x7a, 0xd, 0xbb, 0xf7, 0x3, 0x5b, 0x3b, 0xdd, 0xd2, 0xa8, 0xf1, 0x6c, 0x2a, 0xd8, 0x6, 0x1d, 0x28, 0x2e, 0x2a, 0x77, 0x3, 0x0, 0x17, 0xf7, 0xad, 0x92, 0x44, 0xba, 0xa6, 0x73, 0xab, 0x19, 0x73, 0xab, 0xe9, 0x8c, 0x61, 0x45, 0xbc, 0x7a, 0x2e, 0x62, 0x51, 0x7f, 0x8c, 0xe2, 0x28, 0x15, 0x3, 0x0, 0x11, 0x17, 0xbb, 0xca, 0xa2, 0xd4, 0x71, 0x12, 0xd6, 0x5e, 0xb0, 0x83, 0x80, 0x58, 0x24, 0x7d, 0xb9, 0x46, 0x27, 0x0, 0x0, 0x41, 0xbd, 0x1f, 0x0, 0x4, 0x6a, 0x92, 0x7a, 0x99, 0x2a, 0x2b, 0x19, 0x21, 0x2, 0x0, 0x0, 0x2d, 0x3, 0x15, 0x0, 0x4, 0xd5, 0xe, 0xbf, 0xca, 0x3, 0x0, 0xe, 0x1d, 0x83, 0x13, 0xe9, 0xd5, 0x70, 0x64, 0xf2, 0x83, 0x41, 0x40, 0x92, 0x45, 0xc7, 0x1a, 0x0, 0x6, 0x96, 0xf1, 0xf, 0x16, 0x5b, 0xc4, 0x1f, 0x0, 0x6, 0xce, 0x43, 0x6b, 0x95, 0xd7, 0xdd, 0x1f, 0x0, 0x14, 0xdf, 0x14, 0x35, 0xa7, 0xb9, 0xb1, 0x6a, 0x77, 0x29, 0xa4, 0xdd, 0x3a, 0xfc, 0xc7, 0x93, 0xf5, 0xef, 0x93, 0x1, 0xb, 0x13, 0xb, 0x7e, 0x2, 0x1, 0x83, 0x2, 0x2, 0x9e};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22626);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[2], 0x83);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[5], 0x9E);

}


// SubscribeResponse 22779 [Right QoS0] [PropReceiveMaximum 29958,PropUserProperty "V\171\199J\148\167\152\DC2Y\DEL(\168\222F\189u>y\159(:\230\213(\203\162m\DELs1" "\DLE\230\222\163\163Bhd",PropRequestProblemInformation 33,PropTopicAliasMaximum 13111,PropRequestProblemInformation 159,PropSessionExpiryInterval 24873,PropRequestProblemInformation 74,PropSubscriptionIdentifier 7,PropSessionExpiryInterval 694,PropWillDelayInterval 1746,PropAuthenticationMethod "\ETB\tp9\166\DC3\183",PropMaximumPacketSize 32621,PropServerReference "\151\202^\135\235\227\DLEGFc]\236\142\184\128\248\156]\136\186C",PropPayloadFormatIndicator 120,PropMaximumQoS 100,PropMessageExpiryInterval 11802]
TEST(SubACK5QCTest, Decode19) {
uint8_t pkt[] = {0x90, 0x7c, 0x58, 0xfb, 0x78, 0x21, 0x75, 0x6, 0x26, 0x0, 0x1e, 0x56, 0xab, 0xc7, 0x4a, 0x94, 0xa7, 0x98, 0x12, 0x59, 0x7f, 0x28, 0xa8, 0xde, 0x46, 0xbd, 0x75, 0x3e, 0x79, 0x9f, 0x28, 0x3a, 0xe6, 0xd5, 0x28, 0xcb, 0xa2, 0x6d, 0x7f, 0x73, 0x31, 0x0, 0x8, 0x10, 0xe6, 0xde, 0xa3, 0xa3, 0x42, 0x68, 0x64, 0x17, 0x21, 0x22, 0x33, 0x37, 0x17, 0x9f, 0x11, 0x0, 0x0, 0x61, 0x29, 0x17, 0x4a, 0xb, 0x7, 0x11, 0x0, 0x0, 0x2, 0xb6, 0x18, 0x0, 0x0, 0x6, 0xd2, 0x15, 0x0, 0x7, 0x17, 0x9, 0x70, 0x39, 0xa6, 0x13, 0xb7, 0x27, 0x0, 0x0, 0x7f, 0x6d, 0x1c, 0x0, 0x15, 0x97, 0xca, 0x5e, 0x87, 0xeb, 0xe3, 0x10, 0x47, 0x46, 0x63, 0x5d, 0xec, 0x8e, 0xb8, 0x80, 0xf8, 0x9c, 0x5d, 0x88, 0xba, 0x43, 0x1, 0x78, 0x24, 0x64, 0x2, 0x0, 0x0, 0x2e, 0x1a, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 22779);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);

}


// SubscribeResponse 12719 [Left SubErrNotAuthorized,Right QoS0] [PropServerReference "On\212\204\ACK\209\154\SYN\211\240\142\200\150e\196\205\231\182k#zX\243\133\134\252\185",PropMessageExpiryInterval 8103,PropRetainAvailable 64,PropRequestProblemInformation 145,PropWillDelayInterval 29614,PropRequestProblemInformation 189,PropAssignedClientIdentifier "\SUB\170",PropTopicAlias 12053,PropServerReference "",PropServerKeepAlive 16570,PropAuthenticationData "a\255\197g\177(\228\\\145\SYN\208&l",PropContentType "\201\&1\255\&5\140L\239J^'\200I\158\199,$\164\214\213",PropMaximumQoS 168,PropAuthenticationMethod "\161\202\242?\244\&9\149\181\177\169v \217",PropResponseTopic "\207T\201-\208\160\192\248\vWR\179\132",PropReasonString "\146i\153\200\b\\b\232\157a--_\155e\192",PropRetainAvailable 3,PropCorrelationData "\141",PropSharedSubscriptionAvailable 187,PropResponseTopic "\CAN\133\226qc\NUL\150\134\154\SUB5&\225Y1&\a}\173\255\133\148z@\207",PropCorrelationData "M,\EM7\137\200\US\159{",PropTopicAlias 24670,PropMaximumPacketSize 19132,PropAssignedClientIdentifier "8\160AH\SI\RS\ng\200\&9P\217\240\&0\236\168\164f&\t",PropRetainAvailable 254,PropAuthenticationMethod "\254\154'i\SUB\DC2\"K\179><\r\188\CAN9\252>\195\DC3\ETX\147g\188\&5\132l"]
TEST(SubACK5QCTest, Decode20) {
uint8_t pkt[] = {0x90, 0x8b, 0x2, 0x31, 0xaf, 0x85, 0x2, 0x1c, 0x0, 0x1b, 0x4f, 0x6e, 0xd4, 0xcc, 0x6, 0xd1, 0x9a, 0x16, 0xd3, 0xf0, 0x8e, 0xc8, 0x96, 0x65, 0xc4, 0xcd, 0xe7, 0xb6, 0x6b, 0x23, 0x7a, 0x58, 0xf3, 0x85, 0x86, 0xfc, 0xb9, 0x2, 0x0, 0x0, 0x1f, 0xa7, 0x25, 0x40, 0x17, 0x91, 0x18, 0x0, 0x0, 0x73, 0xae, 0x17, 0xbd, 0x12, 0x0, 0x2, 0x1a, 0xaa, 0x23, 0x2f, 0x15, 0x1c, 0x0, 0x0, 0x13, 0x40, 0xba, 0x16, 0x0, 0xd, 0x61, 0xff, 0xc5, 0x67, 0xb1, 0x28, 0xe4, 0x5c, 0x91, 0x16, 0xd0, 0x26, 0x6c, 0x3, 0x0, 0x13, 0xc9, 0x31, 0xff, 0x35, 0x8c, 0x4c, 0xef, 0x4a, 0x5e, 0x27, 0xc8, 0x49, 0x9e, 0xc7, 0x2c, 0x24, 0xa4, 0xd6, 0xd5, 0x24, 0xa8, 0x15, 0x0, 0xd, 0xa1, 0xca, 0xf2, 0x3f, 0xf4, 0x39, 0x95, 0xb5, 0xb1, 0xa9, 0x76, 0x20, 0xd9, 0x8, 0x0, 0xd, 0xcf, 0x54, 0xc9, 0x2d, 0xd0, 0xa0, 0xc0, 0xf8, 0xb, 0x57, 0x52, 0xb3, 0x84, 0x1f, 0x0, 0x10, 0x92, 0x69, 0x99, 0xc8, 0x8, 0x5c, 0x62, 0xe8, 0x9d, 0x61, 0x2d, 0x2d, 0x5f, 0x9b, 0x65, 0xc0, 0x25, 0x3, 0x9, 0x0, 0x1, 0x8d, 0x2a, 0xbb, 0x8, 0x0, 0x19, 0x18, 0x85, 0xe2, 0x71, 0x63, 0x0, 0x96, 0x86, 0x9a, 0x1a, 0x35, 0x26, 0xe1, 0x59, 0x31, 0x26, 0x7, 0x7d, 0xad, 0xff, 0x85, 0x94, 0x7a, 0x40, 0xcf, 0x9, 0x0, 0x9, 0x4d, 0x2c, 0x19, 0x37, 0x89, 0xc8, 0x1f, 0x9f, 0x7b, 0x23, 0x60, 0x5e, 0x27, 0x0, 0x0, 0x4a, 0xbc, 0x12, 0x0, 0x14, 0x38, 0xa0, 0x41, 0x48, 0xf, 0x1e, 0xa, 0x67, 0xc8, 0x39, 0x50, 0xd9, 0xf0, 0x30, 0xec, 0xa8, 0xa4, 0x66, 0x26, 0x9, 0x25, 0xfe, 0x15, 0x0, 0x1a, 0xfe, 0x9a, 0x27, 0x69, 0x1a, 0x12, 0x22, 0x4b, 0xb3, 0x3e, 0x3c, 0xd, 0xbc, 0x18, 0x39, 0xfc, 0x3e, 0xc3, 0x13, 0x3, 0x93, 0x67, 0xbc, 0x35, 0x84, 0x6c, 0x87, 0x0};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[2];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 2, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12719);
EXPECT_EQ(count, 2);
EXPECT_EQ(granted_qos_levels[0], 0x87);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);

}


// SubscribeResponse 18524 [Right QoS2] [PropMaximumPacketSize 20730,PropWillDelayInterval 25373,PropSubscriptionIdentifierAvailable 57,PropWillDelayInterval 24371,PropRetainAvailable 14,PropRequestResponseInformation 160,PropAssignedClientIdentifier "4aG\n\131\189t\148\217b\209\209k\251\DC3\205\&5\186\173\133G.\147\145",PropTopicAliasMaximum 30097,PropPayloadFormatIndicator 113,PropWildcardSubscriptionAvailable 52,PropReasonString "q\SOHAL\FS\164vC\145\154\250\244\"\167\246\ESC",PropRequestResponseInformation 19]
TEST(SubACK5QCTest, Decode21) {
uint8_t pkt[] = {0x90, 0x50, 0x48, 0x5c, 0x4c, 0x27, 0x0, 0x0, 0x50, 0xfa, 0x18, 0x0, 0x0, 0x63, 0x1d, 0x29, 0x39, 0x18, 0x0, 0x0, 0x5f, 0x33, 0x25, 0xe, 0x19, 0xa0, 0x12, 0x0, 0x18, 0x34, 0x61, 0x47, 0xa, 0x83, 0xbd, 0x74, 0x94, 0xd9, 0x62, 0xd1, 0xd1, 0x6b, 0xfb, 0x13, 0xcd, 0x35, 0xba, 0xad, 0x85, 0x47, 0x2e, 0x93, 0x91, 0x22, 0x75, 0x91, 0x1, 0x71, 0x28, 0x34, 0x1f, 0x0, 0x10, 0x71, 0x1, 0x41, 0x4c, 0x1c, 0xa4, 0x76, 0x43, 0x91, 0x9a, 0xfa, 0xf4, 0x22, 0xa7, 0xf6, 0x1b, 0x19, 0x13, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 18524);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);

}


// SubscribeResponse 12697 [Left SubErrPacketIdentifierInUse,Left SubErrPacketIdentifierInUse,Left SubErrWildcardSubscriptionsNotSupported,Left SubErrSharedSubscriptionsNotSupported,Left SubErrSubscriptionIdentifiersNotSupported,Left SubErrNotAuthorized] [PropRequestResponseInformation 65,PropSubscriptionIdentifierAvailable 150,PropReasonString ")\b\223\213\173)\GS",PropUserProperty "" "\160)\146\f\167\DC4i\\\146",PropMessageExpiryInterval 27739,PropRequestResponseInformation 87,PropAuthenticationData "_\129[0]\150",PropRequestResponseInformation 81,PropMaximumQoS 234,PropMessageExpiryInterval 685]
TEST(SubACK5QCTest, Decode22) {
uint8_t pkt[] = {0x90, 0x3e, 0x31, 0x99, 0x35, 0x19, 0x41, 0x29, 0x96, 0x1f, 0x0, 0x7, 0x29, 0x8, 0xdf, 0xd5, 0xad, 0x29, 0x1d, 0x26, 0x0, 0x0, 0x0, 0x9, 0xa0, 0x29, 0x92, 0xc, 0xa7, 0x14, 0x69, 0x5c, 0x92, 0x2, 0x0, 0x0, 0x6c, 0x5b, 0x19, 0x57, 0x16, 0x0, 0x6, 0x5f, 0x81, 0x5b, 0x30, 0x5d, 0x96, 0x19, 0x51, 0x24, 0xea, 0x2, 0x0, 0x0, 0x2, 0xad, 0x91, 0x91, 0xa2, 0x9e, 0xa1, 0x87};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12697);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x91);
EXPECT_EQ(granted_qos_levels[1], 0x91);
EXPECT_EQ(granted_qos_levels[2], 0xA2);
EXPECT_EQ(granted_qos_levels[3], 0x9E);
EXPECT_EQ(granted_qos_levels[4], 0xA1);
EXPECT_EQ(granted_qos_levels[5], 0x87);

}


// SubscribeResponse 1694 [Left SubErrSubscriptionIdentifiersNotSupported] [PropSubscriptionIdentifier 29,PropRequestResponseInformation 43,PropMaximumPacketSize 2393,PropServerReference "`\253ve\"\180\148jD\DLEh\181?\225\205\ETB|\150)\DC2B\237|\155\191\EMi\ETX",PropWillDelayInterval 2584,PropServerReference "\152\129\248\ETB=\210\"\132",PropResponseTopic "\164I4uR\"\CAN/\218\252",PropRequestResponseInformation 236,PropWillDelayInterval 10307,PropMaximumPacketSize 21415,PropMessageExpiryInterval 11498,PropAssignedClientIdentifier "VB\b\171vn\237D\128\145\189\DEL\135\FS\235\185\238\SO\128\140\STX",PropReasonString "\204\188\153\162\248\a\SO\187\162Z\224R\252h?\\M \207W\238F\DC2p$\241K\234\171\240",PropReasonString "\198\194\180\NUL",PropResponseTopic "]",PropAuthenticationMethod "\187\196\SO\248\161\215T\166\252\237\248\ETX\177\241\ETB\169\SO\175\&6\151\&4H"]
TEST(SubACK5QCTest, Decode23) {
uint8_t pkt[] = {0x90, 0xb8, 0x1, 0x6, 0x9e, 0xb3, 0x1, 0xb, 0x1d, 0x19, 0x2b, 0x27, 0x0, 0x0, 0x9, 0x59, 0x1c, 0x0, 0x1c, 0x60, 0xfd, 0x76, 0x65, 0x22, 0xb4, 0x94, 0x6a, 0x44, 0x10, 0x68, 0xb5, 0x3f, 0xe1, 0xcd, 0x17, 0x7c, 0x96, 0x29, 0x12, 0x42, 0xed, 0x7c, 0x9b, 0xbf, 0x19, 0x69, 0x3, 0x18, 0x0, 0x0, 0xa, 0x18, 0x1c, 0x0, 0x8, 0x98, 0x81, 0xf8, 0x17, 0x3d, 0xd2, 0x22, 0x84, 0x8, 0x0, 0xa, 0xa4, 0x49, 0x34, 0x75, 0x52, 0x22, 0x18, 0x2f, 0xda, 0xfc, 0x19, 0xec, 0x18, 0x0, 0x0, 0x28, 0x43, 0x27, 0x0, 0x0, 0x53, 0xa7, 0x2, 0x0, 0x0, 0x2c, 0xea, 0x12, 0x0, 0x15, 0x56, 0x42, 0x8, 0xab, 0x76, 0x6e, 0xed, 0x44, 0x80, 0x91, 0xbd, 0x7f, 0x87, 0x1c, 0xeb, 0xb9, 0xee, 0xe, 0x80, 0x8c, 0x2, 0x1f, 0x0, 0x1e, 0xcc, 0xbc, 0x99, 0xa2, 0xf8, 0x7, 0xe, 0xbb, 0xa2, 0x5a, 0xe0, 0x52, 0xfc, 0x68, 0x3f, 0x5c, 0x4d, 0x20, 0xcf, 0x57, 0xee, 0x46, 0x12, 0x70, 0x24, 0xf1, 0x4b, 0xea, 0xab, 0xf0, 0x1f, 0x0, 0x4, 0xc6, 0xc2, 0xb4, 0x0, 0x8, 0x0, 0x1, 0x5d, 0x15, 0x0, 0x16, 0xbb, 0xc4, 0xe, 0xf8, 0xa1, 0xd7, 0x54, 0xa6, 0xfc, 0xed, 0xf8, 0x3, 0xb1, 0xf1, 0x17, 0xa9, 0xe, 0xaf, 0x36, 0x97, 0x34, 0x48, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 1694);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], 0xA1);

}


// SubscribeResponse 30899 [Right QoS1] [PropReceiveMaximum 27644,PropReceiveMaximum 8426,PropAuthenticationMethod "\245\194\219\EOT\156",PropTopicAlias 5286,PropMessageExpiryInterval 19925,PropMaximumQoS 126,PropWillDelayInterval 3267,PropMessageExpiryInterval 21796,PropReasonString "\174a\208\rg\222\233Z\129\163\150\&6\185\248,O\128\237",PropAuthenticationData "",PropReasonString "\EOT\t\173\&9\255\216LP\138'\EM\170x\198\235\a\CAN\196\217E!\EM\239\DC2",PropServerReference "29\139D\215\128\151\198\190\247\205)r\DC4\DC4Y\178\DC1\131",PropSubscriptionIdentifier 3,PropRequestResponseInformation 129,PropReasonString "\133\&5\EM\RS<\DEL\228\157|\215\244|\143\231\219\173Ol~V\166\162x\235E}\193\ENQ\218V",PropRequestResponseInformation 21,PropRequestResponseInformation 29,PropResponseInformation "R\151fy\168\191\234\146\"\CAN_\181\&4\"\223m\243A\NAK",PropResponseInformation "W\207v\217\244D!y\242\ACK",PropMessageExpiryInterval 9026,PropResponseInformation "\ESCvURy\155\138\133\253\143\ESC\254",PropContentType "\225\135\187\173\171\v.\243R\133\252\253\STX",PropContentType "]\206\US\t\139",PropAuthenticationData "\182\184\223D\211\ETX\243 )\139\156\251\&1\227\248"]
TEST(SubACK5QCTest, Decode24) {
uint8_t pkt[] = {0x90, 0xfa, 0x1, 0x78, 0xb3, 0xf5, 0x1, 0x21, 0x6b, 0xfc, 0x21, 0x20, 0xea, 0x15, 0x0, 0x5, 0xf5, 0xc2, 0xdb, 0x4, 0x9c, 0x23, 0x14, 0xa6, 0x2, 0x0, 0x0, 0x4d, 0xd5, 0x24, 0x7e, 0x18, 0x0, 0x0, 0xc, 0xc3, 0x2, 0x0, 0x0, 0x55, 0x24, 0x1f, 0x0, 0x12, 0xae, 0x61, 0xd0, 0xd, 0x67, 0xde, 0xe9, 0x5a, 0x81, 0xa3, 0x96, 0x36, 0xb9, 0xf8, 0x2c, 0x4f, 0x80, 0xed, 0x16, 0x0, 0x0, 0x1f, 0x0, 0x18, 0x4, 0x9, 0xad, 0x39, 0xff, 0xd8, 0x4c, 0x50, 0x8a, 0x27, 0x19, 0xaa, 0x78, 0xc6, 0xeb, 0x7, 0x18, 0xc4, 0xd9, 0x45, 0x21, 0x19, 0xef, 0x12, 0x1c, 0x0, 0x13, 0x32, 0x39, 0x8b, 0x44, 0xd7, 0x80, 0x97, 0xc6, 0xbe, 0xf7, 0xcd, 0x29, 0x72, 0x14, 0x14, 0x59, 0xb2, 0x11, 0x83, 0xb, 0x3, 0x19, 0x81, 0x1f, 0x0, 0x1e, 0x85, 0x35, 0x19, 0x1e, 0x3c, 0x7f, 0xe4, 0x9d, 0x7c, 0xd7, 0xf4, 0x7c, 0x8f, 0xe7, 0xdb, 0xad, 0x4f, 0x6c, 0x7e, 0x56, 0xa6, 0xa2, 0x78, 0xeb, 0x45, 0x7d, 0xc1, 0x5, 0xda, 0x56, 0x19, 0x15, 0x19, 0x1d, 0x1a, 0x0, 0x13, 0x52, 0x97, 0x66, 0x79, 0xa8, 0xbf, 0xea, 0x92, 0x22, 0x18, 0x5f, 0xb5, 0x34, 0x22, 0xdf, 0x6d, 0xf3, 0x41, 0x15, 0x1a, 0x0, 0xa, 0x57, 0xcf, 0x76, 0xd9, 0xf4, 0x44, 0x21, 0x79, 0xf2, 0x6, 0x2, 0x0, 0x0, 0x23, 0x42, 0x1a, 0x0, 0xc, 0x1b, 0x76, 0x55, 0x52, 0x79, 0x9b, 0x8a, 0x85, 0xfd, 0x8f, 0x1b, 0xfe, 0x3, 0x0, 0xd, 0xe1, 0x87, 0xbb, 0xad, 0xab, 0xb, 0x2e, 0xf3, 0x52, 0x85, 0xfc, 0xfd, 0x2, 0x3, 0x0, 0x5, 0x5d, 0xce, 0x1f, 0x9, 0x8b, 0x16, 0x0, 0xf, 0xb6, 0xb8, 0xdf, 0x44, 0xd3, 0x3, 0xf3, 0x20, 0x29, 0x8b, 0x9c, 0xfb, 0x31, 0xe3, 0xf8, 0x1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[1];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 1, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 30899);
EXPECT_EQ(count, 1);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);

}


// SubscribeResponse 15 [Left SubErrSubscriptionIdentifiersNotSupported,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported,Right QoS0,Right QoS2] [PropMaximumQoS 216,PropServerReference "A1\"\208\250\203&",PropWildcardSubscriptionAvailable 128,PropMaximumPacketSize 15978,PropUserProperty "W\146\r$\SI\aP&\149|v\208\222\US\128C\217\&4\159\209\128Z@Z" "\CAN+2\131\218!ZZz\192\142",PropResponseTopic ".\216\246&\RSF\130\136k\159\&3\197_[\138\v\145",PropSessionExpiryInterval 29247,PropServerKeepAlive 20272,PropCorrelationData "~N\219\182!\f^\247\172\ACK\148\254\153\159\221\208\129\FS\141\CAN\177\213C\219\135rU",PropResponseTopic "HU\222\186tp\236\RS(\174w\249\GS\220\NAK3t\156\160\147a\145w",PropMessageExpiryInterval 23404,PropMaximumQoS 41]
TEST(SubACK5QCTest, Decode25) {
uint8_t pkt[] = {0x90, 0xa0, 0x1, 0x0, 0xf, 0x96, 0x1, 0x24, 0xd8, 0x1c, 0x0, 0x7, 0x41, 0x31, 0x22, 0xd0, 0xfa, 0xcb, 0x26, 0x28, 0x80, 0x27, 0x0, 0x0, 0x3e, 0x6a, 0x26, 0x0, 0x18, 0x57, 0x92, 0xd, 0x24, 0xf, 0x7, 0x50, 0x26, 0x95, 0x7c, 0x76, 0xd0, 0xde, 0x1f, 0x80, 0x43, 0xd9, 0x34, 0x9f, 0xd1, 0x80, 0x5a, 0x40, 0x5a, 0x0, 0xb, 0x18, 0x2b, 0x32, 0x83, 0xda, 0x21, 0x5a, 0x5a, 0x7a, 0xc0, 0x8e, 0x8, 0x0, 0x11, 0x2e, 0xd8, 0xf6, 0x26, 0x1e, 0x46, 0x82, 0x88, 0x6b, 0x9f, 0x33, 0xc5, 0x5f, 0x5b, 0x8a, 0xb, 0x91, 0x11, 0x0, 0x0, 0x72, 0x3f, 0x13, 0x4f, 0x30, 0x9, 0x0, 0x1b, 0x7e, 0x4e, 0xdb, 0xb6, 0x21, 0xc, 0x5e, 0xf7, 0xac, 0x6, 0x94, 0xfe, 0x99, 0x9f, 0xdd, 0xd0, 0x81, 0x1c, 0x8d, 0x18, 0xb1, 0xd5, 0x43, 0xdb, 0x87, 0x72, 0x55, 0x8, 0x0, 0x17, 0x48, 0x55, 0xde, 0xba, 0x74, 0x70, 0xec, 0x1e, 0x28, 0xae, 0x77, 0xf9, 0x1d, 0xdc, 0x15, 0x33, 0x74, 0x9c, 0xa0, 0x93, 0x61, 0x91, 0x77, 0x2, 0x0, 0x0, 0x5b, 0x6c, 0x24, 0x29, 0xa1, 0x2, 0x2, 0x9e, 0x0, 0x2};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 15);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0xA1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[3], 0x9E);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS2);

}


// SubscribeResponse 13923 [Right QoS2,Left SubErrNotAuthorized,Right QoS1,Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded] [PropContentType "\DC3\SUB@,\185k\226",PropSubscriptionIdentifier 12,PropMessageExpiryInterval 9419,PropReceiveMaximum 31538,PropServerReference "\154\168\128c",PropTopicAliasMaximum 16842,PropServerReference "aXA\247\138<\132:\161\198v",PropMaximumQoS 114,PropMessageExpiryInterval 15881,PropReceiveMaximum 9017,PropSharedSubscriptionAvailable 191,PropUserProperty "" "\NAK\193Ab\228\&4_\150\DEL\rd\128{\208I\163)/\SI\188\255\&1\132",PropUserProperty "\203\173\DC41\139\160\252" "\DC2r\208",PropUserProperty "\145s\208\152\243q\CAN\SYNbG\154J\144\193\157&\SOH\131k\250" "]L\172\152",PropMessageExpiryInterval 2098,PropServerReference "\154\203\&6\ETX\n\EOT\136P\186\208w6\215\143:_\EOT\254R\213L*^#\193E\142i",PropSubscriptionIdentifierAvailable 127,PropMaximumQoS 12,PropMaximumQoS 156]
TEST(SubACK5QCTest, Decode26) {
uint8_t pkt[] = {0x90, 0xb3, 0x1, 0x36, 0x63, 0xaa, 0x1, 0x3, 0x0, 0x7, 0x13, 0x1a, 0x40, 0x2c, 0xb9, 0x6b, 0xe2, 0xb, 0xc, 0x2, 0x0, 0x0, 0x24, 0xcb, 0x21, 0x7b, 0x32, 0x1c, 0x0, 0x4, 0x9a, 0xa8, 0x80, 0x63, 0x22, 0x41, 0xca, 0x1c, 0x0, 0xb, 0x61, 0x58, 0x41, 0xf7, 0x8a, 0x3c, 0x84, 0x3a, 0xa1, 0xc6, 0x76, 0x24, 0x72, 0x2, 0x0, 0x0, 0x3e, 0x9, 0x21, 0x23, 0x39, 0x2a, 0xbf, 0x26, 0x0, 0x0, 0x0, 0x17, 0x15, 0xc1, 0x41, 0x62, 0xe4, 0x34, 0x5f, 0x96, 0x7f, 0xd, 0x64, 0x80, 0x7b, 0xd0, 0x49, 0xa3, 0x29, 0x2f, 0xf, 0xbc, 0xff, 0x31, 0x84, 0x26, 0x0, 0x7, 0xcb, 0xad, 0x14, 0x31, 0x8b, 0xa0, 0xfc, 0x0, 0x3, 0x12, 0x72, 0xd0, 0x26, 0x0, 0x14, 0x91, 0x73, 0xd0, 0x98, 0xf3, 0x71, 0x18, 0x16, 0x62, 0x47, 0x9a, 0x4a, 0x90, 0xc1, 0x9d, 0x26, 0x1, 0x83, 0x6b, 0xfa, 0x0, 0x4, 0x5d, 0x4c, 0xac, 0x98, 0x2, 0x0, 0x0, 0x8, 0x32, 0x1c, 0x0, 0x1c, 0x9a, 0xcb, 0x36, 0x3, 0xa, 0x4, 0x88, 0x50, 0xba, 0xd0, 0x77, 0x36, 0xd7, 0x8f, 0x3a, 0x5f, 0x4, 0xfe, 0x52, 0xd5, 0x4c, 0x2a, 0x5e, 0x23, 0xc1, 0x45, 0x8e, 0x69, 0x29, 0x7f, 0x24, 0xc, 0x24, 0x9c, 0x2, 0x87, 0x1, 0x91, 0x97};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 13923);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], 0x87);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], 0x91);
EXPECT_EQ(granted_qos_levels[4], 0x97);

}


// SubscribeResponse 6677 [Right QoS0,Right QoS1,Left SubErrImplementationSpecificError,Right QoS1,Left SubErrPacketIdentifierInUse,Right QoS0,Right QoS2,Right QoS2,Left SubErrSharedSubscriptionsNotSupported,Right QoS1,Left SubErrImplementationSpecificError] [PropSessionExpiryInterval 14683,PropSessionExpiryInterval 21434,PropAuthenticationData "D#\252\208F\157P\215J \205\186\251\251\139",PropAuthenticationData "\179\247",PropPayloadFormatIndicator 176,PropResponseTopic "\201\244\179\185o\NAK\177\\H\192\ETB\229\170\164\242T\136\149w",PropSubscriptionIdentifierAvailable 152,PropSharedSubscriptionAvailable 60,PropRetainAvailable 141,PropReceiveMaximum 27371,PropSubscriptionIdentifierAvailable 227,PropSubscriptionIdentifierAvailable 154,PropRetainAvailable 162,PropWillDelayInterval 19822,PropAssignedClientIdentifier "c",PropServerKeepAlive 6408,PropResponseInformation "\bF\129f\199\228\201\255\255\176\156\&1\238",PropReceiveMaximum 16984,PropSubscriptionIdentifier 28,PropAuthenticationData "\r\129\228\233\202R\160\164\240w\173\SUB\NULB?\245\204O\210\150\&5\226\141W\239\130\160G",PropMessageExpiryInterval 15050,PropAuthenticationMethod "\SOH\168\SYN!\224\166\237\228_\181\202\136\141\156\217\&9\252-\213\138>",PropResponseTopic "\250\217\206t\"\223\DC2Y\131\FS\139+\DEL\209h~\162\197YV>\DEL",PropServerKeepAlive 11130,PropSharedSubscriptionAvailable 136]
TEST(SubACK5QCTest, Decode27) {
uint8_t pkt[] = {0x90, 0xd2, 0x1, 0x1a, 0x15, 0xc3, 0x1, 0x11, 0x0, 0x0, 0x39, 0x5b, 0x11, 0x0, 0x0, 0x53, 0xba, 0x16, 0x0, 0xf, 0x44, 0x23, 0xfc, 0xd0, 0x46, 0x9d, 0x50, 0xd7, 0x4a, 0x20, 0xcd, 0xba, 0xfb, 0xfb, 0x8b, 0x16, 0x0, 0x2, 0xb3, 0xf7, 0x1, 0xb0, 0x8, 0x0, 0x13, 0xc9, 0xf4, 0xb3, 0xb9, 0x6f, 0x15, 0xb1, 0x5c, 0x48, 0xc0, 0x17, 0xe5, 0xaa, 0xa4, 0xf2, 0x54, 0x88, 0x95, 0x77, 0x29, 0x98, 0x2a, 0x3c, 0x25, 0x8d, 0x21, 0x6a, 0xeb, 0x29, 0xe3, 0x29, 0x9a, 0x25, 0xa2, 0x18, 0x0, 0x0, 0x4d, 0x6e, 0x12, 0x0, 0x1, 0x63, 0x13, 0x19, 0x8, 0x1a, 0x0, 0xd, 0x8, 0x46, 0x81, 0x66, 0xc7, 0xe4, 0xc9, 0xff, 0xff, 0xb0, 0x9c, 0x31, 0xee, 0x21, 0x42, 0x58, 0xb, 0x1c, 0x16, 0x0, 0x1c, 0xd, 0x81, 0xe4, 0xe9, 0xca, 0x52, 0xa0, 0xa4, 0xf0, 0x77, 0xad, 0x1a, 0x0, 0x42, 0x3f, 0xf5, 0xcc, 0x4f, 0xd2, 0x96, 0x35, 0xe2, 0x8d, 0x57, 0xef, 0x82, 0xa0, 0x47, 0x2, 0x0, 0x0, 0x3a, 0xca, 0x15, 0x0, 0x15, 0x1, 0xa8, 0x16, 0x21, 0xe0, 0xa6, 0xed, 0xe4, 0x5f, 0xb5, 0xca, 0x88, 0x8d, 0x9c, 0xd9, 0x39, 0xfc, 0x2d, 0xd5, 0x8a, 0x3e, 0x8, 0x0, 0x16, 0xfa, 0xd9, 0xce, 0x74, 0x22, 0xdf, 0x12, 0x59, 0x83, 0x1c, 0x8b, 0x2b, 0x7f, 0xd1, 0x68, 0x7e, 0xa2, 0xc5, 0x59, 0x56, 0x3e, 0x7f, 0x13, 0x2b, 0x7a, 0x2a, 0x88, 0x0, 0x1, 0x83, 0x1, 0x91, 0x0, 0x2, 0x2, 0x9e, 0x1, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[11];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 11, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 6677);
EXPECT_EQ(count, 11);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[2], 0x83);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], 0x91);
EXPECT_EQ(granted_qos_levels[5], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[6], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[7], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[8], 0x9E);
EXPECT_EQ(granted_qos_levels[9], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[10], 0x83);

}


// SubscribeResponse 12919 [Right QoS2,Left SubErrPacketIdentifierInUse,Right QoS1,Right QoS0,Left SubErrSubscriptionIdentifiersNotSupported] [PropAuthenticationData "f\224~\151\161Ar\218B\165\171\200\130\128\253C\CAN\154\n\153$\ENQ\194\180\148\DC4\223",PropUserProperty "\DC2:#\184q]" "\NAK!_k\236\\m\170\201\173u\149\ETXD:\178\129\164\&6i",PropSubscriptionIdentifier 14,PropRequestResponseInformation 152,PropMessageExpiryInterval 30660,PropSubscriptionIdentifier 5,PropMessageExpiryInterval 24332,PropReceiveMaximum 32249,PropContentType "\178\174=\US~0v\136\187\229\252\f",PropRetainAvailable 253,PropSubscriptionIdentifierAvailable 1,PropServerKeepAlive 19906,PropSubscriptionIdentifierAvailable 54,PropAssignedClientIdentifier "\174o\138z\186\200\184@",PropSubscriptionIdentifier 19,PropWillDelayInterval 7801,PropResponseInformation "\160\SYN#s",PropCorrelationData "\145\SOH\144\133\ETBtn\172w\195j\164\161\205\151\229o\231\168%@UK",PropRequestResponseInformation 101,PropMaximumQoS 213,PropServerReference "u\RS\228\212T:Oz>\154\176\231La-\164,\166",PropCorrelationData "\169\SOH \\\197\209x:\b\176\t\226\\\222\GS\178IV\RSE\190\ETB\252",PropPayloadFormatIndicator 140,PropRequestResponseInformation 93,PropWildcardSubscriptionAvailable 15,PropMaximumPacketSize 21743,PropSubscriptionIdentifierAvailable 12,PropResponseInformation "iv\SI\219)\164\b\253\223\n\t\235\NAK\219"]
TEST(SubACK5QCTest, Decode28) {
uint8_t pkt[] = {0x90, 0xf5, 0x1, 0x32, 0x77, 0xec, 0x1, 0x16, 0x0, 0x1b, 0x66, 0xe0, 0x7e, 0x97, 0xa1, 0x41, 0x72, 0xda, 0x42, 0xa5, 0xab, 0xc8, 0x82, 0x80, 0xfd, 0x43, 0x18, 0x9a, 0xa, 0x99, 0x24, 0x5, 0xc2, 0xb4, 0x94, 0x14, 0xdf, 0x26, 0x0, 0x6, 0x12, 0x3a, 0x23, 0xb8, 0x71, 0x5d, 0x0, 0x14, 0x15, 0x21, 0x5f, 0x6b, 0xec, 0x5c, 0x6d, 0xaa, 0xc9, 0xad, 0x75, 0x95, 0x3, 0x44, 0x3a, 0xb2, 0x81, 0xa4, 0x36, 0x69, 0xb, 0xe, 0x19, 0x98, 0x2, 0x0, 0x0, 0x77, 0xc4, 0xb, 0x5, 0x2, 0x0, 0x0, 0x5f, 0xc, 0x21, 0x7d, 0xf9, 0x3, 0x0, 0xc, 0xb2, 0xae, 0x3d, 0x1f, 0x7e, 0x30, 0x76, 0x88, 0xbb, 0xe5, 0xfc, 0xc, 0x25, 0xfd, 0x29, 0x1, 0x13, 0x4d, 0xc2, 0x29, 0x36, 0x12, 0x0, 0x8, 0xae, 0x6f, 0x8a, 0x7a, 0xba, 0xc8, 0xb8, 0x40, 0xb, 0x13, 0x18, 0x0, 0x0, 0x1e, 0x79, 0x1a, 0x0, 0x4, 0xa0, 0x16, 0x23, 0x73, 0x9, 0x0, 0x17, 0x91, 0x1, 0x90, 0x85, 0x17, 0x74, 0x6e, 0xac, 0x77, 0xc3, 0x6a, 0xa4, 0xa1, 0xcd, 0x97, 0xe5, 0x6f, 0xe7, 0xa8, 0x25, 0x40, 0x55, 0x4b, 0x19, 0x65, 0x24, 0xd5, 0x1c, 0x0, 0x12, 0x75, 0x1e, 0xe4, 0xd4, 0x54, 0x3a, 0x4f, 0x7a, 0x3e, 0x9a, 0xb0, 0xe7, 0x4c, 0x61, 0x2d, 0xa4, 0x2c, 0xa6, 0x9, 0x0, 0x17, 0xa9, 0x1, 0x20, 0x5c, 0xc5, 0xd1, 0x78, 0x3a, 0x8, 0xb0, 0x9, 0xe2, 0x5c, 0xde, 0x1d, 0xb2, 0x49, 0x56, 0x1e, 0x45, 0xbe, 0x17, 0xfc, 0x1, 0x8c, 0x19, 0x5d, 0x28, 0xf, 0x27, 0x0, 0x0, 0x54, 0xef, 0x29, 0xc, 0x1a, 0x0, 0xe, 0x69, 0x76, 0xf, 0xdb, 0x29, 0xa4, 0x8, 0xfd, 0xdf, 0xa, 0x9, 0xeb, 0x15, 0xdb, 0x2, 0x91, 0x1, 0x0, 0xa1};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 12919);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS2);
EXPECT_EQ(granted_qos_levels[1], 0x91);
EXPECT_EQ(granted_qos_levels[2], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0xA1);

}


// SubscribeResponse 20520 [Right QoS1,Right QoS0,Left SubErrNotAuthorized,Right QoS0,Left SubErrImplementationSpecificError] [PropSubscriptionIdentifierAvailable 144,PropTopicAliasMaximum 10170,PropMaximumPacketSize 22999,PropRequestProblemInformation 220,PropAuthenticationData "X\238{\218f),",PropSessionExpiryInterval 21080,PropRequestProblemInformation 67,PropAuthenticationData "\SYN\189\&4\180\225\156\&8\246\DEL\151bX\148n\196@\247\214\132\&4\177\245h\179S\\\215EF",PropAuthenticationMethod "\249,\163\207\134\ESC\176?GbZ<4\218\164\207{",PropSharedSubscriptionAvailable 247,PropRequestResponseInformation 63,PropServerKeepAlive 12124,PropServerReference "_\\\235\181\236)\227\219\190\194\&9#|\233\204\200",PropMessageExpiryInterval 10858,PropRequestResponseInformation 207,PropSessionExpiryInterval 24059,PropReasonString "\NUL\EOT\228\DC3",PropContentType "\177N6\250\204j~\172\199cO\176\130\180 \225ba\206\US",PropAuthenticationData "K\RS\133c\ENQ\143\199\n7s\240IJ\187",PropMessageExpiryInterval 27212,PropSubscriptionIdentifier 10,PropRequestResponseInformation 203,PropTopicAlias 16606,PropAuthenticationMethod "9V\188\255\225\218\&5\DC1\247\NUL",PropWildcardSubscriptionAvailable 206,PropMaximumQoS 9,PropRetainAvailable 230,PropSharedSubscriptionAvailable 159,PropMaximumPacketSize 1549]
TEST(SubACK5QCTest, Decode29) {
uint8_t pkt[] = {0x90, 0xd5, 0x1, 0x50, 0x28, 0xcc, 0x1, 0x29, 0x90, 0x22, 0x27, 0xba, 0x27, 0x0, 0x0, 0x59, 0xd7, 0x17, 0xdc, 0x16, 0x0, 0x7, 0x58, 0xee, 0x7b, 0xda, 0x66, 0x29, 0x2c, 0x11, 0x0, 0x0, 0x52, 0x58, 0x17, 0x43, 0x16, 0x0, 0x1d, 0x16, 0xbd, 0x34, 0xb4, 0xe1, 0x9c, 0x38, 0xf6, 0x7f, 0x97, 0x62, 0x58, 0x94, 0x6e, 0xc4, 0x40, 0xf7, 0xd6, 0x84, 0x34, 0xb1, 0xf5, 0x68, 0xb3, 0x53, 0x5c, 0xd7, 0x45, 0x46, 0x15, 0x0, 0x11, 0xf9, 0x2c, 0xa3, 0xcf, 0x86, 0x1b, 0xb0, 0x3f, 0x47, 0x62, 0x5a, 0x3c, 0x34, 0xda, 0xa4, 0xcf, 0x7b, 0x2a, 0xf7, 0x19, 0x3f, 0x13, 0x2f, 0x5c, 0x1c, 0x0, 0x10, 0x5f, 0x5c, 0xeb, 0xb5, 0xec, 0x29, 0xe3, 0xdb, 0xbe, 0xc2, 0x39, 0x23, 0x7c, 0xe9, 0xcc, 0xc8, 0x2, 0x0, 0x0, 0x2a, 0x6a, 0x19, 0xcf, 0x11, 0x0, 0x0, 0x5d, 0xfb, 0x1f, 0x0, 0x4, 0x0, 0x4, 0xe4, 0x13, 0x3, 0x0, 0x14, 0xb1, 0x4e, 0x36, 0xfa, 0xcc, 0x6a, 0x7e, 0xac, 0xc7, 0x63, 0x4f, 0xb0, 0x82, 0xb4, 0x20, 0xe1, 0x62, 0x61, 0xce, 0x1f, 0x16, 0x0, 0xe, 0x4b, 0x1e, 0x85, 0x63, 0x5, 0x8f, 0xc7, 0xa, 0x37, 0x73, 0xf0, 0x49, 0x4a, 0xbb, 0x2, 0x0, 0x0, 0x6a, 0x4c, 0xb, 0xa, 0x19, 0xcb, 0x23, 0x40, 0xde, 0x15, 0x0, 0xa, 0x39, 0x56, 0xbc, 0xff, 0xe1, 0xda, 0x35, 0x11, 0xf7, 0x0, 0x28, 0xce, 0x24, 0x9, 0x25, 0xe6, 0x2a, 0x9f, 0x27, 0x0, 0x0, 0x6, 0xd, 0x1, 0x0, 0x87, 0x0, 0x83};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[5];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 5, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 20520);
EXPECT_EQ(count, 5);
EXPECT_EQ(granted_qos_levels[0], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[1], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[2], 0x87);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[4], 0x83);

}


// SubscribeResponse 2699 [Left SubErrPacketIdentifierInUse,Left SubErrQuotaExceeded,Left SubErrQuotaExceeded,Right QoS1,Right QoS0,Left SubErrQuotaExceeded] [PropResponseTopic "",PropSessionExpiryInterval 8424]
TEST(SubACK5QCTest, Decode30) {
uint8_t pkt[] = {0x90, 0x11, 0xa, 0x8b, 0x8, 0x8, 0x0, 0x0, 0x11, 0x0, 0x0, 0x20, 0xe8, 0x91, 0x97, 0x97, 0x1, 0x0, 0x97};
uint16_t packet_id;
int count;
lwmqtt_qos_t granted_qos_levels[6];
lwmqtt_err_t err = lwmqtt_decode_suback(pkt, sizeof(pkt), &packet_id,LWMQTT_MQTT5, 6, &count, granted_qos_levels);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(packet_id, 2699);
EXPECT_EQ(count, 6);
EXPECT_EQ(granted_qos_levels[0], 0x91);
EXPECT_EQ(granted_qos_levels[1], 0x97);
EXPECT_EQ(granted_qos_levels[2], 0x97);
EXPECT_EQ(granted_qos_levels[3], LWMQTT_QOS1);
EXPECT_EQ(granted_qos_levels[4], LWMQTT_QOS0);
EXPECT_EQ(granted_qos_levels[5], 0x97);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode1) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode2) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode3) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode4) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode5) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode6) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode7) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode8) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode9) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode10) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode11) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode12) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode13) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode14) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode15) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode16) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode17) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode18) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode19) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode20) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode21) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode22) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode23) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode24) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode25) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode26) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode27) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode28) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode29) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection []
TEST(Disco311QCTest, Encode30) {
uint8_t pkt[] = {0xe0, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT311, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoMessageRateTooHigh [PropReasonString "\225\ENQ<\232\197\144\236\DLESJ\182g~~\230\252\ETX\231",PropContentType "\205\232\136\DC3Z~\156x\FS\223\228\203",PropWillDelayInterval 26618,PropCorrelationData "\228\r\236\237\t\188\136\EOTo\204tPm\DEL\232{'\153\209\196",PropTopicAlias 6948,PropSubscriptionIdentifier 23,PropAssignedClientIdentifier "\238\214\184\137D\251",PropMessageExpiryInterval 6626,PropAssignedClientIdentifier "\151e\219\254\131\134\177\f`\155\194\&3\SUB]\147\ESC\151",PropSharedSubscriptionAvailable 191,PropPayloadFormatIndicator 226,PropAssignedClientIdentifier "S\DC3%x\146\184\210\242\ENQf\228@S-\ETX\231\\\t\173^]\254\231B#S%6",PropTopicAliasMaximum 13418,PropResponseTopic "\bo\208~\176vG\EM\171=",PropWillDelayInterval 5695,PropCorrelationData "t\207\138\SOHXL\139R\201\200\220\145m",PropMessageExpiryInterval 4237,PropReceiveMaximum 27811,PropSubscriptionIdentifierAvailable 116,PropResponseTopic "",PropMessageExpiryInterval 25556,PropMaximumQoS 160,PropResponseTopic "O8\t\226\169\146\ENQ\159s\181\te\226\137\154\"",PropCorrelationData "\144\\X[\203\148\246D>\141 \233S\143",PropRequestProblemInformation 170,PropServerKeepAlive 12755]
TEST(Disco5QCTest, Encode1) {
uint8_t pkt[] = {0xe0, 0xef, 0x1, 0x96, 0xec, 0x1, 0x1f, 0x0, 0x12, 0xe1, 0x5, 0x3c, 0xe8, 0xc5, 0x90, 0xec, 0x10, 0x53, 0x4a, 0xb6, 0x67, 0x7e, 0x7e, 0xe6, 0xfc, 0x3, 0xe7, 0x3, 0x0, 0xc, 0xcd, 0xe8, 0x88, 0x13, 0x5a, 0x7e, 0x9c, 0x78, 0x1c, 0xdf, 0xe4, 0xcb, 0x18, 0x0, 0x0, 0x67, 0xfa, 0x9, 0x0, 0x14, 0xe4, 0xd, 0xec, 0xed, 0x9, 0xbc, 0x88, 0x4, 0x6f, 0xcc, 0x74, 0x50, 0x6d, 0x7f, 0xe8, 0x7b, 0x27, 0x99, 0xd1, 0xc4, 0x23, 0x1b, 0x24, 0xb, 0x17, 0x12, 0x0, 0x6, 0xee, 0xd6, 0xb8, 0x89, 0x44, 0xfb, 0x2, 0x0, 0x0, 0x19, 0xe2, 0x12, 0x0, 0x11, 0x97, 0x65, 0xdb, 0xfe, 0x83, 0x86, 0xb1, 0xc, 0x60, 0x9b, 0xc2, 0x33, 0x1a, 0x5d, 0x93, 0x1b, 0x97, 0x2a, 0xbf, 0x1, 0xe2, 0x12, 0x0, 0x1c, 0x53, 0x13, 0x25, 0x78, 0x92, 0xb8, 0xd2, 0xf2, 0x5, 0x66, 0xe4, 0x40, 0x53, 0x2d, 0x3, 0xe7, 0x5c, 0x9, 0xad, 0x5e, 0x5d, 0xfe, 0xe7, 0x42, 0x23, 0x53, 0x25, 0x36, 0x22, 0x34, 0x6a, 0x8, 0x0, 0xa, 0x8, 0x6f, 0xd0, 0x7e, 0xb0, 0x76, 0x47, 0x19, 0xab, 0x3d, 0x18, 0x0, 0x0, 0x16, 0x3f, 0x9, 0x0, 0xd, 0x74, 0xcf, 0x8a, 0x1, 0x58, 0x4c, 0x8b, 0x52, 0xc9, 0xc8, 0xdc, 0x91, 0x6d, 0x2, 0x0, 0x0, 0x10, 0x8d, 0x21, 0x6c, 0xa3, 0x29, 0x74, 0x8, 0x0, 0x0, 0x2, 0x0, 0x0, 0x63, 0xd4, 0x24, 0xa0, 0x8, 0x0, 0x10, 0x4f, 0x38, 0x9, 0xe2, 0xa9, 0x92, 0x5, 0x9f, 0x73, 0xb5, 0x9, 0x65, 0xe2, 0x89, 0x9a, 0x22, 0x9, 0x0, 0xe, 0x90, 0x5c, 0x58, 0x5b, 0xcb, 0x94, 0xf6, 0x44, 0x3e, 0x8d, 0x20, 0xe9, 0x53, 0x8f, 0x17, 0xaa, 0x13, 0x31, 0xd3};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xe1, 0x5, 0x3c, 0xe8, 0xc5, 0x90, 0xec, 0x10, 0x53, 0x4a, 0xb6, 0x67, 0x7e, 0x7e, 0xe6, 0xfc, 0x3, 0xe7};
  uint8_t bytesprops1[] = {0xcd, 0xe8, 0x88, 0x13, 0x5a, 0x7e, 0x9c, 0x78, 0x1c, 0xdf, 0xe4, 0xcb};
  uint8_t bytesprops2[] = {0xe4, 0xd, 0xec, 0xed, 0x9, 0xbc, 0x88, 0x4, 0x6f, 0xcc, 0x74, 0x50, 0x6d, 0x7f, 0xe8, 0x7b, 0x27, 0x99, 0xd1, 0xc4};
  uint8_t bytesprops3[] = {0xee, 0xd6, 0xb8, 0x89, 0x44, 0xfb};
  uint8_t bytesprops4[] = {0x97, 0x65, 0xdb, 0xfe, 0x83, 0x86, 0xb1, 0xc, 0x60, 0x9b, 0xc2, 0x33, 0x1a, 0x5d, 0x93, 0x1b, 0x97};
  uint8_t bytesprops5[] = {0x53, 0x13, 0x25, 0x78, 0x92, 0xb8, 0xd2, 0xf2, 0x5, 0x66, 0xe4, 0x40, 0x53, 0x2d, 0x3, 0xe7, 0x5c, 0x9, 0xad, 0x5e, 0x5d, 0xfe, 0xe7, 0x42, 0x23, 0x53, 0x25, 0x36};
  uint8_t bytesprops6[] = {0x8, 0x6f, 0xd0, 0x7e, 0xb0, 0x76, 0x47, 0x19, 0xab, 0x3d};
  uint8_t bytesprops7[] = {0x74, 0xcf, 0x8a, 0x1, 0x58, 0x4c, 0x8b, 0x52, 0xc9, 0xc8, 0xdc, 0x91, 0x6d};
  uint8_t bytesprops8[] = {0};
  uint8_t bytesprops9[] = {0x4f, 0x38, 0x9, 0xe2, 0xa9, 0x92, 0x5, 0x9f, 0x73, 0xb5, 0x9, 0x65, 0xe2, 0x89, 0x9a, 0x22};
  uint8_t bytesprops10[] = {0x90, 0x5c, 0x58, 0x5b, 0xcb, 0x94, 0xf6, 0x44, 0x3e, 0x8d, 0x20, 0xe9, 0x53, 0x8f};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {18, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {12, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26618}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6948}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 23}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {6, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6626}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 191}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 226}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {28, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13418}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {10, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5695}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4237}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 27811}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 116}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {0, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25556}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 160}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {16, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 170}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12755}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 150, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoKeepAliveTimeout [PropSubscriptionIdentifier 16,PropReasonString "\DLEC\171",PropAuthenticationMethod "z\161_a\195\160\230m",PropResponseInformation "c.\DC3f\238\255-\174\148\222\152\231BA\SYN\252",PropReasonString "\186]H\146bz\\\228PE)?\155 \SUB\255{",PropReceiveMaximum 18866,PropAuthenticationData "kz\227\GS\219\205",PropWillDelayInterval 29972,PropUserProperty "\233\137\rD\208_\149\227\254\ETB\216\203\243a\147\"\USJ\242\182\143W\231k\162\243\rIb\252" "JT\231\143S\v\166^q\134;\EOT\149PX\145\148\STX\168\&8\169j\245\237",PropContentType "\143\195AB\161\151\234\SOv\243",PropRetainAvailable 162,PropSharedSubscriptionAvailable 171,PropWildcardSubscriptionAvailable 64,PropAuthenticationData "\226(\221",PropSessionExpiryInterval 15912,PropSubscriptionIdentifierAvailable 56,PropMaximumPacketSize 11188,PropRequestResponseInformation 77,PropServerReference "zc,\221?\r\255\250\DLE\222h\130K\247\169\176K\135\198\244JZ\159\192\215",PropMaximumPacketSize 19726,PropRequestResponseInformation 136,PropResponseTopic "\203\192\185)#\SOH\a\219\206<\b\FS\219\\",PropResponseTopic "WzS\142r\209\176\231\213\203!2\NUL!^\205\199\147\155\216\SI\200|2",PropMessageExpiryInterval 31378,PropRetainAvailable 155,PropServerKeepAlive 12042]
TEST(Disco5QCTest, Encode2) {
uint8_t pkt[] = {0xe0, 0x89, 0x2, 0x8d, 0x86, 0x2, 0xb, 0x10, 0x1f, 0x0, 0x3, 0x10, 0x43, 0xab, 0x15, 0x0, 0x8, 0x7a, 0xa1, 0x5f, 0x61, 0xc3, 0xa0, 0xe6, 0x6d, 0x1a, 0x0, 0x10, 0x63, 0x2e, 0x13, 0x66, 0xee, 0xff, 0x2d, 0xae, 0x94, 0xde, 0x98, 0xe7, 0x42, 0x41, 0x16, 0xfc, 0x1f, 0x0, 0x11, 0xba, 0x5d, 0x48, 0x92, 0x62, 0x7a, 0x5c, 0xe4, 0x50, 0x45, 0x29, 0x3f, 0x9b, 0x20, 0x1a, 0xff, 0x7b, 0x21, 0x49, 0xb2, 0x16, 0x0, 0x6, 0x6b, 0x7a, 0xe3, 0x1d, 0xdb, 0xcd, 0x18, 0x0, 0x0, 0x75, 0x14, 0x26, 0x0, 0x1e, 0xe9, 0x89, 0xd, 0x44, 0xd0, 0x5f, 0x95, 0xe3, 0xfe, 0x17, 0xd8, 0xcb, 0xf3, 0x61, 0x93, 0x22, 0x1f, 0x4a, 0xf2, 0xb6, 0x8f, 0x57, 0xe7, 0x6b, 0xa2, 0xf3, 0xd, 0x49, 0x62, 0xfc, 0x0, 0x18, 0x4a, 0x54, 0xe7, 0x8f, 0x53, 0xb, 0xa6, 0x5e, 0x71, 0x86, 0x3b, 0x4, 0x95, 0x50, 0x58, 0x91, 0x94, 0x2, 0xa8, 0x38, 0xa9, 0x6a, 0xf5, 0xed, 0x3, 0x0, 0xa, 0x8f, 0xc3, 0x41, 0x42, 0xa1, 0x97, 0xea, 0xe, 0x76, 0xf3, 0x25, 0xa2, 0x2a, 0xab, 0x28, 0x40, 0x16, 0x0, 0x3, 0xe2, 0x28, 0xdd, 0x11, 0x0, 0x0, 0x3e, 0x28, 0x29, 0x38, 0x27, 0x0, 0x0, 0x2b, 0xb4, 0x19, 0x4d, 0x1c, 0x0, 0x19, 0x7a, 0x63, 0x2c, 0xdd, 0x3f, 0xd, 0xff, 0xfa, 0x10, 0xde, 0x68, 0x82, 0x4b, 0xf7, 0xa9, 0xb0, 0x4b, 0x87, 0xc6, 0xf4, 0x4a, 0x5a, 0x9f, 0xc0, 0xd7, 0x27, 0x0, 0x0, 0x4d, 0xe, 0x19, 0x88, 0x8, 0x0, 0xe, 0xcb, 0xc0, 0xb9, 0x29, 0x23, 0x1, 0x7, 0xdb, 0xce, 0x3c, 0x8, 0x1c, 0xdb, 0x5c, 0x8, 0x0, 0x18, 0x57, 0x7a, 0x53, 0x8e, 0x72, 0xd1, 0xb0, 0xe7, 0xd5, 0xcb, 0x21, 0x32, 0x0, 0x21, 0x5e, 0xcd, 0xc7, 0x93, 0x9b, 0xd8, 0xf, 0xc8, 0x7c, 0x32, 0x2, 0x0, 0x0, 0x7a, 0x92, 0x25, 0x9b, 0x13, 0x2f, 0xa};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x10, 0x43, 0xab};
  uint8_t bytesprops1[] = {0x7a, 0xa1, 0x5f, 0x61, 0xc3, 0xa0, 0xe6, 0x6d};
  uint8_t bytesprops2[] = {0x63, 0x2e, 0x13, 0x66, 0xee, 0xff, 0x2d, 0xae, 0x94, 0xde, 0x98, 0xe7, 0x42, 0x41, 0x16, 0xfc};
  uint8_t bytesprops3[] = {0xba, 0x5d, 0x48, 0x92, 0x62, 0x7a, 0x5c, 0xe4, 0x50, 0x45, 0x29, 0x3f, 0x9b, 0x20, 0x1a, 0xff, 0x7b};
  uint8_t bytesprops4[] = {0x6b, 0x7a, 0xe3, 0x1d, 0xdb, 0xcd};
  uint8_t bytesprops6[] = {0x4a, 0x54, 0xe7, 0x8f, 0x53, 0xb, 0xa6, 0x5e, 0x71, 0x86, 0x3b, 0x4, 0x95, 0x50, 0x58, 0x91, 0x94, 0x2, 0xa8, 0x38, 0xa9, 0x6a, 0xf5, 0xed};
  uint8_t bytesprops5[] = {0xe9, 0x89, 0xd, 0x44, 0xd0, 0x5f, 0x95, 0xe3, 0xfe, 0x17, 0xd8, 0xcb, 0xf3, 0x61, 0x93, 0x22, 0x1f, 0x4a, 0xf2, 0xb6, 0x8f, 0x57, 0xe7, 0x6b, 0xa2, 0xf3, 0xd, 0x49, 0x62, 0xfc};
  uint8_t bytesprops7[] = {0x8f, 0xc3, 0x41, 0x42, 0xa1, 0x97, 0xea, 0xe, 0x76, 0xf3};
  uint8_t bytesprops8[] = {0xe2, 0x28, 0xdd};
  uint8_t bytesprops9[] = {0x7a, 0x63, 0x2c, 0xdd, 0x3f, 0xd, 0xff, 0xfa, 0x10, 0xde, 0x68, 0x82, 0x4b, 0xf7, 0xa9, 0xb0, 0x4b, 0x87, 0xc6, 0xf4, 0x4a, 0x5a, 0x9f, 0xc0, 0xd7};
  uint8_t bytesprops10[] = {0xcb, 0xc0, 0xb9, 0x29, 0x23, 0x1, 0x7, 0xdb, 0xce, 0x3c, 0x8, 0x1c, 0xdb, 0x5c};
  uint8_t bytesprops11[] = {0x57, 0x7a, 0x53, 0x8e, 0x72, 0xd1, 0xb0, 0xe7, 0xd5, 0xcb, 0x21, 0x32, 0x0, 0x21, 0x5e, 0xcd, 0xc7, 0x93, 0x9b, 0xd8, 0xf, 0xc8, 0x7c, 0x32};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 16}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {16, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {17, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 18866}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {6, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29972}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={30, (char*)&bytesprops5}, .v={24, (char*)&bytesprops6}}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {10, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 162}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 171}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 64}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {3, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 15912}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 56}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 11188}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 77}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 19726}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 136}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {14, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {24, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31378}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 155}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12042}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 141, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoTopicNameInvalid [PropSubscriptionIdentifier 29,PropServerKeepAlive 7482,PropAuthenticationData "\STX\FS7\ENQ",PropMessageExpiryInterval 19184,PropSubscriptionIdentifierAvailable 165,PropResponseInformation "\DC1\201<\140\241N\169px\233\166_Z\196\185\131:\246\240S\205",PropSubscriptionIdentifierAvailable 196,PropSubscriptionIdentifier 21,PropSubscriptionIdentifierAvailable 193]
TEST(Disco5QCTest, Encode3) {
uint8_t pkt[] = {0xe0, 0x33, 0x90, 0x31, 0xb, 0x1d, 0x13, 0x1d, 0x3a, 0x16, 0x0, 0x4, 0x2, 0x1c, 0x37, 0x5, 0x2, 0x0, 0x0, 0x4a, 0xf0, 0x29, 0xa5, 0x1a, 0x0, 0x15, 0x11, 0xc9, 0x3c, 0x8c, 0xf1, 0x4e, 0xa9, 0x70, 0x78, 0xe9, 0xa6, 0x5f, 0x5a, 0xc4, 0xb9, 0x83, 0x3a, 0xf6, 0xf0, 0x53, 0xcd, 0x29, 0xc4, 0xb, 0x15, 0x29, 0xc1};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x2, 0x1c, 0x37, 0x5};
  uint8_t bytesprops1[] = {0x11, 0xc9, 0x3c, 0x8c, 0xf1, 0x4e, 0xa9, 0x70, 0x78, 0xe9, 0xa6, 0x5f, 0x5a, 0xc4, 0xb9, 0x83, 0x3a, 0xf6, 0xf0, 0x53, 0xcd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 29}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7482}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {4, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19184}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 165}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {21, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 196}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 21}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 193}},
  };

  lwmqtt_properties_t props = {9, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 144, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoKeepAliveTimeout [PropContentType "j\214j",PropSubscriptionIdentifier 5,PropMessageExpiryInterval 16922,PropResponseInformation "\203\148\158\DELn\245\199\n\v\141",PropCorrelationData "\166T-\f\139\137M=A\192\230\ETB\129",PropCorrelationData "j\145\225=W\215\169\GS\255_T\205\148"]
TEST(Disco5QCTest, Encode4) {
uint8_t pkt[] = {0xe0, 0x3c, 0x8d, 0x3a, 0x3, 0x0, 0x3, 0x6a, 0xd6, 0x6a, 0xb, 0x5, 0x2, 0x0, 0x0, 0x42, 0x1a, 0x1a, 0x0, 0xa, 0xcb, 0x94, 0x9e, 0x7f, 0x6e, 0xf5, 0xc7, 0xa, 0xb, 0x8d, 0x9, 0x0, 0xd, 0xa6, 0x54, 0x2d, 0xc, 0x8b, 0x89, 0x4d, 0x3d, 0x41, 0xc0, 0xe6, 0x17, 0x81, 0x9, 0x0, 0xd, 0x6a, 0x91, 0xe1, 0x3d, 0x57, 0xd7, 0xa9, 0x1d, 0xff, 0x5f, 0x54, 0xcd, 0x94};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x6a, 0xd6, 0x6a};
  uint8_t bytesprops1[] = {0xcb, 0x94, 0x9e, 0x7f, 0x6e, 0xf5, 0xc7, 0xa, 0xb, 0x8d};
  uint8_t bytesprops2[] = {0xa6, 0x54, 0x2d, 0xc, 0x8b, 0x89, 0x4d, 0x3d, 0x41, 0xc0, 0xe6, 0x17, 0x81};
  uint8_t bytesprops3[] = {0x6a, 0x91, 0xe1, 0x3d, 0x57, 0xd7, 0xa9, 0x1d, 0xff, 0x5f, 0x54, 0xcd, 0x94};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {3, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 5}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16922}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops3}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 141, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoQoSNotSupported [PropTopicAlias 24397,PropReceiveMaximum 21691,PropContentType "\180n\NAK\249M\179\130\189:\158\145",PropSharedSubscriptionAvailable 27,PropContentType "\241=\180G\NAK\142",PropAssignedClientIdentifier "+\254P\217D\137\218r`\160\248|\142\&5\179\DC3C4G~",PropSharedSubscriptionAvailable 87,PropMaximumPacketSize 10553,PropTopicAlias 30553,PropSubscriptionIdentifier 15,PropTopicAlias 22925,PropResponseTopic "\NULR\ETX}\248$\164\207z\173.Z\136\249o\185\196\140\166",PropSubscriptionIdentifier 6,PropSharedSubscriptionAvailable 64,PropPayloadFormatIndicator 146,PropMaximumQoS 24,PropRetainAvailable 210,PropServerKeepAlive 23235,PropTopicAlias 14682,PropReasonString "-N\188\"\GS}I\158t\132W",PropMessageExpiryInterval 4570,PropSubscriptionIdentifierAvailable 144,PropAuthenticationData "<"]
TEST(Disco5QCTest, Encode5) {
uint8_t pkt[] = {0xe0, 0x87, 0x1, 0x9b, 0x84, 0x1, 0x23, 0x5f, 0x4d, 0x21, 0x54, 0xbb, 0x3, 0x0, 0xb, 0xb4, 0x6e, 0x15, 0xf9, 0x4d, 0xb3, 0x82, 0xbd, 0x3a, 0x9e, 0x91, 0x2a, 0x1b, 0x3, 0x0, 0x6, 0xf1, 0x3d, 0xb4, 0x47, 0x15, 0x8e, 0x12, 0x0, 0x14, 0x2b, 0xfe, 0x50, 0xd9, 0x44, 0x89, 0xda, 0x72, 0x60, 0xa0, 0xf8, 0x7c, 0x8e, 0x35, 0xb3, 0x13, 0x43, 0x34, 0x47, 0x7e, 0x2a, 0x57, 0x27, 0x0, 0x0, 0x29, 0x39, 0x23, 0x77, 0x59, 0xb, 0xf, 0x23, 0x59, 0x8d, 0x8, 0x0, 0x13, 0x0, 0x52, 0x3, 0x7d, 0xf8, 0x24, 0xa4, 0xcf, 0x7a, 0xad, 0x2e, 0x5a, 0x88, 0xf9, 0x6f, 0xb9, 0xc4, 0x8c, 0xa6, 0xb, 0x6, 0x2a, 0x40, 0x1, 0x92, 0x24, 0x18, 0x25, 0xd2, 0x13, 0x5a, 0xc3, 0x23, 0x39, 0x5a, 0x1f, 0x0, 0xb, 0x2d, 0x4e, 0xbc, 0x22, 0x1d, 0x7d, 0x49, 0x9e, 0x74, 0x84, 0x57, 0x2, 0x0, 0x0, 0x11, 0xda, 0x29, 0x90, 0x16, 0x0, 0x1, 0x3c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xb4, 0x6e, 0x15, 0xf9, 0x4d, 0xb3, 0x82, 0xbd, 0x3a, 0x9e, 0x91};
  uint8_t bytesprops1[] = {0xf1, 0x3d, 0xb4, 0x47, 0x15, 0x8e};
  uint8_t bytesprops2[] = {0x2b, 0xfe, 0x50, 0xd9, 0x44, 0x89, 0xda, 0x72, 0x60, 0xa0, 0xf8, 0x7c, 0x8e, 0x35, 0xb3, 0x13, 0x43, 0x34, 0x47, 0x7e};
  uint8_t bytesprops3[] = {0x0, 0x52, 0x3, 0x7d, 0xf8, 0x24, 0xa4, 0xcf, 0x7a, 0xad, 0x2e, 0x5a, 0x88, 0xf9, 0x6f, 0xb9, 0xc4, 0x8c, 0xa6};
  uint8_t bytesprops4[] = {0x2d, 0x4e, 0xbc, 0x22, 0x1d, 0x7d, 0x49, 0x9e, 0x74, 0x84, 0x57};
  uint8_t bytesprops5[] = {0x3c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 24397}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 21691}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 27}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 87}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10553}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30553}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 15}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22925}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 6}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 64}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 146}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 24}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 210}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 23235}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14682}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {11, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4570}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 144}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 155, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoConnectionRateExceeded [PropUserProperty "\150\ACKW\r_\178\224\254\203\251y\190m\185\142\am\160x\DC4\181\209\162]" "\227\133U\226\&4\213\186\167\NUL\233I\174]\144\144\v\173=\194\DC2\166H\220\236\243",PropWildcardSubscriptionAvailable 112,PropAuthenticationMethod "\147\140\SO$\189.\247h\152\&5\160\181\183^\231\172\182",PropPayloadFormatIndicator 194,PropRetainAvailable 213]
TEST(Disco5QCTest, Encode6) {
uint8_t pkt[] = {0xe0, 0x52, 0x9f, 0x50, 0x26, 0x0, 0x18, 0x96, 0x6, 0x57, 0xd, 0x5f, 0xb2, 0xe0, 0xfe, 0xcb, 0xfb, 0x79, 0xbe, 0x6d, 0xb9, 0x8e, 0x7, 0x6d, 0xa0, 0x78, 0x14, 0xb5, 0xd1, 0xa2, 0x5d, 0x0, 0x19, 0xe3, 0x85, 0x55, 0xe2, 0x34, 0xd5, 0xba, 0xa7, 0x0, 0xe9, 0x49, 0xae, 0x5d, 0x90, 0x90, 0xb, 0xad, 0x3d, 0xc2, 0x12, 0xa6, 0x48, 0xdc, 0xec, 0xf3, 0x28, 0x70, 0x15, 0x0, 0x11, 0x93, 0x8c, 0xe, 0x24, 0xbd, 0x2e, 0xf7, 0x68, 0x98, 0x35, 0xa0, 0xb5, 0xb7, 0x5e, 0xe7, 0xac, 0xb6, 0x1, 0xc2, 0x25, 0xd5};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops1[] = {0xe3, 0x85, 0x55, 0xe2, 0x34, 0xd5, 0xba, 0xa7, 0x0, 0xe9, 0x49, 0xae, 0x5d, 0x90, 0x90, 0xb, 0xad, 0x3d, 0xc2, 0x12, 0xa6, 0x48, 0xdc, 0xec, 0xf3};
  uint8_t bytesprops0[] = {0x96, 0x6, 0x57, 0xd, 0x5f, 0xb2, 0xe0, 0xfe, 0xcb, 0xfb, 0x79, 0xbe, 0x6d, 0xb9, 0x8e, 0x7, 0x6d, 0xa0, 0x78, 0x14, 0xb5, 0xd1, 0xa2, 0x5d};
  uint8_t bytesprops2[] = {0x93, 0x8c, 0xe, 0x24, 0xbd, 0x2e, 0xf7, 0x68, 0x98, 0x35, 0xa0, 0xb5, 0xb7, 0x5e, 0xe7, 0xac, 0xb6};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={24, (char*)&bytesprops0}, .v={25, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 112}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 194}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 213}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 159, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoTopicFilterInvalid [PropTopicAliasMaximum 7050,PropRequestProblemInformation 59,PropMaximumPacketSize 14933,PropContentType "a\187\241l\134&\203N\CAN\194\&25,\172\ETX\239\189L\ETXOc\187",PropResponseInformation "\227;\195#r\237\150\245we\176|\207\ENQ\237\SI|\144\194\202@\181\217LH\amK",PropAuthenticationMethod "|_\202\226\237\225u\ETB\248\EM\178}\162v\177&\"\228^H",PropRequestResponseInformation 147]
TEST(Disco5QCTest, Encode7) {
uint8_t pkt[] = {0xe0, 0x5d, 0x8f, 0x5b, 0x22, 0x1b, 0x8a, 0x17, 0x3b, 0x27, 0x0, 0x0, 0x3a, 0x55, 0x3, 0x0, 0x16, 0x61, 0xbb, 0xf1, 0x6c, 0x86, 0x26, 0xcb, 0x4e, 0x18, 0xc2, 0x32, 0x35, 0x2c, 0xac, 0x3, 0xef, 0xbd, 0x4c, 0x3, 0x4f, 0x63, 0xbb, 0x1a, 0x0, 0x1c, 0xe3, 0x3b, 0xc3, 0x23, 0x72, 0xed, 0x96, 0xf5, 0x77, 0x65, 0xb0, 0x7c, 0xcf, 0x5, 0xed, 0xf, 0x7c, 0x90, 0xc2, 0xca, 0x40, 0xb5, 0xd9, 0x4c, 0x48, 0x7, 0x6d, 0x4b, 0x15, 0x0, 0x14, 0x7c, 0x5f, 0xca, 0xe2, 0xed, 0xe1, 0x75, 0x17, 0xf8, 0x19, 0xb2, 0x7d, 0xa2, 0x76, 0xb1, 0x26, 0x22, 0xe4, 0x5e, 0x48, 0x19, 0x93};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x61, 0xbb, 0xf1, 0x6c, 0x86, 0x26, 0xcb, 0x4e, 0x18, 0xc2, 0x32, 0x35, 0x2c, 0xac, 0x3, 0xef, 0xbd, 0x4c, 0x3, 0x4f, 0x63, 0xbb};
  uint8_t bytesprops1[] = {0xe3, 0x3b, 0xc3, 0x23, 0x72, 0xed, 0x96, 0xf5, 0x77, 0x65, 0xb0, 0x7c, 0xcf, 0x5, 0xed, 0xf, 0x7c, 0x90, 0xc2, 0xca, 0x40, 0xb5, 0xd9, 0x4c, 0x48, 0x7, 0x6d, 0x4b};
  uint8_t bytesprops2[] = {0x7c, 0x5f, 0xca, 0xe2, 0xed, 0xe1, 0x75, 0x17, 0xf8, 0x19, 0xb2, 0x7d, 0xa2, 0x76, 0xb1, 0x26, 0x22, 0xe4, 0x5e, 0x48};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 7050}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 59}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 14933}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 147}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 143, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoServerMoved [PropAuthenticationData "\133\aV\218f{\DEL+0Z\254\160\142\DC2{*`\bb^d\ACK\183\174nO\174",PropRetainAvailable 100,PropUserProperty "\130\226" "f+\145\172\214a%\153\151\186",PropRetainAvailable 2,PropServerKeepAlive 19057,PropAssignedClientIdentifier "#X\b\242~:\246X\SUBo\155v~\ESC\189\185\159i\203",PropCorrelationData "\199z\242Bv\210\&0\187\240\144\198\247",PropAuthenticationData ">L^\162\189L\b\166\v\FS\139Q&\EM4\232\156\231\212H\174\244\t\188\202\154",PropSharedSubscriptionAvailable 88,PropMaximumPacketSize 12821,PropAssignedClientIdentifier "R\179\151\210~Yl5\218\208k\180\159K\176\138",PropAuthenticationMethod "\v\188k\163W\SOH",PropReasonString "\162\SOH\180HL\222\245H\v\DC3",PropReceiveMaximum 20007,PropWillDelayInterval 23538,PropMessageExpiryInterval 21495,PropResponseInformation "\149\241\223\&2\EM\NAK\249G",PropMessageExpiryInterval 13410,PropResponseInformation "\166\235k0\187Z\202\248\195\173\STX\232O\131\217\n\165\197}\201\137\148\152\242-\202",PropMessageExpiryInterval 22642,PropRequestProblemInformation 120,PropResponseInformation "n\NAK3\174T\146\196\SI\170\147\&2p\129\255um6\194\DC3\ETB+[\147\&6\146\202\"(",PropRetainAvailable 42,PropRequestProblemInformation 109,PropMaximumPacketSize 25224]
TEST(Disco5QCTest, Encode8) {
uint8_t pkt[] = {0xe0, 0x94, 0x2, 0x9d, 0x91, 0x2, 0x16, 0x0, 0x1b, 0x85, 0x7, 0x56, 0xda, 0x66, 0x7b, 0x7f, 0x2b, 0x30, 0x5a, 0xfe, 0xa0, 0x8e, 0x12, 0x7b, 0x2a, 0x60, 0x8, 0x62, 0x5e, 0x64, 0x6, 0xb7, 0xae, 0x6e, 0x4f, 0xae, 0x25, 0x64, 0x26, 0x0, 0x2, 0x82, 0xe2, 0x0, 0xa, 0x66, 0x2b, 0x91, 0xac, 0xd6, 0x61, 0x25, 0x99, 0x97, 0xba, 0x25, 0x2, 0x13, 0x4a, 0x71, 0x12, 0x0, 0x13, 0x23, 0x58, 0x8, 0xf2, 0x7e, 0x3a, 0xf6, 0x58, 0x1a, 0x6f, 0x9b, 0x76, 0x7e, 0x1b, 0xbd, 0xb9, 0x9f, 0x69, 0xcb, 0x9, 0x0, 0xc, 0xc7, 0x7a, 0xf2, 0x42, 0x76, 0xd2, 0x30, 0xbb, 0xf0, 0x90, 0xc6, 0xf7, 0x16, 0x0, 0x1a, 0x3e, 0x4c, 0x5e, 0xa2, 0xbd, 0x4c, 0x8, 0xa6, 0xb, 0x1c, 0x8b, 0x51, 0x26, 0x19, 0x34, 0xe8, 0x9c, 0xe7, 0xd4, 0x48, 0xae, 0xf4, 0x9, 0xbc, 0xca, 0x9a, 0x2a, 0x58, 0x27, 0x0, 0x0, 0x32, 0x15, 0x12, 0x0, 0x10, 0x52, 0xb3, 0x97, 0xd2, 0x7e, 0x59, 0x6c, 0x35, 0xda, 0xd0, 0x6b, 0xb4, 0x9f, 0x4b, 0xb0, 0x8a, 0x15, 0x0, 0x6, 0xb, 0xbc, 0x6b, 0xa3, 0x57, 0x1, 0x1f, 0x0, 0xa, 0xa2, 0x1, 0xb4, 0x48, 0x4c, 0xde, 0xf5, 0x48, 0xb, 0x13, 0x21, 0x4e, 0x27, 0x18, 0x0, 0x0, 0x5b, 0xf2, 0x2, 0x0, 0x0, 0x53, 0xf7, 0x1a, 0x0, 0x8, 0x95, 0xf1, 0xdf, 0x32, 0x19, 0x15, 0xf9, 0x47, 0x2, 0x0, 0x0, 0x34, 0x62, 0x1a, 0x0, 0x1a, 0xa6, 0xeb, 0x6b, 0x30, 0xbb, 0x5a, 0xca, 0xf8, 0xc3, 0xad, 0x2, 0xe8, 0x4f, 0x83, 0xd9, 0xa, 0xa5, 0xc5, 0x7d, 0xc9, 0x89, 0x94, 0x98, 0xf2, 0x2d, 0xca, 0x2, 0x0, 0x0, 0x58, 0x72, 0x17, 0x78, 0x1a, 0x0, 0x1c, 0x6e, 0x15, 0x33, 0xae, 0x54, 0x92, 0xc4, 0xf, 0xaa, 0x93, 0x32, 0x70, 0x81, 0xff, 0x75, 0x6d, 0x36, 0xc2, 0x13, 0x17, 0x2b, 0x5b, 0x93, 0x36, 0x92, 0xca, 0x22, 0x28, 0x25, 0x2a, 0x17, 0x6d, 0x27, 0x0, 0x0, 0x62, 0x88};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x85, 0x7, 0x56, 0xda, 0x66, 0x7b, 0x7f, 0x2b, 0x30, 0x5a, 0xfe, 0xa0, 0x8e, 0x12, 0x7b, 0x2a, 0x60, 0x8, 0x62, 0x5e, 0x64, 0x6, 0xb7, 0xae, 0x6e, 0x4f, 0xae};
  uint8_t bytesprops2[] = {0x66, 0x2b, 0x91, 0xac, 0xd6, 0x61, 0x25, 0x99, 0x97, 0xba};
  uint8_t bytesprops1[] = {0x82, 0xe2};
  uint8_t bytesprops3[] = {0x23, 0x58, 0x8, 0xf2, 0x7e, 0x3a, 0xf6, 0x58, 0x1a, 0x6f, 0x9b, 0x76, 0x7e, 0x1b, 0xbd, 0xb9, 0x9f, 0x69, 0xcb};
  uint8_t bytesprops4[] = {0xc7, 0x7a, 0xf2, 0x42, 0x76, 0xd2, 0x30, 0xbb, 0xf0, 0x90, 0xc6, 0xf7};
  uint8_t bytesprops5[] = {0x3e, 0x4c, 0x5e, 0xa2, 0xbd, 0x4c, 0x8, 0xa6, 0xb, 0x1c, 0x8b, 0x51, 0x26, 0x19, 0x34, 0xe8, 0x9c, 0xe7, 0xd4, 0x48, 0xae, 0xf4, 0x9, 0xbc, 0xca, 0x9a};
  uint8_t bytesprops6[] = {0x52, 0xb3, 0x97, 0xd2, 0x7e, 0x59, 0x6c, 0x35, 0xda, 0xd0, 0x6b, 0xb4, 0x9f, 0x4b, 0xb0, 0x8a};
  uint8_t bytesprops7[] = {0xb, 0xbc, 0x6b, 0xa3, 0x57, 0x1};
  uint8_t bytesprops8[] = {0xa2, 0x1, 0xb4, 0x48, 0x4c, 0xde, 0xf5, 0x48, 0xb, 0x13};
  uint8_t bytesprops9[] = {0x95, 0xf1, 0xdf, 0x32, 0x19, 0x15, 0xf9, 0x47};
  uint8_t bytesprops10[] = {0xa6, 0xeb, 0x6b, 0x30, 0xbb, 0x5a, 0xca, 0xf8, 0xc3, 0xad, 0x2, 0xe8, 0x4f, 0x83, 0xd9, 0xa, 0xa5, 0xc5, 0x7d, 0xc9, 0x89, 0x94, 0x98, 0xf2, 0x2d, 0xca};
  uint8_t bytesprops11[] = {0x6e, 0x15, 0x33, 0xae, 0x54, 0x92, 0xc4, 0xf, 0xaa, 0x93, 0x32, 0x70, 0x81, 0xff, 0x75, 0x6d, 0x36, 0xc2, 0x13, 0x17, 0x2b, 0x5b, 0x93, 0x36, 0x92, 0xca, 0x22, 0x28};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {27, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 100}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={2, (char*)&bytesprops1}, .v={10, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 2}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19057}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 88}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 12821}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {6, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 20007}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 23538}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21495}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {8, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13410}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&bytesprops10}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22642}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 120}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&bytesprops11}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 109}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 25224}},
  };

  lwmqtt_properties_t props = {25, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 157, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoReceiveMaximumExceeded [PropServerKeepAlive 16952,PropMessageExpiryInterval 27410,PropResponseInformation "\135\SOHA\239\&0yy\227f\189\169\\\155\&6\233\164Ly\180\183",PropServerKeepAlive 29488,PropUserProperty "\197A\138t#\164\247\192" "\176\139K9\227M+ GBHp[,\205\&0\155`1\214QY1\220\187\217\255",PropUserProperty "oZJ\246\&1\200C\251\164\148\ENQ\200/\223\187+\228\FS\CANOM" "Z\154x6\247\138<Y\192\158\153\214\137\222\239\238\196\US\183(",PropWillDelayInterval 5336,PropRequestResponseInformation 141,PropTopicAlias 30921,PropCorrelationData "\DC1leY\179W\DC4(\237\149\202\249\133)\ESCj\234g\222\170\142\139\250\141\207",PropUserProperty "U\163\161\232\&0\154\DEL\187\136\242\199\188\EM\191x\213\208\204\168;" "\b\231",PropContentType "\239\&3\204\&6\174[\236\208N\r]\233.\129\219\184\247\153cT\"\150\205",PropPayloadFormatIndicator 199,PropTopicAliasMaximum 24628,PropWillDelayInterval 4045,PropRetainAvailable 53,PropMaximumPacketSize 31267,PropRequestResponseInformation 43,PropSubscriptionIdentifierAvailable 212,PropMaximumPacketSize 27078,PropMessageExpiryInterval 11363,PropSubscriptionIdentifierAvailable 83]
TEST(Disco5QCTest, Encode9) {
uint8_t pkt[] = {0xe0, 0xf7, 0x1, 0x93, 0xf4, 0x1, 0x13, 0x42, 0x38, 0x2, 0x0, 0x0, 0x6b, 0x12, 0x1a, 0x0, 0x14, 0x87, 0x1, 0x41, 0xef, 0x30, 0x79, 0x79, 0xe3, 0x66, 0xbd, 0xa9, 0x5c, 0x9b, 0x36, 0xe9, 0xa4, 0x4c, 0x79, 0xb4, 0xb7, 0x13, 0x73, 0x30, 0x26, 0x0, 0x8, 0xc5, 0x41, 0x8a, 0x74, 0x23, 0xa4, 0xf7, 0xc0, 0x0, 0x1b, 0xb0, 0x8b, 0x4b, 0x39, 0xe3, 0x4d, 0x2b, 0x20, 0x47, 0x42, 0x48, 0x70, 0x5b, 0x2c, 0xcd, 0x30, 0x9b, 0x60, 0x31, 0xd6, 0x51, 0x59, 0x31, 0xdc, 0xbb, 0xd9, 0xff, 0x26, 0x0, 0x15, 0x6f, 0x5a, 0x4a, 0xf6, 0x31, 0xc8, 0x43, 0xfb, 0xa4, 0x94, 0x5, 0xc8, 0x2f, 0xdf, 0xbb, 0x2b, 0xe4, 0x1c, 0x18, 0x4f, 0x4d, 0x0, 0x14, 0x5a, 0x9a, 0x78, 0x36, 0xf7, 0x8a, 0x3c, 0x59, 0xc0, 0x9e, 0x99, 0xd6, 0x89, 0xde, 0xef, 0xee, 0xc4, 0x1f, 0xb7, 0x28, 0x18, 0x0, 0x0, 0x14, 0xd8, 0x19, 0x8d, 0x23, 0x78, 0xc9, 0x9, 0x0, 0x19, 0x11, 0x6c, 0x65, 0x59, 0xb3, 0x57, 0x14, 0x28, 0xed, 0x95, 0xca, 0xf9, 0x85, 0x29, 0x1b, 0x6a, 0xea, 0x67, 0xde, 0xaa, 0x8e, 0x8b, 0xfa, 0x8d, 0xcf, 0x26, 0x0, 0x14, 0x55, 0xa3, 0xa1, 0xe8, 0x30, 0x9a, 0x7f, 0xbb, 0x88, 0xf2, 0xc7, 0xbc, 0x19, 0xbf, 0x78, 0xd5, 0xd0, 0xcc, 0xa8, 0x3b, 0x0, 0x2, 0x8, 0xe7, 0x3, 0x0, 0x17, 0xef, 0x33, 0xcc, 0x36, 0xae, 0x5b, 0xec, 0xd0, 0x4e, 0xd, 0x5d, 0xe9, 0x2e, 0x81, 0xdb, 0xb8, 0xf7, 0x99, 0x63, 0x54, 0x22, 0x96, 0xcd, 0x1, 0xc7, 0x22, 0x60, 0x34, 0x18, 0x0, 0x0, 0xf, 0xcd, 0x25, 0x35, 0x27, 0x0, 0x0, 0x7a, 0x23, 0x19, 0x2b, 0x29, 0xd4, 0x27, 0x0, 0x0, 0x69, 0xc6, 0x2, 0x0, 0x0, 0x2c, 0x63, 0x29, 0x53};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x87, 0x1, 0x41, 0xef, 0x30, 0x79, 0x79, 0xe3, 0x66, 0xbd, 0xa9, 0x5c, 0x9b, 0x36, 0xe9, 0xa4, 0x4c, 0x79, 0xb4, 0xb7};
  uint8_t bytesprops2[] = {0xb0, 0x8b, 0x4b, 0x39, 0xe3, 0x4d, 0x2b, 0x20, 0x47, 0x42, 0x48, 0x70, 0x5b, 0x2c, 0xcd, 0x30, 0x9b, 0x60, 0x31, 0xd6, 0x51, 0x59, 0x31, 0xdc, 0xbb, 0xd9, 0xff};
  uint8_t bytesprops1[] = {0xc5, 0x41, 0x8a, 0x74, 0x23, 0xa4, 0xf7, 0xc0};
  uint8_t bytesprops4[] = {0x5a, 0x9a, 0x78, 0x36, 0xf7, 0x8a, 0x3c, 0x59, 0xc0, 0x9e, 0x99, 0xd6, 0x89, 0xde, 0xef, 0xee, 0xc4, 0x1f, 0xb7, 0x28};
  uint8_t bytesprops3[] = {0x6f, 0x5a, 0x4a, 0xf6, 0x31, 0xc8, 0x43, 0xfb, 0xa4, 0x94, 0x5, 0xc8, 0x2f, 0xdf, 0xbb, 0x2b, 0xe4, 0x1c, 0x18, 0x4f, 0x4d};
  uint8_t bytesprops5[] = {0x11, 0x6c, 0x65, 0x59, 0xb3, 0x57, 0x14, 0x28, 0xed, 0x95, 0xca, 0xf9, 0x85, 0x29, 0x1b, 0x6a, 0xea, 0x67, 0xde, 0xaa, 0x8e, 0x8b, 0xfa, 0x8d, 0xcf};
  uint8_t bytesprops7[] = {0x8, 0xe7};
  uint8_t bytesprops6[] = {0x55, 0xa3, 0xa1, 0xe8, 0x30, 0x9a, 0x7f, 0xbb, 0x88, 0xf2, 0xc7, 0xbc, 0x19, 0xbf, 0x78, 0xd5, 0xd0, 0xcc, 0xa8, 0x3b};
  uint8_t bytesprops8[] = {0xef, 0x33, 0xcc, 0x36, 0xae, 0x5b, 0xec, 0xd0, 0x4e, 0xd, 0x5d, 0xe9, 0x2e, 0x81, 0xdb, 0xb8, 0xf7, 0x99, 0x63, 0x54, 0x22, 0x96, 0xcd};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 16952}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27410}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {20, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 29488}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={8, (char*)&bytesprops1}, .v={27, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={21, (char*)&bytesprops3}, .v={20, (char*)&bytesprops4}}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5336}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30921}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {25, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={20, (char*)&bytesprops6}, .v={2, (char*)&bytesprops7}}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 199}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24628}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4045}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 53}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31267}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 43}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 212}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27078}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11363}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 83}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 147, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoPayloadFormatInvalid [PropSubscriptionIdentifierAvailable 213,PropContentType "[c\182Z\ETX\143\174",PropRetainAvailable 237,PropWillDelayInterval 8289,PropContentType "\204F\135",PropResponseTopic "p\252\163\173\249\186",PropRequestProblemInformation 197,PropServerKeepAlive 30880,PropMessageExpiryInterval 13048,PropRequestProblemInformation 134,PropTopicAlias 10449,PropSubscriptionIdentifier 22,PropServerKeepAlive 15489,PropReasonString "\195\250_\ESC\SOH\225\146\165!\148\EM",PropTopicAliasMaximum 19866,PropMessageExpiryInterval 6153,PropRequestResponseInformation 120,PropTopicAlias 29492,PropAuthenticationData "\232",PropRequestProblemInformation 42,PropAuthenticationData "\212{:h\RS\159<"]
TEST(Disco5QCTest, Encode10) {
uint8_t pkt[] = {0xe0, 0x63, 0x99, 0x61, 0x29, 0xd5, 0x3, 0x0, 0x7, 0x5b, 0x63, 0xb6, 0x5a, 0x3, 0x8f, 0xae, 0x25, 0xed, 0x18, 0x0, 0x0, 0x20, 0x61, 0x3, 0x0, 0x3, 0xcc, 0x46, 0x87, 0x8, 0x0, 0x6, 0x70, 0xfc, 0xa3, 0xad, 0xf9, 0xba, 0x17, 0xc5, 0x13, 0x78, 0xa0, 0x2, 0x0, 0x0, 0x32, 0xf8, 0x17, 0x86, 0x23, 0x28, 0xd1, 0xb, 0x16, 0x13, 0x3c, 0x81, 0x1f, 0x0, 0xb, 0xc3, 0xfa, 0x5f, 0x1b, 0x1, 0xe1, 0x92, 0xa5, 0x21, 0x94, 0x19, 0x22, 0x4d, 0x9a, 0x2, 0x0, 0x0, 0x18, 0x9, 0x19, 0x78, 0x23, 0x73, 0x34, 0x16, 0x0, 0x1, 0xe8, 0x17, 0x2a, 0x16, 0x0, 0x7, 0xd4, 0x7b, 0x3a, 0x68, 0x1e, 0x9f, 0x3c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x5b, 0x63, 0xb6, 0x5a, 0x3, 0x8f, 0xae};
  uint8_t bytesprops1[] = {0xcc, 0x46, 0x87};
  uint8_t bytesprops2[] = {0x70, 0xfc, 0xa3, 0xad, 0xf9, 0xba};
  uint8_t bytesprops3[] = {0xc3, 0xfa, 0x5f, 0x1b, 0x1, 0xe1, 0x92, 0xa5, 0x21, 0x94, 0x19};
  uint8_t bytesprops4[] = {0xe8};
  uint8_t bytesprops5[] = {0xd4, 0x7b, 0x3a, 0x68, 0x1e, 0x9f, 0x3c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 213}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {7, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 237}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8289}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {3, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 197}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 30880}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13048}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 134}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10449}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 15489}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {11, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19866}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6153}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 120}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29492}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 42}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {7, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 153, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoNormalDisconnection [PropCorrelationData "\160\217?\221\187\153\242\&9\216\209\196",PropSubscriptionIdentifier 1,PropSharedSubscriptionAvailable 62,PropAuthenticationData "\220\DC2w\155\255\219\147\NAK\186]\SI?-\242\&9\155IYql\180\164q\150\a\NUL\171\GS",PropReasonString "\242/\129\145\SI\148\182\&4T\182R\139^\239;B\246\193jU",PropRequestProblemInformation 162,PropResponseInformation "N\208u\215P\161h\EOT(\243",PropReceiveMaximum 2412]
TEST(Disco5QCTest, Encode11) {
uint8_t pkt[] = {0xe0, 0x5c, 0x0, 0x5a, 0x9, 0x0, 0xb, 0xa0, 0xd9, 0x3f, 0xdd, 0xbb, 0x99, 0xf2, 0x39, 0xd8, 0xd1, 0xc4, 0xb, 0x1, 0x2a, 0x3e, 0x16, 0x0, 0x1c, 0xdc, 0x12, 0x77, 0x9b, 0xff, 0xdb, 0x93, 0x15, 0xba, 0x5d, 0xf, 0x3f, 0x2d, 0xf2, 0x39, 0x9b, 0x49, 0x59, 0x71, 0x6c, 0xb4, 0xa4, 0x71, 0x96, 0x7, 0x0, 0xab, 0x1d, 0x1f, 0x0, 0x14, 0xf2, 0x2f, 0x81, 0x91, 0xf, 0x94, 0xb6, 0x34, 0x54, 0xb6, 0x52, 0x8b, 0x5e, 0xef, 0x3b, 0x42, 0xf6, 0xc1, 0x6a, 0x55, 0x17, 0xa2, 0x1a, 0x0, 0xa, 0x4e, 0xd0, 0x75, 0xd7, 0x50, 0xa1, 0x68, 0x4, 0x28, 0xf3, 0x21, 0x9, 0x6c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xa0, 0xd9, 0x3f, 0xdd, 0xbb, 0x99, 0xf2, 0x39, 0xd8, 0xd1, 0xc4};
  uint8_t bytesprops1[] = {0xdc, 0x12, 0x77, 0x9b, 0xff, 0xdb, 0x93, 0x15, 0xba, 0x5d, 0xf, 0x3f, 0x2d, 0xf2, 0x39, 0x9b, 0x49, 0x59, 0x71, 0x6c, 0xb4, 0xa4, 0x71, 0x96, 0x7, 0x0, 0xab, 0x1d};
  uint8_t bytesprops2[] = {0xf2, 0x2f, 0x81, 0x91, 0xf, 0x94, 0xb6, 0x34, 0x54, 0xb6, 0x52, 0x8b, 0x5e, 0xef, 0x3b, 0x42, 0xf6, 0xc1, 0x6a, 0x55};
  uint8_t bytesprops3[] = {0x4e, 0xd0, 0x75, 0xd7, 0x50, 0xa1, 0x68, 0x4, 0x28, 0xf3};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {11, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 1}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 62}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 162}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 2412}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 0, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoPacketTooLarge [PropTopicAliasMaximum 2818,PropMessageExpiryInterval 28513,PropRequestProblemInformation 93,PropMessageExpiryInterval 9700,PropReasonString "0\244'&\nU\SUB\162\136e\ACKlu\243^\168@\DEL\b EP4\188\&2\131=Y\155",PropMaximumPacketSize 16244,PropMessageExpiryInterval 28664,PropPayloadFormatIndicator 101,PropMaximumQoS 157,PropServerReference "J\191\EOT\218\EM\175p\GSh \131\170\178v8SA\140o(\231\245\199r}O\SUB\191a\246",PropRequestResponseInformation 232,PropSessionExpiryInterval 5258,PropServerReference "\254I\189\215\&4l\STX\201l/\190$\243\DC4\174k\191\146>oFY\RS^\237",PropReasonString "\168\141\189f\166",PropSessionExpiryInterval 7969]
TEST(Disco5QCTest, Encode12) {
uint8_t pkt[] = {0xe0, 0x91, 0x1, 0x95, 0x8e, 0x1, 0x22, 0xb, 0x2, 0x2, 0x0, 0x0, 0x6f, 0x61, 0x17, 0x5d, 0x2, 0x0, 0x0, 0x25, 0xe4, 0x1f, 0x0, 0x1d, 0x30, 0xf4, 0x27, 0x26, 0xa, 0x55, 0x1a, 0xa2, 0x88, 0x65, 0x6, 0x6c, 0x75, 0xf3, 0x5e, 0xa8, 0x40, 0x7f, 0x8, 0x20, 0x45, 0x50, 0x34, 0xbc, 0x32, 0x83, 0x3d, 0x59, 0x9b, 0x27, 0x0, 0x0, 0x3f, 0x74, 0x2, 0x0, 0x0, 0x6f, 0xf8, 0x1, 0x65, 0x24, 0x9d, 0x1c, 0x0, 0x1e, 0x4a, 0xbf, 0x4, 0xda, 0x19, 0xaf, 0x70, 0x1d, 0x68, 0x20, 0x83, 0xaa, 0xb2, 0x76, 0x38, 0x53, 0x41, 0x8c, 0x6f, 0x28, 0xe7, 0xf5, 0xc7, 0x72, 0x7d, 0x4f, 0x1a, 0xbf, 0x61, 0xf6, 0x19, 0xe8, 0x11, 0x0, 0x0, 0x14, 0x8a, 0x1c, 0x0, 0x19, 0xfe, 0x49, 0xbd, 0xd7, 0x34, 0x6c, 0x2, 0xc9, 0x6c, 0x2f, 0xbe, 0x24, 0xf3, 0x14, 0xae, 0x6b, 0xbf, 0x92, 0x3e, 0x6f, 0x46, 0x59, 0x1e, 0x5e, 0xed, 0x1f, 0x0, 0x5, 0xa8, 0x8d, 0xbd, 0x66, 0xa6, 0x11, 0x0, 0x0, 0x1f, 0x21};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x30, 0xf4, 0x27, 0x26, 0xa, 0x55, 0x1a, 0xa2, 0x88, 0x65, 0x6, 0x6c, 0x75, 0xf3, 0x5e, 0xa8, 0x40, 0x7f, 0x8, 0x20, 0x45, 0x50, 0x34, 0xbc, 0x32, 0x83, 0x3d, 0x59, 0x9b};
  uint8_t bytesprops1[] = {0x4a, 0xbf, 0x4, 0xda, 0x19, 0xaf, 0x70, 0x1d, 0x68, 0x20, 0x83, 0xaa, 0xb2, 0x76, 0x38, 0x53, 0x41, 0x8c, 0x6f, 0x28, 0xe7, 0xf5, 0xc7, 0x72, 0x7d, 0x4f, 0x1a, 0xbf, 0x61, 0xf6};
  uint8_t bytesprops2[] = {0xfe, 0x49, 0xbd, 0xd7, 0x34, 0x6c, 0x2, 0xc9, 0x6c, 0x2f, 0xbe, 0x24, 0xf3, 0x14, 0xae, 0x6b, 0xbf, 0x92, 0x3e, 0x6f, 0x46, 0x59, 0x1e, 0x5e, 0xed};
  uint8_t bytesprops3[] = {0xa8, 0x8d, 0xbd, 0x66, 0xa6};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 2818}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28513}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 93}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9700}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 16244}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28664}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 101}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 157}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 232}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5258}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {5, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7969}},
  };

  lwmqtt_properties_t props = {15, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 149, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoSubscriptionIdentifiersNotSupported []
TEST(Disco5QCTest, Encode13) {
uint8_t pkt[] = {0xe0, 0x2, 0xa1, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 161, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoTopicNameInvalid []
TEST(Disco5QCTest, Encode14) {
uint8_t pkt[] = {0xe0, 0x2, 0x90, 0x0};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  
  lwmqtt_property_t propslist[] = {
  };

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 144, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoImplementationSpecificError [PropContentType "1\178F\173\196\r\132A",PropWillDelayInterval 6837,PropServerReference "<|v\228CL\169i\237\172",PropTopicAlias 11493,PropServerKeepAlive 19636,PropAssignedClientIdentifier "\129\v\157\205\163",PropTopicAlias 2516]
TEST(Disco5QCTest, Encode15) {
uint8_t pkt[] = {0xe0, 0x30, 0x83, 0x2e, 0x3, 0x0, 0x8, 0x31, 0xb2, 0x46, 0xad, 0xc4, 0xd, 0x84, 0x41, 0x18, 0x0, 0x0, 0x1a, 0xb5, 0x1c, 0x0, 0xa, 0x3c, 0x7c, 0x76, 0xe4, 0x43, 0x4c, 0xa9, 0x69, 0xed, 0xac, 0x23, 0x2c, 0xe5, 0x13, 0x4c, 0xb4, 0x12, 0x0, 0x5, 0x81, 0xb, 0x9d, 0xcd, 0xa3, 0x23, 0x9, 0xd4};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x31, 0xb2, 0x46, 0xad, 0xc4, 0xd, 0x84, 0x41};
  uint8_t bytesprops1[] = {0x3c, 0x7c, 0x76, 0xe4, 0x43, 0x4c, 0xa9, 0x69, 0xed, 0xac};
  uint8_t bytesprops2[] = {0x81, 0xb, 0x9d, 0xcd, 0xa3};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 6837}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11493}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19636}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {5, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 2516}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 131, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoDisconnectWithWill [PropUserProperty ",AK}%a\ESC1c\200\143\134\ESCnN\213\&3" "3\ETXcK\228\241\226\185\248g;\230\CANa\233\189KJ",PropRequestResponseInformation 51,PropCorrelationData "\213\175\164\189\170|",PropContentType "p\CANg\128",PropUserProperty "\171\217.\157`Tc\211\152c\207SmoTlG5Y" "\247p\221\SI\219",PropAuthenticationData "w\ETB\220]zk\212\157{\244\SO:Q-\222U'\218\250\197",PropMessageExpiryInterval 6020,PropSharedSubscriptionAvailable 8,PropContentType ")\250\234\RS\137\154",PropSharedSubscriptionAvailable 51,PropWildcardSubscriptionAvailable 176,PropAuthenticationData "Ot\EOT\222\223\&6\252\139\175\172j\131t`\139\NAK",PropResponseInformation "\"\246\152\142LU\142vr{\171\SUB\138{S\200\ENQ\144q\241 \vG\186",PropUserProperty "\128\ACK\152V\179\163\228x\ESC\160\230\EOT\195\&5\206.yXJf\226=85,lc" "\SO\131\DEL\215\SYN\213\166\183\248L.@7m\245\133\128r\197",PropContentType "\220\199|\NUL/\208.",PropCorrelationData "\f\235\245\219\201\129\152\204\145\148\US7\173\225f\207\r>\201q Q\238\213\247\195\DLE\213\"",PropTopicAliasMaximum 2107,PropCorrelationData "Q\171\138\205N\132\224\212\223\USF\DC2\177C\231\ETB\DLEF\163",PropSubscriptionIdentifier 1,PropServerKeepAlive 24248,PropRequestProblemInformation 138,PropAssignedClientIdentifier "\221\200\223\136\181\179X&i|\251\210\223)$x\US",PropContentType "\150\EM\130",PropRequestResponseInformation 41,PropMessageExpiryInterval 21178,PropContentType "\181\240}\139'\f"]
TEST(Disco5QCTest, Encode16) {
uint8_t pkt[] = {0xe0, 0xda, 0x2, 0x4, 0xd7, 0x2, 0x26, 0x0, 0x11, 0x2c, 0x41, 0x4b, 0x7d, 0x25, 0x61, 0x1b, 0x31, 0x63, 0xc8, 0x8f, 0x86, 0x1b, 0x6e, 0x4e, 0xd5, 0x33, 0x0, 0x12, 0x33, 0x3, 0x63, 0x4b, 0xe4, 0xf1, 0xe2, 0xb9, 0xf8, 0x67, 0x3b, 0xe6, 0x18, 0x61, 0xe9, 0xbd, 0x4b, 0x4a, 0x19, 0x33, 0x9, 0x0, 0x6, 0xd5, 0xaf, 0xa4, 0xbd, 0xaa, 0x7c, 0x3, 0x0, 0x4, 0x70, 0x18, 0x67, 0x80, 0x26, 0x0, 0x13, 0xab, 0xd9, 0x2e, 0x9d, 0x60, 0x54, 0x63, 0xd3, 0x98, 0x63, 0xcf, 0x53, 0x6d, 0x6f, 0x54, 0x6c, 0x47, 0x35, 0x59, 0x0, 0x5, 0xf7, 0x70, 0xdd, 0xf, 0xdb, 0x16, 0x0, 0x14, 0x77, 0x17, 0xdc, 0x5d, 0x7a, 0x6b, 0xd4, 0x9d, 0x7b, 0xf4, 0xe, 0x3a, 0x51, 0x2d, 0xde, 0x55, 0x27, 0xda, 0xfa, 0xc5, 0x2, 0x0, 0x0, 0x17, 0x84, 0x2a, 0x8, 0x3, 0x0, 0x6, 0x29, 0xfa, 0xea, 0x1e, 0x89, 0x9a, 0x2a, 0x33, 0x28, 0xb0, 0x16, 0x0, 0x10, 0x4f, 0x74, 0x4, 0xde, 0xdf, 0x36, 0xfc, 0x8b, 0xaf, 0xac, 0x6a, 0x83, 0x74, 0x60, 0x8b, 0x15, 0x1a, 0x0, 0x18, 0x22, 0xf6, 0x98, 0x8e, 0x4c, 0x55, 0x8e, 0x76, 0x72, 0x7b, 0xab, 0x1a, 0x8a, 0x7b, 0x53, 0xc8, 0x5, 0x90, 0x71, 0xf1, 0x20, 0xb, 0x47, 0xba, 0x26, 0x0, 0x1b, 0x80, 0x6, 0x98, 0x56, 0xb3, 0xa3, 0xe4, 0x78, 0x1b, 0xa0, 0xe6, 0x4, 0xc3, 0x35, 0xce, 0x2e, 0x79, 0x58, 0x4a, 0x66, 0xe2, 0x3d, 0x38, 0x35, 0x2c, 0x6c, 0x63, 0x0, 0x13, 0xe, 0x83, 0x7f, 0xd7, 0x16, 0xd5, 0xa6, 0xb7, 0xf8, 0x4c, 0x2e, 0x40, 0x37, 0x6d, 0xf5, 0x85, 0x80, 0x72, 0xc5, 0x3, 0x0, 0x7, 0xdc, 0xc7, 0x7c, 0x0, 0x2f, 0xd0, 0x2e, 0x9, 0x0, 0x1d, 0xc, 0xeb, 0xf5, 0xdb, 0xc9, 0x81, 0x98, 0xcc, 0x91, 0x94, 0x1f, 0x37, 0xad, 0xe1, 0x66, 0xcf, 0xd, 0x3e, 0xc9, 0x71, 0x20, 0x51, 0xee, 0xd5, 0xf7, 0xc3, 0x10, 0xd5, 0x22, 0x22, 0x8, 0x3b, 0x9, 0x0, 0x13, 0x51, 0xab, 0x8a, 0xcd, 0x4e, 0x84, 0xe0, 0xd4, 0xdf, 0x1f, 0x46, 0x12, 0xb1, 0x43, 0xe7, 0x17, 0x10, 0x46, 0xa3, 0xb, 0x1, 0x13, 0x5e, 0xb8, 0x17, 0x8a, 0x12, 0x0, 0x11, 0xdd, 0xc8, 0xdf, 0x88, 0xb5, 0xb3, 0x58, 0x26, 0x69, 0x7c, 0xfb, 0xd2, 0xdf, 0x29, 0x24, 0x78, 0x1f, 0x3, 0x0, 0x3, 0x96, 0x19, 0x82, 0x19, 0x29, 0x2, 0x0, 0x0, 0x52, 0xba, 0x3, 0x0, 0x6, 0xb5, 0xf0, 0x7d, 0x8b, 0x27, 0xc};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops1[] = {0x33, 0x3, 0x63, 0x4b, 0xe4, 0xf1, 0xe2, 0xb9, 0xf8, 0x67, 0x3b, 0xe6, 0x18, 0x61, 0xe9, 0xbd, 0x4b, 0x4a};
  uint8_t bytesprops0[] = {0x2c, 0x41, 0x4b, 0x7d, 0x25, 0x61, 0x1b, 0x31, 0x63, 0xc8, 0x8f, 0x86, 0x1b, 0x6e, 0x4e, 0xd5, 0x33};
  uint8_t bytesprops2[] = {0xd5, 0xaf, 0xa4, 0xbd, 0xaa, 0x7c};
  uint8_t bytesprops3[] = {0x70, 0x18, 0x67, 0x80};
  uint8_t bytesprops5[] = {0xf7, 0x70, 0xdd, 0xf, 0xdb};
  uint8_t bytesprops4[] = {0xab, 0xd9, 0x2e, 0x9d, 0x60, 0x54, 0x63, 0xd3, 0x98, 0x63, 0xcf, 0x53, 0x6d, 0x6f, 0x54, 0x6c, 0x47, 0x35, 0x59};
  uint8_t bytesprops6[] = {0x77, 0x17, 0xdc, 0x5d, 0x7a, 0x6b, 0xd4, 0x9d, 0x7b, 0xf4, 0xe, 0x3a, 0x51, 0x2d, 0xde, 0x55, 0x27, 0xda, 0xfa, 0xc5};
  uint8_t bytesprops7[] = {0x29, 0xfa, 0xea, 0x1e, 0x89, 0x9a};
  uint8_t bytesprops8[] = {0x4f, 0x74, 0x4, 0xde, 0xdf, 0x36, 0xfc, 0x8b, 0xaf, 0xac, 0x6a, 0x83, 0x74, 0x60, 0x8b, 0x15};
  uint8_t bytesprops9[] = {0x22, 0xf6, 0x98, 0x8e, 0x4c, 0x55, 0x8e, 0x76, 0x72, 0x7b, 0xab, 0x1a, 0x8a, 0x7b, 0x53, 0xc8, 0x5, 0x90, 0x71, 0xf1, 0x20, 0xb, 0x47, 0xba};
  uint8_t bytesprops11[] = {0xe, 0x83, 0x7f, 0xd7, 0x16, 0xd5, 0xa6, 0xb7, 0xf8, 0x4c, 0x2e, 0x40, 0x37, 0x6d, 0xf5, 0x85, 0x80, 0x72, 0xc5};
  uint8_t bytesprops10[] = {0x80, 0x6, 0x98, 0x56, 0xb3, 0xa3, 0xe4, 0x78, 0x1b, 0xa0, 0xe6, 0x4, 0xc3, 0x35, 0xce, 0x2e, 0x79, 0x58, 0x4a, 0x66, 0xe2, 0x3d, 0x38, 0x35, 0x2c, 0x6c, 0x63};
  uint8_t bytesprops12[] = {0xdc, 0xc7, 0x7c, 0x0, 0x2f, 0xd0, 0x2e};
  uint8_t bytesprops13[] = {0xc, 0xeb, 0xf5, 0xdb, 0xc9, 0x81, 0x98, 0xcc, 0x91, 0x94, 0x1f, 0x37, 0xad, 0xe1, 0x66, 0xcf, 0xd, 0x3e, 0xc9, 0x71, 0x20, 0x51, 0xee, 0xd5, 0xf7, 0xc3, 0x10, 0xd5, 0x22};
  uint8_t bytesprops14[] = {0x51, 0xab, 0x8a, 0xcd, 0x4e, 0x84, 0xe0, 0xd4, 0xdf, 0x1f, 0x46, 0x12, 0xb1, 0x43, 0xe7, 0x17, 0x10, 0x46, 0xa3};
  uint8_t bytesprops15[] = {0xdd, 0xc8, 0xdf, 0x88, 0xb5, 0xb3, 0x58, 0x26, 0x69, 0x7c, 0xfb, 0xd2, 0xdf, 0x29, 0x24, 0x78, 0x1f};
  uint8_t bytesprops16[] = {0x96, 0x19, 0x82};
  uint8_t bytesprops17[] = {0xb5, 0xf0, 0x7d, 0x8b, 0x27, 0xc};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={17, (char*)&bytesprops0}, .v={18, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 51}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {4, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={19, (char*)&bytesprops4}, .v={5, (char*)&bytesprops5}}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6020}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 8}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 51}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 176}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {16, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {24, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={27, (char*)&bytesprops10}, .v={19, (char*)&bytesprops11}}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {7, (char*)&bytesprops12}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {29, (char*)&bytesprops13}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 2107}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops14}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 1}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 24248}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 138}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {17, (char*)&bytesprops15}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {3, (char*)&bytesprops16}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 41}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21178}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops17}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoKeepAliveTimeout [PropSubscriptionIdentifier 12,PropMaximumPacketSize 27576,PropAuthenticationMethod "r\213\205@*(~\169\246\157(\204a\FSu\232\181",PropAuthenticationMethod "\232\150\a",PropResponseTopic "<921^\207",PropWillDelayInterval 8261,PropWillDelayInterval 20923,PropContentType " \CAN\162\SYN\SOH\NUL\214<\216\218b\NUL#\NUL\STXV\237\EOT",PropMessageExpiryInterval 9198,PropTopicAliasMaximum 5712,PropMessageExpiryInterval 4543,PropResponseInformation "\143\232\CAN\187\155\210gD?",PropMaximumPacketSize 20356,PropRequestResponseInformation 250,PropMaximumQoS 33,PropSessionExpiryInterval 26369,PropUserProperty "3n\227\245\163|\199R\SI\232\199\165\239\161S\141CGR\US\"\170\204\187" "h\238]\187/\157\179",PropAuthenticationMethod "\203\DC4\136\144\202\ETXV\241y\190\DC3Ug5\170\205W\255\151U;\155R",PropAuthenticationData "1\164\129\147Y\183\&0O\146\169\STX\185X\188\219=b\237\249=\129\253",PropPayloadFormatIndicator 54,PropResponseInformation "Y\226\153.\192+\129y\234\CAN\226\188\246\230",PropServerKeepAlive 27270]
TEST(Disco5QCTest, Encode17) {
uint8_t pkt[] = {0xe0, 0xe0, 0x1, 0x8d, 0xdd, 0x1, 0xb, 0xc, 0x27, 0x0, 0x0, 0x6b, 0xb8, 0x15, 0x0, 0x11, 0x72, 0xd5, 0xcd, 0x40, 0x2a, 0x28, 0x7e, 0xa9, 0xf6, 0x9d, 0x28, 0xcc, 0x61, 0x1c, 0x75, 0xe8, 0xb5, 0x15, 0x0, 0x3, 0xe8, 0x96, 0x7, 0x8, 0x0, 0x6, 0x3c, 0x39, 0x32, 0x31, 0x5e, 0xcf, 0x18, 0x0, 0x0, 0x20, 0x45, 0x18, 0x0, 0x0, 0x51, 0xbb, 0x3, 0x0, 0x12, 0x20, 0x18, 0xa2, 0x16, 0x1, 0x0, 0xd6, 0x3c, 0xd8, 0xda, 0x62, 0x0, 0x23, 0x0, 0x2, 0x56, 0xed, 0x4, 0x2, 0x0, 0x0, 0x23, 0xee, 0x22, 0x16, 0x50, 0x2, 0x0, 0x0, 0x11, 0xbf, 0x1a, 0x0, 0x9, 0x8f, 0xe8, 0x18, 0xbb, 0x9b, 0xd2, 0x67, 0x44, 0x3f, 0x27, 0x0, 0x0, 0x4f, 0x84, 0x19, 0xfa, 0x24, 0x21, 0x11, 0x0, 0x0, 0x67, 0x1, 0x26, 0x0, 0x18, 0x33, 0x6e, 0xe3, 0xf5, 0xa3, 0x7c, 0xc7, 0x52, 0xf, 0xe8, 0xc7, 0xa5, 0xef, 0xa1, 0x53, 0x8d, 0x43, 0x47, 0x52, 0x1f, 0x22, 0xaa, 0xcc, 0xbb, 0x0, 0x7, 0x68, 0xee, 0x5d, 0xbb, 0x2f, 0x9d, 0xb3, 0x15, 0x0, 0x17, 0xcb, 0x14, 0x88, 0x90, 0xca, 0x3, 0x56, 0xf1, 0x79, 0xbe, 0x13, 0x55, 0x67, 0x35, 0xaa, 0xcd, 0x57, 0xff, 0x97, 0x55, 0x3b, 0x9b, 0x52, 0x16, 0x0, 0x16, 0x31, 0xa4, 0x81, 0x93, 0x59, 0xb7, 0x30, 0x4f, 0x92, 0xa9, 0x2, 0xb9, 0x58, 0xbc, 0xdb, 0x3d, 0x62, 0xed, 0xf9, 0x3d, 0x81, 0xfd, 0x1, 0x36, 0x1a, 0x0, 0xe, 0x59, 0xe2, 0x99, 0x2e, 0xc0, 0x2b, 0x81, 0x79, 0xea, 0x18, 0xe2, 0xbc, 0xf6, 0xe6, 0x13, 0x6a, 0x86};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x72, 0xd5, 0xcd, 0x40, 0x2a, 0x28, 0x7e, 0xa9, 0xf6, 0x9d, 0x28, 0xcc, 0x61, 0x1c, 0x75, 0xe8, 0xb5};
  uint8_t bytesprops1[] = {0xe8, 0x96, 0x7};
  uint8_t bytesprops2[] = {0x3c, 0x39, 0x32, 0x31, 0x5e, 0xcf};
  uint8_t bytesprops3[] = {0x20, 0x18, 0xa2, 0x16, 0x1, 0x0, 0xd6, 0x3c, 0xd8, 0xda, 0x62, 0x0, 0x23, 0x0, 0x2, 0x56, 0xed, 0x4};
  uint8_t bytesprops4[] = {0x8f, 0xe8, 0x18, 0xbb, 0x9b, 0xd2, 0x67, 0x44, 0x3f};
  uint8_t bytesprops6[] = {0x68, 0xee, 0x5d, 0xbb, 0x2f, 0x9d, 0xb3};
  uint8_t bytesprops5[] = {0x33, 0x6e, 0xe3, 0xf5, 0xa3, 0x7c, 0xc7, 0x52, 0xf, 0xe8, 0xc7, 0xa5, 0xef, 0xa1, 0x53, 0x8d, 0x43, 0x47, 0x52, 0x1f, 0x22, 0xaa, 0xcc, 0xbb};
  uint8_t bytesprops7[] = {0xcb, 0x14, 0x88, 0x90, 0xca, 0x3, 0x56, 0xf1, 0x79, 0xbe, 0x13, 0x55, 0x67, 0x35, 0xaa, 0xcd, 0x57, 0xff, 0x97, 0x55, 0x3b, 0x9b, 0x52};
  uint8_t bytesprops8[] = {0x31, 0xa4, 0x81, 0x93, 0x59, 0xb7, 0x30, 0x4f, 0x92, 0xa9, 0x2, 0xb9, 0x58, 0xbc, 0xdb, 0x3d, 0x62, 0xed, 0xf9, 0x3d, 0x81, 0xfd};
  uint8_t bytesprops9[] = {0x59, 0xe2, 0x99, 0x2e, 0xc0, 0x2b, 0x81, 0x79, 0xea, 0x18, 0xe2, 0xbc, 0xf6, 0xe6};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 12}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27576}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8261}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 20923}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9198}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 5712}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4543}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {9, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20356}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 250}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 33}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 26369}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={24, (char*)&bytesprops5}, .v={7, (char*)&bytesprops6}}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {23, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops8}}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops9}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27270}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 141, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoPayloadFormatInvalid [PropServerReference "\175\212N\225\&9\US0\230\184\130c'\236",PropReceiveMaximum 29122,PropSharedSubscriptionAvailable 74,PropPayloadFormatIndicator 231,PropMessageExpiryInterval 10411]
TEST(Disco5QCTest, Encode18) {
uint8_t pkt[] = {0xe0, 0x1e, 0x99, 0x1c, 0x1c, 0x0, 0xd, 0xaf, 0xd4, 0x4e, 0xe1, 0x39, 0x1f, 0x30, 0xe6, 0xb8, 0x82, 0x63, 0x27, 0xec, 0x21, 0x71, 0xc2, 0x2a, 0x4a, 0x1, 0xe7, 0x2, 0x0, 0x0, 0x28, 0xab};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xaf, 0xd4, 0x4e, 0xe1, 0x39, 0x1f, 0x30, 0xe6, 0xb8, 0x82, 0x63, 0x27, 0xec};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {13, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29122}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 74}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 231}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10411}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 153, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoWildcardSubscriptionsNotSupported [PropRequestProblemInformation 181,PropAuthenticationData "@\ESC\171\213\ENQ\246\&2V\162\238",PropResponseInformation "\129\224i\141\250\208\177",PropWillDelayInterval 13537,PropResponseTopic "\240,\217\SOr\139\147T\a\\\166\135\248\128xe\DC1_\vc\239\165C[\207\246\&6\225\230",PropMaximumQoS 197,PropRequestResponseInformation 14,PropAssignedClientIdentifier ")'\r\233\252\DC4\172\253\232\216\156\188e\NAK/\DC1\152\\\192W.",PropServerReference "\DC4y\207KL",PropMessageExpiryInterval 21283]
TEST(Disco5QCTest, Encode19) {
uint8_t pkt[] = {0xe0, 0x69, 0xa2, 0x67, 0x17, 0xb5, 0x16, 0x0, 0xa, 0x40, 0x1b, 0xab, 0xd5, 0x5, 0xf6, 0x32, 0x56, 0xa2, 0xee, 0x1a, 0x0, 0x7, 0x81, 0xe0, 0x69, 0x8d, 0xfa, 0xd0, 0xb1, 0x18, 0x0, 0x0, 0x34, 0xe1, 0x8, 0x0, 0x1d, 0xf0, 0x2c, 0xd9, 0xe, 0x72, 0x8b, 0x93, 0x54, 0x7, 0x5c, 0xa6, 0x87, 0xf8, 0x80, 0x78, 0x65, 0x11, 0x5f, 0xb, 0x63, 0xef, 0xa5, 0x43, 0x5b, 0xcf, 0xf6, 0x36, 0xe1, 0xe6, 0x24, 0xc5, 0x19, 0xe, 0x12, 0x0, 0x15, 0x29, 0x27, 0xd, 0xe9, 0xfc, 0x14, 0xac, 0xfd, 0xe8, 0xd8, 0x9c, 0xbc, 0x65, 0x15, 0x2f, 0x11, 0x98, 0x5c, 0xc0, 0x57, 0x2e, 0x1c, 0x0, 0x5, 0x14, 0x79, 0xcf, 0x4b, 0x4c, 0x2, 0x0, 0x0, 0x53, 0x23};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x40, 0x1b, 0xab, 0xd5, 0x5, 0xf6, 0x32, 0x56, 0xa2, 0xee};
  uint8_t bytesprops1[] = {0x81, 0xe0, 0x69, 0x8d, 0xfa, 0xd0, 0xb1};
  uint8_t bytesprops2[] = {0xf0, 0x2c, 0xd9, 0xe, 0x72, 0x8b, 0x93, 0x54, 0x7, 0x5c, 0xa6, 0x87, 0xf8, 0x80, 0x78, 0x65, 0x11, 0x5f, 0xb, 0x63, 0xef, 0xa5, 0x43, 0x5b, 0xcf, 0xf6, 0x36, 0xe1, 0xe6};
  uint8_t bytesprops3[] = {0x29, 0x27, 0xd, 0xe9, 0xfc, 0x14, 0xac, 0xfd, 0xe8, 0xd8, 0x9c, 0xbc, 0x65, 0x15, 0x2f, 0x11, 0x98, 0x5c, 0xc0, 0x57, 0x2e};
  uint8_t bytesprops4[] = {0x14, 0x79, 0xcf, 0x4b, 0x4c};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 181}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {10, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {7, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 13537}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 197}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 14}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21283}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 162, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoRetainNotSupported [PropRequestResponseInformation 43,PropMaximumPacketSize 26732,PropSessionExpiryInterval 11092,PropAuthenticationData ". 6\253\225\231\250\150F\177n"]
TEST(Disco5QCTest, Encode20) {
uint8_t pkt[] = {0xe0, 0x1c, 0x9a, 0x1a, 0x19, 0x2b, 0x27, 0x0, 0x0, 0x68, 0x6c, 0x11, 0x0, 0x0, 0x2b, 0x54, 0x16, 0x0, 0xb, 0x2e, 0x20, 0x36, 0xfd, 0xe1, 0xe7, 0xfa, 0x96, 0x46, 0xb1, 0x6e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x2e, 0x20, 0x36, 0xfd, 0xe1, 0xe7, 0xfa, 0x96, 0x46, 0xb1, 0x6e};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 43}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 26732}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11092}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 154, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoDisconnectWithWill [PropServerReference "\166G\177\198e\DC2\DLEr|\231=k\"\217\170\180\164\237\230\214\SYNd\218W\DC2\208",PropRequestProblemInformation 143,PropSubscriptionIdentifier 22,PropMaximumQoS 108]
TEST(Disco5QCTest, Encode21) {
uint8_t pkt[] = {0xe0, 0x25, 0x4, 0x23, 0x1c, 0x0, 0x1a, 0xa6, 0x47, 0xb1, 0xc6, 0x65, 0x12, 0x10, 0x72, 0x7c, 0xe7, 0x3d, 0x6b, 0x22, 0xd9, 0xaa, 0xb4, 0xa4, 0xed, 0xe6, 0xd6, 0x16, 0x64, 0xda, 0x57, 0x12, 0xd0, 0x17, 0x8f, 0xb, 0x16, 0x24, 0x6c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xa6, 0x47, 0xb1, 0xc6, 0x65, 0x12, 0x10, 0x72, 0x7c, 0xe7, 0x3d, 0x6b, 0x22, 0xd9, 0xaa, 0xb4, 0xa4, 0xed, 0xe6, 0xd6, 0x16, 0x64, 0xda, 0x57, 0x12, 0xd0};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 143}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 22}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 108}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoTopicNameInvalid [PropCorrelationData "9\GSX\227\194\168\FS\191\201\219\133\236g",PropUserProperty "\243" "]\238hX\198\183\132\224?\167/\181=yZ{z\178",PropAuthenticationMethod "/\142\aU1\\\186}>V\189`Ap^W%\229[",PropWildcardSubscriptionAvailable 160,PropResponseTopic "(\188\130#",PropReasonString "\150_Z0ef",PropSubscriptionIdentifierAvailable 53,PropReceiveMaximum 12034,PropServerKeepAlive 2916,PropSessionExpiryInterval 10487,PropWillDelayInterval 13840,PropSubscriptionIdentifier 3,PropWildcardSubscriptionAvailable 35,PropReasonString ";H\170\254e=\164\v\213\165\148\134,\226\179uB",PropResponseTopic "5.\184\ETX\194\211\&3\DC3F\133\200\184\222\153\166\207J",PropServerKeepAlive 27368,PropSessionExpiryInterval 10893,PropTopicAliasMaximum 6988]
TEST(Disco5QCTest, Encode22) {
uint8_t pkt[] = {0xe0, 0x9c, 0x1, 0x90, 0x99, 0x1, 0x9, 0x0, 0xd, 0x39, 0x1d, 0x58, 0xe3, 0xc2, 0xa8, 0x1c, 0xbf, 0xc9, 0xdb, 0x85, 0xec, 0x67, 0x26, 0x0, 0x1, 0xf3, 0x0, 0x12, 0x5d, 0xee, 0x68, 0x58, 0xc6, 0xb7, 0x84, 0xe0, 0x3f, 0xa7, 0x2f, 0xb5, 0x3d, 0x79, 0x5a, 0x7b, 0x7a, 0xb2, 0x15, 0x0, 0x13, 0x2f, 0x8e, 0x7, 0x55, 0x31, 0x5c, 0xba, 0x7d, 0x3e, 0x56, 0xbd, 0x60, 0x41, 0x70, 0x5e, 0x57, 0x25, 0xe5, 0x5b, 0x28, 0xa0, 0x8, 0x0, 0x4, 0x28, 0xbc, 0x82, 0x23, 0x1f, 0x0, 0x6, 0x96, 0x5f, 0x5a, 0x30, 0x65, 0x66, 0x29, 0x35, 0x21, 0x2f, 0x2, 0x13, 0xb, 0x64, 0x11, 0x0, 0x0, 0x28, 0xf7, 0x18, 0x0, 0x0, 0x36, 0x10, 0xb, 0x3, 0x28, 0x23, 0x1f, 0x0, 0x11, 0x3b, 0x48, 0xaa, 0xfe, 0x65, 0x3d, 0xa4, 0xb, 0xd5, 0xa5, 0x94, 0x86, 0x2c, 0xe2, 0xb3, 0x75, 0x42, 0x8, 0x0, 0x11, 0x35, 0x2e, 0xb8, 0x3, 0xc2, 0xd3, 0x33, 0x13, 0x46, 0x85, 0xc8, 0xb8, 0xde, 0x99, 0xa6, 0xcf, 0x4a, 0x13, 0x6a, 0xe8, 0x11, 0x0, 0x0, 0x2a, 0x8d, 0x22, 0x1b, 0x4c};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x39, 0x1d, 0x58, 0xe3, 0xc2, 0xa8, 0x1c, 0xbf, 0xc9, 0xdb, 0x85, 0xec, 0x67};
  uint8_t bytesprops2[] = {0x5d, 0xee, 0x68, 0x58, 0xc6, 0xb7, 0x84, 0xe0, 0x3f, 0xa7, 0x2f, 0xb5, 0x3d, 0x79, 0x5a, 0x7b, 0x7a, 0xb2};
  uint8_t bytesprops1[] = {0xf3};
  uint8_t bytesprops3[] = {0x2f, 0x8e, 0x7, 0x55, 0x31, 0x5c, 0xba, 0x7d, 0x3e, 0x56, 0xbd, 0x60, 0x41, 0x70, 0x5e, 0x57, 0x25, 0xe5, 0x5b};
  uint8_t bytesprops4[] = {0x28, 0xbc, 0x82, 0x23};
  uint8_t bytesprops5[] = {0x96, 0x5f, 0x5a, 0x30, 0x65, 0x66};
  uint8_t bytesprops6[] = {0x3b, 0x48, 0xaa, 0xfe, 0x65, 0x3d, 0xa4, 0xb, 0xd5, 0xa5, 0x94, 0x86, 0x2c, 0xe2, 0xb3, 0x75, 0x42};
  uint8_t bytesprops7[] = {0x35, 0x2e, 0xb8, 0x3, 0xc2, 0xd3, 0x33, 0x13, 0x46, 0x85, 0xc8, 0xb8, 0xde, 0x99, 0xa6, 0xcf, 0x4a};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={1, (char*)&bytesprops1}, .v={18, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {19, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 160}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 53}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 12034}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2916}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 10487}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 13840}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 3}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 35}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {17, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27368}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 10893}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6988}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 144, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoDisconnectWithWill [PropMessageExpiryInterval 31906,PropServerKeepAlive 11688,PropAuthenticationData "\219\215\SI\228Z\ETX\158&\241Om\234)\US\230{=e\189M",PropMaximumQoS 32,PropUserProperty "3\ENQ*\175\DC1c\251\DLE\210f\197\206\199\CAN\237\ACKFx\215" "]\137\&4\EM\232[\243}N^\253S\142\239\238\t8\213-!\129",PropAuthenticationMethod "\204\169\222\&4C\229\EOT\177\143\241\196Od\176,At\199\167\134\206\254\253o\147\143N\232"]
TEST(Disco5QCTest, Encode23) {
uint8_t pkt[] = {0xe0, 0x6f, 0x4, 0x6d, 0x2, 0x0, 0x0, 0x7c, 0xa2, 0x13, 0x2d, 0xa8, 0x16, 0x0, 0x14, 0xdb, 0xd7, 0xf, 0xe4, 0x5a, 0x3, 0x9e, 0x26, 0xf1, 0x4f, 0x6d, 0xea, 0x29, 0x1f, 0xe6, 0x7b, 0x3d, 0x65, 0xbd, 0x4d, 0x24, 0x20, 0x26, 0x0, 0x13, 0x33, 0x5, 0x2a, 0xaf, 0x11, 0x63, 0xfb, 0x10, 0xd2, 0x66, 0xc5, 0xce, 0xc7, 0x18, 0xed, 0x6, 0x46, 0x78, 0xd7, 0x0, 0x15, 0x5d, 0x89, 0x34, 0x19, 0xe8, 0x5b, 0xf3, 0x7d, 0x4e, 0x5e, 0xfd, 0x53, 0x8e, 0xef, 0xee, 0x9, 0x38, 0xd5, 0x2d, 0x21, 0x81, 0x15, 0x0, 0x1c, 0xcc, 0xa9, 0xde, 0x34, 0x43, 0xe5, 0x4, 0xb1, 0x8f, 0xf1, 0xc4, 0x4f, 0x64, 0xb0, 0x2c, 0x41, 0x74, 0xc7, 0xa7, 0x86, 0xce, 0xfe, 0xfd, 0x6f, 0x93, 0x8f, 0x4e, 0xe8};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0xdb, 0xd7, 0xf, 0xe4, 0x5a, 0x3, 0x9e, 0x26, 0xf1, 0x4f, 0x6d, 0xea, 0x29, 0x1f, 0xe6, 0x7b, 0x3d, 0x65, 0xbd, 0x4d};
  uint8_t bytesprops2[] = {0x5d, 0x89, 0x34, 0x19, 0xe8, 0x5b, 0xf3, 0x7d, 0x4e, 0x5e, 0xfd, 0x53, 0x8e, 0xef, 0xee, 0x9, 0x38, 0xd5, 0x2d, 0x21, 0x81};
  uint8_t bytesprops1[] = {0x33, 0x5, 0x2a, 0xaf, 0x11, 0x63, 0xfb, 0x10, 0xd2, 0x66, 0xc5, 0xce, 0xc7, 0x18, 0xed, 0x6, 0x46, 0x78, 0xd7};
  uint8_t bytesprops3[] = {0xcc, 0xa9, 0xde, 0x34, 0x43, 0xe5, 0x4, 0xb1, 0x8f, 0xf1, 0xc4, 0x4f, 0x64, 0xb0, 0x2c, 0x41, 0x74, 0xc7, 0xa7, 0x86, 0xce, 0xfe, 0xfd, 0x6f, 0x93, 0x8f, 0x4e, 0xe8};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31906}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 11688}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 32}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={19, (char*)&bytesprops1}, .v={21, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops3}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoWildcardSubscriptionsNotSupported [PropResponseInformation "H\162?|+\SUB}\US\t\180k=\208",PropTopicAlias 30601,PropSubscriptionIdentifier 13,PropUserProperty "\205\129\SYN\199k^\192F\234\153L\136\193\131@d\FS\247^\132" "\131\NUL\135\233\133\212\237\230h",PropAssignedClientIdentifier "\253\235\248\160W\232\204\201\EM\NAK\170\200\205Kd\b\160\224\244E\204\t@a\225\217\ESC\157\186|",PropMessageExpiryInterval 9535,PropContentType "\r\252\178\GS\ESC\164/\191m\150d\255Q",PropRequestResponseInformation 253,PropTopicAlias 1395,PropMaximumPacketSize 9375,PropContentType "\231\"\181&<",PropTopicAliasMaximum 17101,PropRetainAvailable 52,PropRetainAvailable 122,PropMaximumQoS 55,PropRequestResponseInformation 156,PropWildcardSubscriptionAvailable 248,PropMessageExpiryInterval 25630,PropSessionExpiryInterval 676,PropAuthenticationMethod "`\226",PropSubscriptionIdentifierAvailable 77,PropWildcardSubscriptionAvailable 115,PropAuthenticationData "\182\143\250\253vR\150F\226\137J\150\191\198\EM\248\216\NUL?>"]
TEST(Disco5QCTest, Encode24) {
uint8_t pkt[] = {0xe0, 0xb9, 0x1, 0xa2, 0xb6, 0x1, 0x1a, 0x0, 0xd, 0x48, 0xa2, 0x3f, 0x7c, 0x2b, 0x1a, 0x7d, 0x1f, 0x9, 0xb4, 0x6b, 0x3d, 0xd0, 0x23, 0x77, 0x89, 0xb, 0xd, 0x26, 0x0, 0x14, 0xcd, 0x81, 0x16, 0xc7, 0x6b, 0x5e, 0xc0, 0x46, 0xea, 0x99, 0x4c, 0x88, 0xc1, 0x83, 0x40, 0x64, 0x1c, 0xf7, 0x5e, 0x84, 0x0, 0x9, 0x83, 0x0, 0x87, 0xe9, 0x85, 0xd4, 0xed, 0xe6, 0x68, 0x12, 0x0, 0x1e, 0xfd, 0xeb, 0xf8, 0xa0, 0x57, 0xe8, 0xcc, 0xc9, 0x19, 0x15, 0xaa, 0xc8, 0xcd, 0x4b, 0x64, 0x8, 0xa0, 0xe0, 0xf4, 0x45, 0xcc, 0x9, 0x40, 0x61, 0xe1, 0xd9, 0x1b, 0x9d, 0xba, 0x7c, 0x2, 0x0, 0x0, 0x25, 0x3f, 0x3, 0x0, 0xd, 0xd, 0xfc, 0xb2, 0x1d, 0x1b, 0xa4, 0x2f, 0xbf, 0x6d, 0x96, 0x64, 0xff, 0x51, 0x19, 0xfd, 0x23, 0x5, 0x73, 0x27, 0x0, 0x0, 0x24, 0x9f, 0x3, 0x0, 0x5, 0xe7, 0x22, 0xb5, 0x26, 0x3c, 0x22, 0x42, 0xcd, 0x25, 0x34, 0x25, 0x7a, 0x24, 0x37, 0x19, 0x9c, 0x28, 0xf8, 0x2, 0x0, 0x0, 0x64, 0x1e, 0x11, 0x0, 0x0, 0x2, 0xa4, 0x15, 0x0, 0x2, 0x60, 0xe2, 0x29, 0x4d, 0x28, 0x73, 0x16, 0x0, 0x14, 0xb6, 0x8f, 0xfa, 0xfd, 0x76, 0x52, 0x96, 0x46, 0xe2, 0x89, 0x4a, 0x96, 0xbf, 0xc6, 0x19, 0xf8, 0xd8, 0x0, 0x3f, 0x3e};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x48, 0xa2, 0x3f, 0x7c, 0x2b, 0x1a, 0x7d, 0x1f, 0x9, 0xb4, 0x6b, 0x3d, 0xd0};
  uint8_t bytesprops2[] = {0x83, 0x0, 0x87, 0xe9, 0x85, 0xd4, 0xed, 0xe6, 0x68};
  uint8_t bytesprops1[] = {0xcd, 0x81, 0x16, 0xc7, 0x6b, 0x5e, 0xc0, 0x46, 0xea, 0x99, 0x4c, 0x88, 0xc1, 0x83, 0x40, 0x64, 0x1c, 0xf7, 0x5e, 0x84};
  uint8_t bytesprops3[] = {0xfd, 0xeb, 0xf8, 0xa0, 0x57, 0xe8, 0xcc, 0xc9, 0x19, 0x15, 0xaa, 0xc8, 0xcd, 0x4b, 0x64, 0x8, 0xa0, 0xe0, 0xf4, 0x45, 0xcc, 0x9, 0x40, 0x61, 0xe1, 0xd9, 0x1b, 0x9d, 0xba, 0x7c};
  uint8_t bytesprops4[] = {0xd, 0xfc, 0xb2, 0x1d, 0x1b, 0xa4, 0x2f, 0xbf, 0x6d, 0x96, 0x64, 0xff, 0x51};
  uint8_t bytesprops5[] = {0xe7, 0x22, 0xb5, 0x26, 0x3c};
  uint8_t bytesprops6[] = {0x60, 0xe2};
  uint8_t bytesprops7[] = {0xb6, 0x8f, 0xfa, 0xfd, 0x76, 0x52, 0x96, 0x46, 0xe2, 0x89, 0x4a, 0x96, 0xbf, 0xc6, 0x19, 0xf8, 0xd8, 0x0, 0x3f, 0x3e};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30601}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 13}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={20, (char*)&bytesprops1}, .v={9, (char*)&bytesprops2}}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {30, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9535}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {13, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 253}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1395}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 9375}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {5, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17101}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 52}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 122}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 55}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 156}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 248}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25630}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 676}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 77}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 115}},
    {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 162, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoSessiontakenOver [PropRequestProblemInformation 147,PropMessageExpiryInterval 9332,PropRequestResponseInformation 40,PropResponseInformation "p@d\ESCG.\GS\ENQYk\146",PropSubscriptionIdentifierAvailable 113,PropMessageExpiryInterval 27708,PropServerKeepAlive 21312,PropAuthenticationMethod "\135][)\217\DC4\240\v@\146\210\SO|\ETB\196\148\SI\v&eot\168\173\149\230\247",PropSessionExpiryInterval 18569,PropRequestResponseInformation 98,PropResponseTopic "D\157\149n\nd@\206\195_ZW\162\186\SUB\205\ETX\228\DC1\225\r-\214",PropRequestProblemInformation 73,PropWildcardSubscriptionAvailable 141,PropAssignedClientIdentifier "\194d?Y\181\ESC\194u\DEL\149\215\&3g&Q\SI\v\134\189\167b\134\DLE\214",PropReceiveMaximum 12656,PropRequestProblemInformation 62,PropResponseInformation "\170\232\143G\220\241",PropTopicAlias 28685]
TEST(Disco5QCTest, Encode25) {
uint8_t pkt[] = {0xe0, 0x93, 0x1, 0x8e, 0x90, 0x1, 0x17, 0x93, 0x2, 0x0, 0x0, 0x24, 0x74, 0x19, 0x28, 0x1a, 0x0, 0xb, 0x70, 0x40, 0x64, 0x1b, 0x47, 0x2e, 0x1d, 0x5, 0x59, 0x6b, 0x92, 0x29, 0x71, 0x2, 0x0, 0x0, 0x6c, 0x3c, 0x13, 0x53, 0x40, 0x15, 0x0, 0x1b, 0x87, 0x5d, 0x5b, 0x29, 0xd9, 0x14, 0xf0, 0xb, 0x40, 0x92, 0xd2, 0xe, 0x7c, 0x17, 0xc4, 0x94, 0xf, 0xb, 0x26, 0x65, 0x6f, 0x74, 0xa8, 0xad, 0x95, 0xe6, 0xf7, 0x11, 0x0, 0x0, 0x48, 0x89, 0x19, 0x62, 0x8, 0x0, 0x17, 0x44, 0x9d, 0x95, 0x6e, 0xa, 0x64, 0x40, 0xce, 0xc3, 0x5f, 0x5a, 0x57, 0xa2, 0xba, 0x1a, 0xcd, 0x3, 0xe4, 0x11, 0xe1, 0xd, 0x2d, 0xd6, 0x17, 0x49, 0x28, 0x8d, 0x12, 0x0, 0x18, 0xc2, 0x64, 0x3f, 0x59, 0xb5, 0x1b, 0xc2, 0x75, 0x7f, 0x95, 0xd7, 0x33, 0x67, 0x26, 0x51, 0xf, 0xb, 0x86, 0xbd, 0xa7, 0x62, 0x86, 0x10, 0xd6, 0x21, 0x31, 0x70, 0x17, 0x3e, 0x1a, 0x0, 0x6, 0xaa, 0xe8, 0x8f, 0x47, 0xdc, 0xf1, 0x23, 0x70, 0xd};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x70, 0x40, 0x64, 0x1b, 0x47, 0x2e, 0x1d, 0x5, 0x59, 0x6b, 0x92};
  uint8_t bytesprops1[] = {0x87, 0x5d, 0x5b, 0x29, 0xd9, 0x14, 0xf0, 0xb, 0x40, 0x92, 0xd2, 0xe, 0x7c, 0x17, 0xc4, 0x94, 0xf, 0xb, 0x26, 0x65, 0x6f, 0x74, 0xa8, 0xad, 0x95, 0xe6, 0xf7};
  uint8_t bytesprops2[] = {0x44, 0x9d, 0x95, 0x6e, 0xa, 0x64, 0x40, 0xce, 0xc3, 0x5f, 0x5a, 0x57, 0xa2, 0xba, 0x1a, 0xcd, 0x3, 0xe4, 0x11, 0xe1, 0xd, 0x2d, 0xd6};
  uint8_t bytesprops3[] = {0xc2, 0x64, 0x3f, 0x59, 0xb5, 0x1b, 0xc2, 0x75, 0x7f, 0x95, 0xd7, 0x33, 0x67, 0x26, 0x51, 0xf, 0xb, 0x86, 0xbd, 0xa7, 0x62, 0x86, 0x10, 0xd6};
  uint8_t bytesprops4[] = {0xaa, 0xe8, 0x8f, 0x47, 0xdc, 0xf1};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 147}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9332}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 40}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {11, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 113}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27708}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21312}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {27, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18569}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 98}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 73}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 141}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 12656}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 62}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 28685}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 142, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoDisconnectWithWill [PropRetainAvailable 130,PropAuthenticationMethod "\NUL\175\222#\241w\211H\140/4\249\v\GS\209\138/<N\213\194R6Qa",PropServerKeepAlive 20204,PropSubscriptionIdentifier 19,PropSessionExpiryInterval 31376,PropReceiveMaximum 22426,PropServerKeepAlive 3571,PropServerReference "\v<\ESC\SUB.\233\255\DC3Y\231\168L_\231\US\147\165\224\167\182\139^\254Y",PropAssignedClientIdentifier "\145\177\201|\254I\179\&4\239|\175\250\159\198{Y\250\DLE\254\180bH#\128\176\176~",PropCorrelationData "",PropMaximumQoS 74,PropMaximumPacketSize 31839,PropMaximumQoS 179,PropRequestProblemInformation 212,PropResponseInformation "\214\177\146o\133\155fl`{\231\194\DC4\245\222\221\212{p",PropSharedSubscriptionAvailable 193,PropMessageExpiryInterval 14961]
TEST(Disco5QCTest, Encode26) {
uint8_t pkt[] = {0xe0, 0x95, 0x1, 0x4, 0x92, 0x1, 0x25, 0x82, 0x15, 0x0, 0x19, 0x0, 0xaf, 0xde, 0x23, 0xf1, 0x77, 0xd3, 0x48, 0x8c, 0x2f, 0x34, 0xf9, 0xb, 0x1d, 0xd1, 0x8a, 0x2f, 0x3c, 0x4e, 0xd5, 0xc2, 0x52, 0x36, 0x51, 0x61, 0x13, 0x4e, 0xec, 0xb, 0x13, 0x11, 0x0, 0x0, 0x7a, 0x90, 0x21, 0x57, 0x9a, 0x13, 0xd, 0xf3, 0x1c, 0x0, 0x18, 0xb, 0x3c, 0x1b, 0x1a, 0x2e, 0xe9, 0xff, 0x13, 0x59, 0xe7, 0xa8, 0x4c, 0x5f, 0xe7, 0x1f, 0x93, 0xa5, 0xe0, 0xa7, 0xb6, 0x8b, 0x5e, 0xfe, 0x59, 0x12, 0x0, 0x1b, 0x91, 0xb1, 0xc9, 0x7c, 0xfe, 0x49, 0xb3, 0x34, 0xef, 0x7c, 0xaf, 0xfa, 0x9f, 0xc6, 0x7b, 0x59, 0xfa, 0x10, 0xfe, 0xb4, 0x62, 0x48, 0x23, 0x80, 0xb0, 0xb0, 0x7e, 0x9, 0x0, 0x0, 0x24, 0x4a, 0x27, 0x0, 0x0, 0x7c, 0x5f, 0x24, 0xb3, 0x17, 0xd4, 0x1a, 0x0, 0x13, 0xd6, 0xb1, 0x92, 0x6f, 0x85, 0x9b, 0x66, 0x6c, 0x60, 0x7b, 0xe7, 0xc2, 0x14, 0xf5, 0xde, 0xdd, 0xd4, 0x7b, 0x70, 0x2a, 0xc1, 0x2, 0x0, 0x0, 0x3a, 0x71};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x0, 0xaf, 0xde, 0x23, 0xf1, 0x77, 0xd3, 0x48, 0x8c, 0x2f, 0x34, 0xf9, 0xb, 0x1d, 0xd1, 0x8a, 0x2f, 0x3c, 0x4e, 0xd5, 0xc2, 0x52, 0x36, 0x51, 0x61};
  uint8_t bytesprops1[] = {0xb, 0x3c, 0x1b, 0x1a, 0x2e, 0xe9, 0xff, 0x13, 0x59, 0xe7, 0xa8, 0x4c, 0x5f, 0xe7, 0x1f, 0x93, 0xa5, 0xe0, 0xa7, 0xb6, 0x8b, 0x5e, 0xfe, 0x59};
  uint8_t bytesprops2[] = {0x91, 0xb1, 0xc9, 0x7c, 0xfe, 0x49, 0xb3, 0x34, 0xef, 0x7c, 0xaf, 0xfa, 0x9f, 0xc6, 0x7b, 0x59, 0xfa, 0x10, 0xfe, 0xb4, 0x62, 0x48, 0x23, 0x80, 0xb0, 0xb0, 0x7e};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0xd6, 0xb1, 0x92, 0x6f, 0x85, 0x9b, 0x66, 0x6c, 0x60, 0x7b, 0xe7, 0xc2, 0x14, 0xf5, 0xde, 0xdd, 0xd4, 0x7b, 0x70};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 130}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20204}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 19}},
    {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31376}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 22426}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 3571}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {27, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 74}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31839}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 179}},
    {.prop = (lwmqtt_prop_t)23, .value = {.byte = 212}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {19, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 193}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14961}},
  };

  lwmqtt_properties_t props = {17, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoReceiveMaximumExceeded [PropSubscriptionIdentifierAvailable 195,PropSubscriptionIdentifierAvailable 118,PropWildcardSubscriptionAvailable 57,PropSharedSubscriptionAvailable 151,PropSubscriptionIdentifierAvailable 223,PropWildcardSubscriptionAvailable 127,PropPayloadFormatIndicator 16,PropAssignedClientIdentifier "\136",PropAuthenticationMethod "!\207L\DEL\218\SOH\248\154\136\NUL\145\178\144\179sC\128\219\130\192\152\171\235?\US\233r+",PropMessageExpiryInterval 2710,PropReasonString "\254l\186\197\177\RS\164\233W\211+X\201\225[$\233\196\166>\SI~\209",PropAuthenticationMethod "\\\200\SYN\152\131\144<\133\204*\249\180=\185\254G\156\223>)\226[^\237K\ESC3",PropMaximumPacketSize 8572,PropSubscriptionIdentifier 9,PropRetainAvailable 54,PropTopicAlias 1970,PropServerKeepAlive 23614,PropServerKeepAlive 10526,PropRetainAvailable 214,PropSharedSubscriptionAvailable 41,PropResponseTopic "\DEL\EM|\231\226S",PropSharedSubscriptionAvailable 109,PropResponseInformation "",PropWillDelayInterval 281,PropTopicAlias 7326,PropMaximumPacketSize 26693,PropContentType "S\141l\161\207\&3\249\&9\209D\207\&9\197G\134\176c\136<\US\EOTVH\147\231\138\136\186\201\SYN",PropUserProperty "\132\254\170S\168\SOH$\201\199>\151\EM\233.\129y\214" ">G)",PropTopicAlias 32372]
TEST(Disco5QCTest, Encode27) {
uint8_t pkt[] = {0xe0, 0xdf, 0x1, 0x93, 0xdc, 0x1, 0x29, 0xc3, 0x29, 0x76, 0x28, 0x39, 0x2a, 0x97, 0x29, 0xdf, 0x28, 0x7f, 0x1, 0x10, 0x12, 0x0, 0x1, 0x88, 0x15, 0x0, 0x1c, 0x21, 0xcf, 0x4c, 0x7f, 0xda, 0x1, 0xf8, 0x9a, 0x88, 0x0, 0x91, 0xb2, 0x90, 0xb3, 0x73, 0x43, 0x80, 0xdb, 0x82, 0xc0, 0x98, 0xab, 0xeb, 0x3f, 0x1f, 0xe9, 0x72, 0x2b, 0x2, 0x0, 0x0, 0xa, 0x96, 0x1f, 0x0, 0x17, 0xfe, 0x6c, 0xba, 0xc5, 0xb1, 0x1e, 0xa4, 0xe9, 0x57, 0xd3, 0x2b, 0x58, 0xc9, 0xe1, 0x5b, 0x24, 0xe9, 0xc4, 0xa6, 0x3e, 0xf, 0x7e, 0xd1, 0x15, 0x0, 0x1b, 0x5c, 0xc8, 0x16, 0x98, 0x83, 0x90, 0x3c, 0x85, 0xcc, 0x2a, 0xf9, 0xb4, 0x3d, 0xb9, 0xfe, 0x47, 0x9c, 0xdf, 0x3e, 0x29, 0xe2, 0x5b, 0x5e, 0xed, 0x4b, 0x1b, 0x33, 0x27, 0x0, 0x0, 0x21, 0x7c, 0xb, 0x9, 0x25, 0x36, 0x23, 0x7, 0xb2, 0x13, 0x5c, 0x3e, 0x13, 0x29, 0x1e, 0x25, 0xd6, 0x2a, 0x29, 0x8, 0x0, 0x6, 0x7f, 0x19, 0x7c, 0xe7, 0xe2, 0x53, 0x2a, 0x6d, 0x1a, 0x0, 0x0, 0x18, 0x0, 0x0, 0x1, 0x19, 0x23, 0x1c, 0x9e, 0x27, 0x0, 0x0, 0x68, 0x45, 0x3, 0x0, 0x1e, 0x53, 0x8d, 0x6c, 0xa1, 0xcf, 0x33, 0xf9, 0x39, 0xd1, 0x44, 0xcf, 0x39, 0xc5, 0x47, 0x86, 0xb0, 0x63, 0x88, 0x3c, 0x1f, 0x4, 0x56, 0x48, 0x93, 0xe7, 0x8a, 0x88, 0xba, 0xc9, 0x16, 0x26, 0x0, 0x11, 0x84, 0xfe, 0xaa, 0x53, 0xa8, 0x1, 0x24, 0xc9, 0xc7, 0x3e, 0x97, 0x19, 0xe9, 0x2e, 0x81, 0x79, 0xd6, 0x0, 0x3, 0x3e, 0x47, 0x29, 0x23, 0x7e, 0x74};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x88};
  uint8_t bytesprops1[] = {0x21, 0xcf, 0x4c, 0x7f, 0xda, 0x1, 0xf8, 0x9a, 0x88, 0x0, 0x91, 0xb2, 0x90, 0xb3, 0x73, 0x43, 0x80, 0xdb, 0x82, 0xc0, 0x98, 0xab, 0xeb, 0x3f, 0x1f, 0xe9, 0x72, 0x2b};
  uint8_t bytesprops2[] = {0xfe, 0x6c, 0xba, 0xc5, 0xb1, 0x1e, 0xa4, 0xe9, 0x57, 0xd3, 0x2b, 0x58, 0xc9, 0xe1, 0x5b, 0x24, 0xe9, 0xc4, 0xa6, 0x3e, 0xf, 0x7e, 0xd1};
  uint8_t bytesprops3[] = {0x5c, 0xc8, 0x16, 0x98, 0x83, 0x90, 0x3c, 0x85, 0xcc, 0x2a, 0xf9, 0xb4, 0x3d, 0xb9, 0xfe, 0x47, 0x9c, 0xdf, 0x3e, 0x29, 0xe2, 0x5b, 0x5e, 0xed, 0x4b, 0x1b, 0x33};
  uint8_t bytesprops4[] = {0x7f, 0x19, 0x7c, 0xe7, 0xe2, 0x53};
  uint8_t bytesprops5[] = {0};
  uint8_t bytesprops6[] = {0x53, 0x8d, 0x6c, 0xa1, 0xcf, 0x33, 0xf9, 0x39, 0xd1, 0x44, 0xcf, 0x39, 0xc5, 0x47, 0x86, 0xb0, 0x63, 0x88, 0x3c, 0x1f, 0x4, 0x56, 0x48, 0x93, 0xe7, 0x8a, 0x88, 0xba, 0xc9, 0x16};
  uint8_t bytesprops8[] = {0x3e, 0x47, 0x29};
  uint8_t bytesprops7[] = {0x84, 0xfe, 0xaa, 0x53, 0xa8, 0x1, 0x24, 0xc9, 0xc7, 0x3e, 0x97, 0x19, 0xe9, 0x2e, 0x81, 0x79, 0xd6};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 195}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 118}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 57}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 151}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 223}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 127}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 16}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {1, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2710}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {23, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {27, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 8572}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 9}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 54}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1970}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 23614}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 10526}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 214}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 41}},
    {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 109}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {0, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 281}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7326}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 26693}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={17, (char*)&bytesprops7}, .v={3, (char*)&bytesprops8}}}},
    {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32372}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 147, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoQuotaExceeded [PropServerReference "e\227\135\rV\154\ESC\NAK\SI!9s\164]\166(xw\210\239",PropCorrelationData "\v\201\204i\228\149\223\235\226\197\164<XJ\213\230\166\157\158\ETB\146\201\221E",PropAssignedClientIdentifier "t\144LA\234\SOH\252\152\137\136Y\140\228\234\207\142\SI\r<\t\206\234",PropSubscriptionIdentifierAvailable 223,PropWildcardSubscriptionAvailable 84,PropReasonString "\250\144\249\140Q\223",PropRequestResponseInformation 180,PropRetainAvailable 55,PropSubscriptionIdentifier 31,PropMessageExpiryInterval 29062,PropReasonString "\152\251\247)\134D\187\218\f\184t]\195\148}\159Z.J@\253\176\142\254Q\204",PropMessageExpiryInterval 32108,PropSubscriptionIdentifierAvailable 36,PropReceiveMaximum 11255,PropAssignedClientIdentifier "\242\EMx\158\144s]=$C}F\231y2\251RR\249PN\158u",PropSharedSubscriptionAvailable 170,PropCorrelationData "\212\251\169M\194\244;\173\168\169\232\t\199\244\191n\145\213\133[\161\GS",PropRetainAvailable 26,PropAssignedClientIdentifier "\EMB\250)\ESC\a4.\239_U)\SO\185$\238W\170\164?%\160\&3\147\DLE\254ou\173",PropRequestResponseInformation 253,PropReceiveMaximum 22463,PropPayloadFormatIndicator 185]
TEST(Disco5QCTest, Encode28) {
uint8_t pkt[] = {0xe0, 0xeb, 0x1, 0x97, 0xe8, 0x1, 0x1c, 0x0, 0x14, 0x65, 0xe3, 0x87, 0xd, 0x56, 0x9a, 0x1b, 0x15, 0xf, 0x21, 0x39, 0x73, 0xa4, 0x5d, 0xa6, 0x28, 0x78, 0x77, 0xd2, 0xef, 0x9, 0x0, 0x18, 0xb, 0xc9, 0xcc, 0x69, 0xe4, 0x95, 0xdf, 0xeb, 0xe2, 0xc5, 0xa4, 0x3c, 0x58, 0x4a, 0xd5, 0xe6, 0xa6, 0x9d, 0x9e, 0x17, 0x92, 0xc9, 0xdd, 0x45, 0x12, 0x0, 0x16, 0x74, 0x90, 0x4c, 0x41, 0xea, 0x1, 0xfc, 0x98, 0x89, 0x88, 0x59, 0x8c, 0xe4, 0xea, 0xcf, 0x8e, 0xf, 0xd, 0x3c, 0x9, 0xce, 0xea, 0x29, 0xdf, 0x28, 0x54, 0x1f, 0x0, 0x6, 0xfa, 0x90, 0xf9, 0x8c, 0x51, 0xdf, 0x19, 0xb4, 0x25, 0x37, 0xb, 0x1f, 0x2, 0x0, 0x0, 0x71, 0x86, 0x1f, 0x0, 0x1a, 0x98, 0xfb, 0xf7, 0x29, 0x86, 0x44, 0xbb, 0xda, 0xc, 0xb8, 0x74, 0x5d, 0xc3, 0x94, 0x7d, 0x9f, 0x5a, 0x2e, 0x4a, 0x40, 0xfd, 0xb0, 0x8e, 0xfe, 0x51, 0xcc, 0x2, 0x0, 0x0, 0x7d, 0x6c, 0x29, 0x24, 0x21, 0x2b, 0xf7, 0x12, 0x0, 0x17, 0xf2, 0x19, 0x78, 0x9e, 0x90, 0x73, 0x5d, 0x3d, 0x24, 0x43, 0x7d, 0x46, 0xe7, 0x79, 0x32, 0xfb, 0x52, 0x52, 0xf9, 0x50, 0x4e, 0x9e, 0x75, 0x2a, 0xaa, 0x9, 0x0, 0x16, 0xd4, 0xfb, 0xa9, 0x4d, 0xc2, 0xf4, 0x3b, 0xad, 0xa8, 0xa9, 0xe8, 0x9, 0xc7, 0xf4, 0xbf, 0x6e, 0x91, 0xd5, 0x85, 0x5b, 0xa1, 0x1d, 0x25, 0x1a, 0x12, 0x0, 0x1d, 0x19, 0x42, 0xfa, 0x29, 0x1b, 0x7, 0x34, 0x2e, 0xef, 0x5f, 0x55, 0x29, 0xe, 0xb9, 0x24, 0xee, 0x57, 0xaa, 0xa4, 0x3f, 0x25, 0xa0, 0x33, 0x93, 0x10, 0xfe, 0x6f, 0x75, 0xad, 0x19, 0xfd, 0x21, 0x57, 0xbf, 0x1, 0xb9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x65, 0xe3, 0x87, 0xd, 0x56, 0x9a, 0x1b, 0x15, 0xf, 0x21, 0x39, 0x73, 0xa4, 0x5d, 0xa6, 0x28, 0x78, 0x77, 0xd2, 0xef};
  uint8_t bytesprops1[] = {0xb, 0xc9, 0xcc, 0x69, 0xe4, 0x95, 0xdf, 0xeb, 0xe2, 0xc5, 0xa4, 0x3c, 0x58, 0x4a, 0xd5, 0xe6, 0xa6, 0x9d, 0x9e, 0x17, 0x92, 0xc9, 0xdd, 0x45};
  uint8_t bytesprops2[] = {0x74, 0x90, 0x4c, 0x41, 0xea, 0x1, 0xfc, 0x98, 0x89, 0x88, 0x59, 0x8c, 0xe4, 0xea, 0xcf, 0x8e, 0xf, 0xd, 0x3c, 0x9, 0xce, 0xea};
  uint8_t bytesprops3[] = {0xfa, 0x90, 0xf9, 0x8c, 0x51, 0xdf};
  uint8_t bytesprops4[] = {0x98, 0xfb, 0xf7, 0x29, 0x86, 0x44, 0xbb, 0xda, 0xc, 0xb8, 0x74, 0x5d, 0xc3, 0x94, 0x7d, 0x9f, 0x5a, 0x2e, 0x4a, 0x40, 0xfd, 0xb0, 0x8e, 0xfe, 0x51, 0xcc};
  uint8_t bytesprops5[] = {0xf2, 0x19, 0x78, 0x9e, 0x90, 0x73, 0x5d, 0x3d, 0x24, 0x43, 0x7d, 0x46, 0xe7, 0x79, 0x32, 0xfb, 0x52, 0x52, 0xf9, 0x50, 0x4e, 0x9e, 0x75};
  uint8_t bytesprops6[] = {0xd4, 0xfb, 0xa9, 0x4d, 0xc2, 0xf4, 0x3b, 0xad, 0xa8, 0xa9, 0xe8, 0x9, 0xc7, 0xf4, 0xbf, 0x6e, 0x91, 0xd5, 0x85, 0x5b, 0xa1, 0x1d};
  uint8_t bytesprops7[] = {0x19, 0x42, 0xfa, 0x29, 0x1b, 0x7, 0x34, 0x2e, 0xef, 0x5f, 0x55, 0x29, 0xe, 0xb9, 0x24, 0xee, 0x57, 0xaa, 0xa4, 0x3f, 0x25, 0xa0, 0x33, 0x93, 0x10, 0xfe, 0x6f, 0x75, 0xad};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {20, (char*)&bytesprops0}}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops1}}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 223}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 84}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 180}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 55}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 31}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29062}},
    {.prop = (lwmqtt_prop_t)31, .value = {.str = {26, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32108}},
    {.prop = (lwmqtt_prop_t)41, .value = {.byte = 36}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 11255}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {23, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 170}},
    {.prop = (lwmqtt_prop_t)9, .value = {.str = {22, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)37, .value = {.byte = 26}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops7}}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 253}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 22463}},
    {.prop = (lwmqtt_prop_t)1, .value = {.byte = 185}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 151, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoQoSNotSupported [PropSharedSubscriptionAvailable 255,PropReceiveMaximum 3693,PropWillDelayInterval 1598,PropAssignedClientIdentifier "N\ETX7\158\t"]
TEST(Disco5QCTest, Encode29) {
uint8_t pkt[] = {0xe0, 0x14, 0x9b, 0x12, 0x2a, 0xff, 0x21, 0xe, 0x6d, 0x18, 0x0, 0x0, 0x6, 0x3e, 0x12, 0x0, 0x5, 0x4e, 0x3, 0x37, 0x9e, 0x9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops0[] = {0x4e, 0x3, 0x37, 0x9e, 0x9};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 255}},
    {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3693}},
    {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 1598}},
    {.prop = (lwmqtt_prop_t)18, .value = {.str = {5, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 155, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


// DisconnectRequest DiscoTopicNameInvalid [PropRequestResponseInformation 14,PropMaximumQoS 14,PropUserProperty "\CANt\DC3\215A\171%\171\&8\226\245\DC4\229\215\162\CAN\130\210\225\144\202\DC1^\157\&3\251\&8" "\EOT\135\132t-\251\FS",PropSubscriptionIdentifier 8,PropResponseInformation "\bk\\\249\RS-\196\GSE\164e\SO6\rR",PropAuthenticationMethod "\176\188\226\128U\183\r `\241",PropMaximumPacketSize 23171,PropMaximumQoS 139,PropRequestResponseInformation 198,PropSharedSubscriptionAvailable 220,PropSharedSubscriptionAvailable 63,PropWildcardSubscriptionAvailable 234,PropServerReference "",PropContentType "\ETB&&\253\179\166GJ",PropServerReference "\NUL\191\225s\226",PropServerKeepAlive 19145]
TEST(Disco5QCTest, Encode30) {
uint8_t pkt[] = {0xe0, 0x76, 0x90, 0x74, 0x19, 0xe, 0x24, 0xe, 0x26, 0x0, 0x1b, 0x18, 0x74, 0x13, 0xd7, 0x41, 0xab, 0x25, 0xab, 0x38, 0xe2, 0xf5, 0x14, 0xe5, 0xd7, 0xa2, 0x18, 0x82, 0xd2, 0xe1, 0x90, 0xca, 0x11, 0x5e, 0x9d, 0x33, 0xfb, 0x38, 0x0, 0x7, 0x4, 0x87, 0x84, 0x74, 0x2d, 0xfb, 0x1c, 0xb, 0x8, 0x1a, 0x0, 0xf, 0x8, 0x6b, 0x5c, 0xf9, 0x1e, 0x2d, 0xc4, 0x1d, 0x45, 0xa4, 0x65, 0xe, 0x36, 0xd, 0x52, 0x15, 0x0, 0xa, 0xb0, 0xbc, 0xe2, 0x80, 0x55, 0xb7, 0xd, 0x20, 0x60, 0xf1, 0x27, 0x0, 0x0, 0x5a, 0x83, 0x24, 0x8b, 0x19, 0xc6, 0x2a, 0xdc, 0x2a, 0x3f, 0x28, 0xea, 0x1c, 0x0, 0x0, 0x3, 0x0, 0x8, 0x17, 0x26, 0x26, 0xfd, 0xb3, 0xa6, 0x47, 0x4a, 0x1c, 0x0, 0x5, 0x0, 0xbf, 0xe1, 0x73, 0xe2, 0x13, 0x4a, 0xc9};
uint8_t buf[sizeof(pkt)+10] = { 0 };
  uint8_t bytesprops1[] = {0x4, 0x87, 0x84, 0x74, 0x2d, 0xfb, 0x1c};
  uint8_t bytesprops0[] = {0x18, 0x74, 0x13, 0xd7, 0x41, 0xab, 0x25, 0xab, 0x38, 0xe2, 0xf5, 0x14, 0xe5, 0xd7, 0xa2, 0x18, 0x82, 0xd2, 0xe1, 0x90, 0xca, 0x11, 0x5e, 0x9d, 0x33, 0xfb, 0x38};
  uint8_t bytesprops2[] = {0x8, 0x6b, 0x5c, 0xf9, 0x1e, 0x2d, 0xc4, 0x1d, 0x45, 0xa4, 0x65, 0xe, 0x36, 0xd, 0x52};
  uint8_t bytesprops3[] = {0xb0, 0xbc, 0xe2, 0x80, 0x55, 0xb7, 0xd, 0x20, 0x60, 0xf1};
  uint8_t bytesprops4[] = {0};
  uint8_t bytesprops5[] = {0x17, 0x26, 0x26, 0xfd, 0xb3, 0xa6, 0x47, 0x4a};
  uint8_t bytesprops6[] = {0x0, 0xbf, 0xe1, 0x73, 0xe2};
  
  lwmqtt_property_t propslist[] = {
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 14}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 14}},
    {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k={27, (char*)&bytesprops0}, .v={7, (char*)&bytesprops1}}}},
    {.prop = (lwmqtt_prop_t)11, .value = {.int32 = 8}},
    {.prop = (lwmqtt_prop_t)26, .value = {.str = {15, (char*)&bytesprops2}}},
    {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops3}}},
    {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 23171}},
    {.prop = (lwmqtt_prop_t)36, .value = {.byte = 139}},
    {.prop = (lwmqtt_prop_t)25, .value = {.byte = 198}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 220}},
    {.prop = (lwmqtt_prop_t)42, .value = {.byte = 63}},
    {.prop = (lwmqtt_prop_t)40, .value = {.byte = 234}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops4}}},
    {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops5}}},
    {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops6}}},
    {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 19145}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
size_t len = 0;
lwmqtt_err_t err = lwmqtt_encode_disconnect(buf, sizeof(buf), &len, LWMQTT_MQTT5, 144, props);
EXPECT_EQ(err, LWMQTT_SUCCESS);
EXPECT_EQ(len, sizeof(pkt));
EXPECT_ARRAY_EQ(pkt, buf, len);

}


