#include <gtest/gtest.h>

extern "C" {
#include <lwmqtt.h>
#include "../src/packet.h"
}

#ifdef __GNUC__
#pragma GCC diagnostic push
#ifdef __clang__
#pragma GCC diagnostic ignored "-Wc99-extensions"
#else
#pragma GCC diagnostic ignored "-Wpedantic"
#endif
#endif

#define EXPECT_ARRAY_EQ(reference, actual, element_count)                 \
  {                                                                       \
    for (size_t cmp_i = 0; cmp_i < element_count; cmp_i++) {              \
      EXPECT_EQ(reference[cmp_i], actual[cmp_i]) << "At byte: " << cmp_i; \
    }                                                                     \
  }

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\164\&3g\145", _pubPktID = 25063,
// _pubBody = "s\178\237\US", _pubProps = []}
TEST(Publish311QCTest, Encode1) {
  uint8_t pkt[] = {0x3c, 0xc, 0x0, 0x4, 0xa4, 0x33, 0x67, 0x91, 0x61, 0xe7, 0x73, 0xb2, 0xed, 0x1f};

  uint8_t buf[24] = {0};

  uint8_t topic_bytes[] = {0xa4, 0x33, 0x67, 0x91};
  lwmqtt_string_t topic = {4, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x73, 0xb2, 0xed, 0x1f};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 4;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 25063, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\213\SUB", _pubPktID = 13464,
// _pubBody = "o\ETBQD}\r\r\192J-\226\"\219Q\SO\244\182!", _pubProps = []}
TEST(Publish311QCTest, Encode2) {
  uint8_t pkt[] = {0x3a, 0x18, 0x0,  0x2,  0xd5, 0x1a, 0x34, 0x98, 0x6f, 0x17, 0x51, 0x44, 0x7d,
                   0xd,  0xd,  0xc0, 0x4a, 0x2d, 0xe2, 0x22, 0xdb, 0x51, 0xe,  0xf4, 0xb6, 0x21};

  uint8_t buf[36] = {0};

  uint8_t topic_bytes[] = {0xd5, 0x1a};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x6f, 0x17, 0x51, 0x44, 0x7d, 0xd, 0xd,  0xc0, 0x4a,
                         0x2d, 0xe2, 0x22, 0xdb, 0x51, 0xe, 0xf4, 0xb6, 0x21};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 13464, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic =
// "^\128\189\159\\k\153Q\222\207%\t\157-\238\240l\DLE&\ESC\220\&5\201yk\184\SO", _pubPktID = 18950, _pubBody =
// "\186\231\&1`\228\223^\203\149L\134\175o\ENQ-b\212\170\128\244\t}", _pubProps = []}
TEST(Publish311QCTest, Encode3) {
  uint8_t pkt[] = {0x3c, 0x35, 0x0,  0x1b, 0x5e, 0x80, 0xbd, 0x9f, 0x5c, 0x6b, 0x99, 0x51, 0xde, 0xcf,
                   0x25, 0x9,  0x9d, 0x2d, 0xee, 0xf0, 0x6c, 0x10, 0x26, 0x1b, 0xdc, 0x35, 0xc9, 0x79,
                   0x6b, 0xb8, 0xe,  0x4a, 0x6,  0xba, 0xe7, 0x31, 0x60, 0xe4, 0xdf, 0x5e, 0xcb, 0x95,
                   0x4c, 0x86, 0xaf, 0x6f, 0x5,  0x2d, 0x62, 0xd4, 0xaa, 0x80, 0xf4, 0x9,  0x7d};

  uint8_t buf[65] = {0};

  uint8_t topic_bytes[] = {0x5e, 0x80, 0xbd, 0x9f, 0x5c, 0x6b, 0x99, 0x51, 0xde, 0xcf, 0x25, 0x9,  0x9d, 0x2d,
                           0xee, 0xf0, 0x6c, 0x10, 0x26, 0x1b, 0xdc, 0x35, 0xc9, 0x79, 0x6b, 0xb8, 0xe};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = false;
  uint8_t msg_bytes[] = {0xba, 0xe7, 0x31, 0x60, 0xe4, 0xdf, 0x5e, 0xcb, 0x95, 0x4c, 0x86,
                         0xaf, 0x6f, 0x5,  0x2d, 0x62, 0xd4, 0xaa, 0x80, 0xf4, 0x9,  0x7d};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 22;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 18950, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\152\SUBq2\SOH\150", _pubPktID =
// 6631, _pubBody = "p\177\185\198Z\188\203\EOT\\\211>c\165\219\215U\r,", _pubProps = []}
TEST(Publish311QCTest, Encode4) {
  uint8_t pkt[] = {0x3a, 0x1c, 0x0,  0x6,  0x98, 0x1a, 0x71, 0x32, 0x1,  0x96, 0x19, 0xe7, 0x70, 0xb1, 0xb9,
                   0xc6, 0x5a, 0xbc, 0xcb, 0x4,  0x5c, 0xd3, 0x3e, 0x63, 0xa5, 0xdb, 0xd7, 0x55, 0xd,  0x2c};

  uint8_t buf[40] = {0};

  uint8_t topic_bytes[] = {0x98, 0x1a, 0x71, 0x32, 0x1, 0x96};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x70, 0xb1, 0xb9, 0xc6, 0x5a, 0xbc, 0xcb, 0x4, 0x5c,
                         0xd3, 0x3e, 0x63, 0xa5, 0xdb, 0xd7, 0x55, 0xd, 0x2c};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 6631, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic =
// ",=;\135\178\237\227\194~\130\190\147}\190\249wf\151\200\SI\170fO", _pubPktID = 22051, _pubBody =
// "\fJ\139u\132\RS\170\170\v\DC3\148\&2\213!,\174A\170\235~\144/\200", _pubProps = []}
TEST(Publish311QCTest, Encode5) {
  uint8_t pkt[] = {0x3b, 0x32, 0x0,  0x17, 0x2c, 0x3d, 0x3b, 0x87, 0xb2, 0xed, 0xe3, 0xc2, 0x7e,
                   0x82, 0xbe, 0x93, 0x7d, 0xbe, 0xf9, 0x77, 0x66, 0x97, 0xc8, 0xf,  0xaa, 0x66,
                   0x4f, 0x56, 0x23, 0xc,  0x4a, 0x8b, 0x75, 0x84, 0x1e, 0xaa, 0xaa, 0xb,  0x13,
                   0x94, 0x32, 0xd5, 0x21, 0x2c, 0xae, 0x41, 0xaa, 0xeb, 0x7e, 0x90, 0x2f, 0xc8};

  uint8_t buf[62] = {0};

  uint8_t topic_bytes[] = {0x2c, 0x3d, 0x3b, 0x87, 0xb2, 0xed, 0xe3, 0xc2, 0x7e, 0x82, 0xbe, 0x93,
                           0x7d, 0xbe, 0xf9, 0x77, 0x66, 0x97, 0xc8, 0xf,  0xaa, 0x66, 0x4f};
  lwmqtt_string_t topic = {23, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = true;
  uint8_t msg_bytes[] = {0xc,  0x4a, 0x8b, 0x75, 0x84, 0x1e, 0xaa, 0xaa, 0xb,  0x13, 0x94, 0x32,
                         0xd5, 0x21, 0x2c, 0xae, 0x41, 0xaa, 0xeb, 0x7e, 0x90, 0x2f, 0xc8};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 23;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 22051, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\STXO\147", _pubPktID = 12656,
// _pubBody = "\b\213$\145\229\187z\252G t\147N", _pubProps = []}
TEST(Publish311QCTest, Encode6) {
  uint8_t pkt[] = {0x35, 0x14, 0x0,  0x3,  0x2,  0x4f, 0x93, 0x31, 0x70, 0x8,  0xd5,
                   0x24, 0x91, 0xe5, 0xbb, 0x7a, 0xfc, 0x47, 0x20, 0x74, 0x93, 0x4e};

  uint8_t buf[32] = {0};

  uint8_t topic_bytes[] = {0x2, 0x4f, 0x93};
  lwmqtt_string_t topic = {3, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = true;
  uint8_t msg_bytes[] = {0x8, 0xd5, 0x24, 0x91, 0xe5, 0xbb, 0x7a, 0xfc, 0x47, 0x20, 0x74, 0x93, 0x4e};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 13;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 12656, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "a \154R\188d2\n\193\213a_`\215\209",
// _pubPktID = 0, _pubBody = "\223\f\232\t\237\211\234\248", _pubProps = []}
TEST(Publish311QCTest, Encode7) {
  uint8_t pkt[] = {0x31, 0x19, 0x0,  0xf,  0x61, 0x20, 0x9a, 0x52, 0xbc, 0x64, 0x32, 0xa,  0xc1, 0xd5,
                   0x61, 0x5f, 0x60, 0xd7, 0xd1, 0xdf, 0xc,  0xe8, 0x9,  0xed, 0xd3, 0xea, 0xf8};

  uint8_t buf[37] = {0};

  uint8_t topic_bytes[] = {0x61, 0x20, 0x9a, 0x52, 0xbc, 0x64, 0x32, 0xa, 0xc1, 0xd5, 0x61, 0x5f, 0x60, 0xd7, 0xd1};
  lwmqtt_string_t topic = {15, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = true;
  uint8_t msg_bytes[] = {0xdf, 0xc, 0xe8, 0x9, 0xed, 0xd3, 0xea, 0xf8};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 8;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic =
// "e\144}\187\204\234\r\DLE\238\SOHC\168\198\137\151;\170\232", _pubPktID = 0, _pubBody =
// "u\221\241\212\194^\n\142\246\204\133\216\SOH\232\215\139\249)", _pubProps = []}
TEST(Publish311QCTest, Encode8) {
  uint8_t pkt[] = {0x39, 0x26, 0x0,  0x12, 0x65, 0x90, 0x7d, 0xbb, 0xcc, 0xea, 0xd,  0x10, 0xee, 0x1,
                   0x43, 0xa8, 0xc6, 0x89, 0x97, 0x3b, 0xaa, 0xe8, 0x75, 0xdd, 0xf1, 0xd4, 0xc2, 0x5e,
                   0xa,  0x8e, 0xf6, 0xcc, 0x85, 0xd8, 0x1,  0xe8, 0xd7, 0x8b, 0xf9, 0x29};

  uint8_t buf[50] = {0};

  uint8_t topic_bytes[] = {0x65, 0x90, 0x7d, 0xbb, 0xcc, 0xea, 0xd,  0x10, 0xee,
                           0x1,  0x43, 0xa8, 0xc6, 0x89, 0x97, 0x3b, 0xaa, 0xe8};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = true;
  uint8_t msg_bytes[] = {0x75, 0xdd, 0xf1, 0xd4, 0xc2, 0x5e, 0xa,  0x8e, 0xf6,
                         0xcc, 0x85, 0xd8, 0x1,  0xe8, 0xd7, 0x8b, 0xf9, 0x29};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "", _pubPktID = 2526, _pubBody =
// "\230r\220N\f\196\206\176_\178\199 P\193-;\128\182%[", _pubProps = []}
TEST(Publish311QCTest, Encode9) {
  uint8_t pkt[] = {0x3a, 0x18, 0x0,  0x0,  0x9,  0xde, 0xe6, 0x72, 0xdc, 0x4e, 0xc,  0xc4, 0xce,
                   0xb0, 0x5f, 0xb2, 0xc7, 0x20, 0x50, 0xc1, 0x2d, 0x3b, 0x80, 0xb6, 0x25, 0x5b};

  uint8_t buf[36] = {0};

  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0xe6, 0x72, 0xdc, 0x4e, 0xc,  0xc4, 0xce, 0xb0, 0x5f, 0xb2,
                         0xc7, 0x20, 0x50, 0xc1, 0x2d, 0x3b, 0x80, 0xb6, 0x25, 0x5b};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 20;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, true, 2526, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "", _pubPktID = 0, _pubBody =
// "}5\238\204\DC2\254\162n\196-\172U\\\169\162\FS\RS\"\189v\148\229\\\223\144|\223\NUL\203", _pubProps = []}
TEST(Publish311QCTest, Encode10) {
  uint8_t pkt[] = {0x30, 0x1f, 0x0,  0x0,  0x7d, 0x35, 0xee, 0xcc, 0x12, 0xfe, 0xa2, 0x6e, 0xc4, 0x2d, 0xac, 0x55, 0x5c,
                   0xa9, 0xa2, 0x1c, 0x1e, 0x22, 0xbd, 0x76, 0x94, 0xe5, 0x5c, 0xdf, 0x90, 0x7c, 0xdf, 0x0,  0xcb};

  uint8_t buf[43] = {0};

  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x7d, 0x35, 0xee, 0xcc, 0x12, 0xfe, 0xa2, 0x6e, 0xc4, 0x2d, 0xac, 0x55, 0x5c, 0xa9, 0xa2,
                         0x1c, 0x1e, 0x22, 0xbd, 0x76, 0x94, 0xe5, 0x5c, 0xdf, 0x90, 0x7c, 0xdf, 0x0,  0xcb};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 29;

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT311, false, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic = "\164\&3g\145", _pubPktID = 25063,
// _pubBody = "s\178\237\US", _pubProps = [PropResponseInformation
// "L!\184\215\210_\255\ETB\163\229\EOT\141\214\173ES\136\224[\a\231Un",PropTopicAlias 28899,PropResponseInformation
// "\SUB\244>k\235hg\149[[&\157\218\EM\n]>\173\255\"*\DC4km\167'\166\176\135:",PropSessionExpiryInterval
// 1026,PropContentType "\195\170\244Y\SI\160\NAK\188\131",PropSessionExpiryInterval 1608,PropTopicAlias
// 15486,PropServerKeepAlive 2825,PropReasonString
// "\162o6_+a\190\216\144sk-\233\240}`\190\136",PropWildcardSubscriptionAvailable 165,PropServerKeepAlive
// 1630,PropResponseInformation "\157\230b\252P\221E\172\156^aK[\224",PropAuthenticationMethod
// "\r~\DC4\137\ETBK\250\235J]=\205\204]",PropResponseInformation
// ",\EM0\156%$=\228\DC44\180W\213\162,",PropTopicAliasMaximum 21055,PropTopicAliasMaximum
// 21339,PropMessageExpiryInterval 8748,PropReceiveMaximum 28723,PropRetainAvailable 108,PropSessionExpiryInterval
// 18854]}
TEST(Publish5QCTest, Encode1) {
  uint8_t pkt[] = {
      0x3c, 0xcb, 0x1,  0x0,  0x4,  0xa4, 0x33, 0x67, 0x91, 0x61, 0xe7, 0xbd, 0x1,  0x1a, 0x0,  0x17, 0x4c, 0x21, 0xb8,
      0xd7, 0xd2, 0x5f, 0xff, 0x17, 0xa3, 0xe5, 0x4,  0x8d, 0xd6, 0xad, 0x45, 0x53, 0x88, 0xe0, 0x5b, 0x7,  0xe7, 0x55,
      0x6e, 0x23, 0x70, 0xe3, 0x1a, 0x0,  0x1e, 0x1a, 0xf4, 0x3e, 0x6b, 0xeb, 0x68, 0x67, 0x95, 0x5b, 0x5b, 0x26, 0x9d,
      0xda, 0x19, 0xa,  0x5d, 0x3e, 0xad, 0xff, 0x22, 0x2a, 0x14, 0x6b, 0x6d, 0xa7, 0x27, 0xa6, 0xb0, 0x87, 0x3a, 0x11,
      0x0,  0x0,  0x4,  0x2,  0x3,  0x0,  0x9,  0xc3, 0xaa, 0xf4, 0x59, 0xf,  0xa0, 0x15, 0xbc, 0x83, 0x11, 0x0,  0x0,
      0x6,  0x48, 0x23, 0x3c, 0x7e, 0x13, 0xb,  0x9,  0x1f, 0x0,  0x12, 0xa2, 0x6f, 0x36, 0x5f, 0x2b, 0x61, 0xbe, 0xd8,
      0x90, 0x73, 0x6b, 0x2d, 0xe9, 0xf0, 0x7d, 0x60, 0xbe, 0x88, 0x28, 0xa5, 0x13, 0x6,  0x5e, 0x1a, 0x0,  0xe,  0x9d,
      0xe6, 0x62, 0xfc, 0x50, 0xdd, 0x45, 0xac, 0x9c, 0x5e, 0x61, 0x4b, 0x5b, 0xe0, 0x15, 0x0,  0xe,  0xd,  0x7e, 0x14,
      0x89, 0x17, 0x4b, 0xfa, 0xeb, 0x4a, 0x5d, 0x3d, 0xcd, 0xcc, 0x5d, 0x1a, 0x0,  0xf,  0x2c, 0x19, 0x30, 0x9c, 0x25,
      0x24, 0x3d, 0xe4, 0x14, 0x34, 0xb4, 0x57, 0xd5, 0xa2, 0x2c, 0x22, 0x52, 0x3f, 0x22, 0x53, 0x5b, 0x2,  0x0,  0x0,
      0x22, 0x2c, 0x21, 0x70, 0x33, 0x25, 0x6c, 0x11, 0x0,  0x0,  0x49, 0xa6, 0x73, 0xb2, 0xed, 0x1f};

  uint8_t buf[216] = {0};

  uint8_t topic_bytes[] = {0xa4, 0x33, 0x67, 0x91};
  lwmqtt_string_t topic = {4, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x73, 0xb2, 0xed, 0x1f};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 4;

  uint8_t bytesprops0[] = {0x4c, 0x21, 0xb8, 0xd7, 0xd2, 0x5f, 0xff, 0x17, 0xa3, 0xe5, 0x4, 0x8d,
                           0xd6, 0xad, 0x45, 0x53, 0x88, 0xe0, 0x5b, 0x7,  0xe7, 0x55, 0x6e};
  uint8_t bytesprops1[] = {0x1a, 0xf4, 0x3e, 0x6b, 0xeb, 0x68, 0x67, 0x95, 0x5b, 0x5b, 0x26, 0x9d, 0xda, 0x19, 0xa,
                           0x5d, 0x3e, 0xad, 0xff, 0x22, 0x2a, 0x14, 0x6b, 0x6d, 0xa7, 0x27, 0xa6, 0xb0, 0x87, 0x3a};
  uint8_t bytesprops2[] = {0xc3, 0xaa, 0xf4, 0x59, 0xf, 0xa0, 0x15, 0xbc, 0x83};
  uint8_t bytesprops3[] = {0xa2, 0x6f, 0x36, 0x5f, 0x2b, 0x61, 0xbe, 0xd8, 0x90,
                           0x73, 0x6b, 0x2d, 0xe9, 0xf0, 0x7d, 0x60, 0xbe, 0x88};
  uint8_t bytesprops4[] = {0x9d, 0xe6, 0x62, 0xfc, 0x50, 0xdd, 0x45, 0xac, 0x9c, 0x5e, 0x61, 0x4b, 0x5b, 0xe0};
  uint8_t bytesprops5[] = {0xd, 0x7e, 0x14, 0x89, 0x17, 0x4b, 0xfa, 0xeb, 0x4a, 0x5d, 0x3d, 0xcd, 0xcc, 0x5d};
  uint8_t bytesprops6[] = {0x2c, 0x19, 0x30, 0x9c, 0x25, 0x24, 0x3d, 0xe4, 0x14, 0x34, 0xb4, 0x57, 0xd5, 0xa2, 0x2c};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {23, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 28899}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1026}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {9, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1608}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15486}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2825}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {18, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 165}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 1630}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {15, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 21055}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 21339}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8748}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 28723}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 108}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18854}},
  };

  lwmqtt_properties_t props = {20, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 25063, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\213\SUB", _pubPktID = 13464,
// _pubBody = "o\ETBQD}\r\r\192J-\226\"\219Q\SO\244\182!", _pubProps = [PropResponseInformation
// "\194\135h\173\237}\162\160!b\215\197&\246}%\178\245\&9\170\GS",PropRetainAvailable 76,PropContentType
// ":\218W\DC37\181\243\164a\188i\DC3\198\193#^37\240\DC4\GSB0'C\228\169 9",PropReasonString
// "\248\139\145\ETX\170\&1\194\EM!\128]\US\182\182\203q\231\151T\180)",PropResponseInformation
// "\ETB\225\223\174M?f\214\128+wQ\US\246\156\238v\143ym[F",PropPayloadFormatIndicator 42,PropRequestResponseInformation
// 223,PropWildcardSubscriptionAvailable 32,PropPayloadFormatIndicator 79,PropRequestResponseInformation
// 125,PropResponseInformation
// "\170\220\ETXb\156\232\251\&8\199\250\153\255\203<B\"V\240\174\153i\222f\EOT0&\DEL\SI\DEL",PropServerReference
// "",PropWillDelayInterval 29196,PropAssignedClientIdentifier "\224\FS\229",PropServerReference
// "\150\233\213\&4\209\"s\202!\195\STX\221\246\215~\v\134\233W\199\175w\242\134\SYN\246",PropReceiveMaximum
// 12223,PropAssignedClientIdentifier "\246!\190\232\248\FS\161\EMk\161\231Kmqf\t
// \US\173\255\179\153#\DC3\132\r",PropAuthenticationMethod "\150<\132r\247\CAN\191\209\212S\137"]}
TEST(Publish5QCTest, Encode2) {
  uint8_t pkt[] = {0x3a, 0x88, 0x2,  0x0,  0x2,  0xd5, 0x1a, 0x34, 0x98, 0xee, 0x1,  0x1a, 0x0,  0x15, 0xc2, 0x87, 0x68,
                   0xad, 0xed, 0x7d, 0xa2, 0xa0, 0x21, 0x62, 0xd7, 0xc5, 0x26, 0xf6, 0x7d, 0x25, 0xb2, 0xf5, 0x39, 0xaa,
                   0x1d, 0x25, 0x4c, 0x3,  0x0,  0x1d, 0x3a, 0xda, 0x57, 0x13, 0x37, 0xb5, 0xf3, 0xa4, 0x61, 0xbc, 0x69,
                   0x13, 0xc6, 0xc1, 0x23, 0x5e, 0x33, 0x37, 0xf0, 0x14, 0x1d, 0x42, 0x30, 0x27, 0x43, 0xe4, 0xa9, 0x20,
                   0x39, 0x1f, 0x0,  0x15, 0xf8, 0x8b, 0x91, 0x3,  0xaa, 0x31, 0xc2, 0x19, 0x21, 0x80, 0x5d, 0x1f, 0xb6,
                   0xb6, 0xcb, 0x71, 0xe7, 0x97, 0x54, 0xb4, 0x29, 0x1a, 0x0,  0x16, 0x17, 0xe1, 0xdf, 0xae, 0x4d, 0x3f,
                   0x66, 0xd6, 0x80, 0x2b, 0x77, 0x51, 0x1f, 0xf6, 0x9c, 0xee, 0x76, 0x8f, 0x79, 0x6d, 0x5b, 0x46, 0x1,
                   0x2a, 0x19, 0xdf, 0x28, 0x20, 0x1,  0x4f, 0x19, 0x7d, 0x1a, 0x0,  0x1d, 0xaa, 0xdc, 0x3,  0x62, 0x9c,
                   0xe8, 0xfb, 0x38, 0xc7, 0xfa, 0x99, 0xff, 0xcb, 0x3c, 0x42, 0x22, 0x56, 0xf0, 0xae, 0x99, 0x69, 0xde,
                   0x66, 0x4,  0x30, 0x26, 0x7f, 0xf,  0x7f, 0x1c, 0x0,  0x0,  0x18, 0x0,  0x0,  0x72, 0xc,  0x12, 0x0,
                   0x3,  0xe0, 0x1c, 0xe5, 0x1c, 0x0,  0x1a, 0x96, 0xe9, 0xd5, 0x34, 0xd1, 0x22, 0x73, 0xca, 0x21, 0xc3,
                   0x2,  0xdd, 0xf6, 0xd7, 0x7e, 0xb,  0x86, 0xe9, 0x57, 0xc7, 0xaf, 0x77, 0xf2, 0x86, 0x16, 0xf6, 0x21,
                   0x2f, 0xbf, 0x12, 0x0,  0x1a, 0xf6, 0x21, 0xbe, 0xe8, 0xf8, 0x1c, 0xa1, 0x19, 0x6b, 0xa1, 0xe7, 0x4b,
                   0x6d, 0x71, 0x66, 0x9,  0x20, 0x1f, 0xad, 0xff, 0xb3, 0x99, 0x23, 0x13, 0x84, 0xd,  0x15, 0x0,  0xb,
                   0x96, 0x3c, 0x84, 0x72, 0xf7, 0x18, 0xbf, 0xd1, 0xd4, 0x53, 0x89, 0x6f, 0x17, 0x51, 0x44, 0x7d, 0xd,
                   0xd,  0xc0, 0x4a, 0x2d, 0xe2, 0x22, 0xdb, 0x51, 0xe,  0xf4, 0xb6, 0x21};

  uint8_t buf[277] = {0};

  uint8_t topic_bytes[] = {0xd5, 0x1a};
  lwmqtt_string_t topic = {2, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x6f, 0x17, 0x51, 0x44, 0x7d, 0xd, 0xd,  0xc0, 0x4a,
                         0x2d, 0xe2, 0x22, 0xdb, 0x51, 0xe, 0xf4, 0xb6, 0x21};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  uint8_t bytesprops0[] = {0xc2, 0x87, 0x68, 0xad, 0xed, 0x7d, 0xa2, 0xa0, 0x21, 0x62, 0xd7,
                           0xc5, 0x26, 0xf6, 0x7d, 0x25, 0xb2, 0xf5, 0x39, 0xaa, 0x1d};
  uint8_t bytesprops1[] = {0x3a, 0xda, 0x57, 0x13, 0x37, 0xb5, 0xf3, 0xa4, 0x61, 0xbc, 0x69, 0x13, 0xc6, 0xc1, 0x23,
                           0x5e, 0x33, 0x37, 0xf0, 0x14, 0x1d, 0x42, 0x30, 0x27, 0x43, 0xe4, 0xa9, 0x20, 0x39};
  uint8_t bytesprops2[] = {0xf8, 0x8b, 0x91, 0x3,  0xaa, 0x31, 0xc2, 0x19, 0x21, 0x80, 0x5d,
                           0x1f, 0xb6, 0xb6, 0xcb, 0x71, 0xe7, 0x97, 0x54, 0xb4, 0x29};
  uint8_t bytesprops3[] = {0x17, 0xe1, 0xdf, 0xae, 0x4d, 0x3f, 0x66, 0xd6, 0x80, 0x2b, 0x77,
                           0x51, 0x1f, 0xf6, 0x9c, 0xee, 0x76, 0x8f, 0x79, 0x6d, 0x5b, 0x46};
  uint8_t bytesprops4[] = {0xaa, 0xdc, 0x3,  0x62, 0x9c, 0xe8, 0xfb, 0x38, 0xc7, 0xfa, 0x99, 0xff, 0xcb, 0x3c, 0x42,
                           0x22, 0x56, 0xf0, 0xae, 0x99, 0x69, 0xde, 0x66, 0x4,  0x30, 0x26, 0x7f, 0xf,  0x7f};
  uint8_t bytesprops5[] = {0};
  uint8_t bytesprops6[] = {0xe0, 0x1c, 0xe5};
  uint8_t bytesprops7[] = {0x96, 0xe9, 0xd5, 0x34, 0xd1, 0x22, 0x73, 0xca, 0x21, 0xc3, 0x2,  0xdd, 0xf6,
                           0xd7, 0x7e, 0xb,  0x86, 0xe9, 0x57, 0xc7, 0xaf, 0x77, 0xf2, 0x86, 0x16, 0xf6};
  uint8_t bytesprops8[] = {0xf6, 0x21, 0xbe, 0xe8, 0xf8, 0x1c, 0xa1, 0x19, 0x6b, 0xa1, 0xe7, 0x4b, 0x6d,
                           0x71, 0x66, 0x9,  0x20, 0x1f, 0xad, 0xff, 0xb3, 0x99, 0x23, 0x13, 0x84, 0xd};
  uint8_t bytesprops9[] = {0x96, 0x3c, 0x84, 0x72, 0xf7, 0x18, 0xbf, 0xd1, 0xd4, 0x53, 0x89};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {21, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 76}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {29, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {21, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 42}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 223}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 32}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 79}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 125}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {29, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29196}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {3, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 12223}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {26, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops9}}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 13464, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS2, _pubRetain = False, _pubTopic =
// "^\128\189\159\\k\153Q\222\207%\t\157-\238\240l\DLE&\ESC\220\&5\201yk\184\SO", _pubPktID = 18950, _pubBody =
// "\186\231\&1`\228\223^\203\149L\134\175o\ENQ-b\212\170\128\244\t}", _pubProps = [PropReceiveMaximum
// 29869,PropUserProperty "\215Uz\241\&2\131\141\157\STX\EOT+\NAK\183O\236waZ\182" ")~$e",PropMaximumPacketSize
// 2422,PropResponseInformation "\230\244P\197\218\&5\216\196\NULY\209\DC3\183\208",PropMaximumPacketSize
// 5035,PropPayloadFormatIndicator 117,PropReceiveMaximum 26803,PropTopicAliasMaximum 14296,PropSessionExpiryInterval
// 31679,PropPayloadFormatIndicator 45,PropRetainAvailable 244,PropServerReference
// "\173\152\144\ACK\129\USviC\246-\182\&6\242+\179p\186\192:\162?Pm1\228\164",PropTopicAliasMaximum
// 28785,PropUserProperty "\154\165\DC4!T\200o\139\206\186\237\DC1\fiQ\166\172\159\211S\161\130\GS)\186\128<\169\248"
// "",PropResponseTopic "\194\201\SOH\194\248",PropReceiveMaximum 15379,PropMessageExpiryInterval 27645,PropUserProperty
// "\253\215\139\230\SI\148\199k\DC2\237\251G\ETB" "\180f\216\140",PropRequestResponseInformation 84,PropMaximumQoS
// 84,PropRequestProblemInformation 114,PropWildcardSubscriptionAvailable 79,PropMessageExpiryInterval 18902]}
TEST(Publish5QCTest, Encode3) {
  uint8_t pkt[] = {0x3c, 0xf8, 0x1,  0x0,  0x1b, 0x5e, 0x80, 0xbd, 0x9f, 0x5c, 0x6b, 0x99, 0x51, 0xde, 0xcf, 0x25, 0x9,
                   0x9d, 0x2d, 0xee, 0xf0, 0x6c, 0x10, 0x26, 0x1b, 0xdc, 0x35, 0xc9, 0x79, 0x6b, 0xb8, 0xe,  0x4a, 0x6,
                   0xc1, 0x1,  0x21, 0x74, 0xad, 0x26, 0x0,  0x13, 0xd7, 0x55, 0x7a, 0xf1, 0x32, 0x83, 0x8d, 0x9d, 0x2,
                   0x4,  0x2b, 0x15, 0xb7, 0x4f, 0xec, 0x77, 0x61, 0x5a, 0xb6, 0x0,  0x4,  0x29, 0x7e, 0x24, 0x65, 0x27,
                   0x0,  0x0,  0x9,  0x76, 0x1a, 0x0,  0xe,  0xe6, 0xf4, 0x50, 0xc5, 0xda, 0x35, 0xd8, 0xc4, 0x0,  0x59,
                   0xd1, 0x13, 0xb7, 0xd0, 0x27, 0x0,  0x0,  0x13, 0xab, 0x1,  0x75, 0x21, 0x68, 0xb3, 0x22, 0x37, 0xd8,
                   0x11, 0x0,  0x0,  0x7b, 0xbf, 0x1,  0x2d, 0x25, 0xf4, 0x1c, 0x0,  0x1b, 0xad, 0x98, 0x90, 0x6,  0x81,
                   0x1f, 0x76, 0x69, 0x43, 0xf6, 0x2d, 0xb6, 0x36, 0xf2, 0x2b, 0xb3, 0x70, 0xba, 0xc0, 0x3a, 0xa2, 0x3f,
                   0x50, 0x6d, 0x31, 0xe4, 0xa4, 0x22, 0x70, 0x71, 0x26, 0x0,  0x1d, 0x9a, 0xa5, 0x14, 0x21, 0x54, 0xc8,
                   0x6f, 0x8b, 0xce, 0xba, 0xed, 0x11, 0xc,  0x69, 0x51, 0xa6, 0xac, 0x9f, 0xd3, 0x53, 0xa1, 0x82, 0x1d,
                   0x29, 0xba, 0x80, 0x3c, 0xa9, 0xf8, 0x0,  0x0,  0x8,  0x0,  0x5,  0xc2, 0xc9, 0x1,  0xc2, 0xf8, 0x21,
                   0x3c, 0x13, 0x2,  0x0,  0x0,  0x6b, 0xfd, 0x26, 0x0,  0xd,  0xfd, 0xd7, 0x8b, 0xe6, 0xf,  0x94, 0xc7,
                   0x6b, 0x12, 0xed, 0xfb, 0x47, 0x17, 0x0,  0x4,  0xb4, 0x66, 0xd8, 0x8c, 0x19, 0x54, 0x24, 0x54, 0x17,
                   0x72, 0x28, 0x4f, 0x2,  0x0,  0x0,  0x49, 0xd6, 0xba, 0xe7, 0x31, 0x60, 0xe4, 0xdf, 0x5e, 0xcb, 0x95,
                   0x4c, 0x86, 0xaf, 0x6f, 0x5,  0x2d, 0x62, 0xd4, 0xaa, 0x80, 0xf4, 0x9,  0x7d};

  uint8_t buf[261] = {0};

  uint8_t topic_bytes[] = {0x5e, 0x80, 0xbd, 0x9f, 0x5c, 0x6b, 0x99, 0x51, 0xde, 0xcf, 0x25, 0x9,  0x9d, 0x2d,
                           0xee, 0xf0, 0x6c, 0x10, 0x26, 0x1b, 0xdc, 0x35, 0xc9, 0x79, 0x6b, 0xb8, 0xe};
  lwmqtt_string_t topic = {27, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = false;
  uint8_t msg_bytes[] = {0xba, 0xe7, 0x31, 0x60, 0xe4, 0xdf, 0x5e, 0xcb, 0x95, 0x4c, 0x86,
                         0xaf, 0x6f, 0x5,  0x2d, 0x62, 0xd4, 0xaa, 0x80, 0xf4, 0x9,  0x7d};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 22;

  uint8_t bytesprops1[] = {0x29, 0x7e, 0x24, 0x65};
  uint8_t bytesprops0[] = {0xd7, 0x55, 0x7a, 0xf1, 0x32, 0x83, 0x8d, 0x9d, 0x2, 0x4,
                           0x2b, 0x15, 0xb7, 0x4f, 0xec, 0x77, 0x61, 0x5a, 0xb6};
  uint8_t bytesprops2[] = {0xe6, 0xf4, 0x50, 0xc5, 0xda, 0x35, 0xd8, 0xc4, 0x0, 0x59, 0xd1, 0x13, 0xb7, 0xd0};
  uint8_t bytesprops3[] = {0xad, 0x98, 0x90, 0x6,  0x81, 0x1f, 0x76, 0x69, 0x43, 0xf6, 0x2d, 0xb6, 0x36, 0xf2,
                           0x2b, 0xb3, 0x70, 0xba, 0xc0, 0x3a, 0xa2, 0x3f, 0x50, 0x6d, 0x31, 0xe4, 0xa4};
  uint8_t bytesprops5[] = {0};
  uint8_t bytesprops4[] = {0x9a, 0xa5, 0x14, 0x21, 0x54, 0xc8, 0x6f, 0x8b, 0xce, 0xba, 0xed, 0x11, 0xc,  0x69, 0x51,
                           0xa6, 0xac, 0x9f, 0xd3, 0x53, 0xa1, 0x82, 0x1d, 0x29, 0xba, 0x80, 0x3c, 0xa9, 0xf8};
  uint8_t bytesprops6[] = {0xc2, 0xc9, 0x1, 0xc2, 0xf8};
  uint8_t bytesprops8[] = {0xb4, 0x66, 0xd8, 0x8c};
  uint8_t bytesprops7[] = {0xfd, 0xd7, 0x8b, 0xe6, 0xf, 0x94, 0xc7, 0x6b, 0x12, 0xed, 0xfb, 0x47, 0x17};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29869}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {19, (char*)&bytesprops0}, .v = {4, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2422}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 5035}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 117}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 26803}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 14296}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31679}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 45}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 244}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28785}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {29, (char*)&bytesprops4}, .v = {0, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15379}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27645}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {13, (char*)&bytesprops7}, .v = {4, (char*)&bytesprops8}}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 84}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 84}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 114}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 79}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18902}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 18950, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "\152\SUBq2\SOH\150", _pubPktID =
// 6631, _pubBody = "p\177\185\198Z\188\203\EOT\\\211>c\165\219\215U\r,", _pubProps = [PropResponseTopic
// "l\240\222\&5\155S\DC1\144",PropSharedSubscriptionAvailable 195,PropTopicAlias 21764,PropAssignedClientIdentifier
// "5~5s\229n8\168[\185\169#j\178",PropMessageExpiryInterval 6243,PropSubscriptionIdentifier
// 8,PropWildcardSubscriptionAvailable 98,PropTopicAlias 18850]}
TEST(Publish5QCTest, Encode4) {
  uint8_t pkt[] = {0x3a, 0x4a, 0x0,  0x6,  0x98, 0x1a, 0x71, 0x32, 0x1,  0x96, 0x19, 0xe7, 0x2d, 0x8,  0x0,  0x8,
                   0x6c, 0xf0, 0xde, 0x35, 0x9b, 0x53, 0x11, 0x90, 0x2a, 0xc3, 0x23, 0x55, 0x4,  0x12, 0x0,  0xe,
                   0x35, 0x7e, 0x35, 0x73, 0xe5, 0x6e, 0x38, 0xa8, 0x5b, 0xb9, 0xa9, 0x23, 0x6a, 0xb2, 0x2,  0x0,
                   0x0,  0x18, 0x63, 0xb,  0x8,  0x28, 0x62, 0x23, 0x49, 0xa2, 0x70, 0xb1, 0xb9, 0xc6, 0x5a, 0xbc,
                   0xcb, 0x4,  0x5c, 0xd3, 0x3e, 0x63, 0xa5, 0xdb, 0xd7, 0x55, 0xd,  0x2c};

  uint8_t buf[86] = {0};

  uint8_t topic_bytes[] = {0x98, 0x1a, 0x71, 0x32, 0x1, 0x96};
  lwmqtt_string_t topic = {6, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x70, 0xb1, 0xb9, 0xc6, 0x5a, 0xbc, 0xcb, 0x4, 0x5c,
                         0xd3, 0x3e, 0x63, 0xa5, 0xdb, 0xd7, 0x55, 0xd, 0x2c};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  uint8_t bytesprops0[] = {0x6c, 0xf0, 0xde, 0x35, 0x9b, 0x53, 0x11, 0x90};
  uint8_t bytesprops1[] = {0x35, 0x7e, 0x35, 0x73, 0xe5, 0x6e, 0x38, 0xa8, 0x5b, 0xb9, 0xa9, 0x23, 0x6a, 0xb2};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 195}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21764}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {14, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6243}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 8}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 98}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18850}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 6631, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = True, _pubTopic =
// ",=;\135\178\237\227\194~\130\190\147}\190\249wf\151\200\SI\170fO", _pubPktID = 22051, _pubBody =
// "\fJ\139u\132\RS\170\170\v\DC3\148\&2\213!,\174A\170\235~\144/\200", _pubProps = [PropTopicAlias
// 4075,PropCorrelationData "\DLE\191\196:\147\187(\220\172Vn\161`\131{L\154\170\146\220#\252~\187"]}
TEST(Publish5QCTest, Encode5) {
  uint8_t pkt[] = {0x3b, 0x51, 0x0,  0x17, 0x2c, 0x3d, 0x3b, 0x87, 0xb2, 0xed, 0xe3, 0xc2, 0x7e, 0x82, 0xbe, 0x93, 0x7d,
                   0xbe, 0xf9, 0x77, 0x66, 0x97, 0xc8, 0xf,  0xaa, 0x66, 0x4f, 0x56, 0x23, 0x1e, 0x23, 0xf,  0xeb, 0x9,
                   0x0,  0x18, 0x10, 0xbf, 0xc4, 0x3a, 0x93, 0xbb, 0x28, 0xdc, 0xac, 0x56, 0x6e, 0xa1, 0x60, 0x83, 0x7b,
                   0x4c, 0x9a, 0xaa, 0x92, 0xdc, 0x23, 0xfc, 0x7e, 0xbb, 0xc,  0x4a, 0x8b, 0x75, 0x84, 0x1e, 0xaa, 0xaa,
                   0xb,  0x13, 0x94, 0x32, 0xd5, 0x21, 0x2c, 0xae, 0x41, 0xaa, 0xeb, 0x7e, 0x90, 0x2f, 0xc8};

  uint8_t buf[93] = {0};

  uint8_t topic_bytes[] = {0x2c, 0x3d, 0x3b, 0x87, 0xb2, 0xed, 0xe3, 0xc2, 0x7e, 0x82, 0xbe, 0x93,
                           0x7d, 0xbe, 0xf9, 0x77, 0x66, 0x97, 0xc8, 0xf,  0xaa, 0x66, 0x4f};
  lwmqtt_string_t topic = {23, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = true;
  uint8_t msg_bytes[] = {0xc,  0x4a, 0x8b, 0x75, 0x84, 0x1e, 0xaa, 0xaa, 0xb,  0x13, 0x94, 0x32,
                         0xd5, 0x21, 0x2c, 0xae, 0x41, 0xaa, 0xeb, 0x7e, 0x90, 0x2f, 0xc8};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 23;

  uint8_t bytesprops0[] = {0x10, 0xbf, 0xc4, 0x3a, 0x93, 0xbb, 0x28, 0xdc, 0xac, 0x56, 0x6e, 0xa1,
                           0x60, 0x83, 0x7b, 0x4c, 0x9a, 0xaa, 0x92, 0xdc, 0x23, 0xfc, 0x7e, 0xbb};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4075}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 22051, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS2, _pubRetain = True, _pubTopic = "\STXO\147", _pubPktID = 12656,
// _pubBody = "\b\213$\145\229\187z\252G t\147N", _pubProps = [PropAssignedClientIdentifier "
// \252V\RS\233\245\158\128\150\184\254\245",PropReceiveMaximum 4428]}
TEST(Publish5QCTest, Encode6) {
  uint8_t pkt[] = {0x35, 0x27, 0x0,  0x3,  0x2,  0x4f, 0x93, 0x31, 0x70, 0x12, 0x12, 0x0,  0xc,  0x20,
                   0xfc, 0x56, 0x1e, 0xe9, 0xf5, 0x9e, 0x80, 0x96, 0xb8, 0xfe, 0xf5, 0x21, 0x11, 0x4c,
                   0x8,  0xd5, 0x24, 0x91, 0xe5, 0xbb, 0x7a, 0xfc, 0x47, 0x20, 0x74, 0x93, 0x4e};

  uint8_t buf[51] = {0};

  uint8_t topic_bytes[] = {0x2, 0x4f, 0x93};
  lwmqtt_string_t topic = {3, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS2;
  msg.retained = true;
  uint8_t msg_bytes[] = {0x8, 0xd5, 0x24, 0x91, 0xe5, 0xbb, 0x7a, 0xfc, 0x47, 0x20, 0x74, 0x93, 0x4e};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 13;

  uint8_t bytesprops0[] = {0x20, 0xfc, 0x56, 0x1e, 0xe9, 0xf5, 0x9e, 0x80, 0x96, 0xb8, 0xfe, 0xf5};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 4428}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 12656, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = True, _pubTopic = "a \154R\188d2\n\193\213a_`\215\209",
// _pubPktID = 0, _pubBody = "\223\f\232\t\237\211\234\248", _pubProps = [PropRequestProblemInformation
// 97,PropServerKeepAlive 31945,PropContentType "N'/\251'.\FS\225",PropMaximumQoS 83,PropMessageExpiryInterval
// 24968,PropTopicAlias 8465,PropAuthenticationData "\128\a\156\230",PropResponseTopic
// "\ACK\243\182\177\174b\f\US\168I$\EOT#\151&\RS",PropMaximumPacketSize 7420,PropAuthenticationData
// "\199\ENQ\199\225\219u",PropSubscriptionIdentifierAvailable 243,PropMessageExpiryInterval
// 11397,PropMessageExpiryInterval 29159,PropResponseTopic
// "r\134:OosukI\239-\139\&9&\192F+\CAN\168{\199\148",PropResponseTopic "\170\143\179j\163",PropUserProperty
// "ZY\167m\229\252\215\166'`\148^\142\185\227\218\ESCns\191~)" "d\138\183\"\186z\141\154\SO",PropServerReference
// "\137O\226",PropMaximumQoS 132,PropMessageExpiryInterval 3796,PropAuthenticationData
// "\ENQ\141P\158D",PropRequestResponseInformation 51,PropSharedSubscriptionAvailable 173,PropTopicAlias 15896]}
TEST(Publish5QCTest, Encode7) {
  uint8_t pkt[] = {
      0x31, 0xca, 0x1,  0x0,  0xf,  0x61, 0x20, 0x9a, 0x52, 0xbc, 0x64, 0x32, 0xa,  0xc1, 0xd5, 0x61, 0x5f, 0x60, 0xd7,
      0xd1, 0xaf, 0x1,  0x17, 0x61, 0x13, 0x7c, 0xc9, 0x3,  0x0,  0x8,  0x4e, 0x27, 0x2f, 0xfb, 0x27, 0x2e, 0x1c, 0xe1,
      0x24, 0x53, 0x2,  0x0,  0x0,  0x61, 0x88, 0x23, 0x21, 0x11, 0x16, 0x0,  0x4,  0x80, 0x7,  0x9c, 0xe6, 0x8,  0x0,
      0x10, 0x6,  0xf3, 0xb6, 0xb1, 0xae, 0x62, 0xc,  0x1f, 0xa8, 0x49, 0x24, 0x4,  0x23, 0x97, 0x26, 0x1e, 0x27, 0x0,
      0x0,  0x1c, 0xfc, 0x16, 0x0,  0x6,  0xc7, 0x5,  0xc7, 0xe1, 0xdb, 0x75, 0x29, 0xf3, 0x2,  0x0,  0x0,  0x2c, 0x85,
      0x2,  0x0,  0x0,  0x71, 0xe7, 0x8,  0x0,  0x16, 0x72, 0x86, 0x3a, 0x4f, 0x6f, 0x73, 0x75, 0x6b, 0x49, 0xef, 0x2d,
      0x8b, 0x39, 0x26, 0xc0, 0x46, 0x2b, 0x18, 0xa8, 0x7b, 0xc7, 0x94, 0x8,  0x0,  0x5,  0xaa, 0x8f, 0xb3, 0x6a, 0xa3,
      0x26, 0x0,  0x16, 0x5a, 0x59, 0xa7, 0x6d, 0xe5, 0xfc, 0xd7, 0xa6, 0x27, 0x60, 0x94, 0x5e, 0x8e, 0xb9, 0xe3, 0xda,
      0x1b, 0x6e, 0x73, 0xbf, 0x7e, 0x29, 0x0,  0x9,  0x64, 0x8a, 0xb7, 0x22, 0xba, 0x7a, 0x8d, 0x9a, 0xe,  0x1c, 0x0,
      0x3,  0x89, 0x4f, 0xe2, 0x24, 0x84, 0x2,  0x0,  0x0,  0xe,  0xd4, 0x16, 0x0,  0x5,  0x5,  0x8d, 0x50, 0x9e, 0x44,
      0x19, 0x33, 0x2a, 0xad, 0x23, 0x3e, 0x18, 0xdf, 0xc,  0xe8, 0x9,  0xed, 0xd3, 0xea, 0xf8};

  uint8_t buf[215] = {0};

  uint8_t topic_bytes[] = {0x61, 0x20, 0x9a, 0x52, 0xbc, 0x64, 0x32, 0xa, 0xc1, 0xd5, 0x61, 0x5f, 0x60, 0xd7, 0xd1};
  lwmqtt_string_t topic = {15, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = true;
  uint8_t msg_bytes[] = {0xdf, 0xc, 0xe8, 0x9, 0xed, 0xd3, 0xea, 0xf8};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 8;

  uint8_t bytesprops0[] = {0x4e, 0x27, 0x2f, 0xfb, 0x27, 0x2e, 0x1c, 0xe1};
  uint8_t bytesprops1[] = {0x80, 0x7, 0x9c, 0xe6};
  uint8_t bytesprops2[] = {0x6, 0xf3, 0xb6, 0xb1, 0xae, 0x62, 0xc, 0x1f, 0xa8, 0x49, 0x24, 0x4, 0x23, 0x97, 0x26, 0x1e};
  uint8_t bytesprops3[] = {0xc7, 0x5, 0xc7, 0xe1, 0xdb, 0x75};
  uint8_t bytesprops4[] = {0x72, 0x86, 0x3a, 0x4f, 0x6f, 0x73, 0x75, 0x6b, 0x49, 0xef, 0x2d,
                           0x8b, 0x39, 0x26, 0xc0, 0x46, 0x2b, 0x18, 0xa8, 0x7b, 0xc7, 0x94};
  uint8_t bytesprops5[] = {0xaa, 0x8f, 0xb3, 0x6a, 0xa3};
  uint8_t bytesprops7[] = {0x64, 0x8a, 0xb7, 0x22, 0xba, 0x7a, 0x8d, 0x9a, 0xe};
  uint8_t bytesprops6[] = {0x5a, 0x59, 0xa7, 0x6d, 0xe5, 0xfc, 0xd7, 0xa6, 0x27, 0x60, 0x94,
                           0x5e, 0x8e, 0xb9, 0xe3, 0xda, 0x1b, 0x6e, 0x73, 0xbf, 0x7e, 0x29};
  uint8_t bytesprops8[] = {0x89, 0x4f, 0xe2};
  uint8_t bytesprops9[] = {0x5, 0x8d, 0x50, 0x9e, 0x44};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 97}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 31945}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 83}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24968}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 8465}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {4, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {16, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7420}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {6, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 243}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11397}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29159}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {22, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {22, (char*)&bytesprops6}, .v = {9, (char*)&bytesprops7}}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 132}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3796}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {5, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 51}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 173}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15896}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS0, _pubRetain = True, _pubTopic =
// "e\144}\187\204\234\r\DLE\238\SOHC\168\198\137\151;\170\232", _pubPktID = 0, _pubBody =
// "u\221\241\212\194^\n\142\246\204\133\216\SOH\232\215\139\249)", _pubProps = [PropMessageExpiryInterval
// 548,PropSharedSubscriptionAvailable 3,PropSubscriptionIdentifier 21,PropSubscriptionIdentifierAvailable
// 46,PropSessionExpiryInterval 21517,PropAuthenticationMethod
// "(OV\255B\EM\232\131\NULqlC#\n\250\233\150D\ACK",PropServerKeepAlive 30127]}
TEST(Publish5QCTest, Encode8) {
  uint8_t pkt[] = {0x39, 0x50, 0x0,  0x12, 0x65, 0x90, 0x7d, 0xbb, 0xcc, 0xea, 0xd,  0x10, 0xee, 0x1,  0x43, 0xa8, 0xc6,
                   0x89, 0x97, 0x3b, 0xaa, 0xe8, 0x29, 0x2,  0x0,  0x0,  0x2,  0x24, 0x2a, 0x3,  0xb,  0x15, 0x29, 0x2e,
                   0x11, 0x0,  0x0,  0x54, 0xd,  0x15, 0x0,  0x13, 0x28, 0x4f, 0x56, 0xff, 0x42, 0x19, 0xe8, 0x83, 0x0,
                   0x71, 0x6c, 0x43, 0x23, 0xa,  0xfa, 0xe9, 0x96, 0x44, 0x6,  0x13, 0x75, 0xaf, 0x75, 0xdd, 0xf1, 0xd4,
                   0xc2, 0x5e, 0xa,  0x8e, 0xf6, 0xcc, 0x85, 0xd8, 0x1,  0xe8, 0xd7, 0x8b, 0xf9, 0x29};

  uint8_t buf[92] = {0};

  uint8_t topic_bytes[] = {0x65, 0x90, 0x7d, 0xbb, 0xcc, 0xea, 0xd,  0x10, 0xee,
                           0x1,  0x43, 0xa8, 0xc6, 0x89, 0x97, 0x3b, 0xaa, 0xe8};
  lwmqtt_string_t topic = {18, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = true;
  uint8_t msg_bytes[] = {0x75, 0xdd, 0xf1, 0xd4, 0xc2, 0x5e, 0xa,  0x8e, 0xf6,
                         0xcc, 0x85, 0xd8, 0x1,  0xe8, 0xd7, 0x8b, 0xf9, 0x29};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 18;

  uint8_t bytesprops0[] = {0x28, 0x4f, 0x56, 0xff, 0x42, 0x19, 0xe8, 0x83, 0x0, 0x71,
                           0x6c, 0x43, 0x23, 0xa,  0xfa, 0xe9, 0x96, 0x44, 0x6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 548}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 3}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 21}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 46}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21517}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 30127}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = True, _pubQoS = QoS1, _pubRetain = False, _pubTopic = "", _pubPktID = 2526, _pubBody =
// "\230r\220N\f\196\206\176_\178\199 P\193-;\128\182%[", _pubProps = [PropTopicAlias 14375,PropUserProperty ""
// "\CAN\168[j\236\236\204\ACK\214\rpk\DLE\242a\144\217\181\208\SOH\t|\146:\249",PropUserProperty
// "\151\r\128Fo\144\211\DC1<\EM\153\190NU6\134'>\186]"
// "uhX\173\171\223\&7\248\223\US1ODw4\203\177\ESC\EOT1\246]3\168\131\129N\EM\207\238",PropCorrelationData
// "\139\210\185\155\SUB\r\191"]}
TEST(Publish5QCTest, Encode9) {
  uint8_t pkt[] = {0x3a, 0x7b, 0x0,  0x0,  0x9,  0xde, 0x62, 0x23, 0x38, 0x27, 0x26, 0x0,  0x0,  0x0,  0x19, 0x18,
                   0xa8, 0x5b, 0x6a, 0xec, 0xec, 0xcc, 0x6,  0xd6, 0xd,  0x70, 0x6b, 0x10, 0xf2, 0x61, 0x90, 0xd9,
                   0xb5, 0xd0, 0x1,  0x9,  0x7c, 0x92, 0x3a, 0xf9, 0x26, 0x0,  0x14, 0x97, 0xd,  0x80, 0x46, 0x6f,
                   0x90, 0xd3, 0x11, 0x3c, 0x19, 0x99, 0xbe, 0x4e, 0x55, 0x36, 0x86, 0x27, 0x3e, 0xba, 0x5d, 0x0,
                   0x1e, 0x75, 0x68, 0x58, 0xad, 0xab, 0xdf, 0x37, 0xf8, 0xdf, 0x1f, 0x31, 0x4f, 0x44, 0x77, 0x34,
                   0xcb, 0xb1, 0x1b, 0x4,  0x31, 0xf6, 0x5d, 0x33, 0xa8, 0x83, 0x81, 0x4e, 0x19, 0xcf, 0xee, 0x9,
                   0x0,  0x7,  0x8b, 0xd2, 0xb9, 0x9b, 0x1a, 0xd,  0xbf, 0xe6, 0x72, 0xdc, 0x4e, 0xc,  0xc4, 0xce,
                   0xb0, 0x5f, 0xb2, 0xc7, 0x20, 0x50, 0xc1, 0x2d, 0x3b, 0x80, 0xb6, 0x25, 0x5b};

  uint8_t buf[135] = {0};

  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS1;
  msg.retained = false;
  uint8_t msg_bytes[] = {0xe6, 0x72, 0xdc, 0x4e, 0xc,  0xc4, 0xce, 0xb0, 0x5f, 0xb2,
                         0xc7, 0x20, 0x50, 0xc1, 0x2d, 0x3b, 0x80, 0xb6, 0x25, 0x5b};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 20;

  uint8_t bytesprops1[] = {0x18, 0xa8, 0x5b, 0x6a, 0xec, 0xec, 0xcc, 0x6, 0xd6, 0xd,  0x70, 0x6b, 0x10,
                           0xf2, 0x61, 0x90, 0xd9, 0xb5, 0xd0, 0x1,  0x9, 0x7c, 0x92, 0x3a, 0xf9};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops3[] = {0x75, 0x68, 0x58, 0xad, 0xab, 0xdf, 0x37, 0xf8, 0xdf, 0x1f, 0x31, 0x4f, 0x44, 0x77, 0x34,
                           0xcb, 0xb1, 0x1b, 0x4,  0x31, 0xf6, 0x5d, 0x33, 0xa8, 0x83, 0x81, 0x4e, 0x19, 0xcf, 0xee};
  uint8_t bytesprops2[] = {0x97, 0xd,  0x80, 0x46, 0x6f, 0x90, 0xd3, 0x11, 0x3c, 0x19,
                           0x99, 0xbe, 0x4e, 0x55, 0x36, 0x86, 0x27, 0x3e, 0xba, 0x5d};
  uint8_t bytesprops4[] = {0x8b, 0xd2, 0xb9, 0x9b, 0x1a, 0xd, 0xbf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 14375}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {0, (char*)&bytesprops0}, .v = {25, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {20, (char*)&bytesprops2}, .v = {30, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {4, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, true, 2526, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// PublishRequest {_pubDup = False, _pubQoS = QoS0, _pubRetain = False, _pubTopic = "", _pubPktID = 0, _pubBody =
// "}5\238\204\DC2\254\162n\196-\172U\\\169\162\FS\RS\"\189v\148\229\\\223\144|\223\NUL\203", _pubProps =
// [PropResponseTopic "f\145\140\205",PropSharedSubscriptionAvailable 213,PropReceiveMaximum
// 32116,PropSubscriptionIdentifierAvailable 232,PropCorrelationData
// "\178:4~\ESCW\197\185\219\NAK8\235\ETX\249\DEL4!\170",PropMaximumQoS 107,PropRequestProblemInformation
// 183,PropAuthenticationMethod "\214\218>\166\211\140\225\198\162\252\225\195\139\SOH\200,\222",PropServerKeepAlive
// 24310,PropWillDelayInterval 24774,PropMaximumQoS 165,PropResponseTopic
// "\FS\199k\197\227\NAK\183\135\ENQ\145\183*\190\255zg^\220&n\217r.\159",PropRequestProblemInformation
// 131,PropSharedSubscriptionAvailable 206,PropCorrelationData
// "@?m1T\SI\228\207\&2\160c\194\&0S\194\191\223\222",PropSubscriptionIdentifierAvailable 51]}
TEST(Publish5QCTest, Encode10) {
  uint8_t pkt[] = {0x30, 0x9b, 0x1,  0x0,  0x0,  0x7b, 0x8,  0x0,  0x4,  0x66, 0x91, 0x8c, 0xcd, 0x2a, 0xd5, 0x21,
                   0x7d, 0x74, 0x29, 0xe8, 0x9,  0x0,  0x12, 0xb2, 0x3a, 0x34, 0x7e, 0x1b, 0x57, 0xc5, 0xb9, 0xdb,
                   0x15, 0x38, 0xeb, 0x3,  0xf9, 0x7f, 0x34, 0x21, 0xaa, 0x24, 0x6b, 0x17, 0xb7, 0x15, 0x0,  0x11,
                   0xd6, 0xda, 0x3e, 0xa6, 0xd3, 0x8c, 0xe1, 0xc6, 0xa2, 0xfc, 0xe1, 0xc3, 0x8b, 0x1,  0xc8, 0x2c,
                   0xde, 0x13, 0x5e, 0xf6, 0x18, 0x0,  0x0,  0x60, 0xc6, 0x24, 0xa5, 0x8,  0x0,  0x18, 0x1c, 0xc7,
                   0x6b, 0xc5, 0xe3, 0x15, 0xb7, 0x87, 0x5,  0x91, 0xb7, 0x2a, 0xbe, 0xff, 0x7a, 0x67, 0x5e, 0xdc,
                   0x26, 0x6e, 0xd9, 0x72, 0x2e, 0x9f, 0x17, 0x83, 0x2a, 0xce, 0x9,  0x0,  0x12, 0x40, 0x3f, 0x6d,
                   0x31, 0x54, 0xf,  0xe4, 0xcf, 0x32, 0xa0, 0x63, 0xc2, 0x30, 0x53, 0xc2, 0xbf, 0xdf, 0xde, 0x29,
                   0x33, 0x7d, 0x35, 0xee, 0xcc, 0x12, 0xfe, 0xa2, 0x6e, 0xc4, 0x2d, 0xac, 0x55, 0x5c, 0xa9, 0xa2,
                   0x1c, 0x1e, 0x22, 0xbd, 0x76, 0x94, 0xe5, 0x5c, 0xdf, 0x90, 0x7c, 0xdf, 0x0,  0xcb};

  uint8_t buf[168] = {0};

  uint8_t topic_bytes[] = {0};
  lwmqtt_string_t topic = {0, (char*)&topic_bytes};
  lwmqtt_message_t msg = lwmqtt_default_message;
  msg.qos = LWMQTT_QOS0;
  msg.retained = false;
  uint8_t msg_bytes[] = {0x7d, 0x35, 0xee, 0xcc, 0x12, 0xfe, 0xa2, 0x6e, 0xc4, 0x2d, 0xac, 0x55, 0x5c, 0xa9, 0xa2,
                         0x1c, 0x1e, 0x22, 0xbd, 0x76, 0x94, 0xe5, 0x5c, 0xdf, 0x90, 0x7c, 0xdf, 0x0,  0xcb};
  msg.payload = (unsigned char*)&msg_bytes;
  msg.payload_len = 29;

  uint8_t bytesprops0[] = {0x66, 0x91, 0x8c, 0xcd};
  uint8_t bytesprops1[] = {0xb2, 0x3a, 0x34, 0x7e, 0x1b, 0x57, 0xc5, 0xb9, 0xdb,
                           0x15, 0x38, 0xeb, 0x3,  0xf9, 0x7f, 0x34, 0x21, 0xaa};
  uint8_t bytesprops2[] = {0xd6, 0xda, 0x3e, 0xa6, 0xd3, 0x8c, 0xe1, 0xc6, 0xa2,
                           0xfc, 0xe1, 0xc3, 0x8b, 0x1,  0xc8, 0x2c, 0xde};
  uint8_t bytesprops3[] = {0x1c, 0xc7, 0x6b, 0xc5, 0xe3, 0x15, 0xb7, 0x87, 0x5,  0x91, 0xb7, 0x2a,
                           0xbe, 0xff, 0x7a, 0x67, 0x5e, 0xdc, 0x26, 0x6e, 0xd9, 0x72, 0x2e, 0x9f};
  uint8_t bytesprops4[] = {0x40, 0x3f, 0x6d, 0x31, 0x54, 0xf,  0xe4, 0xcf, 0x32,
                           0xa0, 0x63, 0xc2, 0x30, 0x53, 0xc2, 0xbf, 0xdf, 0xde};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 32116}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 232}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {18, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 107}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 183}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 24310}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 24774}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 165}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {24, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 206}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {18, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 51}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_publish(buf, sizeof(buf), &len, LWMQTT_MQTT5, false, 0, topic, msg, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just ",\186\SUB\f\DC3\188\204KRj<%\n2x", _password = Just
// "\158A=\ETB\b\254\145\215X\242\128\192\ETB\DELE\ENQp\169\139;s~\SYN\135\CAN\209\EOT\226", _lastWill = Nothing,
// _cleanSession = False, _keepAlive = 22937, _connID = "\148<+X\194\247d\187\STXi\DLE\171\DC1\RS!:dW", _properties =
// []}
TEST(Connect311QCTest, Encode1) {
  uint8_t pkt[] = {0x10, 0x4d, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xc0, 0x59, 0x99, 0x0,  0x12, 0x94, 0x3c,
                   0x2b, 0x58, 0xc2, 0xf7, 0x64, 0xbb, 0x2,  0x69, 0x10, 0xab, 0x11, 0x1e, 0x21, 0x3a, 0x64, 0x57,
                   0x0,  0xf,  0x2c, 0xba, 0x1a, 0xc,  0x13, 0xbc, 0xcc, 0x4b, 0x52, 0x6a, 0x3c, 0x25, 0xa,  0x32,
                   0x78, 0x0,  0x1c, 0x9e, 0x41, 0x3d, 0x17, 0x8,  0xfe, 0x91, 0xd7, 0x58, 0xf2, 0x80, 0xc0, 0x17,
                   0x7f, 0x45, 0x5,  0x70, 0xa9, 0x8b, 0x3b, 0x73, 0x7e, 0x16, 0x87, 0x18, 0xd1, 0x4,  0xe2};

  uint8_t buf[89] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 22937;
  uint8_t client_id_bytes[] = {0x94, 0x3c, 0x2b, 0x58, 0xc2, 0xf7, 0x64, 0xbb, 0x2,
                               0x69, 0x10, 0xab, 0x11, 0x1e, 0x21, 0x3a, 0x64, 0x57};
  lwmqtt_string_t client_id = {18, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x2c, 0xba, 0x1a, 0xc, 0x13, 0xbc, 0xcc, 0x4b, 0x52, 0x6a, 0x3c, 0x25, 0xa, 0x32, 0x78};
  lwmqtt_string_t username = {15, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x9e, 0x41, 0x3d, 0x17, 0x8,  0xfe, 0x91, 0xd7, 0x58, 0xf2, 0x80, 0xc0, 0x17, 0x7f,
                              0x45, 0x5,  0x70, 0xa9, 0x8b, 0x3b, 0x73, 0x7e, 0x16, 0x87, 0x18, 0xd1, 0x4,  0xe2};
  lwmqtt_string_t password = {28, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, NULL);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\164\SYNT\228'W\255\244\187\193\237\180\r\238d\151m\191\n\183", _password =
// Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "2\RS", _willMsg =
// "C\US\226G\191\RS\225\238\241\187U\183Nx\ESC\165\135\147\181\SO|\ESC\236\155\198\&6\255\195", _willProps = []}),
// _cleanSession = True, _keepAlive = 23276, _connID = "\131={\SYN\158\175']\FS\233\139mf\131#\146\252M3", _properties =
// []}
TEST(Connect311QCTest, Encode2) {
  uint8_t pkt[] = {0x10, 0x57, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xa6, 0x5a, 0xec, 0x0,  0x13, 0x83,
                   0x3d, 0x7b, 0x16, 0x9e, 0xaf, 0x27, 0x5d, 0x1c, 0xe9, 0x8b, 0x6d, 0x66, 0x83, 0x23, 0x92,
                   0xfc, 0x4d, 0x33, 0x0,  0x2,  0x32, 0x1e, 0x0,  0x1c, 0x43, 0x1f, 0xe2, 0x47, 0xbf, 0x1e,
                   0xe1, 0xee, 0xf1, 0xbb, 0x55, 0xb7, 0x4e, 0x78, 0x1b, 0xa5, 0x87, 0x93, 0xb5, 0xe,  0x7c,
                   0x1b, 0xec, 0x9b, 0xc6, 0x36, 0xff, 0xc3, 0x0,  0x14, 0xa4, 0x16, 0x54, 0xe4, 0x27, 0x57,
                   0xff, 0xf4, 0xbb, 0xc1, 0xed, 0xb4, 0xd,  0xee, 0x64, 0x97, 0x6d, 0xbf, 0xa,  0xb7};

  uint8_t buf[99] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x32, 0x1e};
  lwmqtt_string_t will_topic = {2, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x43, 0x1f, 0xe2, 0x47, 0xbf, 0x1e, 0xe1, 0xee, 0xf1, 0xbb, 0x55, 0xb7, 0x4e, 0x78,
                                  0x1b, 0xa5, 0x87, 0x93, 0xb5, 0xe,  0x7c, 0x1b, 0xec, 0x9b, 0xc6, 0x36, 0xff, 0xc3};
  lwmqtt_string_t will_payload = {28, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 23276;
  uint8_t client_id_bytes[] = {0x83, 0x3d, 0x7b, 0x16, 0x9e, 0xaf, 0x27, 0x5d, 0x1c, 0xe9,
                               0x8b, 0x6d, 0x66, 0x83, 0x23, 0x92, 0xfc, 0x4d, 0x33};
  lwmqtt_string_t client_id = {19, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xa4, 0x16, 0x54, 0xe4, 0x27, 0x57, 0xff, 0xf4, 0xbb, 0xc1,
                              0xed, 0xb4, 0xd,  0xee, 0x64, 0x97, 0x6d, 0xbf, 0xa,  0xb7};
  lwmqtt_string_t username = {20, (char*)&username_bytes};
  opts.username = username;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\237TI=\140\157[R\161\178\154\138\249", _password = Just "\156\221\243", _lastWill
// = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic =
// "q\252\157\161\146\222\a\NAK2\173\167\152X\152\NAK", _willMsg =
// "\172\197<eAU\RS\144\242\233A\ETXd\DC3\235\241\183\196\197\230!\SUB\159p", _willProps = []}), _cleanSession = True,
// _keepAlive = 7844, _connID = "\DC3\182\162\243D\231aQ<\184p\138\206\248T\248E\205\216S", _properties = []}
TEST(Connect311QCTest, Encode3) {
  uint8_t pkt[] = {0x10, 0x5f, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xe6, 0x1e, 0xa4, 0x0,  0x14, 0x13, 0xb6, 0xa2,
                   0xf3, 0x44, 0xe7, 0x61, 0x51, 0x3c, 0xb8, 0x70, 0x8a, 0xce, 0xf8, 0x54, 0xf8, 0x45, 0xcd, 0xd8, 0x53,
                   0x0,  0xf,  0x71, 0xfc, 0x9d, 0xa1, 0x92, 0xde, 0x7,  0x15, 0x32, 0xad, 0xa7, 0x98, 0x58, 0x98, 0x15,
                   0x0,  0x18, 0xac, 0xc5, 0x3c, 0x65, 0x41, 0x55, 0x1e, 0x90, 0xf2, 0xe9, 0x41, 0x3,  0x64, 0x13, 0xeb,
                   0xf1, 0xb7, 0xc4, 0xc5, 0xe6, 0x21, 0x1a, 0x9f, 0x70, 0x0,  0xd,  0xed, 0x54, 0x49, 0x3d, 0x8c, 0x9d,
                   0x5b, 0x52, 0xa1, 0xb2, 0x9a, 0x8a, 0xf9, 0x0,  0x3,  0x9c, 0xdd, 0xf3};

  uint8_t buf[107] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x71, 0xfc, 0x9d, 0xa1, 0x92, 0xde, 0x7, 0x15,
                                0x32, 0xad, 0xa7, 0x98, 0x58, 0x98, 0x15};
  lwmqtt_string_t will_topic = {15, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xac, 0xc5, 0x3c, 0x65, 0x41, 0x55, 0x1e, 0x90, 0xf2, 0xe9, 0x41, 0x3,
                                  0x64, 0x13, 0xeb, 0xf1, 0xb7, 0xc4, 0xc5, 0xe6, 0x21, 0x1a, 0x9f, 0x70};
  lwmqtt_string_t will_payload = {24, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 7844;
  uint8_t client_id_bytes[] = {0x13, 0xb6, 0xa2, 0xf3, 0x44, 0xe7, 0x61, 0x51, 0x3c, 0xb8,
                               0x70, 0x8a, 0xce, 0xf8, 0x54, 0xf8, 0x45, 0xcd, 0xd8, 0x53};
  lwmqtt_string_t client_id = {20, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xed, 0x54, 0x49, 0x3d, 0x8c, 0x9d, 0x5b, 0x52, 0xa1, 0xb2, 0x9a, 0x8a, 0xf9};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x9c, 0xdd, 0xf3};
  lwmqtt_string_t password = {3, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\224i\DLEM\214\247\187\191\DEL\211\139G\208\177\241\223\240\254Q\187\238",
// _password = Just "\214t\171wJ\205+", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic =
// "\201\&2\STXO\162\178*\207.", _willMsg = "\130sO\246\224\216\186Y^\142PH\235zMe+\247P:~\151\243", _willProps = []}),
// _cleanSession = True, _keepAlive = 27556, _connID =
// "\SYN=D\DC23R\135\142|\151\t7\226\201\228\239\224\189\DC4a\198\210\FSA\189", _properties = []}
TEST(Connect311QCTest, Encode4) {
  uint8_t pkt[] = {0x10, 0x69, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xce, 0x6b, 0xa4, 0x0,  0x19, 0x16, 0x3d,
                   0x44, 0x12, 0x33, 0x52, 0x87, 0x8e, 0x7c, 0x97, 0x9,  0x37, 0xe2, 0xc9, 0xe4, 0xef, 0xe0, 0xbd,
                   0x14, 0x61, 0xc6, 0xd2, 0x1c, 0x41, 0xbd, 0x0,  0x9,  0xc9, 0x32, 0x2,  0x4f, 0xa2, 0xb2, 0x2a,
                   0xcf, 0x2e, 0x0,  0x17, 0x82, 0x73, 0x4f, 0xf6, 0xe0, 0xd8, 0xba, 0x59, 0x5e, 0x8e, 0x50, 0x48,
                   0xeb, 0x7a, 0x4d, 0x65, 0x2b, 0xf7, 0x50, 0x3a, 0x7e, 0x97, 0xf3, 0x0,  0x15, 0xe0, 0x69, 0x10,
                   0x4d, 0xd6, 0xf7, 0xbb, 0xbf, 0x7f, 0xd3, 0x8b, 0x47, 0xd0, 0xb1, 0xf1, 0xdf, 0xf0, 0xfe, 0x51,
                   0xbb, 0xee, 0x0,  0x7,  0xd6, 0x74, 0xab, 0x77, 0x4a, 0xcd, 0x2b};

  uint8_t buf[117] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xc9, 0x32, 0x2, 0x4f, 0xa2, 0xb2, 0x2a, 0xcf, 0x2e};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x82, 0x73, 0x4f, 0xf6, 0xe0, 0xd8, 0xba, 0x59, 0x5e, 0x8e, 0x50, 0x48,
                                  0xeb, 0x7a, 0x4d, 0x65, 0x2b, 0xf7, 0x50, 0x3a, 0x7e, 0x97, 0xf3};
  lwmqtt_string_t will_payload = {23, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS1;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 27556;
  uint8_t client_id_bytes[] = {0x16, 0x3d, 0x44, 0x12, 0x33, 0x52, 0x87, 0x8e, 0x7c, 0x97, 0x9,  0x37, 0xe2,
                               0xc9, 0xe4, 0xef, 0xe0, 0xbd, 0x14, 0x61, 0xc6, 0xd2, 0x1c, 0x41, 0xbd};
  lwmqtt_string_t client_id = {25, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xe0, 0x69, 0x10, 0x4d, 0xd6, 0xf7, 0xbb, 0xbf, 0x7f, 0xd3, 0x8b,
                              0x47, 0xd0, 0xb1, 0xf1, 0xdf, 0xf0, 0xfe, 0x51, 0xbb, 0xee};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xd6, 0x74, 0xab, 0x77, 0x4a, 0xcd, 0x2b};
  lwmqtt_string_t password = {7, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "`\158g", _password = Just "\232\SI\164\182", _lastWill = Just (LastWill
// {_willRetain = False, _willQoS = QoS0, _willTopic = "\228\209\134\&8\254\183", _willMsg =
// "u`\185\164|=O\ACK\216nx\132", _willProps = []}), _cleanSession = True, _keepAlive = 1272, _connID =
// "v=A\216\191\162\"ul\165(\217\182\151@.q", _properties = []}
TEST(Connect311QCTest, Encode5) {
  uint8_t pkt[] = {0x10, 0x3e, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xc6, 0x4,  0xf8, 0x0,  0x11, 0x76, 0x3d,
                   0x41, 0xd8, 0xbf, 0xa2, 0x22, 0x75, 0x6c, 0xa5, 0x28, 0xd9, 0xb6, 0x97, 0x40, 0x2e, 0x71, 0x0,
                   0x6,  0xe4, 0xd1, 0x86, 0x38, 0xfe, 0xb7, 0x0,  0xc,  0x75, 0x60, 0xb9, 0xa4, 0x7c, 0x3d, 0x4f,
                   0x6,  0xd8, 0x6e, 0x78, 0x84, 0x0,  0x3,  0x60, 0x9e, 0x67, 0x0,  0x4,  0xe8, 0xf,  0xa4, 0xb6};

  uint8_t buf[74] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe4, 0xd1, 0x86, 0x38, 0xfe, 0xb7};
  lwmqtt_string_t will_topic = {6, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x75, 0x60, 0xb9, 0xa4, 0x7c, 0x3d, 0x4f, 0x6, 0xd8, 0x6e, 0x78, 0x84};
  lwmqtt_string_t will_payload = {12, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 1272;
  uint8_t client_id_bytes[] = {0x76, 0x3d, 0x41, 0xd8, 0xbf, 0xa2, 0x22, 0x75, 0x6c,
                               0xa5, 0x28, 0xd9, 0xb6, 0x97, 0x40, 0x2e, 0x71};
  lwmqtt_string_t client_id = {17, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x60, 0x9e, 0x67};
  lwmqtt_string_t username = {3, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xe8, 0xf, 0xa4, 0xb6};
  lwmqtt_string_t password = {4, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "|\ENQ\ETXN\196/!2\EOT\150wV\ETB\205R\NUL", _password = Just
// "\171\176x\189\&3I\250!\207\139J\139\160x\SYN", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0,
// _willTopic = "9~,\236\224~@\247G|] \153\191\142\DC3\DEL\ETBcx\a\192\211\EOT\138IF", _willMsg =
// "\143q\200<\208LHV\222HO1\181U\229\173\158\255", _willProps = []}), _cleanSession = True, _keepAlive = 22109, _connID
// = "\DC4\170\162a\211\176\131\ETX\208", _properties = []}
TEST(Connect311QCTest, Encode6) {
  uint8_t pkt[] = {0x10, 0x69, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xe6, 0x56, 0x5d, 0x0,  0x9,  0x14, 0xaa,
                   0xa2, 0x61, 0xd3, 0xb0, 0x83, 0x3,  0xd0, 0x0,  0x1b, 0x39, 0x7e, 0x2c, 0xec, 0xe0, 0x7e, 0x40,
                   0xf7, 0x47, 0x7c, 0x5d, 0x20, 0x99, 0xbf, 0x8e, 0x13, 0x7f, 0x17, 0x63, 0x78, 0x7,  0xc0, 0xd3,
                   0x4,  0x8a, 0x49, 0x46, 0x0,  0x12, 0x8f, 0x71, 0xc8, 0x3c, 0xd0, 0x4c, 0x48, 0x56, 0xde, 0x48,
                   0x4f, 0x31, 0xb5, 0x55, 0xe5, 0xad, 0x9e, 0xff, 0x0,  0x10, 0x7c, 0x5,  0x3,  0x4e, 0xc4, 0x2f,
                   0x21, 0x32, 0x4,  0x96, 0x77, 0x56, 0x17, 0xcd, 0x52, 0x0,  0x0,  0xf,  0xab, 0xb0, 0x78, 0xbd,
                   0x33, 0x49, 0xfa, 0x21, 0xcf, 0x8b, 0x4a, 0x8b, 0xa0, 0x78, 0x16};

  uint8_t buf[117] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x39, 0x7e, 0x2c, 0xec, 0xe0, 0x7e, 0x40, 0xf7, 0x47, 0x7c, 0x5d, 0x20, 0x99, 0xbf,
                                0x8e, 0x13, 0x7f, 0x17, 0x63, 0x78, 0x7,  0xc0, 0xd3, 0x4,  0x8a, 0x49, 0x46};
  lwmqtt_string_t will_topic = {27, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x8f, 0x71, 0xc8, 0x3c, 0xd0, 0x4c, 0x48, 0x56, 0xde,
                                  0x48, 0x4f, 0x31, 0xb5, 0x55, 0xe5, 0xad, 0x9e, 0xff};
  lwmqtt_string_t will_payload = {18, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 22109;
  uint8_t client_id_bytes[] = {0x14, 0xaa, 0xa2, 0x61, 0xd3, 0xb0, 0x83, 0x3, 0xd0};
  lwmqtt_string_t client_id = {9, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x7c, 0x5,  0x3,  0x4e, 0xc4, 0x2f, 0x21, 0x32,
                              0x4,  0x96, 0x77, 0x56, 0x17, 0xcd, 0x52, 0x0};
  lwmqtt_string_t username = {16, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xab, 0xb0, 0x78, 0xbd, 0x33, 0x49, 0xfa, 0x21, 0xcf, 0x8b, 0x4a, 0x8b, 0xa0, 0x78, 0x16};
  lwmqtt_string_t password = {15, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "$\EM\165\160\SUBJ\a\172X\237g2\r\233#\197H\209G\165\171\255\DEL", _password = Just
// "\EM\190|\164\130", _lastWill = Nothing, _cleanSession = False, _keepAlive = 10212, _connID = "\"{\179:\181",
// _properties = []}
TEST(Connect311QCTest, Encode7) {
  uint8_t pkt[] = {0x10, 0x31, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xc0, 0x27, 0xe4, 0x0,
                   0x5,  0x22, 0x7b, 0xb3, 0x3a, 0xb5, 0x0,  0x17, 0x24, 0x19, 0xa5, 0xa0, 0x1a,
                   0x4a, 0x7,  0xac, 0x58, 0xed, 0x67, 0x32, 0xd,  0xe9, 0x23, 0xc5, 0x48, 0xd1,
                   0x47, 0xa5, 0xab, 0xff, 0x7f, 0x0,  0x5,  0x19, 0xbe, 0x7c, 0xa4, 0x82};

  uint8_t buf[61] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 10212;
  uint8_t client_id_bytes[] = {0x22, 0x7b, 0xb3, 0x3a, 0xb5};
  lwmqtt_string_t client_id = {5, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x24, 0x19, 0xa5, 0xa0, 0x1a, 0x4a, 0x7,  0xac, 0x58, 0xed, 0x67, 0x32,
                              0xd,  0xe9, 0x23, 0xc5, 0x48, 0xd1, 0x47, 0xa5, 0xab, 0xff, 0x7f};
  lwmqtt_string_t username = {23, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x19, 0xbe, 0x7c, 0xa4, 0x82};
  lwmqtt_string_t password = {5, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, NULL);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\152\195~\228&V\199\194\ESC\206\154", _password = Just
// "ve\174\255\183:\192\165\&3\171\241\187+\DEL\209\"\248\224\186\154", _lastWill = Just (LastWill {_willRetain = True,
// _willQoS = QoS1, _willTopic = "\162\193N\246G", _willMsg = "\193\226\183\237\166\202\233", _willProps = []}),
// _cleanSession = False, _keepAlive = 16879, _connID = "", _properties = []}
TEST(Connect311QCTest, Encode8) {
  uint8_t pkt[] = {0x10, 0x3f, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xec, 0x41, 0xef, 0x0,  0x0,  0x0,  0x5,  0xa2,
                   0xc1, 0x4e, 0xf6, 0x47, 0x0,  0x7,  0xc1, 0xe2, 0xb7, 0xed, 0xa6, 0xca, 0xe9, 0x0,  0xb,  0x98, 0xc3,
                   0x7e, 0xe4, 0x26, 0x56, 0xc7, 0xc2, 0x1b, 0xce, 0x9a, 0x0,  0x14, 0x76, 0x65, 0xae, 0xff, 0xb7, 0x3a,
                   0xc0, 0xa5, 0x33, 0xab, 0xf1, 0xbb, 0x2b, 0x7f, 0xd1, 0x22, 0xf8, 0xe0, 0xba, 0x9a};

  uint8_t buf[75] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa2, 0xc1, 0x4e, 0xf6, 0x47};
  lwmqtt_string_t will_topic = {5, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xc1, 0xe2, 0xb7, 0xed, 0xa6, 0xca, 0xe9};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS1;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 16879;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x98, 0xc3, 0x7e, 0xe4, 0x26, 0x56, 0xc7, 0xc2, 0x1b, 0xce, 0x9a};
  lwmqtt_string_t username = {11, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x76, 0x65, 0xae, 0xff, 0xb7, 0x3a, 0xc0, 0xa5, 0x33, 0xab,
                              0xf1, 0xbb, 0x2b, 0x7f, 0xd1, 0x22, 0xf8, 0xe0, 0xba, 0x9a};
  lwmqtt_string_t password = {20, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just
// "\242\220\SUB\204\v-\136\211/\218\DC2\243\158]\190\165\251\150H\238\200\DC2\152\245U\202\NULf\153", _password = Just
// "\161\v@\t\155\233WB", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic =
// "\222v\195\252\243\159p\129\STX\218r\STX\ESCm\242\201\193\&6X\191h\206\233\210x\134d\170\f", _willMsg =
// "\DC2Bm\152\DLE\140\SO\236*\150\134\134m\195I\140\tMpG\v\199\138'\230\242\227\247m\202", _willProps = []}),
// _cleanSession = True, _keepAlive = 9102, _connID =
// "\234B\EOT\247\247W\194\222\nP\131)&?\226\&0X\209p\ESC\177z\201\SOt\131g(\215W", _properties = []}
TEST(Connect311QCTest, Encode9) {
  uint8_t pkt[] = {0x10, 0x92, 0x1,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xc6, 0x23, 0x8e, 0x0,  0x1e, 0xea, 0x42,
                   0x4,  0xf7, 0xf7, 0x57, 0xc2, 0xde, 0xa,  0x50, 0x83, 0x29, 0x26, 0x3f, 0xe2, 0x30, 0x58, 0xd1, 0x70,
                   0x1b, 0xb1, 0x7a, 0xc9, 0xe,  0x74, 0x83, 0x67, 0x28, 0xd7, 0x57, 0x0,  0x1d, 0xde, 0x76, 0xc3, 0xfc,
                   0xf3, 0x9f, 0x70, 0x81, 0x2,  0xda, 0x72, 0x2,  0x1b, 0x6d, 0xf2, 0xc9, 0xc1, 0x36, 0x58, 0xbf, 0x68,
                   0xce, 0xe9, 0xd2, 0x78, 0x86, 0x64, 0xaa, 0xc,  0x0,  0x1e, 0x12, 0x42, 0x6d, 0x98, 0x10, 0x8c, 0xe,
                   0xec, 0x2a, 0x96, 0x86, 0x86, 0x6d, 0xc3, 0x49, 0x8c, 0x9,  0x4d, 0x70, 0x47, 0xb,  0xc7, 0x8a, 0x27,
                   0xe6, 0xf2, 0xe3, 0xf7, 0x6d, 0xca, 0x0,  0x1d, 0xf2, 0xdc, 0x1a, 0xcc, 0xb,  0x2d, 0x88, 0xd3, 0x2f,
                   0xda, 0x12, 0xf3, 0x9e, 0x5d, 0xbe, 0xa5, 0xfb, 0x96, 0x48, 0xee, 0xc8, 0x12, 0x98, 0xf5, 0x55, 0xca,
                   0x0,  0x66, 0x99, 0x0,  0x8,  0xa1, 0xb,  0x40, 0x9,  0x9b, 0xe9, 0x57, 0x42};

  uint8_t buf[159] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xde, 0x76, 0xc3, 0xfc, 0xf3, 0x9f, 0x70, 0x81, 0x2,  0xda,
                                0x72, 0x2,  0x1b, 0x6d, 0xf2, 0xc9, 0xc1, 0x36, 0x58, 0xbf,
                                0x68, 0xce, 0xe9, 0xd2, 0x78, 0x86, 0x64, 0xaa, 0xc};
  lwmqtt_string_t will_topic = {29, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x12, 0x42, 0x6d, 0x98, 0x10, 0x8c, 0xe,  0xec, 0x2a, 0x96,
                                  0x86, 0x86, 0x6d, 0xc3, 0x49, 0x8c, 0x9,  0x4d, 0x70, 0x47,
                                  0xb,  0xc7, 0x8a, 0x27, 0xe6, 0xf2, 0xe3, 0xf7, 0x6d, 0xca};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 9102;
  uint8_t client_id_bytes[] = {0xea, 0x42, 0x4,  0xf7, 0xf7, 0x57, 0xc2, 0xde, 0xa, 0x50, 0x83, 0x29, 0x26, 0x3f, 0xe2,
                               0x30, 0x58, 0xd1, 0x70, 0x1b, 0xb1, 0x7a, 0xc9, 0xe, 0x74, 0x83, 0x67, 0x28, 0xd7, 0x57};
  lwmqtt_string_t client_id = {30, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xf2, 0xdc, 0x1a, 0xcc, 0xb,  0x2d, 0x88, 0xd3, 0x2f, 0xda, 0x12, 0xf3, 0x9e, 0x5d, 0xbe,
                              0xa5, 0xfb, 0x96, 0x48, 0xee, 0xc8, 0x12, 0x98, 0xf5, 0x55, 0xca, 0x0,  0x66, 0x99};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xa1, 0xb, 0x40, 0x9, 0x9b, 0xe9, 0x57, 0x42};
  lwmqtt_string_t password = {8, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\174\237\224:\154\243X\224`\199", _password = Just
// "%\185W1f}\195\140\153\169\181\238\243\236\EM,V\216\ESC\151\168", _lastWill = Just (LastWill {_willRetain = True,
// _willQoS = QoS2, _willTopic = "\162\219\EM\161\228\128\255m", _willMsg = "", _willProps = []}), _cleanSession = True,
// _keepAlive = 17212, _connID = "\203o\140\199r\n\144n\FS\211\223\147\152?\GS\152/\v\245r\"\250", _properties = []}
TEST(Connect311QCTest, Encode10) {
  uint8_t pkt[] = {0x10, 0x51, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x4,  0xf6, 0x43, 0x3c, 0x0,  0x16, 0xcb, 0x6f, 0x8c,
                   0xc7, 0x72, 0xa,  0x90, 0x6e, 0x1c, 0xd3, 0xdf, 0x93, 0x98, 0x3f, 0x1d, 0x98, 0x2f, 0xb,  0xf5, 0x72,
                   0x22, 0xfa, 0x0,  0x8,  0xa2, 0xdb, 0x19, 0xa1, 0xe4, 0x80, 0xff, 0x6d, 0x0,  0x0,  0x0,  0xa,  0xae,
                   0xed, 0xe0, 0x3a, 0x9a, 0xf3, 0x58, 0xe0, 0x60, 0xc7, 0x0,  0x15, 0x25, 0xb9, 0x57, 0x31, 0x66, 0x7d,
                   0xc3, 0x8c, 0x99, 0xa9, 0xb5, 0xee, 0xf3, 0xec, 0x19, 0x2c, 0x56, 0xd8, 0x1b, 0x97, 0xa8};

  uint8_t buf[93] = {0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa2, 0xdb, 0x19, 0xa1, 0xe4, 0x80, 0xff, 0x6d};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0};
  lwmqtt_string_t will_payload = {0, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS2;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 17212;
  uint8_t client_id_bytes[] = {0xcb, 0x6f, 0x8c, 0xc7, 0x72, 0xa,  0x90, 0x6e, 0x1c, 0xd3, 0xdf,
                               0x93, 0x98, 0x3f, 0x1d, 0x98, 0x2f, 0xb,  0xf5, 0x72, 0x22, 0xfa};
  lwmqtt_string_t client_id = {22, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xae, 0xed, 0xe0, 0x3a, 0x9a, 0xf3, 0x58, 0xe0, 0x60, 0xc7};
  lwmqtt_string_t username = {10, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x25, 0xb9, 0x57, 0x31, 0x66, 0x7d, 0xc3, 0x8c, 0x99, 0xa9, 0xb5,
                              0xee, 0xf3, 0xec, 0x19, 0x2c, 0x56, 0xd8, 0x1b, 0x97, 0xa8};
  lwmqtt_string_t password = {21, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT311, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just ",\186\SUB\f\DC3\188\204KRj<%\n2x", _password = Just
// "\158A=\ETB\b\254\145\215X\242\128\192\ETB\DELE\ENQp\169\139;s~\SYN\135\CAN\209\EOT\226", _lastWill = Nothing,
// _cleanSession = False, _keepAlive = 22937, _connID = "\148<+X\194\247d\187\STXi\DLE\171\DC1\RS!:dW", _properties =
// [PropCorrelationData
// "\144\SO\142\195{!!z\131\203i\FS\DC3&\149\141\168;\221\161?A\ar\137\248\&5\168\184",PropContentType
// "\SOH\164",PropWildcardSubscriptionAvailable 190,PropSubscriptionIdentifier 12,PropSubscriptionIdentifier
// 8,PropPayloadFormatIndicator 27,PropCorrelationData
// "\205\&3\250%\190\141\145\175\244\RS\180\166\&8\136",PropSharedSubscriptionAvailable 213,PropMaximumPacketSize
// 1915,PropPayloadFormatIndicator 113,PropMaximumPacketSize 21593,PropReasonString
// "\250\249uz\138\249\194\b\228\DC2\255\ETX\255\197\147\151Q<\253\233",PropServerKeepAlive
// 7204,PropRequestResponseInformation 136,PropSubscriptionIdentifierAvailable 128,PropMessageExpiryInterval
// 9096,PropReceiveMaximum 15561,PropMessageExpiryInterval 7455,PropSubscriptionIdentifierAvailable 135,PropUserProperty
// "\176\189N\131h\172\225Z\211\180p\167*\229\193\SYN\f\191\190K\211\241Ca\193"
// "]yn\185\183\189R\213\162\202,\EOT\237ni[;Y\SUB",PropRequestProblemInformation 194,PropMaximumQoS
// 99,PropSessionExpiryInterval 11028]}
TEST(Connect5QCTest, Encode1) {
  uint8_t pkt[] = {
      0x10, 0x82, 0x2,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xc0, 0x59, 0x99, 0xb3, 0x1,  0x9,  0x0,  0x1d, 0x90,
      0xe,  0x8e, 0xc3, 0x7b, 0x21, 0x21, 0x7a, 0x83, 0xcb, 0x69, 0x1c, 0x13, 0x26, 0x95, 0x8d, 0xa8, 0x3b, 0xdd, 0xa1,
      0x3f, 0x41, 0x7,  0x72, 0x89, 0xf8, 0x35, 0xa8, 0xb8, 0x3,  0x0,  0x2,  0x1,  0xa4, 0x28, 0xbe, 0xb,  0xc,  0xb,
      0x8,  0x1,  0x1b, 0x9,  0x0,  0xe,  0xcd, 0x33, 0xfa, 0x25, 0xbe, 0x8d, 0x91, 0xaf, 0xf4, 0x1e, 0xb4, 0xa6, 0x38,
      0x88, 0x2a, 0xd5, 0x27, 0x0,  0x0,  0x7,  0x7b, 0x1,  0x71, 0x27, 0x0,  0x0,  0x54, 0x59, 0x1f, 0x0,  0x14, 0xfa,
      0xf9, 0x75, 0x7a, 0x8a, 0xf9, 0xc2, 0x8,  0xe4, 0x12, 0xff, 0x3,  0xff, 0xc5, 0x93, 0x97, 0x51, 0x3c, 0xfd, 0xe9,
      0x13, 0x1c, 0x24, 0x19, 0x88, 0x29, 0x80, 0x2,  0x0,  0x0,  0x23, 0x88, 0x21, 0x3c, 0xc9, 0x2,  0x0,  0x0,  0x1d,
      0x1f, 0x29, 0x87, 0x26, 0x0,  0x19, 0xb0, 0xbd, 0x4e, 0x83, 0x68, 0xac, 0xe1, 0x5a, 0xd3, 0xb4, 0x70, 0xa7, 0x2a,
      0xe5, 0xc1, 0x16, 0xc,  0xbf, 0xbe, 0x4b, 0xd3, 0xf1, 0x43, 0x61, 0xc1, 0x0,  0x13, 0x5d, 0x79, 0x6e, 0xb9, 0xb7,
      0xbd, 0x52, 0xd5, 0xa2, 0xca, 0x2c, 0x4,  0xed, 0x6e, 0x69, 0x5b, 0x3b, 0x59, 0x1a, 0x17, 0xc2, 0x24, 0x63, 0x11,
      0x0,  0x0,  0x2b, 0x14, 0x0,  0x12, 0x94, 0x3c, 0x2b, 0x58, 0xc2, 0xf7, 0x64, 0xbb, 0x2,  0x69, 0x10, 0xab, 0x11,
      0x1e, 0x21, 0x3a, 0x64, 0x57, 0x0,  0xf,  0x2c, 0xba, 0x1a, 0xc,  0x13, 0xbc, 0xcc, 0x4b, 0x52, 0x6a, 0x3c, 0x25,
      0xa,  0x32, 0x78, 0x0,  0x1c, 0x9e, 0x41, 0x3d, 0x17, 0x8,  0xfe, 0x91, 0xd7, 0x58, 0xf2, 0x80, 0xc0, 0x17, 0x7f,
      0x45, 0x5,  0x70, 0xa9, 0x8b, 0x3b, 0x73, 0x7e, 0x16, 0x87, 0x18, 0xd1, 0x4,  0xe2};

  uint8_t buf[271] = {0};

  uint8_t bytesprops0[] = {0x90, 0xe,  0x8e, 0xc3, 0x7b, 0x21, 0x21, 0x7a, 0x83, 0xcb, 0x69, 0x1c, 0x13, 0x26, 0x95,
                           0x8d, 0xa8, 0x3b, 0xdd, 0xa1, 0x3f, 0x41, 0x7,  0x72, 0x89, 0xf8, 0x35, 0xa8, 0xb8};
  uint8_t bytesprops1[] = {0x1, 0xa4};
  uint8_t bytesprops2[] = {0xcd, 0x33, 0xfa, 0x25, 0xbe, 0x8d, 0x91, 0xaf, 0xf4, 0x1e, 0xb4, 0xa6, 0x38, 0x88};
  uint8_t bytesprops3[] = {0xfa, 0xf9, 0x75, 0x7a, 0x8a, 0xf9, 0xc2, 0x8,  0xe4, 0x12,
                           0xff, 0x3,  0xff, 0xc5, 0x93, 0x97, 0x51, 0x3c, 0xfd, 0xe9};
  uint8_t bytesprops5[] = {0x5d, 0x79, 0x6e, 0xb9, 0xb7, 0xbd, 0x52, 0xd5, 0xa2, 0xca,
                           0x2c, 0x4,  0xed, 0x6e, 0x69, 0x5b, 0x3b, 0x59, 0x1a};
  uint8_t bytesprops4[] = {0xb0, 0xbd, 0x4e, 0x83, 0x68, 0xac, 0xe1, 0x5a, 0xd3, 0xb4, 0x70, 0xa7, 0x2a,
                           0xe5, 0xc1, 0x16, 0xc,  0xbf, 0xbe, 0x4b, 0xd3, 0xf1, 0x43, 0x61, 0xc1};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {29, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 190}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 12}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 8}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 27}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1915}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 113}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 21593}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 7204}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 136}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 128}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9096}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15561}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7455}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 135}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {25, (char*)&bytesprops4}, .v = {19, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 194}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 99}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11028}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 22937;
  uint8_t client_id_bytes[] = {0x94, 0x3c, 0x2b, 0x58, 0xc2, 0xf7, 0x64, 0xbb, 0x2,
                               0x69, 0x10, 0xab, 0x11, 0x1e, 0x21, 0x3a, 0x64, 0x57};
  lwmqtt_string_t client_id = {18, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x2c, 0xba, 0x1a, 0xc, 0x13, 0xbc, 0xcc, 0x4b, 0x52, 0x6a, 0x3c, 0x25, 0xa, 0x32, 0x78};
  lwmqtt_string_t username = {15, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x9e, 0x41, 0x3d, 0x17, 0x8,  0xfe, 0x91, 0xd7, 0x58, 0xf2, 0x80, 0xc0, 0x17, 0x7f,
                              0x45, 0x5,  0x70, 0xa9, 0x8b, 0x3b, 0x73, 0x7e, 0x16, 0x87, 0x18, 0xd1, 0x4,  0xe2};
  lwmqtt_string_t password = {28, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, NULL);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\164\SYNT\228'W\255\244\187\193\237\180\r\238d\151m\191\n\183", _password =
// Nothing, _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic = "2\RS", _willMsg =
// "C\US\226G\191\RS\225\238\241\187U\183Nx\ESC\165\135\147\181\SO|\ESC\236\155\198\&6\255\195", _willProps = []}),
// _cleanSession = True, _keepAlive = 23276, _connID = "\131={\SYN\158\175']\FS\233\139mf\131#\146\252M3", _properties =
// [PropServerKeepAlive 26284,PropSharedSubscriptionAvailable 216,PropMessageExpiryInterval 27230,PropTopicAlias
// 10402,PropServerKeepAlive 13080,PropRequestProblemInformation 123,PropSessionExpiryInterval 3460,PropServerKeepAlive
// 15256,PropRequestProblemInformation 228,PropReasonString "=\142\SUB\252
// \167\SYN\214\250t\224/\233\253bf\161\242\186(\213\ETB~\NULHY\245\203\158",PropCorrelationData
// "\252\188c#G\138\210\231\&8\154_\233R",PropPayloadFormatIndicator 247,PropSubscriptionIdentifier
// 30,PropPayloadFormatIndicator 39,PropContentType "\226\128\\\\J,\158",PropTopicAliasMaximum
// 21236,PropPayloadFormatIndicator 66,PropRetainAvailable 105,PropCorrelationData
// "\158\DC2A{W\204%\154\154U\170o\ENQ\247i\166|_]\214\231",PropMessageExpiryInterval 30139,PropAssignedClientIdentifier
// "\237\SOH)\185\193\166",PropWillDelayInterval 23656,PropRequestResponseInformation 57,PropTopicAlias
// 1904,PropMaximumQoS 29,PropSubscriptionIdentifierAvailable 242,PropSubscriptionIdentifier 27]}
TEST(Connect5QCTest, Encode2) {
  uint8_t pkt[] = {
      0x10, 0xf3, 0x1,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xa6, 0x5a, 0xec, 0x99, 0x1,  0x13, 0x66, 0xac, 0x2a,
      0xd8, 0x2,  0x0,  0x0,  0x6a, 0x5e, 0x23, 0x28, 0xa2, 0x13, 0x33, 0x18, 0x17, 0x7b, 0x11, 0x0,  0x0,  0xd,  0x84,
      0x13, 0x3b, 0x98, 0x17, 0xe4, 0x1f, 0x0,  0x1d, 0x3d, 0x8e, 0x1a, 0xfc, 0x20, 0xa7, 0x16, 0xd6, 0xfa, 0x74, 0xe0,
      0x2f, 0xe9, 0xfd, 0x62, 0x66, 0xa1, 0xf2, 0xba, 0x28, 0xd5, 0x17, 0x7e, 0x0,  0x48, 0x59, 0xf5, 0xcb, 0x9e, 0x9,
      0x0,  0xd,  0xfc, 0xbc, 0x63, 0x23, 0x47, 0x8a, 0xd2, 0xe7, 0x38, 0x9a, 0x5f, 0xe9, 0x52, 0x1,  0xf7, 0xb,  0x1e,
      0x1,  0x27, 0x3,  0x0,  0x7,  0xe2, 0x80, 0x5c, 0x5c, 0x4a, 0x2c, 0x9e, 0x22, 0x52, 0xf4, 0x1,  0x42, 0x25, 0x69,
      0x9,  0x0,  0x15, 0x9e, 0x12, 0x41, 0x7b, 0x57, 0xcc, 0x25, 0x9a, 0x9a, 0x55, 0xaa, 0x6f, 0x5,  0xf7, 0x69, 0xa6,
      0x7c, 0x5f, 0x5d, 0xd6, 0xe7, 0x2,  0x0,  0x0,  0x75, 0xbb, 0x12, 0x0,  0x6,  0xed, 0x1,  0x29, 0xb9, 0xc1, 0xa6,
      0x18, 0x0,  0x0,  0x5c, 0x68, 0x19, 0x39, 0x23, 0x7,  0x70, 0x24, 0x1d, 0x29, 0xf2, 0xb,  0x1b, 0x0,  0x13, 0x83,
      0x3d, 0x7b, 0x16, 0x9e, 0xaf, 0x27, 0x5d, 0x1c, 0xe9, 0x8b, 0x6d, 0x66, 0x83, 0x23, 0x92, 0xfc, 0x4d, 0x33, 0x0,
      0x0,  0x2,  0x32, 0x1e, 0x0,  0x1c, 0x43, 0x1f, 0xe2, 0x47, 0xbf, 0x1e, 0xe1, 0xee, 0xf1, 0xbb, 0x55, 0xb7, 0x4e,
      0x78, 0x1b, 0xa5, 0x87, 0x93, 0xb5, 0xe,  0x7c, 0x1b, 0xec, 0x9b, 0xc6, 0x36, 0xff, 0xc3, 0x0,  0x14, 0xa4, 0x16,
      0x54, 0xe4, 0x27, 0x57, 0xff, 0xf4, 0xbb, 0xc1, 0xed, 0xb4, 0xd,  0xee, 0x64, 0x97, 0x6d, 0xbf, 0xa,  0xb7};

  uint8_t buf[256] = {0};

  uint8_t bytesprops0[] = {0x3d, 0x8e, 0x1a, 0xfc, 0x20, 0xa7, 0x16, 0xd6, 0xfa, 0x74, 0xe0, 0x2f, 0xe9, 0xfd, 0x62,
                           0x66, 0xa1, 0xf2, 0xba, 0x28, 0xd5, 0x17, 0x7e, 0x0,  0x48, 0x59, 0xf5, 0xcb, 0x9e};
  uint8_t bytesprops1[] = {0xfc, 0xbc, 0x63, 0x23, 0x47, 0x8a, 0xd2, 0xe7, 0x38, 0x9a, 0x5f, 0xe9, 0x52};
  uint8_t bytesprops2[] = {0xe2, 0x80, 0x5c, 0x5c, 0x4a, 0x2c, 0x9e};
  uint8_t bytesprops3[] = {0x9e, 0x12, 0x41, 0x7b, 0x57, 0xcc, 0x25, 0x9a, 0x9a, 0x55, 0xaa,
                           0x6f, 0x5,  0xf7, 0x69, 0xa6, 0x7c, 0x5f, 0x5d, 0xd6, 0xe7};
  uint8_t bytesprops4[] = {0xed, 0x1, 0x29, 0xb9, 0xc1, 0xa6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 26284}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 216}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27230}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10402}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13080}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 123}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 3460}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 15256}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 228}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 247}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 30}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 39}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {7, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 21236}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 66}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 105}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {21, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30139}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {6, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 23656}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 57}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1904}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 29}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 242}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 27}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;

  lwmqtt_property_t willpropslist[] = {};

  lwmqtt_properties_t willprops = {0, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x32, 0x1e};
  lwmqtt_string_t will_topic = {2, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x43, 0x1f, 0xe2, 0x47, 0xbf, 0x1e, 0xe1, 0xee, 0xf1, 0xbb, 0x55, 0xb7, 0x4e, 0x78,
                                  0x1b, 0xa5, 0x87, 0x93, 0xb5, 0xe,  0x7c, 0x1b, 0xec, 0x9b, 0xc6, 0x36, 0xff, 0xc3};
  lwmqtt_string_t will_payload = {28, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 23276;
  uint8_t client_id_bytes[] = {0x83, 0x3d, 0x7b, 0x16, 0x9e, 0xaf, 0x27, 0x5d, 0x1c, 0xe9,
                               0x8b, 0x6d, 0x66, 0x83, 0x23, 0x92, 0xfc, 0x4d, 0x33};
  lwmqtt_string_t client_id = {19, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xa4, 0x16, 0x54, 0xe4, 0x27, 0x57, 0xff, 0xf4, 0xbb, 0xc1,
                              0xed, 0xb4, 0xd,  0xee, 0x64, 0x97, 0x6d, 0xbf, 0xa,  0xb7};
  lwmqtt_string_t username = {20, (char*)&username_bytes};
  opts.username = username;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\237TI=\140\157[R\161\178\154\138\249", _password = Just "\156\221\243", _lastWill
// = Just (LastWill {_willRetain = True, _willQoS = QoS0, _willTopic =
// "q\252\157\161\146\222\a\NAK2\173\167\152X\152\NAK", _willMsg =
// "\172\197<eAU\RS\144\242\233A\ETXd\DC3\235\241\183\196\197\230!\SUB\159p", _willProps = [PropReasonString
// "I\189\192\251\226\182C\130:\236><*\246\137\ESC\188\RS;\ENQ",PropAuthenticationMethod
// "s\224\226\217",PropRequestProblemInformation 110,PropAssignedClientIdentifier
// "\162\178\&6\\\164v\202\137\&70\DEL\150;<;We>\183",PropReceiveMaximum 1866,PropSharedSubscriptionAvailable
// 78,PropRetainAvailable 14,PropMessageExpiryInterval 2378,PropTopicAlias 8222,PropMessageExpiryInterval
// 24111,PropWillDelayInterval 8276,PropServerKeepAlive 18954,PropRequestProblemInformation 76,PropReasonString
// "x\240|",PropMessageExpiryInterval 13256]}), _cleanSession = True, _keepAlive = 7844, _connID =
// "\DC3\182\162\243D\231aQ<\184p\138\206\248T\248E\205\216S", _properties = [PropTopicAlias
// 27783,PropSubscriptionIdentifier 23,PropCorrelationData "(+\145\222*\206\250\207f!\172\&9",PropMessageExpiryInterval
// 14693,PropRetainAvailable 22,PropSharedSubscriptionAvailable 157,PropSharedSubscriptionAvailable
// 196,PropPayloadFormatIndicator 140,PropServerKeepAlive 26053,PropRetainAvailable 25]}
TEST(Connect5QCTest, Encode3) {
  uint8_t pkt[] = {0x10, 0xe6, 0x1,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xe6, 0x1e, 0xa4, 0x26, 0x23, 0x6c, 0x87,
                   0xb,  0x17, 0x9,  0x0,  0xc,  0x28, 0x2b, 0x91, 0xde, 0x2a, 0xce, 0xfa, 0xcf, 0x66, 0x21, 0xac, 0x39,
                   0x2,  0x0,  0x0,  0x39, 0x65, 0x25, 0x16, 0x2a, 0x9d, 0x2a, 0xc4, 0x1,  0x8c, 0x13, 0x65, 0xc5, 0x25,
                   0x19, 0x0,  0x14, 0x13, 0xb6, 0xa2, 0xf3, 0x44, 0xe7, 0x61, 0x51, 0x3c, 0xb8, 0x70, 0x8a, 0xce, 0xf8,
                   0x54, 0xf8, 0x45, 0xcd, 0xd8, 0x53, 0x5f, 0x1f, 0x0,  0x14, 0x49, 0xbd, 0xc0, 0xfb, 0xe2, 0xb6, 0x43,
                   0x82, 0x3a, 0xec, 0x3e, 0x3c, 0x2a, 0xf6, 0x89, 0x1b, 0xbc, 0x1e, 0x3b, 0x5,  0x15, 0x0,  0x4,  0x73,
                   0xe0, 0xe2, 0xd9, 0x17, 0x6e, 0x12, 0x0,  0x13, 0xa2, 0xb2, 0x36, 0x5c, 0xa4, 0x76, 0xca, 0x89, 0x37,
                   0x30, 0x7f, 0x96, 0x3b, 0x3c, 0x3b, 0x57, 0x65, 0x3e, 0xb7, 0x21, 0x7,  0x4a, 0x2a, 0x4e, 0x25, 0xe,
                   0x2,  0x0,  0x0,  0x9,  0x4a, 0x23, 0x20, 0x1e, 0x2,  0x0,  0x0,  0x5e, 0x2f, 0x18, 0x0,  0x0,  0x20,
                   0x54, 0x13, 0x4a, 0xa,  0x17, 0x4c, 0x1f, 0x0,  0x3,  0x78, 0xf0, 0x7c, 0x2,  0x0,  0x0,  0x33, 0xc8,
                   0x0,  0xf,  0x71, 0xfc, 0x9d, 0xa1, 0x92, 0xde, 0x7,  0x15, 0x32, 0xad, 0xa7, 0x98, 0x58, 0x98, 0x15,
                   0x0,  0x18, 0xac, 0xc5, 0x3c, 0x65, 0x41, 0x55, 0x1e, 0x90, 0xf2, 0xe9, 0x41, 0x3,  0x64, 0x13, 0xeb,
                   0xf1, 0xb7, 0xc4, 0xc5, 0xe6, 0x21, 0x1a, 0x9f, 0x70, 0x0,  0xd,  0xed, 0x54, 0x49, 0x3d, 0x8c, 0x9d,
                   0x5b, 0x52, 0xa1, 0xb2, 0x9a, 0x8a, 0xf9, 0x0,  0x3,  0x9c, 0xdd, 0xf3};

  uint8_t buf[243] = {0};

  uint8_t bytesprops0[] = {0x28, 0x2b, 0x91, 0xde, 0x2a, 0xce, 0xfa, 0xcf, 0x66, 0x21, 0xac, 0x39};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 27783}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 23}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14693}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 22}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 157}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 196}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 140}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 26053}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 25}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x49, 0xbd, 0xc0, 0xfb, 0xe2, 0xb6, 0x43, 0x82, 0x3a, 0xec,
                               0x3e, 0x3c, 0x2a, 0xf6, 0x89, 0x1b, 0xbc, 0x1e, 0x3b, 0x5};
  uint8_t byteswillprops1[] = {0x73, 0xe0, 0xe2, 0xd9};
  uint8_t byteswillprops2[] = {0xa2, 0xb2, 0x36, 0x5c, 0xa4, 0x76, 0xca, 0x89, 0x37, 0x30,
                               0x7f, 0x96, 0x3b, 0x3c, 0x3b, 0x57, 0x65, 0x3e, 0xb7};
  uint8_t byteswillprops3[] = {0x78, 0xf0, 0x7c};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&byteswillprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&byteswillprops1}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 110}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&byteswillprops2}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 1866}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 14}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2378}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 8222}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24111}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8276}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 18954}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 76}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&byteswillprops3}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13256}},
  };

  lwmqtt_properties_t willprops = {15, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x71, 0xfc, 0x9d, 0xa1, 0x92, 0xde, 0x7, 0x15,
                                0x32, 0xad, 0xa7, 0x98, 0x58, 0x98, 0x15};
  lwmqtt_string_t will_topic = {15, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xac, 0xc5, 0x3c, 0x65, 0x41, 0x55, 0x1e, 0x90, 0xf2, 0xe9, 0x41, 0x3,
                                  0x64, 0x13, 0xeb, 0xf1, 0xb7, 0xc4, 0xc5, 0xe6, 0x21, 0x1a, 0x9f, 0x70};
  lwmqtt_string_t will_payload = {24, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 7844;
  uint8_t client_id_bytes[] = {0x13, 0xb6, 0xa2, 0xf3, 0x44, 0xe7, 0x61, 0x51, 0x3c, 0xb8,
                               0x70, 0x8a, 0xce, 0xf8, 0x54, 0xf8, 0x45, 0xcd, 0xd8, 0x53};
  lwmqtt_string_t client_id = {20, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xed, 0x54, 0x49, 0x3d, 0x8c, 0x9d, 0x5b, 0x52, 0xa1, 0xb2, 0x9a, 0x8a, 0xf9};
  lwmqtt_string_t username = {13, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x9c, 0xdd, 0xf3};
  lwmqtt_string_t password = {3, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\224i\DLEM\214\247\187\191\DEL\211\139G\208\177\241\223\240\254Q\187\238",
// _password = Just "\214t\171wJ\205+", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS1, _willTopic =
// "\201\&2\STXO\162\178*\207.", _willMsg = "\130sO\246\224\216\186Y^\142PH\235zMe+\247P:~\151\243", _willProps =
// [PropSharedSubscriptionAvailable 234,PropMaximumPacketSize 13128,PropSharedSubscriptionAvailable
// 26,PropTopicAliasMaximum 30233,PropContentType
// "\210\206\"\ENQ_J\STX28\252At\252V|x\233\153\145b9\160\n\192\209\247I\197\DC4_",PropAssignedClientIdentifier
// "\162\RS\214y\233\129\212\162\239",PropMessageExpiryInterval 3560,PropSubscriptionIdentifierAvailable
// 237,PropTopicAliasMaximum 10546,PropContentType
// "\ESCN\DC2\156\134|o\183\183k\219\DC2e\222{\197]",PropMaximumPacketSize 12592,PropSubscriptionIdentifierAvailable
// 202,PropWildcardSubscriptionAvailable 238,PropSubscriptionIdentifier 11,PropMaximumPacketSize
// 27524,PropSubscriptionIdentifierAvailable 195,PropResponseInformation
// "q\SUB\169\EOT\245]\169\CAN\SI\b\b\218U\220\238\247\156\STX\213B\130M\231\190\EM\255",PropReceiveMaximum
// 30498,PropTopicAlias 13431,PropAuthenticationData "\129z\243*~",PropAuthenticationData
// ">W3\237\160\SYN\r_\139\248HFF",PropCorrelationData "zP\EM\229\CAN\NAK",PropMaximumQoS 133,PropMessageExpiryInterval
// 3956]}), _cleanSession = True, _keepAlive = 27556, _connID =
// "\SYN=D\DC23R\135\142|\151\t7\226\201\228\239\224\189\DC4a\198\210\FSA\189", _properties = [PropMessageExpiryInterval
// 23978,PropResponseInformation "\EOTa\156N\222\CAN\224\198\171\RSq6\194)\NAK\223\137"]}
TEST(Connect5QCTest, Encode4) {
  uint8_t pkt[] = {
      0x10, 0xb9, 0x2,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xce, 0x6b, 0xa4, 0x19, 0x2,  0x0,  0x0,  0x5d, 0xaa,
      0x1a, 0x0,  0x11, 0x4,  0x61, 0x9c, 0x4e, 0xde, 0x18, 0xe0, 0xc6, 0xab, 0x1e, 0x71, 0x36, 0xc2, 0x29, 0x15, 0xdf,
      0x89, 0x0,  0x19, 0x16, 0x3d, 0x44, 0x12, 0x33, 0x52, 0x87, 0x8e, 0x7c, 0x97, 0x9,  0x37, 0xe2, 0xc9, 0xe4, 0xef,
      0xe0, 0xbd, 0x14, 0x61, 0xc6, 0xd2, 0x1c, 0x41, 0xbd, 0xb4, 0x1,  0x2a, 0xea, 0x27, 0x0,  0x0,  0x33, 0x48, 0x2a,
      0x1a, 0x22, 0x76, 0x19, 0x3,  0x0,  0x1e, 0xd2, 0xce, 0x22, 0x5,  0x5f, 0x4a, 0x2,  0x32, 0x38, 0xfc, 0x41, 0x74,
      0xfc, 0x56, 0x7c, 0x78, 0xe9, 0x99, 0x91, 0x62, 0x39, 0xa0, 0xa,  0xc0, 0xd1, 0xf7, 0x49, 0xc5, 0x14, 0x5f, 0x12,
      0x0,  0x9,  0xa2, 0x1e, 0xd6, 0x79, 0xe9, 0x81, 0xd4, 0xa2, 0xef, 0x2,  0x0,  0x0,  0xd,  0xe8, 0x29, 0xed, 0x22,
      0x29, 0x32, 0x3,  0x0,  0x11, 0x1b, 0x4e, 0x12, 0x9c, 0x86, 0x7c, 0x6f, 0xb7, 0xb7, 0x6b, 0xdb, 0x12, 0x65, 0xde,
      0x7b, 0xc5, 0x5d, 0x27, 0x0,  0x0,  0x31, 0x30, 0x29, 0xca, 0x28, 0xee, 0xb,  0xb,  0x27, 0x0,  0x0,  0x6b, 0x84,
      0x29, 0xc3, 0x1a, 0x0,  0x1a, 0x71, 0x1a, 0xa9, 0x4,  0xf5, 0x5d, 0xa9, 0x18, 0xf,  0x8,  0x8,  0xda, 0x55, 0xdc,
      0xee, 0xf7, 0x9c, 0x2,  0xd5, 0x42, 0x82, 0x4d, 0xe7, 0xbe, 0x19, 0xff, 0x21, 0x77, 0x22, 0x23, 0x34, 0x77, 0x16,
      0x0,  0x5,  0x81, 0x7a, 0xf3, 0x2a, 0x7e, 0x16, 0x0,  0xd,  0x3e, 0x57, 0x33, 0xed, 0xa0, 0x16, 0xd,  0x5f, 0x8b,
      0xf8, 0x48, 0x46, 0x46, 0x9,  0x0,  0x6,  0x7a, 0x50, 0x19, 0xe5, 0x18, 0x15, 0x24, 0x85, 0x2,  0x0,  0x0,  0xf,
      0x74, 0x0,  0x9,  0xc9, 0x32, 0x2,  0x4f, 0xa2, 0xb2, 0x2a, 0xcf, 0x2e, 0x0,  0x17, 0x82, 0x73, 0x4f, 0xf6, 0xe0,
      0xd8, 0xba, 0x59, 0x5e, 0x8e, 0x50, 0x48, 0xeb, 0x7a, 0x4d, 0x65, 0x2b, 0xf7, 0x50, 0x3a, 0x7e, 0x97, 0xf3, 0x0,
      0x15, 0xe0, 0x69, 0x10, 0x4d, 0xd6, 0xf7, 0xbb, 0xbf, 0x7f, 0xd3, 0x8b, 0x47, 0xd0, 0xb1, 0xf1, 0xdf, 0xf0, 0xfe,
      0x51, 0xbb, 0xee, 0x0,  0x7,  0xd6, 0x74, 0xab, 0x77, 0x4a, 0xcd, 0x2b};

  uint8_t buf[326] = {0};

  uint8_t bytesprops0[] = {0x4,  0x61, 0x9c, 0x4e, 0xde, 0x18, 0xe0, 0xc6, 0xab,
                           0x1e, 0x71, 0x36, 0xc2, 0x29, 0x15, 0xdf, 0x89};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23978}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {17, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xd2, 0xce, 0x22, 0x5,  0x5f, 0x4a, 0x2,  0x32, 0x38, 0xfc,
                               0x41, 0x74, 0xfc, 0x56, 0x7c, 0x78, 0xe9, 0x99, 0x91, 0x62,
                               0x39, 0xa0, 0xa,  0xc0, 0xd1, 0xf7, 0x49, 0xc5, 0x14, 0x5f};
  uint8_t byteswillprops1[] = {0xa2, 0x1e, 0xd6, 0x79, 0xe9, 0x81, 0xd4, 0xa2, 0xef};
  uint8_t byteswillprops2[] = {0x1b, 0x4e, 0x12, 0x9c, 0x86, 0x7c, 0x6f, 0xb7, 0xb7,
                               0x6b, 0xdb, 0x12, 0x65, 0xde, 0x7b, 0xc5, 0x5d};
  uint8_t byteswillprops3[] = {0x71, 0x1a, 0xa9, 0x4,  0xf5, 0x5d, 0xa9, 0x18, 0xf,  0x8,  0x8,  0xda, 0x55,
                               0xdc, 0xee, 0xf7, 0x9c, 0x2,  0xd5, 0x42, 0x82, 0x4d, 0xe7, 0xbe, 0x19, 0xff};
  uint8_t byteswillprops4[] = {0x81, 0x7a, 0xf3, 0x2a, 0x7e};
  uint8_t byteswillprops5[] = {0x3e, 0x57, 0x33, 0xed, 0xa0, 0x16, 0xd, 0x5f, 0x8b, 0xf8, 0x48, 0x46, 0x46};
  uint8_t byteswillprops6[] = {0x7a, 0x50, 0x19, 0xe5, 0x18, 0x15};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 234}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 13128}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 26}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 30233}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&byteswillprops0}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {9, (char*)&byteswillprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3560}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 237}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 10546}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {17, (char*)&byteswillprops2}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 12592}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 202}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 238}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 11}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27524}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 195}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&byteswillprops3}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30498}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 13431}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {5, (char*)&byteswillprops4}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {13, (char*)&byteswillprops5}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&byteswillprops6}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 133}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3956}},
  };

  lwmqtt_properties_t willprops = {24, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xc9, 0x32, 0x2, 0x4f, 0xa2, 0xb2, 0x2a, 0xcf, 0x2e};
  lwmqtt_string_t will_topic = {9, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x82, 0x73, 0x4f, 0xf6, 0xe0, 0xd8, 0xba, 0x59, 0x5e, 0x8e, 0x50, 0x48,
                                  0xeb, 0x7a, 0x4d, 0x65, 0x2b, 0xf7, 0x50, 0x3a, 0x7e, 0x97, 0xf3};
  lwmqtt_string_t will_payload = {23, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS1;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 27556;
  uint8_t client_id_bytes[] = {0x16, 0x3d, 0x44, 0x12, 0x33, 0x52, 0x87, 0x8e, 0x7c, 0x97, 0x9,  0x37, 0xe2,
                               0xc9, 0xe4, 0xef, 0xe0, 0xbd, 0x14, 0x61, 0xc6, 0xd2, 0x1c, 0x41, 0xbd};
  lwmqtt_string_t client_id = {25, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xe0, 0x69, 0x10, 0x4d, 0xd6, 0xf7, 0xbb, 0xbf, 0x7f, 0xd3, 0x8b,
                              0x47, 0xd0, 0xb1, 0xf1, 0xdf, 0xf0, 0xfe, 0x51, 0xbb, 0xee};
  lwmqtt_string_t username = {21, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xd6, 0x74, 0xab, 0x77, 0x4a, 0xcd, 0x2b};
  lwmqtt_string_t password = {7, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "`\158g", _password = Just "\232\SI\164\182", _lastWill = Just (LastWill
// {_willRetain = False, _willQoS = QoS0, _willTopic = "\228\209\134\&8\254\183", _willMsg =
// "u`\185\164|=O\ACK\216nx\132", _willProps = [PropMessageExpiryInterval 15261,PropTopicAliasMaximum
// 29836,PropRequestProblemInformation 20,PropRetainAvailable 102,PropRequestResponseInformation 129,PropRetainAvailable
// 104,PropUserProperty "\234\&8x\EMW" "\230\149\DC2;^\DLE\165\STX\245\151@V\211\149A\178S",PropUserProperty
// "\225p\154\210" "\131J\SI\129g\189\DC3\170\143RS\234\129\245\252X\228\171\215\&0",PropWildcardSubscriptionAvailable
// 78,PropAuthenticationMethod "f\141\254\185\233#",PropServerReference
// "[u\253\220\RS\235\188\183\155\202\CAN\186\229\185hV_\130\172)A\210%\ETX",PropUserProperty
// "f\161)F\206\248o\174\212\rf\169\241\164\223U-\214\186!\169\162\163\198\152"
// "\189Mi\200\EOT&1\203\221\182\SUB\194\222e\199\ACK\130U%\"",PropAssignedClientIdentifier
// "\GS_\206V\SUBy\174Q\STX\187b\161F.\141s\235{\DC3\251",PropMessageExpiryInterval 28877,PropResponseInformation
// "\CANP\ENQN8>\229D*",PropMessageExpiryInterval 19314,PropRequestResponseInformation 24,PropResponseInformation
// "]\147J\178\146&\158<t\240\156d\251\188\CAN0\146\DC1\GS\204>l\177\153\238\161\a\192",PropMessageExpiryInterval
// 5878,PropSessionExpiryInterval 18096,PropReceiveMaximum 27639,PropWildcardSubscriptionAvailable 151]}), _cleanSession
// = True, _keepAlive = 1272, _connID = "v=A\216\191\162\"ul\165(\217\182\151@.q", _properties =
// [PropSubscriptionIdentifier 22,PropPayloadFormatIndicator 172,PropContentType "\247\129",PropReceiveMaximum
// 14439,PropUserProperty "a\142 \153\240G" "\\\202\249\165\251\134/\v",PropSessionExpiryInterval
// 24192,PropWildcardSubscriptionAvailable 11,PropSubscriptionIdentifier 29,PropReceiveMaximum
// 8508,PropWildcardSubscriptionAvailable 28,PropMessageExpiryInterval 22152,PropReasonString
// "w\n0.",PropMessageExpiryInterval 18385,PropContentType "N\146\217\145fE\231\231\248\201\149\"u\212\139"]}
TEST(Connect5QCTest, Encode5) {
  uint8_t pkt[] = {
      0x10, 0x8e, 0x3,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xc6, 0x4,  0xf8, 0x50, 0xb,  0x16, 0x1,  0xac, 0x3,
      0x0,  0x2,  0xf7, 0x81, 0x21, 0x38, 0x67, 0x26, 0x0,  0x6,  0x61, 0x8e, 0x20, 0x99, 0xf0, 0x47, 0x0,  0x8,  0x5c,
      0xca, 0xf9, 0xa5, 0xfb, 0x86, 0x2f, 0xb,  0x11, 0x0,  0x0,  0x5e, 0x80, 0x28, 0xb,  0xb,  0x1d, 0x21, 0x21, 0x3c,
      0x28, 0x1c, 0x2,  0x0,  0x0,  0x56, 0x88, 0x1f, 0x0,  0x4,  0x77, 0xa,  0x30, 0x2e, 0x2,  0x0,  0x0,  0x47, 0xd1,
      0x3,  0x0,  0xf,  0x4e, 0x92, 0xd9, 0x91, 0x66, 0x45, 0xe7, 0xe7, 0xf8, 0xc9, 0x95, 0x22, 0x75, 0xd4, 0x8b, 0x0,
      0x11, 0x76, 0x3d, 0x41, 0xd8, 0xbf, 0xa2, 0x22, 0x75, 0x6c, 0xa5, 0x28, 0xd9, 0xb6, 0x97, 0x40, 0x2e, 0x71, 0xfd,
      0x1,  0x2,  0x0,  0x0,  0x3b, 0x9d, 0x22, 0x74, 0x8c, 0x17, 0x14, 0x25, 0x66, 0x19, 0x81, 0x25, 0x68, 0x26, 0x0,
      0x5,  0xea, 0x38, 0x78, 0x19, 0x57, 0x0,  0x11, 0xe6, 0x95, 0x12, 0x3b, 0x5e, 0x10, 0xa5, 0x2,  0xf5, 0x97, 0x40,
      0x56, 0xd3, 0x95, 0x41, 0xb2, 0x53, 0x26, 0x0,  0x4,  0xe1, 0x70, 0x9a, 0xd2, 0x0,  0x14, 0x83, 0x4a, 0xf,  0x81,
      0x67, 0xbd, 0x13, 0xaa, 0x8f, 0x52, 0x53, 0xea, 0x81, 0xf5, 0xfc, 0x58, 0xe4, 0xab, 0xd7, 0x30, 0x28, 0x4e, 0x15,
      0x0,  0x6,  0x66, 0x8d, 0xfe, 0xb9, 0xe9, 0x23, 0x1c, 0x0,  0x18, 0x5b, 0x75, 0xfd, 0xdc, 0x1e, 0xeb, 0xbc, 0xb7,
      0x9b, 0xca, 0x18, 0xba, 0xe5, 0xb9, 0x68, 0x56, 0x5f, 0x82, 0xac, 0x29, 0x41, 0xd2, 0x25, 0x3,  0x26, 0x0,  0x19,
      0x66, 0xa1, 0x29, 0x46, 0xce, 0xf8, 0x6f, 0xae, 0xd4, 0xd,  0x66, 0xa9, 0xf1, 0xa4, 0xdf, 0x55, 0x2d, 0xd6, 0xba,
      0x21, 0xa9, 0xa2, 0xa3, 0xc6, 0x98, 0x0,  0x14, 0xbd, 0x4d, 0x69, 0xc8, 0x4,  0x26, 0x31, 0xcb, 0xdd, 0xb6, 0x1a,
      0xc2, 0xde, 0x65, 0xc7, 0x6,  0x82, 0x55, 0x25, 0x22, 0x12, 0x0,  0x14, 0x1d, 0x5f, 0xce, 0x56, 0x1a, 0x79, 0xae,
      0x51, 0x2,  0xbb, 0x62, 0xa1, 0x46, 0x2e, 0x8d, 0x73, 0xeb, 0x7b, 0x13, 0xfb, 0x2,  0x0,  0x0,  0x70, 0xcd, 0x1a,
      0x0,  0x9,  0x18, 0x50, 0x5,  0x4e, 0x38, 0x3e, 0xe5, 0x44, 0x2a, 0x2,  0x0,  0x0,  0x4b, 0x72, 0x19, 0x18, 0x1a,
      0x0,  0x1c, 0x5d, 0x93, 0x4a, 0xb2, 0x92, 0x26, 0x9e, 0x3c, 0x74, 0xf0, 0x9c, 0x64, 0xfb, 0xbc, 0x18, 0x30, 0x92,
      0x11, 0x1d, 0xcc, 0x3e, 0x6c, 0xb1, 0x99, 0xee, 0xa1, 0x7,  0xc0, 0x2,  0x0,  0x0,  0x16, 0xf6, 0x11, 0x0,  0x0,
      0x46, 0xb0, 0x21, 0x6b, 0xf7, 0x28, 0x97, 0x0,  0x6,  0xe4, 0xd1, 0x86, 0x38, 0xfe, 0xb7, 0x0,  0xc,  0x75, 0x60,
      0xb9, 0xa4, 0x7c, 0x3d, 0x4f, 0x6,  0xd8, 0x6e, 0x78, 0x84, 0x0,  0x3,  0x60, 0x9e, 0x67, 0x0,  0x4,  0xe8, 0xf,
      0xa4, 0xb6};

  uint8_t buf[411] = {0};

  uint8_t bytesprops0[] = {0xf7, 0x81};
  uint8_t bytesprops2[] = {0x5c, 0xca, 0xf9, 0xa5, 0xfb, 0x86, 0x2f, 0xb};
  uint8_t bytesprops1[] = {0x61, 0x8e, 0x20, 0x99, 0xf0, 0x47};
  uint8_t bytesprops3[] = {0x77, 0xa, 0x30, 0x2e};
  uint8_t bytesprops4[] = {0x4e, 0x92, 0xd9, 0x91, 0x66, 0x45, 0xe7, 0xe7, 0xf8, 0xc9, 0x95, 0x22, 0x75, 0xd4, 0x8b};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 22}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 172}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 14439}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {6, (char*)&bytesprops1}, .v = {8, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 24192}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 11}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 29}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 8508}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 28}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22152}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {4, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18385}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops1[] = {0xe6, 0x95, 0x12, 0x3b, 0x5e, 0x10, 0xa5, 0x2, 0xf5,
                               0x97, 0x40, 0x56, 0xd3, 0x95, 0x41, 0xb2, 0x53};
  uint8_t byteswillprops0[] = {0xea, 0x38, 0x78, 0x19, 0x57};
  uint8_t byteswillprops3[] = {0x83, 0x4a, 0xf,  0x81, 0x67, 0xbd, 0x13, 0xaa, 0x8f, 0x52,
                               0x53, 0xea, 0x81, 0xf5, 0xfc, 0x58, 0xe4, 0xab, 0xd7, 0x30};
  uint8_t byteswillprops2[] = {0xe1, 0x70, 0x9a, 0xd2};
  uint8_t byteswillprops4[] = {0x66, 0x8d, 0xfe, 0xb9, 0xe9, 0x23};
  uint8_t byteswillprops5[] = {0x5b, 0x75, 0xfd, 0xdc, 0x1e, 0xeb, 0xbc, 0xb7, 0x9b, 0xca, 0x18, 0xba,
                               0xe5, 0xb9, 0x68, 0x56, 0x5f, 0x82, 0xac, 0x29, 0x41, 0xd2, 0x25, 0x3};
  uint8_t byteswillprops7[] = {0xbd, 0x4d, 0x69, 0xc8, 0x4,  0x26, 0x31, 0xcb, 0xdd, 0xb6,
                               0x1a, 0xc2, 0xde, 0x65, 0xc7, 0x6,  0x82, 0x55, 0x25, 0x22};
  uint8_t byteswillprops6[] = {0x66, 0xa1, 0x29, 0x46, 0xce, 0xf8, 0x6f, 0xae, 0xd4, 0xd,  0x66, 0xa9, 0xf1,
                               0xa4, 0xdf, 0x55, 0x2d, 0xd6, 0xba, 0x21, 0xa9, 0xa2, 0xa3, 0xc6, 0x98};
  uint8_t byteswillprops8[] = {0x1d, 0x5f, 0xce, 0x56, 0x1a, 0x79, 0xae, 0x51, 0x2,  0xbb,
                               0x62, 0xa1, 0x46, 0x2e, 0x8d, 0x73, 0xeb, 0x7b, 0x13, 0xfb};
  uint8_t byteswillprops9[] = {0x18, 0x50, 0x5, 0x4e, 0x38, 0x3e, 0xe5, 0x44, 0x2a};
  uint8_t byteswillprops10[] = {0x5d, 0x93, 0x4a, 0xb2, 0x92, 0x26, 0x9e, 0x3c, 0x74, 0xf0, 0x9c, 0x64, 0xfb, 0xbc,
                                0x18, 0x30, 0x92, 0x11, 0x1d, 0xcc, 0x3e, 0x6c, 0xb1, 0x99, 0xee, 0xa1, 0x7,  0xc0};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15261}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29836}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 20}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 102}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 129}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 104}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {5, (char*)&byteswillprops0}, .v = {17, (char*)&byteswillprops1}}}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {4, (char*)&byteswillprops2}, .v = {20, (char*)&byteswillprops3}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {6, (char*)&byteswillprops4}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&byteswillprops5}}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {25, (char*)&byteswillprops6}, .v = {20, (char*)&byteswillprops7}}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&byteswillprops8}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28877}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {9, (char*)&byteswillprops9}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19314}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 24}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&byteswillprops10}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5878}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18096}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 27639}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 151}},
  };

  lwmqtt_properties_t willprops = {22, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xe4, 0xd1, 0x86, 0x38, 0xfe, 0xb7};
  lwmqtt_string_t will_topic = {6, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x75, 0x60, 0xb9, 0xa4, 0x7c, 0x3d, 0x4f, 0x6, 0xd8, 0x6e, 0x78, 0x84};
  lwmqtt_string_t will_payload = {12, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 1272;
  uint8_t client_id_bytes[] = {0x76, 0x3d, 0x41, 0xd8, 0xbf, 0xa2, 0x22, 0x75, 0x6c,
                               0xa5, 0x28, 0xd9, 0xb6, 0x97, 0x40, 0x2e, 0x71};
  lwmqtt_string_t client_id = {17, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x60, 0x9e, 0x67};
  lwmqtt_string_t username = {3, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xe8, 0xf, 0xa4, 0xb6};
  lwmqtt_string_t password = {4, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "|\ENQ\ETXN\196/!2\EOT\150wV\ETB\205R\NUL", _password = Just
// "\171\176x\189\&3I\250!\207\139J\139\160x\SYN", _lastWill = Just (LastWill {_willRetain = True, _willQoS = QoS0,
// _willTopic = "9~,\236\224~@\247G|] \153\191\142\DC3\DEL\ETBcx\a\192\211\EOT\138IF", _willMsg =
// "\143q\200<\208LHV\222HO1\181U\229\173\158\255", _willProps = [PropMessageExpiryInterval 22676,PropUserProperty
// "t\GS\172\&3\213\181\221\140" "\242\191K\211F\247{\232\&31q`dJ",PropWillDelayInterval 18062,PropMaximumPacketSize
// 5758,PropContentType "\181\&9d\177\196@$a\155\132E\247\177\DEL\209\155\SYN\SOHZ\SI\167\156\r",PropMaximumPacketSize
// 32395,PropRequestResponseInformation 230,PropResponseTopic
// "\231%-\195\204\160\230\130\238S\176\187\128\214\247*fN.)k\146C\DC43\180!O;",PropMaximumPacketSize
// 8412,PropMessageExpiryInterval 20741,PropSubscriptionIdentifier 34,PropMessageExpiryInterval
// 3727,PropAuthenticationData
// "\208\182P\212\"bl\174\233\177+\249\EOT\230\173\a\194w\156\251\165\244\192\224\DC2\242\180\CAN",PropRequestProblemInformation
// 140,PropReceiveMaximum 31448,PropContentType "\SYN\168Tq\255\&4\226\237",PropServerKeepAlive 12597,PropReceiveMaximum
// 26906,PropWillDelayInterval 20356,PropCorrelationData "+p\240\GS\180\STX\235b$",PropResponseInformation
// "GT\ACKV",PropAssignedClientIdentifier
// "\160\&3!\SI\208GJ\233\153\130\163\169\f\CAN\221",PropWildcardSubscriptionAvailable 219,PropMaximumPacketSize
// 29532,PropReasonString
// "\169\RST\156~+\254\NAKF\208\195J\US\ESC$\177\190]\247\v\162\153D.\ENQ\175\136\214",PropTopicAliasMaximum
// 17359,PropReasonString
// "\DC1\SUB2\179\235\196U\SIi\196\&3\n_\234\DC3\EM\US\t(\ETB\226\&3\226\215\132\&6\222\NUL",PropMessageExpiryInterval
// 15547,PropMaximumPacketSize 435,PropServerReference "\SOHA"]}), _cleanSession = True, _keepAlive = 22109, _connID =
// "\DC4\170\162a\211\176\131\ETX\208", _properties = [PropServerReference "",PropRequestProblemInformation
// 9,PropCorrelationData "r\163\FS\131^\203\171\228\251",PropTopicAliasMaximum 30892,PropRequestResponseInformation
// 40,PropResponseTopic "\"gmj\239\211\&9\223\171\175\RS I0\136\154\233&\155\163",PropAuthenticationData
// "Y\FS\ENQZ\249s\147&H\188|q'3\236\193?!\178\184~Y\160\148\227",PropSubscriptionIdentifier 3,PropTopicAliasMaximum
// 13591,PropRequestProblemInformation 67,PropServerReference "\151\FSZ\189\161\249ha\DC1l\ETX\208\&6e\203r(\213
// \240\&9\172\130@\181\131\fI\152",PropPayloadFormatIndicator 88,PropCorrelationData "\195%",PropWillDelayInterval
// 25823,PropRequestProblemInformation 234,PropRetainAvailable 166,PropPayloadFormatIndicator 99,PropUserProperty
// "\164\SI\183\198'\153l\223"
// "\US\204\185\164\243\228\209\ACKC\156\247{\143\241\145\135\180\131\138\178\188\DEL>\160\\\SYN1\139",PropSubscriptionIdentifierAvailable
// 7,PropSubscriptionIdentifier 9,PropServerReference "s\172\218\206K\156i\GS\154$\133O\174\160
// \199i\205\247_$%Ux\170L\205",PropMaximumPacketSize 18119,PropCorrelationData
// "\227\157\235\193\139&\"L\231\133",PropWillDelayInterval 24104,PropResponseInformation
// "\227\254\251\227\145\RS\164OH\r\200\204\158",PropContentType
// "\134\224\147\203\ETX\189\185\189\179\189jT\148|\165~#",PropReasonString
// "a\229\206\164\193K\NUL\ETB8\148\DLE\191\245",PropReceiveMaximum 30786,PropSubscriptionIdentifierAvailable 109]}
TEST(Connect5QCTest, Encode6) {
  uint8_t pkt[] = {
      0x10, 0xbc, 0x5,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xe6, 0x56, 0x5d, 0x9d, 0x2,  0x1c, 0x0,  0x0,  0x17,
      0x9,  0x9,  0x0,  0x9,  0x72, 0xa3, 0x1c, 0x83, 0x5e, 0xcb, 0xab, 0xe4, 0xfb, 0x22, 0x78, 0xac, 0x19, 0x28, 0x8,
      0x0,  0x14, 0x22, 0x67, 0x6d, 0x6a, 0xef, 0xd3, 0x39, 0xdf, 0xab, 0xaf, 0x1e, 0x20, 0x49, 0x30, 0x88, 0x9a, 0xe9,
      0x26, 0x9b, 0xa3, 0x16, 0x0,  0x19, 0x59, 0x1c, 0x5,  0x5a, 0xf9, 0x73, 0x93, 0x26, 0x48, 0xbc, 0x7c, 0x71, 0x27,
      0x33, 0xec, 0xc1, 0x3f, 0x21, 0xb2, 0xb8, 0x7e, 0x59, 0xa0, 0x94, 0xe3, 0xb,  0x3,  0x22, 0x35, 0x17, 0x17, 0x43,
      0x1c, 0x0,  0x1d, 0x97, 0x1c, 0x5a, 0xbd, 0xa1, 0xf9, 0x68, 0x61, 0x11, 0x6c, 0x3,  0xd0, 0x36, 0x65, 0xcb, 0x72,
      0x28, 0xd5, 0x20, 0xf0, 0x39, 0xac, 0x82, 0x40, 0xb5, 0x83, 0xc,  0x49, 0x98, 0x1,  0x58, 0x9,  0x0,  0x2,  0xc3,
      0x25, 0x18, 0x0,  0x0,  0x64, 0xdf, 0x17, 0xea, 0x25, 0xa6, 0x1,  0x63, 0x26, 0x0,  0x8,  0xa4, 0xf,  0xb7, 0xc6,
      0x27, 0x99, 0x6c, 0xdf, 0x0,  0x1c, 0x1f, 0xcc, 0xb9, 0xa4, 0xf3, 0xe4, 0xd1, 0x6,  0x43, 0x9c, 0xf7, 0x7b, 0x8f,
      0xf1, 0x91, 0x87, 0xb4, 0x83, 0x8a, 0xb2, 0xbc, 0x7f, 0x3e, 0xa0, 0x5c, 0x16, 0x31, 0x8b, 0x29, 0x7,  0xb,  0x9,
      0x1c, 0x0,  0x1b, 0x73, 0xac, 0xda, 0xce, 0x4b, 0x9c, 0x69, 0x1d, 0x9a, 0x24, 0x85, 0x4f, 0xae, 0xa0, 0x20, 0xc7,
      0x69, 0xcd, 0xf7, 0x5f, 0x24, 0x25, 0x55, 0x78, 0xaa, 0x4c, 0xcd, 0x27, 0x0,  0x0,  0x46, 0xc7, 0x9,  0x0,  0xa,
      0xe3, 0x9d, 0xeb, 0xc1, 0x8b, 0x26, 0x22, 0x4c, 0xe7, 0x85, 0x18, 0x0,  0x0,  0x5e, 0x28, 0x1a, 0x0,  0xd,  0xe3,
      0xfe, 0xfb, 0xe3, 0x91, 0x1e, 0xa4, 0x4f, 0x48, 0xd,  0xc8, 0xcc, 0x9e, 0x3,  0x0,  0x11, 0x86, 0xe0, 0x93, 0xcb,
      0x3,  0xbd, 0xb9, 0xbd, 0xb3, 0xbd, 0x6a, 0x54, 0x94, 0x7c, 0xa5, 0x7e, 0x23, 0x1f, 0x0,  0xd,  0x61, 0xe5, 0xce,
      0xa4, 0xc1, 0x4b, 0x0,  0x17, 0x38, 0x94, 0x10, 0xbf, 0xf5, 0x21, 0x78, 0x42, 0x29, 0x6d, 0x0,  0x9,  0x14, 0xaa,
      0xa2, 0x61, 0xd3, 0xb0, 0x83, 0x3,  0xd0, 0xb2, 0x2,  0x2,  0x0,  0x0,  0x58, 0x94, 0x26, 0x0,  0x8,  0x74, 0x1d,
      0xac, 0x33, 0xd5, 0xb5, 0xdd, 0x8c, 0x0,  0xe,  0xf2, 0xbf, 0x4b, 0xd3, 0x46, 0xf7, 0x7b, 0xe8, 0x33, 0x31, 0x71,
      0x60, 0x64, 0x4a, 0x18, 0x0,  0x0,  0x46, 0x8e, 0x27, 0x0,  0x0,  0x16, 0x7e, 0x3,  0x0,  0x17, 0xb5, 0x39, 0x64,
      0xb1, 0xc4, 0x40, 0x24, 0x61, 0x9b, 0x84, 0x45, 0xf7, 0xb1, 0x7f, 0xd1, 0x9b, 0x16, 0x1,  0x5a, 0xf,  0xa7, 0x9c,
      0xd,  0x27, 0x0,  0x0,  0x7e, 0x8b, 0x19, 0xe6, 0x8,  0x0,  0x1d, 0xe7, 0x25, 0x2d, 0xc3, 0xcc, 0xa0, 0xe6, 0x82,
      0xee, 0x53, 0xb0, 0xbb, 0x80, 0xd6, 0xf7, 0x2a, 0x66, 0x4e, 0x2e, 0x29, 0x6b, 0x92, 0x43, 0x14, 0x33, 0xb4, 0x21,
      0x4f, 0x3b, 0x27, 0x0,  0x0,  0x20, 0xdc, 0x2,  0x0,  0x0,  0x51, 0x5,  0xb,  0x22, 0x2,  0x0,  0x0,  0xe,  0x8f,
      0x16, 0x0,  0x1c, 0xd0, 0xb6, 0x50, 0xd4, 0x22, 0x62, 0x6c, 0xae, 0xe9, 0xb1, 0x2b, 0xf9, 0x4,  0xe6, 0xad, 0x7,
      0xc2, 0x77, 0x9c, 0xfb, 0xa5, 0xf4, 0xc0, 0xe0, 0x12, 0xf2, 0xb4, 0x18, 0x17, 0x8c, 0x21, 0x7a, 0xd8, 0x3,  0x0,
      0x8,  0x16, 0xa8, 0x54, 0x71, 0xff, 0x34, 0xe2, 0xed, 0x13, 0x31, 0x35, 0x21, 0x69, 0x1a, 0x18, 0x0,  0x0,  0x4f,
      0x84, 0x9,  0x0,  0x9,  0x2b, 0x70, 0xf0, 0x1d, 0xb4, 0x2,  0xeb, 0x62, 0x24, 0x1a, 0x0,  0x4,  0x47, 0x54, 0x6,
      0x56, 0x12, 0x0,  0xf,  0xa0, 0x33, 0x21, 0xf,  0xd0, 0x47, 0x4a, 0xe9, 0x99, 0x82, 0xa3, 0xa9, 0xc,  0x18, 0xdd,
      0x28, 0xdb, 0x27, 0x0,  0x0,  0x73, 0x5c, 0x1f, 0x0,  0x1c, 0xa9, 0x1e, 0x54, 0x9c, 0x7e, 0x2b, 0xfe, 0x15, 0x46,
      0xd0, 0xc3, 0x4a, 0x1f, 0x1b, 0x24, 0xb1, 0xbe, 0x5d, 0xf7, 0xb,  0xa2, 0x99, 0x44, 0x2e, 0x5,  0xaf, 0x88, 0xd6,
      0x22, 0x43, 0xcf, 0x1f, 0x0,  0x1c, 0x11, 0x1a, 0x32, 0xb3, 0xeb, 0xc4, 0x55, 0xf,  0x69, 0xc4, 0x33, 0xa,  0x5f,
      0xea, 0x13, 0x19, 0x1f, 0x9,  0x28, 0x17, 0xe2, 0x33, 0xe2, 0xd7, 0x84, 0x36, 0xde, 0x0,  0x2,  0x0,  0x0,  0x3c,
      0xbb, 0x27, 0x0,  0x0,  0x1,  0xb3, 0x1c, 0x0,  0x2,  0x1,  0x41, 0x0,  0x1b, 0x39, 0x7e, 0x2c, 0xec, 0xe0, 0x7e,
      0x40, 0xf7, 0x47, 0x7c, 0x5d, 0x20, 0x99, 0xbf, 0x8e, 0x13, 0x7f, 0x17, 0x63, 0x78, 0x7,  0xc0, 0xd3, 0x4,  0x8a,
      0x49, 0x46, 0x0,  0x12, 0x8f, 0x71, 0xc8, 0x3c, 0xd0, 0x4c, 0x48, 0x56, 0xde, 0x48, 0x4f, 0x31, 0xb5, 0x55, 0xe5,
      0xad, 0x9e, 0xff, 0x0,  0x10, 0x7c, 0x5,  0x3,  0x4e, 0xc4, 0x2f, 0x21, 0x32, 0x4,  0x96, 0x77, 0x56, 0x17, 0xcd,
      0x52, 0x0,  0x0,  0xf,  0xab, 0xb0, 0x78, 0xbd, 0x33, 0x49, 0xfa, 0x21, 0xcf, 0x8b, 0x4a, 0x8b, 0xa0, 0x78, 0x16};

  uint8_t buf[713] = {0};

  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0x72, 0xa3, 0x1c, 0x83, 0x5e, 0xcb, 0xab, 0xe4, 0xfb};
  uint8_t bytesprops2[] = {0x22, 0x67, 0x6d, 0x6a, 0xef, 0xd3, 0x39, 0xdf, 0xab, 0xaf,
                           0x1e, 0x20, 0x49, 0x30, 0x88, 0x9a, 0xe9, 0x26, 0x9b, 0xa3};
  uint8_t bytesprops3[] = {0x59, 0x1c, 0x5,  0x5a, 0xf9, 0x73, 0x93, 0x26, 0x48, 0xbc, 0x7c, 0x71, 0x27,
                           0x33, 0xec, 0xc1, 0x3f, 0x21, 0xb2, 0xb8, 0x7e, 0x59, 0xa0, 0x94, 0xe3};
  uint8_t bytesprops4[] = {0x97, 0x1c, 0x5a, 0xbd, 0xa1, 0xf9, 0x68, 0x61, 0x11, 0x6c, 0x3,  0xd0, 0x36, 0x65, 0xcb,
                           0x72, 0x28, 0xd5, 0x20, 0xf0, 0x39, 0xac, 0x82, 0x40, 0xb5, 0x83, 0xc,  0x49, 0x98};
  uint8_t bytesprops5[] = {0xc3, 0x25};
  uint8_t bytesprops7[] = {0x1f, 0xcc, 0xb9, 0xa4, 0xf3, 0xe4, 0xd1, 0x6,  0x43, 0x9c, 0xf7, 0x7b, 0x8f, 0xf1,
                           0x91, 0x87, 0xb4, 0x83, 0x8a, 0xb2, 0xbc, 0x7f, 0x3e, 0xa0, 0x5c, 0x16, 0x31, 0x8b};
  uint8_t bytesprops6[] = {0xa4, 0xf, 0xb7, 0xc6, 0x27, 0x99, 0x6c, 0xdf};
  uint8_t bytesprops8[] = {0x73, 0xac, 0xda, 0xce, 0x4b, 0x9c, 0x69, 0x1d, 0x9a, 0x24, 0x85, 0x4f, 0xae, 0xa0,
                           0x20, 0xc7, 0x69, 0xcd, 0xf7, 0x5f, 0x24, 0x25, 0x55, 0x78, 0xaa, 0x4c, 0xcd};
  uint8_t bytesprops9[] = {0xe3, 0x9d, 0xeb, 0xc1, 0x8b, 0x26, 0x22, 0x4c, 0xe7, 0x85};
  uint8_t bytesprops10[] = {0xe3, 0xfe, 0xfb, 0xe3, 0x91, 0x1e, 0xa4, 0x4f, 0x48, 0xd, 0xc8, 0xcc, 0x9e};
  uint8_t bytesprops11[] = {0x86, 0xe0, 0x93, 0xcb, 0x3,  0xbd, 0xb9, 0xbd, 0xb3,
                            0xbd, 0x6a, 0x54, 0x94, 0x7c, 0xa5, 0x7e, 0x23};
  uint8_t bytesprops12[] = {0x61, 0xe5, 0xce, 0xa4, 0xc1, 0x4b, 0x0, 0x17, 0x38, 0x94, 0x10, 0xbf, 0xf5};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 9}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 30892}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 40}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 3}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13591}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 67}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {29, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 88}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {2, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 25823}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 234}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 166}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 99}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {8, (char*)&bytesprops6}, .v = {28, (char*)&bytesprops7}}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 7}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 9}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18119}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 24104}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {17, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {13, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30786}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 109}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops1[] = {0xf2, 0xbf, 0x4b, 0xd3, 0x46, 0xf7, 0x7b, 0xe8, 0x33, 0x31, 0x71, 0x60, 0x64, 0x4a};
  uint8_t byteswillprops0[] = {0x74, 0x1d, 0xac, 0x33, 0xd5, 0xb5, 0xdd, 0x8c};
  uint8_t byteswillprops2[] = {0xb5, 0x39, 0x64, 0xb1, 0xc4, 0x40, 0x24, 0x61, 0x9b, 0x84, 0x45, 0xf7,
                               0xb1, 0x7f, 0xd1, 0x9b, 0x16, 0x1,  0x5a, 0xf,  0xa7, 0x9c, 0xd};
  uint8_t byteswillprops3[] = {0xe7, 0x25, 0x2d, 0xc3, 0xcc, 0xa0, 0xe6, 0x82, 0xee, 0x53, 0xb0, 0xbb, 0x80, 0xd6, 0xf7,
                               0x2a, 0x66, 0x4e, 0x2e, 0x29, 0x6b, 0x92, 0x43, 0x14, 0x33, 0xb4, 0x21, 0x4f, 0x3b};
  uint8_t byteswillprops4[] = {0xd0, 0xb6, 0x50, 0xd4, 0x22, 0x62, 0x6c, 0xae, 0xe9, 0xb1, 0x2b, 0xf9, 0x4,  0xe6,
                               0xad, 0x7,  0xc2, 0x77, 0x9c, 0xfb, 0xa5, 0xf4, 0xc0, 0xe0, 0x12, 0xf2, 0xb4, 0x18};
  uint8_t byteswillprops5[] = {0x16, 0xa8, 0x54, 0x71, 0xff, 0x34, 0xe2, 0xed};
  uint8_t byteswillprops6[] = {0x2b, 0x70, 0xf0, 0x1d, 0xb4, 0x2, 0xeb, 0x62, 0x24};
  uint8_t byteswillprops7[] = {0x47, 0x54, 0x6, 0x56};
  uint8_t byteswillprops8[] = {0xa0, 0x33, 0x21, 0xf, 0xd0, 0x47, 0x4a, 0xe9, 0x99, 0x82, 0xa3, 0xa9, 0xc, 0x18, 0xdd};
  uint8_t byteswillprops9[] = {0xa9, 0x1e, 0x54, 0x9c, 0x7e, 0x2b, 0xfe, 0x15, 0x46, 0xd0, 0xc3, 0x4a, 0x1f, 0x1b,
                               0x24, 0xb1, 0xbe, 0x5d, 0xf7, 0xb,  0xa2, 0x99, 0x44, 0x2e, 0x5,  0xaf, 0x88, 0xd6};
  uint8_t byteswillprops10[] = {0x11, 0x1a, 0x32, 0xb3, 0xeb, 0xc4, 0x55, 0xf,  0x69, 0xc4, 0x33, 0xa,  0x5f, 0xea,
                                0x13, 0x19, 0x1f, 0x9,  0x28, 0x17, 0xe2, 0x33, 0xe2, 0xd7, 0x84, 0x36, 0xde, 0x0};
  uint8_t byteswillprops11[] = {0x1, 0x41};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 22676}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {8, (char*)&byteswillprops0}, .v = {14, (char*)&byteswillprops1}}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18062}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 5758}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&byteswillprops2}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32395}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 230}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&byteswillprops3}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 8412}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 20741}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 34}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3727}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&byteswillprops4}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 140}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 31448}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&byteswillprops5}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12597}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 26906}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 20356}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&byteswillprops6}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {4, (char*)&byteswillprops7}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {15, (char*)&byteswillprops8}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 219}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 29532}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {28, (char*)&byteswillprops9}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17359}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {28, (char*)&byteswillprops10}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15547}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 435}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {2, (char*)&byteswillprops11}}},
  };

  lwmqtt_properties_t willprops = {30, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0x39, 0x7e, 0x2c, 0xec, 0xe0, 0x7e, 0x40, 0xf7, 0x47, 0x7c, 0x5d, 0x20, 0x99, 0xbf,
                                0x8e, 0x13, 0x7f, 0x17, 0x63, 0x78, 0x7,  0xc0, 0xd3, 0x4,  0x8a, 0x49, 0x46};
  lwmqtt_string_t will_topic = {27, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x8f, 0x71, 0xc8, 0x3c, 0xd0, 0x4c, 0x48, 0x56, 0xde,
                                  0x48, 0x4f, 0x31, 0xb5, 0x55, 0xe5, 0xad, 0x9e, 0xff};
  lwmqtt_string_t will_payload = {18, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 22109;
  uint8_t client_id_bytes[] = {0x14, 0xaa, 0xa2, 0x61, 0xd3, 0xb0, 0x83, 0x3, 0xd0};
  lwmqtt_string_t client_id = {9, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x7c, 0x5,  0x3,  0x4e, 0xc4, 0x2f, 0x21, 0x32,
                              0x4,  0x96, 0x77, 0x56, 0x17, 0xcd, 0x52, 0x0};
  lwmqtt_string_t username = {16, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xab, 0xb0, 0x78, 0xbd, 0x33, 0x49, 0xfa, 0x21, 0xcf, 0x8b, 0x4a, 0x8b, 0xa0, 0x78, 0x16};
  lwmqtt_string_t password = {15, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "$\EM\165\160\SUBJ\a\172X\237g2\r\233#\197H\209G\165\171\255\DEL", _password = Just
// "\EM\190|\164\130", _lastWill = Nothing, _cleanSession = False, _keepAlive = 10212, _connID = "\"{\179:\181",
// _properties = [PropRequestResponseInformation 114,PropCorrelationData "L\166\133\n]g/`\244"]}
TEST(Connect5QCTest, Encode7) {
  uint8_t pkt[] = {0x10, 0x40, 0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xc0, 0x27, 0xe4, 0xe,  0x19, 0x72, 0x9,  0x0,
                   0x9,  0x4c, 0xa6, 0x85, 0xa,  0x5d, 0x67, 0x2f, 0x60, 0xf4, 0x0,  0x5,  0x22, 0x7b, 0xb3, 0x3a, 0xb5,
                   0x0,  0x17, 0x24, 0x19, 0xa5, 0xa0, 0x1a, 0x4a, 0x7,  0xac, 0x58, 0xed, 0x67, 0x32, 0xd,  0xe9, 0x23,
                   0xc5, 0x48, 0xd1, 0x47, 0xa5, 0xab, 0xff, 0x7f, 0x0,  0x5,  0x19, 0xbe, 0x7c, 0xa4, 0x82};

  uint8_t buf[76] = {0};

  uint8_t bytesprops0[] = {0x4c, 0xa6, 0x85, 0xa, 0x5d, 0x67, 0x2f, 0x60, 0xf4};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 114}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&bytesprops0}}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 10212;
  uint8_t client_id_bytes[] = {0x22, 0x7b, 0xb3, 0x3a, 0xb5};
  lwmqtt_string_t client_id = {5, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x24, 0x19, 0xa5, 0xa0, 0x1a, 0x4a, 0x7,  0xac, 0x58, 0xed, 0x67, 0x32,
                              0xd,  0xe9, 0x23, 0xc5, 0x48, 0xd1, 0x47, 0xa5, 0xab, 0xff, 0x7f};
  lwmqtt_string_t username = {23, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x19, 0xbe, 0x7c, 0xa4, 0x82};
  lwmqtt_string_t password = {5, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, NULL);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\152\195~\228&V\199\194\ESC\206\154", _password = Just
// "ve\174\255\183:\192\165\&3\171\241\187+\DEL\209\"\248\224\186\154", _lastWill = Just (LastWill {_willRetain = True,
// _willQoS = QoS1, _willTopic = "\162\193N\246G", _willMsg = "\193\226\183\237\166\202\233", _willProps =
// [PropServerReference "%P\DC3\242\SI \147\v\164\140:=\246\178$",PropReceiveMaximum
// 23397,PropWildcardSubscriptionAvailable 190,PropSessionExpiryInterval 31340,PropRetainAvailable
// 201,PropWildcardSubscriptionAvailable 101,PropAssignedClientIdentifier
// "\180\140\GS\EM\189\227\242v\200\CAN\201\152\243\144\141\158\&2\143\155t\206\&8{|"]}), _cleanSession = False,
// _keepAlive = 16879, _connID = "", _properties = [PropTopicAliasMaximum 26905,PropResponseTopic
// "\ETXr\195\163#\207C\193\194\249\&7\239\160\155\STX\138\182\141nl\138\224",PropAuthenticationMethod
// "v\200\207\&5\ACK%\203\225^\DLE\DC1?R\186\t\209i",PropPayloadFormatIndicator 12,PropMaximumQoS
// 27,PropAuthenticationData "\255r\171bm0q8>\ESCQ\128\193\243\236\198K\221\152",PropSessionExpiryInterval
// 18432,PropRetainAvailable 60,PropSharedSubscriptionAvailable 200,PropSubscriptionIdentifier 20,PropMaximumPacketSize
// 19861,PropMaximumQoS 189,PropServerKeepAlive 18916,PropResponseTopic
// "\153\189\238U\240f\201\251\130\RS\247\167\152.?\RSz\241\164g'[c\181!\140\&2\133",PropResponseInformation
// "W-=I\247(\235 8X\209\224\239o\196M\134\157\232\SYN\145\153\141ri\130PI\158a",PropSessionExpiryInterval
// 29328,PropUserProperty "" "\230",PropAuthenticationMethod
// "\\\253\\\152\SI\194\ESC\218\207\182l\ENQ\193.\248K",PropMaximumQoS 134,PropMaximumPacketSize
// 22187,PropRetainAvailable 16,PropMessageExpiryInterval 23463,PropRequestResponseInformation
// 242,PropResponseInformation "E\208\DC4\160\137\135\v3\197\181\130\GS\SYN\b8\ENQ\n",PropReceiveMaximum
// 14612,PropWildcardSubscriptionAvailable 72,PropReceiveMaximum 8504]}
TEST(Connect5QCTest, Encode8) {
  uint8_t pkt[] = {
      0x10, 0xe6, 0x2,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xec, 0x41, 0xef, 0xe9, 0x1,  0x22, 0x69, 0x19, 0x8,
      0x0,  0x16, 0x3,  0x72, 0xc3, 0xa3, 0x23, 0xcf, 0x43, 0xc1, 0xc2, 0xf9, 0x37, 0xef, 0xa0, 0x9b, 0x2,  0x8a, 0xb6,
      0x8d, 0x6e, 0x6c, 0x8a, 0xe0, 0x15, 0x0,  0x11, 0x76, 0xc8, 0xcf, 0x35, 0x6,  0x25, 0xcb, 0xe1, 0x5e, 0x10, 0x11,
      0x3f, 0x52, 0xba, 0x9,  0xd1, 0x69, 0x1,  0xc,  0x24, 0x1b, 0x16, 0x0,  0x13, 0xff, 0x72, 0xab, 0x62, 0x6d, 0x30,
      0x71, 0x38, 0x3e, 0x1b, 0x51, 0x80, 0xc1, 0xf3, 0xec, 0xc6, 0x4b, 0xdd, 0x98, 0x11, 0x0,  0x0,  0x48, 0x0,  0x25,
      0x3c, 0x2a, 0xc8, 0xb,  0x14, 0x27, 0x0,  0x0,  0x4d, 0x95, 0x24, 0xbd, 0x13, 0x49, 0xe4, 0x8,  0x0,  0x1c, 0x99,
      0xbd, 0xee, 0x55, 0xf0, 0x66, 0xc9, 0xfb, 0x82, 0x1e, 0xf7, 0xa7, 0x98, 0x2e, 0x3f, 0x1e, 0x7a, 0xf1, 0xa4, 0x67,
      0x27, 0x5b, 0x63, 0xb5, 0x21, 0x8c, 0x32, 0x85, 0x1a, 0x0,  0x1e, 0x57, 0x2d, 0x3d, 0x49, 0xf7, 0x28, 0xeb, 0x20,
      0x38, 0x58, 0xd1, 0xe0, 0xef, 0x6f, 0xc4, 0x4d, 0x86, 0x9d, 0xe8, 0x16, 0x91, 0x99, 0x8d, 0x72, 0x69, 0x82, 0x50,
      0x49, 0x9e, 0x61, 0x11, 0x0,  0x0,  0x72, 0x90, 0x26, 0x0,  0x0,  0x0,  0x1,  0xe6, 0x15, 0x0,  0x10, 0x5c, 0xfd,
      0x5c, 0x98, 0xf,  0xc2, 0x1b, 0xda, 0xcf, 0xb6, 0x6c, 0x5,  0xc1, 0x2e, 0xf8, 0x4b, 0x24, 0x86, 0x27, 0x0,  0x0,
      0x56, 0xab, 0x25, 0x10, 0x2,  0x0,  0x0,  0x5b, 0xa7, 0x19, 0xf2, 0x1a, 0x0,  0x11, 0x45, 0xd0, 0x14, 0xa0, 0x89,
      0x87, 0xb,  0x33, 0xc5, 0xb5, 0x82, 0x1d, 0x16, 0x8,  0x38, 0x5,  0xa,  0x21, 0x39, 0x14, 0x28, 0x48, 0x21, 0x21,
      0x38, 0x0,  0x0,  0x3b, 0x1c, 0x0,  0xf,  0x25, 0x50, 0x13, 0xf2, 0xf,  0x20, 0x93, 0xb,  0xa4, 0x8c, 0x3a, 0x3d,
      0xf6, 0xb2, 0x24, 0x21, 0x5b, 0x65, 0x28, 0xbe, 0x11, 0x0,  0x0,  0x7a, 0x6c, 0x25, 0xc9, 0x28, 0x65, 0x12, 0x0,
      0x18, 0xb4, 0x8c, 0x1d, 0x19, 0xbd, 0xe3, 0xf2, 0x76, 0xc8, 0x18, 0xc9, 0x98, 0xf3, 0x90, 0x8d, 0x9e, 0x32, 0x8f,
      0x9b, 0x74, 0xce, 0x38, 0x7b, 0x7c, 0x0,  0x5,  0xa2, 0xc1, 0x4e, 0xf6, 0x47, 0x0,  0x7,  0xc1, 0xe2, 0xb7, 0xed,
      0xa6, 0xca, 0xe9, 0x0,  0xb,  0x98, 0xc3, 0x7e, 0xe4, 0x26, 0x56, 0xc7, 0xc2, 0x1b, 0xce, 0x9a, 0x0,  0x14, 0x76,
      0x65, 0xae, 0xff, 0xb7, 0x3a, 0xc0, 0xa5, 0x33, 0xab, 0xf1, 0xbb, 0x2b, 0x7f, 0xd1, 0x22, 0xf8, 0xe0, 0xba, 0x9a};

  uint8_t buf[371] = {0};

  uint8_t bytesprops0[] = {0x3,  0x72, 0xc3, 0xa3, 0x23, 0xcf, 0x43, 0xc1, 0xc2, 0xf9, 0x37,
                           0xef, 0xa0, 0x9b, 0x2,  0x8a, 0xb6, 0x8d, 0x6e, 0x6c, 0x8a, 0xe0};
  uint8_t bytesprops1[] = {0x76, 0xc8, 0xcf, 0x35, 0x6,  0x25, 0xcb, 0xe1, 0x5e,
                           0x10, 0x11, 0x3f, 0x52, 0xba, 0x9,  0xd1, 0x69};
  uint8_t bytesprops2[] = {0xff, 0x72, 0xab, 0x62, 0x6d, 0x30, 0x71, 0x38, 0x3e, 0x1b,
                           0x51, 0x80, 0xc1, 0xf3, 0xec, 0xc6, 0x4b, 0xdd, 0x98};
  uint8_t bytesprops3[] = {0x99, 0xbd, 0xee, 0x55, 0xf0, 0x66, 0xc9, 0xfb, 0x82, 0x1e, 0xf7, 0xa7, 0x98, 0x2e,
                           0x3f, 0x1e, 0x7a, 0xf1, 0xa4, 0x67, 0x27, 0x5b, 0x63, 0xb5, 0x21, 0x8c, 0x32, 0x85};
  uint8_t bytesprops4[] = {0x57, 0x2d, 0x3d, 0x49, 0xf7, 0x28, 0xeb, 0x20, 0x38, 0x58, 0xd1, 0xe0, 0xef, 0x6f, 0xc4,
                           0x4d, 0x86, 0x9d, 0xe8, 0x16, 0x91, 0x99, 0x8d, 0x72, 0x69, 0x82, 0x50, 0x49, 0x9e, 0x61};
  uint8_t bytesprops6[] = {0xe6};
  uint8_t bytesprops5[] = {0};
  uint8_t bytesprops7[] = {0x5c, 0xfd, 0x5c, 0x98, 0xf,  0xc2, 0x1b, 0xda,
                           0xcf, 0xb6, 0x6c, 0x5,  0xc1, 0x2e, 0xf8, 0x4b};
  uint8_t bytesprops8[] = {0x45, 0xd0, 0x14, 0xa0, 0x89, 0x87, 0xb, 0x33, 0xc5,
                           0xb5, 0x82, 0x1d, 0x16, 0x8,  0x38, 0x5, 0xa};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 26905}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {22, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 12}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 27}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18432}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 60}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 200}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 20}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 19861}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 189}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 18916}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {28, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 29328}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {0, (char*)&bytesprops5}, .v = {1, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {16, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 134}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 22187}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 16}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23463}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 242}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {17, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 14612}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 72}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 8504}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0x25, 0x50, 0x13, 0xf2, 0xf, 0x20, 0x93, 0xb, 0xa4, 0x8c, 0x3a, 0x3d, 0xf6, 0xb2, 0x24};
  uint8_t byteswillprops1[] = {0xb4, 0x8c, 0x1d, 0x19, 0xbd, 0xe3, 0xf2, 0x76, 0xc8, 0x18, 0xc9, 0x98,
                               0xf3, 0x90, 0x8d, 0x9e, 0x32, 0x8f, 0x9b, 0x74, 0xce, 0x38, 0x7b, 0x7c};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {15, (char*)&byteswillprops0}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 23397}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 190}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31340}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 201}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 101}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&byteswillprops1}}},
  };

  lwmqtt_properties_t willprops = {7, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa2, 0xc1, 0x4e, 0xf6, 0x47};
  lwmqtt_string_t will_topic = {5, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0xc1, 0xe2, 0xb7, 0xed, 0xa6, 0xca, 0xe9};
  lwmqtt_string_t will_payload = {7, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS1;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = false;
  opts.keep_alive = 16879;
  uint8_t client_id_bytes[] = {0};
  lwmqtt_string_t client_id = {0, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0x98, 0xc3, 0x7e, 0xe4, 0x26, 0x56, 0xc7, 0xc2, 0x1b, 0xce, 0x9a};
  lwmqtt_string_t username = {11, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x76, 0x65, 0xae, 0xff, 0xb7, 0x3a, 0xc0, 0xa5, 0x33, 0xab,
                              0xf1, 0xbb, 0x2b, 0x7f, 0xd1, 0x22, 0xf8, 0xe0, 0xba, 0x9a};
  lwmqtt_string_t password = {20, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just
// "\242\220\SUB\204\v-\136\211/\218\DC2\243\158]\190\165\251\150H\238\200\DC2\152\245U\202\NULf\153", _password = Just
// "\161\v@\t\155\233WB", _lastWill = Just (LastWill {_willRetain = False, _willQoS = QoS0, _willTopic =
// "\222v\195\252\243\159p\129\STX\218r\STX\ESCm\242\201\193\&6X\191h\206\233\210x\134d\170\f", _willMsg =
// "\DC2Bm\152\DLE\140\SO\236*\150\134\134m\195I\140\tMpG\v\199\138'\230\242\227\247m\202", _willProps =
// [PropReceiveMaximum 23059,PropWillDelayInterval 22019,PropContentType
// "\250\"\SI\252\ETX!s\bqK\197g2\204\142~M2\155F\NAK",PropWillDelayInterval 21909,PropRequestProblemInformation
// 21,PropAuthenticationData "\STX@R\EOT\150#m\SO\184\245B\196=O",PropMessageExpiryInterval 17248,PropCorrelationData
// "\195G\209x\242o\204pR%\152\243'\244\210MF\nd+U\183I",PropAuthenticationData
// "\221\214+\237\ETX\"\198\217\DC2\231\183\156\210\CANi\228:\137\EOT\233wn\208\ACK\207\ETX8,",PropWildcardSubscriptionAvailable
// 191,PropMaximumQoS 176,PropAuthenticationData
// "\186\210\159\\A\140\212)h\190\240\205dTF\190\\B\228\ETB\139\173\244\132\168\n(\143c",PropSubscriptionIdentifierAvailable
// 178,PropMessageExpiryInterval 30219,PropTopicAliasMaximum 938]}), _cleanSession = True, _keepAlive = 9102, _connID =
// "\234B\EOT\247\247W\194\222\nP\131)&?\226\&0X\209p\ESC\177z\201\SOt\131g(\215W", _properties =
// [PropPayloadFormatIndicator 87,PropContentType "\ETX\136\218.\199\146\ACK\"\154.a\247>VX",PropCorrelationData
// "\SOH\213\167\169\140\SOH\ESC\209\191\199g\174D\197\252\183o\SUB\143\227Nn\r!b\182",PropTopicAliasMaximum
// 4141,PropSubscriptionIdentifier 2,PropMaximumQoS 103,PropMaximumPacketSize 26526,PropSharedSubscriptionAvailable
// 64,PropTopicAlias 530,PropAssignedClientIdentifier "\NUL\218g\RS",PropSubscriptionIdentifierAvailable
// 120,PropSessionExpiryInterval 18660,PropAuthenticationData
// "4\208\STX\247Z\226w\182\132",PropSubscriptionIdentifierAvailable 190,PropSessionExpiryInterval
// 8586,PropResponseTopic
// "\183\&4\169K*U\SO{\155\181.\137\215j\154\\\203\179\252\&042g\SUB\f\a\153",PropMaximumPacketSize
// 364,PropRetainAvailable 110,PropResponseTopic "\230\ENQyA\t\128\221+",PropAuthenticationData
// "kRr\164\251\193\203\251c\244{P\ENQ\182\238\206~\179\238\US\159",PropCorrelationData
// "\207\222\198\DC2\163r\129&\145\244\197]\156\192\215!",PropRetainAvailable 87,PropReasonString "o
// \US0\204\136~\188\vl1\a\237",PropAuthenticationData
// "\249\SO\189\DC1Z\DELL\235\161\191\220|\222/\219kL\156n+\CAN\230\162l\231^s\207",PropCorrelationData
// "\246Tp\163&O\201\224TS\151\SUBU/P\227\ETB\152\234\255.5\148\235\&1\138\220\156\172\154",PropServerReference
// "\152\153q2X\ENQ\200\218\221X\217}\212\246\227\&0<@\217\SI\142",PropResponseInformation
// "d6\219d1\159\DC3\202GyEn",PropRequestProblemInformation 234,PropUserProperty "\213]&\138\232ID\159\238o\178#k%P\151"
// "%\132\DC2y\142\216\171%\248~\252\165~\r\171\RSp\229\192-\225\236\SYN&X\US"]}
TEST(Connect5QCTest, Encode9) {
  uint8_t pkt[] = {
      0x10, 0xa2, 0x5,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xc6, 0x23, 0x8e, 0xe8, 0x2,  0x1,  0x57, 0x3,  0x0,
      0xf,  0x3,  0x88, 0xda, 0x2e, 0xc7, 0x92, 0x6,  0x22, 0x9a, 0x2e, 0x61, 0xf7, 0x3e, 0x56, 0x58, 0x9,  0x0,  0x1a,
      0x1,  0xd5, 0xa7, 0xa9, 0x8c, 0x1,  0x1b, 0xd1, 0xbf, 0xc7, 0x67, 0xae, 0x44, 0xc5, 0xfc, 0xb7, 0x6f, 0x1a, 0x8f,
      0xe3, 0x4e, 0x6e, 0xd,  0x21, 0x62, 0xb6, 0x22, 0x10, 0x2d, 0xb,  0x2,  0x24, 0x67, 0x27, 0x0,  0x0,  0x67, 0x9e,
      0x2a, 0x40, 0x23, 0x2,  0x12, 0x12, 0x0,  0x4,  0x0,  0xda, 0x67, 0x1e, 0x29, 0x78, 0x11, 0x0,  0x0,  0x48, 0xe4,
      0x16, 0x0,  0x9,  0x34, 0xd0, 0x2,  0xf7, 0x5a, 0xe2, 0x77, 0xb6, 0x84, 0x29, 0xbe, 0x11, 0x0,  0x0,  0x21, 0x8a,
      0x8,  0x0,  0x1b, 0xb7, 0x34, 0xa9, 0x4b, 0x2a, 0x55, 0xe,  0x7b, 0x9b, 0xb5, 0x2e, 0x89, 0xd7, 0x6a, 0x9a, 0x5c,
      0xcb, 0xb3, 0xfc, 0x30, 0x34, 0x32, 0x67, 0x1a, 0xc,  0x7,  0x99, 0x27, 0x0,  0x0,  0x1,  0x6c, 0x25, 0x6e, 0x8,
      0x0,  0x8,  0xe6, 0x5,  0x79, 0x41, 0x9,  0x80, 0xdd, 0x2b, 0x16, 0x0,  0x15, 0x6b, 0x52, 0x72, 0xa4, 0xfb, 0xc1,
      0xcb, 0xfb, 0x63, 0xf4, 0x7b, 0x50, 0x5,  0xb6, 0xee, 0xce, 0x7e, 0xb3, 0xee, 0x1f, 0x9f, 0x9,  0x0,  0x10, 0xcf,
      0xde, 0xc6, 0x12, 0xa3, 0x72, 0x81, 0x26, 0x91, 0xf4, 0xc5, 0x5d, 0x9c, 0xc0, 0xd7, 0x21, 0x25, 0x57, 0x1f, 0x0,
      0xd,  0x6f, 0x20, 0x1f, 0x30, 0xcc, 0x88, 0x7e, 0xbc, 0xb,  0x6c, 0x31, 0x7,  0xed, 0x16, 0x0,  0x1c, 0xf9, 0xe,
      0xbd, 0x11, 0x5a, 0x7f, 0x4c, 0xeb, 0xa1, 0xbf, 0xdc, 0x7c, 0xde, 0x2f, 0xdb, 0x6b, 0x4c, 0x9c, 0x6e, 0x2b, 0x18,
      0xe6, 0xa2, 0x6c, 0xe7, 0x5e, 0x73, 0xcf, 0x9,  0x0,  0x1e, 0xf6, 0x54, 0x70, 0xa3, 0x26, 0x4f, 0xc9, 0xe0, 0x54,
      0x53, 0x97, 0x1a, 0x55, 0x2f, 0x50, 0xe3, 0x17, 0x98, 0xea, 0xff, 0x2e, 0x35, 0x94, 0xeb, 0x31, 0x8a, 0xdc, 0x9c,
      0xac, 0x9a, 0x1c, 0x0,  0x15, 0x98, 0x99, 0x71, 0x32, 0x58, 0x5,  0xc8, 0xda, 0xdd, 0x58, 0xd9, 0x7d, 0xd4, 0xf6,
      0xe3, 0x30, 0x3c, 0x40, 0xd9, 0xf,  0x8e, 0x1a, 0x0,  0xc,  0x64, 0x36, 0xdb, 0x64, 0x31, 0x9f, 0x13, 0xca, 0x47,
      0x79, 0x45, 0x6e, 0x17, 0xea, 0x26, 0x0,  0x10, 0xd5, 0x5d, 0x26, 0x8a, 0xe8, 0x49, 0x44, 0x9f, 0xee, 0x6f, 0xb2,
      0x23, 0x6b, 0x25, 0x50, 0x97, 0x0,  0x1a, 0x25, 0x84, 0x12, 0x79, 0x8e, 0xd8, 0xab, 0x25, 0xf8, 0x7e, 0xfc, 0xa5,
      0x7e, 0xd,  0xab, 0x1e, 0x70, 0xe5, 0xc0, 0x2d, 0xe1, 0xec, 0x16, 0x26, 0x58, 0x1f, 0x0,  0x1e, 0xea, 0x42, 0x4,
      0xf7, 0xf7, 0x57, 0xc2, 0xde, 0xa,  0x50, 0x83, 0x29, 0x26, 0x3f, 0xe2, 0x30, 0x58, 0xd1, 0x70, 0x1b, 0xb1, 0x7a,
      0xc9, 0xe,  0x74, 0x83, 0x67, 0x28, 0xd7, 0x57, 0xa4, 0x1,  0x21, 0x5a, 0x13, 0x18, 0x0,  0x0,  0x56, 0x3,  0x3,
      0x0,  0x15, 0xfa, 0x22, 0xf,  0xfc, 0x3,  0x21, 0x73, 0x8,  0x71, 0x4b, 0xc5, 0x67, 0x32, 0xcc, 0x8e, 0x7e, 0x4d,
      0x32, 0x9b, 0x46, 0x15, 0x18, 0x0,  0x0,  0x55, 0x95, 0x17, 0x15, 0x16, 0x0,  0xe,  0x2,  0x40, 0x52, 0x4,  0x96,
      0x23, 0x6d, 0xe,  0xb8, 0xf5, 0x42, 0xc4, 0x3d, 0x4f, 0x2,  0x0,  0x0,  0x43, 0x60, 0x9,  0x0,  0x17, 0xc3, 0x47,
      0xd1, 0x78, 0xf2, 0x6f, 0xcc, 0x70, 0x52, 0x25, 0x98, 0xf3, 0x27, 0xf4, 0xd2, 0x4d, 0x46, 0xa,  0x64, 0x2b, 0x55,
      0xb7, 0x49, 0x16, 0x0,  0x1c, 0xdd, 0xd6, 0x2b, 0xed, 0x3,  0x22, 0xc6, 0xd9, 0x12, 0xe7, 0xb7, 0x9c, 0xd2, 0x18,
      0x69, 0xe4, 0x3a, 0x89, 0x4,  0xe9, 0x77, 0x6e, 0xd0, 0x6,  0xcf, 0x3,  0x38, 0x2c, 0x28, 0xbf, 0x24, 0xb0, 0x16,
      0x0,  0x1d, 0xba, 0xd2, 0x9f, 0x5c, 0x41, 0x8c, 0xd4, 0x29, 0x68, 0xbe, 0xf0, 0xcd, 0x64, 0x54, 0x46, 0xbe, 0x5c,
      0x42, 0xe4, 0x17, 0x8b, 0xad, 0xf4, 0x84, 0xa8, 0xa,  0x28, 0x8f, 0x63, 0x29, 0xb2, 0x2,  0x0,  0x0,  0x76, 0xb,
      0x22, 0x3,  0xaa, 0x0,  0x1d, 0xde, 0x76, 0xc3, 0xfc, 0xf3, 0x9f, 0x70, 0x81, 0x2,  0xda, 0x72, 0x2,  0x1b, 0x6d,
      0xf2, 0xc9, 0xc1, 0x36, 0x58, 0xbf, 0x68, 0xce, 0xe9, 0xd2, 0x78, 0x86, 0x64, 0xaa, 0xc,  0x0,  0x1e, 0x12, 0x42,
      0x6d, 0x98, 0x10, 0x8c, 0xe,  0xec, 0x2a, 0x96, 0x86, 0x86, 0x6d, 0xc3, 0x49, 0x8c, 0x9,  0x4d, 0x70, 0x47, 0xb,
      0xc7, 0x8a, 0x27, 0xe6, 0xf2, 0xe3, 0xf7, 0x6d, 0xca, 0x0,  0x1d, 0xf2, 0xdc, 0x1a, 0xcc, 0xb,  0x2d, 0x88, 0xd3,
      0x2f, 0xda, 0x12, 0xf3, 0x9e, 0x5d, 0xbe, 0xa5, 0xfb, 0x96, 0x48, 0xee, 0xc8, 0x12, 0x98, 0xf5, 0x55, 0xca, 0x0,
      0x66, 0x99, 0x0,  0x8,  0xa1, 0xb,  0x40, 0x9,  0x9b, 0xe9, 0x57, 0x42};

  uint8_t buf[687] = {0};

  uint8_t bytesprops0[] = {0x3, 0x88, 0xda, 0x2e, 0xc7, 0x92, 0x6, 0x22, 0x9a, 0x2e, 0x61, 0xf7, 0x3e, 0x56, 0x58};
  uint8_t bytesprops1[] = {0x1,  0xd5, 0xa7, 0xa9, 0x8c, 0x1,  0x1b, 0xd1, 0xbf, 0xc7, 0x67, 0xae, 0x44,
                           0xc5, 0xfc, 0xb7, 0x6f, 0x1a, 0x8f, 0xe3, 0x4e, 0x6e, 0xd,  0x21, 0x62, 0xb6};
  uint8_t bytesprops2[] = {0x0, 0xda, 0x67, 0x1e};
  uint8_t bytesprops3[] = {0x34, 0xd0, 0x2, 0xf7, 0x5a, 0xe2, 0x77, 0xb6, 0x84};
  uint8_t bytesprops4[] = {0xb7, 0x34, 0xa9, 0x4b, 0x2a, 0x55, 0xe,  0x7b, 0x9b, 0xb5, 0x2e, 0x89, 0xd7, 0x6a,
                           0x9a, 0x5c, 0xcb, 0xb3, 0xfc, 0x30, 0x34, 0x32, 0x67, 0x1a, 0xc,  0x7,  0x99};
  uint8_t bytesprops5[] = {0xe6, 0x5, 0x79, 0x41, 0x9, 0x80, 0xdd, 0x2b};
  uint8_t bytesprops6[] = {0x6b, 0x52, 0x72, 0xa4, 0xfb, 0xc1, 0xcb, 0xfb, 0x63, 0xf4, 0x7b,
                           0x50, 0x5,  0xb6, 0xee, 0xce, 0x7e, 0xb3, 0xee, 0x1f, 0x9f};
  uint8_t bytesprops7[] = {0xcf, 0xde, 0xc6, 0x12, 0xa3, 0x72, 0x81, 0x26,
                           0x91, 0xf4, 0xc5, 0x5d, 0x9c, 0xc0, 0xd7, 0x21};
  uint8_t bytesprops8[] = {0x6f, 0x20, 0x1f, 0x30, 0xcc, 0x88, 0x7e, 0xbc, 0xb, 0x6c, 0x31, 0x7, 0xed};
  uint8_t bytesprops9[] = {0xf9, 0xe,  0xbd, 0x11, 0x5a, 0x7f, 0x4c, 0xeb, 0xa1, 0xbf, 0xdc, 0x7c, 0xde, 0x2f,
                           0xdb, 0x6b, 0x4c, 0x9c, 0x6e, 0x2b, 0x18, 0xe6, 0xa2, 0x6c, 0xe7, 0x5e, 0x73, 0xcf};
  uint8_t bytesprops10[] = {0xf6, 0x54, 0x70, 0xa3, 0x26, 0x4f, 0xc9, 0xe0, 0x54, 0x53, 0x97, 0x1a, 0x55, 0x2f, 0x50,
                            0xe3, 0x17, 0x98, 0xea, 0xff, 0x2e, 0x35, 0x94, 0xeb, 0x31, 0x8a, 0xdc, 0x9c, 0xac, 0x9a};
  uint8_t bytesprops11[] = {0x98, 0x99, 0x71, 0x32, 0x58, 0x5,  0xc8, 0xda, 0xdd, 0x58, 0xd9,
                            0x7d, 0xd4, 0xf6, 0xe3, 0x30, 0x3c, 0x40, 0xd9, 0xf,  0x8e};
  uint8_t bytesprops12[] = {0x64, 0x36, 0xdb, 0x64, 0x31, 0x9f, 0x13, 0xca, 0x47, 0x79, 0x45, 0x6e};
  uint8_t bytesprops14[] = {0x25, 0x84, 0x12, 0x79, 0x8e, 0xd8, 0xab, 0x25, 0xf8, 0x7e, 0xfc, 0xa5, 0x7e,
                            0xd,  0xab, 0x1e, 0x70, 0xe5, 0xc0, 0x2d, 0xe1, 0xec, 0x16, 0x26, 0x58, 0x1f};
  uint8_t bytesprops13[] = {0xd5, 0x5d, 0x26, 0x8a, 0xe8, 0x49, 0x44, 0x9f,
                            0xee, 0x6f, 0xb2, 0x23, 0x6b, 0x25, 0x50, 0x97};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 87}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4141}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 2}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 103}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 26526}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 64}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 530}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {4, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 120}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 18660}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {9, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 190}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 8586}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 364}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 110}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {21, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 87}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {13, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {12, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 234}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {16, (char*)&bytesprops13}, .v = {26, (char*)&bytesprops14}}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0xfa, 0x22, 0xf,  0xfc, 0x3,  0x21, 0x73, 0x8,  0x71, 0x4b, 0xc5,
                               0x67, 0x32, 0xcc, 0x8e, 0x7e, 0x4d, 0x32, 0x9b, 0x46, 0x15};
  uint8_t byteswillprops1[] = {0x2, 0x40, 0x52, 0x4, 0x96, 0x23, 0x6d, 0xe, 0xb8, 0xf5, 0x42, 0xc4, 0x3d, 0x4f};
  uint8_t byteswillprops2[] = {0xc3, 0x47, 0xd1, 0x78, 0xf2, 0x6f, 0xcc, 0x70, 0x52, 0x25, 0x98, 0xf3,
                               0x27, 0xf4, 0xd2, 0x4d, 0x46, 0xa,  0x64, 0x2b, 0x55, 0xb7, 0x49};
  uint8_t byteswillprops3[] = {0xdd, 0xd6, 0x2b, 0xed, 0x3, 0x22, 0xc6, 0xd9, 0x12, 0xe7, 0xb7, 0x9c, 0xd2, 0x18,
                               0x69, 0xe4, 0x3a, 0x89, 0x4, 0xe9, 0x77, 0x6e, 0xd0, 0x6,  0xcf, 0x3,  0x38, 0x2c};
  uint8_t byteswillprops4[] = {0xba, 0xd2, 0x9f, 0x5c, 0x41, 0x8c, 0xd4, 0x29, 0x68, 0xbe, 0xf0, 0xcd, 0x64, 0x54, 0x46,
                               0xbe, 0x5c, 0x42, 0xe4, 0x17, 0x8b, 0xad, 0xf4, 0x84, 0xa8, 0xa,  0x28, 0x8f, 0x63};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 23059}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 22019}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&byteswillprops0}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21909}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 21}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {14, (char*)&byteswillprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 17248}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {23, (char*)&byteswillprops2}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&byteswillprops3}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 191}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 176}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&byteswillprops4}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 178}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30219}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 938}},
  };

  lwmqtt_properties_t willprops = {15, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xde, 0x76, 0xc3, 0xfc, 0xf3, 0x9f, 0x70, 0x81, 0x2,  0xda,
                                0x72, 0x2,  0x1b, 0x6d, 0xf2, 0xc9, 0xc1, 0x36, 0x58, 0xbf,
                                0x68, 0xce, 0xe9, 0xd2, 0x78, 0x86, 0x64, 0xaa, 0xc};
  lwmqtt_string_t will_topic = {29, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0x12, 0x42, 0x6d, 0x98, 0x10, 0x8c, 0xe,  0xec, 0x2a, 0x96,
                                  0x86, 0x86, 0x6d, 0xc3, 0x49, 0x8c, 0x9,  0x4d, 0x70, 0x47,
                                  0xb,  0xc7, 0x8a, 0x27, 0xe6, 0xf2, 0xe3, 0xf7, 0x6d, 0xca};
  lwmqtt_string_t will_payload = {30, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS0;
  will.retained = false;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 9102;
  uint8_t client_id_bytes[] = {0xea, 0x42, 0x4,  0xf7, 0xf7, 0x57, 0xc2, 0xde, 0xa, 0x50, 0x83, 0x29, 0x26, 0x3f, 0xe2,
                               0x30, 0x58, 0xd1, 0x70, 0x1b, 0xb1, 0x7a, 0xc9, 0xe, 0x74, 0x83, 0x67, 0x28, 0xd7, 0x57};
  lwmqtt_string_t client_id = {30, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xf2, 0xdc, 0x1a, 0xcc, 0xb,  0x2d, 0x88, 0xd3, 0x2f, 0xda, 0x12, 0xf3, 0x9e, 0x5d, 0xbe,
                              0xa5, 0xfb, 0x96, 0x48, 0xee, 0xc8, 0x12, 0x98, 0xf5, 0x55, 0xca, 0x0,  0x66, 0x99};
  lwmqtt_string_t username = {29, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0xa1, 0xb, 0x40, 0x9, 0x9b, 0xe9, 0x57, 0x42};
  lwmqtt_string_t password = {8, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// ConnectRequest {_username = Just "\174\237\224:\154\243X\224`\199", _password = Just
// "%\185W1f}\195\140\153\169\181\238\243\236\EM,V\216\ESC\151\168", _lastWill = Just (LastWill {_willRetain = True,
// _willQoS = QoS2, _willTopic = "\162\219\EM\161\228\128\255m", _willMsg = "", _willProps = [PropAuthenticationData
// "",PropUserProperty "\241\182\DELW\185\FSV\203\254!\191e\184\173v"
// "5\186\170\159J\173\138LGd\DC2",PropSubscriptionIdentifier 30,PropAuthenticationData
// "\DC4\203\EOT\t\137/l\252\129(\211\187\225",PropTopicAliasMaximum 31859,PropMaximumPacketSize 5092,PropResponseTopic
// "",PropRequestResponseInformation 63,PropWildcardSubscriptionAvailable 50,PropSessionExpiryInterval
// 28357,PropSubscriptionIdentifierAvailable 244,PropTopicAliasMaximum 4424,PropAuthenticationMethod
// ",\DC3\161\192\DLE\137\&7",PropSharedSubscriptionAvailable 33,PropCorrelationData
// "\234+\178+\DLE?o\137\164\210\145\238<\193Ci\148\233\b\251\FS\DLE\217\145\238\164",PropMaximumPacketSize
// 21984,PropSubscriptionIdentifierAvailable 55,PropAuthenticationData "US\224/\189"]}), _cleanSession = True,
// _keepAlive = 17212, _connID = "\203o\140\199r\n\144n\FS\211\223\147\152?\GS\152/\v\245r\"\250", _properties =
// [PropAuthenticationMethod "\188\249MP\236w3\210\146\"\141m\208E\204\148",PropReasonString
// "\178\&1\131\&3=h\198\GS'\231\140\148\253\194\169a\134#P(\249\196\b\174\174/\214\"\149",PropTopicAlias
// 29058,PropSubscriptionIdentifier 10,PropWildcardSubscriptionAvailable 243]}
TEST(Connect5QCTest, Encode10) {
  uint8_t pkt[] = {
      0x10, 0x93, 0x2,  0x0,  0x4,  0x4d, 0x51, 0x54, 0x54, 0x5,  0xf6, 0x43, 0x3c, 0x3a, 0x15, 0x0,  0x10, 0xbc, 0xf9,
      0x4d, 0x50, 0xec, 0x77, 0x33, 0xd2, 0x92, 0x22, 0x8d, 0x6d, 0xd0, 0x45, 0xcc, 0x94, 0x1f, 0x0,  0x1d, 0xb2, 0x31,
      0x83, 0x33, 0x3d, 0x68, 0xc6, 0x1d, 0x27, 0xe7, 0x8c, 0x94, 0xfd, 0xc2, 0xa9, 0x61, 0x86, 0x23, 0x50, 0x28, 0xf9,
      0xc4, 0x8,  0xae, 0xae, 0x2f, 0xd6, 0x22, 0x95, 0x23, 0x71, 0x82, 0xb,  0xa,  0x28, 0xf3, 0x0,  0x16, 0xcb, 0x6f,
      0x8c, 0xc7, 0x72, 0xa,  0x90, 0x6e, 0x1c, 0xd3, 0xdf, 0x93, 0x98, 0x3f, 0x1d, 0x98, 0x2f, 0xb,  0xf5, 0x72, 0x22,
      0xfa, 0x85, 0x1,  0x16, 0x0,  0x0,  0x26, 0x0,  0xf,  0xf1, 0xb6, 0x7f, 0x57, 0xb9, 0x1c, 0x56, 0xcb, 0xfe, 0x21,
      0xbf, 0x65, 0xb8, 0xad, 0x76, 0x0,  0xb,  0x35, 0xba, 0xaa, 0x9f, 0x4a, 0xad, 0x8a, 0x4c, 0x47, 0x64, 0x12, 0xb,
      0x1e, 0x16, 0x0,  0xd,  0x14, 0xcb, 0x4,  0x9,  0x89, 0x2f, 0x6c, 0xfc, 0x81, 0x28, 0xd3, 0xbb, 0xe1, 0x22, 0x7c,
      0x73, 0x27, 0x0,  0x0,  0x13, 0xe4, 0x8,  0x0,  0x0,  0x19, 0x3f, 0x28, 0x32, 0x11, 0x0,  0x0,  0x6e, 0xc5, 0x29,
      0xf4, 0x22, 0x11, 0x48, 0x15, 0x0,  0x7,  0x2c, 0x13, 0xa1, 0xc0, 0x10, 0x89, 0x37, 0x2a, 0x21, 0x9,  0x0,  0x1a,
      0xea, 0x2b, 0xb2, 0x2b, 0x10, 0x3f, 0x6f, 0x89, 0xa4, 0xd2, 0x91, 0xee, 0x3c, 0xc1, 0x43, 0x69, 0x94, 0xe9, 0x8,
      0xfb, 0x1c, 0x10, 0xd9, 0x91, 0xee, 0xa4, 0x27, 0x0,  0x0,  0x55, 0xe0, 0x29, 0x37, 0x16, 0x0,  0x5,  0x55, 0x53,
      0xe0, 0x2f, 0xbd, 0x0,  0x8,  0xa2, 0xdb, 0x19, 0xa1, 0xe4, 0x80, 0xff, 0x6d, 0x0,  0x0,  0x0,  0xa,  0xae, 0xed,
      0xe0, 0x3a, 0x9a, 0xf3, 0x58, 0xe0, 0x60, 0xc7, 0x0,  0x15, 0x25, 0xb9, 0x57, 0x31, 0x66, 0x7d, 0xc3, 0x8c, 0x99,
      0xa9, 0xb5, 0xee, 0xf3, 0xec, 0x19, 0x2c, 0x56, 0xd8, 0x1b, 0x97, 0xa8};

  uint8_t buf[288] = {0};

  uint8_t bytesprops0[] = {0xbc, 0xf9, 0x4d, 0x50, 0xec, 0x77, 0x33, 0xd2,
                           0x92, 0x22, 0x8d, 0x6d, 0xd0, 0x45, 0xcc, 0x94};
  uint8_t bytesprops1[] = {0xb2, 0x31, 0x83, 0x33, 0x3d, 0x68, 0xc6, 0x1d, 0x27, 0xe7, 0x8c, 0x94, 0xfd, 0xc2, 0xa9,
                           0x61, 0x86, 0x23, 0x50, 0x28, 0xf9, 0xc4, 0x8,  0xae, 0xae, 0x2f, 0xd6, 0x22, 0x95};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29058}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 10}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 243}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
  lwmqtt_will_t will = lwmqtt_default_will;
  uint8_t byteswillprops0[] = {0};
  uint8_t byteswillprops2[] = {0x35, 0xba, 0xaa, 0x9f, 0x4a, 0xad, 0x8a, 0x4c, 0x47, 0x64, 0x12};
  uint8_t byteswillprops1[] = {0xf1, 0xb6, 0x7f, 0x57, 0xb9, 0x1c, 0x56, 0xcb,
                               0xfe, 0x21, 0xbf, 0x65, 0xb8, 0xad, 0x76};
  uint8_t byteswillprops3[] = {0x14, 0xcb, 0x4, 0x9, 0x89, 0x2f, 0x6c, 0xfc, 0x81, 0x28, 0xd3, 0xbb, 0xe1};
  uint8_t byteswillprops4[] = {0};
  uint8_t byteswillprops5[] = {0x2c, 0x13, 0xa1, 0xc0, 0x10, 0x89, 0x37};
  uint8_t byteswillprops6[] = {0xea, 0x2b, 0xb2, 0x2b, 0x10, 0x3f, 0x6f, 0x89, 0xa4, 0xd2, 0x91, 0xee, 0x3c,
                               0xc1, 0x43, 0x69, 0x94, 0xe9, 0x8,  0xfb, 0x1c, 0x10, 0xd9, 0x91, 0xee, 0xa4};
  uint8_t byteswillprops7[] = {0x55, 0x53, 0xe0, 0x2f, 0xbd};

  lwmqtt_property_t willpropslist[] = {
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {0, (char*)&byteswillprops0}}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {15, (char*)&byteswillprops1}, .v = {11, (char*)&byteswillprops2}}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 30}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {13, (char*)&byteswillprops3}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 31859}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 5092}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {0, (char*)&byteswillprops4}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 63}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 50}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28357}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 244}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4424}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&byteswillprops5}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 33}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&byteswillprops6}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 21984}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 55}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {5, (char*)&byteswillprops7}}},
  };

  lwmqtt_properties_t willprops = {18, (lwmqtt_property_t*)&willpropslist};
  uint8_t will_topic_bytes[] = {0xa2, 0xdb, 0x19, 0xa1, 0xe4, 0x80, 0xff, 0x6d};
  lwmqtt_string_t will_topic = {8, (char*)&will_topic_bytes};
  uint8_t will_payload_bytes[] = {0};
  lwmqtt_string_t will_payload = {0, (char*)&will_payload_bytes};
  will.topic = will_topic;
  will.payload = will_payload;
  will.qos = LWMQTT_QOS2;
  will.retained = true;
  will.properties = willprops;
  lwmqtt_options_t opts = lwmqtt_default_options;
  opts.properties = props;
  opts.clean_session = true;
  opts.keep_alive = 17212;
  uint8_t client_id_bytes[] = {0xcb, 0x6f, 0x8c, 0xc7, 0x72, 0xa,  0x90, 0x6e, 0x1c, 0xd3, 0xdf,
                               0x93, 0x98, 0x3f, 0x1d, 0x98, 0x2f, 0xb,  0xf5, 0x72, 0x22, 0xfa};
  lwmqtt_string_t client_id = {22, (char*)&client_id_bytes};
  opts.client_id = client_id;
  uint8_t username_bytes[] = {0xae, 0xed, 0xe0, 0x3a, 0x9a, 0xf3, 0x58, 0xe0, 0x60, 0xc7};
  lwmqtt_string_t username = {10, (char*)&username_bytes};
  opts.username = username;
  uint8_t password_bytes[] = {0x25, 0xb9, 0x57, 0x31, 0x66, 0x7d, 0xc3, 0x8c, 0x99, 0xa9, 0xb5,
                              0xee, 0xf3, 0xec, 0x19, 0x2c, 0x56, 0xd8, 0x1b, 0x97, 0xa8};
  lwmqtt_string_t password = {21, (char*)&password_bytes};
  opts.password = password;
  size_t len = 0;
  lwmqtt_err_t err = lwmqtt_encode_connect(buf, sizeof(buf), &len, LWMQTT_MQTT5, opts, &will);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 31688 [("\134Q\r\137U\191\DEL\166>c<~\234\229\251\206\249tYv\161\\\154OeS",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\220\254\200+\222G\NUL\254\179r\136{N\185N\151rL\147\ETX\251\145p\202\177\129\244\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),(";\154\220$\161c\EM\CAN\187~\EM\131+\SYN\242\172q\CAN(\214",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\199G9%\137ER:\132\252\SUB\145)\DC1\238\243q\SI",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\151\228-h2E\145\155\RS[\a\180\192{W\249\DC2k\241\246&L\189\146\SI\227P\233(",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\188\128\150\245A\241\232\247\246K\242\221E\146@\166n\144\178VMY",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("]!b\157\132\190\207K\CAN\240\196\ENQ\CAN\224\246\SOR9CcF\242\206\r\248\GSj",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode1) {
  uint8_t pkt[] = {
      0x82, 0xce, 0x1,  0x7b, 0xc8, 0x0,  0x1a, 0x86, 0x51, 0xd,  0x89, 0x55, 0xbf, 0x7f, 0xa6, 0x3e, 0x63, 0x3c, 0x7e,
      0xea, 0xe5, 0xfb, 0xce, 0xf9, 0x74, 0x59, 0x76, 0xa1, 0x5c, 0x9a, 0x4f, 0x65, 0x53, 0x0,  0x0,  0x1c, 0xdc, 0xfe,
      0xc8, 0x2b, 0xde, 0x47, 0x0,  0xfe, 0xb3, 0x72, 0x88, 0x7b, 0x4e, 0xb9, 0x4e, 0x97, 0x72, 0x4c, 0x93, 0x3,  0xfb,
      0x91, 0x70, 0xca, 0xb1, 0x81, 0xf4, 0xdc, 0x1,  0x0,  0x14, 0x3b, 0x9a, 0xdc, 0x24, 0xa1, 0x63, 0x19, 0x18, 0xbb,
      0x7e, 0x19, 0x83, 0x2b, 0x16, 0xf2, 0xac, 0x71, 0x18, 0x28, 0xd6, 0x1,  0x0,  0x12, 0xc7, 0x47, 0x39, 0x25, 0x89,
      0x45, 0x52, 0x3a, 0x84, 0xfc, 0x1a, 0x91, 0x29, 0x11, 0xee, 0xf3, 0x71, 0xf,  0x0,  0x0,  0x0,  0x0,  0x0,  0x1,
      0x6b, 0x1,  0x0,  0x1d, 0x97, 0xe4, 0x2d, 0x68, 0x32, 0x45, 0x91, 0x9b, 0x1e, 0x5b, 0x7,  0xb4, 0xc0, 0x7b, 0x57,
      0xf9, 0x12, 0x6b, 0xf1, 0xf6, 0x26, 0x4c, 0xbd, 0x92, 0xf,  0xe3, 0x50, 0xe9, 0x28, 0x1,  0x0,  0x0,  0x1,  0x0,
      0x0,  0x2,  0x0,  0x16, 0xbc, 0x80, 0x96, 0xf5, 0x41, 0xf1, 0xe8, 0xf7, 0xf6, 0x4b, 0xf2, 0xdd, 0x45, 0x92, 0x40,
      0xa6, 0x6e, 0x90, 0xb2, 0x56, 0x4d, 0x59, 0x1,  0x0,  0x1b, 0x5d, 0x21, 0x62, 0x9d, 0x84, 0xbe, 0xcf, 0x4b, 0x18,
      0xf0, 0xc4, 0x5,  0x18, 0xe0, 0xf6, 0xe,  0x52, 0x39, 0x43, 0x63, 0x46, 0xf2, 0xce, 0xd,  0xf8, 0x1d, 0x6a, 0x2};

  uint8_t buf[219] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0x51, 0xd,  0x89, 0x55, 0xbf, 0x7f, 0xa6, 0x3e, 0x63, 0x3c, 0x7e, 0xea,
                                     0xe5, 0xfb, 0xce, 0xf9, 0x74, 0x59, 0x76, 0xa1, 0x5c, 0x9a, 0x4f, 0x65, 0x53};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xdc, 0xfe, 0xc8, 0x2b, 0xde, 0x47, 0x0,  0xfe, 0xb3, 0x72,
                                     0x88, 0x7b, 0x4e, 0xb9, 0x4e, 0x97, 0x72, 0x4c, 0x93, 0x3,
                                     0xfb, 0x91, 0x70, 0xca, 0xb1, 0x81, 0xf4, 0xdc};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3b, 0x9a, 0xdc, 0x24, 0xa1, 0x63, 0x19, 0x18, 0xbb, 0x7e,
                                     0x19, 0x83, 0x2b, 0x16, 0xf2, 0xac, 0x71, 0x18, 0x28, 0xd6};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc7, 0x47, 0x39, 0x25, 0x89, 0x45, 0x52, 0x3a, 0x84,
                                     0xfc, 0x1a, 0x91, 0x29, 0x11, 0xee, 0xf3, 0x71, 0xf};
  lwmqtt_string_t topic_filter_s3 = {18, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0};
  lwmqtt_string_t topic_filter_s4 = {0, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6b};
  lwmqtt_string_t topic_filter_s5 = {1, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x97, 0xe4, 0x2d, 0x68, 0x32, 0x45, 0x91, 0x9b, 0x1e, 0x5b,
                                     0x7,  0xb4, 0xc0, 0x7b, 0x57, 0xf9, 0x12, 0x6b, 0xf1, 0xf6,
                                     0x26, 0x4c, 0xbd, 0x92, 0xf,  0xe3, 0x50, 0xe9, 0x28};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0};
  lwmqtt_string_t topic_filter_s8 = {0, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbc, 0x80, 0x96, 0xf5, 0x41, 0xf1, 0xe8, 0xf7, 0xf6, 0x4b, 0xf2,
                                     0xdd, 0x45, 0x92, 0x40, 0xa6, 0x6e, 0x90, 0xb2, 0x56, 0x4d, 0x59};
  lwmqtt_string_t topic_filter_s9 = {22, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x5d, 0x21, 0x62, 0x9d, 0x84, 0xbe, 0xcf, 0x4b, 0x18,
                                      0xf0, 0xc4, 0x5,  0x18, 0xe0, 0xf6, 0xe,  0x52, 0x39,
                                      0x43, 0x63, 0x46, 0xf2, 0xce, 0xd,  0xf8, 0x1d, 0x6a};
  lwmqtt_string_t topic_filter_s10 = {27, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 31688, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25984
// [("1\GS\194\RS\CAND\173\140\252\160\207\178\215*q\172o\165\DC3\n\250\129\USa\128\ETB\183\171",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\175\195N\144p\188x@x\190\233.LbP!\f{\DLEez\153\bs\DC3",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\246\&9\f\n\v\143znf!\192pb2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Vw\169\NUL\222V\237}\DLE\240t\249",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode2) {
  uint8_t pkt[] = {0x82, 0x5d, 0x65, 0x80, 0x0,  0x1c, 0x31, 0x1d, 0xc2, 0x1e, 0x18, 0x44, 0xad, 0x8c, 0xfc, 0xa0,
                   0xcf, 0xb2, 0xd7, 0x2a, 0x71, 0xac, 0x6f, 0xa5, 0x13, 0xa,  0xfa, 0x81, 0x1f, 0x61, 0x80, 0x17,
                   0xb7, 0xab, 0x1,  0x0,  0x19, 0xaf, 0xc3, 0x4e, 0x90, 0x70, 0xbc, 0x78, 0x40, 0x78, 0xbe, 0xe9,
                   0x2e, 0x4c, 0x62, 0x50, 0x21, 0xc,  0x7b, 0x10, 0x65, 0x7a, 0x99, 0x8,  0x73, 0x13, 0x2,  0x0,
                   0xe,  0xf6, 0x39, 0xc,  0xa,  0xb,  0x8f, 0x7a, 0x6e, 0x66, 0x21, 0xc0, 0x70, 0x62, 0x32, 0x2,
                   0x0,  0xc,  0x56, 0x77, 0xa9, 0x0,  0xde, 0x56, 0xed, 0x7d, 0x10, 0xf0, 0x74, 0xf9, 0x1};

  uint8_t buf[105] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x31, 0x1d, 0xc2, 0x1e, 0x18, 0x44, 0xad, 0x8c, 0xfc, 0xa0,
                                     0xcf, 0xb2, 0xd7, 0x2a, 0x71, 0xac, 0x6f, 0xa5, 0x13, 0xa,
                                     0xfa, 0x81, 0x1f, 0x61, 0x80, 0x17, 0xb7, 0xab};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaf, 0xc3, 0x4e, 0x90, 0x70, 0xbc, 0x78, 0x40, 0x78, 0xbe, 0xe9, 0x2e, 0x4c,
                                     0x62, 0x50, 0x21, 0xc,  0x7b, 0x10, 0x65, 0x7a, 0x99, 0x8,  0x73, 0x13};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf6, 0x39, 0xc, 0xa, 0xb, 0x8f, 0x7a, 0x6e, 0x66, 0x21, 0xc0, 0x70, 0x62, 0x32};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x56, 0x77, 0xa9, 0x0, 0xde, 0x56, 0xed, 0x7d, 0x10, 0xf0, 0x74, 0xf9};
  lwmqtt_string_t topic_filter_s3 = {12, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25984, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 15464
// [("\SOC\155\217\ESC\vJ\139\SOW\183\RS]\STX&\SUB\184\NUL\242J\186\165\165\204\&5\160\209\156\&9",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\248\143P2v\177\&2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("n\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal
// = False, _subQoS = QoS2}),("X\159\CAN\143\245\n\206y\DC4\135\DC4i\232`",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\DLEA\227\&5x\234\US\171",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\164\177\152\ETBhD\152\251\180\"\244\239\191\241\149\227}\183\&0",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\r@\174C\FSM$\180\212'\253\157\173\SOI9\204b",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("C\226\169\230)",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\145Tu\NUL\b\ESC\227",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode3) {
  uint8_t pkt[] = {0x82, 0x8a, 0x1,  0x3c, 0x68, 0x0,  0x1d, 0xe,  0x43, 0x9b, 0xd9, 0x1b, 0xb,  0x4a, 0x8b, 0xe,
                   0x57, 0xb7, 0x1e, 0x5d, 0x2,  0x26, 0x1a, 0xb8, 0x0,  0xf2, 0x4a, 0xba, 0xa5, 0xa5, 0xcc, 0x35,
                   0xa0, 0xd1, 0x9c, 0x39, 0x0,  0x0,  0x7,  0xf8, 0x8f, 0x50, 0x32, 0x76, 0xb1, 0x32, 0x2,  0x0,
                   0x2,  0x6e, 0xd2, 0x2,  0x0,  0xe,  0x58, 0x9f, 0x18, 0x8f, 0xf5, 0xa,  0xce, 0x79, 0x14, 0x87,
                   0x14, 0x69, 0xe8, 0x60, 0x2,  0x0,  0x8,  0x10, 0x41, 0xe3, 0x35, 0x78, 0xea, 0x1f, 0xab, 0x0,
                   0x0,  0x13, 0xa4, 0xb1, 0x98, 0x17, 0x68, 0x44, 0x98, 0xfb, 0xb4, 0x22, 0xf4, 0xef, 0xbf, 0xf1,
                   0x95, 0xe3, 0x7d, 0xb7, 0x30, 0x0,  0x0,  0x12, 0xd,  0x40, 0xae, 0x43, 0x1c, 0x4d, 0x24, 0xb4,
                   0xd4, 0x27, 0xfd, 0x9d, 0xad, 0xe,  0x49, 0x39, 0xcc, 0x62, 0x0,  0x0,  0x5,  0x43, 0xe2, 0xa9,
                   0xe6, 0x29, 0x0,  0x0,  0x7,  0x91, 0x54, 0x75, 0x0,  0x8,  0x1b, 0xe3, 0x1};

  uint8_t buf[151] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0xe,  0x43, 0x9b, 0xd9, 0x1b, 0xb,  0x4a, 0x8b, 0xe,  0x57,
                                     0xb7, 0x1e, 0x5d, 0x2,  0x26, 0x1a, 0xb8, 0x0,  0xf2, 0x4a,
                                     0xba, 0xa5, 0xa5, 0xcc, 0x35, 0xa0, 0xd1, 0x9c, 0x39};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf8, 0x8f, 0x50, 0x32, 0x76, 0xb1, 0x32};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x6e, 0xd2};
  lwmqtt_string_t topic_filter_s2 = {2, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x58, 0x9f, 0x18, 0x8f, 0xf5, 0xa, 0xce, 0x79, 0x14, 0x87, 0x14, 0x69, 0xe8, 0x60};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x10, 0x41, 0xe3, 0x35, 0x78, 0xea, 0x1f, 0xab};
  lwmqtt_string_t topic_filter_s4 = {8, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa4, 0xb1, 0x98, 0x17, 0x68, 0x44, 0x98, 0xfb, 0xb4, 0x22,
                                     0xf4, 0xef, 0xbf, 0xf1, 0x95, 0xe3, 0x7d, 0xb7, 0x30};
  lwmqtt_string_t topic_filter_s5 = {19, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd,  0x40, 0xae, 0x43, 0x1c, 0x4d, 0x24, 0xb4, 0xd4,
                                     0x27, 0xfd, 0x9d, 0xad, 0xe,  0x49, 0x39, 0xcc, 0x62};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x43, 0xe2, 0xa9, 0xe6, 0x29};
  lwmqtt_string_t topic_filter_s7 = {5, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x91, 0x54, 0x75, 0x0, 0x8, 0x1b, 0xe3};
  lwmqtt_string_t topic_filter_s8 = {7, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 15464, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 838 [("$-\227\252n\140N\241\225\146S\213\231(\193\150\248\177u\194",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode4) {
  uint8_t pkt[] = {0x82, 0x19, 0x3,  0x46, 0x0,  0x14, 0x24, 0x2d, 0xe3, 0xfc, 0x6e, 0x8c, 0x4e, 0xf1,
                   0xe1, 0x92, 0x53, 0xd5, 0xe7, 0x28, 0xc1, 0x96, 0xf8, 0xb1, 0x75, 0xc2, 0x1};

  uint8_t buf[37] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x24, 0x2d, 0xe3, 0xfc, 0x6e, 0x8c, 0x4e, 0xf1, 0xe1, 0x92,
                                     0x53, 0xd5, 0xe7, 0x28, 0xc1, 0x96, 0xf8, 0xb1, 0x75, 0xc2};
  lwmqtt_string_t topic_filter_s0 = {20, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 838, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16617 [("*\213.\SOH{\207\165\GS\FS\150\148]qq=A\239\234\252\189\STX;",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\210<\215\&2\177\181\232\211j\199\228\159~/\181X\SYN\136\205\\\253#",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\223[\223\187\180|\210;\149\229\164E",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS0}),("\133\253\223\167\156+\246\156\162\137\SYN\187I\v\233\SUB-\204P\169\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("1\b?\185o\135\176\195\173\ETB\161\156'\128M",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("6\129\247\STX\251H6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("#`\225\150-e~\189\179c\212Qv\226U\171q\201\244\186i\219\169\234\t\175",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NUL\136\CANO\SI\DEL\DC3\SYN\162\134\176\241\190eb\210\155",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\129>",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode5) {
  uint8_t pkt[] = {0x82, 0xad, 0x1,  0x40, 0xe9, 0x0,  0x16, 0x2a, 0xd5, 0x2e, 0x1,  0x7b, 0xcf, 0xa5, 0x1d, 0x1c,
                   0x96, 0x94, 0x5d, 0x71, 0x71, 0x3d, 0x41, 0xef, 0xea, 0xfc, 0xbd, 0x2,  0x3b, 0x2,  0x0,  0x16,
                   0xd2, 0x3c, 0xd7, 0x32, 0xb1, 0xb5, 0xe8, 0xd3, 0x6a, 0xc7, 0xe4, 0x9f, 0x7e, 0x2f, 0xb5, 0x58,
                   0x16, 0x88, 0xcd, 0x5c, 0xfd, 0x23, 0x1,  0x0,  0xc,  0xdf, 0x5b, 0xdf, 0xbb, 0xb4, 0x7c, 0xd2,
                   0x3b, 0x95, 0xe5, 0xa4, 0x45, 0x0,  0x0,  0x15, 0x85, 0xfd, 0xdf, 0xa7, 0x9c, 0x2b, 0xf6, 0x9c,
                   0xa2, 0x89, 0x16, 0xbb, 0x49, 0xb,  0xe9, 0x1a, 0x2d, 0xcc, 0x50, 0xa9, 0xe9, 0x0,  0x0,  0xf,
                   0x31, 0x8,  0x3f, 0xb9, 0x6f, 0x87, 0xb0, 0xc3, 0xad, 0x17, 0xa1, 0x9c, 0x27, 0x80, 0x4d, 0x2,
                   0x0,  0x7,  0x36, 0x81, 0xf7, 0x2,  0xfb, 0x48, 0x36, 0x0,  0x0,  0x1a, 0x23, 0x60, 0xe1, 0x96,
                   0x2d, 0x65, 0x7e, 0xbd, 0xb3, 0x63, 0xd4, 0x51, 0x76, 0xe2, 0x55, 0xab, 0x71, 0xc9, 0xf4, 0xba,
                   0x69, 0xdb, 0xa9, 0xea, 0x9,  0xaf, 0x0,  0x0,  0x11, 0x0,  0x88, 0x18, 0x4f, 0xf,  0x7f, 0x13,
                   0x16, 0xa2, 0x86, 0xb0, 0xf1, 0xbe, 0x65, 0x62, 0xd2, 0x9b, 0x1,  0x0,  0x2,  0x81, 0x3e, 0x1};

  uint8_t buf[186] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x2a, 0xd5, 0x2e, 0x1,  0x7b, 0xcf, 0xa5, 0x1d, 0x1c, 0x96, 0x94,
                                     0x5d, 0x71, 0x71, 0x3d, 0x41, 0xef, 0xea, 0xfc, 0xbd, 0x2,  0x3b};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd2, 0x3c, 0xd7, 0x32, 0xb1, 0xb5, 0xe8, 0xd3, 0x6a, 0xc7, 0xe4,
                                     0x9f, 0x7e, 0x2f, 0xb5, 0x58, 0x16, 0x88, 0xcd, 0x5c, 0xfd, 0x23};
  lwmqtt_string_t topic_filter_s1 = {22, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xdf, 0x5b, 0xdf, 0xbb, 0xb4, 0x7c, 0xd2, 0x3b, 0x95, 0xe5, 0xa4, 0x45};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x85, 0xfd, 0xdf, 0xa7, 0x9c, 0x2b, 0xf6, 0x9c, 0xa2, 0x89, 0x16,
                                     0xbb, 0x49, 0xb,  0xe9, 0x1a, 0x2d, 0xcc, 0x50, 0xa9, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x31, 0x8,  0x3f, 0xb9, 0x6f, 0x87, 0xb0, 0xc3,
                                     0xad, 0x17, 0xa1, 0x9c, 0x27, 0x80, 0x4d};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x36, 0x81, 0xf7, 0x2, 0xfb, 0x48, 0x36};
  lwmqtt_string_t topic_filter_s5 = {7, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x23, 0x60, 0xe1, 0x96, 0x2d, 0x65, 0x7e, 0xbd, 0xb3, 0x63, 0xd4, 0x51, 0x76,
                                     0xe2, 0x55, 0xab, 0x71, 0xc9, 0xf4, 0xba, 0x69, 0xdb, 0xa9, 0xea, 0x9,  0xaf};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x0,  0x88, 0x18, 0x4f, 0xf,  0x7f, 0x13, 0x16, 0xa2,
                                     0x86, 0xb0, 0xf1, 0xbe, 0x65, 0x62, 0xd2, 0x9b};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x81, 0x3e};
  lwmqtt_string_t topic_filter_s8 = {2, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 16617, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4070 [("\v\136/\233\EOT\FS\240\255\227\DC3q9\SI\SOH\\",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\170\176\237\215\202\131\&2\ESCK\136h\184\178\226\178}.\242",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode6) {
  uint8_t pkt[] = {0x82, 0x29, 0xf,  0xe6, 0x0,  0xf,  0xb,  0x88, 0x2f, 0xe9, 0x4,  0x1c, 0xf0, 0xff, 0xe3,
                   0x13, 0x71, 0x39, 0xf,  0x1,  0x5c, 0x1,  0x0,  0x12, 0xaa, 0xb0, 0xed, 0xd7, 0xca, 0x83,
                   0x32, 0x1b, 0x4b, 0x88, 0x68, 0xb8, 0xb2, 0xe2, 0xb2, 0x7d, 0x2e, 0xf2, 0x0};

  uint8_t buf[53] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xb,  0x88, 0x2f, 0xe9, 0x4, 0x1c, 0xf0, 0xff,
                                     0xe3, 0x13, 0x71, 0x39, 0xf, 0x1,  0x5c};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaa, 0xb0, 0xed, 0xd7, 0xca, 0x83, 0x32, 0x1b, 0x4b,
                                     0x88, 0x68, 0xb8, 0xb2, 0xe2, 0xb2, 0x7d, 0x2e, 0xf2};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4070, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1318 [("\141",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("(\232l\147\231\ETB\129\188\&6\207\SO\182\244\225\193S\228\&7\179\DEL\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\241\168\NUL\143\233m\184\163\STX\218\&8\156\252\250i\184C\188B\167\197\224A",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\177s\170{`\"e\RSr\DC3\r[\215\130\150\199q\253\216\221\231;\SYN",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\254*\164\NUL.\198\237\227\&3\143\SUB\248\248\162\t\167\n\146\232\250AK\234\220\178f\205\210\226",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\159}A_\221B\190\143\&5\n\NUL\186z)\143",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\r0\DC1\n\226K\201\177\128\US:\237o\241I\186d|",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Q\EM\214h\"_\196\253z\ACK\211F7\211D\144\NUL",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),(")\213\149\ACK",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode7) {
  uint8_t pkt[] = {0x82, 0xb4, 0x1,  0x5,  0x26, 0x0,  0x1,  0x8d, 0x2,  0x0,  0x15, 0x28, 0xe8, 0x6c, 0x93, 0xe7, 0x17,
                   0x81, 0xbc, 0x36, 0xcf, 0xe,  0xb6, 0xf4, 0xe1, 0xc1, 0x53, 0xe4, 0x37, 0xb3, 0x7f, 0xdc, 0x2,  0x0,
                   0x17, 0xf1, 0xa8, 0x0,  0x8f, 0xe9, 0x6d, 0xb8, 0xa3, 0x2,  0xda, 0x38, 0x9c, 0xfc, 0xfa, 0x69, 0xb8,
                   0x43, 0xbc, 0x42, 0xa7, 0xc5, 0xe0, 0x41, 0x2,  0x0,  0x17, 0xb1, 0x73, 0xaa, 0x7b, 0x60, 0x22, 0x65,
                   0x1e, 0x72, 0x13, 0xd,  0x5b, 0xd7, 0x82, 0x96, 0xc7, 0x71, 0xfd, 0xd8, 0xdd, 0xe7, 0x3b, 0x16, 0x2,
                   0x0,  0x1d, 0xfe, 0x2a, 0xa4, 0x0,  0x2e, 0xc6, 0xed, 0xe3, 0x33, 0x8f, 0x1a, 0xf8, 0xf8, 0xa2, 0x9,
                   0xa7, 0xa,  0x92, 0xe8, 0xfa, 0x41, 0x4b, 0xea, 0xdc, 0xb2, 0x66, 0xcd, 0xd2, 0xe2, 0x2,  0x0,  0xf,
                   0x9f, 0x7d, 0x41, 0x5f, 0xdd, 0x42, 0xbe, 0x8f, 0x35, 0xa,  0x0,  0xba, 0x7a, 0x29, 0x8f, 0x0,  0x0,
                   0x12, 0xd,  0x30, 0x11, 0xa,  0xe2, 0x4b, 0xc9, 0xb1, 0x80, 0x1f, 0x3a, 0xed, 0x6f, 0xf1, 0x49, 0xba,
                   0x64, 0x7c, 0x2,  0x0,  0x11, 0x51, 0x19, 0xd6, 0x68, 0x22, 0x5f, 0xc4, 0xfd, 0x7a, 0x6,  0xd3, 0x46,
                   0x37, 0xd3, 0x44, 0x90, 0x0,  0x1,  0x0,  0x4,  0x29, 0xd5, 0x95, 0x6,  0x2};

  uint8_t buf[193] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x8d};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x28, 0xe8, 0x6c, 0x93, 0xe7, 0x17, 0x81, 0xbc, 0x36, 0xcf, 0xe,
                                     0xb6, 0xf4, 0xe1, 0xc1, 0x53, 0xe4, 0x37, 0xb3, 0x7f, 0xdc};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf1, 0xa8, 0x0,  0x8f, 0xe9, 0x6d, 0xb8, 0xa3, 0x2,  0xda, 0x38, 0x9c,
                                     0xfc, 0xfa, 0x69, 0xb8, 0x43, 0xbc, 0x42, 0xa7, 0xc5, 0xe0, 0x41};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb1, 0x73, 0xaa, 0x7b, 0x60, 0x22, 0x65, 0x1e, 0x72, 0x13, 0xd, 0x5b,
                                     0xd7, 0x82, 0x96, 0xc7, 0x71, 0xfd, 0xd8, 0xdd, 0xe7, 0x3b, 0x16};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xfe, 0x2a, 0xa4, 0x0,  0x2e, 0xc6, 0xed, 0xe3, 0x33, 0x8f,
                                     0x1a, 0xf8, 0xf8, 0xa2, 0x9,  0xa7, 0xa,  0x92, 0xe8, 0xfa,
                                     0x41, 0x4b, 0xea, 0xdc, 0xb2, 0x66, 0xcd, 0xd2, 0xe2};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x9f, 0x7d, 0x41, 0x5f, 0xdd, 0x42, 0xbe, 0x8f,
                                     0x35, 0xa,  0x0,  0xba, 0x7a, 0x29, 0x8f};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd,  0x30, 0x11, 0xa,  0xe2, 0x4b, 0xc9, 0xb1, 0x80,
                                     0x1f, 0x3a, 0xed, 0x6f, 0xf1, 0x49, 0xba, 0x64, 0x7c};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x51, 0x19, 0xd6, 0x68, 0x22, 0x5f, 0xc4, 0xfd, 0x7a,
                                     0x6,  0xd3, 0x46, 0x37, 0xd3, 0x44, 0x90, 0x0};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x29, 0xd5, 0x95, 0x6};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1318, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4255
// [("\180\179\158\152\140\184\134\243\150\253\DELV\188\SIa\US\207\DEL\234C\tl\186p*M\209\246\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("/\140^\ESC#\181^Ia%o\229mJ\166XA\DELA\183l;S_l\133^",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\159\&8\162\SYN\188\181",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\253\&9-\SOH\n\189\207\219",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode8) {
  uint8_t pkt[] = {0x82, 0x54, 0x10, 0x9f, 0x0,  0x1d, 0xb4, 0xb3, 0x9e, 0x98, 0x8c, 0xb8, 0x86, 0xf3, 0x96,
                   0xfd, 0x7f, 0x56, 0xbc, 0xf,  0x61, 0x1f, 0xcf, 0x7f, 0xea, 0x43, 0x9,  0x6c, 0xba, 0x70,
                   0x2a, 0x4d, 0xd1, 0xf6, 0xa2, 0x0,  0x0,  0x1b, 0x2f, 0x8c, 0x5e, 0x1b, 0x23, 0xb5, 0x5e,
                   0x49, 0x61, 0x25, 0x6f, 0xe5, 0x6d, 0x4a, 0xa6, 0x58, 0x41, 0x7f, 0x41, 0xb7, 0x6c, 0x3b,
                   0x53, 0x5f, 0x6c, 0x85, 0x5e, 0x0,  0x0,  0x6,  0x9f, 0x38, 0xa2, 0x16, 0xbc, 0xb5, 0x1,
                   0x0,  0x8,  0xfd, 0x39, 0x2d, 0x1,  0xa,  0xbd, 0xcf, 0xdb, 0x1};

  uint8_t buf[96] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xb4, 0xb3, 0x9e, 0x98, 0x8c, 0xb8, 0x86, 0xf3, 0x96, 0xfd,
                                     0x7f, 0x56, 0xbc, 0xf,  0x61, 0x1f, 0xcf, 0x7f, 0xea, 0x43,
                                     0x9,  0x6c, 0xba, 0x70, 0x2a, 0x4d, 0xd1, 0xf6, 0xa2};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2f, 0x8c, 0x5e, 0x1b, 0x23, 0xb5, 0x5e, 0x49, 0x61, 0x25, 0x6f, 0xe5, 0x6d, 0x4a,
                                     0xa6, 0x58, 0x41, 0x7f, 0x41, 0xb7, 0x6c, 0x3b, 0x53, 0x5f, 0x6c, 0x85, 0x5e};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9f, 0x38, 0xa2, 0x16, 0xbc, 0xb5};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfd, 0x39, 0x2d, 0x1, 0xa, 0xbd, 0xcf, 0xdb};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4255, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8790 [("BZ_)",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\244x\187\186\255\245oy\163<\181\242J3\202-",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("'8\171[\231\210\133\201\GSP\238\199\163'\182bO@\226\RS?\SO@\244uRA\SI2",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("W\239\192\&2\217\184?\141\&7\FSL",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\200h\214",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\187\DC2\tI\174\251I\ETB\FS\NAK\148\DC4\136Je\193|\216V)j",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode9) {
  uint8_t pkt[] = {0x82, 0x68, 0x22, 0x56, 0x0,  0x4,  0x42, 0x5a, 0x5f, 0x29, 0x0,  0x0,  0x10, 0xf4, 0x78, 0xbb,
                   0xba, 0xff, 0xf5, 0x6f, 0x79, 0xa3, 0x3c, 0xb5, 0xf2, 0x4a, 0x33, 0xca, 0x2d, 0x0,  0x0,  0x1d,
                   0x27, 0x38, 0xab, 0x5b, 0xe7, 0xd2, 0x85, 0xc9, 0x1d, 0x50, 0xee, 0xc7, 0xa3, 0x27, 0xb6, 0x62,
                   0x4f, 0x40, 0xe2, 0x1e, 0x3f, 0xe,  0x40, 0xf4, 0x75, 0x52, 0x41, 0xf,  0x32, 0x2,  0x0,  0xb,
                   0x57, 0xef, 0xc0, 0x32, 0xd9, 0xb8, 0x3f, 0x8d, 0x37, 0x1c, 0x4c, 0x2,  0x0,  0x3,  0xc8, 0x68,
                   0xd6, 0x0,  0x0,  0x15, 0xbb, 0x12, 0x9,  0x49, 0xae, 0xfb, 0x49, 0x17, 0x1c, 0x15, 0x94, 0x14,
                   0x88, 0x4a, 0x65, 0xc1, 0x7c, 0xd8, 0x56, 0x29, 0x6a, 0x0};

  uint8_t buf[116] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x42, 0x5a, 0x5f, 0x29};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf4, 0x78, 0xbb, 0xba, 0xff, 0xf5, 0x6f, 0x79,
                                     0xa3, 0x3c, 0xb5, 0xf2, 0x4a, 0x33, 0xca, 0x2d};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x27, 0x38, 0xab, 0x5b, 0xe7, 0xd2, 0x85, 0xc9, 0x1d, 0x50,
                                     0xee, 0xc7, 0xa3, 0x27, 0xb6, 0x62, 0x4f, 0x40, 0xe2, 0x1e,
                                     0x3f, 0xe,  0x40, 0xf4, 0x75, 0x52, 0x41, 0xf,  0x32};
  lwmqtt_string_t topic_filter_s2 = {29, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x57, 0xef, 0xc0, 0x32, 0xd9, 0xb8, 0x3f, 0x8d, 0x37, 0x1c, 0x4c};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc8, 0x68, 0xd6};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xbb, 0x12, 0x9,  0x49, 0xae, 0xfb, 0x49, 0x17, 0x1c, 0x15, 0x94,
                                     0x14, 0x88, 0x4a, 0x65, 0xc1, 0x7c, 0xd8, 0x56, 0x29, 0x6a};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 8790, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28419 [("\172\146\187b\165\234\194\249&",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("&\154ju i",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\196\DC4\v\a\177\139Fn\195",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("m\205\237M\200/\184hq79.3\134,\188\154\r\211\201\143\CAN\223\SYN
// \200v\164<",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ENQ\241`\255\207+~",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode10) {
  uint8_t pkt[] = {0x82, 0x4d, 0x6f, 0x3,  0x0,  0x9,  0xac, 0x92, 0xbb, 0x62, 0xa5, 0xea, 0xc2, 0xf9, 0x26, 0x0,
                   0x0,  0x6,  0x26, 0x9a, 0x6a, 0x75, 0x20, 0x69, 0x1,  0x0,  0x9,  0xc4, 0x14, 0xb,  0x7,  0xb1,
                   0x8b, 0x46, 0x6e, 0xc3, 0x1,  0x0,  0x1d, 0x6d, 0xcd, 0xed, 0x4d, 0xc8, 0x2f, 0xb8, 0x68, 0x71,
                   0x37, 0x39, 0x2e, 0x33, 0x86, 0x2c, 0xbc, 0x9a, 0xd,  0xd3, 0xc9, 0x8f, 0x18, 0xdf, 0x16, 0x20,
                   0xc8, 0x76, 0xa4, 0x3c, 0x1,  0x0,  0x7,  0x5,  0xf1, 0x60, 0xff, 0xcf, 0x2b, 0x7e, 0x1};

  uint8_t buf[89] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xac, 0x92, 0xbb, 0x62, 0xa5, 0xea, 0xc2, 0xf9, 0x26};
  lwmqtt_string_t topic_filter_s0 = {9, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x26, 0x9a, 0x6a, 0x75, 0x20, 0x69};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc4, 0x14, 0xb, 0x7, 0xb1, 0x8b, 0x46, 0x6e, 0xc3};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6d, 0xcd, 0xed, 0x4d, 0xc8, 0x2f, 0xb8, 0x68, 0x71, 0x37,
                                     0x39, 0x2e, 0x33, 0x86, 0x2c, 0xbc, 0x9a, 0xd,  0xd3, 0xc9,
                                     0x8f, 0x18, 0xdf, 0x16, 0x20, 0xc8, 0x76, 0xa4, 0x3c};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5, 0xf1, 0x60, 0xff, 0xcf, 0x2b, 0x7e};
  lwmqtt_string_t topic_filter_s4 = {7, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 28419, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 5081 [("Zq\ETB\209",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS0}),("\254\248\251$\238\158f\176\218\152\154A\147\STX^\184'w\188\&2{\US\165I\vF\139",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\164\143V*3\253\171\214\141x.\184\242l\217\&2\255\ENQ",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\171E\173\162L\158>9\a\202\138\223Jb{\170Y8\RS\137\226\166I\177J",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\185\188",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode11) {
  uint8_t pkt[] = {0x82, 0x60, 0x13, 0xd9, 0x0,  0x4,  0x5a, 0x71, 0x17, 0xd1, 0x0,  0x0,  0x1b, 0xfe, 0xf8, 0xfb, 0x24,
                   0xee, 0x9e, 0x66, 0xb0, 0xda, 0x98, 0x9a, 0x41, 0x93, 0x2,  0x5e, 0xb8, 0x27, 0x77, 0xbc, 0x32, 0x7b,
                   0x1f, 0xa5, 0x49, 0xb,  0x46, 0x8b, 0x1,  0x0,  0x12, 0xa4, 0x8f, 0x56, 0x2a, 0x33, 0xfd, 0xab, 0xd6,
                   0x8d, 0x78, 0x2e, 0xb8, 0xf2, 0x6c, 0xd9, 0x32, 0xff, 0x5,  0x1,  0x0,  0x19, 0xab, 0x45, 0xad, 0xa2,
                   0x4c, 0x9e, 0x3e, 0x39, 0x7,  0xca, 0x8a, 0xdf, 0x4a, 0x62, 0x7b, 0xaa, 0x59, 0x38, 0x1e, 0x89, 0xe2,
                   0xa6, 0x49, 0xb1, 0x4a, 0x2,  0x0,  0x2,  0xb9, 0xbc, 0x2,  0x0,  0x0,  0x1};

  uint8_t buf[108] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x5a, 0x71, 0x17, 0xd1};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xfe, 0xf8, 0xfb, 0x24, 0xee, 0x9e, 0x66, 0xb0, 0xda, 0x98, 0x9a, 0x41, 0x93, 0x2,
                                     0x5e, 0xb8, 0x27, 0x77, 0xbc, 0x32, 0x7b, 0x1f, 0xa5, 0x49, 0xb,  0x46, 0x8b};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa4, 0x8f, 0x56, 0x2a, 0x33, 0xfd, 0xab, 0xd6, 0x8d,
                                     0x78, 0x2e, 0xb8, 0xf2, 0x6c, 0xd9, 0x32, 0xff, 0x5};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xab, 0x45, 0xad, 0xa2, 0x4c, 0x9e, 0x3e, 0x39, 0x7,  0xca, 0x8a, 0xdf, 0x4a,
                                     0x62, 0x7b, 0xaa, 0x59, 0x38, 0x1e, 0x89, 0xe2, 0xa6, 0x49, 0xb1, 0x4a};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xb9, 0xbc};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 5081, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25469 [("\196\234\233C\245\STX\229\154\t\US\r\b&>F\213\130\&4",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("}\ENQ\233z\235\223\134Z\220y\220\255\ACK\f8\r\211\178\171\145=\183\148\DC4\187{S:\215\247",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("SL0j\ENQ\STX\v\178\243,\155\168-3\RS*R\246\NAK\134f)\183\196",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\t\185T\132Z\205GI\DC2\146\156\233\201\134k\142\168\247\201=\179\134\&1",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\200\160\129\198|>\238\159\254\255\CANc\149\154\139\167#\234n",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\169\216=\154v",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("9\254'\139~\175N\ETX\172\240\223\&5^\171\"\163\222\225*\182\&2,\254\&6\174\EM2\f\227",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("o\SOH\195\158\&0R\138\250",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\EM\SYN\174\218\152k\247\&5i_\205`,\fm*\131_",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\163n)\179A=<\NUL\US\199\129\163\137+u",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode12) {
  uint8_t pkt[] = {
      0x82, 0xe0, 0x1,  0x63, 0x7d, 0x0,  0x12, 0xc4, 0xea, 0xe9, 0x43, 0xf5, 0x2,  0xe5, 0x9a, 0x9,  0x1f, 0xd,  0x8,
      0x26, 0x3e, 0x46, 0xd5, 0x82, 0x34, 0x1,  0x0,  0x1e, 0x7d, 0x5,  0xe9, 0x7a, 0xeb, 0xdf, 0x86, 0x5a, 0xdc, 0x79,
      0xdc, 0xff, 0x6,  0xc,  0x38, 0xd,  0xd3, 0xb2, 0xab, 0x91, 0x3d, 0xb7, 0x94, 0x14, 0xbb, 0x7b, 0x53, 0x3a, 0xd7,
      0xf7, 0x2,  0x0,  0x18, 0x53, 0x4c, 0x30, 0x6a, 0x5,  0x2,  0xb,  0xb2, 0xf3, 0x2c, 0x9b, 0xa8, 0x2d, 0x33, 0x1e,
      0x2a, 0x52, 0xf6, 0x15, 0x86, 0x66, 0x29, 0xb7, 0xc4, 0x2,  0x0,  0x17, 0x9,  0xb9, 0x54, 0x84, 0x5a, 0xcd, 0x47,
      0x49, 0x12, 0x92, 0x9c, 0xe9, 0xc9, 0x86, 0x6b, 0x8e, 0xa8, 0xf7, 0xc9, 0x3d, 0xb3, 0x86, 0x31, 0x1,  0x0,  0x13,
      0xc8, 0xa0, 0x81, 0xc6, 0x7c, 0x3e, 0xee, 0x9f, 0xfe, 0xff, 0x18, 0x63, 0x95, 0x9a, 0x8b, 0xa7, 0x23, 0xea, 0x6e,
      0x2,  0x0,  0x5,  0xa9, 0xd8, 0x3d, 0x9a, 0x76, 0x1,  0x0,  0x1d, 0x39, 0xfe, 0x27, 0x8b, 0x7e, 0xaf, 0x4e, 0x3,
      0xac, 0xf0, 0xdf, 0x35, 0x5e, 0xab, 0x22, 0xa3, 0xde, 0xe1, 0x2a, 0xb6, 0x32, 0x2c, 0xfe, 0x36, 0xae, 0x19, 0x32,
      0xc,  0xe3, 0x2,  0x0,  0x8,  0x6f, 0x1,  0xc3, 0x9e, 0x30, 0x52, 0x8a, 0xfa, 0x0,  0x0,  0x12, 0x19, 0x16, 0xae,
      0xda, 0x98, 0x6b, 0xf7, 0x35, 0x69, 0x5f, 0xcd, 0x60, 0x2c, 0xc,  0x6d, 0x2a, 0x83, 0x5f, 0x2,  0x0,  0xf,  0xa3,
      0x6e, 0x29, 0xb3, 0x41, 0x3d, 0x3c, 0x0,  0x1f, 0xc7, 0x81, 0xa3, 0x89, 0x2b, 0x75, 0x0,  0x0,  0x0,  0x2};

  uint8_t buf[237] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0xea, 0xe9, 0x43, 0xf5, 0x2,  0xe5, 0x9a, 0x9,
                                     0x1f, 0xd,  0x8,  0x26, 0x3e, 0x46, 0xd5, 0x82, 0x34};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7d, 0x5,  0xe9, 0x7a, 0xeb, 0xdf, 0x86, 0x5a, 0xdc, 0x79,
                                     0xdc, 0xff, 0x6,  0xc,  0x38, 0xd,  0xd3, 0xb2, 0xab, 0x91,
                                     0x3d, 0xb7, 0x94, 0x14, 0xbb, 0x7b, 0x53, 0x3a, 0xd7, 0xf7};
  lwmqtt_string_t topic_filter_s1 = {30, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x4c, 0x30, 0x6a, 0x5,  0x2,  0xb,  0xb2, 0xf3, 0x2c, 0x9b, 0xa8,
                                     0x2d, 0x33, 0x1e, 0x2a, 0x52, 0xf6, 0x15, 0x86, 0x66, 0x29, 0xb7, 0xc4};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x9,  0xb9, 0x54, 0x84, 0x5a, 0xcd, 0x47, 0x49, 0x12, 0x92, 0x9c, 0xe9,
                                     0xc9, 0x86, 0x6b, 0x8e, 0xa8, 0xf7, 0xc9, 0x3d, 0xb3, 0x86, 0x31};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc8, 0xa0, 0x81, 0xc6, 0x7c, 0x3e, 0xee, 0x9f, 0xfe, 0xff,
                                     0x18, 0x63, 0x95, 0x9a, 0x8b, 0xa7, 0x23, 0xea, 0x6e};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa9, 0xd8, 0x3d, 0x9a, 0x76};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x39, 0xfe, 0x27, 0x8b, 0x7e, 0xaf, 0x4e, 0x3,  0xac, 0xf0,
                                     0xdf, 0x35, 0x5e, 0xab, 0x22, 0xa3, 0xde, 0xe1, 0x2a, 0xb6,
                                     0x32, 0x2c, 0xfe, 0x36, 0xae, 0x19, 0x32, 0xc,  0xe3};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x6f, 0x1, 0xc3, 0x9e, 0x30, 0x52, 0x8a, 0xfa};
  lwmqtt_string_t topic_filter_s7 = {8, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x19, 0x16, 0xae, 0xda, 0x98, 0x6b, 0xf7, 0x35, 0x69,
                                     0x5f, 0xcd, 0x60, 0x2c, 0xc,  0x6d, 0x2a, 0x83, 0x5f};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xa3, 0x6e, 0x29, 0xb3, 0x41, 0x3d, 0x3c, 0x0,
                                     0x1f, 0xc7, 0x81, 0xa3, 0x89, 0x2b, 0x75};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0};
  lwmqtt_string_t topic_filter_s10 = {0, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25469, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14214 [("96\SIk\238a\SI\ETX\203\216\176fgS\149\148\229\206$",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\242\218\225YA\243\153\247\189I",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("1\141\ENQ\206\182U",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode13) {
  uint8_t pkt[] = {0x82, 0x32, 0x37, 0x86, 0x0,  0x13, 0x39, 0x36, 0xf,  0x6b, 0xee, 0x61, 0xf,
                   0x3,  0xcb, 0xd8, 0xb0, 0x66, 0x67, 0x53, 0x95, 0x94, 0xe5, 0xce, 0x24, 0x2,
                   0x0,  0xa,  0xf2, 0xda, 0xe1, 0x59, 0x41, 0xf3, 0x99, 0xf7, 0xbd, 0x49, 0x1,
                   0x0,  0x1,  0xeb, 0x0,  0x0,  0x6,  0x31, 0x8d, 0x5,  0xce, 0xb6, 0x55, 0x0};

  uint8_t buf[62] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x39, 0x36, 0xf,  0x6b, 0xee, 0x61, 0xf,  0x3,  0xcb, 0xd8,
                                     0xb0, 0x66, 0x67, 0x53, 0x95, 0x94, 0xe5, 0xce, 0x24};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf2, 0xda, 0xe1, 0x59, 0x41, 0xf3, 0x99, 0xf7, 0xbd, 0x49};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xeb};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x31, 0x8d, 0x5, 0xce, 0xb6, 0x55};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14214, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 26235 [("\DLE",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("m;1\220gk`\169\152\251",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\SIj6\144\200ar\STX",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\241c\229\NULx\190Q\SYN",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode14) {
  uint8_t pkt[] = {0x82, 0x29, 0x66, 0x7b, 0x0,  0x1,  0x10, 0x1, 0x0,  0xa,  0x6d, 0x3b, 0x31, 0xdc, 0x67,
                   0x6b, 0x60, 0xa9, 0x98, 0xfb, 0x1,  0x0,  0x8, 0xf,  0x6a, 0x36, 0x90, 0xc8, 0x61, 0x72,
                   0x2,  0x0,  0x0,  0x8,  0xf1, 0x63, 0xe5, 0x0, 0x78, 0xbe, 0x51, 0x16, 0x0};

  uint8_t buf[53] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x10};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6d, 0x3b, 0x31, 0xdc, 0x67, 0x6b, 0x60, 0xa9, 0x98, 0xfb};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf, 0x6a, 0x36, 0x90, 0xc8, 0x61, 0x72, 0x2};
  lwmqtt_string_t topic_filter_s2 = {8, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf1, 0x63, 0xe5, 0x0, 0x78, 0xbe, 0x51, 0x16};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 26235, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10474 [("\ACK\214li.\ESC\US;<O]t>\201}3\165",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\152\173{\218\168a\184Y_y\149\241F:y\188",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\147\ESC\141H\166\226\230G\180\252\198\196\GS",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\236\183\RSM\169v\254\179TT7\211\194\132\161fbQ\218\US\135\202\f\149E\197\197\SOHuK",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("3\179|)\222p\245\SUB\197\v\182\RSnw#\225\157t\ETX\DC2E",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\233\213\221\219\SUB0\164J\162\185\156\230\230\&5\156\244\133",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("d\NULN\129\242u`\152\ACK\DEL_\164\207\168\191T\132\177\"\FS*",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\136f7w\182\132'",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\220w'\179\FSxy\194[@\163;",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("9H\134H\191\242[\206S\129\162\243\244Kw$",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode15) {
  uint8_t pkt[] = {
      0x82, 0xca, 0x1,  0x28, 0xea, 0x0,  0x11, 0x6,  0xd6, 0x6c, 0x69, 0x2e, 0x1b, 0x1f, 0x3b, 0x3c, 0x4f, 0x5d, 0x74,
      0x3e, 0xc9, 0x7d, 0x33, 0xa5, 0x0,  0x0,  0x10, 0x98, 0xad, 0x7b, 0xda, 0xa8, 0x61, 0xb8, 0x59, 0x5f, 0x79, 0x95,
      0xf1, 0x46, 0x3a, 0x79, 0xbc, 0x2,  0x0,  0xd,  0x93, 0x1b, 0x8d, 0x48, 0xa6, 0xe2, 0xe6, 0x47, 0xb4, 0xfc, 0xc6,
      0xc4, 0x1d, 0x2,  0x0,  0x1e, 0xec, 0xb7, 0x1e, 0x4d, 0xa9, 0x76, 0xfe, 0xb3, 0x54, 0x54, 0x37, 0xd3, 0xc2, 0x84,
      0xa1, 0x66, 0x62, 0x51, 0xda, 0x1f, 0x87, 0xca, 0xc,  0x95, 0x45, 0xc5, 0xc5, 0x1,  0x75, 0x4b, 0x0,  0x0,  0x15,
      0x33, 0xb3, 0x7c, 0x29, 0xde, 0x70, 0xf5, 0x1a, 0xc5, 0xb,  0xb6, 0x1e, 0x6e, 0x77, 0x23, 0xe1, 0x9d, 0x74, 0x3,
      0x12, 0x45, 0x1,  0x0,  0x11, 0xe9, 0xd5, 0xdd, 0xdb, 0x1a, 0x30, 0xa4, 0x4a, 0xa2, 0xb9, 0x9c, 0xe6, 0xe6, 0x35,
      0x9c, 0xf4, 0x85, 0x2,  0x0,  0x15, 0x64, 0x0,  0x4e, 0x81, 0xf2, 0x75, 0x60, 0x98, 0x6,  0x7f, 0x5f, 0xa4, 0xcf,
      0xa8, 0xbf, 0x54, 0x84, 0xb1, 0x22, 0x1c, 0x2a, 0x2,  0x0,  0x7,  0x88, 0x66, 0x37, 0x77, 0xb6, 0x84, 0x27, 0x2,
      0x0,  0xc,  0xdc, 0x77, 0x27, 0xb3, 0x1c, 0x78, 0x79, 0xc2, 0x5b, 0x40, 0xa3, 0x3b, 0x2,  0x0,  0x10, 0x39, 0x48,
      0x86, 0x48, 0xbf, 0xf2, 0x5b, 0xce, 0x53, 0x81, 0xa2, 0xf3, 0xf4, 0x4b, 0x77, 0x24, 0x1};

  uint8_t buf[215] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x6,  0xd6, 0x6c, 0x69, 0x2e, 0x1b, 0x1f, 0x3b, 0x3c,
                                     0x4f, 0x5d, 0x74, 0x3e, 0xc9, 0x7d, 0x33, 0xa5};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x98, 0xad, 0x7b, 0xda, 0xa8, 0x61, 0xb8, 0x59,
                                     0x5f, 0x79, 0x95, 0xf1, 0x46, 0x3a, 0x79, 0xbc};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x93, 0x1b, 0x8d, 0x48, 0xa6, 0xe2, 0xe6, 0x47, 0xb4, 0xfc, 0xc6, 0xc4, 0x1d};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xec, 0xb7, 0x1e, 0x4d, 0xa9, 0x76, 0xfe, 0xb3, 0x54, 0x54,
                                     0x37, 0xd3, 0xc2, 0x84, 0xa1, 0x66, 0x62, 0x51, 0xda, 0x1f,
                                     0x87, 0xca, 0xc,  0x95, 0x45, 0xc5, 0xc5, 0x1,  0x75, 0x4b};
  lwmqtt_string_t topic_filter_s3 = {30, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x33, 0xb3, 0x7c, 0x29, 0xde, 0x70, 0xf5, 0x1a, 0xc5, 0xb, 0xb6,
                                     0x1e, 0x6e, 0x77, 0x23, 0xe1, 0x9d, 0x74, 0x3,  0x12, 0x45};
  lwmqtt_string_t topic_filter_s4 = {21, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe9, 0xd5, 0xdd, 0xdb, 0x1a, 0x30, 0xa4, 0x4a, 0xa2,
                                     0xb9, 0x9c, 0xe6, 0xe6, 0x35, 0x9c, 0xf4, 0x85};
  lwmqtt_string_t topic_filter_s5 = {17, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x64, 0x0,  0x4e, 0x81, 0xf2, 0x75, 0x60, 0x98, 0x6,  0x7f, 0x5f,
                                     0xa4, 0xcf, 0xa8, 0xbf, 0x54, 0x84, 0xb1, 0x22, 0x1c, 0x2a};
  lwmqtt_string_t topic_filter_s6 = {21, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x88, 0x66, 0x37, 0x77, 0xb6, 0x84, 0x27};
  lwmqtt_string_t topic_filter_s7 = {7, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdc, 0x77, 0x27, 0xb3, 0x1c, 0x78, 0x79, 0xc2, 0x5b, 0x40, 0xa3, 0x3b};
  lwmqtt_string_t topic_filter_s8 = {12, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x39, 0x48, 0x86, 0x48, 0xbf, 0xf2, 0x5b, 0xce,
                                     0x53, 0x81, 0xa2, 0xf3, 0xf4, 0x4b, 0x77, 0x24};
  lwmqtt_string_t topic_filter_s9 = {16, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10474, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3250 [("x\215}:\240\130\FS\DC3r\185\253t\214\&4\231\195dG<\187\f",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\ETB\236&\173\154\233\&7\EOT~",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("!\CAN\STX\GSG;\179\203\n\224\213",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\208d*\128\&7+\217w\"\f\250\ENQ\189\159\234\236\247\238\ACK0\195",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\155\218X\182O\200\175-#",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\219\217L\214\219",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("A\235\201\159~{C\168\132nu\ETB",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\159jI\215+\216\176`\223\230\169\155\239\249q6",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode16) {
  uint8_t pkt[] = {0x82, 0x82, 0x1,  0xc,  0xb2, 0x0,  0x15, 0x78, 0xd7, 0x7d, 0x3a, 0xf0, 0x82, 0x1c, 0x13, 0x72, 0xb9,
                   0xfd, 0x74, 0xd6, 0x34, 0xe7, 0xc3, 0x64, 0x47, 0x3c, 0xbb, 0xc,  0x0,  0x0,  0x9,  0x17, 0xec, 0x26,
                   0xad, 0x9a, 0xe9, 0x37, 0x4,  0x7e, 0x2,  0x0,  0xb,  0x21, 0x18, 0x2,  0x1d, 0x47, 0x3b, 0xb3, 0xcb,
                   0xa,  0xe0, 0xd5, 0x0,  0x0,  0x15, 0xd0, 0x64, 0x2a, 0x80, 0x37, 0x2b, 0xd9, 0x77, 0x22, 0xc,  0xfa,
                   0x5,  0xbd, 0x9f, 0xea, 0xec, 0xf7, 0xee, 0x6,  0x30, 0xc3, 0x0,  0x0,  0x9,  0x9b, 0xda, 0x58, 0xb6,
                   0x4f, 0xc8, 0xaf, 0x2d, 0x23, 0x1,  0x0,  0x5,  0xdb, 0xd9, 0x4c, 0xd6, 0xdb, 0x1,  0x0,  0xc,  0x41,
                   0xeb, 0xc9, 0x9f, 0x7e, 0x7b, 0x43, 0xa8, 0x84, 0x6e, 0x75, 0x17, 0x1,  0x0,  0x10, 0x9f, 0x6a, 0x49,
                   0xd7, 0x2b, 0xd8, 0xb0, 0x60, 0xdf, 0xe6, 0xa9, 0x9b, 0xef, 0xf9, 0x71, 0x36, 0x1};

  uint8_t buf[143] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x78, 0xd7, 0x7d, 0x3a, 0xf0, 0x82, 0x1c, 0x13, 0x72, 0xb9, 0xfd,
                                     0x74, 0xd6, 0x34, 0xe7, 0xc3, 0x64, 0x47, 0x3c, 0xbb, 0xc};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x17, 0xec, 0x26, 0xad, 0x9a, 0xe9, 0x37, 0x4, 0x7e};
  lwmqtt_string_t topic_filter_s1 = {9, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x21, 0x18, 0x2, 0x1d, 0x47, 0x3b, 0xb3, 0xcb, 0xa, 0xe0, 0xd5};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd0, 0x64, 0x2a, 0x80, 0x37, 0x2b, 0xd9, 0x77, 0x22, 0xc, 0xfa,
                                     0x5,  0xbd, 0x9f, 0xea, 0xec, 0xf7, 0xee, 0x6,  0x30, 0xc3};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0xda, 0x58, 0xb6, 0x4f, 0xc8, 0xaf, 0x2d, 0x23};
  lwmqtt_string_t topic_filter_s4 = {9, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xdb, 0xd9, 0x4c, 0xd6, 0xdb};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x41, 0xeb, 0xc9, 0x9f, 0x7e, 0x7b, 0x43, 0xa8, 0x84, 0x6e, 0x75, 0x17};
  lwmqtt_string_t topic_filter_s6 = {12, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x9f, 0x6a, 0x49, 0xd7, 0x2b, 0xd8, 0xb0, 0x60,
                                     0xdf, 0xe6, 0xa9, 0x9b, 0xef, 0xf9, 0x71, 0x36};
  lwmqtt_string_t topic_filter_s7 = {16, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 3250, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12034
// [("\128.\143\172\255%\203\247\222\207O\146%X\169\204g\245\223\SUB\150#\190tM\173Fw9",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode17) {
  uint8_t pkt[] = {0x82, 0x22, 0x2f, 0x2,  0x0,  0x1d, 0x80, 0x2e, 0x8f, 0xac, 0xff, 0x25,
                   0xcb, 0xf7, 0xde, 0xcf, 0x4f, 0x92, 0x25, 0x58, 0xa9, 0xcc, 0x67, 0xf5,
                   0xdf, 0x1a, 0x96, 0x23, 0xbe, 0x74, 0x4d, 0xad, 0x46, 0x77, 0x39, 0x0};

  uint8_t buf[46] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x80, 0x2e, 0x8f, 0xac, 0xff, 0x25, 0xcb, 0xf7, 0xde, 0xcf,
                                     0x4f, 0x92, 0x25, 0x58, 0xa9, 0xcc, 0x67, 0xf5, 0xdf, 0x1a,
                                     0x96, 0x23, 0xbe, 0x74, 0x4d, 0xad, 0x46, 0x77, 0x39};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12034, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4596 [("7\239\237\148",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\201\SI~\174\182\156;o{\142",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\219\b\DLE\SYN\228sb\177\143\195\230o<\196\246f=B",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\135\224?\NUL\161\188\134E\172\&4>1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),(".\233\181Y\146\&6\140\157\t\205\161Mo\215\&5\186\RSB_\ACK\219\186\f\238",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("1\174\&9\253\135o\201\235\GS\243\240\SYN\177jUy\141\218\158\251\232Pg\161\SYN\SO\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\137\&5u\EOT\209\DC4e\177\194H\NAKp;Q\228\b\149\178\182\140\217>!\",\FS\154\163\&1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\189r\185K\155\247:&\129\FS}\SUB\136\205\198gm\202\183|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode18) {
  uint8_t pkt[] = {0x82, 0xb1, 0x1,  0x11, 0xf4, 0x0,  0x4,  0x37, 0xef, 0xed, 0x94, 0x2,  0x0,  0x0,  0x1,  0x0,  0x1,
                   0xce, 0x2,  0x0,  0xa,  0xc9, 0xf,  0x7e, 0xae, 0xb6, 0x9c, 0x3b, 0x6f, 0x7b, 0x8e, 0x1,  0x0,  0x12,
                   0xdb, 0x8,  0x10, 0x16, 0xe4, 0x73, 0x62, 0xb1, 0x8f, 0xc3, 0xe6, 0x6f, 0x3c, 0xc4, 0xf6, 0x66, 0x3d,
                   0x42, 0x2,  0x0,  0xc,  0x87, 0xe0, 0x3f, 0x0,  0xa1, 0xbc, 0x86, 0x45, 0xac, 0x34, 0x3e, 0x31, 0x2,
                   0x0,  0x18, 0x2e, 0xe9, 0xb5, 0x59, 0x92, 0x36, 0x8c, 0x9d, 0x9,  0xcd, 0xa1, 0x4d, 0x6f, 0xd7, 0x35,
                   0xba, 0x1e, 0x42, 0x5f, 0x6,  0xdb, 0xba, 0xc,  0xee, 0x2,  0x0,  0x1b, 0x31, 0xae, 0x39, 0xfd, 0x87,
                   0x6f, 0xc9, 0xeb, 0x1d, 0xf3, 0xf0, 0x16, 0xb1, 0x6a, 0x55, 0x79, 0x8d, 0xda, 0x9e, 0xfb, 0xe8, 0x50,
                   0x67, 0xa1, 0x16, 0xe,  0xa2, 0x2,  0x0,  0x1d, 0x89, 0x35, 0x75, 0x4,  0xd1, 0x14, 0x65, 0xb1, 0xc2,
                   0x48, 0x15, 0x70, 0x3b, 0x51, 0xe4, 0x8,  0x95, 0xb2, 0xb6, 0x8c, 0xd9, 0x3e, 0x21, 0x22, 0x2c, 0x1c,
                   0x9a, 0xa3, 0x31, 0x2,  0x0,  0x14, 0xbd, 0x72, 0xb9, 0x4b, 0x9b, 0xf7, 0x3a, 0x26, 0x81, 0x1c, 0x7d,
                   0x1a, 0x88, 0xcd, 0xc6, 0x67, 0x6d, 0xca, 0xb7, 0x7c, 0x0};

  uint8_t buf[190] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x37, 0xef, 0xed, 0x94};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xce};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc9, 0xf, 0x7e, 0xae, 0xb6, 0x9c, 0x3b, 0x6f, 0x7b, 0x8e};
  lwmqtt_string_t topic_filter_s3 = {10, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xdb, 0x8,  0x10, 0x16, 0xe4, 0x73, 0x62, 0xb1, 0x8f,
                                     0xc3, 0xe6, 0x6f, 0x3c, 0xc4, 0xf6, 0x66, 0x3d, 0x42};
  lwmqtt_string_t topic_filter_s4 = {18, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x87, 0xe0, 0x3f, 0x0, 0xa1, 0xbc, 0x86, 0x45, 0xac, 0x34, 0x3e, 0x31};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x2e, 0xe9, 0xb5, 0x59, 0x92, 0x36, 0x8c, 0x9d, 0x9,  0xcd, 0xa1, 0x4d,
                                     0x6f, 0xd7, 0x35, 0xba, 0x1e, 0x42, 0x5f, 0x6,  0xdb, 0xba, 0xc,  0xee};
  lwmqtt_string_t topic_filter_s6 = {24, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x31, 0xae, 0x39, 0xfd, 0x87, 0x6f, 0xc9, 0xeb, 0x1d, 0xf3, 0xf0, 0x16, 0xb1, 0x6a,
                                     0x55, 0x79, 0x8d, 0xda, 0x9e, 0xfb, 0xe8, 0x50, 0x67, 0xa1, 0x16, 0xe,  0xa2};
  lwmqtt_string_t topic_filter_s7 = {27, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x89, 0x35, 0x75, 0x4,  0xd1, 0x14, 0x65, 0xb1, 0xc2, 0x48,
                                     0x15, 0x70, 0x3b, 0x51, 0xe4, 0x8,  0x95, 0xb2, 0xb6, 0x8c,
                                     0xd9, 0x3e, 0x21, 0x22, 0x2c, 0x1c, 0x9a, 0xa3, 0x31};
  lwmqtt_string_t topic_filter_s8 = {29, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbd, 0x72, 0xb9, 0x4b, 0x9b, 0xf7, 0x3a, 0x26, 0x81, 0x1c,
                                     0x7d, 0x1a, 0x88, 0xcd, 0xc6, 0x67, 0x6d, 0xca, 0xb7, 0x7c};
  lwmqtt_string_t topic_filter_s9 = {20, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4596, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12163 [("\r\156\"+\229.^L8\n\226%&\152\200\143De",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\233=P\128\f\151\147O\193\209\230l\183\&7Z\153\201\152z:\237\&8\STX\176Z\187\245\253",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\154\238U\255\128\128\129\222",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\178\STX7\173\221\210\128$\v\SOHQ\223\172\129",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("J\179\253\197\215CRg\185\217\STX1\223\&5\213\&17\245y\\h\154\DC4Jz\238\168\243\DC3!",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("G-\208\165h?\SO\131[\DC1",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\193\175\185E?\229\197iQ\ETX\234\174%\176\197\223\197\DLE\233M\211\250X\185wU",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode19) {
  uint8_t pkt[] = {0x82, 0x9d, 0x1,  0x2f, 0x83, 0x0,  0x12, 0xd,  0x9c, 0x22, 0x2b, 0xe5, 0x2e, 0x5e, 0x4c, 0x38,
                   0xa,  0xe2, 0x25, 0x26, 0x98, 0xc8, 0x8f, 0x44, 0x65, 0x0,  0x0,  0x1c, 0xe9, 0x3d, 0x50, 0x80,
                   0xc,  0x97, 0x93, 0x4f, 0xc1, 0xd1, 0xe6, 0x6c, 0xb7, 0x37, 0x5a, 0x99, 0xc9, 0x98, 0x7a, 0x3a,
                   0xed, 0x38, 0x2,  0xb0, 0x5a, 0xbb, 0xf5, 0xfd, 0x2,  0x0,  0x8,  0x9a, 0xee, 0x55, 0xff, 0x80,
                   0x80, 0x81, 0xde, 0x2,  0x0,  0xe,  0xb2, 0x2,  0x37, 0xad, 0xdd, 0xd2, 0x80, 0x24, 0xb,  0x1,
                   0x51, 0xdf, 0xac, 0x81, 0x2,  0x0,  0x1e, 0x4a, 0xb3, 0xfd, 0xc5, 0xd7, 0x43, 0x52, 0x67, 0xb9,
                   0xd9, 0x2,  0x31, 0xdf, 0x35, 0xd5, 0x31, 0x37, 0xf5, 0x79, 0x5c, 0x68, 0x9a, 0x14, 0x4a, 0x7a,
                   0xee, 0xa8, 0xf3, 0x13, 0x21, 0x0,  0x0,  0xa,  0x47, 0x2d, 0xd0, 0xa5, 0x68, 0x3f, 0xe,  0x83,
                   0x5b, 0x11, 0x2,  0x0,  0x1a, 0xc1, 0xaf, 0xb9, 0x45, 0x3f, 0xe5, 0xc5, 0x69, 0x51, 0x3,  0xea,
                   0xae, 0x25, 0xb0, 0xc5, 0xdf, 0xc5, 0x10, 0xe9, 0x4d, 0xd3, 0xfa, 0x58, 0xb9, 0x77, 0x55, 0x2};

  uint8_t buf[170] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xd, 0x9c, 0x22, 0x2b, 0xe5, 0x2e, 0x5e, 0x4c, 0x38,
                                     0xa, 0xe2, 0x25, 0x26, 0x98, 0xc8, 0x8f, 0x44, 0x65};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xe9, 0x3d, 0x50, 0x80, 0xc,  0x97, 0x93, 0x4f, 0xc1, 0xd1,
                                     0xe6, 0x6c, 0xb7, 0x37, 0x5a, 0x99, 0xc9, 0x98, 0x7a, 0x3a,
                                     0xed, 0x38, 0x2,  0xb0, 0x5a, 0xbb, 0xf5, 0xfd};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9a, 0xee, 0x55, 0xff, 0x80, 0x80, 0x81, 0xde};
  lwmqtt_string_t topic_filter_s2 = {8, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb2, 0x2, 0x37, 0xad, 0xdd, 0xd2, 0x80, 0x24, 0xb, 0x1, 0x51, 0xdf, 0xac, 0x81};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4a, 0xb3, 0xfd, 0xc5, 0xd7, 0x43, 0x52, 0x67, 0xb9, 0xd9,
                                     0x2,  0x31, 0xdf, 0x35, 0xd5, 0x31, 0x37, 0xf5, 0x79, 0x5c,
                                     0x68, 0x9a, 0x14, 0x4a, 0x7a, 0xee, 0xa8, 0xf3, 0x13, 0x21};
  lwmqtt_string_t topic_filter_s4 = {30, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x47, 0x2d, 0xd0, 0xa5, 0x68, 0x3f, 0xe, 0x83, 0x5b, 0x11};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc1, 0xaf, 0xb9, 0x45, 0x3f, 0xe5, 0xc5, 0x69, 0x51, 0x3,  0xea, 0xae, 0x25,
                                     0xb0, 0xc5, 0xdf, 0xc5, 0x10, 0xe9, 0x4d, 0xd3, 0xfa, 0x58, 0xb9, 0x77, 0x55};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12163, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21672 [(":f\201\245\150t\153",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("g^\195\215\\\138\194\147\188\181W\136",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\163\181\241IK\nA\212\254d\216",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode20) {
  uint8_t pkt[] = {0x82, 0x29, 0x54, 0xa8, 0x0,  0x7,  0x3a, 0x66, 0xc9, 0xf5, 0x96, 0x74, 0x99, 0x1, 0x0,
                   0xc,  0x67, 0x5e, 0xc3, 0xd7, 0x5c, 0x8a, 0xc2, 0x93, 0xbc, 0xb5, 0x57, 0x88, 0x0, 0x0,
                   0xb,  0xa3, 0xb5, 0xf1, 0x49, 0x4b, 0xa,  0x41, 0xd4, 0xfe, 0x64, 0xd8, 0x0};

  uint8_t buf[53] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x3a, 0x66, 0xc9, 0xf5, 0x96, 0x74, 0x99};
  lwmqtt_string_t topic_filter_s0 = {7, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x67, 0x5e, 0xc3, 0xd7, 0x5c, 0x8a, 0xc2, 0x93, 0xbc, 0xb5, 0x57, 0x88};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa3, 0xb5, 0xf1, 0x49, 0x4b, 0xa, 0x41, 0xd4, 0xfe, 0x64, 0xd8};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21672, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2811 [("\232\155/\190\204\180\EOT\185\187J",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\204\150\224\190\140\164\182\211\159\f`\DC1",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\246te&\248u\229%^L\158\FSG\SYNQPL\237b\SOH\240\185",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k\ETX\f\tX\164\ETX",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode21) {
  uint8_t pkt[] = {0x82, 0x41, 0xa,  0xfb, 0x0,  0xa,  0xe8, 0x9b, 0x2f, 0xbe, 0xcc, 0xb4, 0x4,  0xb9, 0xbb, 0x4a, 0x1,
                   0x0,  0xc,  0xcc, 0x96, 0xe0, 0xbe, 0x8c, 0xa4, 0xb6, 0xd3, 0x9f, 0xc,  0x60, 0x11, 0x2,  0x0,  0x16,
                   0xf6, 0x74, 0x65, 0x26, 0xf8, 0x75, 0xe5, 0x25, 0x5e, 0x4c, 0x9e, 0x1c, 0x47, 0x16, 0x51, 0x50, 0x4c,
                   0xed, 0x62, 0x1,  0xf0, 0xb9, 0x0,  0x0,  0x7,  0x6b, 0x3,  0xc,  0x9,  0x58, 0xa4, 0x3,  0x1};

  uint8_t buf[77] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xe8, 0x9b, 0x2f, 0xbe, 0xcc, 0xb4, 0x4, 0xb9, 0xbb, 0x4a};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcc, 0x96, 0xe0, 0xbe, 0x8c, 0xa4, 0xb6, 0xd3, 0x9f, 0xc, 0x60, 0x11};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf6, 0x74, 0x65, 0x26, 0xf8, 0x75, 0xe5, 0x25, 0x5e, 0x4c, 0x9e,
                                     0x1c, 0x47, 0x16, 0x51, 0x50, 0x4c, 0xed, 0x62, 0x1,  0xf0, 0xb9};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6b, 0x3, 0xc, 0x9, 0x58, 0xa4, 0x3};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2811, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27615 [("\NAK\134\219\&6;\150\&1UX\155\237e\170\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("D\188\171\141\181i\189E\145\165\209^\172\DC3\184\&4\DC3\GS\221\USd\169UZ\156]\218",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("U\197\163\225\242\DELe\225y\183n'_\168\130\EOTv\134DS\164\148\vc=\226\240\215",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("%\220\143Z\STX\254s5\230\248\161\215\251k\222j2\132\174X\243\199\DC1\147\231",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\230\199yn\147I\171\f\206\152\247\ACK\246\205\&7i>7\137\ETXi",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("YLH\ETXb\224\237\198\151j\195\234\238",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NUL4\232",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode22) {
  uint8_t pkt[] = {0x82, 0x9d, 0x1,  0x6b, 0xdf, 0x0,  0xe,  0x15, 0x86, 0xdb, 0x36, 0x3b, 0x96, 0x31, 0x55, 0x58,
                   0x9b, 0xed, 0x65, 0xaa, 0xdd, 0x2,  0x0,  0x0,  0x2,  0x0,  0x1b, 0x44, 0xbc, 0xab, 0x8d, 0xb5,
                   0x69, 0xbd, 0x45, 0x91, 0xa5, 0xd1, 0x5e, 0xac, 0x13, 0xb8, 0x34, 0x13, 0x1d, 0xdd, 0x1f, 0x64,
                   0xa9, 0x55, 0x5a, 0x9c, 0x5d, 0xda, 0x2,  0x0,  0x1c, 0x55, 0xc5, 0xa3, 0xe1, 0xf2, 0x7f, 0x65,
                   0xe1, 0x79, 0xb7, 0x6e, 0x27, 0x5f, 0xa8, 0x82, 0x4,  0x76, 0x86, 0x44, 0x53, 0xa4, 0x94, 0xb,
                   0x63, 0x3d, 0xe2, 0xf0, 0xd7, 0x2,  0x0,  0x19, 0x25, 0xdc, 0x8f, 0x5a, 0x2,  0xfe, 0x73, 0x35,
                   0xe6, 0xf8, 0xa1, 0xd7, 0xfb, 0x6b, 0xde, 0x6a, 0x32, 0x84, 0xae, 0x58, 0xf3, 0xc7, 0x11, 0x93,
                   0xe7, 0x1,  0x0,  0x15, 0xe6, 0xc7, 0x79, 0x6e, 0x93, 0x49, 0xab, 0xc,  0xce, 0x98, 0xf7, 0x6,
                   0xf6, 0xcd, 0x37, 0x69, 0x3e, 0x37, 0x89, 0x3,  0x69, 0x1,  0x0,  0xd,  0x59, 0x4c, 0x48, 0x3,
                   0x62, 0xe0, 0xed, 0xc6, 0x97, 0x6a, 0xc3, 0xea, 0xee, 0x0,  0x0,  0x3,  0x0,  0x34, 0xe8, 0x1};

  uint8_t buf[170] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x86, 0xdb, 0x36, 0x3b, 0x96, 0x31,
                                     0x55, 0x58, 0x9b, 0xed, 0x65, 0xaa, 0xdd};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x44, 0xbc, 0xab, 0x8d, 0xb5, 0x69, 0xbd, 0x45, 0x91, 0xa5, 0xd1, 0x5e, 0xac, 0x13,
                                     0xb8, 0x34, 0x13, 0x1d, 0xdd, 0x1f, 0x64, 0xa9, 0x55, 0x5a, 0x9c, 0x5d, 0xda};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x55, 0xc5, 0xa3, 0xe1, 0xf2, 0x7f, 0x65, 0xe1, 0x79, 0xb7,
                                     0x6e, 0x27, 0x5f, 0xa8, 0x82, 0x4,  0x76, 0x86, 0x44, 0x53,
                                     0xa4, 0x94, 0xb,  0x63, 0x3d, 0xe2, 0xf0, 0xd7};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x25, 0xdc, 0x8f, 0x5a, 0x2,  0xfe, 0x73, 0x35, 0xe6, 0xf8, 0xa1, 0xd7, 0xfb,
                                     0x6b, 0xde, 0x6a, 0x32, 0x84, 0xae, 0x58, 0xf3, 0xc7, 0x11, 0x93, 0xe7};
  lwmqtt_string_t topic_filter_s4 = {25, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe6, 0xc7, 0x79, 0x6e, 0x93, 0x49, 0xab, 0xc,  0xce, 0x98, 0xf7,
                                     0x6,  0xf6, 0xcd, 0x37, 0x69, 0x3e, 0x37, 0x89, 0x3,  0x69};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x59, 0x4c, 0x48, 0x3, 0x62, 0xe0, 0xed, 0xc6, 0x97, 0x6a, 0xc3, 0xea, 0xee};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x0, 0x34, 0xe8};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 27615, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14083 [("\135\234\FS",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("n\183\&9\DC1f\NUL@\185\255\185qq\STX\"\173\fJ\218\SUB",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\128p\197\DC1\162\160\171\171K\149\206 \ACK\145\202\142",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode23) {
  uint8_t pkt[] = {0x82, 0x31, 0x37, 0x3,  0x0,  0x3,  0x87, 0xea, 0x1c, 0x2,  0x0,  0x13, 0x6e, 0xb7, 0x39, 0x11, 0x66,
                   0x0,  0x40, 0xb9, 0xff, 0xb9, 0x71, 0x71, 0x2,  0x22, 0xad, 0xc,  0x4a, 0xda, 0x1a, 0x1,  0x0,  0x10,
                   0x80, 0x70, 0xc5, 0x11, 0xa2, 0xa0, 0xab, 0xab, 0x4b, 0x95, 0xce, 0x20, 0x6,  0x91, 0xca, 0x8e, 0x0};

  uint8_t buf[61] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x87, 0xea, 0x1c};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6e, 0xb7, 0x39, 0x11, 0x66, 0x0, 0x40, 0xb9, 0xff, 0xb9,
                                     0x71, 0x71, 0x2,  0x22, 0xad, 0xc, 0x4a, 0xda, 0x1a};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x80, 0x70, 0xc5, 0x11, 0xa2, 0xa0, 0xab, 0xab,
                                     0x4b, 0x95, 0xce, 0x20, 0x6,  0x91, 0xca, 0x8e};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14083, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16713 [("\141D\238n\154\164\246$)\214WR\f v\189\185*\139\r\DLE\ESC\135\SOH\164\132",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\185\139@\EM\a\ETX\186\130\FS\DC4\149\129",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS1}),("\139\211\225\252\160\193\136\130\164\243{3h\210\157/\220\156Eg\147l52",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\254\153c\253\205\198H\213\STX\SYN\139d#\249ON\143{\v\NAK3Iwz\EOT|\GS\ESC:^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode24) {
  uint8_t pkt[] = {0x82, 0x6a, 0x41, 0x49, 0x0,  0x1a, 0x8d, 0x44, 0xee, 0x6e, 0x9a, 0xa4, 0xf6, 0x24, 0x29, 0xd6,
                   0x57, 0x52, 0xc,  0x20, 0x76, 0xbd, 0xb9, 0x2a, 0x8b, 0xd,  0x10, 0x1b, 0x87, 0x1,  0xa4, 0x84,
                   0x2,  0x0,  0xc,  0xb9, 0x8b, 0x40, 0x19, 0x7,  0x3,  0xba, 0x82, 0x1c, 0x14, 0x95, 0x81, 0x1,
                   0x0,  0x18, 0x8b, 0xd3, 0xe1, 0xfc, 0xa0, 0xc1, 0x88, 0x82, 0xa4, 0xf3, 0x7b, 0x33, 0x68, 0xd2,
                   0x9d, 0x2f, 0xdc, 0x9c, 0x45, 0x67, 0x93, 0x6c, 0x35, 0x32, 0x1,  0x0,  0x1e, 0xfe, 0x99, 0x63,
                   0xfd, 0xcd, 0xc6, 0x48, 0xd5, 0x2,  0x16, 0x8b, 0x64, 0x23, 0xf9, 0x4f, 0x4e, 0x8f, 0x7b, 0xb,
                   0x15, 0x33, 0x49, 0x77, 0x7a, 0x4,  0x7c, 0x1d, 0x1b, 0x3a, 0x5e, 0x2};

  uint8_t buf[118] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x8d, 0x44, 0xee, 0x6e, 0x9a, 0xa4, 0xf6, 0x24, 0x29, 0xd6, 0x57, 0x52, 0xc,
                                     0x20, 0x76, 0xbd, 0xb9, 0x2a, 0x8b, 0xd,  0x10, 0x1b, 0x87, 0x1,  0xa4, 0x84};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb9, 0x8b, 0x40, 0x19, 0x7, 0x3, 0xba, 0x82, 0x1c, 0x14, 0x95, 0x81};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8b, 0xd3, 0xe1, 0xfc, 0xa0, 0xc1, 0x88, 0x82, 0xa4, 0xf3, 0x7b, 0x33,
                                     0x68, 0xd2, 0x9d, 0x2f, 0xdc, 0x9c, 0x45, 0x67, 0x93, 0x6c, 0x35, 0x32};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfe, 0x99, 0x63, 0xfd, 0xcd, 0xc6, 0x48, 0xd5, 0x2,  0x16,
                                     0x8b, 0x64, 0x23, 0xf9, 0x4f, 0x4e, 0x8f, 0x7b, 0xb,  0x15,
                                     0x33, 0x49, 0x77, 0x7a, 0x4,  0x7c, 0x1d, 0x1b, 0x3a, 0x5e};
  lwmqtt_string_t topic_filter_s3 = {30, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 16713, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25471 [("
// g\199\217\146\253&\DC3\235\b\186\200\t\171\254\172\FS\140m\DC3\CAN\238F\224\187\190\171\242",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\179hw\206r\aC\GS\159\n\206\SUB\255$mE\EOTm]\210A\224",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("Vd\170\246\&2\v",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\230\130+\153\214\164\236\ENQas\251\192}h)\SOH\ESC{\189=\190\235'w\202\225\&4\223\ACK",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\221\&8F\142\&7\197\DC4\193\151\193@\EOT\151\ACK\146\157\239\149\STX\181\220\148\157\STX\224",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("l\160\229\230\146",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode25) {
  uint8_t pkt[] = {0x82, 0x8a, 0x1,  0x63, 0x7f, 0x0,  0x1c, 0x20, 0x67, 0xc7, 0xd9, 0x92, 0xfd, 0x26, 0x13, 0xeb,
                   0x8,  0xba, 0xc8, 0x9,  0xab, 0xfe, 0xac, 0x1c, 0x8c, 0x6d, 0x13, 0x18, 0xee, 0x46, 0xe0, 0xbb,
                   0xbe, 0xab, 0xf2, 0x0,  0x0,  0x0,  0x1,  0x0,  0x16, 0xb3, 0x68, 0x77, 0xce, 0x72, 0x7,  0x43,
                   0x1d, 0x9f, 0xa,  0xce, 0x1a, 0xff, 0x24, 0x6d, 0x45, 0x4,  0x6d, 0x5d, 0xd2, 0x41, 0xe0, 0x0,
                   0x0,  0x6,  0x56, 0x64, 0xaa, 0xf6, 0x32, 0xb,  0x1,  0x0,  0x1d, 0xe6, 0x82, 0x2b, 0x99, 0xd6,
                   0xa4, 0xec, 0x5,  0x61, 0x73, 0xfb, 0xc0, 0x7d, 0x68, 0x29, 0x1,  0x1b, 0x7b, 0xbd, 0x3d, 0xbe,
                   0xeb, 0x27, 0x77, 0xca, 0xe1, 0x34, 0xdf, 0x6,  0x1,  0x0,  0x19, 0xdd, 0x38, 0x46, 0x8e, 0x37,
                   0xc5, 0x14, 0xc1, 0x97, 0xc1, 0x40, 0x4,  0x97, 0x6,  0x92, 0x9d, 0xef, 0x95, 0x2,  0xb5, 0xdc,
                   0x94, 0x9d, 0x2,  0xe0, 0x1,  0x0,  0x5,  0x6c, 0xa0, 0xe5, 0xe6, 0x92, 0x0};

  uint8_t buf[151] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x20, 0x67, 0xc7, 0xd9, 0x92, 0xfd, 0x26, 0x13, 0xeb, 0x8,
                                     0xba, 0xc8, 0x9,  0xab, 0xfe, 0xac, 0x1c, 0x8c, 0x6d, 0x13,
                                     0x18, 0xee, 0x46, 0xe0, 0xbb, 0xbe, 0xab, 0xf2};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb3, 0x68, 0x77, 0xce, 0x72, 0x7, 0x43, 0x1d, 0x9f, 0xa,  0xce,
                                     0x1a, 0xff, 0x24, 0x6d, 0x45, 0x4, 0x6d, 0x5d, 0xd2, 0x41, 0xe0};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x56, 0x64, 0xaa, 0xf6, 0x32, 0xb};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe6, 0x82, 0x2b, 0x99, 0xd6, 0xa4, 0xec, 0x5,  0x61, 0x73,
                                     0xfb, 0xc0, 0x7d, 0x68, 0x29, 0x1,  0x1b, 0x7b, 0xbd, 0x3d,
                                     0xbe, 0xeb, 0x27, 0x77, 0xca, 0xe1, 0x34, 0xdf, 0x6};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xdd, 0x38, 0x46, 0x8e, 0x37, 0xc5, 0x14, 0xc1, 0x97, 0xc1, 0x40, 0x4, 0x97,
                                     0x6,  0x92, 0x9d, 0xef, 0x95, 0x2,  0xb5, 0xdc, 0x94, 0x9d, 0x2,  0xe0};
  lwmqtt_string_t topic_filter_s5 = {25, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x6c, 0xa0, 0xe5, 0xe6, 0x92};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25471, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10657 [("\ENQ4\f\143\197\ENQ\145\193\247\141\221i\199\192\173\223",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\188\156\DC3\177\134%\161",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\\\222\217\&5\226r",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\176c\ESCP\163\GSx\DC3",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("G\ENQ\204\136\fTN\163\214\228\254eHG\166\CAN\210\146>",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\172\144=\175\\\ESC\f\226\179v\175\164D$R9\211",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("S\242\171\242\STX\221\188uJ\199l\155\137\232\\\135\187\141\SYN\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\NAK\205\STX\156\ENQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\161\200eM1\161*\234\207\198\169\252.\DC2nE\230\227HE8\135\164\244",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("al}\149\EOT(\233\DLE\STX\233\208\183ui-F\t",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode26) {
  uint8_t pkt[] = {0x82, 0xab, 0x1,  0x29, 0xa1, 0x0,  0x10, 0x5,  0x34, 0xc,  0x8f, 0xc5, 0x5,  0x91, 0xc1, 0xf7,
                   0x8d, 0xdd, 0x69, 0xc7, 0xc0, 0xad, 0xdf, 0x2,  0x0,  0x7,  0xbc, 0x9c, 0x13, 0xb1, 0x86, 0x25,
                   0xa1, 0x0,  0x0,  0x6,  0x5c, 0xde, 0xd9, 0x35, 0xe2, 0x72, 0x2,  0x0,  0x8,  0xb0, 0x63, 0x1b,
                   0x50, 0xa3, 0x1d, 0x78, 0x13, 0x1,  0x0,  0x13, 0x47, 0x5,  0xcc, 0x88, 0xc,  0x54, 0x4e, 0xa3,
                   0xd6, 0xe4, 0xfe, 0x65, 0x48, 0x47, 0xa6, 0x18, 0xd2, 0x92, 0x3e, 0x1,  0x0,  0x11, 0xac, 0x90,
                   0x3d, 0xaf, 0x5c, 0x1b, 0xc,  0xe2, 0xb3, 0x76, 0xaf, 0xa4, 0x44, 0x24, 0x52, 0x39, 0xd3, 0x1,
                   0x0,  0x14, 0x53, 0xf2, 0xab, 0xf2, 0x2,  0xdd, 0xbc, 0x75, 0x4a, 0xc7, 0x6c, 0x9b, 0x89, 0xe8,
                   0x5c, 0x87, 0xbb, 0x8d, 0x16, 0xd9, 0x1,  0x0,  0x5,  0x15, 0xcd, 0x2,  0x9c, 0x5,  0x1,  0x0,
                   0x18, 0xa1, 0xc8, 0x65, 0x4d, 0x31, 0xa1, 0x2a, 0xea, 0xcf, 0xc6, 0xa9, 0xfc, 0x2e, 0x12, 0x6e,
                   0x45, 0xe6, 0xe3, 0x48, 0x45, 0x38, 0x87, 0xa4, 0xf4, 0x1,  0x0,  0x11, 0x61, 0x6c, 0x7d, 0x95,
                   0x4,  0x28, 0xe9, 0x10, 0x2,  0xe9, 0xd0, 0xb7, 0x75, 0x69, 0x2d, 0x46, 0x9,  0x2};

  uint8_t buf[184] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x5,  0x34, 0xc,  0x8f, 0xc5, 0x5,  0x91, 0xc1,
                                     0xf7, 0x8d, 0xdd, 0x69, 0xc7, 0xc0, 0xad, 0xdf};
  lwmqtt_string_t topic_filter_s0 = {16, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xbc, 0x9c, 0x13, 0xb1, 0x86, 0x25, 0xa1};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5c, 0xde, 0xd9, 0x35, 0xe2, 0x72};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb0, 0x63, 0x1b, 0x50, 0xa3, 0x1d, 0x78, 0x13};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x47, 0x5,  0xcc, 0x88, 0xc,  0x54, 0x4e, 0xa3, 0xd6, 0xe4,
                                     0xfe, 0x65, 0x48, 0x47, 0xa6, 0x18, 0xd2, 0x92, 0x3e};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xac, 0x90, 0x3d, 0xaf, 0x5c, 0x1b, 0xc,  0xe2, 0xb3,
                                     0x76, 0xaf, 0xa4, 0x44, 0x24, 0x52, 0x39, 0xd3};
  lwmqtt_string_t topic_filter_s5 = {17, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x53, 0xf2, 0xab, 0xf2, 0x2,  0xdd, 0xbc, 0x75, 0x4a, 0xc7,
                                     0x6c, 0x9b, 0x89, 0xe8, 0x5c, 0x87, 0xbb, 0x8d, 0x16, 0xd9};
  lwmqtt_string_t topic_filter_s6 = {20, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x15, 0xcd, 0x2, 0x9c, 0x5};
  lwmqtt_string_t topic_filter_s7 = {5, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xa1, 0xc8, 0x65, 0x4d, 0x31, 0xa1, 0x2a, 0xea, 0xcf, 0xc6, 0xa9, 0xfc,
                                     0x2e, 0x12, 0x6e, 0x45, 0xe6, 0xe3, 0x48, 0x45, 0x38, 0x87, 0xa4, 0xf4};
  lwmqtt_string_t topic_filter_s8 = {24, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x61, 0x6c, 0x7d, 0x95, 0x4,  0x28, 0xe9, 0x10, 0x2,
                                     0xe9, 0xd0, 0xb7, 0x75, 0x69, 0x2d, 0x46, 0x9};
  lwmqtt_string_t topic_filter_s9 = {17, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10657, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 15036 [("\ETB\177\238\199$\NUL\128\209",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("3r:\DC1c[upm\234_c`\195V\252C\vu\153\196",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("g\238\250",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("\183\236\166\159+\v\b\SI\149\DC2\247\&1",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\ESCd\242\134N\161i\169\135\230\198m\163\166\229\247e\211E",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("Y\216\242f(\ETX=\152\ESC\208?B|\197\n\198Z\148\153\199\f\r\\n5\137#4",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode27) {
  uint8_t pkt[] = {0x82, 0x6f, 0x3a, 0xbc, 0x0,  0x8,  0x17, 0xb1, 0xee, 0xc7, 0x24, 0x0,  0x80, 0xd1, 0x0,  0x0,  0x15,
                   0x33, 0x72, 0x3a, 0x11, 0x63, 0x5b, 0x75, 0x70, 0x6d, 0xea, 0x5f, 0x63, 0x60, 0xc3, 0x56, 0xfc, 0x43,
                   0xb,  0x75, 0x99, 0xc4, 0x1,  0x0,  0x3,  0x67, 0xee, 0xfa, 0x0,  0x0,  0xc,  0xb7, 0xec, 0xa6, 0x9f,
                   0x2b, 0xb,  0x8,  0xf,  0x95, 0x12, 0xf7, 0x31, 0x2,  0x0,  0x13, 0x1b, 0x64, 0xf2, 0x86, 0x4e, 0xa1,
                   0x69, 0xa9, 0x87, 0xe6, 0xc6, 0x6d, 0xa3, 0xa6, 0xe5, 0xf7, 0x65, 0xd3, 0x45, 0x0,  0x0,  0x1c, 0x59,
                   0xd8, 0xf2, 0x66, 0x28, 0x3,  0x3d, 0x98, 0x1b, 0xd0, 0x3f, 0x42, 0x7c, 0xc5, 0xa,  0xc6, 0x5a, 0x94,
                   0x99, 0xc7, 0xc,  0xd,  0x5c, 0x6e, 0x35, 0x89, 0x23, 0x34, 0x1};

  uint8_t buf[123] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x17, 0xb1, 0xee, 0xc7, 0x24, 0x0, 0x80, 0xd1};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x33, 0x72, 0x3a, 0x11, 0x63, 0x5b, 0x75, 0x70, 0x6d, 0xea, 0x5f,
                                     0x63, 0x60, 0xc3, 0x56, 0xfc, 0x43, 0xb,  0x75, 0x99, 0xc4};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x67, 0xee, 0xfa};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb7, 0xec, 0xa6, 0x9f, 0x2b, 0xb, 0x8, 0xf, 0x95, 0x12, 0xf7, 0x31};
  lwmqtt_string_t topic_filter_s3 = {12, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x1b, 0x64, 0xf2, 0x86, 0x4e, 0xa1, 0x69, 0xa9, 0x87, 0xe6,
                                     0xc6, 0x6d, 0xa3, 0xa6, 0xe5, 0xf7, 0x65, 0xd3, 0x45};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x59, 0xd8, 0xf2, 0x66, 0x28, 0x3,  0x3d, 0x98, 0x1b, 0xd0,
                                     0x3f, 0x42, 0x7c, 0xc5, 0xa,  0xc6, 0x5a, 0x94, 0x99, 0xc7,
                                     0xc,  0xd,  0x5c, 0x6e, 0x35, 0x89, 0x23, 0x34};
  lwmqtt_string_t topic_filter_s5 = {28, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 15036, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2876 [("\143\161\221\224\191",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("rT\145\ay\160\215s,\146c\129\150>@!/\217\141",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\r\184\142p\151\204\170\249\180/\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\235\167\DLE\217\198\169\175\SI\182\ESC",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("G\130\214\&0\b\EM/\194\249\193\148`\222\217\ETXQZ\251\&7\n\147k\254\158t\249\130\219-E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\SO\205\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2}),("\175\GS\210~\190\GS\178\&9\230=\236|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\213\RSA\148\250i2Cbmo\147D\254\170\&33p\218\CAN\232\206\SO\142\&7",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\169\DEL\233~\135W\168q\226\158\197\227\151}9",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode28) {
  uint8_t pkt[] = {0x82, 0xa2, 0x1,  0xb,  0x3c, 0x0,  0x5,  0x8f, 0xa1, 0xdd, 0xe0, 0xbf, 0x1,  0x0,  0x13, 0x72, 0x54,
                   0x91, 0x7,  0x79, 0xa0, 0xd7, 0x73, 0x2c, 0x92, 0x63, 0x81, 0x96, 0x3e, 0x40, 0x21, 0x2f, 0xd9, 0x8d,
                   0x0,  0x0,  0x0,  0x0,  0x0,  0xb,  0xd,  0xb8, 0x8e, 0x70, 0x97, 0xcc, 0xaa, 0xf9, 0xb4, 0x2f, 0xd2,
                   0x1,  0x0,  0xa,  0xeb, 0xa7, 0x10, 0xd9, 0xc6, 0xa9, 0xaf, 0xf,  0xb6, 0x1b, 0x1,  0x0,  0x1e, 0x47,
                   0x82, 0xd6, 0x30, 0x8,  0x19, 0x2f, 0xc2, 0xf9, 0xc1, 0x94, 0x60, 0xde, 0xd9, 0x3,  0x51, 0x5a, 0xfb,
                   0x37, 0xa,  0x93, 0x6b, 0xfe, 0x9e, 0x74, 0xf9, 0x82, 0xdb, 0x2d, 0x45, 0x0,  0x0,  0x3,  0xe,  0xcd,
                   0xce, 0x2,  0x0,  0xc,  0xaf, 0x1d, 0xd2, 0x7e, 0xbe, 0x1d, 0xb2, 0x39, 0xe6, 0x3d, 0xec, 0x7c, 0x2,
                   0x0,  0x19, 0xd5, 0x1e, 0x41, 0x94, 0xfa, 0x69, 0x32, 0x43, 0x62, 0x6d, 0x6f, 0x93, 0x44, 0xfe, 0xaa,
                   0x33, 0x33, 0x70, 0xda, 0x18, 0xe8, 0xce, 0xe,  0x8e, 0x37, 0x1,  0x0,  0xf,  0xa9, 0x7f, 0xe9, 0x7e,
                   0x87, 0x57, 0xa8, 0x71, 0xe2, 0x9e, 0xc5, 0xe3, 0x97, 0x7d, 0x39, 0x2};

  uint8_t buf[175] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x8f, 0xa1, 0xdd, 0xe0, 0xbf};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x72, 0x54, 0x91, 0x7,  0x79, 0xa0, 0xd7, 0x73, 0x2c, 0x92,
                                     0x63, 0x81, 0x96, 0x3e, 0x40, 0x21, 0x2f, 0xd9, 0x8d};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd, 0xb8, 0x8e, 0x70, 0x97, 0xcc, 0xaa, 0xf9, 0xb4, 0x2f, 0xd2};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xeb, 0xa7, 0x10, 0xd9, 0xc6, 0xa9, 0xaf, 0xf, 0xb6, 0x1b};
  lwmqtt_string_t topic_filter_s4 = {10, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x47, 0x82, 0xd6, 0x30, 0x8,  0x19, 0x2f, 0xc2, 0xf9, 0xc1,
                                     0x94, 0x60, 0xde, 0xd9, 0x3,  0x51, 0x5a, 0xfb, 0x37, 0xa,
                                     0x93, 0x6b, 0xfe, 0x9e, 0x74, 0xf9, 0x82, 0xdb, 0x2d, 0x45};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xe, 0xcd, 0xce};
  lwmqtt_string_t topic_filter_s6 = {3, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xaf, 0x1d, 0xd2, 0x7e, 0xbe, 0x1d, 0xb2, 0x39, 0xe6, 0x3d, 0xec, 0x7c};
  lwmqtt_string_t topic_filter_s7 = {12, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xd5, 0x1e, 0x41, 0x94, 0xfa, 0x69, 0x32, 0x43, 0x62, 0x6d, 0x6f, 0x93, 0x44,
                                     0xfe, 0xaa, 0x33, 0x33, 0x70, 0xda, 0x18, 0xe8, 0xce, 0xe,  0x8e, 0x37};
  lwmqtt_string_t topic_filter_s8 = {25, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xa9, 0x7f, 0xe9, 0x7e, 0x87, 0x57, 0xa8, 0x71,
                                     0xe2, 0x9e, 0xc5, 0xe3, 0x97, 0x7d, 0x39};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2876, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30960 [("\185\236\245\223\167kV\209\203\206v",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("`\208\168\173\228W\128\NUL\ESC\220\215\244'8\132
// \151\&8\151\138\SO\228g",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\196b\128&>\147\253\195D\218\SI\NAK\EOT\ETBV\195\140\"s\215\166Z:9",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("=|\155\128\168\238V\248\201^w7\200+\247\FS\194\185\218\184",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode29) {
  uint8_t pkt[] = {0x82, 0x5f, 0x78, 0xf0, 0x0,  0xb,  0xb9, 0xec, 0xf5, 0xdf, 0xa7, 0x6b, 0x56, 0xd1, 0xcb, 0xce, 0x76,
                   0x1,  0x0,  0x0,  0x2,  0x0,  0x17, 0x60, 0xd0, 0xa8, 0xad, 0xe4, 0x57, 0x80, 0x0,  0x1b, 0xdc, 0xd7,
                   0xf4, 0x27, 0x38, 0x84, 0x20, 0x97, 0x38, 0x97, 0x8a, 0xe,  0xe4, 0x67, 0x1,  0x0,  0x18, 0xc4, 0x62,
                   0x80, 0x26, 0x3e, 0x93, 0xfd, 0xc3, 0x44, 0xda, 0xf,  0x15, 0x4,  0x17, 0x56, 0xc3, 0x8c, 0x22, 0x73,
                   0xd7, 0xa6, 0x5a, 0x3a, 0x39, 0x2,  0x0,  0x14, 0x3d, 0x7c, 0x9b, 0x80, 0xa8, 0xee, 0x56, 0xf8, 0xc9,
                   0x5e, 0x77, 0x37, 0xc8, 0x2b, 0xf7, 0x1c, 0xc2, 0xb9, 0xda, 0xb8, 0x1};

  uint8_t buf[107] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xb9, 0xec, 0xf5, 0xdf, 0xa7, 0x6b, 0x56, 0xd1, 0xcb, 0xce, 0x76};
  lwmqtt_string_t topic_filter_s0 = {11, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x60, 0xd0, 0xa8, 0xad, 0xe4, 0x57, 0x80, 0x0,  0x1b, 0xdc, 0xd7, 0xf4,
                                     0x27, 0x38, 0x84, 0x20, 0x97, 0x38, 0x97, 0x8a, 0xe,  0xe4, 0x67};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc4, 0x62, 0x80, 0x26, 0x3e, 0x93, 0xfd, 0xc3, 0x44, 0xda, 0xf,  0x15,
                                     0x4,  0x17, 0x56, 0xc3, 0x8c, 0x22, 0x73, 0xd7, 0xa6, 0x5a, 0x3a, 0x39};
  lwmqtt_string_t topic_filter_s3 = {24, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x3d, 0x7c, 0x9b, 0x80, 0xa8, 0xee, 0x56, 0xf8, 0xc9, 0x5e,
                                     0x77, 0x37, 0xc8, 0x2b, 0xf7, 0x1c, 0xc2, 0xb9, 0xda, 0xb8};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 30960, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 19821 [("\162",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\200\151\208c\FS\228\171\229\143c\210\no\DC1F(\147w\158",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("w\206\216e\255h\237\252\178.",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\196)\168x0\242\199\SI\251\223L\150\183\234\205\197\137`\215'\aD\164\EOT5\148\ETB\189",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode30) {
  uint8_t pkt[] = {0x82, 0x48, 0x4d, 0x6d, 0x0,  0x1,  0xa2, 0x2,  0x0,  0x13, 0xc8, 0x97, 0xd0, 0x63, 0x1c,
                   0xe4, 0xab, 0xe5, 0x8f, 0x63, 0xd2, 0xa,  0x6f, 0x11, 0x46, 0x28, 0x93, 0x77, 0x9e, 0x1,
                   0x0,  0xa,  0x77, 0xce, 0xd8, 0x65, 0xff, 0x68, 0xed, 0xfc, 0xb2, 0x2e, 0x2,  0x0,  0x1c,
                   0xc4, 0x29, 0xa8, 0x78, 0x30, 0xf2, 0xc7, 0xf,  0xfb, 0xdf, 0x4c, 0x96, 0xb7, 0xea, 0xcd,
                   0xc5, 0x89, 0x60, 0xd7, 0x27, 0x7,  0x44, 0xa4, 0x4,  0x35, 0x94, 0x17, 0xbd, 0x2};

  uint8_t buf[84] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xa2};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc8, 0x97, 0xd0, 0x63, 0x1c, 0xe4, 0xab, 0xe5, 0x8f, 0x63,
                                     0xd2, 0xa,  0x6f, 0x11, 0x46, 0x28, 0x93, 0x77, 0x9e};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x77, 0xce, 0xd8, 0x65, 0xff, 0x68, 0xed, 0xfc, 0xb2, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc4, 0x29, 0xa8, 0x78, 0x30, 0xf2, 0xc7, 0xf,  0xfb, 0xdf,
                                     0x4c, 0x96, 0xb7, 0xea, 0xcd, 0xc5, 0x89, 0x60, 0xd7, 0x27,
                                     0x7,  0x44, 0xa4, 0x4,  0x35, 0x94, 0x17, 0xbd};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 19821, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21770
// [("\139=b\145p\157\223b|\STX[\197\203\167e^\171\235\151}k\149\EOT\132\SO\239\218\159\152",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ACK\227+\134\ETB\170\253\166",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\148-\198\ACKO:X\191\162",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\128\150\&7\b\f^g\182Dr\t8k\240\170\&7",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("jBu\DC1!5\207\193K6\164\a\EOT\189m\169\154}\186\220\246\141\&8\167\GS\184\RS\192",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("s\207#\r\188b4B|f>\135\234\142\&7\202\154\186",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode31) {
  uint8_t pkt[] = {0x82, 0x80, 0x1,  0x55, 0xa,  0x0,  0x1d, 0x8b, 0x3d, 0x62, 0x91, 0x70, 0x9d, 0xdf, 0x62, 0x7c, 0x2,
                   0x5b, 0xc5, 0xcb, 0xa7, 0x65, 0x5e, 0xab, 0xeb, 0x97, 0x7d, 0x6b, 0x95, 0x4,  0x84, 0xe,  0xef, 0xda,
                   0x9f, 0x98, 0x1,  0x0,  0x8,  0x6,  0xe3, 0x2b, 0x86, 0x17, 0xaa, 0xfd, 0xa6, 0x2,  0x0,  0x9,  0x94,
                   0x2d, 0xc6, 0x6,  0x4f, 0x3a, 0x58, 0xbf, 0xa2, 0x2,  0x0,  0x10, 0x80, 0x96, 0x37, 0x8,  0xc,  0x5e,
                   0x67, 0xb6, 0x44, 0x72, 0x9,  0x38, 0x6b, 0xf0, 0xaa, 0x37, 0x1,  0x0,  0x1c, 0x6a, 0x42, 0x75, 0x11,
                   0x21, 0x35, 0xcf, 0xc1, 0x4b, 0x36, 0xa4, 0x7,  0x4,  0xbd, 0x6d, 0xa9, 0x9a, 0x7d, 0xba, 0xdc, 0xf6,
                   0x8d, 0x38, 0xa7, 0x1d, 0xb8, 0x1e, 0xc0, 0x2,  0x0,  0x12, 0x73, 0xcf, 0x23, 0xd,  0xbc, 0x62, 0x34,
                   0x42, 0x7c, 0x66, 0x3e, 0x87, 0xea, 0x8e, 0x37, 0xca, 0x9a, 0xba, 0x1};

  uint8_t buf[141] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x8b, 0x3d, 0x62, 0x91, 0x70, 0x9d, 0xdf, 0x62, 0x7c, 0x2,
                                     0x5b, 0xc5, 0xcb, 0xa7, 0x65, 0x5e, 0xab, 0xeb, 0x97, 0x7d,
                                     0x6b, 0x95, 0x4,  0x84, 0xe,  0xef, 0xda, 0x9f, 0x98};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6, 0xe3, 0x2b, 0x86, 0x17, 0xaa, 0xfd, 0xa6};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x94, 0x2d, 0xc6, 0x6, 0x4f, 0x3a, 0x58, 0xbf, 0xa2};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x80, 0x96, 0x37, 0x8,  0xc,  0x5e, 0x67, 0xb6,
                                     0x44, 0x72, 0x9,  0x38, 0x6b, 0xf0, 0xaa, 0x37};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6a, 0x42, 0x75, 0x11, 0x21, 0x35, 0xcf, 0xc1, 0x4b, 0x36,
                                     0xa4, 0x7,  0x4,  0xbd, 0x6d, 0xa9, 0x9a, 0x7d, 0xba, 0xdc,
                                     0xf6, 0x8d, 0x38, 0xa7, 0x1d, 0xb8, 0x1e, 0xc0};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x73, 0xcf, 0x23, 0xd,  0xbc, 0x62, 0x34, 0x42, 0x7c,
                                     0x66, 0x3e, 0x87, 0xea, 0x8e, 0x37, 0xca, 0x9a, 0xba};
  lwmqtt_string_t topic_filter_s5 = {18, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21770, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 24232
// [("\228\219\211\ENQ\144\&1\EMRC\252<\249\191\134\214I\149\ENQ\204~\DC4\165\182\150\219\180^\DC2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("js\191\171\SYN\189\226K\172j8\255\165\172\234R\174`\205\174\r)\ESCN\b\166\150\&6\151",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\195\230#0b={P\147",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS =
// QoS1}),("\b\181\152j\EMo\228\134\219\174\179~\246\170>\175\209\193\138D\129\150K\v\163.\223@",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("F\212\150u\137\212\165\227\t\252\203'8\195\187\205~",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\232\133xTT\221\207\NUL",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\ETX}\171pE",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("@$\166\244=%&\CANS\tx2\215\"\DLE\204\197\147\DC4nU\ENQ]\229>\EM`\246H",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\153\175\GS\173\ETB\160a\b\FS\195\152\193\STX\139\242\129\254{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\244\&6\\v\143b\181\188\130\153t\237\185>\130",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\161g3\193\181G;",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode32) {
  uint8_t pkt[] = {0x82, 0xe4, 0x1,  0x5e, 0xa8, 0x0,  0x1c, 0xe4, 0xdb, 0xd3, 0x5,  0x90, 0x31, 0x19, 0x52, 0x43, 0xfc,
                   0x3c, 0xf9, 0xbf, 0x86, 0xd6, 0x49, 0x95, 0x5,  0xcc, 0x7e, 0x14, 0xa5, 0xb6, 0x96, 0xdb, 0xb4, 0x5e,
                   0x12, 0x0,  0x0,  0x1d, 0x6a, 0x73, 0xbf, 0xab, 0x16, 0xbd, 0xe2, 0x4b, 0xac, 0x6a, 0x38, 0xff, 0xa5,
                   0xac, 0xea, 0x52, 0xae, 0x60, 0xcd, 0xae, 0xd,  0x29, 0x1b, 0x4e, 0x8,  0xa6, 0x96, 0x36, 0x97, 0x0,
                   0x0,  0x9,  0xc3, 0xe6, 0x23, 0x30, 0x62, 0x3d, 0x7b, 0x50, 0x93, 0x1,  0x0,  0x1c, 0x8,  0xb5, 0x98,
                   0x6a, 0x19, 0x6f, 0xe4, 0x86, 0xdb, 0xae, 0xb3, 0x7e, 0xf6, 0xaa, 0x3e, 0xaf, 0xd1, 0xc1, 0x8a, 0x44,
                   0x81, 0x96, 0x4b, 0xb,  0xa3, 0x2e, 0xdf, 0x40, 0x1,  0x0,  0x11, 0x46, 0xd4, 0x96, 0x75, 0x89, 0xd4,
                   0xa5, 0xe3, 0x9,  0xfc, 0xcb, 0x27, 0x38, 0xc3, 0xbb, 0xcd, 0x7e, 0x1,  0x0,  0x8,  0xe8, 0x85, 0x78,
                   0x54, 0x54, 0xdd, 0xcf, 0x0,  0x0,  0x0,  0x5,  0x3,  0x7d, 0xab, 0x70, 0x45, 0x1,  0x0,  0x1d, 0x40,
                   0x24, 0xa6, 0xf4, 0x3d, 0x25, 0x26, 0x18, 0x53, 0x9,  0x78, 0x32, 0xd7, 0x22, 0x10, 0xcc, 0xc5, 0x93,
                   0x14, 0x6e, 0x55, 0x5,  0x5d, 0xe5, 0x3e, 0x19, 0x60, 0xf6, 0x48, 0x0,  0x0,  0x12, 0x99, 0xaf, 0x1d,
                   0xad, 0x17, 0xa0, 0x61, 0x8,  0x1c, 0xc3, 0x98, 0xc1, 0x2,  0x8b, 0xf2, 0x81, 0xfe, 0x7b, 0x0,  0x0,
                   0xf,  0xf4, 0x36, 0x5c, 0x76, 0x8f, 0x62, 0xb5, 0xbc, 0x82, 0x99, 0x74, 0xed, 0xb9, 0x3e, 0x82, 0x2,
                   0x0,  0x7,  0xa1, 0x67, 0x33, 0xc1, 0xb5, 0x47, 0x3b, 0x1};

  uint8_t buf[241] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xe4, 0xdb, 0xd3, 0x5, 0x90, 0x31, 0x19, 0x52, 0x43, 0xfc, 0x3c, 0xf9, 0xbf, 0x86,
                                     0xd6, 0x49, 0x95, 0x5, 0xcc, 0x7e, 0x14, 0xa5, 0xb6, 0x96, 0xdb, 0xb4, 0x5e, 0x12};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6a, 0x73, 0xbf, 0xab, 0x16, 0xbd, 0xe2, 0x4b, 0xac, 0x6a,
                                     0x38, 0xff, 0xa5, 0xac, 0xea, 0x52, 0xae, 0x60, 0xcd, 0xae,
                                     0xd,  0x29, 0x1b, 0x4e, 0x8,  0xa6, 0x96, 0x36, 0x97};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc3, 0xe6, 0x23, 0x30, 0x62, 0x3d, 0x7b, 0x50, 0x93};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8,  0xb5, 0x98, 0x6a, 0x19, 0x6f, 0xe4, 0x86, 0xdb, 0xae,
                                     0xb3, 0x7e, 0xf6, 0xaa, 0x3e, 0xaf, 0xd1, 0xc1, 0x8a, 0x44,
                                     0x81, 0x96, 0x4b, 0xb,  0xa3, 0x2e, 0xdf, 0x40};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x46, 0xd4, 0x96, 0x75, 0x89, 0xd4, 0xa5, 0xe3, 0x9,
                                     0xfc, 0xcb, 0x27, 0x38, 0xc3, 0xbb, 0xcd, 0x7e};
  lwmqtt_string_t topic_filter_s4 = {17, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe8, 0x85, 0x78, 0x54, 0x54, 0xdd, 0xcf, 0x0};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3, 0x7d, 0xab, 0x70, 0x45};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x40, 0x24, 0xa6, 0xf4, 0x3d, 0x25, 0x26, 0x18, 0x53, 0x9,
                                     0x78, 0x32, 0xd7, 0x22, 0x10, 0xcc, 0xc5, 0x93, 0x14, 0x6e,
                                     0x55, 0x5,  0x5d, 0xe5, 0x3e, 0x19, 0x60, 0xf6, 0x48};
  lwmqtt_string_t topic_filter_s7 = {29, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x99, 0xaf, 0x1d, 0xad, 0x17, 0xa0, 0x61, 0x8,  0x1c,
                                     0xc3, 0x98, 0xc1, 0x2,  0x8b, 0xf2, 0x81, 0xfe, 0x7b};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf4, 0x36, 0x5c, 0x76, 0x8f, 0x62, 0xb5, 0xbc,
                                     0x82, 0x99, 0x74, 0xed, 0xb9, 0x3e, 0x82};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xa1, 0x67, 0x33, 0xc1, 0xb5, 0x47, 0x3b};
  lwmqtt_string_t topic_filter_s10 = {7, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 24232, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1966 [("\202jY\229%\180?VjcM\232\215\146\SYNs\253\SYNW\162\170\244Y",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("6\r\249\236N\201*c",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("K\131A\193\166$\USc,N\221\254\172\242\137\232s\"l\ETB\DC4;S\198(",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("r\129\"\198\151\161\183\159\156\156\202\DC1\GS\153\EOT\ETX\146",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\202aP!\RSH\210E\130Q\ETX\r\161r
// \168u\216\145\SYN\157G\204\148\180\STX",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("]wv2\143\149\148\159\RS\157",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\158\DC4\161$H\248\233\&7q\130-\225\219em\181\DC4nH\v\228=G#0\243O\f\DC4{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),(";\232\243\148t\249g\EM\247\&4
// \198\130\228\f\ACK\203\199\250\215\&6\RS\148",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS0}),("I\191\225\be\SO\193\210\CAN=z\199$i\\a\157\145\132\&7\137\174\GS\148\ESC\245\194\193\134J",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\189\225\230\152\147\154q\DC2\158\197\187\194\178\146&\GSl\235\157\248\246\"\232\253\204\253I\DC2\143<",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode33) {
  uint8_t pkt[] = {
      0x82, 0xfe, 0x1,  0x7,  0xae, 0x0,  0x17, 0xca, 0x6a, 0x59, 0xe5, 0x25, 0xb4, 0x3f, 0x56, 0x6a, 0x63, 0x4d, 0xe8,
      0xd7, 0x92, 0x16, 0x73, 0xfd, 0x16, 0x57, 0xa2, 0xaa, 0xf4, 0x59, 0x2,  0x0,  0x8,  0x36, 0xd,  0xf9, 0xec, 0x4e,
      0xc9, 0x2a, 0x63, 0x0,  0x0,  0x19, 0x4b, 0x83, 0x41, 0xc1, 0xa6, 0x24, 0x1f, 0x63, 0x2c, 0x4e, 0xdd, 0xfe, 0xac,
      0xf2, 0x89, 0xe8, 0x73, 0x22, 0x6c, 0x17, 0x14, 0x3b, 0x53, 0xc6, 0x28, 0x2,  0x0,  0x11, 0x72, 0x81, 0x22, 0xc6,
      0x97, 0xa1, 0xb7, 0x9f, 0x9c, 0x9c, 0xca, 0x11, 0x1d, 0x99, 0x4,  0x3,  0x92, 0x0,  0x0,  0x1a, 0xca, 0x61, 0x50,
      0x21, 0x1e, 0x48, 0xd2, 0x45, 0x82, 0x51, 0x3,  0xd,  0xa1, 0x72, 0x20, 0xa8, 0x75, 0xd8, 0x91, 0x16, 0x9d, 0x47,
      0xcc, 0x94, 0xb4, 0x2,  0x0,  0x0,  0xa,  0x5d, 0x77, 0x76, 0x32, 0x8f, 0x95, 0x94, 0x9f, 0x1e, 0x9d, 0x2,  0x0,
      0x1e, 0x9e, 0x14, 0xa1, 0x24, 0x48, 0xf8, 0xe9, 0x37, 0x71, 0x82, 0x2d, 0xe1, 0xdb, 0x65, 0x6d, 0xb5, 0x14, 0x6e,
      0x48, 0xb,  0xe4, 0x3d, 0x47, 0x23, 0x30, 0xf3, 0x4f, 0xc,  0x14, 0x7b, 0x1,  0x0,  0x17, 0x3b, 0xe8, 0xf3, 0x94,
      0x74, 0xf9, 0x67, 0x19, 0xf7, 0x34, 0x20, 0xc6, 0x82, 0xe4, 0xc,  0x6,  0xcb, 0xc7, 0xfa, 0xd7, 0x36, 0x1e, 0x94,
      0x0,  0x0,  0x1e, 0x49, 0xbf, 0xe1, 0x8,  0x65, 0xe,  0xc1, 0xd2, 0x18, 0x3d, 0x7a, 0xc7, 0x24, 0x69, 0x5c, 0x61,
      0x9d, 0x91, 0x84, 0x37, 0x89, 0xae, 0x1d, 0x94, 0x1b, 0xf5, 0xc2, 0xc1, 0x86, 0x4a, 0x0,  0x0,  0x1e, 0xbd, 0xe1,
      0xe6, 0x98, 0x93, 0x9a, 0x71, 0x12, 0x9e, 0xc5, 0xbb, 0xc2, 0xb2, 0x92, 0x26, 0x1d, 0x6c, 0xeb, 0x9d, 0xf8, 0xf6,
      0x22, 0xe8, 0xfd, 0xcc, 0xfd, 0x49, 0x12, 0x8f, 0x3c, 0x2};

  uint8_t buf[267] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0xca, 0x6a, 0x59, 0xe5, 0x25, 0xb4, 0x3f, 0x56, 0x6a, 0x63, 0x4d, 0xe8,
                                     0xd7, 0x92, 0x16, 0x73, 0xfd, 0x16, 0x57, 0xa2, 0xaa, 0xf4, 0x59};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x36, 0xd, 0xf9, 0xec, 0x4e, 0xc9, 0x2a, 0x63};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4b, 0x83, 0x41, 0xc1, 0xa6, 0x24, 0x1f, 0x63, 0x2c, 0x4e, 0xdd, 0xfe, 0xac,
                                     0xf2, 0x89, 0xe8, 0x73, 0x22, 0x6c, 0x17, 0x14, 0x3b, 0x53, 0xc6, 0x28};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x72, 0x81, 0x22, 0xc6, 0x97, 0xa1, 0xb7, 0x9f, 0x9c,
                                     0x9c, 0xca, 0x11, 0x1d, 0x99, 0x4,  0x3,  0x92};
  lwmqtt_string_t topic_filter_s3 = {17, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xca, 0x61, 0x50, 0x21, 0x1e, 0x48, 0xd2, 0x45, 0x82, 0x51, 0x3,  0xd,  0xa1,
                                     0x72, 0x20, 0xa8, 0x75, 0xd8, 0x91, 0x16, 0x9d, 0x47, 0xcc, 0x94, 0xb4, 0x2};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x5d, 0x77, 0x76, 0x32, 0x8f, 0x95, 0x94, 0x9f, 0x1e, 0x9d};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x9e, 0x14, 0xa1, 0x24, 0x48, 0xf8, 0xe9, 0x37, 0x71, 0x82,
                                     0x2d, 0xe1, 0xdb, 0x65, 0x6d, 0xb5, 0x14, 0x6e, 0x48, 0xb,
                                     0xe4, 0x3d, 0x47, 0x23, 0x30, 0xf3, 0x4f, 0xc,  0x14, 0x7b};
  lwmqtt_string_t topic_filter_s6 = {30, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x3b, 0xe8, 0xf3, 0x94, 0x74, 0xf9, 0x67, 0x19, 0xf7, 0x34, 0x20, 0xc6,
                                     0x82, 0xe4, 0xc,  0x6,  0xcb, 0xc7, 0xfa, 0xd7, 0x36, 0x1e, 0x94};
  lwmqtt_string_t topic_filter_s7 = {23, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x49, 0xbf, 0xe1, 0x8,  0x65, 0xe,  0xc1, 0xd2, 0x18, 0x3d,
                                     0x7a, 0xc7, 0x24, 0x69, 0x5c, 0x61, 0x9d, 0x91, 0x84, 0x37,
                                     0x89, 0xae, 0x1d, 0x94, 0x1b, 0xf5, 0xc2, 0xc1, 0x86, 0x4a};
  lwmqtt_string_t topic_filter_s8 = {30, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbd, 0xe1, 0xe6, 0x98, 0x93, 0x9a, 0x71, 0x12, 0x9e, 0xc5,
                                     0xbb, 0xc2, 0xb2, 0x92, 0x26, 0x1d, 0x6c, 0xeb, 0x9d, 0xf8,
                                     0xf6, 0x22, 0xe8, 0xfd, 0xcc, 0xfd, 0x49, 0x12, 0x8f, 0x3c};
  lwmqtt_string_t topic_filter_s9 = {30, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1966, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 11595 [("\157Y\254\b\253\241E\158M\CAN\255\215Q\ENQ\217\131\177",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\171\DC1\150\DLE\ETBSSi\198{\213\206\249t\216\rt\218\236\161\143\&8\145",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\181\FS]\249\210A:\189\185\DC1\ENQ\175]\150\218\169\SOH\193\SOH`\150\169\182l",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\233/\143\172\SIn:m\212Pf\177&\234\165\181\226\DEL3\153\SI\241l\144\242",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode34) {
  uint8_t pkt[] = {0x82, 0x67, 0x2d, 0x4b, 0x0,  0x11, 0x9d, 0x59, 0xfe, 0x8,  0xfd, 0xf1, 0x45, 0x9e, 0x4d,
                   0x18, 0xff, 0xd7, 0x51, 0x5,  0xd9, 0x83, 0xb1, 0x2,  0x0,  0x17, 0xab, 0x11, 0x96, 0x10,
                   0x17, 0x53, 0x53, 0x69, 0xc6, 0x7b, 0xd5, 0xce, 0xf9, 0x74, 0xd8, 0xd,  0x74, 0xda, 0xec,
                   0xa1, 0x8f, 0x38, 0x91, 0x2,  0x0,  0x18, 0xb5, 0x1c, 0x5d, 0xf9, 0xd2, 0x41, 0x3a, 0xbd,
                   0xb9, 0x11, 0x5,  0xaf, 0x5d, 0x96, 0xda, 0xa9, 0x1,  0xc1, 0x1,  0x60, 0x96, 0xa9, 0xb6,
                   0x6c, 0x2,  0x0,  0x19, 0xe9, 0x2f, 0x8f, 0xac, 0xf,  0x6e, 0x3a, 0x6d, 0xd4, 0x50, 0x66,
                   0xb1, 0x26, 0xea, 0xa5, 0xb5, 0xe2, 0x7f, 0x33, 0x99, 0xf,  0xf1, 0x6c, 0x90, 0xf2, 0x1};

  uint8_t buf[115] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x9d, 0x59, 0xfe, 0x8,  0xfd, 0xf1, 0x45, 0x9e, 0x4d,
                                     0x18, 0xff, 0xd7, 0x51, 0x5,  0xd9, 0x83, 0xb1};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x11, 0x96, 0x10, 0x17, 0x53, 0x53, 0x69, 0xc6, 0x7b, 0xd5, 0xce,
                                     0xf9, 0x74, 0xd8, 0xd,  0x74, 0xda, 0xec, 0xa1, 0x8f, 0x38, 0x91};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb5, 0x1c, 0x5d, 0xf9, 0xd2, 0x41, 0x3a, 0xbd, 0xb9, 0x11, 0x5,  0xaf,
                                     0x5d, 0x96, 0xda, 0xa9, 0x1,  0xc1, 0x1,  0x60, 0x96, 0xa9, 0xb6, 0x6c};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xe9, 0x2f, 0x8f, 0xac, 0xf,  0x6e, 0x3a, 0x6d, 0xd4, 0x50, 0x66, 0xb1, 0x26,
                                     0xea, 0xa5, 0xb5, 0xe2, 0x7f, 0x33, 0x99, 0xf,  0xf1, 0x6c, 0x90, 0xf2};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 11595, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3561 [("\SI\230\235\135\157\175%\128",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\174\n|v\146#k\154\224-R\219\SUB\245k\186\207:
// \r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\DC2\181\156\155\180{\234\ETX\GS\223\168\199u\168N\218w\246\&3\DC3z\168y\249",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\170\211",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("R\230\221\&6\239O\211\146vM3YD\140\129+\194B\160\200\163\189",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode35) {
  uint8_t pkt[] = {0x82, 0x5d, 0xd,  0xe9, 0x0,  0x8,  0xf,  0xe6, 0xeb, 0x87, 0x9d, 0xaf, 0x25, 0x80, 0x0,  0x0,
                   0x14, 0xae, 0xa,  0x7c, 0x76, 0x92, 0x23, 0x6b, 0x9a, 0xe0, 0x2d, 0x52, 0xdb, 0x1a, 0xf5, 0x6b,
                   0xba, 0xcf, 0x3a, 0x20, 0xd,  0x0,  0x0,  0x18, 0x12, 0xb5, 0x9c, 0x9b, 0xb4, 0x7b, 0xea, 0x3,
                   0x1d, 0xdf, 0xa8, 0xc7, 0x75, 0xa8, 0x4e, 0xda, 0x77, 0xf6, 0x33, 0x13, 0x7a, 0xa8, 0x79, 0xf9,
                   0x1,  0x0,  0x2,  0xaa, 0xd3, 0x2,  0x0,  0x16, 0x52, 0xe6, 0xdd, 0x36, 0xef, 0x4f, 0xd3, 0x92,
                   0x76, 0x4d, 0x33, 0x59, 0x44, 0x8c, 0x81, 0x2b, 0xc2, 0x42, 0xa0, 0xc8, 0xa3, 0xbd, 0x0};

  uint8_t buf[105] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xf, 0xe6, 0xeb, 0x87, 0x9d, 0xaf, 0x25, 0x80};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0xa,  0x7c, 0x76, 0x92, 0x23, 0x6b, 0x9a, 0xe0, 0x2d,
                                     0x52, 0xdb, 0x1a, 0xf5, 0x6b, 0xba, 0xcf, 0x3a, 0x20, 0xd};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x12, 0xb5, 0x9c, 0x9b, 0xb4, 0x7b, 0xea, 0x3,  0x1d, 0xdf, 0xa8, 0xc7,
                                     0x75, 0xa8, 0x4e, 0xda, 0x77, 0xf6, 0x33, 0x13, 0x7a, 0xa8, 0x79, 0xf9};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xaa, 0xd3};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x52, 0xe6, 0xdd, 0x36, 0xef, 0x4f, 0xd3, 0x92, 0x76, 0x4d, 0x33,
                                     0x59, 0x44, 0x8c, 0x81, 0x2b, 0xc2, 0x42, 0xa0, 0xc8, 0xa3, 0xbd};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 3561, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27717 [("\241m\204\194)1\\\134\EOTj\252\251\183\169o~+",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\165\223\t",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ETX)\192\ETXE\164\158\181\239\216\SOH\131\171\196\207",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\182bC|\240!\219\DC4Q\200\161",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\160\162\&7\226\196(\141G\165\139\207\SI\255\171\251J\DC2\ETX\168q'1\240-^\185\192\191]",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("}$%\168\155\130\v\149v!\166",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\167o\ETX\243\&6\210\&8\STX\199\236h\129H1M\147\GS\241\143S\246B\130\234\160\215\223\184",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\SUBq\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("]g\181\SUBP\232h\172\GS\180\247\RS\203\236",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\201\158",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("C\229\189\187\171\185\NAKjA!\129\253",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode36) {
  uint8_t pkt[] = {0x82, 0xb4, 0x1,  0x6c, 0x45, 0x0,  0x11, 0xf1, 0x6d, 0xcc, 0xc2, 0x29, 0x31, 0x5c, 0x86, 0x4,  0x6a,
                   0xfc, 0xfb, 0xb7, 0xa9, 0x6f, 0x7e, 0x2b, 0x1,  0x0,  0x3,  0xa5, 0xdf, 0x9,  0x1,  0x0,  0xf,  0x3,
                   0x29, 0xc0, 0x3,  0x45, 0xa4, 0x9e, 0xb5, 0xef, 0xd8, 0x1,  0x83, 0xab, 0xc4, 0xcf, 0x2,  0x0,  0xb,
                   0xb6, 0x62, 0x43, 0x7c, 0xf0, 0x21, 0xdb, 0x14, 0x51, 0xc8, 0xa1, 0x1,  0x0,  0x1d, 0xa0, 0xa2, 0x37,
                   0xe2, 0xc4, 0x28, 0x8d, 0x47, 0xa5, 0x8b, 0xcf, 0xf,  0xff, 0xab, 0xfb, 0x4a, 0x12, 0x3,  0xa8, 0x71,
                   0x27, 0x31, 0xf0, 0x2d, 0x5e, 0xb9, 0xc0, 0xbf, 0x5d, 0x1,  0x0,  0xb,  0x7d, 0x24, 0x25, 0xa8, 0x9b,
                   0x82, 0xb,  0x95, 0x76, 0x21, 0xa6, 0x2,  0x0,  0x1c, 0xa7, 0x6f, 0x3,  0xf3, 0x36, 0xd2, 0x38, 0x2,
                   0xc7, 0xec, 0x68, 0x81, 0x48, 0x31, 0x4d, 0x93, 0x1d, 0xf1, 0x8f, 0x53, 0xf6, 0x42, 0x82, 0xea, 0xa0,
                   0xd7, 0xdf, 0xb8, 0x2,  0x0,  0x3,  0x1a, 0x71, 0xeb, 0x0,  0x0,  0xe,  0x5d, 0x67, 0xb5, 0x1a, 0x50,
                   0xe8, 0x68, 0xac, 0x1d, 0xb4, 0xf7, 0x1e, 0xcb, 0xec, 0x1,  0x0,  0x2,  0xc9, 0x9e, 0x1,  0x0,  0xc,
                   0x43, 0xe5, 0xbd, 0xbb, 0xab, 0xb9, 0x15, 0x6a, 0x41, 0x21, 0x81, 0xfd, 0x2};

  uint8_t buf[193] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xf1, 0x6d, 0xcc, 0xc2, 0x29, 0x31, 0x5c, 0x86, 0x4,
                                     0x6a, 0xfc, 0xfb, 0xb7, 0xa9, 0x6f, 0x7e, 0x2b};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa5, 0xdf, 0x9};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3,  0x29, 0xc0, 0x3,  0x45, 0xa4, 0x9e, 0xb5,
                                     0xef, 0xd8, 0x1,  0x83, 0xab, 0xc4, 0xcf};
  lwmqtt_string_t topic_filter_s2 = {15, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb6, 0x62, 0x43, 0x7c, 0xf0, 0x21, 0xdb, 0x14, 0x51, 0xc8, 0xa1};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xa0, 0xa2, 0x37, 0xe2, 0xc4, 0x28, 0x8d, 0x47, 0xa5, 0x8b,
                                     0xcf, 0xf,  0xff, 0xab, 0xfb, 0x4a, 0x12, 0x3,  0xa8, 0x71,
                                     0x27, 0x31, 0xf0, 0x2d, 0x5e, 0xb9, 0xc0, 0xbf, 0x5d};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x24, 0x25, 0xa8, 0x9b, 0x82, 0xb, 0x95, 0x76, 0x21, 0xa6};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xa7, 0x6f, 0x3,  0xf3, 0x36, 0xd2, 0x38, 0x2,  0xc7, 0xec,
                                     0x68, 0x81, 0x48, 0x31, 0x4d, 0x93, 0x1d, 0xf1, 0x8f, 0x53,
                                     0xf6, 0x42, 0x82, 0xea, 0xa0, 0xd7, 0xdf, 0xb8};
  lwmqtt_string_t topic_filter_s6 = {28, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x1a, 0x71, 0xeb};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x5d, 0x67, 0xb5, 0x1a, 0x50, 0xe8, 0x68,
                                     0xac, 0x1d, 0xb4, 0xf7, 0x1e, 0xcb, 0xec};
  lwmqtt_string_t topic_filter_s8 = {14, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xc9, 0x9e};
  lwmqtt_string_t topic_filter_s9 = {2, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x43, 0xe5, 0xbd, 0xbb, 0xab, 0xb9, 0x15, 0x6a, 0x41, 0x21, 0x81, 0xfd};
  lwmqtt_string_t topic_filter_s10 = {12, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 27717, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10081 [("\254\182\236\b\134\175Afy\149p\146)\CAN\196]\172",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\140\141\202Y\140aB-\ENQx\198i\168\DEL\ESC\244\250-",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode37) {
  uint8_t pkt[] = {0x82, 0x2b, 0x27, 0x61, 0x0,  0x11, 0xfe, 0xb6, 0xec, 0x8,  0x86, 0xaf, 0x41, 0x66, 0x79,
                   0x95, 0x70, 0x92, 0x29, 0x18, 0xc4, 0x5d, 0xac, 0x0,  0x0,  0x12, 0x8c, 0x8d, 0xca, 0x59,
                   0x8c, 0x61, 0x42, 0x2d, 0x5,  0x78, 0xc6, 0x69, 0xa8, 0x7f, 0x1b, 0xf4, 0xfa, 0x2d, 0x1};

  uint8_t buf[55] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xfe, 0xb6, 0xec, 0x8,  0x86, 0xaf, 0x41, 0x66, 0x79,
                                     0x95, 0x70, 0x92, 0x29, 0x18, 0xc4, 0x5d, 0xac};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8c, 0x8d, 0xca, 0x59, 0x8c, 0x61, 0x42, 0x2d, 0x5,
                                     0x78, 0xc6, 0x69, 0xa8, 0x7f, 0x1b, 0xf4, 0xfa, 0x2d};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10081, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12277 [("Qa\142\154\DC1\250'%d\167",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\251-\198\134\225\144X\220\STXN\142\199g*\SYN\128\238\209\135\238\166\183Q\232K)",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\173\&7va\196^-\248\&9\223;d\152(1\217u\154X\206\246\247\129o\211Z",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("8\207\165@\ESC\201\ri\241",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\141{KJ$\219&c3\196\b3,W\232`\131~\\\165\243\175\201\199E\240\SO6",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode38) {
  uint8_t pkt[] = {0x82, 0x74, 0x2f, 0xf5, 0x0,  0xa,  0x51, 0x61, 0x8e, 0x9a, 0x11, 0xfa, 0x27, 0x25, 0x64, 0xa7, 0x1,
                   0x0,  0x1a, 0xfb, 0x2d, 0xc6, 0x86, 0xe1, 0x90, 0x58, 0xdc, 0x2,  0x4e, 0x8e, 0xc7, 0x67, 0x2a, 0x16,
                   0x80, 0xee, 0xd1, 0x87, 0xee, 0xa6, 0xb7, 0x51, 0xe8, 0x4b, 0x29, 0x1,  0x0,  0x1a, 0xad, 0x37, 0x76,
                   0x61, 0xc4, 0x5e, 0x2d, 0xf8, 0x39, 0xdf, 0x3b, 0x64, 0x98, 0x28, 0x31, 0xd9, 0x75, 0x9a, 0x58, 0xce,
                   0xf6, 0xf7, 0x81, 0x6f, 0xd3, 0x5a, 0x1,  0x0,  0x9,  0x38, 0xcf, 0xa5, 0x40, 0x1b, 0xc9, 0xd,  0x69,
                   0xf1, 0x2,  0x0,  0x1c, 0x8d, 0x7b, 0x4b, 0x4a, 0x24, 0xdb, 0x26, 0x63, 0x33, 0xc4, 0x8,  0x33, 0x2c,
                   0x57, 0xe8, 0x60, 0x83, 0x7e, 0x5c, 0xa5, 0xf3, 0xaf, 0xc9, 0xc7, 0x45, 0xf0, 0xe,  0x36, 0x0};

  uint8_t buf[128] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x51, 0x61, 0x8e, 0x9a, 0x11, 0xfa, 0x27, 0x25, 0x64, 0xa7};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xfb, 0x2d, 0xc6, 0x86, 0xe1, 0x90, 0x58, 0xdc, 0x2,  0x4e, 0x8e, 0xc7, 0x67,
                                     0x2a, 0x16, 0x80, 0xee, 0xd1, 0x87, 0xee, 0xa6, 0xb7, 0x51, 0xe8, 0x4b, 0x29};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xad, 0x37, 0x76, 0x61, 0xc4, 0x5e, 0x2d, 0xf8, 0x39, 0xdf, 0x3b, 0x64, 0x98,
                                     0x28, 0x31, 0xd9, 0x75, 0x9a, 0x58, 0xce, 0xf6, 0xf7, 0x81, 0x6f, 0xd3, 0x5a};
  lwmqtt_string_t topic_filter_s2 = {26, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x38, 0xcf, 0xa5, 0x40, 0x1b, 0xc9, 0xd, 0x69, 0xf1};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8d, 0x7b, 0x4b, 0x4a, 0x24, 0xdb, 0x26, 0x63, 0x33, 0xc4,
                                     0x8,  0x33, 0x2c, 0x57, 0xe8, 0x60, 0x83, 0x7e, 0x5c, 0xa5,
                                     0xf3, 0xaf, 0xc9, 0xc7, 0x45, 0xf0, 0xe,  0x36};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12277, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 518 [("\139\STXE:n\137b\f\184\166\168\143a\150+/\136,\154\148\190k\196u\189n\n",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode39) {
  uint8_t pkt[] = {0x82, 0x20, 0x2,  0x6,  0x0,  0x1b, 0x8b, 0x2,  0x45, 0x3a, 0x6e, 0x89, 0x62, 0xc,  0xb8, 0xa6, 0xa8,
                   0x8f, 0x61, 0x96, 0x2b, 0x2f, 0x88, 0x2c, 0x9a, 0x94, 0xbe, 0x6b, 0xc4, 0x75, 0xbd, 0x6e, 0xa,  0x2};

  uint8_t buf[44] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x8b, 0x2,  0x45, 0x3a, 0x6e, 0x89, 0x62, 0xc,  0xb8, 0xa6, 0xa8, 0x8f, 0x61, 0x96,
                                     0x2b, 0x2f, 0x88, 0x2c, 0x9a, 0x94, 0xbe, 0x6b, 0xc4, 0x75, 0xbd, 0x6e, 0xa};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 518, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 20513 [("\246\249y9",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\174\158\&9I\236",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\234)\247\155]i\178i\160:\ENQ\162\186\204\194v^KTS.P\233&\189",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode40) {
  uint8_t pkt[] = {0x82, 0x2d, 0x50, 0x21, 0x0,  0x4,  0xf6, 0xf9, 0x79, 0x39, 0x0,  0x0,  0x5,  0xae, 0x9e, 0x39,
                   0x49, 0xec, 0x1,  0x0,  0x19, 0xea, 0x29, 0xf7, 0x9b, 0x5d, 0x69, 0xb2, 0x69, 0xa0, 0x3a, 0x5,
                   0xa2, 0xba, 0xcc, 0xc2, 0x76, 0x5e, 0x4b, 0x54, 0x53, 0x2e, 0x50, 0xe9, 0x26, 0xbd, 0x1};

  uint8_t buf[57] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xf6, 0xf9, 0x79, 0x39};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0x9e, 0x39, 0x49, 0xec};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xea, 0x29, 0xf7, 0x9b, 0x5d, 0x69, 0xb2, 0x69, 0xa0, 0x3a, 0x5,  0xa2, 0xba,
                                     0xcc, 0xc2, 0x76, 0x5e, 0x4b, 0x54, 0x53, 0x2e, 0x50, 0xe9, 0x26, 0xbd};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 20513, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13179 [("YR\212\171\209\EOTx\164\209\197\US\155",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\235",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\172\250G",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\r\149\246#m\237\132i\162%c\ESC\144\159F`\229\254\ENQG",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("}O6\STX\EM\250D>\167\STX",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\140\134n",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode41) {
  uint8_t pkt[] = {0x82, 0x48, 0x33, 0x7b, 0x0,  0xc,  0x59, 0x52, 0xd4, 0xab, 0xd1, 0x4,  0x78, 0xa4, 0xd1,
                   0xc5, 0x1f, 0x9b, 0x1,  0x0,  0x1,  0xeb, 0x1,  0x0,  0x3,  0xac, 0xfa, 0x47, 0x2,  0x0,
                   0x0,  0x2,  0x0,  0x14, 0xd,  0x95, 0xf6, 0x23, 0x6d, 0xed, 0x84, 0x69, 0xa2, 0x25, 0x63,
                   0x1b, 0x90, 0x9f, 0x46, 0x60, 0xe5, 0xfe, 0x5,  0x47, 0x1,  0x0,  0xa,  0x7d, 0x4f, 0x36,
                   0x2,  0x19, 0xfa, 0x44, 0x3e, 0xa7, 0x2,  0x0,  0x0,  0x3,  0x8c, 0x86, 0x6e, 0x2};

  uint8_t buf[84] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x59, 0x52, 0xd4, 0xab, 0xd1, 0x4, 0x78, 0xa4, 0xd1, 0xc5, 0x1f, 0x9b};
  lwmqtt_string_t topic_filter_s0 = {12, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xeb};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xac, 0xfa, 0x47};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0};
  lwmqtt_string_t topic_filter_s3 = {0, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd,  0x95, 0xf6, 0x23, 0x6d, 0xed, 0x84, 0x69, 0xa2, 0x25,
                                     0x63, 0x1b, 0x90, 0x9f, 0x46, 0x60, 0xe5, 0xfe, 0x5,  0x47};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x4f, 0x36, 0x2, 0x19, 0xfa, 0x44, 0x3e, 0xa7, 0x2};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8c, 0x86, 0x6e};
  lwmqtt_string_t topic_filter_s6 = {3, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 13179, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2708 [("\128\SUB\143\242\FS\143\181\142tg\159H\SI\193<",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\STX\194;\241\194\228a\t\191u0o\203O|\SUBV\174x\171\235\159\149\&6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("4\173\128\155%\a\234\DLE\166\&1\188\EOT@\142qQuA\154N",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\169p4\162\139:?",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\130)\226\134",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode42) {
  uint8_t pkt[] = {0x82, 0x57, 0xa,  0x94, 0x0,  0xf,  0x80, 0x1a, 0x8f, 0xf2, 0x1c, 0x8f, 0xb5, 0x8e, 0x74,
                   0x67, 0x9f, 0x48, 0xf,  0xc1, 0x3c, 0x1,  0x0,  0x18, 0x2,  0xc2, 0x3b, 0xf1, 0xc2, 0xe4,
                   0x61, 0x9,  0xbf, 0x75, 0x30, 0x6f, 0xcb, 0x4f, 0x7c, 0x1a, 0x56, 0xae, 0x78, 0xab, 0xeb,
                   0x9f, 0x95, 0x36, 0x2,  0x0,  0x14, 0x34, 0xad, 0x80, 0x9b, 0x25, 0x7,  0xea, 0x10, 0xa6,
                   0x31, 0xbc, 0x4,  0x40, 0x8e, 0x71, 0x51, 0x75, 0x41, 0x9a, 0x4e, 0x1,  0x0,  0x7,  0xa9,
                   0x70, 0x34, 0xa2, 0x8b, 0x3a, 0x3f, 0x1,  0x0,  0x4,  0x82, 0x29, 0xe2, 0x86, 0x0};

  uint8_t buf[99] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x80, 0x1a, 0x8f, 0xf2, 0x1c, 0x8f, 0xb5, 0x8e,
                                     0x74, 0x67, 0x9f, 0x48, 0xf,  0xc1, 0x3c};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2,  0xc2, 0x3b, 0xf1, 0xc2, 0xe4, 0x61, 0x9,  0xbf, 0x75, 0x30, 0x6f,
                                     0xcb, 0x4f, 0x7c, 0x1a, 0x56, 0xae, 0x78, 0xab, 0xeb, 0x9f, 0x95, 0x36};
  lwmqtt_string_t topic_filter_s1 = {24, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x34, 0xad, 0x80, 0x9b, 0x25, 0x7,  0xea, 0x10, 0xa6, 0x31,
                                     0xbc, 0x4,  0x40, 0x8e, 0x71, 0x51, 0x75, 0x41, 0x9a, 0x4e};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa9, 0x70, 0x34, 0xa2, 0x8b, 0x3a, 0x3f};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x82, 0x29, 0xe2, 0x86};
  lwmqtt_string_t topic_filter_s4 = {4, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2708, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22393 [("4\151\147%\225\205\145\214",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\170\240\162w`E\254\232
// \143\DC2x\209h3\148\197\DEL\195~\165h\DLE\232\201Bm",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\248\158\234\227[R.\240VV'\227@\DC3)\DLE\242\199\US\199\221H\199",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode43) {
  uint8_t pkt[] = {0x82, 0x45, 0x57, 0x79, 0x0,  0x8,  0x34, 0x97, 0x93, 0x25, 0xe1, 0xcd, 0x91, 0xd6, 0x2,
                   0x0,  0x1b, 0xaa, 0xf0, 0xa2, 0x77, 0x60, 0x45, 0xfe, 0xe8, 0x20, 0x8f, 0x12, 0x78, 0xd1,
                   0x68, 0x33, 0x94, 0xc5, 0x7f, 0xc3, 0x7e, 0xa5, 0x68, 0x10, 0xe8, 0xc9, 0x42, 0x6d, 0x2,
                   0x0,  0x17, 0xf8, 0x9e, 0xea, 0xe3, 0x5b, 0x52, 0x2e, 0xf0, 0x56, 0x56, 0x27, 0xe3, 0x40,
                   0x13, 0x29, 0x10, 0xf2, 0xc7, 0x1f, 0xc7, 0xdd, 0x48, 0xc7, 0x0};

  uint8_t buf[81] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x34, 0x97, 0x93, 0x25, 0xe1, 0xcd, 0x91, 0xd6};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaa, 0xf0, 0xa2, 0x77, 0x60, 0x45, 0xfe, 0xe8, 0x20, 0x8f, 0x12, 0x78, 0xd1, 0x68,
                                     0x33, 0x94, 0xc5, 0x7f, 0xc3, 0x7e, 0xa5, 0x68, 0x10, 0xe8, 0xc9, 0x42, 0x6d};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf8, 0x9e, 0xea, 0xe3, 0x5b, 0x52, 0x2e, 0xf0, 0x56, 0x56, 0x27, 0xe3,
                                     0x40, 0x13, 0x29, 0x10, 0xf2, 0xc7, 0x1f, 0xc7, 0xdd, 0x48, 0xc7};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 22393, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16009 [("\v\252$!\153S\184\231\225\247\182w\185\196\179\251-)D\130W\129\222\SYNQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Bn\211\153\\\EOT\238\190\196\180C1\146B\199\236h\DC1\210\&9,\147I",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\EOT;7\159\130c%\243\CAN\148\213\v\247'",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\220\225\t\132\131\223\183",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode44) {
  uint8_t pkt[] = {0x82, 0x53, 0x3e, 0x89, 0x0,  0x19, 0xb,  0xfc, 0x24, 0x21, 0x99, 0x53, 0xb8, 0xe7, 0xe1, 0xf7, 0xb6,
                   0x77, 0xb9, 0xc4, 0xb3, 0xfb, 0x2d, 0x29, 0x44, 0x82, 0x57, 0x81, 0xde, 0x16, 0x51, 0x2,  0x0,  0x17,
                   0x42, 0x6e, 0xd3, 0x99, 0x5c, 0x4,  0xee, 0xbe, 0xc4, 0xb4, 0x43, 0x31, 0x92, 0x42, 0xc7, 0xec, 0x68,
                   0x11, 0xd2, 0x39, 0x2c, 0x93, 0x49, 0x1,  0x0,  0xe,  0x4,  0x3b, 0x37, 0x9f, 0x82, 0x63, 0x25, 0xf3,
                   0x18, 0x94, 0xd5, 0xb,  0xf7, 0x27, 0x1,  0x0,  0x7,  0xdc, 0xe1, 0x9,  0x84, 0x83, 0xdf, 0xb7, 0x1};

  uint8_t buf[95] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xb,  0xfc, 0x24, 0x21, 0x99, 0x53, 0xb8, 0xe7, 0xe1, 0xf7, 0xb6, 0x77, 0xb9,
                                     0xc4, 0xb3, 0xfb, 0x2d, 0x29, 0x44, 0x82, 0x57, 0x81, 0xde, 0x16, 0x51};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x42, 0x6e, 0xd3, 0x99, 0x5c, 0x4,  0xee, 0xbe, 0xc4, 0xb4, 0x43, 0x31,
                                     0x92, 0x42, 0xc7, 0xec, 0x68, 0x11, 0xd2, 0x39, 0x2c, 0x93, 0x49};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4, 0x3b, 0x37, 0x9f, 0x82, 0x63, 0x25, 0xf3, 0x18, 0x94, 0xd5, 0xb, 0xf7, 0x27};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xdc, 0xe1, 0x9, 0x84, 0x83, 0xdf, 0xb7};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 16009, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14676 [("\219\215v\249b\191\208\&8H\181\rI&\210",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode45) {
  uint8_t pkt[] = {0x82, 0x13, 0x39, 0x54, 0x0,  0xe, 0xdb, 0xd7, 0x76, 0xf9, 0x62,
                   0xbf, 0xd0, 0x38, 0x48, 0xb5, 0xd, 0x49, 0x26, 0xd2, 0x1};

  uint8_t buf[31] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xdb, 0xd7, 0x76, 0xf9, 0x62, 0xbf, 0xd0, 0x38, 0x48, 0xb5, 0xd, 0x49, 0x26, 0xd2};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14676, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2406
// [("\154wi\237\149\207\222\244\234fa?\209A\DEL\205\221\&5\DLE\224@\211\160\208\239\&0\134\SO\NUL",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("L|I\231\128\172e\STX@\198x",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("Sa \169\184R\183\199\225\251\153%v6\228H\"\244J\193",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),(";\"\b\143\221\r",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\210\147\237\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\141\237\229\157\173\ETXX/\224\174,\\\236\228",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\219\SOH\f)\241\252",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode46) {
  uint8_t pkt[] = {0x82, 0x71, 0x9,  0x66, 0x0,  0x1d, 0x9a, 0x77, 0x69, 0xed, 0x95, 0xcf, 0xde, 0xf4, 0xea, 0x66, 0x61,
                   0x3f, 0xd1, 0x41, 0x7f, 0xcd, 0xdd, 0x35, 0x10, 0xe0, 0x40, 0xd3, 0xa0, 0xd0, 0xef, 0x30, 0x86, 0xe,
                   0x0,  0x0,  0x0,  0xb,  0x4c, 0x7c, 0x49, 0xe7, 0x80, 0xac, 0x65, 0x2,  0x40, 0xc6, 0x78, 0x0,  0x0,
                   0x14, 0x53, 0x61, 0x20, 0xa9, 0xb8, 0x52, 0xb7, 0xc7, 0xe1, 0xfb, 0x99, 0x25, 0x76, 0x36, 0xe4, 0x48,
                   0x22, 0xf4, 0x4a, 0xc1, 0x0,  0x0,  0x6,  0x3b, 0x22, 0x8,  0x8f, 0xdd, 0xd,  0x0,  0x0,  0x4,  0xd2,
                   0x93, 0xed, 0x19, 0x2,  0x0,  0xe,  0x8d, 0xed, 0xe5, 0x9d, 0xad, 0x3,  0x58, 0x2f, 0xe0, 0xae, 0x2c,
                   0x5c, 0xec, 0xe4, 0x2,  0x0,  0x6,  0xdb, 0x1,  0xc,  0x29, 0xf1, 0xfc, 0x1};

  uint8_t buf[125] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x9a, 0x77, 0x69, 0xed, 0x95, 0xcf, 0xde, 0xf4, 0xea, 0x66,
                                     0x61, 0x3f, 0xd1, 0x41, 0x7f, 0xcd, 0xdd, 0x35, 0x10, 0xe0,
                                     0x40, 0xd3, 0xa0, 0xd0, 0xef, 0x30, 0x86, 0xe,  0x0};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x4c, 0x7c, 0x49, 0xe7, 0x80, 0xac, 0x65, 0x2, 0x40, 0xc6, 0x78};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x61, 0x20, 0xa9, 0xb8, 0x52, 0xb7, 0xc7, 0xe1, 0xfb,
                                     0x99, 0x25, 0x76, 0x36, 0xe4, 0x48, 0x22, 0xf4, 0x4a, 0xc1};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3b, 0x22, 0x8, 0x8f, 0xdd, 0xd};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd2, 0x93, 0xed, 0x19};
  lwmqtt_string_t topic_filter_s4 = {4, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8d, 0xed, 0xe5, 0x9d, 0xad, 0x3, 0x58, 0x2f, 0xe0, 0xae, 0x2c, 0x5c, 0xec, 0xe4};
  lwmqtt_string_t topic_filter_s5 = {14, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xdb, 0x1, 0xc, 0x29, 0xf1, 0xfc};
  lwmqtt_string_t topic_filter_s6 = {6, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2406, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4955 [("\ENQ\139D6\149b\234\144\205\249k\207\248\b5\137\DC1\211*i\214\212Z\197\232\EM",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\193\&7\178\197`\133\195'\217\NAK\245\130i",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\vU\DEL\193\165\247\239O\244\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode47) {
  uint8_t pkt[] = {0x82, 0x3c, 0x13, 0x5b, 0x0,  0x1a, 0x5,  0x8b, 0x44, 0x36, 0x95, 0x62, 0xea, 0x90, 0xcd, 0xf9,
                   0x6b, 0xcf, 0xf8, 0x8,  0x35, 0x89, 0x11, 0xd3, 0x2a, 0x69, 0xd6, 0xd4, 0x5a, 0xc5, 0xe8, 0x19,
                   0x0,  0x0,  0xd,  0xc1, 0x37, 0xb2, 0xc5, 0x60, 0x85, 0xc3, 0x27, 0xd9, 0x15, 0xf5, 0x82, 0x69,
                   0x1,  0x0,  0xa,  0xb,  0x55, 0x7f, 0xc1, 0xa5, 0xf7, 0xef, 0x4f, 0xf4, 0xdc, 0x1};

  uint8_t buf[72] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x5, 0x8b, 0x44, 0x36, 0x95, 0x62, 0xea, 0x90, 0xcd, 0xf9, 0x6b, 0xcf, 0xf8,
                                     0x8, 0x35, 0x89, 0x11, 0xd3, 0x2a, 0x69, 0xd6, 0xd4, 0x5a, 0xc5, 0xe8, 0x19};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x37, 0xb2, 0xc5, 0x60, 0x85, 0xc3, 0x27, 0xd9, 0x15, 0xf5, 0x82, 0x69};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb, 0x55, 0x7f, 0xc1, 0xa5, 0xf7, 0xef, 0x4f, 0xf4, 0xdc};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4955, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 11203 [("\204\DC2P\234<\186\CANVS(\203F\SO\243\v\199\215\190\165-j\243",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\131\130\210u\174\253S\151\142FR\139\135\186\209\232\170\138\156\&1\NAKf\158E\186\167",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("#\151\&7\NULk\190\232\&6\DEL\DC4H\212\161\&6:\225",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\198\255$N$\183E\246\148\&8\242:\214\128\&2\178\149v/\140",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("O:\185)_;T{\187\198[\166&\148\153\147\203\\YB+Z\169fv\133\rL",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\182\ESC\138\244\250D\150\219B\SI\149\ENQ\172]i\166&\153\190~\228\193>\209",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\143\&6\\:",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode48) {
  uint8_t pkt[] = {0x82, 0xa3, 0x1,  0x2b, 0xc3, 0x0,  0x16, 0xcc, 0x12, 0x50, 0xea, 0x3c, 0xba, 0x18, 0x56, 0x53, 0x28,
                   0xcb, 0x46, 0xe,  0xf3, 0xb,  0xc7, 0xd7, 0xbe, 0xa5, 0x2d, 0x6a, 0xf3, 0x0,  0x0,  0x1a, 0x83, 0x82,
                   0xd2, 0x75, 0xae, 0xfd, 0x53, 0x97, 0x8e, 0x46, 0x52, 0x8b, 0x87, 0xba, 0xd1, 0xe8, 0xaa, 0x8a, 0x9c,
                   0x31, 0x15, 0x66, 0x9e, 0x45, 0xba, 0xa7, 0x2,  0x0,  0x10, 0x23, 0x97, 0x37, 0x0,  0x6b, 0xbe, 0xe8,
                   0x36, 0x7f, 0x14, 0x48, 0xd4, 0xa1, 0x36, 0x3a, 0xe1, 0x0,  0x0,  0x14, 0xc6, 0xff, 0x24, 0x4e, 0x24,
                   0xb7, 0x45, 0xf6, 0x94, 0x38, 0xf2, 0x3a, 0xd6, 0x80, 0x32, 0xb2, 0x95, 0x76, 0x2f, 0x8c, 0x0,  0x0,
                   0x1c, 0x4f, 0x3a, 0xb9, 0x29, 0x5f, 0x3b, 0x54, 0x7b, 0xbb, 0xc6, 0x5b, 0xa6, 0x26, 0x94, 0x99, 0x93,
                   0xcb, 0x5c, 0x59, 0x42, 0x2b, 0x5a, 0xa9, 0x66, 0x76, 0x85, 0xd,  0x4c, 0x0,  0x0,  0x18, 0xb6, 0x1b,
                   0x8a, 0xf4, 0xfa, 0x44, 0x96, 0xdb, 0x42, 0xf,  0x95, 0x5,  0xac, 0x5d, 0x69, 0xa6, 0x26, 0x99, 0xbe,
                   0x7e, 0xe4, 0xc1, 0x3e, 0xd1, 0x1,  0x0,  0x4,  0x8f, 0x36, 0x5c, 0x3a, 0x1};

  uint8_t buf[176] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xcc, 0x12, 0x50, 0xea, 0x3c, 0xba, 0x18, 0x56, 0x53, 0x28, 0xcb,
                                     0x46, 0xe,  0xf3, 0xb,  0xc7, 0xd7, 0xbe, 0xa5, 0x2d, 0x6a, 0xf3};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x83, 0x82, 0xd2, 0x75, 0xae, 0xfd, 0x53, 0x97, 0x8e, 0x46, 0x52, 0x8b, 0x87,
                                     0xba, 0xd1, 0xe8, 0xaa, 0x8a, 0x9c, 0x31, 0x15, 0x66, 0x9e, 0x45, 0xba, 0xa7};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x23, 0x97, 0x37, 0x0,  0x6b, 0xbe, 0xe8, 0x36,
                                     0x7f, 0x14, 0x48, 0xd4, 0xa1, 0x36, 0x3a, 0xe1};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc6, 0xff, 0x24, 0x4e, 0x24, 0xb7, 0x45, 0xf6, 0x94, 0x38,
                                     0xf2, 0x3a, 0xd6, 0x80, 0x32, 0xb2, 0x95, 0x76, 0x2f, 0x8c};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4f, 0x3a, 0xb9, 0x29, 0x5f, 0x3b, 0x54, 0x7b, 0xbb, 0xc6,
                                     0x5b, 0xa6, 0x26, 0x94, 0x99, 0x93, 0xcb, 0x5c, 0x59, 0x42,
                                     0x2b, 0x5a, 0xa9, 0x66, 0x76, 0x85, 0xd,  0x4c};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xb6, 0x1b, 0x8a, 0xf4, 0xfa, 0x44, 0x96, 0xdb, 0x42, 0xf,  0x95, 0x5,
                                     0xac, 0x5d, 0x69, 0xa6, 0x26, 0x99, 0xbe, 0x7e, 0xe4, 0xc1, 0x3e, 0xd1};
  lwmqtt_string_t topic_filter_s5 = {24, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8f, 0x36, 0x5c, 0x3a};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 11203, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30275 [("\NAK\ENQ",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode49) {
  uint8_t pkt[] = {0x82, 0x7, 0x76, 0x43, 0x0, 0x2, 0x15, 0x5, 0x2};

  uint8_t buf[19] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x5};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 30275, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16095 [("\NAK;\166\150$",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("~U\133\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\187m\GS\SOH\205\135\128<\RS\242\204^T\DC1]\f'\v\166\151\218v\STX\FS\131>\NUL",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("n\134\188wS\138\128\229\&1w*\244&",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode50) {
  uint8_t pkt[] = {0x82, 0x3f, 0x3e, 0xdf, 0x0,  0x5,  0x15, 0x3b, 0xa6, 0x96, 0x24, 0x1,  0x0,  0x4,  0x7e, 0x55, 0x85,
                   0x19, 0x1,  0x0,  0x1b, 0xbb, 0x6d, 0x1d, 0x1,  0xcd, 0x87, 0x80, 0x3c, 0x1e, 0xf2, 0xcc, 0x5e, 0x54,
                   0x11, 0x5d, 0xc,  0x27, 0xb,  0xa6, 0x97, 0xda, 0x76, 0x2,  0x1c, 0x83, 0x3e, 0x0,  0x0,  0x0,  0xd,
                   0x6e, 0x86, 0xbc, 0x77, 0x53, 0x8a, 0x80, 0xe5, 0x31, 0x77, 0x2a, 0xf4, 0x26, 0x2};

  uint8_t buf[75] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x3b, 0xa6, 0x96, 0x24};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7e, 0x55, 0x85, 0x19};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbb, 0x6d, 0x1d, 0x1, 0xcd, 0x87, 0x80, 0x3c, 0x1e, 0xf2, 0xcc, 0x5e, 0x54, 0x11,
                                     0x5d, 0xc,  0x27, 0xb, 0xa6, 0x97, 0xda, 0x76, 0x2,  0x1c, 0x83, 0x3e, 0x0};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6e, 0x86, 0xbc, 0x77, 0x53, 0x8a, 0x80, 0xe5, 0x31, 0x77, 0x2a, 0xf4, 0x26};
  lwmqtt_string_t topic_filter_s3 = {13, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 16095, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27116 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode51) {
  uint8_t pkt[] = {0x82, 0x5, 0x69, 0xec, 0x0, 0x0, 0x1};

  uint8_t buf[17] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 27116, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21718 [("1\174I~\249\CAN\ETB\DC1\225r>\134\n\208\t\160\184\206T\DC3\207L:\206C\137\158",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\207\SI\180J\RSA\SYN\212",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\b\176\222\185\206Sp\170\133",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode52) {
  uint8_t pkt[] = {0x82, 0x37, 0x54, 0xd6, 0x0,  0x1b, 0x31, 0xae, 0x49, 0x7e, 0xf9, 0x18, 0x17, 0x11, 0xe1,
                   0x72, 0x3e, 0x86, 0xa,  0xd0, 0x9,  0xa0, 0xb8, 0xce, 0x54, 0x13, 0xcf, 0x4c, 0x3a, 0xce,
                   0x43, 0x89, 0x9e, 0x2,  0x0,  0x8,  0xcf, 0xf,  0xb4, 0x4a, 0x1e, 0x41, 0x16, 0xd4, 0x1,
                   0x0,  0x9,  0x8,  0xb0, 0xde, 0xb9, 0xce, 0x53, 0x70, 0xaa, 0x85, 0x0};

  uint8_t buf[67] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x31, 0xae, 0x49, 0x7e, 0xf9, 0x18, 0x17, 0x11, 0xe1, 0x72, 0x3e, 0x86, 0xa, 0xd0,
                                     0x9,  0xa0, 0xb8, 0xce, 0x54, 0x13, 0xcf, 0x4c, 0x3a, 0xce, 0x43, 0x89, 0x9e};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcf, 0xf, 0xb4, 0x4a, 0x1e, 0x41, 0x16, 0xd4};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8, 0xb0, 0xde, 0xb9, 0xce, 0x53, 0x70, 0xaa, 0x85};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21718, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 32713 [("2\214\247\243(1\182\&4\130\248PZ\198\183\251=\\\128w\163\165~o\202",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("Z\195\171v<ncn\157",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\217\201\212Q\167\135\197\180\132\211\159.",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\219\CANe\r\135#\220",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode53) {
  uint8_t pkt[] = {0x82, 0x42, 0x7f, 0xc9, 0x0,  0x18, 0x32, 0xd6, 0xf7, 0xf3, 0x28, 0x31, 0xb6, 0x34, 0x82, 0xf8, 0x50,
                   0x5a, 0xc6, 0xb7, 0xfb, 0x3d, 0x5c, 0x80, 0x77, 0xa3, 0xa5, 0x7e, 0x6f, 0xca, 0x1,  0x0,  0x9,  0x5a,
                   0xc3, 0xab, 0x76, 0x3c, 0x6e, 0x63, 0x6e, 0x9d, 0x2,  0x0,  0xc,  0xd9, 0xc9, 0xd4, 0x51, 0xa7, 0x87,
                   0xc5, 0xb4, 0x84, 0xd3, 0x9f, 0x2e, 0x2,  0x0,  0x7,  0xdb, 0x18, 0x65, 0xd,  0x87, 0x23, 0xdc, 0x2};

  uint8_t buf[78] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x32, 0xd6, 0xf7, 0xf3, 0x28, 0x31, 0xb6, 0x34, 0x82, 0xf8, 0x50, 0x5a,
                                     0xc6, 0xb7, 0xfb, 0x3d, 0x5c, 0x80, 0x77, 0xa3, 0xa5, 0x7e, 0x6f, 0xca};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x5a, 0xc3, 0xab, 0x76, 0x3c, 0x6e, 0x63, 0x6e, 0x9d};
  lwmqtt_string_t topic_filter_s1 = {9, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xd9, 0xc9, 0xd4, 0x51, 0xa7, 0x87, 0xc5, 0xb4, 0x84, 0xd3, 0x9f, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xdb, 0x18, 0x65, 0xd, 0x87, 0x23, 0xdc};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 32713, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 29246 [("\237a\128\&0\FS\162\&4\135a\134-.\243=Z\131\255f^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("Wjn\237\248",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\140\183\154\b\172n\b)\ETXd",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("=\136\EOTZm\DC4\133\150\247V\183\175\213\168MPE\207a\189\171\233",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("UL\a\161\168U0\ETB\155\ESCn/\195\199\239:\170\185?\205\157\246\161x\218\242(\140\187",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\251\137,\142\241\190\248\206\209\242",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\187\133\204\252\DC3\170\128",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("k\t\DC1I(\ESC\193Zo\174\DC1D\153\213\166\n\141\158\ENQ\200",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode54) {
  uint8_t pkt[] = {0x82, 0x94, 0x1,  0x72, 0x3e, 0x0,  0x13, 0xed, 0x61, 0x80, 0x30, 0x1c, 0xa2, 0x34, 0x87, 0x61, 0x86,
                   0x2d, 0x2e, 0xf3, 0x3d, 0x5a, 0x83, 0xff, 0x66, 0x5e, 0x1,  0x0,  0x5,  0x57, 0x6a, 0x6e, 0xed, 0xf8,
                   0x2,  0x0,  0xa,  0x8c, 0xb7, 0x9a, 0x8,  0xac, 0x6e, 0x8,  0x29, 0x3,  0x64, 0x1,  0x0,  0x16, 0x3d,
                   0x88, 0x4,  0x5a, 0x6d, 0x14, 0x85, 0x96, 0xf7, 0x56, 0xb7, 0xaf, 0xd5, 0xa8, 0x4d, 0x50, 0x45, 0xcf,
                   0x61, 0xbd, 0xab, 0xe9, 0x0,  0x0,  0x1d, 0x55, 0x4c, 0x7,  0xa1, 0xa8, 0x55, 0x30, 0x17, 0x9b, 0x1b,
                   0x6e, 0x2f, 0xc3, 0xc7, 0xef, 0x3a, 0xaa, 0xb9, 0x3f, 0xcd, 0x9d, 0xf6, 0xa1, 0x78, 0xda, 0xf2, 0x28,
                   0x8c, 0xbb, 0x0,  0x0,  0xa,  0xfb, 0x89, 0x2c, 0x8e, 0xf1, 0xbe, 0xf8, 0xce, 0xd1, 0xf2, 0x1,  0x0,
                   0x7,  0xbb, 0x85, 0xcc, 0xfc, 0x13, 0xaa, 0x80, 0x0,  0x0,  0x14, 0x6b, 0x9,  0x11, 0x49, 0x28, 0x1b,
                   0xc1, 0x5a, 0x6f, 0xae, 0x11, 0x44, 0x99, 0xd5, 0xa6, 0xa,  0x8d, 0x9e, 0x5,  0xc8, 0x0};

  uint8_t buf[161] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xed, 0x61, 0x80, 0x30, 0x1c, 0xa2, 0x34, 0x87, 0x61, 0x86,
                                     0x2d, 0x2e, 0xf3, 0x3d, 0x5a, 0x83, 0xff, 0x66, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x57, 0x6a, 0x6e, 0xed, 0xf8};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8c, 0xb7, 0x9a, 0x8, 0xac, 0x6e, 0x8, 0x29, 0x3, 0x64};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3d, 0x88, 0x4,  0x5a, 0x6d, 0x14, 0x85, 0x96, 0xf7, 0x56, 0xb7,
                                     0xaf, 0xd5, 0xa8, 0x4d, 0x50, 0x45, 0xcf, 0x61, 0xbd, 0xab, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x55, 0x4c, 0x7,  0xa1, 0xa8, 0x55, 0x30, 0x17, 0x9b, 0x1b,
                                     0x6e, 0x2f, 0xc3, 0xc7, 0xef, 0x3a, 0xaa, 0xb9, 0x3f, 0xcd,
                                     0x9d, 0xf6, 0xa1, 0x78, 0xda, 0xf2, 0x28, 0x8c, 0xbb};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xfb, 0x89, 0x2c, 0x8e, 0xf1, 0xbe, 0xf8, 0xce, 0xd1, 0xf2};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xbb, 0x85, 0xcc, 0xfc, 0x13, 0xaa, 0x80};
  lwmqtt_string_t topic_filter_s6 = {7, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x6b, 0x9,  0x11, 0x49, 0x28, 0x1b, 0xc1, 0x5a, 0x6f, 0xae,
                                     0x11, 0x44, 0x99, 0xd5, 0xa6, 0xa,  0x8d, 0x9e, 0x5,  0xc8};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 29246, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2039 [("\134\204K\176hu :\174\236V\DC1u\178\203",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\US\NULy38e\DC4\186\218\247&\r\202\247\214\221\158\tO:\146?c\221\188\174\202\241\206",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode55) {
  uint8_t pkt[] = {0x82, 0x34, 0x7,  0xf7, 0x0,  0xf,  0x86, 0xcc, 0x4b, 0xb0, 0x68, 0x75, 0x20, 0x3a,
                   0xae, 0xec, 0x56, 0x11, 0x75, 0xb2, 0xcb, 0x1,  0x0,  0x1d, 0x1f, 0x0,  0x79, 0x33,
                   0x38, 0x65, 0x14, 0xba, 0xda, 0xf7, 0x26, 0xd,  0xca, 0xf7, 0xd6, 0xdd, 0x9e, 0x9,
                   0x4f, 0x3a, 0x92, 0x3f, 0x63, 0xdd, 0xbc, 0xae, 0xca, 0xf1, 0xce, 0x2};

  uint8_t buf[64] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0xcc, 0x4b, 0xb0, 0x68, 0x75, 0x20, 0x3a,
                                     0xae, 0xec, 0x56, 0x11, 0x75, 0xb2, 0xcb};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1f, 0x0,  0x79, 0x33, 0x38, 0x65, 0x14, 0xba, 0xda, 0xf7,
                                     0x26, 0xd,  0xca, 0xf7, 0xd6, 0xdd, 0x9e, 0x9,  0x4f, 0x3a,
                                     0x92, 0x3f, 0x63, 0xdd, 0xbc, 0xae, 0xca, 0xf1, 0xce};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2039, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 29065
// [("^Q\224\196\169V\128\198eL\204\194\202.?\DEL\NAK\206Z\162;V\t\163\214\DLE\156\232",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\216\186a\141",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\173\DC4j\205\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode56) {
  uint8_t pkt[] = {0x82, 0x30, 0x71, 0x89, 0x0,  0x1c, 0x5e, 0x51, 0xe0, 0xc4, 0xa9, 0x56, 0x80, 0xc6, 0x65, 0x4c, 0xcc,
                   0xc2, 0xca, 0x2e, 0x3f, 0x7f, 0x15, 0xce, 0x5a, 0xa2, 0x3b, 0x56, 0x9,  0xa3, 0xd6, 0x10, 0x9c, 0xe8,
                   0x1,  0x0,  0x4,  0xd8, 0xba, 0x61, 0x8d, 0x1,  0x0,  0x5,  0xad, 0x14, 0x6a, 0xcd, 0xeb, 0x2};

  uint8_t buf[60] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x5e, 0x51, 0xe0, 0xc4, 0xa9, 0x56, 0x80, 0xc6, 0x65, 0x4c,
                                     0xcc, 0xc2, 0xca, 0x2e, 0x3f, 0x7f, 0x15, 0xce, 0x5a, 0xa2,
                                     0x3b, 0x56, 0x9,  0xa3, 0xd6, 0x10, 0x9c, 0xe8};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd8, 0xba, 0x61, 0x8d};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xad, 0x14, 0x6a, 0xcd, 0xeb};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 29065, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 6655 [("x\149\146\242D\207\254D\208\218\227h\141>hT\212\152\tmFk\v\159",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("v[g\156",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode57) {
  uint8_t pkt[] = {0x82, 0x24, 0x19, 0xff, 0x0,  0x18, 0x78, 0x95, 0x92, 0xf2, 0x44, 0xcf, 0xfe,
                   0x44, 0xd0, 0xda, 0xe3, 0x68, 0x8d, 0x3e, 0x68, 0x54, 0xd4, 0x98, 0x9,  0x6d,
                   0x46, 0x6b, 0xb,  0x9f, 0x2,  0x0,  0x4,  0x76, 0x5b, 0x67, 0x9c, 0x0};

  uint8_t buf[48] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x78, 0x95, 0x92, 0xf2, 0x44, 0xcf, 0xfe, 0x44, 0xd0, 0xda, 0xe3, 0x68,
                                     0x8d, 0x3e, 0x68, 0x54, 0xd4, 0x98, 0x9,  0x6d, 0x46, 0x6b, 0xb,  0x9f};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x76, 0x5b, 0x67, 0x9c};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 6655, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2977 [("\137K3uf\128\132\202\FS\FS\224`z\196\144d\197\197\158\200y\233\ACK\184\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\171c\189\177zn\130)$\236\168",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\204\230!\136BX\135:J\204\170O\186\244\SO\140L2\187\"\132",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\185TD=\248\202\150\235L\245\DC4\184\200\145\EM\255\170\192\203\233\178\205\230\"w",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\138\215!n9\139\196\249\192\194\244\135Z'\136\194",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("S\170L\DC2\175\154u\143\228\222\"p8\148\148\170\224\213\161\189\147",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode58) {
  uint8_t pkt[] = {0x82, 0x8b, 0x1,  0xb,  0xa1, 0x0,  0x19, 0x89, 0x4b, 0x33, 0x75, 0x66, 0x80, 0x84, 0xca, 0x1c,
                   0x1c, 0xe0, 0x60, 0x7a, 0xc4, 0x90, 0x64, 0xc5, 0xc5, 0x9e, 0xc8, 0x79, 0xe9, 0x6,  0xb8, 0xdc,
                   0x2,  0x0,  0xb,  0xab, 0x63, 0xbd, 0xb1, 0x7a, 0x6e, 0x82, 0x29, 0x24, 0xec, 0xa8, 0x1,  0x0,
                   0x15, 0xcc, 0xe6, 0x21, 0x88, 0x42, 0x58, 0x87, 0x3a, 0x4a, 0xcc, 0xaa, 0x4f, 0xba, 0xf4, 0xe,
                   0x8c, 0x4c, 0x32, 0xbb, 0x22, 0x84, 0x1,  0x0,  0x19, 0xb9, 0x54, 0x44, 0x3d, 0xf8, 0xca, 0x96,
                   0xeb, 0x4c, 0xf5, 0x14, 0xb8, 0xc8, 0x91, 0x19, 0xff, 0xaa, 0xc0, 0xcb, 0xe9, 0xb2, 0xcd, 0xe6,
                   0x22, 0x77, 0x1,  0x0,  0x10, 0x8a, 0xd7, 0x21, 0x6e, 0x39, 0x8b, 0xc4, 0xf9, 0xc0, 0xc2, 0xf4,
                   0x87, 0x5a, 0x27, 0x88, 0xc2, 0x0,  0x0,  0x15, 0x53, 0xaa, 0x4c, 0x12, 0xaf, 0x9a, 0x75, 0x8f,
                   0xe4, 0xde, 0x22, 0x70, 0x38, 0x94, 0x94, 0xaa, 0xe0, 0xd5, 0xa1, 0xbd, 0x93, 0x0};

  uint8_t buf[152] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x89, 0x4b, 0x33, 0x75, 0x66, 0x80, 0x84, 0xca, 0x1c, 0x1c, 0xe0, 0x60, 0x7a,
                                     0xc4, 0x90, 0x64, 0xc5, 0xc5, 0x9e, 0xc8, 0x79, 0xe9, 0x6,  0xb8, 0xdc};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x63, 0xbd, 0xb1, 0x7a, 0x6e, 0x82, 0x29, 0x24, 0xec, 0xa8};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xcc, 0xe6, 0x21, 0x88, 0x42, 0x58, 0x87, 0x3a, 0x4a, 0xcc, 0xaa,
                                     0x4f, 0xba, 0xf4, 0xe,  0x8c, 0x4c, 0x32, 0xbb, 0x22, 0x84};
  lwmqtt_string_t topic_filter_s2 = {21, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb9, 0x54, 0x44, 0x3d, 0xf8, 0xca, 0x96, 0xeb, 0x4c, 0xf5, 0x14, 0xb8, 0xc8,
                                     0x91, 0x19, 0xff, 0xaa, 0xc0, 0xcb, 0xe9, 0xb2, 0xcd, 0xe6, 0x22, 0x77};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8a, 0xd7, 0x21, 0x6e, 0x39, 0x8b, 0xc4, 0xf9,
                                     0xc0, 0xc2, 0xf4, 0x87, 0x5a, 0x27, 0x88, 0xc2};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x53, 0xaa, 0x4c, 0x12, 0xaf, 0x9a, 0x75, 0x8f, 0xe4, 0xde, 0x22,
                                     0x70, 0x38, 0x94, 0x94, 0xaa, 0xe0, 0xd5, 0xa1, 0xbd, 0x93};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 2977, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14796 [("dL\223\173OD1\b",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\194\241\150\GS\SYN\239\&9\227\136c\138\225ItdFP",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode59) {
  uint8_t pkt[] = {0x82, 0x21, 0x39, 0xcc, 0x0,  0x8,  0x64, 0x4c, 0xdf, 0xad, 0x4f, 0x44,
                   0x31, 0x8,  0x1,  0x0,  0x11, 0xc2, 0xf1, 0x96, 0x1d, 0x16, 0xef, 0x39,
                   0xe3, 0x88, 0x63, 0x8a, 0xe1, 0x49, 0x74, 0x64, 0x46, 0x50, 0x1};

  uint8_t buf[45] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x64, 0x4c, 0xdf, 0xad, 0x4f, 0x44, 0x31, 0x8};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc2, 0xf1, 0x96, 0x1d, 0x16, 0xef, 0x39, 0xe3, 0x88,
                                     0x63, 0x8a, 0xe1, 0x49, 0x74, 0x64, 0x46, 0x50};
  lwmqtt_string_t topic_filter_s1 = {17, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14796, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12164 [("\215\191",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\183\&1\149d|\172\187\170\n\253\&0\247d\147\189",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\"-\141\168\ESCz\249\US;",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\248\206\134zY'gO\232M\144X\242\ESC\196\210\242Ka",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\155\&9\136\225\249<@6\DC2C8VS\170\237\208=1\161t\156e\198R'\149\183",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\138h\162\"\239\145\&1Q\212\182\ETB\132\178T\203\211\181\250\190\ETX\US\154\132c\168\205\218\139\176\171",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\165\160\138\189\b1fH\233\ACK_\\\a\250\137\DEL\130\251\NUL\US\166\145[\162J",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193\ETX\186T\206c}8/>H\163\255\173\&4",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("<\STX\246d\230",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("e\229|n.\CAN\FS\177\249\229Y\"Fe\193\209\"\225+\217x\190ub\253|",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\170R!*\191)5\154\202|,\DEL};bb\224\&1\233\194M\DC4`&\NUL\131",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode60) {
  uint8_t pkt[] = {0x82, 0xea, 0x1,  0x2f, 0x84, 0x0,  0x2,  0xd7, 0xbf, 0x1,  0x0,  0xf,  0xb7, 0x31, 0x95, 0x64, 0x7c,
                   0xac, 0xbb, 0xaa, 0xa,  0xfd, 0x30, 0xf7, 0x64, 0x93, 0xbd, 0x2,  0x0,  0x9,  0x22, 0x2d, 0x8d, 0xa8,
                   0x1b, 0x7a, 0xf9, 0x1f, 0x3b, 0x0,  0x0,  0x13, 0xf8, 0xce, 0x86, 0x7a, 0x59, 0x27, 0x67, 0x4f, 0xe8,
                   0x4d, 0x90, 0x58, 0xf2, 0x1b, 0xc4, 0xd2, 0xf2, 0x4b, 0x61, 0x2,  0x0,  0x1b, 0x9b, 0x39, 0x88, 0xe1,
                   0xf9, 0x3c, 0x40, 0x36, 0x12, 0x43, 0x38, 0x56, 0x53, 0xaa, 0xed, 0xd0, 0x3d, 0x31, 0xa1, 0x74, 0x9c,
                   0x65, 0xc6, 0x52, 0x27, 0x95, 0xb7, 0x0,  0x0,  0x1e, 0x8a, 0x68, 0xa2, 0x22, 0xef, 0x91, 0x31, 0x51,
                   0xd4, 0xb6, 0x17, 0x84, 0xb2, 0x54, 0xcb, 0xd3, 0xb5, 0xfa, 0xbe, 0x3,  0x1f, 0x9a, 0x84, 0x63, 0xa8,
                   0xcd, 0xda, 0x8b, 0xb0, 0xab, 0x2,  0x0,  0x19, 0xa5, 0xa0, 0x8a, 0xbd, 0x8,  0x31, 0x66, 0x48, 0xe9,
                   0x6,  0x5f, 0x5c, 0x7,  0xfa, 0x89, 0x7f, 0x82, 0xfb, 0x0,  0x1f, 0xa6, 0x91, 0x5b, 0xa2, 0x4a, 0x2,
                   0x0,  0xf,  0xc1, 0x3,  0xba, 0x54, 0xce, 0x63, 0x7d, 0x38, 0x2f, 0x3e, 0x48, 0xa3, 0xff, 0xad, 0x34,
                   0x0,  0x0,  0x5,  0x3c, 0x2,  0xf6, 0x64, 0xe6, 0x1,  0x0,  0x1a, 0x65, 0xe5, 0x7c, 0x6e, 0x2e, 0x18,
                   0x1c, 0xb1, 0xf9, 0xe5, 0x59, 0x22, 0x46, 0x65, 0xc1, 0xd1, 0x22, 0xe1, 0x2b, 0xd9, 0x78, 0xbe, 0x75,
                   0x62, 0xfd, 0x7c, 0x2,  0x0,  0x1a, 0xaa, 0x52, 0x21, 0x2a, 0xbf, 0x29, 0x35, 0x9a, 0xca, 0x7c, 0x2c,
                   0x7f, 0x7d, 0x3b, 0x62, 0x62, 0xe0, 0x31, 0xe9, 0xc2, 0x4d, 0x14, 0x60, 0x26, 0x0,  0x83, 0x2};

  uint8_t buf[247] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xd7, 0xbf};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb7, 0x31, 0x95, 0x64, 0x7c, 0xac, 0xbb, 0xaa,
                                     0xa,  0xfd, 0x30, 0xf7, 0x64, 0x93, 0xbd};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x22, 0x2d, 0x8d, 0xa8, 0x1b, 0x7a, 0xf9, 0x1f, 0x3b};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf8, 0xce, 0x86, 0x7a, 0x59, 0x27, 0x67, 0x4f, 0xe8, 0x4d,
                                     0x90, 0x58, 0xf2, 0x1b, 0xc4, 0xd2, 0xf2, 0x4b, 0x61};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0x39, 0x88, 0xe1, 0xf9, 0x3c, 0x40, 0x36, 0x12, 0x43, 0x38, 0x56, 0x53, 0xaa,
                                     0xed, 0xd0, 0x3d, 0x31, 0xa1, 0x74, 0x9c, 0x65, 0xc6, 0x52, 0x27, 0x95, 0xb7};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8a, 0x68, 0xa2, 0x22, 0xef, 0x91, 0x31, 0x51, 0xd4, 0xb6,
                                     0x17, 0x84, 0xb2, 0x54, 0xcb, 0xd3, 0xb5, 0xfa, 0xbe, 0x3,
                                     0x1f, 0x9a, 0x84, 0x63, 0xa8, 0xcd, 0xda, 0x8b, 0xb0, 0xab};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xa5, 0xa0, 0x8a, 0xbd, 0x8,  0x31, 0x66, 0x48, 0xe9, 0x6,  0x5f, 0x5c, 0x7,
                                     0xfa, 0x89, 0x7f, 0x82, 0xfb, 0x0,  0x1f, 0xa6, 0x91, 0x5b, 0xa2, 0x4a};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xc1, 0x3,  0xba, 0x54, 0xce, 0x63, 0x7d, 0x38,
                                     0x2f, 0x3e, 0x48, 0xa3, 0xff, 0xad, 0x34};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x3c, 0x2, 0xf6, 0x64, 0xe6};
  lwmqtt_string_t topic_filter_s8 = {5, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x65, 0xe5, 0x7c, 0x6e, 0x2e, 0x18, 0x1c, 0xb1, 0xf9, 0xe5, 0x59, 0x22, 0x46,
                                     0x65, 0xc1, 0xd1, 0x22, 0xe1, 0x2b, 0xd9, 0x78, 0xbe, 0x75, 0x62, 0xfd, 0x7c};
  lwmqtt_string_t topic_filter_s9 = {26, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xaa, 0x52, 0x21, 0x2a, 0xbf, 0x29, 0x35, 0x9a, 0xca, 0x7c, 0x2c, 0x7f, 0x7d,
                                      0x3b, 0x62, 0x62, 0xe0, 0x31, 0xe9, 0xc2, 0x4d, 0x14, 0x60, 0x26, 0x0,  0x83};
  lwmqtt_string_t topic_filter_s10 = {26, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12164, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12633 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\142\241\204\138,\174\131\149\199\160o\205\146",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("r\146\242\132\DC1\212\252\ETX\DC3\192\195\&3\169\231!",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\225\238p\223\135rJ\134'\ETB\DEL\137\131\NUL\223h\DC4\171\ESC\248",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("l1\185\139a\217\DEL7?\r\EM?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("?<CE\195\171\147\151\165\153[\DC4\134",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ETX)\224\148\161\DEL\177\145\SYN\ETX$\253_\148\204\248\GS\129.\182 \180,Z",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\202\&4(.\251\165[\160\186\189\138srVA",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),(" \228\227a",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\236D\151z\EM\252r",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode61) {
  uint8_t pkt[] = {0x82, 0x9b, 0x1,  0x31, 0x59, 0x0,  0x0,  0x0,  0x0,  0xd,  0x8e, 0xf1, 0xcc, 0x8a, 0x2c, 0xae,
                   0x83, 0x95, 0xc7, 0xa0, 0x6f, 0xcd, 0x92, 0x0,  0x0,  0xf,  0x72, 0x92, 0xf2, 0x84, 0x11, 0xd4,
                   0xfc, 0x3,  0x13, 0xc0, 0xc3, 0x33, 0xa9, 0xe7, 0x21, 0x1,  0x0,  0x14, 0xe1, 0xee, 0x70, 0xdf,
                   0x87, 0x72, 0x4a, 0x86, 0x27, 0x17, 0x7f, 0x89, 0x83, 0x0,  0xdf, 0x68, 0x14, 0xab, 0x1b, 0xf8,
                   0x0,  0x0,  0xc,  0x6c, 0x31, 0xb9, 0x8b, 0x61, 0xd9, 0x7f, 0x37, 0x3f, 0xd,  0x19, 0x3f, 0x2,
                   0x0,  0xd,  0x3f, 0x3c, 0x43, 0x45, 0xc3, 0xab, 0x93, 0x97, 0xa5, 0x99, 0x5b, 0x14, 0x86, 0x1,
                   0x0,  0x18, 0x3,  0x29, 0xe0, 0x94, 0xa1, 0x7f, 0xb1, 0x91, 0x16, 0x3,  0x24, 0xfd, 0x5f, 0x94,
                   0xcc, 0xf8, 0x1d, 0x81, 0x2e, 0xb6, 0x20, 0xb4, 0x2c, 0x5a, 0x2,  0x0,  0xf,  0xca, 0x34, 0x28,
                   0x2e, 0xfb, 0xa5, 0x5b, 0xa0, 0xba, 0xbd, 0x8a, 0x73, 0x72, 0x56, 0x41, 0x0,  0x0,  0x4,  0x20,
                   0xe4, 0xe3, 0x61, 0x0,  0x0,  0x7,  0xec, 0x44, 0x97, 0x7a, 0x19, 0xfc, 0x72, 0x2};

  uint8_t buf[168] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8e, 0xf1, 0xcc, 0x8a, 0x2c, 0xae, 0x83, 0x95, 0xc7, 0xa0, 0x6f, 0xcd, 0x92};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x72, 0x92, 0xf2, 0x84, 0x11, 0xd4, 0xfc, 0x3,
                                     0x13, 0xc0, 0xc3, 0x33, 0xa9, 0xe7, 0x21};
  lwmqtt_string_t topic_filter_s2 = {15, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xe1, 0xee, 0x70, 0xdf, 0x87, 0x72, 0x4a, 0x86, 0x27, 0x17,
                                     0x7f, 0x89, 0x83, 0x0,  0xdf, 0x68, 0x14, 0xab, 0x1b, 0xf8};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6c, 0x31, 0xb9, 0x8b, 0x61, 0xd9, 0x7f, 0x37, 0x3f, 0xd, 0x19, 0x3f};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x3f, 0x3c, 0x43, 0x45, 0xc3, 0xab, 0x93, 0x97, 0xa5, 0x99, 0x5b, 0x14, 0x86};
  lwmqtt_string_t topic_filter_s5 = {13, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3,  0x29, 0xe0, 0x94, 0xa1, 0x7f, 0xb1, 0x91, 0x16, 0x3,  0x24, 0xfd,
                                     0x5f, 0x94, 0xcc, 0xf8, 0x1d, 0x81, 0x2e, 0xb6, 0x20, 0xb4, 0x2c, 0x5a};
  lwmqtt_string_t topic_filter_s6 = {24, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xca, 0x34, 0x28, 0x2e, 0xfb, 0xa5, 0x5b, 0xa0,
                                     0xba, 0xbd, 0x8a, 0x73, 0x72, 0x56, 0x41};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x20, 0xe4, 0xe3, 0x61};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xec, 0x44, 0x97, 0x7a, 0x19, 0xfc, 0x72};
  lwmqtt_string_t topic_filter_s9 = {7, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12633, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21642 [("\217\193\146\133\233\237\&84\STX|9\SI^",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("!\191\250T>\226!\129{\254Q",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\FSG=\NUL",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\142gv\133\156\SYN\162\216C",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\152\212\158(t\138F\128{&?'-\194\239p\DC2H\132\131\SYNd\169\128\215\NAKa\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\179\212\228\145\130\161\198\&5\236H\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("\196\&6?\162\212TA\205\USkt\b\208",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode62) {
  uint8_t pkt[] = {0x82, 0x70, 0x54, 0x8a, 0x0,  0xd,  0xd9, 0xc1, 0x92, 0x85, 0xe9, 0xed, 0x38, 0x34, 0x2,  0x7c, 0x39,
                   0xf,  0x5e, 0x1,  0x0,  0xb,  0x21, 0xbf, 0xfa, 0x54, 0x3e, 0xe2, 0x21, 0x81, 0x7b, 0xfe, 0x51, 0x1,
                   0x0,  0x4,  0x1c, 0x47, 0x3d, 0x0,  0x1,  0x0,  0x9,  0x8e, 0x67, 0x76, 0x85, 0x9c, 0x16, 0xa2, 0xd8,
                   0x43, 0x1,  0x0,  0x1c, 0x98, 0xd4, 0x9e, 0x28, 0x74, 0x8a, 0x46, 0x80, 0x7b, 0x26, 0x3f, 0x27, 0x2d,
                   0xc2, 0xef, 0x70, 0x12, 0x48, 0x84, 0x83, 0x16, 0x64, 0xa9, 0x80, 0xd7, 0x15, 0x61, 0xd9, 0x2,  0x0,
                   0xb,  0xb3, 0xd4, 0xe4, 0x91, 0x82, 0xa1, 0xc6, 0x35, 0xec, 0x48, 0x98, 0x0,  0x0,  0xd,  0xc4, 0x36,
                   0x3f, 0xa2, 0xd4, 0x54, 0x41, 0xcd, 0x1f, 0x6b, 0x74, 0x8,  0xd0, 0x2};

  uint8_t buf[124] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xd9, 0xc1, 0x92, 0x85, 0xe9, 0xed, 0x38, 0x34, 0x2, 0x7c, 0x39, 0xf, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x21, 0xbf, 0xfa, 0x54, 0x3e, 0xe2, 0x21, 0x81, 0x7b, 0xfe, 0x51};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1c, 0x47, 0x3d, 0x0};
  lwmqtt_string_t topic_filter_s2 = {4, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8e, 0x67, 0x76, 0x85, 0x9c, 0x16, 0xa2, 0xd8, 0x43};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x98, 0xd4, 0x9e, 0x28, 0x74, 0x8a, 0x46, 0x80, 0x7b, 0x26,
                                     0x3f, 0x27, 0x2d, 0xc2, 0xef, 0x70, 0x12, 0x48, 0x84, 0x83,
                                     0x16, 0x64, 0xa9, 0x80, 0xd7, 0x15, 0x61, 0xd9};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xb3, 0xd4, 0xe4, 0x91, 0x82, 0xa1, 0xc6, 0x35, 0xec, 0x48, 0x98};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc4, 0x36, 0x3f, 0xa2, 0xd4, 0x54, 0x41, 0xcd, 0x1f, 0x6b, 0x74, 0x8, 0xd0};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 21642, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 17671 [("u\219]\165\215\137\250\193O\129\136\181\180\tG@\188t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\250\141\FS\155\a\192Q}\186\203\ACK\DEL\246\233\SUB\206\&2/\240\137\189'F$\189dq\159\142h",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\SYN\189~\178VN\200\201\v\165\218\230\166\ETB",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("L\136+\152\143",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\139\202\184\152g\f\231`",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode63) {
  uint8_t pkt[] = {0x82, 0x63, 0x45, 0x7,  0x0,  0x12, 0x75, 0xdb, 0x5d, 0xa5, 0xd7, 0x89, 0xfa, 0xc1, 0x4f, 0x81, 0x88,
                   0xb5, 0xb4, 0x9,  0x47, 0x40, 0xbc, 0x74, 0x1,  0x0,  0x0,  0x1,  0x0,  0x1e, 0xfa, 0x8d, 0x1c, 0x9b,
                   0x7,  0xc0, 0x51, 0x7d, 0xba, 0xcb, 0x6,  0x7f, 0xf6, 0xe9, 0x1a, 0xce, 0x32, 0x2f, 0xf0, 0x89, 0xbd,
                   0x27, 0x46, 0x24, 0xbd, 0x64, 0x71, 0x9f, 0x8e, 0x68, 0x0,  0x0,  0xe,  0x16, 0xbd, 0x7e, 0xb2, 0x56,
                   0x4e, 0xc8, 0xc9, 0xb,  0xa5, 0xda, 0xe6, 0xa6, 0x17, 0x1,  0x0,  0x5,  0x4c, 0x88, 0x2b, 0x98, 0x8f,
                   0x2,  0x0,  0x8,  0x8b, 0xca, 0xb8, 0x98, 0x67, 0xc,  0xe7, 0x60, 0x1,  0x0,  0x1,  0x5c, 0x2};

  uint8_t buf[111] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x75, 0xdb, 0x5d, 0xa5, 0xd7, 0x89, 0xfa, 0xc1, 0x4f,
                                     0x81, 0x88, 0xb5, 0xb4, 0x9,  0x47, 0x40, 0xbc, 0x74};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xfa, 0x8d, 0x1c, 0x9b, 0x7,  0xc0, 0x51, 0x7d, 0xba, 0xcb,
                                     0x6,  0x7f, 0xf6, 0xe9, 0x1a, 0xce, 0x32, 0x2f, 0xf0, 0x89,
                                     0xbd, 0x27, 0x46, 0x24, 0xbd, 0x64, 0x71, 0x9f, 0x8e, 0x68};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x16, 0xbd, 0x7e, 0xb2, 0x56, 0x4e, 0xc8, 0xc9, 0xb, 0xa5, 0xda, 0xe6, 0xa6, 0x17};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4c, 0x88, 0x2b, 0x98, 0x8f};
  lwmqtt_string_t topic_filter_s4 = {5, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8b, 0xca, 0xb8, 0x98, 0x67, 0xc, 0xe7, 0x60};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x5c};
  lwmqtt_string_t topic_filter_s6 = {1, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 17671, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 18903 [("\245\147\176",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("sQ\169h\ACK\237\155\fg\232\206\138",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode64) {
  uint8_t pkt[] = {0x82, 0x17, 0x49, 0xd7, 0x0,  0x3,  0xf5, 0x93, 0xb0, 0x0,  0x0,  0xc, 0x73,
                   0x51, 0xa9, 0x68, 0x6,  0xed, 0x9b, 0xc,  0x67, 0xe8, 0xce, 0x8a, 0x2};

  uint8_t buf[35] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xf5, 0x93, 0xb0};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x73, 0x51, 0xa9, 0x68, 0x6, 0xed, 0x9b, 0xc, 0x67, 0xe8, 0xce, 0x8a};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 18903, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 187 [("5>j",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("\134/\US\STX\249\130\n\159\"\235\ETB\FS\163\USR\194\156d>\213\144=\161/*'\231\"",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\DEL\250Oc\141\225\&8\234B\179",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\141\218\241\136\246\183d\251\&3\182\235#\208\bPH\170Y\194",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\215N",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("}'\141;\170\&26H\213Yh\130\RS\178\DLEuL\155\134\229\210\138\DLEi\GS~S",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\220\&6\DC2a\245\161\nd\210\tR\238\159Z1\236\207\215\181\204\ACKb}\252\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("f<B\131\\\216\160\251em2\245\DEL\243y\216|\157\129\231?\192+\219",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193g\214v\STX\187\231\254\172\&3\181\235\228H\158\160\231\r4\177",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("6\b^\ETX\173\159C+\NUL)C",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode65) {
  uint8_t pkt[] = {0x82, 0xc9, 0x1,  0x0,  0xbb, 0x0,  0x3,  0x35, 0x3e, 0x6a, 0x1,  0x0,  0x1c, 0x86, 0x2f, 0x1f, 0x2,
                   0xf9, 0x82, 0xa,  0x9f, 0x22, 0xeb, 0x17, 0x1c, 0xa3, 0x1f, 0x52, 0xc2, 0x9c, 0x64, 0x3e, 0xd5, 0x90,
                   0x3d, 0xa1, 0x2f, 0x2a, 0x27, 0xe7, 0x22, 0x1,  0x0,  0xa,  0x7f, 0xfa, 0x4f, 0x63, 0x8d, 0xe1, 0x38,
                   0xea, 0x42, 0xb3, 0x0,  0x0,  0x13, 0x8d, 0xda, 0xf1, 0x88, 0xf6, 0xb7, 0x64, 0xfb, 0x33, 0xb6, 0xeb,
                   0x23, 0xd0, 0x8,  0x50, 0x48, 0xaa, 0x59, 0xc2, 0x0,  0x0,  0x2,  0xd7, 0x4e, 0x1,  0x0,  0x1b, 0x7d,
                   0x27, 0x8d, 0x3b, 0xaa, 0x32, 0x36, 0x48, 0xd5, 0x59, 0x68, 0x82, 0x1e, 0xb2, 0x10, 0x75, 0x4c, 0x9b,
                   0x86, 0xe5, 0xd2, 0x8a, 0x10, 0x69, 0x1d, 0x7e, 0x53, 0x1,  0x0,  0x19, 0xdc, 0x36, 0x12, 0x61, 0xf5,
                   0xa1, 0xa,  0x64, 0xd2, 0x9,  0x52, 0xee, 0x9f, 0x5a, 0x31, 0xec, 0xcf, 0xd7, 0xb5, 0xcc, 0x6,  0x62,
                   0x7d, 0xfc, 0xd9, 0x1,  0x0,  0x18, 0x66, 0x3c, 0x42, 0x83, 0x5c, 0xd8, 0xa0, 0xfb, 0x65, 0x6d, 0x32,
                   0xf5, 0x7f, 0xf3, 0x79, 0xd8, 0x7c, 0x9d, 0x81, 0xe7, 0x3f, 0xc0, 0x2b, 0xdb, 0x2,  0x0,  0x14, 0xc1,
                   0x67, 0xd6, 0x76, 0x2,  0xbb, 0xe7, 0xfe, 0xac, 0x33, 0xb5, 0xeb, 0xe4, 0x48, 0x9e, 0xa0, 0xe7, 0xd,
                   0x34, 0xb1, 0x2,  0x0,  0xb,  0x36, 0x8,  0x5e, 0x3,  0xad, 0x9f, 0x43, 0x2b, 0x0,  0x29, 0x43, 0x0};

  uint8_t buf[214] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x35, 0x3e, 0x6a};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86, 0x2f, 0x1f, 0x2,  0xf9, 0x82, 0xa,  0x9f, 0x22, 0xeb,
                                     0x17, 0x1c, 0xa3, 0x1f, 0x52, 0xc2, 0x9c, 0x64, 0x3e, 0xd5,
                                     0x90, 0x3d, 0xa1, 0x2f, 0x2a, 0x27, 0xe7, 0x22};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x7f, 0xfa, 0x4f, 0x63, 0x8d, 0xe1, 0x38, 0xea, 0x42, 0xb3};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8d, 0xda, 0xf1, 0x88, 0xf6, 0xb7, 0x64, 0xfb, 0x33, 0xb6,
                                     0xeb, 0x23, 0xd0, 0x8,  0x50, 0x48, 0xaa, 0x59, 0xc2};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd7, 0x4e};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x27, 0x8d, 0x3b, 0xaa, 0x32, 0x36, 0x48, 0xd5, 0x59, 0x68, 0x82, 0x1e, 0xb2,
                                     0x10, 0x75, 0x4c, 0x9b, 0x86, 0xe5, 0xd2, 0x8a, 0x10, 0x69, 0x1d, 0x7e, 0x53};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xdc, 0x36, 0x12, 0x61, 0xf5, 0xa1, 0xa,  0x64, 0xd2, 0x9,  0x52, 0xee, 0x9f,
                                     0x5a, 0x31, 0xec, 0xcf, 0xd7, 0xb5, 0xcc, 0x6,  0x62, 0x7d, 0xfc, 0xd9};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x66, 0x3c, 0x42, 0x83, 0x5c, 0xd8, 0xa0, 0xfb, 0x65, 0x6d, 0x32, 0xf5,
                                     0x7f, 0xf3, 0x79, 0xd8, 0x7c, 0x9d, 0x81, 0xe7, 0x3f, 0xc0, 0x2b, 0xdb};
  lwmqtt_string_t topic_filter_s7 = {24, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xc1, 0x67, 0xd6, 0x76, 0x2,  0xbb, 0xe7, 0xfe, 0xac, 0x33,
                                     0xb5, 0xeb, 0xe4, 0x48, 0x9e, 0xa0, 0xe7, 0xd,  0x34, 0xb1};
  lwmqtt_string_t topic_filter_s8 = {20, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x36, 0x8, 0x5e, 0x3, 0xad, 0x9f, 0x43, 0x2b, 0x0, 0x29, 0x43};
  lwmqtt_string_t topic_filter_s9 = {11, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 187, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4732 [("j\160\144\131\199\149\137\205\180
// 0\\\238'\v\239%\140y\130\166\DLEFW\196+/\SUB\175k",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS2}),("\165\208DR\186\164\169,\247\185\GS8.\251,j9\ENQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\236\&1\180e\159x\190{\ACKe\222\&5\150",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\169\ESC\164*w3X",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\136\v\137",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\243\193Mz&\151\240i\138\171=\222\226\169(\251\146\149k3\176t\206\161N~\165",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\177\209\242\173U\232\ETX*\217i\250\167Jh\240\SOH\210\230\EM\150z\205",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\183\189\159?,\251\246\DEL\FS$\134\134}",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode66) {
  uint8_t pkt[] = {0x82, 0x9f, 0x1,  0x12, 0x7c, 0x0,  0x1e, 0x6a, 0xa0, 0x90, 0x83, 0xc7, 0x95, 0x89, 0xcd, 0xb4, 0x20,
                   0x30, 0x5c, 0xee, 0x27, 0xb,  0xef, 0x25, 0x8c, 0x79, 0x82, 0xa6, 0x10, 0x46, 0x57, 0xc4, 0x2b, 0x2f,
                   0x1a, 0xaf, 0x6b, 0x2,  0x0,  0x12, 0xa5, 0xd0, 0x44, 0x52, 0xba, 0xa4, 0xa9, 0x2c, 0xf7, 0xb9, 0x1d,
                   0x38, 0x2e, 0xfb, 0x2c, 0x6a, 0x39, 0x5,  0x0,  0x0,  0xd,  0xec, 0x31, 0xb4, 0x65, 0x9f, 0x78, 0xbe,
                   0x7b, 0x6,  0x65, 0xde, 0x35, 0x96, 0x2,  0x0,  0x7,  0xa9, 0x1b, 0xa4, 0x2a, 0x77, 0x33, 0x58, 0x0,
                   0x0,  0x3,  0x88, 0xb,  0x89, 0x0,  0x0,  0x1b, 0xf3, 0xc1, 0x4d, 0x7a, 0x26, 0x97, 0xf0, 0x69, 0x8a,
                   0xab, 0x3d, 0xde, 0xe2, 0xa9, 0x28, 0xfb, 0x92, 0x95, 0x6b, 0x33, 0xb0, 0x74, 0xce, 0xa1, 0x4e, 0x7e,
                   0xa5, 0x0,  0x0,  0x16, 0xb1, 0xd1, 0xf2, 0xad, 0x55, 0xe8, 0x3,  0x2a, 0xd9, 0x69, 0xfa, 0xa7, 0x4a,
                   0x68, 0xf0, 0x1,  0xd2, 0xe6, 0x19, 0x96, 0x7a, 0xcd, 0x2,  0x0,  0xd,  0xb7, 0xbd, 0x9f, 0x3f, 0x2c,
                   0xfb, 0xf6, 0x7f, 0x1c, 0x24, 0x86, 0x86, 0x7d, 0x1};

  uint8_t buf[172] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x6a, 0xa0, 0x90, 0x83, 0xc7, 0x95, 0x89, 0xcd, 0xb4, 0x20,
                                     0x30, 0x5c, 0xee, 0x27, 0xb,  0xef, 0x25, 0x8c, 0x79, 0x82,
                                     0xa6, 0x10, 0x46, 0x57, 0xc4, 0x2b, 0x2f, 0x1a, 0xaf, 0x6b};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa5, 0xd0, 0x44, 0x52, 0xba, 0xa4, 0xa9, 0x2c, 0xf7,
                                     0xb9, 0x1d, 0x38, 0x2e, 0xfb, 0x2c, 0x6a, 0x39, 0x5};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xec, 0x31, 0xb4, 0x65, 0x9f, 0x78, 0xbe, 0x7b, 0x6, 0x65, 0xde, 0x35, 0x96};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa9, 0x1b, 0xa4, 0x2a, 0x77, 0x33, 0x58};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x88, 0xb, 0x89};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf3, 0xc1, 0x4d, 0x7a, 0x26, 0x97, 0xf0, 0x69, 0x8a, 0xab, 0x3d, 0xde, 0xe2, 0xa9,
                                     0x28, 0xfb, 0x92, 0x95, 0x6b, 0x33, 0xb0, 0x74, 0xce, 0xa1, 0x4e, 0x7e, 0xa5};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb1, 0xd1, 0xf2, 0xad, 0x55, 0xe8, 0x3,  0x2a, 0xd9, 0x69, 0xfa,
                                     0xa7, 0x4a, 0x68, 0xf0, 0x1,  0xd2, 0xe6, 0x19, 0x96, 0x7a, 0xcd};
  lwmqtt_string_t topic_filter_s6 = {22, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xb7, 0xbd, 0x9f, 0x3f, 0x2c, 0xfb, 0xf6, 0x7f, 0x1c, 0x24, 0x86, 0x86, 0x7d};
  lwmqtt_string_t topic_filter_s7 = {13, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4732, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14957
// [("J\147\230\135V\211\184\205\203c\167\216Fb\245\187\165\175\&7\175Zh\224\EOT\247\147&#",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\134n\153\177\133\152\145aTM\141\223#\220\167X\138\DLE\143JK\148\201\ETX\251\138\229",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode67) {
  uint8_t pkt[] = {0x82, 0x3f, 0x3a, 0x6d, 0x0,  0x1c, 0x4a, 0x93, 0xe6, 0x87, 0x56, 0xd3, 0xb8, 0xcd, 0xcb, 0x63, 0xa7,
                   0xd8, 0x46, 0x62, 0xf5, 0xbb, 0xa5, 0xaf, 0x37, 0xaf, 0x5a, 0x68, 0xe0, 0x4,  0xf7, 0x93, 0x26, 0x23,
                   0x1,  0x0,  0x1b, 0x86, 0x6e, 0x99, 0xb1, 0x85, 0x98, 0x91, 0x61, 0x54, 0x4d, 0x8d, 0xdf, 0x23, 0xdc,
                   0xa7, 0x58, 0x8a, 0x10, 0x8f, 0x4a, 0x4b, 0x94, 0xc9, 0x3,  0xfb, 0x8a, 0xe5, 0x1};

  uint8_t buf[75] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x4a, 0x93, 0xe6, 0x87, 0x56, 0xd3, 0xb8, 0xcd, 0xcb, 0x63,
                                     0xa7, 0xd8, 0x46, 0x62, 0xf5, 0xbb, 0xa5, 0xaf, 0x37, 0xaf,
                                     0x5a, 0x68, 0xe0, 0x4,  0xf7, 0x93, 0x26, 0x23};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86, 0x6e, 0x99, 0xb1, 0x85, 0x98, 0x91, 0x61, 0x54, 0x4d, 0x8d, 0xdf, 0x23, 0xdc,
                                     0xa7, 0x58, 0x8a, 0x10, 0x8f, 0x4a, 0x4b, 0x94, 0xc9, 0x3,  0xfb, 0x8a, 0xe5};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14957, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10919 [("t\SUB9\188\&6\246\145\139\179Z\219\201\195_E\251",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\193ia\255\232\&5\138\199>\245\230\190d\n",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS0}),("\SYN\233\177\236i\130\128\129L\208\174U\146\138F\247\182\212.\225y\DC2R\230s`9\178X_",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("C\183z\254h",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\232t\GS\132\129\184f\CAN\CAN>\141:L\216\DC3{\191Y\213\232\SYN|\212\146k\195",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\SO]\228\162\189*ST\168t\ACK\143\216r\249\178\199\&0(\200[}\173\235\206\159F",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\STX\148\192L*\157`\179\224=e\224\228\&6",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS0}),("\232J\211\179\136\130\218\157A\177\157j!\157\237\a\248\213\SUB\155",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode68) {
  uint8_t pkt[] = {0x82, 0xb2, 0x1,  0x2a, 0xa7, 0x0,  0x10, 0x74, 0x1a, 0x39, 0xbc, 0x36, 0xf6, 0x91, 0x8b, 0xb3, 0x5a,
                   0xdb, 0xc9, 0xc3, 0x5f, 0x45, 0xfb, 0x1,  0x0,  0xe,  0xc1, 0x69, 0x61, 0xff, 0xe8, 0x35, 0x8a, 0xc7,
                   0x3e, 0xf5, 0xe6, 0xbe, 0x64, 0xa,  0x0,  0x0,  0x1e, 0x16, 0xe9, 0xb1, 0xec, 0x69, 0x82, 0x80, 0x81,
                   0x4c, 0xd0, 0xae, 0x55, 0x92, 0x8a, 0x46, 0xf7, 0xb6, 0xd4, 0x2e, 0xe1, 0x79, 0x12, 0x52, 0xe6, 0x73,
                   0x60, 0x39, 0xb2, 0x58, 0x5f, 0x0,  0x0,  0x5,  0x43, 0xb7, 0x7a, 0xfe, 0x68, 0x1,  0x0,  0x1a, 0xe8,
                   0x74, 0x1d, 0x84, 0x81, 0xb8, 0x66, 0x18, 0x18, 0x3e, 0x8d, 0x3a, 0x4c, 0xd8, 0x13, 0x7b, 0xbf, 0x59,
                   0xd5, 0xe8, 0x16, 0x7c, 0xd4, 0x92, 0x6b, 0xc3, 0x1,  0x0,  0x1b, 0xe,  0x5d, 0xe4, 0xa2, 0xbd, 0x2a,
                   0x53, 0x54, 0xa8, 0x74, 0x6,  0x8f, 0xd8, 0x72, 0xf9, 0xb2, 0xc7, 0x30, 0x28, 0xc8, 0x5b, 0x7d, 0xad,
                   0xeb, 0xce, 0x9f, 0x46, 0x1,  0x0,  0xe,  0x2,  0x94, 0xc0, 0x4c, 0x2a, 0x9d, 0x60, 0xb3, 0xe0, 0x3d,
                   0x65, 0xe0, 0xe4, 0x36, 0x0,  0x0,  0x14, 0xe8, 0x4a, 0xd3, 0xb3, 0x88, 0x82, 0xda, 0x9d, 0x41, 0xb1,
                   0x9d, 0x6a, 0x21, 0x9d, 0xed, 0x7,  0xf8, 0xd5, 0x1a, 0x9b, 0x0};

  uint8_t buf[191] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x74, 0x1a, 0x39, 0xbc, 0x36, 0xf6, 0x91, 0x8b,
                                     0xb3, 0x5a, 0xdb, 0xc9, 0xc3, 0x5f, 0x45, 0xfb};
  lwmqtt_string_t topic_filter_s0 = {16, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x69, 0x61, 0xff, 0xe8, 0x35, 0x8a, 0xc7, 0x3e, 0xf5, 0xe6, 0xbe, 0x64, 0xa};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x16, 0xe9, 0xb1, 0xec, 0x69, 0x82, 0x80, 0x81, 0x4c, 0xd0,
                                     0xae, 0x55, 0x92, 0x8a, 0x46, 0xf7, 0xb6, 0xd4, 0x2e, 0xe1,
                                     0x79, 0x12, 0x52, 0xe6, 0x73, 0x60, 0x39, 0xb2, 0x58, 0x5f};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x43, 0xb7, 0x7a, 0xfe, 0x68};
  lwmqtt_string_t topic_filter_s3 = {5, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe8, 0x74, 0x1d, 0x84, 0x81, 0xb8, 0x66, 0x18, 0x18, 0x3e, 0x8d, 0x3a, 0x4c,
                                     0xd8, 0x13, 0x7b, 0xbf, 0x59, 0xd5, 0xe8, 0x16, 0x7c, 0xd4, 0x92, 0x6b, 0xc3};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe,  0x5d, 0xe4, 0xa2, 0xbd, 0x2a, 0x53, 0x54, 0xa8, 0x74, 0x6,  0x8f, 0xd8, 0x72,
                                     0xf9, 0xb2, 0xc7, 0x30, 0x28, 0xc8, 0x5b, 0x7d, 0xad, 0xeb, 0xce, 0x9f, 0x46};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x2, 0x94, 0xc0, 0x4c, 0x2a, 0x9d, 0x60, 0xb3, 0xe0, 0x3d, 0x65, 0xe0, 0xe4, 0x36};
  lwmqtt_string_t topic_filter_s6 = {14, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xe8, 0x4a, 0xd3, 0xb3, 0x88, 0x82, 0xda, 0x9d, 0x41, 0xb1,
                                     0x9d, 0x6a, 0x21, 0x9d, 0xed, 0x7,  0xf8, 0xd5, 0x1a, 0x9b};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10919, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 692 [("\151\140>\206\207\NUL\208\139\194L\251\227\220\170\163\153*~?,w\245u",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\227\154\215d\192;_\237G\128o\235Q\218rV\202\SOHr\DEL\144\155",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("S'\141\229\&7]\"\179\212\174\r\185\176",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\137\202Y\ENQ\254#\197\FS(R\208\234n0x\ACK\141\210i\227$0\182H%",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("0\237\190\218C6",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\247/{\nv\233V\144\198e\158",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\247\194\142\228\247\186\227\&8",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("J",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\200\183{SW\236\248y\197\224\172K\STX\184W\v~\211",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\247\146\ETB\254\241\SYN\199\197\175\237\\\220\213\154\178\214\136k\147S\SI\228\EM\219\129.\240",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\249h\135(AF",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode69) {
  uint8_t pkt[] = {0x82, 0xc3, 0x1,  0x2,  0xb4, 0x0,  0x17, 0x97, 0x8c, 0x3e, 0xce, 0xcf, 0x0,  0xd0, 0x8b, 0xc2, 0x4c,
                   0xfb, 0xe3, 0xdc, 0xaa, 0xa3, 0x99, 0x2a, 0x7e, 0x3f, 0x2c, 0x77, 0xf5, 0x75, 0x2,  0x0,  0x16, 0xe3,
                   0x9a, 0xd7, 0x64, 0xc0, 0x3b, 0x5f, 0xed, 0x47, 0x80, 0x6f, 0xeb, 0x51, 0xda, 0x72, 0x56, 0xca, 0x1,
                   0x72, 0x7f, 0x90, 0x9b, 0x0,  0x0,  0xd,  0x53, 0x27, 0x8d, 0xe5, 0x37, 0x5d, 0x22, 0xb3, 0xd4, 0xae,
                   0xd,  0xb9, 0xb0, 0x1,  0x0,  0x19, 0x89, 0xca, 0x59, 0x5,  0xfe, 0x23, 0xc5, 0x1c, 0x28, 0x52, 0xd0,
                   0xea, 0x6e, 0x30, 0x78, 0x6,  0x8d, 0xd2, 0x69, 0xe3, 0x24, 0x30, 0xb6, 0x48, 0x25, 0x1,  0x0,  0x6,
                   0x30, 0xed, 0xbe, 0xda, 0x43, 0x36, 0x1,  0x0,  0xb,  0xf7, 0x2f, 0x7b, 0xa,  0x76, 0xe9, 0x56, 0x90,
                   0xc6, 0x65, 0x9e, 0x0,  0x0,  0x8,  0xf7, 0xc2, 0x8e, 0xe4, 0xf7, 0xba, 0xe3, 0x38, 0x0,  0x0,  0x1,
                   0x4a, 0x2,  0x0,  0x12, 0xc8, 0xb7, 0x7b, 0x53, 0x57, 0xec, 0xf8, 0x79, 0xc5, 0xe0, 0xac, 0x4b, 0x2,
                   0xb8, 0x57, 0xb,  0x7e, 0xd3, 0x0,  0x0,  0x1b, 0xf7, 0x92, 0x17, 0xfe, 0xf1, 0x16, 0xc7, 0xc5, 0xaf,
                   0xed, 0x5c, 0xdc, 0xd5, 0x9a, 0xb2, 0xd6, 0x88, 0x6b, 0x93, 0x53, 0xf,  0xe4, 0x19, 0xdb, 0x81, 0x2e,
                   0xf0, 0x2,  0x0,  0x6,  0xf9, 0x68, 0x87, 0x28, 0x41, 0x46, 0x1};

  uint8_t buf[208] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x97, 0x8c, 0x3e, 0xce, 0xcf, 0x0,  0xd0, 0x8b, 0xc2, 0x4c, 0xfb, 0xe3,
                                     0xdc, 0xaa, 0xa3, 0x99, 0x2a, 0x7e, 0x3f, 0x2c, 0x77, 0xf5, 0x75};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xe3, 0x9a, 0xd7, 0x64, 0xc0, 0x3b, 0x5f, 0xed, 0x47, 0x80, 0x6f,
                                     0xeb, 0x51, 0xda, 0x72, 0x56, 0xca, 0x1,  0x72, 0x7f, 0x90, 0x9b};
  lwmqtt_string_t topic_filter_s1 = {22, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x27, 0x8d, 0xe5, 0x37, 0x5d, 0x22, 0xb3, 0xd4, 0xae, 0xd, 0xb9, 0xb0};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x89, 0xca, 0x59, 0x5,  0xfe, 0x23, 0xc5, 0x1c, 0x28, 0x52, 0xd0, 0xea, 0x6e,
                                     0x30, 0x78, 0x6,  0x8d, 0xd2, 0x69, 0xe3, 0x24, 0x30, 0xb6, 0x48, 0x25};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x30, 0xed, 0xbe, 0xda, 0x43, 0x36};
  lwmqtt_string_t topic_filter_s4 = {6, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf7, 0x2f, 0x7b, 0xa, 0x76, 0xe9, 0x56, 0x90, 0xc6, 0x65, 0x9e};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xf7, 0xc2, 0x8e, 0xe4, 0xf7, 0xba, 0xe3, 0x38};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x4a};
  lwmqtt_string_t topic_filter_s7 = {1, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xc8, 0xb7, 0x7b, 0x53, 0x57, 0xec, 0xf8, 0x79, 0xc5,
                                     0xe0, 0xac, 0x4b, 0x2,  0xb8, 0x57, 0xb,  0x7e, 0xd3};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf7, 0x92, 0x17, 0xfe, 0xf1, 0x16, 0xc7, 0xc5, 0xaf, 0xed, 0x5c, 0xdc, 0xd5, 0x9a,
                                     0xb2, 0xd6, 0x88, 0x6b, 0x93, 0x53, 0xf,  0xe4, 0x19, 0xdb, 0x81, 0x2e, 0xf0};
  lwmqtt_string_t topic_filter_s9 = {27, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xf9, 0x68, 0x87, 0x28, 0x41, 0x46};
  lwmqtt_string_t topic_filter_s10 = {6, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 692, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1184 [("\170g\\2\a\FS\243\&2\134#\245<\232\v<s\136\131\ETB\221/?\ah(Q@\177",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\255",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\236\208\198",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("\FS",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\146\DLEf\245n@\208m\191\ENQ\248\235=\213\192s\225\ENQ+\152\160\f|\204",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode70) {
  uint8_t pkt[] = {0x82, 0x4a, 0x4,  0xa0, 0x0,  0x1c, 0xaa, 0x67, 0x5c, 0x32, 0x7,  0x1c, 0xf3, 0x32, 0x86, 0x23,
                   0xf5, 0x3c, 0xe8, 0xb,  0x3c, 0x73, 0x88, 0x83, 0x17, 0xdd, 0x2f, 0x3f, 0x7,  0x68, 0x28, 0x51,
                   0x40, 0xb1, 0x1,  0x0,  0x1,  0xff, 0x2,  0x0,  0x3,  0xec, 0xd0, 0xc6, 0x0,  0x0,  0x1,  0x1c,
                   0x1,  0x0,  0x18, 0x92, 0x10, 0x66, 0xf5, 0x6e, 0x40, 0xd0, 0x6d, 0xbf, 0x5,  0xf8, 0xeb, 0x3d,
                   0xd5, 0xc0, 0x73, 0xe1, 0x5,  0x2b, 0x98, 0xa0, 0xc,  0x7c, 0xcc, 0x1};

  uint8_t buf[86] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xaa, 0x67, 0x5c, 0x32, 0x7,  0x1c, 0xf3, 0x32, 0x86, 0x23,
                                     0xf5, 0x3c, 0xe8, 0xb,  0x3c, 0x73, 0x88, 0x83, 0x17, 0xdd,
                                     0x2f, 0x3f, 0x7,  0x68, 0x28, 0x51, 0x40, 0xb1};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xff};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xec, 0xd0, 0xc6};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1c};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x92, 0x10, 0x66, 0xf5, 0x6e, 0x40, 0xd0, 0x6d, 0xbf, 0x5, 0xf8, 0xeb,
                                     0x3d, 0xd5, 0xc0, 0x73, 0xe1, 0x5,  0x2b, 0x98, 0xa0, 0xc, 0x7c, 0xcc};
  lwmqtt_string_t topic_filter_s4 = {24, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1184, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28334 [("\196\208x\145\a\197\236\166\237\198\\-\222a\r\140\158N\199\&7\178\RS`=>!E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\163/?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("_",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\\\158\228\223\ETB:\150)dY|!\236\205\164s\139\v\167>\221\EM",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\232\208\185f\157\247N\190\191\ETX\212\t\213\229\SOH
// \206\v\178@\162^",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("m\137\v\f7\141&\216@\158!\GS\192\191\189",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\EOTg\241\167",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode71) {
  uint8_t pkt[] = {0x82, 0x75, 0x6e, 0xae, 0x0,  0x1b, 0xc4, 0xd0, 0x78, 0x91, 0x7,  0xc5, 0xec, 0xa6, 0xed, 0xc6, 0x5c,
                   0x2d, 0xde, 0x61, 0xd,  0x8c, 0x9e, 0x4e, 0xc7, 0x37, 0xb2, 0x1e, 0x60, 0x3d, 0x3e, 0x21, 0x45, 0x0,
                   0x0,  0x3,  0xa3, 0x2f, 0x3f, 0x1,  0x0,  0x1,  0x5f, 0x2,  0x0,  0x16, 0x5c, 0x9e, 0xe4, 0xdf, 0x17,
                   0x3a, 0x96, 0x29, 0x64, 0x59, 0x7c, 0x21, 0xec, 0xcd, 0xa4, 0x73, 0x8b, 0xb,  0xa7, 0x3e, 0xdd, 0x19,
                   0x2,  0x0,  0x16, 0xe8, 0xd0, 0xb9, 0x66, 0x9d, 0xf7, 0x4e, 0xbe, 0xbf, 0x3,  0xd4, 0x9,  0xd5, 0xe5,
                   0x1,  0x20, 0xce, 0xb,  0xb2, 0x40, 0xa2, 0x5e, 0x1,  0x0,  0xf,  0x6d, 0x89, 0xb,  0xc,  0x37, 0x8d,
                   0x26, 0xd8, 0x40, 0x9e, 0x21, 0x1d, 0xc0, 0xbf, 0xbd, 0x1,  0x0,  0x4,  0x4,  0x67, 0xf1, 0xa7, 0x1};

  uint8_t buf[129] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0xd0, 0x78, 0x91, 0x7,  0xc5, 0xec, 0xa6, 0xed, 0xc6, 0x5c, 0x2d, 0xde, 0x61,
                                     0xd,  0x8c, 0x9e, 0x4e, 0xc7, 0x37, 0xb2, 0x1e, 0x60, 0x3d, 0x3e, 0x21, 0x45};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa3, 0x2f, 0x3f};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5f};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x5c, 0x9e, 0xe4, 0xdf, 0x17, 0x3a, 0x96, 0x29, 0x64, 0x59, 0x7c,
                                     0x21, 0xec, 0xcd, 0xa4, 0x73, 0x8b, 0xb,  0xa7, 0x3e, 0xdd, 0x19};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe8, 0xd0, 0xb9, 0x66, 0x9d, 0xf7, 0x4e, 0xbe, 0xbf, 0x3,  0xd4,
                                     0x9,  0xd5, 0xe5, 0x1,  0x20, 0xce, 0xb,  0xb2, 0x40, 0xa2, 0x5e};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6d, 0x89, 0xb,  0xc,  0x37, 0x8d, 0x26, 0xd8,
                                     0x40, 0x9e, 0x21, 0x1d, 0xc0, 0xbf, 0xbd};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x4, 0x67, 0xf1, 0xa7};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 28334, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 26598 [("=\225\250g\177\216\249\&8\252='RyD\192\199@\SOh\247\158\236\151\&4d\199\247",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("#\151\183Z\151O\182\172\150*i\\\161\230\221\176\251\180\217H;]\215\250\196L\201\228\DC3\244",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\243\152\219Kk\182Q,eE \RS*/\SYN\134V\DC3FyOS[",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\139\SOH\t\179g\DC3&n'\158C\223Y\254",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\205$\145XN\129y\188+2W2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode72) {
  uint8_t pkt[] = {0x82, 0x7e, 0x67, 0xe6, 0x0,  0x1b, 0x3d, 0xe1, 0xfa, 0x67, 0xb1, 0xd8, 0xf9, 0x38, 0xfc, 0x3d,
                   0x27, 0x52, 0x79, 0x44, 0xc0, 0xc7, 0x40, 0xe,  0x68, 0xf7, 0x9e, 0xec, 0x97, 0x34, 0x64, 0xc7,
                   0xf7, 0x2,  0x0,  0x0,  0x1,  0x0,  0x1e, 0x23, 0x97, 0xb7, 0x5a, 0x97, 0x4f, 0xb6, 0xac, 0x96,
                   0x2a, 0x69, 0x5c, 0xa1, 0xe6, 0xdd, 0xb0, 0xfb, 0xb4, 0xd9, 0x48, 0x3b, 0x5d, 0xd7, 0xfa, 0xc4,
                   0x4c, 0xc9, 0xe4, 0x13, 0xf4, 0x0,  0x0,  0x17, 0xf3, 0x98, 0xdb, 0x4b, 0x6b, 0xb6, 0x51, 0x2c,
                   0x65, 0x45, 0x20, 0x1e, 0x2a, 0x2f, 0x16, 0x86, 0x56, 0x13, 0x46, 0x79, 0x4f, 0x53, 0x5b, 0x1,
                   0x0,  0xe,  0x8b, 0x1,  0x9,  0xb3, 0x67, 0x13, 0x26, 0x6e, 0x27, 0x9e, 0x43, 0xdf, 0x59, 0xfe,
                   0x0,  0x0,  0xc,  0xcd, 0x24, 0x91, 0x58, 0x4e, 0x81, 0x79, 0xbc, 0x2b, 0x32, 0x57, 0x32, 0x1};

  uint8_t buf[138] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x3d, 0xe1, 0xfa, 0x67, 0xb1, 0xd8, 0xf9, 0x38, 0xfc, 0x3d, 0x27, 0x52, 0x79, 0x44,
                                     0xc0, 0xc7, 0x40, 0xe,  0x68, 0xf7, 0x9e, 0xec, 0x97, 0x34, 0x64, 0xc7, 0xf7};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x23, 0x97, 0xb7, 0x5a, 0x97, 0x4f, 0xb6, 0xac, 0x96, 0x2a,
                                     0x69, 0x5c, 0xa1, 0xe6, 0xdd, 0xb0, 0xfb, 0xb4, 0xd9, 0x48,
                                     0x3b, 0x5d, 0xd7, 0xfa, 0xc4, 0x4c, 0xc9, 0xe4, 0x13, 0xf4};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf3, 0x98, 0xdb, 0x4b, 0x6b, 0xb6, 0x51, 0x2c, 0x65, 0x45, 0x20, 0x1e,
                                     0x2a, 0x2f, 0x16, 0x86, 0x56, 0x13, 0x46, 0x79, 0x4f, 0x53, 0x5b};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8b, 0x1, 0x9, 0xb3, 0x67, 0x13, 0x26, 0x6e, 0x27, 0x9e, 0x43, 0xdf, 0x59, 0xfe};
  lwmqtt_string_t topic_filter_s4 = {14, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xcd, 0x24, 0x91, 0x58, 0x4e, 0x81, 0x79, 0xbc, 0x2b, 0x32, 0x57, 0x32};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 26598, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8075 [("\153\219wC\224\141\212\158d\179\204\165\177\194fH\170\138^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\163{\DC4\190\210\150W\162\228}\131*;\DC1\208;\155n\214I\147\176\137\176",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\v\244\209y\179\242\230\161\147:u\140\228\&5k\177\179\250",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("<c\220Q\219\172,\169\135\208\141ks\132\"\227\SOH\199\136\SUB@",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NAK\248\202\244\EMh#\175\134\193\250\DC2J\166o&_\ACK\FS\SUB\231\219\128",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode73) {
  uint8_t pkt[] = {0x82, 0x7a, 0x1f, 0x8b, 0x0,  0x13, 0x99, 0xdb, 0x77, 0x43, 0xe0, 0x8d, 0xd4, 0x9e, 0x64, 0xb3,
                   0xcc, 0xa5, 0xb1, 0xc2, 0x66, 0x48, 0xaa, 0x8a, 0x5e, 0x1,  0x0,  0x18, 0xa3, 0x7b, 0x14, 0xbe,
                   0xd2, 0x96, 0x57, 0xa2, 0xe4, 0x7d, 0x83, 0x2a, 0x3b, 0x11, 0xd0, 0x3b, 0x9b, 0x6e, 0xd6, 0x49,
                   0x93, 0xb0, 0x89, 0xb0, 0x2,  0x0,  0x12, 0xb,  0xf4, 0xd1, 0x79, 0xb3, 0xf2, 0xe6, 0xa1, 0x93,
                   0x3a, 0x75, 0x8c, 0xe4, 0x35, 0x6b, 0xb1, 0xb3, 0xfa, 0x2,  0x0,  0x15, 0x3c, 0x63, 0xdc, 0x51,
                   0xdb, 0xac, 0x2c, 0xa9, 0x87, 0xd0, 0x8d, 0x6b, 0x73, 0x84, 0x22, 0xe3, 0x1,  0xc7, 0x88, 0x1a,
                   0x40, 0x0,  0x0,  0x17, 0x15, 0xf8, 0xca, 0xf4, 0x19, 0x68, 0x23, 0xaf, 0x86, 0xc1, 0xfa, 0x12,
                   0x4a, 0xa6, 0x6f, 0x26, 0x5f, 0x6,  0x1c, 0x1a, 0xe7, 0xdb, 0x80, 0x0};

  uint8_t buf[134] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x99, 0xdb, 0x77, 0x43, 0xe0, 0x8d, 0xd4, 0x9e, 0x64, 0xb3,
                                     0xcc, 0xa5, 0xb1, 0xc2, 0x66, 0x48, 0xaa, 0x8a, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa3, 0x7b, 0x14, 0xbe, 0xd2, 0x96, 0x57, 0xa2, 0xe4, 0x7d, 0x83, 0x2a,
                                     0x3b, 0x11, 0xd0, 0x3b, 0x9b, 0x6e, 0xd6, 0x49, 0x93, 0xb0, 0x89, 0xb0};
  lwmqtt_string_t topic_filter_s1 = {24, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb,  0xf4, 0xd1, 0x79, 0xb3, 0xf2, 0xe6, 0xa1, 0x93,
                                     0x3a, 0x75, 0x8c, 0xe4, 0x35, 0x6b, 0xb1, 0xb3, 0xfa};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3c, 0x63, 0xdc, 0x51, 0xdb, 0xac, 0x2c, 0xa9, 0x87, 0xd0, 0x8d,
                                     0x6b, 0x73, 0x84, 0x22, 0xe3, 0x1,  0xc7, 0x88, 0x1a, 0x40};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x15, 0xf8, 0xca, 0xf4, 0x19, 0x68, 0x23, 0xaf, 0x86, 0xc1, 0xfa, 0x12,
                                     0x4a, 0xa6, 0x6f, 0x26, 0x5f, 0x6,  0x1c, 0x1a, 0xe7, 0xdb, 0x80};
  lwmqtt_string_t topic_filter_s4 = {23, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 8075, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 17947 [("E",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\b\194\179\135\DEL\153\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS1}),("Ck\239\&5\r'\223d\205C\238\188\149\179\198\131\139\135\200j\152\135\161aZ5r\178",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("P\157\181\133\180{",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("hs_K\231\&7\ENQ\142\157\194\196\252\240\136)\157\159\167\255G",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("t\128h\134T\160\178ra\146\201",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("2\136\235\225",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("t\200\SOH\144\243\v\159F&\253\186*\163\136d\rA\DC1\ACK\209\"\DC1\193V\DC1",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\232\169\205\147\SYN\129\145\196#!\ACK\171I\225",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\215\221\EM\254/\164d>\184\211O\228\212N\251O\183\208V\241\211\t\209\244\RS\186",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode74) {
  uint8_t pkt[] = {0x82, 0xb1, 0x1,  0x46, 0x1b, 0x0,  0x1,  0x45, 0x0,  0x0,  0x7,  0x8,  0xc2, 0xb3, 0x87, 0x7f, 0x99,
                   0x5c, 0x1,  0x0,  0x1c, 0x43, 0x6b, 0xef, 0x35, 0xd,  0x27, 0xdf, 0x64, 0xcd, 0x43, 0xee, 0xbc, 0x95,
                   0xb3, 0xc6, 0x83, 0x8b, 0x87, 0xc8, 0x6a, 0x98, 0x87, 0xa1, 0x61, 0x5a, 0x35, 0x72, 0xb2, 0x0,  0x0,
                   0x6,  0x50, 0x9d, 0xb5, 0x85, 0xb4, 0x7b, 0x1,  0x0,  0x14, 0x68, 0x73, 0x5f, 0x4b, 0xe7, 0x37, 0x5,
                   0x8e, 0x9d, 0xc2, 0xc4, 0xfc, 0xf0, 0x88, 0x29, 0x9d, 0x9f, 0xa7, 0xff, 0x47, 0x0,  0x0,  0xb,  0x74,
                   0x80, 0x68, 0x86, 0x54, 0xa0, 0xb2, 0x72, 0x61, 0x92, 0xc9, 0x2,  0x0,  0x4,  0x32, 0x88, 0xeb, 0xe1,
                   0x0,  0x0,  0x0,  0x1,  0x0,  0x19, 0x74, 0xc8, 0x1,  0x90, 0xf3, 0xb,  0x9f, 0x46, 0x26, 0xfd, 0xba,
                   0x2a, 0xa3, 0x88, 0x64, 0xd,  0x41, 0x11, 0x6,  0xd1, 0x22, 0x11, 0xc1, 0x56, 0x11, 0x2,  0x0,  0xe,
                   0xe8, 0xa9, 0xcd, 0x93, 0x16, 0x81, 0x91, 0xc4, 0x23, 0x21, 0x6,  0xab, 0x49, 0xe1, 0x1,  0x0,  0x1a,
                   0xd7, 0xdd, 0x19, 0xfe, 0x2f, 0xa4, 0x64, 0x3e, 0xb8, 0xd3, 0x4f, 0xe4, 0xd4, 0x4e, 0xfb, 0x4f, 0xb7,
                   0xd0, 0x56, 0xf1, 0xd3, 0x9,  0xd1, 0xf4, 0x1e, 0xba, 0x1};

  uint8_t buf[190] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x45};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8, 0xc2, 0xb3, 0x87, 0x7f, 0x99, 0x5c};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x43, 0x6b, 0xef, 0x35, 0xd,  0x27, 0xdf, 0x64, 0xcd, 0x43,
                                     0xee, 0xbc, 0x95, 0xb3, 0xc6, 0x83, 0x8b, 0x87, 0xc8, 0x6a,
                                     0x98, 0x87, 0xa1, 0x61, 0x5a, 0x35, 0x72, 0xb2};
  lwmqtt_string_t topic_filter_s2 = {28, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x50, 0x9d, 0xb5, 0x85, 0xb4, 0x7b};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x68, 0x73, 0x5f, 0x4b, 0xe7, 0x37, 0x5,  0x8e, 0x9d, 0xc2,
                                     0xc4, 0xfc, 0xf0, 0x88, 0x29, 0x9d, 0x9f, 0xa7, 0xff, 0x47};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x74, 0x80, 0x68, 0x86, 0x54, 0xa0, 0xb2, 0x72, 0x61, 0x92, 0xc9};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x32, 0x88, 0xeb, 0xe1};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x74, 0xc8, 0x1, 0x90, 0xf3, 0xb, 0x9f, 0x46, 0x26, 0xfd, 0xba, 0x2a, 0xa3,
                                     0x88, 0x64, 0xd, 0x41, 0x11, 0x6, 0xd1, 0x22, 0x11, 0xc1, 0x56, 0x11};
  lwmqtt_string_t topic_filter_s8 = {25, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xe8, 0xa9, 0xcd, 0x93, 0x16, 0x81, 0x91, 0xc4, 0x23, 0x21, 0x6, 0xab, 0x49, 0xe1};
  lwmqtt_string_t topic_filter_s9 = {14, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xd7, 0xdd, 0x19, 0xfe, 0x2f, 0xa4, 0x64, 0x3e, 0xb8, 0xd3, 0x4f, 0xe4, 0xd4,
                                      0x4e, 0xfb, 0x4f, 0xb7, 0xd0, 0x56, 0xf1, 0xd3, 0x9,  0xd1, 0xf4, 0x1e, 0xba};
  lwmqtt_string_t topic_filter_s10 = {26, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 17947, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 167 [("\231\169\150\t\250\191\150<\142\244\175\168\192\184\179",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\212\vx}\a\239:\\|\164~\165\239\172\b\182j\"e\244",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\199\200~",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\US97\178\208\r#N\n\150nm+6\213\NUL\171\252\t",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\137\ETX\197\217\NUL\223\232\207\253\202\144V#\158k\156DSE2\145\ENQ\158\234\133\150",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("#\149\222<\ETXQ\182,\188$Y~(\178|T\176_\145\151'",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\175\ENQ\GS\245\242)\153\DC2\129\190\DC4\n\235\129\160 \190\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("DJ\236\247\\fp\240\131\213\DLEP\133\CAN\133",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\188n\248-\193\248\138\147\SI\181\to\137\t\148\230\233=",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode75) {
  uint8_t pkt[] = {0x82, 0xb8, 0x1,  0x0,  0xa7, 0x0,  0xf,  0xe7, 0xa9, 0x96, 0x9,  0xfa, 0xbf, 0x96, 0x3c, 0x8e, 0xf4,
                   0xaf, 0xa8, 0xc0, 0xb8, 0xb3, 0x2,  0x0,  0x14, 0xd4, 0xb,  0x78, 0x7d, 0x7,  0xef, 0x3a, 0x5c, 0x7c,
                   0xa4, 0x7e, 0xa5, 0xef, 0xac, 0x8,  0xb6, 0x6a, 0x22, 0x65, 0xf4, 0x2,  0x0,  0x3,  0xc7, 0xc8, 0x7e,
                   0x0,  0x0,  0x13, 0x1f, 0x39, 0x37, 0xb2, 0xd0, 0xd,  0x23, 0x4e, 0xa,  0x96, 0x6e, 0x6d, 0x2b, 0x36,
                   0xd5, 0x0,  0xab, 0xfc, 0x9,  0x2,  0x0,  0x1a, 0x89, 0x3,  0xc5, 0xd9, 0x0,  0xdf, 0xe8, 0xcf, 0xfd,
                   0xca, 0x90, 0x56, 0x23, 0x9e, 0x6b, 0x9c, 0x44, 0x53, 0x45, 0x32, 0x91, 0x5,  0x9e, 0xea, 0x85, 0x96,
                   0x1,  0x0,  0x15, 0x23, 0x95, 0xde, 0x3c, 0x3,  0x51, 0xb6, 0x2c, 0xbc, 0x24, 0x59, 0x7e, 0x28, 0xb2,
                   0x7c, 0x54, 0xb0, 0x5f, 0x91, 0x97, 0x27, 0x0,  0x0,  0x12, 0xaf, 0x5,  0x1d, 0xf5, 0xf2, 0x29, 0x99,
                   0x12, 0x81, 0xbe, 0x14, 0xa,  0xeb, 0x81, 0xa0, 0x20, 0xbe, 0xe9, 0x2,  0x0,  0xf,  0x44, 0x4a, 0xec,
                   0xf7, 0x5c, 0x66, 0x70, 0xf0, 0x83, 0xd5, 0x10, 0x50, 0x85, 0x18, 0x85, 0x1,  0x0,  0x12, 0xbc, 0x6e,
                   0xf8, 0x2d, 0xc1, 0xf8, 0x8a, 0x93, 0xf,  0xb5, 0x9,  0x6f, 0x89, 0x9,  0x94, 0xe6, 0xe9, 0x3d, 0x1};

  uint8_t buf[197] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0xe7, 0xa9, 0x96, 0x9,  0xfa, 0xbf, 0x96, 0x3c,
                                     0x8e, 0xf4, 0xaf, 0xa8, 0xc0, 0xb8, 0xb3};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd4, 0xb,  0x78, 0x7d, 0x7, 0xef, 0x3a, 0x5c, 0x7c, 0xa4,
                                     0x7e, 0xa5, 0xef, 0xac, 0x8, 0xb6, 0x6a, 0x22, 0x65, 0xf4};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc7, 0xc8, 0x7e};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1f, 0x39, 0x37, 0xb2, 0xd0, 0xd, 0x23, 0x4e, 0xa, 0x96,
                                     0x6e, 0x6d, 0x2b, 0x36, 0xd5, 0x0, 0xab, 0xfc, 0x9};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x89, 0x3,  0xc5, 0xd9, 0x0,  0xdf, 0xe8, 0xcf, 0xfd, 0xca, 0x90, 0x56, 0x23,
                                     0x9e, 0x6b, 0x9c, 0x44, 0x53, 0x45, 0x32, 0x91, 0x5,  0x9e, 0xea, 0x85, 0x96};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x23, 0x95, 0xde, 0x3c, 0x3,  0x51, 0xb6, 0x2c, 0xbc, 0x24, 0x59,
                                     0x7e, 0x28, 0xb2, 0x7c, 0x54, 0xb0, 0x5f, 0x91, 0x97, 0x27};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xaf, 0x5,  0x1d, 0xf5, 0xf2, 0x29, 0x99, 0x12, 0x81,
                                     0xbe, 0x14, 0xa,  0xeb, 0x81, 0xa0, 0x20, 0xbe, 0xe9};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x44, 0x4a, 0xec, 0xf7, 0x5c, 0x66, 0x70, 0xf0,
                                     0x83, 0xd5, 0x10, 0x50, 0x85, 0x18, 0x85};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xbc, 0x6e, 0xf8, 0x2d, 0xc1, 0xf8, 0x8a, 0x93, 0xf,
                                     0xb5, 0x9,  0x6f, 0x89, 0x9,  0x94, 0xe6, 0xe9, 0x3d};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 167, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3223 [("U#\128\166r\217",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\198l]6!\158\151\NUL\255\155|\156\254",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode76) {
  uint8_t pkt[] = {0x82, 0x1b, 0xc,  0x97, 0x0,  0x6,  0x55, 0x23, 0x80, 0xa6, 0x72, 0xd9, 0x0,  0x0, 0xd,
                   0xc6, 0x6c, 0x5d, 0x36, 0x21, 0x9e, 0x97, 0x0,  0xff, 0x9b, 0x7c, 0x9c, 0xfe, 0x1};

  uint8_t buf[39] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x55, 0x23, 0x80, 0xa6, 0x72, 0xd9};
  lwmqtt_string_t topic_filter_s0 = {6, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc6, 0x6c, 0x5d, 0x36, 0x21, 0x9e, 0x97, 0x0, 0xff, 0x9b, 0x7c, 0x9c, 0xfe};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 3223, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1845 [("\196\128\&4\163O\255",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("f\255\128\199\ETXD\164B\184\249 \251\243\158TM\242\130",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("d@V!\249\199\168\166\194\241\244\243y\202\222\203\132\164\184\145\196\164",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\SYN\197\232MQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\242W\198\204\146t\ESC\192'\177\DC49>\166`{\152Q\247v\213\133\EM \160~@",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\229\252\136\170\181]\155\129\151\157\222\219P\163\177\130\146F\205",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\234\196[a\EOTi\137\214",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\232\&4\187\230\144aj3\ETB\EM\162%t\228",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\STXv\213",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\"=\211\194\176",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode77) {
  uint8_t pkt[] = {0x82, 0xa2, 0x1,  0x7,  0x35, 0x0,  0x6,  0xc4, 0x80, 0x34, 0xa3, 0x4f, 0xff, 0x2,  0x0,  0x12, 0x66,
                   0xff, 0x80, 0xc7, 0x3,  0x44, 0xa4, 0x42, 0xb8, 0xf9, 0x20, 0xfb, 0xf3, 0x9e, 0x54, 0x4d, 0xf2, 0x82,
                   0x0,  0x0,  0x16, 0x64, 0x40, 0x56, 0x21, 0xf9, 0xc7, 0xa8, 0xa6, 0xc2, 0xf1, 0xf4, 0xf3, 0x79, 0xca,
                   0xde, 0xcb, 0x84, 0xa4, 0xb8, 0x91, 0xc4, 0xa4, 0x0,  0x0,  0x5,  0x16, 0xc5, 0xe8, 0x4d, 0x51, 0x1,
                   0x0,  0x1b, 0xf2, 0x57, 0xc6, 0xcc, 0x92, 0x74, 0x1b, 0xc0, 0x27, 0xb1, 0x14, 0x39, 0x3e, 0xa6, 0x60,
                   0x7b, 0x98, 0x51, 0xf7, 0x76, 0xd5, 0x85, 0x19, 0x20, 0xa0, 0x7e, 0x40, 0x0,  0x0,  0x13, 0xe5, 0xfc,
                   0x88, 0xaa, 0xb5, 0x5d, 0x9b, 0x81, 0x97, 0x9d, 0xde, 0xdb, 0x50, 0xa3, 0xb1, 0x82, 0x92, 0x46, 0xcd,
                   0x1,  0x0,  0x0,  0x0,  0x0,  0x8,  0xea, 0xc4, 0x5b, 0x61, 0x4,  0x69, 0x89, 0xd6, 0x2,  0x0,  0xe,
                   0xe8, 0x34, 0xbb, 0xe6, 0x90, 0x61, 0x6a, 0x33, 0x17, 0x19, 0xa2, 0x25, 0x74, 0xe4, 0x0,  0x0,  0x3,
                   0x2,  0x76, 0xd5, 0x2,  0x0,  0x5,  0x22, 0x3d, 0xd3, 0xc2, 0xb0, 0x2};

  uint8_t buf[175] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0x80, 0x34, 0xa3, 0x4f, 0xff};
  lwmqtt_string_t topic_filter_s0 = {6, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x66, 0xff, 0x80, 0xc7, 0x3,  0x44, 0xa4, 0x42, 0xb8,
                                     0xf9, 0x20, 0xfb, 0xf3, 0x9e, 0x54, 0x4d, 0xf2, 0x82};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x64, 0x40, 0x56, 0x21, 0xf9, 0xc7, 0xa8, 0xa6, 0xc2, 0xf1, 0xf4,
                                     0xf3, 0x79, 0xca, 0xde, 0xcb, 0x84, 0xa4, 0xb8, 0x91, 0xc4, 0xa4};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x16, 0xc5, 0xe8, 0x4d, 0x51};
  lwmqtt_string_t topic_filter_s3 = {5, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf2, 0x57, 0xc6, 0xcc, 0x92, 0x74, 0x1b, 0xc0, 0x27, 0xb1, 0x14, 0x39, 0x3e, 0xa6,
                                     0x60, 0x7b, 0x98, 0x51, 0xf7, 0x76, 0xd5, 0x85, 0x19, 0x20, 0xa0, 0x7e, 0x40};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe5, 0xfc, 0x88, 0xaa, 0xb5, 0x5d, 0x9b, 0x81, 0x97, 0x9d,
                                     0xde, 0xdb, 0x50, 0xa3, 0xb1, 0x82, 0x92, 0x46, 0xcd};
  lwmqtt_string_t topic_filter_s5 = {19, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0};
  lwmqtt_string_t topic_filter_s6 = {0, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xea, 0xc4, 0x5b, 0x61, 0x4, 0x69, 0x89, 0xd6};
  lwmqtt_string_t topic_filter_s7 = {8, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xe8, 0x34, 0xbb, 0xe6, 0x90, 0x61, 0x6a,
                                     0x33, 0x17, 0x19, 0xa2, 0x25, 0x74, 0xe4};
  lwmqtt_string_t topic_filter_s8 = {14, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x2, 0x76, 0xd5};
  lwmqtt_string_t topic_filter_s9 = {3, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x22, 0x3d, 0xd3, 0xc2, 0xb0};
  lwmqtt_string_t topic_filter_s10 = {5, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1845, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12377 [("\156\222Z\207\145\DC1\171\133j\149\210Dr\137\&1\130\219\182 2H\210\203s",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode78) {
  uint8_t pkt[] = {0x82, 0x1d, 0x30, 0x59, 0x0,  0x18, 0x9c, 0xde, 0x5a, 0xcf, 0x91, 0x11, 0xab, 0x85, 0x6a, 0x95,
                   0xd2, 0x44, 0x72, 0x89, 0x31, 0x82, 0xdb, 0xb6, 0x20, 0x32, 0x48, 0xd2, 0xcb, 0x73, 0x1};

  uint8_t buf[41] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x9c, 0xde, 0x5a, 0xcf, 0x91, 0x11, 0xab, 0x85, 0x6a, 0x95, 0xd2, 0x44,
                                     0x72, 0x89, 0x31, 0x82, 0xdb, 0xb6, 0x20, 0x32, 0x48, 0xd2, 0xcb, 0x73};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 12377, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 290 [("-\CAN\FSe\144\STXP\243wu\191%\250\176\&5\250\204V\239\137}",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\128&U[\222\&1,\232\&9\137\194\vD\146\155m\DLE\213\249\229d\FSI+\v]",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\232g?\215\156\STXD\132\NUL\197\ACK(\234:\DC1\153C\148\b/\180^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\176\160\178:&\NUL\182\\\173\RS\138\144\138@\148U\ENQA>\191\&1t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),(".\162!\217\216*\155\205\236\RSc\tEWe2\159'\216\149\193\235\DC1[\200\188\233\230\215",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\187\152j\248\219\&2\152\&3\SO\GS\135",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\176\144m\168\226",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\227\202\180@6a",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("|\129\183e\162\160X\243e\238E\183\184\128SY\157\EM6\253",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode79) {
  uint8_t pkt[] = {0x82, 0xbf, 0x1,  0x1,  0x22, 0x0,  0x15, 0x2d, 0x18, 0x1c, 0x65, 0x90, 0x2,  0x50, 0xf3, 0x77, 0x75,
                   0xbf, 0x25, 0xfa, 0xb0, 0x35, 0xfa, 0xcc, 0x56, 0xef, 0x89, 0x7d, 0x1,  0x0,  0x1a, 0x80, 0x26, 0x55,
                   0x5b, 0xde, 0x31, 0x2c, 0xe8, 0x39, 0x89, 0xc2, 0xb,  0x44, 0x92, 0x9b, 0x6d, 0x10, 0xd5, 0xf9, 0xe5,
                   0x64, 0x1c, 0x49, 0x2b, 0xb,  0x5d, 0x0,  0x0,  0x16, 0xe8, 0x67, 0x3f, 0xd7, 0x9c, 0x2,  0x44, 0x84,
                   0x0,  0xc5, 0x6,  0x28, 0xea, 0x3a, 0x11, 0x99, 0x43, 0x94, 0x8,  0x2f, 0xb4, 0x5e, 0x1,  0x0,  0x16,
                   0xb0, 0xa0, 0xb2, 0x3a, 0x26, 0x0,  0xb6, 0x5c, 0xad, 0x1e, 0x8a, 0x90, 0x8a, 0x40, 0x94, 0x55, 0x5,
                   0x41, 0x3e, 0xbf, 0x31, 0x74, 0x1,  0x0,  0x1d, 0x2e, 0xa2, 0x21, 0xd9, 0xd8, 0x2a, 0x9b, 0xcd, 0xec,
                   0x1e, 0x63, 0x9,  0x45, 0x57, 0x65, 0x32, 0x9f, 0x27, 0xd8, 0x95, 0xc1, 0xeb, 0x11, 0x5b, 0xc8, 0xbc,
                   0xe9, 0xe6, 0xd7, 0x2,  0x0,  0xb,  0xbb, 0x98, 0x6a, 0xf8, 0xdb, 0x32, 0x98, 0x33, 0xe,  0x1d, 0x87,
                   0x2,  0x0,  0x5,  0xb0, 0x90, 0x6d, 0xa8, 0xe2, 0x1,  0x0,  0x6,  0xe3, 0xca, 0xb4, 0x40, 0x36, 0x61,
                   0x2,  0x0,  0x14, 0x7c, 0x81, 0xb7, 0x65, 0xa2, 0xa0, 0x58, 0xf3, 0x65, 0xee, 0x45, 0xb7, 0xb8, 0x80,
                   0x53, 0x59, 0x9d, 0x19, 0x36, 0xfd, 0x1};

  uint8_t buf[204] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x2d, 0x18, 0x1c, 0x65, 0x90, 0x2,  0x50, 0xf3, 0x77, 0x75, 0xbf,
                                     0x25, 0xfa, 0xb0, 0x35, 0xfa, 0xcc, 0x56, 0xef, 0x89, 0x7d};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x80, 0x26, 0x55, 0x5b, 0xde, 0x31, 0x2c, 0xe8, 0x39, 0x89, 0xc2, 0xb, 0x44,
                                     0x92, 0x9b, 0x6d, 0x10, 0xd5, 0xf9, 0xe5, 0x64, 0x1c, 0x49, 0x2b, 0xb, 0x5d};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe8, 0x67, 0x3f, 0xd7, 0x9c, 0x2,  0x44, 0x84, 0x0,  0xc5, 0x6,
                                     0x28, 0xea, 0x3a, 0x11, 0x99, 0x43, 0x94, 0x8,  0x2f, 0xb4, 0x5e};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb0, 0xa0, 0xb2, 0x3a, 0x26, 0x0, 0xb6, 0x5c, 0xad, 0x1e, 0x8a,
                                     0x90, 0x8a, 0x40, 0x94, 0x55, 0x5, 0x41, 0x3e, 0xbf, 0x31, 0x74};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x2e, 0xa2, 0x21, 0xd9, 0xd8, 0x2a, 0x9b, 0xcd, 0xec, 0x1e,
                                     0x63, 0x9,  0x45, 0x57, 0x65, 0x32, 0x9f, 0x27, 0xd8, 0x95,
                                     0xc1, 0xeb, 0x11, 0x5b, 0xc8, 0xbc, 0xe9, 0xe6, 0xd7};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xbb, 0x98, 0x6a, 0xf8, 0xdb, 0x32, 0x98, 0x33, 0xe, 0x1d, 0x87};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb0, 0x90, 0x6d, 0xa8, 0xe2};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xe3, 0xca, 0xb4, 0x40, 0x36, 0x61};
  lwmqtt_string_t topic_filter_s7 = {6, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x7c, 0x81, 0xb7, 0x65, 0xa2, 0xa0, 0x58, 0xf3, 0x65, 0xee,
                                     0x45, 0xb7, 0xb8, 0x80, 0x53, 0x59, 0x9d, 0x19, 0x36, 0xfd};
  lwmqtt_string_t topic_filter_s8 = {20, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 290, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28088 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),(":\193@\178\186\219\136\180",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\254\238]\245\184?\239",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("W'\132<\DC3\nUBMC\159\172b\NUL\185",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode80) {
  uint8_t pkt[] = {0x82, 0x2c, 0x6d, 0xb8, 0x0,  0x0,  0x2,  0x0,  0x8,  0x3a, 0xc1, 0x40, 0xb2, 0xba, 0xdb, 0x88,
                   0xb4, 0x2,  0x0,  0x7,  0xfe, 0xee, 0x5d, 0xf5, 0xb8, 0x3f, 0xef, 0x0,  0x0,  0xf,  0x57, 0x27,
                   0x84, 0x3c, 0x13, 0xa,  0x55, 0x42, 0x4d, 0x43, 0x9f, 0xac, 0x62, 0x0,  0xb9, 0x1};

  uint8_t buf[56] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x3a, 0xc1, 0x40, 0xb2, 0xba, 0xdb, 0x88, 0xb4};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xfe, 0xee, 0x5d, 0xf5, 0xb8, 0x3f, 0xef};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x57, 0x27, 0x84, 0x3c, 0x13, 0xa, 0x55, 0x42,
                                     0x4d, 0x43, 0x9f, 0xac, 0x62, 0x0, 0xb9};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 28088, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4272 [("\":\159\"\202S\RS\ACK\244z5",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\242\235\190\253wC6\EMH\250\232\247\131u\172\a=\132\224\&9\192 \GS",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\222!bl\193ck\202\&8K",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\162\190\167\211\FS\232\161;\130{%\ENQ\ACK\200\DC1\153\206\DC2\172b\193r\138",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("!",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode81) {
  uint8_t pkt[] = {0x82, 0x55, 0x10, 0xb0, 0x0,  0xb,  0x22, 0x3a, 0x9f, 0x22, 0xca, 0x53, 0x1e, 0x6,  0xf4,
                   0x7a, 0x35, 0x2,  0x0,  0x17, 0xf2, 0xeb, 0xbe, 0xfd, 0x77, 0x43, 0x36, 0x19, 0x48, 0xfa,
                   0xe8, 0xf7, 0x83, 0x75, 0xac, 0x7,  0x3d, 0x84, 0xe0, 0x39, 0xc0, 0x20, 0x1d, 0x0,  0x0,
                   0xa,  0xde, 0x21, 0x62, 0x6c, 0xc1, 0x63, 0x6b, 0xca, 0x38, 0x4b, 0x0,  0x0,  0x17, 0xa2,
                   0xbe, 0xa7, 0xd3, 0x1c, 0xe8, 0xa1, 0x3b, 0x82, 0x7b, 0x25, 0x5,  0x6,  0xc8, 0x11, 0x99,
                   0xce, 0x12, 0xac, 0x62, 0xc1, 0x72, 0x8a, 0x2,  0x0,  0x1,  0x21, 0x2};

  uint8_t buf[97] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x22, 0x3a, 0x9f, 0x22, 0xca, 0x53, 0x1e, 0x6, 0xf4, 0x7a, 0x35};
  lwmqtt_string_t topic_filter_s0 = {11, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf2, 0xeb, 0xbe, 0xfd, 0x77, 0x43, 0x36, 0x19, 0x48, 0xfa, 0xe8, 0xf7,
                                     0x83, 0x75, 0xac, 0x7,  0x3d, 0x84, 0xe0, 0x39, 0xc0, 0x20, 0x1d};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xde, 0x21, 0x62, 0x6c, 0xc1, 0x63, 0x6b, 0xca, 0x38, 0x4b};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa2, 0xbe, 0xa7, 0xd3, 0x1c, 0xe8, 0xa1, 0x3b, 0x82, 0x7b, 0x25, 0x5,
                                     0x6,  0xc8, 0x11, 0x99, 0xce, 0x12, 0xac, 0x62, 0xc1, 0x72, 0x8a};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x21};
  lwmqtt_string_t topic_filter_s4 = {1, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4272, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14420 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\193\143\248\171\SUBB\US\162U`\238\207",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\230\138\SIF\159~gN\227\241|",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("'\194\SUB\DC1\143+,\"\128\209\SUB\220\162\DC1\240\196\DC3\226\NUL\146\226:\STX\189J*~&\200",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("~3\195L&]\160\184\161\STX\168\181#Em!\205\252K\253",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("dI\177g\202Vp4k\ENQ\178\255z\171x\212\STX\224\RSS\FS\169\144\180\151\182\201",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("6\NAK\EOT\145\216\229B\EM\247\242\&1b\223\131\141",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode82) {
  uint8_t pkt[] = {0x82, 0x89, 0x1,  0x38, 0x54, 0x0,  0x0,  0x0,  0x0,  0xc,  0xc1, 0x8f, 0xf8, 0xab, 0x1a, 0x42,
                   0x1f, 0xa2, 0x55, 0x60, 0xee, 0xcf, 0x0,  0x0,  0xb,  0xe6, 0x8a, 0xf,  0x46, 0x9f, 0x7e, 0x67,
                   0x4e, 0xe3, 0xf1, 0x7c, 0x0,  0x0,  0x1d, 0x27, 0xc2, 0x1a, 0x11, 0x8f, 0x2b, 0x2c, 0x22, 0x80,
                   0xd1, 0x1a, 0xdc, 0xa2, 0x11, 0xf0, 0xc4, 0x13, 0xe2, 0x0,  0x92, 0xe2, 0x3a, 0x2,  0xbd, 0x4a,
                   0x2a, 0x7e, 0x26, 0xc8, 0x2,  0x0,  0x14, 0x7e, 0x33, 0xc3, 0x4c, 0x26, 0x5d, 0xa0, 0xb8, 0xa1,
                   0x2,  0xa8, 0xb5, 0x23, 0x45, 0x6d, 0x21, 0xcd, 0xfc, 0x4b, 0xfd, 0x2,  0x0,  0x1b, 0x64, 0x49,
                   0xb1, 0x67, 0xca, 0x56, 0x70, 0x34, 0x6b, 0x5,  0xb2, 0xff, 0x7a, 0xab, 0x78, 0xd4, 0x2,  0xe0,
                   0x1e, 0x53, 0x1c, 0xa9, 0x90, 0xb4, 0x97, 0xb6, 0xc9, 0x2,  0x0,  0xf,  0x36, 0x15, 0x4,  0x91,
                   0xd8, 0xe5, 0x42, 0x19, 0xf7, 0xf2, 0x31, 0x62, 0xdf, 0x83, 0x8d, 0x2};

  uint8_t buf[150] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x8f, 0xf8, 0xab, 0x1a, 0x42, 0x1f, 0xa2, 0x55, 0x60, 0xee, 0xcf};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe6, 0x8a, 0xf, 0x46, 0x9f, 0x7e, 0x67, 0x4e, 0xe3, 0xf1, 0x7c};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x27, 0xc2, 0x1a, 0x11, 0x8f, 0x2b, 0x2c, 0x22, 0x80, 0xd1,
                                     0x1a, 0xdc, 0xa2, 0x11, 0xf0, 0xc4, 0x13, 0xe2, 0x0,  0x92,
                                     0xe2, 0x3a, 0x2,  0xbd, 0x4a, 0x2a, 0x7e, 0x26, 0xc8};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x7e, 0x33, 0xc3, 0x4c, 0x26, 0x5d, 0xa0, 0xb8, 0xa1, 0x2,
                                     0xa8, 0xb5, 0x23, 0x45, 0x6d, 0x21, 0xcd, 0xfc, 0x4b, 0xfd};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x64, 0x49, 0xb1, 0x67, 0xca, 0x56, 0x70, 0x34, 0x6b, 0x5,  0xb2, 0xff, 0x7a, 0xab,
                                     0x78, 0xd4, 0x2,  0xe0, 0x1e, 0x53, 0x1c, 0xa9, 0x90, 0xb4, 0x97, 0xb6, 0xc9};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x36, 0x15, 0x4,  0x91, 0xd8, 0xe5, 0x42, 0x19,
                                     0xf7, 0xf2, 0x31, 0x62, 0xdf, 0x83, 0x8d};
  lwmqtt_string_t topic_filter_s6 = {15, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14420, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27160 [("\162D\159",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\195_\131\NULo|\DC3\153\204\130Z\129\a\148$\133jPw\238<\201\&1X\151F\133\248\217l",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\168\&1\255\241I\162\173v\254uZ*\140G",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\US=\184j\\AA\155\156@\178\229r'K0i\204\ESC\168Q'\196\226\234\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode83) {
  uint8_t pkt[] = {0x82, 0x57, 0x6a, 0x18, 0x0,  0x3,  0xa2, 0x44, 0x9f, 0x2,  0x0,  0x1e, 0xc3, 0x5f, 0x83,
                   0x0,  0x6f, 0x7c, 0x13, 0x99, 0xcc, 0x82, 0x5a, 0x81, 0x7,  0x94, 0x24, 0x85, 0x6a, 0x50,
                   0x77, 0xee, 0x3c, 0xc9, 0x31, 0x58, 0x97, 0x46, 0x85, 0xf8, 0xd9, 0x6c, 0x2,  0x0,  0xe,
                   0xa8, 0x31, 0xff, 0xf1, 0x49, 0xa2, 0xad, 0x76, 0xfe, 0x75, 0x5a, 0x2a, 0x8c, 0x47, 0x1,
                   0x0,  0x1a, 0x1f, 0x3d, 0xb8, 0x6a, 0x5c, 0x41, 0x41, 0x9b, 0x9c, 0x40, 0xb2, 0xe5, 0x72,
                   0x27, 0x4b, 0x30, 0x69, 0xcc, 0x1b, 0xa8, 0x51, 0x27, 0xc4, 0xe2, 0xea, 0xe9, 0x2};

  uint8_t buf[99] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xa2, 0x44, 0x9f};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc3, 0x5f, 0x83, 0x0,  0x6f, 0x7c, 0x13, 0x99, 0xcc, 0x82,
                                     0x5a, 0x81, 0x7,  0x94, 0x24, 0x85, 0x6a, 0x50, 0x77, 0xee,
                                     0x3c, 0xc9, 0x31, 0x58, 0x97, 0x46, 0x85, 0xf8, 0xd9, 0x6c};
  lwmqtt_string_t topic_filter_s1 = {30, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa8, 0x31, 0xff, 0xf1, 0x49, 0xa2, 0xad,
                                     0x76, 0xfe, 0x75, 0x5a, 0x2a, 0x8c, 0x47};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1f, 0x3d, 0xb8, 0x6a, 0x5c, 0x41, 0x41, 0x9b, 0x9c, 0x40, 0xb2, 0xe5, 0x72,
                                     0x27, 0x4b, 0x30, 0x69, 0xcc, 0x1b, 0xa8, 0x51, 0x27, 0xc4, 0xe2, 0xea, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {26, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 27160, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22660
// [("k\215\&6o4\168\148\NAKl|\DC2eLi\r\203\ETX\152\158\131\197\142\143\248\134l\CAN\243\SYN",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("!m\185",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("t\a\155\243\134r\ETB)\244Y:",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\144",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("Dy",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS0}),("\169p\197\187\137\SUBA\138\224\242\167\174\rh\b\143\210f\225\220\STX\200\t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\rw\214#2r\221~\249",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode84) {
  uint8_t pkt[] = {0x82, 0x65, 0x58, 0x84, 0x0,  0x1d, 0x6b, 0xd7, 0x36, 0x6f, 0x34, 0xa8, 0x94, 0x15, 0x6c,
                   0x7c, 0x12, 0x65, 0x4c, 0x69, 0xd,  0xcb, 0x3,  0x98, 0x9e, 0x83, 0xc5, 0x8e, 0x8f, 0xf8,
                   0x86, 0x6c, 0x18, 0xf3, 0x16, 0x0,  0x0,  0x3,  0x21, 0x6d, 0xb9, 0x1,  0x0,  0xb,  0x74,
                   0x7,  0x9b, 0xf3, 0x86, 0x72, 0x17, 0x29, 0xf4, 0x59, 0x3a, 0x2,  0x0,  0x1,  0x90, 0x1,
                   0x0,  0x2,  0x44, 0x79, 0x0,  0x0,  0x17, 0xa9, 0x70, 0xc5, 0xbb, 0x89, 0x1a, 0x41, 0x8a,
                   0xe0, 0xf2, 0xa7, 0xae, 0xd,  0x68, 0x8,  0x8f, 0xd2, 0x66, 0xe1, 0xdc, 0x2,  0xc8, 0x9,
                   0x1,  0x0,  0x9,  0xd,  0x77, 0xd6, 0x23, 0x32, 0x72, 0xdd, 0x7e, 0xf9, 0x2};

  uint8_t buf[113] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x6b, 0xd7, 0x36, 0x6f, 0x34, 0xa8, 0x94, 0x15, 0x6c, 0x7c,
                                     0x12, 0x65, 0x4c, 0x69, 0xd,  0xcb, 0x3,  0x98, 0x9e, 0x83,
                                     0xc5, 0x8e, 0x8f, 0xf8, 0x86, 0x6c, 0x18, 0xf3, 0x16};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x21, 0x6d, 0xb9};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x74, 0x7, 0x9b, 0xf3, 0x86, 0x72, 0x17, 0x29, 0xf4, 0x59, 0x3a};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x90};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x44, 0x79};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa9, 0x70, 0xc5, 0xbb, 0x89, 0x1a, 0x41, 0x8a, 0xe0, 0xf2, 0xa7, 0xae,
                                     0xd,  0x68, 0x8,  0x8f, 0xd2, 0x66, 0xe1, 0xdc, 0x2,  0xc8, 0x9};
  lwmqtt_string_t topic_filter_s5 = {23, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd, 0x77, 0xd6, 0x23, 0x32, 0x72, 0xdd, 0x7e, 0xf9};
  lwmqtt_string_t topic_filter_s6 = {9, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 22660, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13206 [("\134\245\ft\GS\160Zb\214\NAK\247^\170\162\CAN\201D\147\244$\SUB\DC2\130d\170",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\134",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\190\142\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2}),("9",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\NAKe\ETB\156>o\252\206\DC2F\DLE\224\224\183\231O\254`K\185\191\202",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\246\204EG\236x\DC3\172\243\168+\175\196v@#\DEL\188\&4\205M\226p1\165\174",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\ETX;\137\191}\SOdq\196\DC1\234\160\DEL1\173\155Rr8(\241S\132\173\129",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode85) {
  uint8_t pkt[] = {0x82, 0x7e, 0x33, 0x96, 0x0,  0x19, 0x86, 0xf5, 0xc,  0x74, 0x1d, 0xa0, 0x5a, 0x62, 0xd6, 0x15,
                   0xf7, 0x5e, 0xaa, 0xa2, 0x18, 0xc9, 0x44, 0x93, 0xf4, 0x24, 0x1a, 0x12, 0x82, 0x64, 0xaa, 0x1,
                   0x0,  0x1,  0x86, 0x1,  0x0,  0x3,  0xbe, 0x8e, 0xd2, 0x2,  0x0,  0x1,  0x39, 0x1,  0x0,  0x16,
                   0x15, 0x65, 0x17, 0x9c, 0x3e, 0x6f, 0xfc, 0xce, 0x12, 0x46, 0x10, 0xe0, 0xe0, 0xb7, 0xe7, 0x4f,
                   0xfe, 0x60, 0x4b, 0xb9, 0xbf, 0xca, 0x2,  0x0,  0x1a, 0xf6, 0xcc, 0x45, 0x47, 0xec, 0x78, 0x13,
                   0xac, 0xf3, 0xa8, 0x2b, 0xaf, 0xc4, 0x76, 0x40, 0x23, 0x7f, 0xbc, 0x34, 0xcd, 0x4d, 0xe2, 0x70,
                   0x31, 0xa5, 0xae, 0x0,  0x0,  0x19, 0x3,  0x3b, 0x89, 0xbf, 0x7d, 0xe,  0x64, 0x71, 0xc4, 0x11,
                   0xea, 0xa0, 0x7f, 0x31, 0xad, 0x9b, 0x52, 0x72, 0x38, 0x28, 0xf1, 0x53, 0x84, 0xad, 0x81, 0x1};

  uint8_t buf[138] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0xf5, 0xc,  0x74, 0x1d, 0xa0, 0x5a, 0x62, 0xd6, 0x15, 0xf7, 0x5e, 0xaa,
                                     0xa2, 0x18, 0xc9, 0x44, 0x93, 0xf4, 0x24, 0x1a, 0x12, 0x82, 0x64, 0xaa};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbe, 0x8e, 0xd2};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x39};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x15, 0x65, 0x17, 0x9c, 0x3e, 0x6f, 0xfc, 0xce, 0x12, 0x46, 0x10,
                                     0xe0, 0xe0, 0xb7, 0xe7, 0x4f, 0xfe, 0x60, 0x4b, 0xb9, 0xbf, 0xca};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf6, 0xcc, 0x45, 0x47, 0xec, 0x78, 0x13, 0xac, 0xf3, 0xa8, 0x2b, 0xaf, 0xc4,
                                     0x76, 0x40, 0x23, 0x7f, 0xbc, 0x34, 0xcd, 0x4d, 0xe2, 0x70, 0x31, 0xa5, 0xae};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3,  0x3b, 0x89, 0xbf, 0x7d, 0xe,  0x64, 0x71, 0xc4, 0x11, 0xea, 0xa0, 0x7f,
                                     0x31, 0xad, 0x9b, 0x52, 0x72, 0x38, 0x28, 0xf1, 0x53, 0x84, 0xad, 0x81};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 13206, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8501 [("\203p\176B\229Ul'\142n\159\GS\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode86) {
  uint8_t pkt[] = {0x82, 0x12, 0x21, 0x35, 0x0,  0xd,  0xcb, 0x70, 0xb0, 0x42,
                   0xe5, 0x55, 0x6c, 0x27, 0x8e, 0x6e, 0x9f, 0x1d, 0xdd, 0x2};

  uint8_t buf[30] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xcb, 0x70, 0xb0, 0x42, 0xe5, 0x55, 0x6c, 0x27, 0x8e, 0x6e, 0x9f, 0x1d, 0xdd};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 8501, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25153 [("\132f\153\132\244w'\154\220S",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\249\167\241%",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\142\244",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\151NI\219\241\129\216N\187\248`\189\"G}\165\133)7R\135\154\ETX~\175",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("/;\227\164B+\151W!\206\238\128\136\GS\vz\163\244:G\172V",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("5\145\185{#B\152\236",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("<\131\162\143,2\130\130\159\151\150\CAN2\223\208\ESC\181\218\201\149\&6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode87) {
  uint8_t pkt[] = {0x82, 0x76, 0x62, 0x41, 0x0,  0xa,  0x84, 0x66, 0x99, 0x84, 0xf4, 0x77, 0x27, 0x9a, 0xdc,
                   0x53, 0x0,  0x0,  0x0,  0x0,  0x0,  0x4,  0xf9, 0xa7, 0xf1, 0x25, 0x2,  0x0,  0x2,  0x8e,
                   0xf4, 0x1,  0x0,  0x19, 0x97, 0x4e, 0x49, 0xdb, 0xf1, 0x81, 0xd8, 0x4e, 0xbb, 0xf8, 0x60,
                   0xbd, 0x22, 0x47, 0x7d, 0xa5, 0x85, 0x29, 0x37, 0x52, 0x87, 0x9a, 0x3,  0x7e, 0xaf, 0x0,
                   0x0,  0x16, 0x2f, 0x3b, 0xe3, 0xa4, 0x42, 0x2b, 0x97, 0x57, 0x21, 0xce, 0xee, 0x80, 0x88,
                   0x1d, 0xb,  0x7a, 0xa3, 0xf4, 0x3a, 0x47, 0xac, 0x56, 0x0,  0x0,  0x8,  0x35, 0x91, 0xb9,
                   0x7b, 0x23, 0x42, 0x98, 0xec, 0x0,  0x0,  0x15, 0x3c, 0x83, 0xa2, 0x8f, 0x2c, 0x32, 0x82,
                   0x82, 0x9f, 0x97, 0x96, 0x18, 0x32, 0xdf, 0xd0, 0x1b, 0xb5, 0xda, 0xc9, 0x95, 0x36, 0x0};

  uint8_t buf[130] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x84, 0x66, 0x99, 0x84, 0xf4, 0x77, 0x27, 0x9a, 0xdc, 0x53};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf9, 0xa7, 0xf1, 0x25};
  lwmqtt_string_t topic_filter_s2 = {4, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8e, 0xf4};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x97, 0x4e, 0x49, 0xdb, 0xf1, 0x81, 0xd8, 0x4e, 0xbb, 0xf8, 0x60, 0xbd, 0x22,
                                     0x47, 0x7d, 0xa5, 0x85, 0x29, 0x37, 0x52, 0x87, 0x9a, 0x3,  0x7e, 0xaf};
  lwmqtt_string_t topic_filter_s4 = {25, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x2f, 0x3b, 0xe3, 0xa4, 0x42, 0x2b, 0x97, 0x57, 0x21, 0xce, 0xee,
                                     0x80, 0x88, 0x1d, 0xb,  0x7a, 0xa3, 0xf4, 0x3a, 0x47, 0xac, 0x56};
  lwmqtt_string_t topic_filter_s5 = {22, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x35, 0x91, 0xb9, 0x7b, 0x23, 0x42, 0x98, 0xec};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x3c, 0x83, 0xa2, 0x8f, 0x2c, 0x32, 0x82, 0x82, 0x9f, 0x97, 0x96,
                                     0x18, 0x32, 0xdf, 0xd0, 0x1b, 0xb5, 0xda, 0xc9, 0x95, 0x36};
  lwmqtt_string_t topic_filter_s7 = {21, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25153, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10517 [("\252",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode88) {
  uint8_t pkt[] = {0x82, 0x6, 0x29, 0x15, 0x0, 0x1, 0xfc, 0x1};

  uint8_t buf[18] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xfc};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 10517, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 24618 [("\162\&7a\196\249\&0\135*\143\198O\209\148nI",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode89) {
  uint8_t pkt[] = {0x82, 0x14, 0x60, 0x2a, 0x0,  0xf,  0xa2, 0x37, 0x61, 0xc4, 0xf9,
                   0x30, 0x87, 0x2a, 0x8f, 0xc6, 0x4f, 0xd1, 0x94, 0x6e, 0x49, 0x0};

  uint8_t buf[32] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xa2, 0x37, 0x61, 0xc4, 0xf9, 0x30, 0x87, 0x2a,
                                     0x8f, 0xc6, 0x4f, 0xd1, 0x94, 0x6e, 0x49};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 24618, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 32265 [("\188Z\ESCD\172\&2\GSO\235_\175N*$\243\136\224 =\137\169\155\DEL\227\&1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\203\232q4\EM\v\220\158X\173l\SUB\174",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode90) {
  uint8_t pkt[] = {0x82, 0x2e, 0x7e, 0x9,  0x0,  0x19, 0xbc, 0x5a, 0x1b, 0x44, 0xac, 0x32, 0x1d, 0x4f, 0xeb, 0x5f,
                   0xaf, 0x4e, 0x2a, 0x24, 0xf3, 0x88, 0xe0, 0x20, 0x3d, 0x89, 0xa9, 0x9b, 0x7f, 0xe3, 0x31, 0x0,
                   0x0,  0xd,  0xcb, 0xe8, 0x71, 0x34, 0x19, 0xb,  0xdc, 0x9e, 0x58, 0xad, 0x6c, 0x1a, 0xae, 0x2};

  uint8_t buf[58] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xbc, 0x5a, 0x1b, 0x44, 0xac, 0x32, 0x1d, 0x4f, 0xeb, 0x5f, 0xaf, 0x4e, 0x2a,
                                     0x24, 0xf3, 0x88, 0xe0, 0x20, 0x3d, 0x89, 0xa9, 0x9b, 0x7f, 0xe3, 0x31};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcb, 0xe8, 0x71, 0x34, 0x19, 0xb, 0xdc, 0x9e, 0x58, 0xad, 0x6c, 0x1a, 0xae};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 32265, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 7342 [("\RS8\172\211YnUe\216\&6",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("~\\\198\&7Ty\GS\206{}\244\164c@{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("j\227\vg\167<\\S\255\151",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("$S\172",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\174\RS\128=\161\254b\152\&4 \209\226m\237`\SOHcY\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\210\179\&8\244\FS\DC2\219W\171\&8!\186",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("Z\202\&4E\179\143\226E\151\146!\135\216",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\150\&5\226T\150\145THQ\tM\156\165\146Y\245\"\ESC\152YF\252\180\142\222\181\171\175D",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\220\144\&8\247r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("G=\164\r\202\193\181\145:\160V\n7F/\251\199)\224\DLE\197\239\r",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode91) {
  uint8_t pkt[] = {0x82, 0xab, 0x1,  0x1c, 0xae, 0x0,  0xa,  0x1e, 0x38, 0xac, 0xd3, 0x59, 0x6e, 0x55, 0x65, 0xd8,
                   0x36, 0x2,  0x0,  0xf,  0x7e, 0x5c, 0xc6, 0x37, 0x54, 0x79, 0x1d, 0xce, 0x7b, 0x7d, 0xf4, 0xa4,
                   0x63, 0x40, 0x7b, 0x2,  0x0,  0xa,  0x6a, 0xe3, 0xb,  0x67, 0xa7, 0x3c, 0x5c, 0x53, 0xff, 0x97,
                   0x0,  0x0,  0x3,  0x24, 0x53, 0xac, 0x0,  0x0,  0x13, 0xae, 0x1e, 0x80, 0x3d, 0xa1, 0xfe, 0x62,
                   0x98, 0x34, 0x20, 0xd1, 0xe2, 0x6d, 0xed, 0x60, 0x1,  0x63, 0x59, 0xa2, 0x1,  0x0,  0xc,  0xd2,
                   0xb3, 0x38, 0xf4, 0x1c, 0x12, 0xdb, 0x57, 0xab, 0x38, 0x21, 0xba, 0x1,  0x0,  0xd,  0x5a, 0xca,
                   0x34, 0x45, 0xb3, 0x8f, 0xe2, 0x45, 0x97, 0x92, 0x21, 0x87, 0xd8, 0x1,  0x0,  0x1d, 0x96, 0x35,
                   0xe2, 0x54, 0x96, 0x91, 0x54, 0x48, 0x51, 0x9,  0x4d, 0x9c, 0xa5, 0x92, 0x59, 0xf5, 0x22, 0x1b,
                   0x98, 0x59, 0x46, 0xfc, 0xb4, 0x8e, 0xde, 0xb5, 0xab, 0xaf, 0x44, 0x1,  0x0,  0x5,  0xdc, 0x90,
                   0x38, 0xf7, 0x72, 0x1,  0x0,  0x17, 0x47, 0x3d, 0xa4, 0xd,  0xca, 0xc1, 0xb5, 0x91, 0x3a, 0xa0,
                   0x56, 0xa,  0x37, 0x46, 0x2f, 0xfb, 0xc7, 0x29, 0xe0, 0x10, 0xc5, 0xef, 0xd,  0x2};

  uint8_t buf[184] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x1e, 0x38, 0xac, 0xd3, 0x59, 0x6e, 0x55, 0x65, 0xd8, 0x36};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7e, 0x5c, 0xc6, 0x37, 0x54, 0x79, 0x1d, 0xce,
                                     0x7b, 0x7d, 0xf4, 0xa4, 0x63, 0x40, 0x7b};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x6a, 0xe3, 0xb, 0x67, 0xa7, 0x3c, 0x5c, 0x53, 0xff, 0x97};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x24, 0x53, 0xac};
  lwmqtt_string_t topic_filter_s3 = {3, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xae, 0x1e, 0x80, 0x3d, 0xa1, 0xfe, 0x62, 0x98, 0x34, 0x20,
                                     0xd1, 0xe2, 0x6d, 0xed, 0x60, 0x1,  0x63, 0x59, 0xa2};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xd2, 0xb3, 0x38, 0xf4, 0x1c, 0x12, 0xdb, 0x57, 0xab, 0x38, 0x21, 0xba};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x5a, 0xca, 0x34, 0x45, 0xb3, 0x8f, 0xe2, 0x45, 0x97, 0x92, 0x21, 0x87, 0xd8};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x96, 0x35, 0xe2, 0x54, 0x96, 0x91, 0x54, 0x48, 0x51, 0x9,
                                     0x4d, 0x9c, 0xa5, 0x92, 0x59, 0xf5, 0x22, 0x1b, 0x98, 0x59,
                                     0x46, 0xfc, 0xb4, 0x8e, 0xde, 0xb5, 0xab, 0xaf, 0x44};
  lwmqtt_string_t topic_filter_s7 = {29, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdc, 0x90, 0x38, 0xf7, 0x72};
  lwmqtt_string_t topic_filter_s8 = {5, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x47, 0x3d, 0xa4, 0xd,  0xca, 0xc1, 0xb5, 0x91, 0x3a, 0xa0, 0x56, 0xa,
                                     0x37, 0x46, 0x2f, 0xfb, 0xc7, 0x29, 0xe0, 0x10, 0xc5, 0xef, 0xd};
  lwmqtt_string_t topic_filter_s9 = {23, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 7342, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25785 [("4\DC1\131\219{\253\160\n\151f\226{\218\179",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("F\173\174\178\252\144\161\193\&0H\130c\170,\160\167-)\162",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\230\216\219R\ACK\203\\\EM\206|\151\250\&7",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("7!\245\132~\DC2(\164\v\167p\249O]\EOTx*&\173pP\249\209",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\213\FS\146i\223\DC4\233\DC1\SI\208*_B\198EP\ACK[\226\182)\255",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\247P\157\US\255e\250\180",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe311QCTest, Encode92) {
  uint8_t pkt[] = {0x82, 0x77, 0x64, 0xb9, 0x0,  0xe,  0x34, 0x11, 0x83, 0xdb, 0x7b, 0xfd, 0xa0, 0xa,  0x97, 0x66,
                   0xe2, 0x7b, 0xda, 0xb3, 0x0,  0x0,  0x13, 0x46, 0xad, 0xae, 0xb2, 0xfc, 0x90, 0xa1, 0xc1, 0x30,
                   0x48, 0x82, 0x63, 0xaa, 0x2c, 0xa0, 0xa7, 0x2d, 0x29, 0xa2, 0x0,  0x0,  0xd,  0xe6, 0xd8, 0xdb,
                   0x52, 0x6,  0xcb, 0x5c, 0x19, 0xce, 0x7c, 0x97, 0xfa, 0x37, 0x1,  0x0,  0x17, 0x37, 0x21, 0xf5,
                   0x84, 0x7e, 0x12, 0x28, 0xa4, 0xb,  0xa7, 0x70, 0xf9, 0x4f, 0x5d, 0x4,  0x78, 0x2a, 0x26, 0xad,
                   0x70, 0x50, 0xf9, 0xd1, 0x1,  0x0,  0x16, 0xd5, 0x1c, 0x92, 0x69, 0xdf, 0x14, 0xe9, 0x11, 0xf,
                   0xd0, 0x2a, 0x5f, 0x42, 0xc6, 0x45, 0x50, 0x6,  0x5b, 0xe2, 0xb6, 0x29, 0xff, 0x2,  0x0,  0x8,
                   0xf7, 0x50, 0x9d, 0x1f, 0xff, 0x65, 0xfa, 0xb4, 0x0};

  uint8_t buf[131] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x34, 0x11, 0x83, 0xdb, 0x7b, 0xfd, 0xa0, 0xa, 0x97, 0x66, 0xe2, 0x7b, 0xda, 0xb3};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x46, 0xad, 0xae, 0xb2, 0xfc, 0x90, 0xa1, 0xc1, 0x30, 0x48,
                                     0x82, 0x63, 0xaa, 0x2c, 0xa0, 0xa7, 0x2d, 0x29, 0xa2};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe6, 0xd8, 0xdb, 0x52, 0x6, 0xcb, 0x5c, 0x19, 0xce, 0x7c, 0x97, 0xfa, 0x37};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x37, 0x21, 0xf5, 0x84, 0x7e, 0x12, 0x28, 0xa4, 0xb,  0xa7, 0x70, 0xf9,
                                     0x4f, 0x5d, 0x4,  0x78, 0x2a, 0x26, 0xad, 0x70, 0x50, 0xf9, 0xd1};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd5, 0x1c, 0x92, 0x69, 0xdf, 0x14, 0xe9, 0x11, 0xf,  0xd0, 0x2a,
                                     0x5f, 0x42, 0xc6, 0x45, 0x50, 0x6,  0x5b, 0xe2, 0xb6, 0x29, 0xff};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf7, 0x50, 0x9d, 0x1f, 0xff, 0x65, 0xfa, 0xb4};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25785, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8081 [("\247\197\143\CANr(\SO\230",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("\183\151u\251Or\149\230`\218\133\NUL\ETX\f",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("%\232\ACKq\200;\197\192\155\162\245|\t(\206\172\a\DELe\148\253\227\200\253\187s\219\179y",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("rp\156\133\138@\184",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\STX\f\202\217I\195/\218#\168^<V3\251\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("V\188\NUL\151S\EM\251&\RS$\199\150\141\198\241)\ENQ;\153\145\189\184\ESC\166\190\t",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode93) {
  uint8_t pkt[] = {0x82, 0x7b, 0x1f, 0x91, 0x0,  0x8,  0xf7, 0xc5, 0x8f, 0x18, 0x72, 0x28, 0xe,  0xe6, 0x0,  0x0,
                   0xe,  0xb7, 0x97, 0x75, 0xfb, 0x4f, 0x72, 0x95, 0xe6, 0x60, 0xda, 0x85, 0x0,  0x3,  0xc,  0x0,
                   0x0,  0x1d, 0x25, 0xe8, 0x6,  0x71, 0xc8, 0x3b, 0xc5, 0xc0, 0x9b, 0xa2, 0xf5, 0x7c, 0x9,  0x28,
                   0xce, 0xac, 0x7,  0x7f, 0x65, 0x94, 0xfd, 0xe3, 0xc8, 0xfd, 0xbb, 0x73, 0xdb, 0xb3, 0x79, 0x0,
                   0x0,  0x7,  0x72, 0x70, 0x9c, 0x85, 0x8a, 0x40, 0xb8, 0x0,  0x0,  0x0,  0x0,  0x0,  0x10, 0x2,
                   0xc,  0xca, 0xd9, 0x49, 0xc3, 0x2f, 0xda, 0x23, 0xa8, 0x5e, 0x3c, 0x56, 0x33, 0xfb, 0xdd, 0x0,
                   0x0,  0x1a, 0x56, 0xbc, 0x0,  0x97, 0x53, 0x19, 0xfb, 0x26, 0x1e, 0x24, 0xc7, 0x96, 0x8d, 0xc6,
                   0xf1, 0x29, 0x5,  0x3b, 0x99, 0x91, 0xbd, 0xb8, 0x1b, 0xa6, 0xbe, 0x9,  0x2};

  uint8_t buf[135] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xf7, 0xc5, 0x8f, 0x18, 0x72, 0x28, 0xe, 0xe6};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb7, 0x97, 0x75, 0xfb, 0x4f, 0x72, 0x95, 0xe6, 0x60, 0xda, 0x85, 0x0, 0x3, 0xc};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x25, 0xe8, 0x6,  0x71, 0xc8, 0x3b, 0xc5, 0xc0, 0x9b, 0xa2,
                                     0xf5, 0x7c, 0x9,  0x28, 0xce, 0xac, 0x7,  0x7f, 0x65, 0x94,
                                     0xfd, 0xe3, 0xc8, 0xfd, 0xbb, 0x73, 0xdb, 0xb3, 0x79};
  lwmqtt_string_t topic_filter_s2 = {29, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x72, 0x70, 0x9c, 0x85, 0x8a, 0x40, 0xb8};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0};
  lwmqtt_string_t topic_filter_s4 = {0, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x2,  0xc,  0xca, 0xd9, 0x49, 0xc3, 0x2f, 0xda,
                                     0x23, 0xa8, 0x5e, 0x3c, 0x56, 0x33, 0xfb, 0xdd};
  lwmqtt_string_t topic_filter_s5 = {16, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x56, 0xbc, 0x0,  0x97, 0x53, 0x19, 0xfb, 0x26, 0x1e, 0x24, 0xc7, 0x96, 0x8d,
                                     0xc6, 0xf1, 0x29, 0x5,  0x3b, 0x99, 0x91, 0xbd, 0xb8, 0x1b, 0xa6, 0xbe, 0x9};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 8081, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4638
// [("S\220\&2\154\206\\\254\EOT\\\212\FS\\\244\DC4\217?\144\230\200\137\252o\185\FS\US\148G\SOH",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("c\161\fG\150\206T\187E\170o\CAN\STX\168\172\238\249\210\154\215\144\238r\170-\175'h",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("tNSrg",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS2}),("\DC1y\160B\243\US\SI\228H\218\128\158\210[\140\147\f3\177\EOT\151\148\&2'",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\226\197\190\a)\156\155\246\157|\243\181[T\199p",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\\\248H\138\STX",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode94) {
  uint8_t pkt[] = {0x82, 0x7e, 0x12, 0x1e, 0x0,  0x1c, 0x53, 0xdc, 0x32, 0x9a, 0xce, 0x5c, 0xfe, 0x4,  0x5c, 0xd4,
                   0x1c, 0x5c, 0xf4, 0x14, 0xd9, 0x3f, 0x90, 0xe6, 0xc8, 0x89, 0xfc, 0x6f, 0xb9, 0x1c, 0x1f, 0x94,
                   0x47, 0x1,  0x1,  0x0,  0x1c, 0x63, 0xa1, 0xc,  0x47, 0x96, 0xce, 0x54, 0xbb, 0x45, 0xaa, 0x6f,
                   0x18, 0x2,  0xa8, 0xac, 0xee, 0xf9, 0xd2, 0x9a, 0xd7, 0x90, 0xee, 0x72, 0xaa, 0x2d, 0xaf, 0x27,
                   0x68, 0x0,  0x0,  0x5,  0x74, 0x4e, 0x53, 0x72, 0x67, 0x2,  0x0,  0x18, 0x11, 0x79, 0xa0, 0x42,
                   0xf3, 0x1f, 0xf,  0xe4, 0x48, 0xda, 0x80, 0x9e, 0xd2, 0x5b, 0x8c, 0x93, 0xc,  0x33, 0xb1, 0x4,
                   0x97, 0x94, 0x32, 0x27, 0x2,  0x0,  0x10, 0xe2, 0xc5, 0xbe, 0x7,  0x29, 0x9c, 0x9b, 0xf6, 0x9d,
                   0x7c, 0xf3, 0xb5, 0x5b, 0x54, 0xc7, 0x70, 0x2,  0x0,  0x5,  0x5c, 0xf8, 0x48, 0x8a, 0x2,  0x2};

  uint8_t buf[138] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x53, 0xdc, 0x32, 0x9a, 0xce, 0x5c, 0xfe, 0x4,  0x5c, 0xd4, 0x1c, 0x5c, 0xf4, 0x14,
                                     0xd9, 0x3f, 0x90, 0xe6, 0xc8, 0x89, 0xfc, 0x6f, 0xb9, 0x1c, 0x1f, 0x94, 0x47, 0x1};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x63, 0xa1, 0xc,  0x47, 0x96, 0xce, 0x54, 0xbb, 0x45, 0xaa,
                                     0x6f, 0x18, 0x2,  0xa8, 0xac, 0xee, 0xf9, 0xd2, 0x9a, 0xd7,
                                     0x90, 0xee, 0x72, 0xaa, 0x2d, 0xaf, 0x27, 0x68};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x74, 0x4e, 0x53, 0x72, 0x67};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x11, 0x79, 0xa0, 0x42, 0xf3, 0x1f, 0xf,  0xe4, 0x48, 0xda, 0x80, 0x9e,
                                     0xd2, 0x5b, 0x8c, 0x93, 0xc,  0x33, 0xb1, 0x4,  0x97, 0x94, 0x32, 0x27};
  lwmqtt_string_t topic_filter_s3 = {24, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe2, 0xc5, 0xbe, 0x7,  0x29, 0x9c, 0x9b, 0xf6,
                                     0x9d, 0x7c, 0xf3, 0xb5, 0x5b, 0x54, 0xc7, 0x70};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x5c, 0xf8, 0x48, 0x8a, 0x2};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 4638, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30339 [("\179u\189\US\149]BIh\141\231\&6-\r\DC1Zc\223\\\DC3\163",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\RS\239\NAK.\t\226\168BS\142\163\209\211\134\\Uz\EOTV\129\STX.\ENQ\RS\ETB",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("r\146\230\ESC\129\250\136&\248\195p\140J(\DC2|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\251\175\166\&3\137\173N\196\187T~\DEL\158\245\238\247B\151\139\r\142=\247\EOT/\171E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\204\171\242\244a7\178\140\138\149\174\201",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\131\241\222xlu'9!6\242\213K\227\&0\234\199\150+d\"\DC2/\145\149i;EV",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\SYNr\167\NUL\254\180",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193\211\192\222m\154\164",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode95) {
  uint8_t pkt[] = {0x82, 0xa9, 0x1,  0x76, 0x83, 0x0,  0x15, 0xb3, 0x75, 0xbd, 0x1f, 0x95, 0x5d, 0x42, 0x49, 0x68,
                   0x8d, 0xe7, 0x36, 0x2d, 0xd,  0x11, 0x5a, 0x63, 0xdf, 0x5c, 0x13, 0xa3, 0x0,  0x0,  0x19, 0x1e,
                   0xef, 0x15, 0x2e, 0x9,  0xe2, 0xa8, 0x42, 0x53, 0x8e, 0xa3, 0xd1, 0xd3, 0x86, 0x5c, 0x55, 0x7a,
                   0x4,  0x56, 0x81, 0x2,  0x2e, 0x5,  0x1e, 0x17, 0x2,  0x0,  0x10, 0x72, 0x92, 0xe6, 0x1b, 0x81,
                   0xfa, 0x88, 0x26, 0xf8, 0xc3, 0x70, 0x8c, 0x4a, 0x28, 0x12, 0x7c, 0x1,  0x0,  0x1b, 0xfb, 0xaf,
                   0xa6, 0x33, 0x89, 0xad, 0x4e, 0xc4, 0xbb, 0x54, 0x7e, 0x7f, 0x9e, 0xf5, 0xee, 0xf7, 0x42, 0x97,
                   0x8b, 0xd,  0x8e, 0x3d, 0xf7, 0x4,  0x2f, 0xab, 0x45, 0x0,  0x0,  0xc,  0xcc, 0xab, 0xf2, 0xf4,
                   0x61, 0x37, 0xb2, 0x8c, 0x8a, 0x95, 0xae, 0xc9, 0x2,  0x0,  0x1d, 0x83, 0xf1, 0xde, 0x78, 0x6c,
                   0x75, 0x27, 0x39, 0x21, 0x36, 0xf2, 0xd5, 0x4b, 0xe3, 0x30, 0xea, 0xc7, 0x96, 0x2b, 0x64, 0x22,
                   0x12, 0x2f, 0x91, 0x95, 0x69, 0x3b, 0x45, 0x56, 0x1,  0x0,  0x6,  0x16, 0x72, 0xa7, 0x0,  0xfe,
                   0xb4, 0x2,  0x0,  0x7,  0xc1, 0xd3, 0xc0, 0xde, 0x6d, 0x9a, 0xa4, 0x2};

  uint8_t buf[182] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xb3, 0x75, 0xbd, 0x1f, 0x95, 0x5d, 0x42, 0x49, 0x68, 0x8d, 0xe7,
                                     0x36, 0x2d, 0xd,  0x11, 0x5a, 0x63, 0xdf, 0x5c, 0x13, 0xa3};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1e, 0xef, 0x15, 0x2e, 0x9, 0xe2, 0xa8, 0x42, 0x53, 0x8e, 0xa3, 0xd1, 0xd3,
                                     0x86, 0x5c, 0x55, 0x7a, 0x4, 0x56, 0x81, 0x2,  0x2e, 0x5,  0x1e, 0x17};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x72, 0x92, 0xe6, 0x1b, 0x81, 0xfa, 0x88, 0x26,
                                     0xf8, 0xc3, 0x70, 0x8c, 0x4a, 0x28, 0x12, 0x7c};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfb, 0xaf, 0xa6, 0x33, 0x89, 0xad, 0x4e, 0xc4, 0xbb, 0x54, 0x7e, 0x7f, 0x9e, 0xf5,
                                     0xee, 0xf7, 0x42, 0x97, 0x8b, 0xd,  0x8e, 0x3d, 0xf7, 0x4,  0x2f, 0xab, 0x45};
  lwmqtt_string_t topic_filter_s3 = {27, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xcc, 0xab, 0xf2, 0xf4, 0x61, 0x37, 0xb2, 0x8c, 0x8a, 0x95, 0xae, 0xc9};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x83, 0xf1, 0xde, 0x78, 0x6c, 0x75, 0x27, 0x39, 0x21, 0x36,
                                     0xf2, 0xd5, 0x4b, 0xe3, 0x30, 0xea, 0xc7, 0x96, 0x2b, 0x64,
                                     0x22, 0x12, 0x2f, 0x91, 0x95, 0x69, 0x3b, 0x45, 0x56};
  lwmqtt_string_t topic_filter_s5 = {29, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x16, 0x72, 0xa7, 0x0, 0xfe, 0xb4};
  lwmqtt_string_t topic_filter_s6 = {6, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xc1, 0xd3, 0xc0, 0xde, 0x6d, 0x9a, 0xa4};
  lwmqtt_string_t topic_filter_s7 = {7, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 30339, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25983 [("\NULh]\172\248\158\GS:.\SOH<\\0\204q",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\CAN?\208\234\166~,\246\198\198\RS\128\a\167#\ESC\USb\161\FS",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\160\US\153\210\&2\243#\154\167",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\129\CAN\203\191Y5\132\246\162\129\192XU\"\172S",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode96) {
  uint8_t pkt[] = {0x82, 0x4a, 0x65, 0x7f, 0x0,  0xf,  0x0,  0x68, 0x5d, 0xac, 0xf8, 0x9e, 0x1d, 0x3a, 0x2e, 0x1,
                   0x3c, 0x5c, 0x30, 0xcc, 0x71, 0x2,  0x0,  0x14, 0x18, 0x3f, 0xd0, 0xea, 0xa6, 0x7e, 0x2c, 0xf6,
                   0xc6, 0xc6, 0x1e, 0x80, 0x7,  0xa7, 0x23, 0x1b, 0x1f, 0x62, 0xa1, 0x1c, 0x1,  0x0,  0x9,  0xa0,
                   0x1f, 0x99, 0xd2, 0x32, 0xf3, 0x23, 0x9a, 0xa7, 0x0,  0x0,  0x10, 0x81, 0x18, 0xcb, 0xbf, 0x59,
                   0x35, 0x84, 0xf6, 0xa2, 0x81, 0xc0, 0x58, 0x55, 0x22, 0xac, 0x53, 0x1};

  uint8_t buf[86] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x0,  0x68, 0x5d, 0xac, 0xf8, 0x9e, 0x1d, 0x3a,
                                     0x2e, 0x1,  0x3c, 0x5c, 0x30, 0xcc, 0x71};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x18, 0x3f, 0xd0, 0xea, 0xa6, 0x7e, 0x2c, 0xf6, 0xc6, 0xc6,
                                     0x1e, 0x80, 0x7,  0xa7, 0x23, 0x1b, 0x1f, 0x62, 0xa1, 0x1c};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa0, 0x1f, 0x99, 0xd2, 0x32, 0xf3, 0x23, 0x9a, 0xa7};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x81, 0x18, 0xcb, 0xbf, 0x59, 0x35, 0x84, 0xf6,
                                     0xa2, 0x81, 0xc0, 0x58, 0x55, 0x22, 0xac, 0x53};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 25983, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14533 [("\207u\229\191Dm6]U\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\159\195\128\SOHK\243\248gf\DEL",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("[{\199\214\EMb\b\140H/\140\146\DC3\SYN\141\SOh\251\148\a\145\SOH*\160\190\145\130D\SO/",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\v6\STX\"\b%
// \211\241\184\238\234b\247\174\178w",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\158\143\t\131\211\229\129,\234\193GG\206r\191\150\176\DC2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("6\195\241\184/\168\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal
// = False, _subQoS = QoS0}),("\140\DC3M\195\237\DLEO\231",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode97) {
  uint8_t pkt[] = {0x82, 0x7b, 0x38, 0xc5, 0x0,  0xa,  0xcf, 0x75, 0xe5, 0xbf, 0x44, 0x6d, 0x36, 0x5d, 0x55, 0x98,
                   0x2,  0x0,  0xa,  0x9f, 0xc3, 0x80, 0x1,  0x4b, 0xf3, 0xf8, 0x67, 0x66, 0x7f, 0x0,  0x0,  0x1e,
                   0x5b, 0x7b, 0xc7, 0xd6, 0x19, 0x62, 0x8,  0x8c, 0x48, 0x2f, 0x8c, 0x92, 0x13, 0x16, 0x8d, 0xe,
                   0x68, 0xfb, 0x94, 0x7,  0x91, 0x1,  0x2a, 0xa0, 0xbe, 0x91, 0x82, 0x44, 0xe,  0x2f, 0x2,  0x0,
                   0x11, 0xb,  0x36, 0x2,  0x22, 0x8,  0x25, 0x20, 0xd3, 0xf1, 0xb8, 0xee, 0xea, 0x62, 0xf7, 0xae,
                   0xb2, 0x77, 0x2,  0x0,  0x12, 0x9e, 0x8f, 0x9,  0x83, 0xd3, 0xe5, 0x81, 0x2c, 0xea, 0xc1, 0x47,
                   0x47, 0xce, 0x72, 0xbf, 0x96, 0xb0, 0x12, 0x0,  0x0,  0x7,  0x36, 0xc3, 0xf1, 0xb8, 0x2f, 0xa8,
                   0xce, 0x0,  0x0,  0x8,  0x8c, 0x13, 0x4d, 0xc3, 0xed, 0x10, 0x4f, 0xe7, 0x1};

  uint8_t buf[135] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xcf, 0x75, 0xe5, 0xbf, 0x44, 0x6d, 0x36, 0x5d, 0x55, 0x98};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x9f, 0xc3, 0x80, 0x1, 0x4b, 0xf3, 0xf8, 0x67, 0x66, 0x7f};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5b, 0x7b, 0xc7, 0xd6, 0x19, 0x62, 0x8,  0x8c, 0x48, 0x2f,
                                     0x8c, 0x92, 0x13, 0x16, 0x8d, 0xe,  0x68, 0xfb, 0x94, 0x7,
                                     0x91, 0x1,  0x2a, 0xa0, 0xbe, 0x91, 0x82, 0x44, 0xe,  0x2f};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb,  0x36, 0x2,  0x22, 0x8,  0x25, 0x20, 0xd3, 0xf1,
                                     0xb8, 0xee, 0xea, 0x62, 0xf7, 0xae, 0xb2, 0x77};
  lwmqtt_string_t topic_filter_s3 = {17, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9e, 0x8f, 0x9,  0x83, 0xd3, 0xe5, 0x81, 0x2c, 0xea,
                                     0xc1, 0x47, 0x47, 0xce, 0x72, 0xbf, 0x96, 0xb0, 0x12};
  lwmqtt_string_t topic_filter_s4 = {18, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x36, 0xc3, 0xf1, 0xb8, 0x2f, 0xa8, 0xce};
  lwmqtt_string_t topic_filter_s5 = {7, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8c, 0x13, 0x4d, 0xc3, 0xed, 0x10, 0x4f, 0xe7};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 14533, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1538
// [("\136v9\252\152\153\179\197P\132F\ETX\176\STX\166RR\222\t\216\163\143\252n\ETB\212",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode98) {
  uint8_t pkt[] = {0x82, 0x1f, 0x6, 0x2,  0x0,  0x1a, 0x88, 0x76, 0x39, 0xfc, 0x98, 0x99, 0xb3, 0xc5, 0x50, 0x84, 0x46,
                   0x3,  0xb0, 0x2, 0xa6, 0x52, 0x52, 0xde, 0x9,  0xd8, 0xa3, 0x8f, 0xfc, 0x6e, 0x17, 0xd4, 0x1};

  uint8_t buf[43] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x88, 0x76, 0x39, 0xfc, 0x98, 0x99, 0xb3, 0xc5, 0x50, 0x84, 0x46, 0x3,  0xb0,
                                     0x2,  0xa6, 0x52, 0x52, 0xde, 0x9,  0xd8, 0xa3, 0x8f, 0xfc, 0x6e, 0x17, 0xd4};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 1538, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22336 [("\239\178\194.\198\235(\167c\190\ETX\155\184\185\245\170}\US\231$\149\255\212",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("3\STXm\179%\DLE\247O\NULI\CAN\t\180\147\136\133\176\195[r\158\131\b\SOE\SYN\139\163\154",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\225\235\137<S\DEL4\245\221aD\167e\n\v\219\156\"\SYNIKN\161\162\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\192\248Z\217\171\ETX\220u\NAKu\b7\STX(\129\DC3\FS\223h\195\194\136\a@\SUB9lo\251",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\252\147\191\160\176p\tq\131\159\156X\152<\168\141\140\229*\196[",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe311QCTest, Encode99) {
  uint8_t pkt[] = {0x82, 0x90, 0x1,  0x57, 0x40, 0x0,  0x17, 0xef, 0xb2, 0xc2, 0x2e, 0xc6, 0xeb, 0x28, 0xa7, 0x63, 0xbe,
                   0x3,  0x9b, 0xb8, 0xb9, 0xf5, 0xaa, 0x7d, 0x1f, 0xe7, 0x24, 0x95, 0xff, 0xd4, 0x1,  0x0,  0x1d, 0x33,
                   0x2,  0x6d, 0xb3, 0x25, 0x10, 0xf7, 0x4f, 0x0,  0x49, 0x18, 0x9,  0xb4, 0x93, 0x88, 0x85, 0xb0, 0xc3,
                   0x5b, 0x72, 0x9e, 0x83, 0x8,  0xe,  0x45, 0x16, 0x8b, 0xa3, 0x9a, 0x1,  0x0,  0x19, 0xe1, 0xeb, 0x89,
                   0x3c, 0x53, 0x7f, 0x34, 0xf5, 0xdd, 0x61, 0x44, 0xa7, 0x65, 0xa,  0xb,  0xdb, 0x9c, 0x22, 0x16, 0x49,
                   0x4b, 0x4e, 0xa1, 0xa2, 0xd9, 0x1,  0x0,  0x1d, 0xc0, 0xf8, 0x5a, 0xd9, 0xab, 0x3,  0xdc, 0x75, 0x15,
                   0x75, 0x8,  0x37, 0x2,  0x28, 0x81, 0x13, 0x1c, 0xdf, 0x68, 0xc3, 0xc2, 0x88, 0x7,  0x40, 0x1a, 0x39,
                   0x6c, 0x6f, 0xfb, 0x0,  0x0,  0x15, 0xfc, 0x93, 0xbf, 0xa0, 0xb0, 0x70, 0x9,  0x71, 0x83, 0x9f, 0x9c,
                   0x58, 0x98, 0x3c, 0xa8, 0x8d, 0x8c, 0xe5, 0x2a, 0xc4, 0x5b, 0x2};

  uint8_t buf[157] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xef, 0xb2, 0xc2, 0x2e, 0xc6, 0xeb, 0x28, 0xa7, 0x63, 0xbe, 0x3, 0x9b,
                                     0xb8, 0xb9, 0xf5, 0xaa, 0x7d, 0x1f, 0xe7, 0x24, 0x95, 0xff, 0xd4};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x33, 0x2,  0x6d, 0xb3, 0x25, 0x10, 0xf7, 0x4f, 0x0,  0x49,
                                     0x18, 0x9,  0xb4, 0x93, 0x88, 0x85, 0xb0, 0xc3, 0x5b, 0x72,
                                     0x9e, 0x83, 0x8,  0xe,  0x45, 0x16, 0x8b, 0xa3, 0x9a};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe1, 0xeb, 0x89, 0x3c, 0x53, 0x7f, 0x34, 0xf5, 0xdd, 0x61, 0x44, 0xa7, 0x65,
                                     0xa,  0xb,  0xdb, 0x9c, 0x22, 0x16, 0x49, 0x4b, 0x4e, 0xa1, 0xa2, 0xd9};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc0, 0xf8, 0x5a, 0xd9, 0xab, 0x3,  0xdc, 0x75, 0x15, 0x75,
                                     0x8,  0x37, 0x2,  0x28, 0x81, 0x13, 0x1c, 0xdf, 0x68, 0xc3,
                                     0xc2, 0x88, 0x7,  0x40, 0x1a, 0x39, 0x6c, 0x6f, 0xfb};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xfc, 0x93, 0xbf, 0xa0, 0xb0, 0x70, 0x9,  0x71, 0x83, 0x9f, 0x9c,
                                     0x58, 0x98, 0x3c, 0xa8, 0x8d, 0x8c, 0xe5, 0x2a, 0xc4, 0x5b};
  lwmqtt_string_t topic_filter_s4 = {21, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 22336, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13807 [("wL\191\189\221|G\238\226$\136\tIp\SO\n\STX\165, \246K\185U\237\\",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("T\FS\235=\v;\128q\152\153}\"U[\178",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\184\150",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\190\236)\ENQ@h\184\224\&0",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("j\178B\166\172b\202\203P\STX,'\174\145\243o>\197\223\157\229|5\SOH\220\&94\241",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("BR\DLEz\176\178\218\206\141\160\252]Y\170\218\142\167\ETX\204\229=\r\255UWG",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\144\229\227)\143\168?\194\171\204\212\138\180\ETX\176\GS+\SO\254C>bp\150\184\247\144\231 ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\222CJ\178\&0\215~\186\&5\STX/\241\178\136H\207\"",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe311QCTest, Encode100) {
  uint8_t pkt[] = {0x82, 0xb2, 0x1,  0x35, 0xef, 0x0,  0x1a, 0x77, 0x4c, 0xbf, 0xbd, 0xdd, 0x7c, 0x47, 0xee, 0xe2, 0x24,
                   0x88, 0x9,  0x49, 0x70, 0xe,  0xa,  0x2,  0xa5, 0x2c, 0x20, 0xf6, 0x4b, 0xb9, 0x55, 0xed, 0x5c, 0x0,
                   0x0,  0xf,  0x54, 0x1c, 0xeb, 0x3d, 0xb,  0x3b, 0x80, 0x71, 0x98, 0x99, 0x7d, 0x22, 0x55, 0x5b, 0xb2,
                   0x1,  0x0,  0x2,  0xb8, 0x96, 0x1,  0x0,  0x9,  0xbe, 0xec, 0x29, 0x5,  0x40, 0x68, 0xb8, 0xe0, 0x30,
                   0x1,  0x0,  0x1c, 0x6a, 0xb2, 0x42, 0xa6, 0xac, 0x62, 0xca, 0xcb, 0x50, 0x2,  0x2c, 0x27, 0xae, 0x91,
                   0xf3, 0x6f, 0x3e, 0xc5, 0xdf, 0x9d, 0xe5, 0x7c, 0x35, 0x1,  0xdc, 0x39, 0x34, 0xf1, 0x2,  0x0,  0x1a,
                   0x42, 0x52, 0x10, 0x7a, 0xb0, 0xb2, 0xda, 0xce, 0x8d, 0xa0, 0xfc, 0x5d, 0x59, 0xaa, 0xda, 0x8e, 0xa7,
                   0x3,  0xcc, 0xe5, 0x3d, 0xd,  0xff, 0x55, 0x57, 0x47, 0x1,  0x0,  0x1d, 0x90, 0xe5, 0xe3, 0x29, 0x8f,
                   0xa8, 0x3f, 0xc2, 0xab, 0xcc, 0xd4, 0x8a, 0xb4, 0x3,  0xb0, 0x1d, 0x2b, 0xe,  0xfe, 0x43, 0x3e, 0x62,
                   0x70, 0x96, 0xb8, 0xf7, 0x90, 0xe7, 0x20, 0x2,  0x0,  0x11, 0xde, 0x43, 0x4a, 0xb2, 0x30, 0xd7, 0x7e,
                   0xba, 0x35, 0x2,  0x2f, 0xf1, 0xb2, 0x88, 0x48, 0xcf, 0x22, 0x1};

  uint8_t buf[191] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x77, 0x4c, 0xbf, 0xbd, 0xdd, 0x7c, 0x47, 0xee, 0xe2, 0x24, 0x88, 0x9,  0x49,
                                     0x70, 0xe,  0xa,  0x2,  0xa5, 0x2c, 0x20, 0xf6, 0x4b, 0xb9, 0x55, 0xed, 0x5c};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x54, 0x1c, 0xeb, 0x3d, 0xb,  0x3b, 0x80, 0x71,
                                     0x98, 0x99, 0x7d, 0x22, 0x55, 0x5b, 0xb2};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb8, 0x96};
  lwmqtt_string_t topic_filter_s2 = {2, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xbe, 0xec, 0x29, 0x5, 0x40, 0x68, 0xb8, 0xe0, 0x30};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6a, 0xb2, 0x42, 0xa6, 0xac, 0x62, 0xca, 0xcb, 0x50, 0x2, 0x2c, 0x27, 0xae, 0x91,
                                     0xf3, 0x6f, 0x3e, 0xc5, 0xdf, 0x9d, 0xe5, 0x7c, 0x35, 0x1, 0xdc, 0x39, 0x34, 0xf1};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x42, 0x52, 0x10, 0x7a, 0xb0, 0xb2, 0xda, 0xce, 0x8d, 0xa0, 0xfc, 0x5d, 0x59,
                                     0xaa, 0xda, 0x8e, 0xa7, 0x3,  0xcc, 0xe5, 0x3d, 0xd,  0xff, 0x55, 0x57, 0x47};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x90, 0xe5, 0xe3, 0x29, 0x8f, 0xa8, 0x3f, 0xc2, 0xab, 0xcc,
                                     0xd4, 0x8a, 0xb4, 0x3,  0xb0, 0x1d, 0x2b, 0xe,  0xfe, 0x43,
                                     0x3e, 0x62, 0x70, 0x96, 0xb8, 0xf7, 0x90, 0xe7, 0x20};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xde, 0x43, 0x4a, 0xb2, 0x30, 0xd7, 0x7e, 0xba, 0x35,
                                     0x2,  0x2f, 0xf1, 0xb2, 0x88, 0x48, 0xcf, 0x22};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT311, 13807, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 31688 [("\134Q\r\137U\191\DEL\166>c<~\234\229\251\206\249tYv\161\\\154OeS",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\220\254\200+\222G\NUL\254\179r\136{N\185N\151rL\147\ETX\251\145p\202\177\129\244\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),(";\154\220$\161c\EM\CAN\187~\EM\131+\SYN\242\172q\CAN(\214",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\199G9%\137ER:\132\252\SUB\145)\DC1\238\243q\SI",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\151\228-h2E\145\155\RS[\a\180\192{W\249\DC2k\241\246&L\189\146\SI\227P\233(",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\188\128\150\245A\241\232\247\246K\242\221E\146@\166n\144\178VMY",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("]!b\157\132\190\207K\CAN\240\196\ENQ\CAN\224\246\SOR9CcF\242\206\r\248\GSj",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropResponseInformation
// "\141\230\237\153\196\150\138\175jF)\162\152\&39\138v\253\CAN\176\&9\164",PropContentType "\142
// |\228q\150TQt\NAK\147",PropResponseInformation "4FN\ENQU\207\&3\137\NUL\240B[K\239\140e/\206\143W\214\229\234L\191
// ",PropRequestResponseInformation 228,PropResponseTopic "\246\&33\DLE\183\160\165\247",PropMaximumPacketSize
// 10572,PropServerKeepAlive 5009,PropCorrelationData
// "\GS/\140\160\220\135\188\242\235j\EOT\223\aH\242\191\183\a\135\&8",PropSubscriptionIdentifierAvailable
// 113,PropMessageExpiryInterval 31499,PropAuthenticationData
// "\195\f\174r\145\DEL\a\254\194B\228\\^\234z\222\CANyXwm",PropResponseTopic "",PropReceiveMaximum
// 29806,PropTopicAliasMaximum 6132,PropReceiveMaximum 6074,PropSubscriptionIdentifier 23,PropTopicAlias
// 25692,PropReasonString "\US\250\199\&6\251q\STX\138\f`_\RSE&JIG\247\v8\242\EOT",PropContentType
// "\223Y&\254\134\151\NAK\SUB\ETX\174\223"]
TEST(Subscribe5QCTest, Encode1) {
  uint8_t pkt[] = {
      0x82, 0x97, 0x3,  0x7b, 0xc8, 0xc7, 0x1,  0x1a, 0x0,  0x16, 0x8d, 0xe6, 0xed, 0x99, 0xc4, 0x96, 0x8a, 0xaf, 0x6a,
      0x46, 0x29, 0xa2, 0x98, 0x33, 0x39, 0x8a, 0x76, 0xfd, 0x18, 0xb0, 0x39, 0xa4, 0x3,  0x0,  0xb,  0x8e, 0x20, 0x7c,
      0xe4, 0x71, 0x96, 0x54, 0x51, 0x74, 0x15, 0x93, 0x1a, 0x0,  0x1a, 0x34, 0x46, 0x4e, 0x5,  0x55, 0xcf, 0x33, 0x89,
      0x0,  0xf0, 0x42, 0x5b, 0x4b, 0xef, 0x8c, 0x65, 0x2f, 0xce, 0x8f, 0x57, 0xd6, 0xe5, 0xea, 0x4c, 0xbf, 0x20, 0x19,
      0xe4, 0x8,  0x0,  0x8,  0xf6, 0x33, 0x33, 0x10, 0xb7, 0xa0, 0xa5, 0xf7, 0x27, 0x0,  0x0,  0x29, 0x4c, 0x13, 0x13,
      0x91, 0x9,  0x0,  0x14, 0x1d, 0x2f, 0x8c, 0xa0, 0xdc, 0x87, 0xbc, 0xf2, 0xeb, 0x6a, 0x4,  0xdf, 0x7,  0x48, 0xf2,
      0xbf, 0xb7, 0x7,  0x87, 0x38, 0x29, 0x71, 0x2,  0x0,  0x0,  0x7b, 0xb,  0x16, 0x0,  0x15, 0xc3, 0xc,  0xae, 0x72,
      0x91, 0x7f, 0x7,  0xfe, 0xc2, 0x42, 0xe4, 0x5c, 0x5e, 0xea, 0x7a, 0xde, 0x18, 0x79, 0x58, 0x77, 0x6d, 0x8,  0x0,
      0x0,  0x21, 0x74, 0x6e, 0x22, 0x17, 0xf4, 0x21, 0x17, 0xba, 0xb,  0x17, 0x23, 0x64, 0x5c, 0x1f, 0x0,  0x16, 0x1f,
      0xfa, 0xc7, 0x36, 0xfb, 0x71, 0x2,  0x8a, 0xc,  0x60, 0x5f, 0x1e, 0x45, 0x26, 0x4a, 0x49, 0x47, 0xf7, 0xb,  0x38,
      0xf2, 0x4,  0x3,  0x0,  0xb,  0xdf, 0x59, 0x26, 0xfe, 0x86, 0x97, 0x15, 0x1a, 0x3,  0xae, 0xdf, 0x0,  0x1a, 0x86,
      0x51, 0xd,  0x89, 0x55, 0xbf, 0x7f, 0xa6, 0x3e, 0x63, 0x3c, 0x7e, 0xea, 0xe5, 0xfb, 0xce, 0xf9, 0x74, 0x59, 0x76,
      0xa1, 0x5c, 0x9a, 0x4f, 0x65, 0x53, 0x0,  0x0,  0x1c, 0xdc, 0xfe, 0xc8, 0x2b, 0xde, 0x47, 0x0,  0xfe, 0xb3, 0x72,
      0x88, 0x7b, 0x4e, 0xb9, 0x4e, 0x97, 0x72, 0x4c, 0x93, 0x3,  0xfb, 0x91, 0x70, 0xca, 0xb1, 0x81, 0xf4, 0xdc, 0x1,
      0x0,  0x14, 0x3b, 0x9a, 0xdc, 0x24, 0xa1, 0x63, 0x19, 0x18, 0xbb, 0x7e, 0x19, 0x83, 0x2b, 0x16, 0xf2, 0xac, 0x71,
      0x18, 0x28, 0xd6, 0x1,  0x0,  0x12, 0xc7, 0x47, 0x39, 0x25, 0x89, 0x45, 0x52, 0x3a, 0x84, 0xfc, 0x1a, 0x91, 0x29,
      0x11, 0xee, 0xf3, 0x71, 0xf,  0x0,  0x0,  0x0,  0x0,  0x0,  0x1,  0x6b, 0x1,  0x0,  0x1d, 0x97, 0xe4, 0x2d, 0x68,
      0x32, 0x45, 0x91, 0x9b, 0x1e, 0x5b, 0x7,  0xb4, 0xc0, 0x7b, 0x57, 0xf9, 0x12, 0x6b, 0xf1, 0xf6, 0x26, 0x4c, 0xbd,
      0x92, 0xf,  0xe3, 0x50, 0xe9, 0x28, 0x1,  0x0,  0x0,  0x1,  0x0,  0x0,  0x2,  0x0,  0x16, 0xbc, 0x80, 0x96, 0xf5,
      0x41, 0xf1, 0xe8, 0xf7, 0xf6, 0x4b, 0xf2, 0xdd, 0x45, 0x92, 0x40, 0xa6, 0x6e, 0x90, 0xb2, 0x56, 0x4d, 0x59, 0x1,
      0x0,  0x1b, 0x5d, 0x21, 0x62, 0x9d, 0x84, 0xbe, 0xcf, 0x4b, 0x18, 0xf0, 0xc4, 0x5,  0x18, 0xe0, 0xf6, 0xe,  0x52,
      0x39, 0x43, 0x63, 0x46, 0xf2, 0xce, 0xd,  0xf8, 0x1d, 0x6a, 0x2};

  uint8_t buf[420] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0x51, 0xd,  0x89, 0x55, 0xbf, 0x7f, 0xa6, 0x3e, 0x63, 0x3c, 0x7e, 0xea,
                                     0xe5, 0xfb, 0xce, 0xf9, 0x74, 0x59, 0x76, 0xa1, 0x5c, 0x9a, 0x4f, 0x65, 0x53};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xdc, 0xfe, 0xc8, 0x2b, 0xde, 0x47, 0x0,  0xfe, 0xb3, 0x72,
                                     0x88, 0x7b, 0x4e, 0xb9, 0x4e, 0x97, 0x72, 0x4c, 0x93, 0x3,
                                     0xfb, 0x91, 0x70, 0xca, 0xb1, 0x81, 0xf4, 0xdc};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3b, 0x9a, 0xdc, 0x24, 0xa1, 0x63, 0x19, 0x18, 0xbb, 0x7e,
                                     0x19, 0x83, 0x2b, 0x16, 0xf2, 0xac, 0x71, 0x18, 0x28, 0xd6};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc7, 0x47, 0x39, 0x25, 0x89, 0x45, 0x52, 0x3a, 0x84,
                                     0xfc, 0x1a, 0x91, 0x29, 0x11, 0xee, 0xf3, 0x71, 0xf};
  lwmqtt_string_t topic_filter_s3 = {18, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0};
  lwmqtt_string_t topic_filter_s4 = {0, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6b};
  lwmqtt_string_t topic_filter_s5 = {1, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x97, 0xe4, 0x2d, 0x68, 0x32, 0x45, 0x91, 0x9b, 0x1e, 0x5b,
                                     0x7,  0xb4, 0xc0, 0x7b, 0x57, 0xf9, 0x12, 0x6b, 0xf1, 0xf6,
                                     0x26, 0x4c, 0xbd, 0x92, 0xf,  0xe3, 0x50, 0xe9, 0x28};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0};
  lwmqtt_string_t topic_filter_s8 = {0, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbc, 0x80, 0x96, 0xf5, 0x41, 0xf1, 0xe8, 0xf7, 0xf6, 0x4b, 0xf2,
                                     0xdd, 0x45, 0x92, 0x40, 0xa6, 0x6e, 0x90, 0xb2, 0x56, 0x4d, 0x59};
  lwmqtt_string_t topic_filter_s9 = {22, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x5d, 0x21, 0x62, 0x9d, 0x84, 0xbe, 0xcf, 0x4b, 0x18,
                                      0xf0, 0xc4, 0x5,  0x18, 0xe0, 0xf6, 0xe,  0x52, 0x39,
                                      0x43, 0x63, 0x46, 0xf2, 0xce, 0xd,  0xf8, 0x1d, 0x6a};
  lwmqtt_string_t topic_filter_s10 = {27, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x8d, 0xe6, 0xed, 0x99, 0xc4, 0x96, 0x8a, 0xaf, 0x6a, 0x46, 0x29,
                           0xa2, 0x98, 0x33, 0x39, 0x8a, 0x76, 0xfd, 0x18, 0xb0, 0x39, 0xa4};
  uint8_t bytesprops1[] = {0x8e, 0x20, 0x7c, 0xe4, 0x71, 0x96, 0x54, 0x51, 0x74, 0x15, 0x93};
  uint8_t bytesprops2[] = {0x34, 0x46, 0x4e, 0x5,  0x55, 0xcf, 0x33, 0x89, 0x0,  0xf0, 0x42, 0x5b, 0x4b,
                           0xef, 0x8c, 0x65, 0x2f, 0xce, 0x8f, 0x57, 0xd6, 0xe5, 0xea, 0x4c, 0xbf, 0x20};
  uint8_t bytesprops3[] = {0xf6, 0x33, 0x33, 0x10, 0xb7, 0xa0, 0xa5, 0xf7};
  uint8_t bytesprops4[] = {0x1d, 0x2f, 0x8c, 0xa0, 0xdc, 0x87, 0xbc, 0xf2, 0xeb, 0x6a,
                           0x4,  0xdf, 0x7,  0x48, 0xf2, 0xbf, 0xb7, 0x7,  0x87, 0x38};
  uint8_t bytesprops5[] = {0xc3, 0xc,  0xae, 0x72, 0x91, 0x7f, 0x7,  0xfe, 0xc2, 0x42, 0xe4,
                           0x5c, 0x5e, 0xea, 0x7a, 0xde, 0x18, 0x79, 0x58, 0x77, 0x6d};
  uint8_t bytesprops6[] = {0};
  uint8_t bytesprops7[] = {0x1f, 0xfa, 0xc7, 0x36, 0xfb, 0x71, 0x2,  0x8a, 0xc,  0x60, 0x5f,
                           0x1e, 0x45, 0x26, 0x4a, 0x49, 0x47, 0xf7, 0xb,  0x38, 0xf2, 0x4};
  uint8_t bytesprops8[] = {0xdf, 0x59, 0x26, 0xfe, 0x86, 0x97, 0x15, 0x1a, 0x3, 0xae, 0xdf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 228}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10572}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 5009}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {20, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 113}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31499}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {21, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {0, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29806}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6132}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 6074}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 23}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25692}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 31688, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25984
// [("1\GS\194\RS\CAND\173\140\252\160\207\178\215*q\172o\165\DC3\n\250\129\USa\128\ETB\183\171",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\175\195N\144p\188x@x\190\233.LbP!\f{\DLEez\153\bs\DC3",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\246\&9\f\n\v\143znf!\192pb2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Vw\169\NUL\222V\237}\DLE\240t\249",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] [PropPayloadFormatIndicator 130,PropMessageExpiryInterval
// 14472,PropAuthenticationData
// "\156?\131\151\US\207_\177\246\228\153?\205\&0V\253\ETX\r\SI2\236\\\214\rV\136=z7\153",PropWildcardSubscriptionAvailable
// 90,PropMessageExpiryInterval 12708,PropReceiveMaximum 13332,PropResponseTopic
// "\222>$",PropSharedSubscriptionAvailable 122,PropSessionExpiryInterval 7520,PropAuthenticationData
// "\161\231\137_\217\166\204]\192\233\175\246P$\DEL\189\147",PropRequestResponseInformation 212,PropReasonString
// "\155A5\164+$"]
TEST(Subscribe5QCTest, Encode2) {
  uint8_t pkt[] = {0x82, 0xbc, 0x1,  0x65, 0x80, 0x5e, 0x1,  0x82, 0x2,  0x0,  0x0,  0x38, 0x88, 0x16, 0x0,  0x1e,
                   0x9c, 0x3f, 0x83, 0x97, 0x1f, 0xcf, 0x5f, 0xb1, 0xf6, 0xe4, 0x99, 0x3f, 0xcd, 0x30, 0x56, 0xfd,
                   0x3,  0xd,  0xf,  0x32, 0xec, 0x5c, 0xd6, 0xd,  0x56, 0x88, 0x3d, 0x7a, 0x37, 0x99, 0x28, 0x5a,
                   0x2,  0x0,  0x0,  0x31, 0xa4, 0x21, 0x34, 0x14, 0x8,  0x0,  0x3,  0xde, 0x3e, 0x24, 0x2a, 0x7a,
                   0x11, 0x0,  0x0,  0x1d, 0x60, 0x16, 0x0,  0x11, 0xa1, 0xe7, 0x89, 0x5f, 0xd9, 0xa6, 0xcc, 0x5d,
                   0xc0, 0xe9, 0xaf, 0xf6, 0x50, 0x24, 0x7f, 0xbd, 0x93, 0x19, 0xd4, 0x1f, 0x0,  0x6,  0x9b, 0x41,
                   0x35, 0xa4, 0x2b, 0x24, 0x0,  0x1c, 0x31, 0x1d, 0xc2, 0x1e, 0x18, 0x44, 0xad, 0x8c, 0xfc, 0xa0,
                   0xcf, 0xb2, 0xd7, 0x2a, 0x71, 0xac, 0x6f, 0xa5, 0x13, 0xa,  0xfa, 0x81, 0x1f, 0x61, 0x80, 0x17,
                   0xb7, 0xab, 0x1,  0x0,  0x19, 0xaf, 0xc3, 0x4e, 0x90, 0x70, 0xbc, 0x78, 0x40, 0x78, 0xbe, 0xe9,
                   0x2e, 0x4c, 0x62, 0x50, 0x21, 0xc,  0x7b, 0x10, 0x65, 0x7a, 0x99, 0x8,  0x73, 0x13, 0x2,  0x0,
                   0xe,  0xf6, 0x39, 0xc,  0xa,  0xb,  0x8f, 0x7a, 0x6e, 0x66, 0x21, 0xc0, 0x70, 0x62, 0x32, 0x2,
                   0x0,  0xc,  0x56, 0x77, 0xa9, 0x0,  0xde, 0x56, 0xed, 0x7d, 0x10, 0xf0, 0x74, 0xf9, 0x1};

  uint8_t buf[201] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x31, 0x1d, 0xc2, 0x1e, 0x18, 0x44, 0xad, 0x8c, 0xfc, 0xa0,
                                     0xcf, 0xb2, 0xd7, 0x2a, 0x71, 0xac, 0x6f, 0xa5, 0x13, 0xa,
                                     0xfa, 0x81, 0x1f, 0x61, 0x80, 0x17, 0xb7, 0xab};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaf, 0xc3, 0x4e, 0x90, 0x70, 0xbc, 0x78, 0x40, 0x78, 0xbe, 0xe9, 0x2e, 0x4c,
                                     0x62, 0x50, 0x21, 0xc,  0x7b, 0x10, 0x65, 0x7a, 0x99, 0x8,  0x73, 0x13};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf6, 0x39, 0xc, 0xa, 0xb, 0x8f, 0x7a, 0x6e, 0x66, 0x21, 0xc0, 0x70, 0x62, 0x32};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x56, 0x77, 0xa9, 0x0, 0xde, 0x56, 0xed, 0x7d, 0x10, 0xf0, 0x74, 0xf9};
  lwmqtt_string_t topic_filter_s3 = {12, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x9c, 0x3f, 0x83, 0x97, 0x1f, 0xcf, 0x5f, 0xb1, 0xf6, 0xe4, 0x99, 0x3f, 0xcd, 0x30, 0x56,
                           0xfd, 0x3,  0xd,  0xf,  0x32, 0xec, 0x5c, 0xd6, 0xd,  0x56, 0x88, 0x3d, 0x7a, 0x37, 0x99};
  uint8_t bytesprops1[] = {0xde, 0x3e, 0x24};
  uint8_t bytesprops2[] = {0xa1, 0xe7, 0x89, 0x5f, 0xd9, 0xa6, 0xcc, 0x5d, 0xc0,
                           0xe9, 0xaf, 0xf6, 0x50, 0x24, 0x7f, 0xbd, 0x93};
  uint8_t bytesprops3[] = {0x9b, 0x41, 0x35, 0xa4, 0x2b, 0x24};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 130}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14472}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {30, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 90}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12708}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13332}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {3, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 122}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7520}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {17, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 212}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops3}}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25984, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 15464
// [("\SOC\155\217\ESC\vJ\139\SOW\183\RS]\STX&\SUB\184\NUL\242J\186\165\165\204\&5\160\209\156\&9",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\248\143P2v\177\&2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("n\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal
// = False, _subQoS = QoS2}),("X\159\CAN\143\245\n\206y\DC4\135\DC4i\232`",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\DLEA\227\&5x\234\US\171",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\164\177\152\ETBhD\152\251\180\"\244\239\191\241\149\227}\183\&0",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\r@\174C\FSM$\180\212'\253\157\173\SOI9\204b",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("C\226\169\230)",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\145Tu\NUL\b\ESC\227",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropTopicAliasMaximum 18730,PropSessionExpiryInterval 5052,PropSubscriptionIdentifierAvailable
// 10,PropCorrelationData "\EOT\160_\129\199h\241\244\158Di\130\128A\157*\n\199",PropMessageExpiryInterval
// 9252,PropRetainAvailable 152,PropContentType "X\170",PropMaximumQoS 200,PropAuthenticationMethod
// "\133\&0\230d\240#\198\167\152[\t\141\162\&5\f\182\174\222J\238\141\223Q\210\&9;",PropServerReference
// "\246\243'\142\140gr\158\229/\220\198\&8e\217\221\&5\195\239\164\237\200\t\189\t\n\177\FS\193\b",PropCorrelationData
// "b@M\135U=@X",PropReceiveMaximum 13606,PropPayloadFormatIndicator 76,PropReceiveMaximum 21293,PropReasonString
// "\178\ETB\135\DEL\141.p\US\146mg\v%b\210\147;_8\252\231_\191\242K\v\246*d\230",PropSubscriptionIdentifierAvailable
// 140]
TEST(Subscribe5QCTest, Encode3) {
  uint8_t pkt[] = {
      0x82, 0xad, 0x2,  0x3c, 0x68, 0xa1, 0x1,  0x22, 0x49, 0x2a, 0x11, 0x0,  0x0,  0x13, 0xbc, 0x29, 0xa,  0x9,  0x0,
      0x12, 0x4,  0xa0, 0x5f, 0x81, 0xc7, 0x68, 0xf1, 0xf4, 0x9e, 0x44, 0x69, 0x82, 0x80, 0x41, 0x9d, 0x2a, 0xa,  0xc7,
      0x2,  0x0,  0x0,  0x24, 0x24, 0x25, 0x98, 0x3,  0x0,  0x2,  0x58, 0xaa, 0x24, 0xc8, 0x15, 0x0,  0x1a, 0x85, 0x30,
      0xe6, 0x64, 0xf0, 0x23, 0xc6, 0xa7, 0x98, 0x5b, 0x9,  0x8d, 0xa2, 0x35, 0xc,  0xb6, 0xae, 0xde, 0x4a, 0xee, 0x8d,
      0xdf, 0x51, 0xd2, 0x39, 0x3b, 0x1c, 0x0,  0x1e, 0xf6, 0xf3, 0x27, 0x8e, 0x8c, 0x67, 0x72, 0x9e, 0xe5, 0x2f, 0xdc,
      0xc6, 0x38, 0x65, 0xd9, 0xdd, 0x35, 0xc3, 0xef, 0xa4, 0xed, 0xc8, 0x9,  0xbd, 0x9,  0xa,  0xb1, 0x1c, 0xc1, 0x8,
      0x9,  0x0,  0x8,  0x62, 0x40, 0x4d, 0x87, 0x55, 0x3d, 0x40, 0x58, 0x21, 0x35, 0x26, 0x1,  0x4c, 0x21, 0x53, 0x2d,
      0x1f, 0x0,  0x1e, 0xb2, 0x17, 0x87, 0x7f, 0x8d, 0x2e, 0x70, 0x1f, 0x92, 0x6d, 0x67, 0xb,  0x25, 0x62, 0xd2, 0x93,
      0x3b, 0x5f, 0x38, 0xfc, 0xe7, 0x5f, 0xbf, 0xf2, 0x4b, 0xb,  0xf6, 0x2a, 0x64, 0xe6, 0x29, 0x8c, 0x0,  0x1d, 0xe,
      0x43, 0x9b, 0xd9, 0x1b, 0xb,  0x4a, 0x8b, 0xe,  0x57, 0xb7, 0x1e, 0x5d, 0x2,  0x26, 0x1a, 0xb8, 0x0,  0xf2, 0x4a,
      0xba, 0xa5, 0xa5, 0xcc, 0x35, 0xa0, 0xd1, 0x9c, 0x39, 0x0,  0x0,  0x7,  0xf8, 0x8f, 0x50, 0x32, 0x76, 0xb1, 0x32,
      0x2,  0x0,  0x2,  0x6e, 0xd2, 0x2,  0x0,  0xe,  0x58, 0x9f, 0x18, 0x8f, 0xf5, 0xa,  0xce, 0x79, 0x14, 0x87, 0x14,
      0x69, 0xe8, 0x60, 0x2,  0x0,  0x8,  0x10, 0x41, 0xe3, 0x35, 0x78, 0xea, 0x1f, 0xab, 0x0,  0x0,  0x13, 0xa4, 0xb1,
      0x98, 0x17, 0x68, 0x44, 0x98, 0xfb, 0xb4, 0x22, 0xf4, 0xef, 0xbf, 0xf1, 0x95, 0xe3, 0x7d, 0xb7, 0x30, 0x0,  0x0,
      0x12, 0xd,  0x40, 0xae, 0x43, 0x1c, 0x4d, 0x24, 0xb4, 0xd4, 0x27, 0xfd, 0x9d, 0xad, 0xe,  0x49, 0x39, 0xcc, 0x62,
      0x0,  0x0,  0x5,  0x43, 0xe2, 0xa9, 0xe6, 0x29, 0x0,  0x0,  0x7,  0x91, 0x54, 0x75, 0x0,  0x8,  0x1b, 0xe3, 0x1};

  uint8_t buf[314] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0xe,  0x43, 0x9b, 0xd9, 0x1b, 0xb,  0x4a, 0x8b, 0xe,  0x57,
                                     0xb7, 0x1e, 0x5d, 0x2,  0x26, 0x1a, 0xb8, 0x0,  0xf2, 0x4a,
                                     0xba, 0xa5, 0xa5, 0xcc, 0x35, 0xa0, 0xd1, 0x9c, 0x39};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf8, 0x8f, 0x50, 0x32, 0x76, 0xb1, 0x32};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x6e, 0xd2};
  lwmqtt_string_t topic_filter_s2 = {2, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x58, 0x9f, 0x18, 0x8f, 0xf5, 0xa, 0xce, 0x79, 0x14, 0x87, 0x14, 0x69, 0xe8, 0x60};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x10, 0x41, 0xe3, 0x35, 0x78, 0xea, 0x1f, 0xab};
  lwmqtt_string_t topic_filter_s4 = {8, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa4, 0xb1, 0x98, 0x17, 0x68, 0x44, 0x98, 0xfb, 0xb4, 0x22,
                                     0xf4, 0xef, 0xbf, 0xf1, 0x95, 0xe3, 0x7d, 0xb7, 0x30};
  lwmqtt_string_t topic_filter_s5 = {19, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd,  0x40, 0xae, 0x43, 0x1c, 0x4d, 0x24, 0xb4, 0xd4,
                                     0x27, 0xfd, 0x9d, 0xad, 0xe,  0x49, 0x39, 0xcc, 0x62};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x43, 0xe2, 0xa9, 0xe6, 0x29};
  lwmqtt_string_t topic_filter_s7 = {5, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x91, 0x54, 0x75, 0x0, 0x8, 0x1b, 0xe3};
  lwmqtt_string_t topic_filter_s8 = {7, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x4,  0xa0, 0x5f, 0x81, 0xc7, 0x68, 0xf1, 0xf4, 0x9e,
                           0x44, 0x69, 0x82, 0x80, 0x41, 0x9d, 0x2a, 0xa,  0xc7};
  uint8_t bytesprops1[] = {0x58, 0xaa};
  uint8_t bytesprops2[] = {0x85, 0x30, 0xe6, 0x64, 0xf0, 0x23, 0xc6, 0xa7, 0x98, 0x5b, 0x9,  0x8d, 0xa2,
                           0x35, 0xc,  0xb6, 0xae, 0xde, 0x4a, 0xee, 0x8d, 0xdf, 0x51, 0xd2, 0x39, 0x3b};
  uint8_t bytesprops3[] = {0xf6, 0xf3, 0x27, 0x8e, 0x8c, 0x67, 0x72, 0x9e, 0xe5, 0x2f, 0xdc, 0xc6, 0x38, 0x65, 0xd9,
                           0xdd, 0x35, 0xc3, 0xef, 0xa4, 0xed, 0xc8, 0x9,  0xbd, 0x9,  0xa,  0xb1, 0x1c, 0xc1, 0x8};
  uint8_t bytesprops4[] = {0x62, 0x40, 0x4d, 0x87, 0x55, 0x3d, 0x40, 0x58};
  uint8_t bytesprops5[] = {0xb2, 0x17, 0x87, 0x7f, 0x8d, 0x2e, 0x70, 0x1f, 0x92, 0x6d, 0x67, 0xb,  0x25, 0x62, 0xd2,
                           0x93, 0x3b, 0x5f, 0x38, 0xfc, 0xe7, 0x5f, 0xbf, 0xf2, 0x4b, 0xb,  0xf6, 0x2a, 0x64, 0xe6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 18730}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 5052}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 10}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {18, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9252}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 152}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 200}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {8, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 13606}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 76}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 21293}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {30, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 140}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 15464, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 838 [("$-\227\252n\140N\241\225\146S\213\231(\193\150\248\177u\194",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropMessageExpiryInterval
// 9616,PropPayloadFormatIndicator 152,PropAssignedClientIdentifier "\237\248\176\172\135H\154s\242\197|\140
// &\209\rQh#e\171\234",PropAssignedClientIdentifier "\t",PropAuthenticationMethod
// "\214\255_\213g\182\&5m\217\n\"",PropUserProperty "\224<\159\154\193\174\207\166"
// "BL;3R\187j\225\246mD\222\239\153\230\146\240\233\149\175\189"]
TEST(Subscribe5QCTest, Encode4) {
  uint8_t pkt[] = {0x82, 0x6e, 0x3,  0x46, 0x54, 0x2,  0x0,  0x0,  0x25, 0x90, 0x1,  0x98, 0x12, 0x0,  0x16, 0xed,
                   0xf8, 0xb0, 0xac, 0x87, 0x48, 0x9a, 0x73, 0xf2, 0xc5, 0x7c, 0x8c, 0x20, 0x26, 0xd1, 0xd,  0x51,
                   0x68, 0x23, 0x65, 0xab, 0xea, 0x12, 0x0,  0x1,  0x9,  0x15, 0x0,  0xb,  0xd6, 0xff, 0x5f, 0xd5,
                   0x67, 0xb6, 0x35, 0x6d, 0xd9, 0xa,  0x22, 0x26, 0x0,  0x8,  0xe0, 0x3c, 0x9f, 0x9a, 0xc1, 0xae,
                   0xcf, 0xa6, 0x0,  0x15, 0x42, 0x4c, 0x3b, 0x33, 0x52, 0xbb, 0x6a, 0xe1, 0xf6, 0x6d, 0x44, 0xde,
                   0xef, 0x99, 0xe6, 0x92, 0xf0, 0xe9, 0x95, 0xaf, 0xbd, 0x0,  0x14, 0x24, 0x2d, 0xe3, 0xfc, 0x6e,
                   0x8c, 0x4e, 0xf1, 0xe1, 0x92, 0x53, 0xd5, 0xe7, 0x28, 0xc1, 0x96, 0xf8, 0xb1, 0x75, 0xc2, 0x1};

  uint8_t buf[122] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x24, 0x2d, 0xe3, 0xfc, 0x6e, 0x8c, 0x4e, 0xf1, 0xe1, 0x92,
                                     0x53, 0xd5, 0xe7, 0x28, 0xc1, 0x96, 0xf8, 0xb1, 0x75, 0xc2};
  lwmqtt_string_t topic_filter_s0 = {20, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xed, 0xf8, 0xb0, 0xac, 0x87, 0x48, 0x9a, 0x73, 0xf2, 0xc5, 0x7c,
                           0x8c, 0x20, 0x26, 0xd1, 0xd,  0x51, 0x68, 0x23, 0x65, 0xab, 0xea};
  uint8_t bytesprops1[] = {0x9};
  uint8_t bytesprops2[] = {0xd6, 0xff, 0x5f, 0xd5, 0x67, 0xb6, 0x35, 0x6d, 0xd9, 0xa, 0x22};
  uint8_t bytesprops4[] = {0x42, 0x4c, 0x3b, 0x33, 0x52, 0xbb, 0x6a, 0xe1, 0xf6, 0x6d, 0x44,
                           0xde, 0xef, 0x99, 0xe6, 0x92, 0xf0, 0xe9, 0x95, 0xaf, 0xbd};
  uint8_t bytesprops3[] = {0xe0, 0x3c, 0x9f, 0x9a, 0xc1, 0xae, 0xcf, 0xa6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9616}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 152}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {1, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {8, (char*)&bytesprops3}, .v = {21, (char*)&bytesprops4}}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 838, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16617 [("*\213.\SOH{\207\165\GS\FS\150\148]qq=A\239\234\252\189\STX;",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\210<\215\&2\177\181\232\211j\199\228\159~/\181X\SYN\136\205\\\253#",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\223[\223\187\180|\210;\149\229\164E",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS0}),("\133\253\223\167\156+\246\156\162\137\SYN\187I\v\233\SUB-\204P\169\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("1\b?\185o\135\176\195\173\ETB\161\156'\128M",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("6\129\247\STX\251H6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("#`\225\150-e~\189\179c\212Qv\226U\171q\201\244\186i\219\169\234\t\175",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NUL\136\CANO\SI\DEL\DC3\SYN\162\134\176\241\190eb\210\155",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\129>",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropServerReference
// "4\241{\135)\177\156\182\DC2|\186'?\161\224\&3",PropUserProperty
// "=G\147\136\ETX\169_\SOH\232\143\197\218\191\DC3d\238E\157\v7\ETXlP"
// "P~\254\155\151\194",PropSharedSubscriptionAvailable 185,PropAuthenticationData
// "\170\172\181:\178\228\255I\b\159\147\172\ETX\137'#\215a\144",PropRequestResponseInformation
// 207,PropMessageExpiryInterval 5495,PropWillDelayInterval 605,PropAssignedClientIdentifier
// "v\183\b\142\195\244\240\130\161\254\&6x\FSJ",PropMessageExpiryInterval 15712,PropServerKeepAlive
// 1894,PropTopicAliasMaximum 13651,PropAuthenticationMethod "\235T}\CAN",PropUserProperty "K\249\DC2|"
// "\237\n\158OC\182\178\242\255\238\179\248\a\253",PropResponseTopic
// "\DC4\f\160\215\192Yp;\221\172\ENQHf^\185u\207\&0\EM\203\133!\ACKs_\214q",PropSubscriptionIdentifier
// 1,PropMaximumPacketSize 25076,PropRequestProblemInformation 68]
TEST(Subscribe5QCTest, Encode5) {
  uint8_t pkt[] = {
      0x82, 0xe9, 0x2,  0x40, 0xe9, 0xba, 0x1,  0x1c, 0x0,  0x10, 0x34, 0xf1, 0x7b, 0x87, 0x29, 0xb1, 0x9c, 0xb6, 0x12,
      0x7c, 0xba, 0x27, 0x3f, 0xa1, 0xe0, 0x33, 0x26, 0x0,  0x17, 0x3d, 0x47, 0x93, 0x88, 0x3,  0xa9, 0x5f, 0x1,  0xe8,
      0x8f, 0xc5, 0xda, 0xbf, 0x13, 0x64, 0xee, 0x45, 0x9d, 0xb,  0x37, 0x3,  0x6c, 0x50, 0x0,  0x6,  0x50, 0x7e, 0xfe,
      0x9b, 0x97, 0xc2, 0x2a, 0xb9, 0x16, 0x0,  0x13, 0xaa, 0xac, 0xb5, 0x3a, 0xb2, 0xe4, 0xff, 0x49, 0x8,  0x9f, 0x93,
      0xac, 0x3,  0x89, 0x27, 0x23, 0xd7, 0x61, 0x90, 0x19, 0xcf, 0x2,  0x0,  0x0,  0x15, 0x77, 0x18, 0x0,  0x0,  0x2,
      0x5d, 0x12, 0x0,  0xe,  0x76, 0xb7, 0x8,  0x8e, 0xc3, 0xf4, 0xf0, 0x82, 0xa1, 0xfe, 0x36, 0x78, 0x1c, 0x4a, 0x2,
      0x0,  0x0,  0x3d, 0x60, 0x13, 0x7,  0x66, 0x22, 0x35, 0x53, 0x15, 0x0,  0x4,  0xeb, 0x54, 0x7d, 0x18, 0x26, 0x0,
      0x4,  0x4b, 0xf9, 0x12, 0x7c, 0x0,  0xe,  0xed, 0xa,  0x9e, 0x4f, 0x43, 0xb6, 0xb2, 0xf2, 0xff, 0xee, 0xb3, 0xf8,
      0x7,  0xfd, 0x8,  0x0,  0x1b, 0x14, 0xc,  0xa0, 0xd7, 0xc0, 0x59, 0x70, 0x3b, 0xdd, 0xac, 0x5,  0x48, 0x66, 0x5e,
      0xb9, 0x75, 0xcf, 0x30, 0x19, 0xcb, 0x85, 0x21, 0x6,  0x73, 0x5f, 0xd6, 0x71, 0xb,  0x1,  0x27, 0x0,  0x0,  0x61,
      0xf4, 0x17, 0x44, 0x0,  0x16, 0x2a, 0xd5, 0x2e, 0x1,  0x7b, 0xcf, 0xa5, 0x1d, 0x1c, 0x96, 0x94, 0x5d, 0x71, 0x71,
      0x3d, 0x41, 0xef, 0xea, 0xfc, 0xbd, 0x2,  0x3b, 0x2,  0x0,  0x16, 0xd2, 0x3c, 0xd7, 0x32, 0xb1, 0xb5, 0xe8, 0xd3,
      0x6a, 0xc7, 0xe4, 0x9f, 0x7e, 0x2f, 0xb5, 0x58, 0x16, 0x88, 0xcd, 0x5c, 0xfd, 0x23, 0x1,  0x0,  0xc,  0xdf, 0x5b,
      0xdf, 0xbb, 0xb4, 0x7c, 0xd2, 0x3b, 0x95, 0xe5, 0xa4, 0x45, 0x0,  0x0,  0x15, 0x85, 0xfd, 0xdf, 0xa7, 0x9c, 0x2b,
      0xf6, 0x9c, 0xa2, 0x89, 0x16, 0xbb, 0x49, 0xb,  0xe9, 0x1a, 0x2d, 0xcc, 0x50, 0xa9, 0xe9, 0x0,  0x0,  0xf,  0x31,
      0x8,  0x3f, 0xb9, 0x6f, 0x87, 0xb0, 0xc3, 0xad, 0x17, 0xa1, 0x9c, 0x27, 0x80, 0x4d, 0x2,  0x0,  0x7,  0x36, 0x81,
      0xf7, 0x2,  0xfb, 0x48, 0x36, 0x0,  0x0,  0x1a, 0x23, 0x60, 0xe1, 0x96, 0x2d, 0x65, 0x7e, 0xbd, 0xb3, 0x63, 0xd4,
      0x51, 0x76, 0xe2, 0x55, 0xab, 0x71, 0xc9, 0xf4, 0xba, 0x69, 0xdb, 0xa9, 0xea, 0x9,  0xaf, 0x0,  0x0,  0x11, 0x0,
      0x88, 0x18, 0x4f, 0xf,  0x7f, 0x13, 0x16, 0xa2, 0x86, 0xb0, 0xf1, 0xbe, 0x65, 0x62, 0xd2, 0x9b, 0x1,  0x0,  0x2,
      0x81, 0x3e, 0x1};

  uint8_t buf[374] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x2a, 0xd5, 0x2e, 0x1,  0x7b, 0xcf, 0xa5, 0x1d, 0x1c, 0x96, 0x94,
                                     0x5d, 0x71, 0x71, 0x3d, 0x41, 0xef, 0xea, 0xfc, 0xbd, 0x2,  0x3b};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd2, 0x3c, 0xd7, 0x32, 0xb1, 0xb5, 0xe8, 0xd3, 0x6a, 0xc7, 0xe4,
                                     0x9f, 0x7e, 0x2f, 0xb5, 0x58, 0x16, 0x88, 0xcd, 0x5c, 0xfd, 0x23};
  lwmqtt_string_t topic_filter_s1 = {22, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xdf, 0x5b, 0xdf, 0xbb, 0xb4, 0x7c, 0xd2, 0x3b, 0x95, 0xe5, 0xa4, 0x45};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x85, 0xfd, 0xdf, 0xa7, 0x9c, 0x2b, 0xf6, 0x9c, 0xa2, 0x89, 0x16,
                                     0xbb, 0x49, 0xb,  0xe9, 0x1a, 0x2d, 0xcc, 0x50, 0xa9, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x31, 0x8,  0x3f, 0xb9, 0x6f, 0x87, 0xb0, 0xc3,
                                     0xad, 0x17, 0xa1, 0x9c, 0x27, 0x80, 0x4d};
  lwmqtt_string_t topic_filter_s4 = {15, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x36, 0x81, 0xf7, 0x2, 0xfb, 0x48, 0x36};
  lwmqtt_string_t topic_filter_s5 = {7, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x23, 0x60, 0xe1, 0x96, 0x2d, 0x65, 0x7e, 0xbd, 0xb3, 0x63, 0xd4, 0x51, 0x76,
                                     0xe2, 0x55, 0xab, 0x71, 0xc9, 0xf4, 0xba, 0x69, 0xdb, 0xa9, 0xea, 0x9,  0xaf};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x0,  0x88, 0x18, 0x4f, 0xf,  0x7f, 0x13, 0x16, 0xa2,
                                     0x86, 0xb0, 0xf1, 0xbe, 0x65, 0x62, 0xd2, 0x9b};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x81, 0x3e};
  lwmqtt_string_t topic_filter_s8 = {2, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x34, 0xf1, 0x7b, 0x87, 0x29, 0xb1, 0x9c, 0xb6,
                           0x12, 0x7c, 0xba, 0x27, 0x3f, 0xa1, 0xe0, 0x33};
  uint8_t bytesprops2[] = {0x50, 0x7e, 0xfe, 0x9b, 0x97, 0xc2};
  uint8_t bytesprops1[] = {0x3d, 0x47, 0x93, 0x88, 0x3,  0xa9, 0x5f, 0x1,  0xe8, 0x8f, 0xc5, 0xda,
                           0xbf, 0x13, 0x64, 0xee, 0x45, 0x9d, 0xb,  0x37, 0x3,  0x6c, 0x50};
  uint8_t bytesprops3[] = {0xaa, 0xac, 0xb5, 0x3a, 0xb2, 0xe4, 0xff, 0x49, 0x8, 0x9f,
                           0x93, 0xac, 0x3,  0x89, 0x27, 0x23, 0xd7, 0x61, 0x90};
  uint8_t bytesprops4[] = {0x76, 0xb7, 0x8, 0x8e, 0xc3, 0xf4, 0xf0, 0x82, 0xa1, 0xfe, 0x36, 0x78, 0x1c, 0x4a};
  uint8_t bytesprops5[] = {0xeb, 0x54, 0x7d, 0x18};
  uint8_t bytesprops7[] = {0xed, 0xa, 0x9e, 0x4f, 0x43, 0xb6, 0xb2, 0xf2, 0xff, 0xee, 0xb3, 0xf8, 0x7, 0xfd};
  uint8_t bytesprops6[] = {0x4b, 0xf9, 0x12, 0x7c};
  uint8_t bytesprops8[] = {0x14, 0xc,  0xa0, 0xd7, 0xc0, 0x59, 0x70, 0x3b, 0xdd, 0xac, 0x5,  0x48, 0x66, 0x5e,
                           0xb9, 0x75, 0xcf, 0x30, 0x19, 0xcb, 0x85, 0x21, 0x6,  0x73, 0x5f, 0xd6, 0x71};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {23, (char*)&bytesprops1}, .v = {6, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 185}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 207}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5495}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 605}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {14, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15712}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 1894}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13651}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {4, (char*)&bytesprops6}, .v = {14, (char*)&bytesprops7}}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 1}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 25076}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 68}},
  };

  lwmqtt_properties_t props = {17, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 16617, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4070 [("\v\136/\233\EOT\FS\240\255\227\DC3q9\SI\SOH\\",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\170\176\237\215\202\131\&2\ESCK\136h\184\178\226\178}.\242",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropMessageExpiryInterval
// 23503,PropSessionExpiryInterval 6089,PropMaximumPacketSize 7148,PropUserProperty "[\DC2\234\153\CAN'\ETX\152d\186"
// "\208\na\201\165\173p\232",PropAuthenticationData "\240h5\143\128\179:\131|\140Z",PropMessageExpiryInterval
// 23070,PropWillDelayInterval 1219,PropSubscriptionIdentifierAvailable 72,PropWillDelayInterval
// 20808,PropCorrelationData "U\rh\144",PropServerKeepAlive 3568,PropRequestResponseInformation
// 236,PropPayloadFormatIndicator 46,PropMessageExpiryInterval 14380,PropWildcardSubscriptionAvailable
// 95,PropAuthenticationData "\137\189l\153\160\233\ETX\237\r"]
TEST(Subscribe5QCTest, Encode6) {
  uint8_t pkt[] = {0x82, 0x90, 0x1,  0xf,  0xe6, 0x66, 0x2,  0x0,  0x0,  0x5b, 0xcf, 0x11, 0x0,  0x0,  0x17, 0xc9, 0x27,
                   0x0,  0x0,  0x1b, 0xec, 0x26, 0x0,  0xa,  0x5b, 0x12, 0xea, 0x99, 0x18, 0x27, 0x3,  0x98, 0x64, 0xba,
                   0x0,  0x8,  0xd0, 0xa,  0x61, 0xc9, 0xa5, 0xad, 0x70, 0xe8, 0x16, 0x0,  0xb,  0xf0, 0x68, 0x35, 0x8f,
                   0x80, 0xb3, 0x3a, 0x83, 0x7c, 0x8c, 0x5a, 0x2,  0x0,  0x0,  0x5a, 0x1e, 0x18, 0x0,  0x0,  0x4,  0xc3,
                   0x29, 0x48, 0x18, 0x0,  0x0,  0x51, 0x48, 0x9,  0x0,  0x4,  0x55, 0xd,  0x68, 0x90, 0x13, 0xd,  0xf0,
                   0x19, 0xec, 0x1,  0x2e, 0x2,  0x0,  0x0,  0x38, 0x2c, 0x28, 0x5f, 0x16, 0x0,  0x9,  0x89, 0xbd, 0x6c,
                   0x99, 0xa0, 0xe9, 0x3,  0xed, 0xd,  0x0,  0xf,  0xb,  0x88, 0x2f, 0xe9, 0x4,  0x1c, 0xf0, 0xff, 0xe3,
                   0x13, 0x71, 0x39, 0xf,  0x1,  0x5c, 0x1,  0x0,  0x12, 0xaa, 0xb0, 0xed, 0xd7, 0xca, 0x83, 0x32, 0x1b,
                   0x4b, 0x88, 0x68, 0xb8, 0xb2, 0xe2, 0xb2, 0x7d, 0x2e, 0xf2, 0x0};

  uint8_t buf[157] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xb,  0x88, 0x2f, 0xe9, 0x4, 0x1c, 0xf0, 0xff,
                                     0xe3, 0x13, 0x71, 0x39, 0xf, 0x1,  0x5c};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaa, 0xb0, 0xed, 0xd7, 0xca, 0x83, 0x32, 0x1b, 0x4b,
                                     0x88, 0x68, 0xb8, 0xb2, 0xe2, 0xb2, 0x7d, 0x2e, 0xf2};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0};
  uint8_t bytesprops1[] = {0xd0, 0xa, 0x61, 0xc9, 0xa5, 0xad, 0x70, 0xe8};
  uint8_t bytesprops0[] = {0x5b, 0x12, 0xea, 0x99, 0x18, 0x27, 0x3, 0x98, 0x64, 0xba};
  uint8_t bytesprops2[] = {0xf0, 0x68, 0x35, 0x8f, 0x80, 0xb3, 0x3a, 0x83, 0x7c, 0x8c, 0x5a};
  uint8_t bytesprops3[] = {0x55, 0xd, 0x68, 0x90};
  uint8_t bytesprops4[] = {0x89, 0xbd, 0x6c, 0x99, 0xa0, 0xe9, 0x3, 0xed, 0xd};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23503}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 6089}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7148}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {10, (char*)&bytesprops0}, .v = {8, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23070}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 1219}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 72}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 20808}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 3568}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 236}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 46}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14380}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 95}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {9, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4070, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1318 [("\141",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("(\232l\147\231\ETB\129\188\&6\207\SO\182\244\225\193S\228\&7\179\DEL\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\241\168\NUL\143\233m\184\163\STX\218\&8\156\252\250i\184C\188B\167\197\224A",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\177s\170{`\"e\RSr\DC3\r[\215\130\150\199q\253\216\221\231;\SYN",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\254*\164\NUL.\198\237\227\&3\143\SUB\248\248\162\t\167\n\146\232\250AK\234\220\178f\205\210\226",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\159}A_\221B\190\143\&5\n\NUL\186z)\143",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\r0\DC1\n\226K\201\177\128\US:\237o\241I\186d|",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Q\EM\214h\"_\196\253z\ACK\211F7\211D\144\NUL",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),(")\213\149\ACK",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropContentType
// "\130\ENQm\151\150mh\225Hc\184\187\247",PropResponseTopic "S51\GS\134\178\187V@\221",PropResponseInformation
// "\204\196\n$a-\EOT\243\SYNJ\190",PropAuthenticationMethod
// "j\131\232\175\144\213p2\166\179\218\167\130\153\195\242\204J\142Ti\179pM\164",PropAuthenticationData
// "\143\NUL\253\152\190\179\v\184\n\143\&9\170\162\138\230\a\254",PropTopicAlias 25408,PropSharedSubscriptionAvailable
// 253,PropTopicAlias 9479,PropSessionExpiryInterval 28451,PropWildcardSubscriptionAvailable 200,PropResponseInformation
// "\161\165\SO\189\173\EOT\175\&4\\jwc\177\193\SYNJ\186\235\223(#v",PropSessionExpiryInterval
// 14824,PropMaximumPacketSize 4374,PropSubscriptionIdentifier 12,PropMaximumPacketSize 2638,PropMaximumQoS
// 100,PropCorrelationData "\249\&3\\\211\147",PropRequestResponseInformation 8,PropReasonString
// "#",PropWildcardSubscriptionAvailable 248,PropPayloadFormatIndicator 146,PropAuthenticationMethod
// "\218`\167",PropRequestProblemInformation 80,PropAuthenticationMethod
// "o\170\235\155\200^(\171(\SYN\216\214\b\227\163DV\211\163",PropMessageExpiryInterval 17106,PropAuthenticationData
// "v\253\DC2\198\a\EMO\188\176\213\FS\159\202\RS\b\248g\170\243\234\140\DC4\v\EOTb\242\205\135\&0\141",PropReasonString
// "\DC4\154\ENQ\239\170\178\203\153U\208\153\DLE\230\146\226$\178\NUL\"\198;9\175MY\150\211Im",PropMessageExpiryInterval
// 21474,PropReasonString "A^\155er\157"]
TEST(Subscribe5QCTest, Encode7) {
  uint8_t pkt[] = {
      0x82, 0xd0, 0x3,  0x5,  0x26, 0x9a, 0x2,  0x3,  0x0,  0xd,  0x82, 0x5,  0x6d, 0x97, 0x96, 0x6d, 0x68, 0xe1, 0x48,
      0x63, 0xb8, 0xbb, 0xf7, 0x8,  0x0,  0xa,  0x53, 0x35, 0x31, 0x1d, 0x86, 0xb2, 0xbb, 0x56, 0x40, 0xdd, 0x1a, 0x0,
      0xb,  0xcc, 0xc4, 0xa,  0x24, 0x61, 0x2d, 0x4,  0xf3, 0x16, 0x4a, 0xbe, 0x15, 0x0,  0x19, 0x6a, 0x83, 0xe8, 0xaf,
      0x90, 0xd5, 0x70, 0x32, 0xa6, 0xb3, 0xda, 0xa7, 0x82, 0x99, 0xc3, 0xf2, 0xcc, 0x4a, 0x8e, 0x54, 0x69, 0xb3, 0x70,
      0x4d, 0xa4, 0x16, 0x0,  0x11, 0x8f, 0x0,  0xfd, 0x98, 0xbe, 0xb3, 0xb,  0xb8, 0xa,  0x8f, 0x39, 0xaa, 0xa2, 0x8a,
      0xe6, 0x7,  0xfe, 0x23, 0x63, 0x40, 0x2a, 0xfd, 0x23, 0x25, 0x7,  0x11, 0x0,  0x0,  0x6f, 0x23, 0x28, 0xc8, 0x1a,
      0x0,  0x16, 0xa1, 0xa5, 0xe,  0xbd, 0xad, 0x4,  0xaf, 0x34, 0x5c, 0x6a, 0x77, 0x63, 0xb1, 0xc1, 0x16, 0x4a, 0xba,
      0xeb, 0xdf, 0x28, 0x23, 0x76, 0x11, 0x0,  0x0,  0x39, 0xe8, 0x27, 0x0,  0x0,  0x11, 0x16, 0xb,  0xc,  0x27, 0x0,
      0x0,  0xa,  0x4e, 0x24, 0x64, 0x9,  0x0,  0x5,  0xf9, 0x33, 0x5c, 0xd3, 0x93, 0x19, 0x8,  0x1f, 0x0,  0x1,  0x23,
      0x28, 0xf8, 0x1,  0x92, 0x15, 0x0,  0x3,  0xda, 0x60, 0xa7, 0x17, 0x50, 0x15, 0x0,  0x13, 0x6f, 0xaa, 0xeb, 0x9b,
      0xc8, 0x5e, 0x28, 0xab, 0x28, 0x16, 0xd8, 0xd6, 0x8,  0xe3, 0xa3, 0x44, 0x56, 0xd3, 0xa3, 0x2,  0x0,  0x0,  0x42,
      0xd2, 0x16, 0x0,  0x1e, 0x76, 0xfd, 0x12, 0xc6, 0x7,  0x19, 0x4f, 0xbc, 0xb0, 0xd5, 0x1c, 0x9f, 0xca, 0x1e, 0x8,
      0xf8, 0x67, 0xaa, 0xf3, 0xea, 0x8c, 0x14, 0xb,  0x4,  0x62, 0xf2, 0xcd, 0x87, 0x30, 0x8d, 0x1f, 0x0,  0x1d, 0x14,
      0x9a, 0x5,  0xef, 0xaa, 0xb2, 0xcb, 0x99, 0x55, 0xd0, 0x99, 0x10, 0xe6, 0x92, 0xe2, 0x24, 0xb2, 0x0,  0x22, 0xc6,
      0x3b, 0x39, 0xaf, 0x4d, 0x59, 0x96, 0xd3, 0x49, 0x6d, 0x2,  0x0,  0x0,  0x53, 0xe2, 0x1f, 0x0,  0x6,  0x41, 0x5e,
      0x9b, 0x65, 0x72, 0x9d, 0x0,  0x1,  0x8d, 0x2,  0x0,  0x15, 0x28, 0xe8, 0x6c, 0x93, 0xe7, 0x17, 0x81, 0xbc, 0x36,
      0xcf, 0xe,  0xb6, 0xf4, 0xe1, 0xc1, 0x53, 0xe4, 0x37, 0xb3, 0x7f, 0xdc, 0x2,  0x0,  0x17, 0xf1, 0xa8, 0x0,  0x8f,
      0xe9, 0x6d, 0xb8, 0xa3, 0x2,  0xda, 0x38, 0x9c, 0xfc, 0xfa, 0x69, 0xb8, 0x43, 0xbc, 0x42, 0xa7, 0xc5, 0xe0, 0x41,
      0x2,  0x0,  0x17, 0xb1, 0x73, 0xaa, 0x7b, 0x60, 0x22, 0x65, 0x1e, 0x72, 0x13, 0xd,  0x5b, 0xd7, 0x82, 0x96, 0xc7,
      0x71, 0xfd, 0xd8, 0xdd, 0xe7, 0x3b, 0x16, 0x2,  0x0,  0x1d, 0xfe, 0x2a, 0xa4, 0x0,  0x2e, 0xc6, 0xed, 0xe3, 0x33,
      0x8f, 0x1a, 0xf8, 0xf8, 0xa2, 0x9,  0xa7, 0xa,  0x92, 0xe8, 0xfa, 0x41, 0x4b, 0xea, 0xdc, 0xb2, 0x66, 0xcd, 0xd2,
      0xe2, 0x2,  0x0,  0xf,  0x9f, 0x7d, 0x41, 0x5f, 0xdd, 0x42, 0xbe, 0x8f, 0x35, 0xa,  0x0,  0xba, 0x7a, 0x29, 0x8f,
      0x0,  0x0,  0x12, 0xd,  0x30, 0x11, 0xa,  0xe2, 0x4b, 0xc9, 0xb1, 0x80, 0x1f, 0x3a, 0xed, 0x6f, 0xf1, 0x49, 0xba,
      0x64, 0x7c, 0x2,  0x0,  0x11, 0x51, 0x19, 0xd6, 0x68, 0x22, 0x5f, 0xc4, 0xfd, 0x7a, 0x6,  0xd3, 0x46, 0x37, 0xd3,
      0x44, 0x90, 0x0,  0x1,  0x0,  0x4,  0x29, 0xd5, 0x95, 0x6,  0x2};

  uint8_t buf[477] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x8d};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x28, 0xe8, 0x6c, 0x93, 0xe7, 0x17, 0x81, 0xbc, 0x36, 0xcf, 0xe,
                                     0xb6, 0xf4, 0xe1, 0xc1, 0x53, 0xe4, 0x37, 0xb3, 0x7f, 0xdc};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf1, 0xa8, 0x0,  0x8f, 0xe9, 0x6d, 0xb8, 0xa3, 0x2,  0xda, 0x38, 0x9c,
                                     0xfc, 0xfa, 0x69, 0xb8, 0x43, 0xbc, 0x42, 0xa7, 0xc5, 0xe0, 0x41};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb1, 0x73, 0xaa, 0x7b, 0x60, 0x22, 0x65, 0x1e, 0x72, 0x13, 0xd, 0x5b,
                                     0xd7, 0x82, 0x96, 0xc7, 0x71, 0xfd, 0xd8, 0xdd, 0xe7, 0x3b, 0x16};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xfe, 0x2a, 0xa4, 0x0,  0x2e, 0xc6, 0xed, 0xe3, 0x33, 0x8f,
                                     0x1a, 0xf8, 0xf8, 0xa2, 0x9,  0xa7, 0xa,  0x92, 0xe8, 0xfa,
                                     0x41, 0x4b, 0xea, 0xdc, 0xb2, 0x66, 0xcd, 0xd2, 0xe2};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x9f, 0x7d, 0x41, 0x5f, 0xdd, 0x42, 0xbe, 0x8f,
                                     0x35, 0xa,  0x0,  0xba, 0x7a, 0x29, 0x8f};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd,  0x30, 0x11, 0xa,  0xe2, 0x4b, 0xc9, 0xb1, 0x80,
                                     0x1f, 0x3a, 0xed, 0x6f, 0xf1, 0x49, 0xba, 0x64, 0x7c};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x51, 0x19, 0xd6, 0x68, 0x22, 0x5f, 0xc4, 0xfd, 0x7a,
                                     0x6,  0xd3, 0x46, 0x37, 0xd3, 0x44, 0x90, 0x0};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x29, 0xd5, 0x95, 0x6};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x82, 0x5, 0x6d, 0x97, 0x96, 0x6d, 0x68, 0xe1, 0x48, 0x63, 0xb8, 0xbb, 0xf7};
  uint8_t bytesprops1[] = {0x53, 0x35, 0x31, 0x1d, 0x86, 0xb2, 0xbb, 0x56, 0x40, 0xdd};
  uint8_t bytesprops2[] = {0xcc, 0xc4, 0xa, 0x24, 0x61, 0x2d, 0x4, 0xf3, 0x16, 0x4a, 0xbe};
  uint8_t bytesprops3[] = {0x6a, 0x83, 0xe8, 0xaf, 0x90, 0xd5, 0x70, 0x32, 0xa6, 0xb3, 0xda, 0xa7, 0x82,
                           0x99, 0xc3, 0xf2, 0xcc, 0x4a, 0x8e, 0x54, 0x69, 0xb3, 0x70, 0x4d, 0xa4};
  uint8_t bytesprops4[] = {0x8f, 0x0,  0xfd, 0x98, 0xbe, 0xb3, 0xb, 0xb8, 0xa,
                           0x8f, 0x39, 0xaa, 0xa2, 0x8a, 0xe6, 0x7, 0xfe};
  uint8_t bytesprops5[] = {0xa1, 0xa5, 0xe,  0xbd, 0xad, 0x4,  0xaf, 0x34, 0x5c, 0x6a, 0x77,
                           0x63, 0xb1, 0xc1, 0x16, 0x4a, 0xba, 0xeb, 0xdf, 0x28, 0x23, 0x76};
  uint8_t bytesprops6[] = {0xf9, 0x33, 0x5c, 0xd3, 0x93};
  uint8_t bytesprops7[] = {0x23};
  uint8_t bytesprops8[] = {0xda, 0x60, 0xa7};
  uint8_t bytesprops9[] = {0x6f, 0xaa, 0xeb, 0x9b, 0xc8, 0x5e, 0x28, 0xab, 0x28, 0x16,
                           0xd8, 0xd6, 0x8,  0xe3, 0xa3, 0x44, 0x56, 0xd3, 0xa3};
  uint8_t bytesprops10[] = {0x76, 0xfd, 0x12, 0xc6, 0x7,  0x19, 0x4f, 0xbc, 0xb0, 0xd5, 0x1c, 0x9f, 0xca, 0x1e, 0x8,
                            0xf8, 0x67, 0xaa, 0xf3, 0xea, 0x8c, 0x14, 0xb,  0x4,  0x62, 0xf2, 0xcd, 0x87, 0x30, 0x8d};
  uint8_t bytesprops11[] = {0x14, 0x9a, 0x5, 0xef, 0xaa, 0xb2, 0xcb, 0x99, 0x55, 0xd0, 0x99, 0x10, 0xe6, 0x92, 0xe2,
                            0x24, 0xb2, 0x0, 0x22, 0xc6, 0x3b, 0x39, 0xaf, 0x4d, 0x59, 0x96, 0xd3, 0x49, 0x6d};
  uint8_t bytesprops12[] = {0x41, 0x5e, 0x9b, 0x65, 0x72, 0x9d};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {13, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {10, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {17, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25408}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 253}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 9479}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28451}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 200}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 14824}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4374}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 12}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2638}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 100}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {5, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 8}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {1, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 248}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 146}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {3, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 80}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {19, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 17106}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {30, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21474}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops12}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1318, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4255
// [("\180\179\158\152\140\184\134\243\150\253\DELV\188\SIa\US\207\DEL\234C\tl\186p*M\209\246\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("/\140^\ESC#\181^Ia%o\229mJ\166XA\DELA\183l;S_l\133^",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\159\&8\162\SYN\188\181",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\253\&9-\SOH\n\189\207\219",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1})] [PropServerKeepAlive 10210,PropServerReference "",PropAuthenticationMethod
// "\210A\184>i:\DC3X\235\203\ESC\ESC]\SO\254\a\249\137\150\195[\176\136D\161\254u~",PropServerReference
// "\234\166'\198\222\235\EM\232\216\167\174\156\&4\182b7\r2\ETB\\\231JPj\DC4\ACK\194K",PropResponseTopic
// "\131L\NAK\157\240)\SI\FS\241\234\184\146m",PropSharedSubscriptionAvailable 213,PropRequestResponseInformation
// 75,PropAuthenticationMethod "\USjH\219\193\175",PropReceiveMaximum 4502,PropSubscriptionIdentifier 20,PropTopicAlias
// 4861,PropCorrelationData "\226=\243Q\226\154\204/`0",PropResponseInformation "<\195u",PropSharedSubscriptionAvailable
// 229,PropSubscriptionIdentifierAvailable 37,PropSubscriptionIdentifierAvailable 148,PropAuthenticationMethod
// "\145r.\DC4\164\219\&4\133\170\150\NUL",PropSessionExpiryInterval 1927,PropTopicAliasMaximum 12840,PropResponseTopic
// "\251$4\141ye\202\216",PropReceiveMaximum 29338,PropSubscriptionIdentifierAvailable 0,PropSessionExpiryInterval
// 9070,PropRetainAvailable 159,PropCorrelationData "\US\251\187R{\203\133B\146\206"]
TEST(Subscribe5QCTest, Encode8) {
  uint8_t pkt[] = {
      0x82, 0x92, 0x2,  0x10, 0x9f, 0xbc, 0x1,  0x13, 0x27, 0xe2, 0x1c, 0x0,  0x0,  0x15, 0x0,  0x1c, 0xd2, 0x41, 0xb8,
      0x3e, 0x69, 0x3a, 0x13, 0x58, 0xeb, 0xcb, 0x1b, 0x1b, 0x5d, 0xe,  0xfe, 0x7,  0xf9, 0x89, 0x96, 0xc3, 0x5b, 0xb0,
      0x88, 0x44, 0xa1, 0xfe, 0x75, 0x7e, 0x1c, 0x0,  0x1c, 0xea, 0xa6, 0x27, 0xc6, 0xde, 0xeb, 0x19, 0xe8, 0xd8, 0xa7,
      0xae, 0x9c, 0x34, 0xb6, 0x62, 0x37, 0xd,  0x32, 0x17, 0x5c, 0xe7, 0x4a, 0x50, 0x6a, 0x14, 0x6,  0xc2, 0x4b, 0x8,
      0x0,  0xd,  0x83, 0x4c, 0x15, 0x9d, 0xf0, 0x29, 0xf,  0x1c, 0xf1, 0xea, 0xb8, 0x92, 0x6d, 0x2a, 0xd5, 0x19, 0x4b,
      0x15, 0x0,  0x6,  0x1f, 0x6a, 0x48, 0xdb, 0xc1, 0xaf, 0x21, 0x11, 0x96, 0xb,  0x14, 0x23, 0x12, 0xfd, 0x9,  0x0,
      0xa,  0xe2, 0x3d, 0xf3, 0x51, 0xe2, 0x9a, 0xcc, 0x2f, 0x60, 0x30, 0x1a, 0x0,  0x3,  0x3c, 0xc3, 0x75, 0x2a, 0xe5,
      0x29, 0x25, 0x29, 0x94, 0x15, 0x0,  0xb,  0x91, 0x72, 0x2e, 0x14, 0xa4, 0xdb, 0x34, 0x85, 0xaa, 0x96, 0x0,  0x11,
      0x0,  0x0,  0x7,  0x87, 0x22, 0x32, 0x28, 0x8,  0x0,  0x8,  0xfb, 0x24, 0x34, 0x8d, 0x79, 0x65, 0xca, 0xd8, 0x21,
      0x72, 0x9a, 0x29, 0x0,  0x11, 0x0,  0x0,  0x23, 0x6e, 0x25, 0x9f, 0x9,  0x0,  0xa,  0x1f, 0xfb, 0xbb, 0x52, 0x7b,
      0xcb, 0x85, 0x42, 0x92, 0xce, 0x0,  0x1d, 0xb4, 0xb3, 0x9e, 0x98, 0x8c, 0xb8, 0x86, 0xf3, 0x96, 0xfd, 0x7f, 0x56,
      0xbc, 0xf,  0x61, 0x1f, 0xcf, 0x7f, 0xea, 0x43, 0x9,  0x6c, 0xba, 0x70, 0x2a, 0x4d, 0xd1, 0xf6, 0xa2, 0x0,  0x0,
      0x1b, 0x2f, 0x8c, 0x5e, 0x1b, 0x23, 0xb5, 0x5e, 0x49, 0x61, 0x25, 0x6f, 0xe5, 0x6d, 0x4a, 0xa6, 0x58, 0x41, 0x7f,
      0x41, 0xb7, 0x6c, 0x3b, 0x53, 0x5f, 0x6c, 0x85, 0x5e, 0x0,  0x0,  0x6,  0x9f, 0x38, 0xa2, 0x16, 0xbc, 0xb5, 0x1,
      0x0,  0x8,  0xfd, 0x39, 0x2d, 0x1,  0xa,  0xbd, 0xcf, 0xdb, 0x1};

  uint8_t buf[287] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xb4, 0xb3, 0x9e, 0x98, 0x8c, 0xb8, 0x86, 0xf3, 0x96, 0xfd,
                                     0x7f, 0x56, 0xbc, 0xf,  0x61, 0x1f, 0xcf, 0x7f, 0xea, 0x43,
                                     0x9,  0x6c, 0xba, 0x70, 0x2a, 0x4d, 0xd1, 0xf6, 0xa2};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2f, 0x8c, 0x5e, 0x1b, 0x23, 0xb5, 0x5e, 0x49, 0x61, 0x25, 0x6f, 0xe5, 0x6d, 0x4a,
                                     0xa6, 0x58, 0x41, 0x7f, 0x41, 0xb7, 0x6c, 0x3b, 0x53, 0x5f, 0x6c, 0x85, 0x5e};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9f, 0x38, 0xa2, 0x16, 0xbc, 0xb5};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfd, 0x39, 0x2d, 0x1, 0xa, 0xbd, 0xcf, 0xdb};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0xd2, 0x41, 0xb8, 0x3e, 0x69, 0x3a, 0x13, 0x58, 0xeb, 0xcb, 0x1b, 0x1b, 0x5d, 0xe,
                           0xfe, 0x7,  0xf9, 0x89, 0x96, 0xc3, 0x5b, 0xb0, 0x88, 0x44, 0xa1, 0xfe, 0x75, 0x7e};
  uint8_t bytesprops2[] = {0xea, 0xa6, 0x27, 0xc6, 0xde, 0xeb, 0x19, 0xe8, 0xd8, 0xa7, 0xae, 0x9c, 0x34, 0xb6,
                           0x62, 0x37, 0xd,  0x32, 0x17, 0x5c, 0xe7, 0x4a, 0x50, 0x6a, 0x14, 0x6,  0xc2, 0x4b};
  uint8_t bytesprops3[] = {0x83, 0x4c, 0x15, 0x9d, 0xf0, 0x29, 0xf, 0x1c, 0xf1, 0xea, 0xb8, 0x92, 0x6d};
  uint8_t bytesprops4[] = {0x1f, 0x6a, 0x48, 0xdb, 0xc1, 0xaf};
  uint8_t bytesprops5[] = {0xe2, 0x3d, 0xf3, 0x51, 0xe2, 0x9a, 0xcc, 0x2f, 0x60, 0x30};
  uint8_t bytesprops6[] = {0x3c, 0xc3, 0x75};
  uint8_t bytesprops7[] = {0x91, 0x72, 0x2e, 0x14, 0xa4, 0xdb, 0x34, 0x85, 0xaa, 0x96, 0x0};
  uint8_t bytesprops8[] = {0xfb, 0x24, 0x34, 0x8d, 0x79, 0x65, 0xca, 0xd8};
  uint8_t bytesprops9[] = {0x1f, 0xfb, 0xbb, 0x52, 0x7b, 0xcb, 0x85, 0x42, 0x92, 0xce};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 10210}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {28, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {13, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 75}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {6, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 4502}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 20}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4861}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {3, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 229}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 37}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 148}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 1927}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 12840}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29338}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 0}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9070}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 159}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops9}}},
  };

  lwmqtt_properties_t props = {25, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4255, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8790 [("BZ_)",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\244x\187\186\255\245oy\163<\181\242J3\202-",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("'8\171[\231\210\133\201\GSP\238\199\163'\182bO@\226\RS?\SO@\244uRA\SI2",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("W\239\192\&2\217\184?\141\&7\FSL",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\200h\214",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\187\DC2\tI\174\251I\ETB\FS\NAK\148\DC4\136Je\193|\216V)j",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})]
// [PropResponseTopic "\"k\179G\190w1\150\208\185\FS\155S\250i\146\220\EMR",PropAuthenticationMethod
// "w\199\142\212\ACK$\129l\156\143\206\245\134r\144o\176\204\228\169",PropReceiveMaximum
// 28238,PropPayloadFormatIndicator 218,PropAuthenticationMethod "\172\160\143\182\169q\221",PropTopicAlias
// 7951,PropServerReference
// "\168\160*\DC3\152=L|\151\136A\f\ESCz\153NKJ!\133W\178H\241\167\174",PropSubscriptionIdentifierAvailable
// 83,PropCorrelationData "",PropWildcardSubscriptionAvailable 184,PropWillDelayInterval
// 30166,PropPayloadFormatIndicator 91,PropAssignedClientIdentifier
// "\162@\168\DC3\137#\DC1\136`I\183",PropWildcardSubscriptionAvailable 60,PropResponseInformation
// "`<\231\128f\183i\149bUp\EMt\\ \147W\222\220\234\aYq>\217\192\159\161",PropReceiveMaximum
// 8969,PropRequestProblemInformation 202,PropUserProperty "\r\128\DLE\254ts\\3\US\CAN\197\196\241\200"
// "l\RS\145\143,\147\224\245\ESCT\CAN\174\DC2k7\r\SOH\146\247\173\DC3\221-",PropCorrelationData
// "\r\DC3\233\240s\DC2\227\ETBf\RS\142\"\189\161\173\226\&1T\173\199\138\171\243\217\179\213\206",PropUserProperty
// "\192-\SI9\243t\224\&7\130\156{\222\144\179\247\199JZT\176" "\149",PropTopicAlias 26691,PropAssignedClientIdentifier
// "\218u\205H9pV%\142\163M\NUL\233\129\184\139*\138jk!\ESC\192a",PropWillDelayInterval 24054,PropWillDelayInterval
// 8523,PropAuthenticationData "\145\GS\RS\238\DC4\228t\243\225\217\v\f",PropAuthenticationData
// "?\239\197\219mF[\215.\228\236\158\250\NAKT~\SOH&\235\159\DC3"]
TEST(Subscribe5QCTest, Encode9) {
  uint8_t pkt[] = {
      0x82, 0xb9, 0x3,  0x22, 0x56, 0xcf, 0x2,  0x8,  0x0,  0x13, 0x22, 0x6b, 0xb3, 0x47, 0xbe, 0x77, 0x31, 0x96, 0xd0,
      0xb9, 0x1c, 0x9b, 0x53, 0xfa, 0x69, 0x92, 0xdc, 0x19, 0x52, 0x15, 0x0,  0x14, 0x77, 0xc7, 0x8e, 0xd4, 0x6,  0x24,
      0x81, 0x6c, 0x9c, 0x8f, 0xce, 0xf5, 0x86, 0x72, 0x90, 0x6f, 0xb0, 0xcc, 0xe4, 0xa9, 0x21, 0x6e, 0x4e, 0x1,  0xda,
      0x15, 0x0,  0x7,  0xac, 0xa0, 0x8f, 0xb6, 0xa9, 0x71, 0xdd, 0x23, 0x1f, 0xf,  0x1c, 0x0,  0x1a, 0xa8, 0xa0, 0x2a,
      0x13, 0x98, 0x3d, 0x4c, 0x7c, 0x97, 0x88, 0x41, 0xc,  0x1b, 0x7a, 0x99, 0x4e, 0x4b, 0x4a, 0x21, 0x85, 0x57, 0xb2,
      0x48, 0xf1, 0xa7, 0xae, 0x29, 0x53, 0x9,  0x0,  0x0,  0x28, 0xb8, 0x18, 0x0,  0x0,  0x75, 0xd6, 0x1,  0x5b, 0x12,
      0x0,  0xb,  0xa2, 0x40, 0xa8, 0x13, 0x89, 0x23, 0x11, 0x88, 0x60, 0x49, 0xb7, 0x28, 0x3c, 0x1a, 0x0,  0x1c, 0x60,
      0x3c, 0xe7, 0x80, 0x66, 0xb7, 0x69, 0x95, 0x62, 0x55, 0x70, 0x19, 0x74, 0x5c, 0x20, 0x93, 0x57, 0xde, 0xdc, 0xea,
      0x7,  0x59, 0x71, 0x3e, 0xd9, 0xc0, 0x9f, 0xa1, 0x21, 0x23, 0x9,  0x17, 0xca, 0x26, 0x0,  0xe,  0xd,  0x80, 0x10,
      0xfe, 0x74, 0x73, 0x5c, 0x33, 0x1f, 0x18, 0xc5, 0xc4, 0xf1, 0xc8, 0x0,  0x17, 0x6c, 0x1e, 0x91, 0x8f, 0x2c, 0x93,
      0xe0, 0xf5, 0x1b, 0x54, 0x18, 0xae, 0x12, 0x6b, 0x37, 0xd,  0x1,  0x92, 0xf7, 0xad, 0x13, 0xdd, 0x2d, 0x9,  0x0,
      0x1b, 0xd,  0x13, 0xe9, 0xf0, 0x73, 0x12, 0xe3, 0x17, 0x66, 0x1e, 0x8e, 0x22, 0xbd, 0xa1, 0xad, 0xe2, 0x31, 0x54,
      0xad, 0xc7, 0x8a, 0xab, 0xf3, 0xd9, 0xb3, 0xd5, 0xce, 0x26, 0x0,  0x14, 0xc0, 0x2d, 0xf,  0x39, 0xf3, 0x74, 0xe0,
      0x37, 0x82, 0x9c, 0x7b, 0xde, 0x90, 0xb3, 0xf7, 0xc7, 0x4a, 0x5a, 0x54, 0xb0, 0x0,  0x1,  0x95, 0x23, 0x68, 0x43,
      0x12, 0x0,  0x18, 0xda, 0x75, 0xcd, 0x48, 0x39, 0x70, 0x56, 0x25, 0x8e, 0xa3, 0x4d, 0x0,  0xe9, 0x81, 0xb8, 0x8b,
      0x2a, 0x8a, 0x6a, 0x6b, 0x21, 0x1b, 0xc0, 0x61, 0x18, 0x0,  0x0,  0x5d, 0xf6, 0x18, 0x0,  0x0,  0x21, 0x4b, 0x16,
      0x0,  0xc,  0x91, 0x1d, 0x1e, 0xee, 0x14, 0xe4, 0x74, 0xf3, 0xe1, 0xd9, 0xb,  0xc,  0x16, 0x0,  0x15, 0x3f, 0xef,
      0xc5, 0xdb, 0x6d, 0x46, 0x5b, 0xd7, 0x2e, 0xe4, 0xec, 0x9e, 0xfa, 0x15, 0x54, 0x7e, 0x1,  0x26, 0xeb, 0x9f, 0x13,
      0x0,  0x4,  0x42, 0x5a, 0x5f, 0x29, 0x0,  0x0,  0x10, 0xf4, 0x78, 0xbb, 0xba, 0xff, 0xf5, 0x6f, 0x79, 0xa3, 0x3c,
      0xb5, 0xf2, 0x4a, 0x33, 0xca, 0x2d, 0x0,  0x0,  0x1d, 0x27, 0x38, 0xab, 0x5b, 0xe7, 0xd2, 0x85, 0xc9, 0x1d, 0x50,
      0xee, 0xc7, 0xa3, 0x27, 0xb6, 0x62, 0x4f, 0x40, 0xe2, 0x1e, 0x3f, 0xe,  0x40, 0xf4, 0x75, 0x52, 0x41, 0xf,  0x32,
      0x2,  0x0,  0xb,  0x57, 0xef, 0xc0, 0x32, 0xd9, 0xb8, 0x3f, 0x8d, 0x37, 0x1c, 0x4c, 0x2,  0x0,  0x3,  0xc8, 0x68,
      0xd6, 0x0,  0x0,  0x15, 0xbb, 0x12, 0x9,  0x49, 0xae, 0xfb, 0x49, 0x17, 0x1c, 0x15, 0x94, 0x14, 0x88, 0x4a, 0x65,
      0xc1, 0x7c, 0xd8, 0x56, 0x29, 0x6a, 0x0};

  uint8_t buf[454] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x42, 0x5a, 0x5f, 0x29};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf4, 0x78, 0xbb, 0xba, 0xff, 0xf5, 0x6f, 0x79,
                                     0xa3, 0x3c, 0xb5, 0xf2, 0x4a, 0x33, 0xca, 0x2d};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x27, 0x38, 0xab, 0x5b, 0xe7, 0xd2, 0x85, 0xc9, 0x1d, 0x50,
                                     0xee, 0xc7, 0xa3, 0x27, 0xb6, 0x62, 0x4f, 0x40, 0xe2, 0x1e,
                                     0x3f, 0xe,  0x40, 0xf4, 0x75, 0x52, 0x41, 0xf,  0x32};
  lwmqtt_string_t topic_filter_s2 = {29, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x57, 0xef, 0xc0, 0x32, 0xd9, 0xb8, 0x3f, 0x8d, 0x37, 0x1c, 0x4c};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc8, 0x68, 0xd6};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xbb, 0x12, 0x9,  0x49, 0xae, 0xfb, 0x49, 0x17, 0x1c, 0x15, 0x94,
                                     0x14, 0x88, 0x4a, 0x65, 0xc1, 0x7c, 0xd8, 0x56, 0x29, 0x6a};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x22, 0x6b, 0xb3, 0x47, 0xbe, 0x77, 0x31, 0x96, 0xd0, 0xb9,
                           0x1c, 0x9b, 0x53, 0xfa, 0x69, 0x92, 0xdc, 0x19, 0x52};
  uint8_t bytesprops1[] = {0x77, 0xc7, 0x8e, 0xd4, 0x6,  0x24, 0x81, 0x6c, 0x9c, 0x8f,
                           0xce, 0xf5, 0x86, 0x72, 0x90, 0x6f, 0xb0, 0xcc, 0xe4, 0xa9};
  uint8_t bytesprops2[] = {0xac, 0xa0, 0x8f, 0xb6, 0xa9, 0x71, 0xdd};
  uint8_t bytesprops3[] = {0xa8, 0xa0, 0x2a, 0x13, 0x98, 0x3d, 0x4c, 0x7c, 0x97, 0x88, 0x41, 0xc,  0x1b,
                           0x7a, 0x99, 0x4e, 0x4b, 0x4a, 0x21, 0x85, 0x57, 0xb2, 0x48, 0xf1, 0xa7, 0xae};
  uint8_t bytesprops4[] = {0};
  uint8_t bytesprops5[] = {0xa2, 0x40, 0xa8, 0x13, 0x89, 0x23, 0x11, 0x88, 0x60, 0x49, 0xb7};
  uint8_t bytesprops6[] = {0x60, 0x3c, 0xe7, 0x80, 0x66, 0xb7, 0x69, 0x95, 0x62, 0x55, 0x70, 0x19, 0x74, 0x5c,
                           0x20, 0x93, 0x57, 0xde, 0xdc, 0xea, 0x7,  0x59, 0x71, 0x3e, 0xd9, 0xc0, 0x9f, 0xa1};
  uint8_t bytesprops8[] = {0x6c, 0x1e, 0x91, 0x8f, 0x2c, 0x93, 0xe0, 0xf5, 0x1b, 0x54, 0x18, 0xae,
                           0x12, 0x6b, 0x37, 0xd,  0x1,  0x92, 0xf7, 0xad, 0x13, 0xdd, 0x2d};
  uint8_t bytesprops7[] = {0xd, 0x80, 0x10, 0xfe, 0x74, 0x73, 0x5c, 0x33, 0x1f, 0x18, 0xc5, 0xc4, 0xf1, 0xc8};
  uint8_t bytesprops9[] = {0xd,  0x13, 0xe9, 0xf0, 0x73, 0x12, 0xe3, 0x17, 0x66, 0x1e, 0x8e, 0x22, 0xbd, 0xa1,
                           0xad, 0xe2, 0x31, 0x54, 0xad, 0xc7, 0x8a, 0xab, 0xf3, 0xd9, 0xb3, 0xd5, 0xce};
  uint8_t bytesprops11[] = {0x95};
  uint8_t bytesprops10[] = {0xc0, 0x2d, 0xf,  0x39, 0xf3, 0x74, 0xe0, 0x37, 0x82, 0x9c,
                            0x7b, 0xde, 0x90, 0xb3, 0xf7, 0xc7, 0x4a, 0x5a, 0x54, 0xb0};
  uint8_t bytesprops12[] = {0xda, 0x75, 0xcd, 0x48, 0x39, 0x70, 0x56, 0x25, 0x8e, 0xa3, 0x4d, 0x0,
                            0xe9, 0x81, 0xb8, 0x8b, 0x2a, 0x8a, 0x6a, 0x6b, 0x21, 0x1b, 0xc0, 0x61};
  uint8_t bytesprops13[] = {0x91, 0x1d, 0x1e, 0xee, 0x14, 0xe4, 0x74, 0xf3, 0xe1, 0xd9, 0xb, 0xc};
  uint8_t bytesprops14[] = {0x3f, 0xef, 0xc5, 0xdb, 0x6d, 0x46, 0x5b, 0xd7, 0x2e, 0xe4, 0xec,
                            0x9e, 0xfa, 0x15, 0x54, 0x7e, 0x1,  0x26, 0xeb, 0x9f, 0x13};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 28238}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 218}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7951}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 83}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 184}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 30166}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 91}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 60}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 8969}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 202}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {14, (char*)&bytesprops7}, .v = {23, (char*)&bytesprops8}}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {27, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {20, (char*)&bytesprops10}, .v = {1, (char*)&bytesprops11}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 26691}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 24054}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 8523}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops13}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {21, (char*)&bytesprops14}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 8790, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28419 [("\172\146\187b\165\234\194\249&",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("&\154ju i",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\196\DC4\v\a\177\139Fn\195",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("m\205\237M\200/\184hq79.3\134,\188\154\r\211\201\143\CAN\223\SYN
// \200v\164<",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ENQ\241`\255\207+~",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] [PropReasonString "G\DLE#\178\SUB\\W\139\169\&3\ENQl\EOT\206\193\201\181yl",PropMaximumQoS
// 233,PropWillDelayInterval 7767,PropSubscriptionIdentifier 19,PropMaximumQoS 119,PropWillDelayInterval
// 5694,PropWillDelayInterval 9243,PropAssignedClientIdentifier
// "l\183\"\142Ss\NAKwH#\210\254\211\132\210\229\143\198\190\246\241\229",PropRetainAvailable 16,PropUserProperty
// "\155pJ\\'M/@\EOT\NUL\207\216\DC1.\214\&0" "<)X\219'T{\"_#\206",PropTopicAliasMaximum 8705,PropMaximumPacketSize
// 18115,PropRequestResponseInformation 36,PropCorrelationData "Q\n\n\229\&6\193\169\140X^\191y",PropMaximumPacketSize
// 10019,PropRequestResponseInformation 189,PropServerKeepAlive 28101,PropTopicAliasMaximum 32452]
TEST(Subscribe5QCTest, Encode10) {
  uint8_t pkt[] = {
      0x82, 0xdb, 0x1,  0x6f, 0x3,  0x8c, 0x1,  0x1f, 0x0,  0x13, 0x47, 0x10, 0x23, 0xb2, 0x1a, 0x5c, 0x57, 0x8b, 0xa9,
      0x33, 0x5,  0x6c, 0x4,  0xce, 0xc1, 0xc9, 0xb5, 0x79, 0x6c, 0x24, 0xe9, 0x18, 0x0,  0x0,  0x1e, 0x57, 0xb,  0x13,
      0x24, 0x77, 0x18, 0x0,  0x0,  0x16, 0x3e, 0x18, 0x0,  0x0,  0x24, 0x1b, 0x12, 0x0,  0x16, 0x6c, 0xb7, 0x22, 0x8e,
      0x53, 0x73, 0x15, 0x77, 0x48, 0x23, 0xd2, 0xfe, 0xd3, 0x84, 0xd2, 0xe5, 0x8f, 0xc6, 0xbe, 0xf6, 0xf1, 0xe5, 0x25,
      0x10, 0x26, 0x0,  0x10, 0x9b, 0x70, 0x4a, 0x5c, 0x27, 0x4d, 0x2f, 0x40, 0x4,  0x0,  0xcf, 0xd8, 0x11, 0x2e, 0xd6,
      0x30, 0x0,  0xb,  0x3c, 0x29, 0x58, 0xdb, 0x27, 0x54, 0x7b, 0x22, 0x5f, 0x23, 0xce, 0x22, 0x22, 0x1,  0x27, 0x0,
      0x0,  0x46, 0xc3, 0x19, 0x24, 0x9,  0x0,  0xc,  0x51, 0xa,  0xa,  0xe5, 0x36, 0xc1, 0xa9, 0x8c, 0x58, 0x5e, 0xbf,
      0x79, 0x27, 0x0,  0x0,  0x27, 0x23, 0x19, 0xbd, 0x13, 0x6d, 0xc5, 0x22, 0x7e, 0xc4, 0x0,  0x9,  0xac, 0x92, 0xbb,
      0x62, 0xa5, 0xea, 0xc2, 0xf9, 0x26, 0x0,  0x0,  0x6,  0x26, 0x9a, 0x6a, 0x75, 0x20, 0x69, 0x1,  0x0,  0x9,  0xc4,
      0x14, 0xb,  0x7,  0xb1, 0x8b, 0x46, 0x6e, 0xc3, 0x1,  0x0,  0x1d, 0x6d, 0xcd, 0xed, 0x4d, 0xc8, 0x2f, 0xb8, 0x68,
      0x71, 0x37, 0x39, 0x2e, 0x33, 0x86, 0x2c, 0xbc, 0x9a, 0xd,  0xd3, 0xc9, 0x8f, 0x18, 0xdf, 0x16, 0x20, 0xc8, 0x76,
      0xa4, 0x3c, 0x1,  0x0,  0x7,  0x5,  0xf1, 0x60, 0xff, 0xcf, 0x2b, 0x7e, 0x1};

  uint8_t buf[232] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xac, 0x92, 0xbb, 0x62, 0xa5, 0xea, 0xc2, 0xf9, 0x26};
  lwmqtt_string_t topic_filter_s0 = {9, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x26, 0x9a, 0x6a, 0x75, 0x20, 0x69};
  lwmqtt_string_t topic_filter_s1 = {6, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc4, 0x14, 0xb, 0x7, 0xb1, 0x8b, 0x46, 0x6e, 0xc3};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6d, 0xcd, 0xed, 0x4d, 0xc8, 0x2f, 0xb8, 0x68, 0x71, 0x37,
                                     0x39, 0x2e, 0x33, 0x86, 0x2c, 0xbc, 0x9a, 0xd,  0xd3, 0xc9,
                                     0x8f, 0x18, 0xdf, 0x16, 0x20, 0xc8, 0x76, 0xa4, 0x3c};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x5, 0xf1, 0x60, 0xff, 0xcf, 0x2b, 0x7e};
  lwmqtt_string_t topic_filter_s4 = {7, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x47, 0x10, 0x23, 0xb2, 0x1a, 0x5c, 0x57, 0x8b, 0xa9, 0x33,
                           0x5,  0x6c, 0x4,  0xce, 0xc1, 0xc9, 0xb5, 0x79, 0x6c};
  uint8_t bytesprops1[] = {0x6c, 0xb7, 0x22, 0x8e, 0x53, 0x73, 0x15, 0x77, 0x48, 0x23, 0xd2,
                           0xfe, 0xd3, 0x84, 0xd2, 0xe5, 0x8f, 0xc6, 0xbe, 0xf6, 0xf1, 0xe5};
  uint8_t bytesprops3[] = {0x3c, 0x29, 0x58, 0xdb, 0x27, 0x54, 0x7b, 0x22, 0x5f, 0x23, 0xce};
  uint8_t bytesprops2[] = {0x9b, 0x70, 0x4a, 0x5c, 0x27, 0x4d, 0x2f, 0x40,
                           0x4,  0x0,  0xcf, 0xd8, 0x11, 0x2e, 0xd6, 0x30};
  uint8_t bytesprops4[] = {0x51, 0xa, 0xa, 0xe5, 0x36, 0xc1, 0xa9, 0x8c, 0x58, 0x5e, 0xbf, 0x79};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 233}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 7767}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 19}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 119}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 5694}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 9243}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 16}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {16, (char*)&bytesprops2}, .v = {11, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 8705}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18115}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 36}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10019}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 189}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 28101}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32452}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 28419, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 5081 [("Zq\ETB\209",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS0}),("\254\248\251$\238\158f\176\218\152\154A\147\STX^\184'w\188\&2{\US\165I\vF\139",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\164\143V*3\253\171\214\141x.\184\242l\217\&2\255\ENQ",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\171E\173\162L\158>9\a\202\138\223Jb{\170Y8\RS\137\226\166I\177J",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\185\188",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropTopicAlias
// 10841,PropContentType "c\166;3\224\143\205\145s/~\212\185K",PropReasonString
// "\182m\218-L\210\146\166\GS|\DC1\165)8\238\192\172g\184\137\167z\168\248\211U",PropServerReference
// "\133\129\239\146",PropRequestResponseInformation 196,PropCorrelationData
// ",kk\NUL\234\211\CAN\159Y\185\&5\164R\162",PropRetainAvailable 165,PropResponseTopic
// "\179\215\177\DEL\r\249\170\tI\253b@\184\195\246\143\193\194<`\EM8r\ENQ\160",PropSharedSubscriptionAvailable
// 69,PropSharedSubscriptionAvailable 119,PropRequestResponseInformation 58,PropMessageExpiryInterval
// 12503,PropReasonString "\133\131\212\&7\153\246\&0",PropContentType
// "\167E'Z\209*\144\ETXC",PropPayloadFormatIndicator 38,PropContentType
// "\145^\201(0\SYN\174\188\198A\SUBfl,\139\&2_\230\233NRy\205\255\249b\160\155\176",PropTopicAlias
// 1094,PropRequestResponseInformation 213,PropReasonString "vwj%+
// \140\150\NAK\231\248\187+\130\210\&2j\NAK\168\b\189y",PropWildcardSubscriptionAvailable 155,PropMessageExpiryInterval
// 31491]
TEST(Subscribe5QCTest, Encode11) {
  uint8_t pkt[] = {
      0x82, 0xb3, 0x2,  0x13, 0xd9, 0xd1, 0x1,  0x23, 0x2a, 0x59, 0x3,  0x0,  0xe,  0x63, 0xa6, 0x3b, 0x33, 0xe0, 0x8f,
      0xcd, 0x91, 0x73, 0x2f, 0x7e, 0xd4, 0xb9, 0x4b, 0x1f, 0x0,  0x1a, 0xb6, 0x6d, 0xda, 0x2d, 0x4c, 0xd2, 0x92, 0xa6,
      0x1d, 0x7c, 0x11, 0xa5, 0x29, 0x38, 0xee, 0xc0, 0xac, 0x67, 0xb8, 0x89, 0xa7, 0x7a, 0xa8, 0xf8, 0xd3, 0x55, 0x1c,
      0x0,  0x4,  0x85, 0x81, 0xef, 0x92, 0x19, 0xc4, 0x9,  0x0,  0xe,  0x2c, 0x6b, 0x6b, 0x0,  0xea, 0xd3, 0x18, 0x9f,
      0x59, 0xb9, 0x35, 0xa4, 0x52, 0xa2, 0x25, 0xa5, 0x8,  0x0,  0x19, 0xb3, 0xd7, 0xb1, 0x7f, 0xd,  0xf9, 0xaa, 0x9,
      0x49, 0xfd, 0x62, 0x40, 0xb8, 0xc3, 0xf6, 0x8f, 0xc1, 0xc2, 0x3c, 0x60, 0x19, 0x38, 0x72, 0x5,  0xa0, 0x2a, 0x45,
      0x2a, 0x77, 0x19, 0x3a, 0x2,  0x0,  0x0,  0x30, 0xd7, 0x1f, 0x0,  0x7,  0x85, 0x83, 0xd4, 0x37, 0x99, 0xf6, 0x30,
      0x3,  0x0,  0x9,  0xa7, 0x45, 0x27, 0x5a, 0xd1, 0x2a, 0x90, 0x3,  0x43, 0x1,  0x26, 0x3,  0x0,  0x1d, 0x91, 0x5e,
      0xc9, 0x28, 0x30, 0x16, 0xae, 0xbc, 0xc6, 0x41, 0x1a, 0x66, 0x6c, 0x2c, 0x8b, 0x32, 0x5f, 0xe6, 0xe9, 0x4e, 0x52,
      0x79, 0xcd, 0xff, 0xf9, 0x62, 0xa0, 0x9b, 0xb0, 0x23, 0x4,  0x46, 0x19, 0xd5, 0x1f, 0x0,  0x16, 0x76, 0x77, 0x6a,
      0x25, 0x2b, 0x20, 0x8c, 0x96, 0x15, 0xe7, 0xf8, 0xbb, 0x2b, 0x82, 0xd2, 0x32, 0x6a, 0x15, 0xa8, 0x8,  0xbd, 0x79,
      0x28, 0x9b, 0x2,  0x0,  0x0,  0x7b, 0x3,  0x0,  0x4,  0x5a, 0x71, 0x17, 0xd1, 0x0,  0x0,  0x1b, 0xfe, 0xf8, 0xfb,
      0x24, 0xee, 0x9e, 0x66, 0xb0, 0xda, 0x98, 0x9a, 0x41, 0x93, 0x2,  0x5e, 0xb8, 0x27, 0x77, 0xbc, 0x32, 0x7b, 0x1f,
      0xa5, 0x49, 0xb,  0x46, 0x8b, 0x1,  0x0,  0x12, 0xa4, 0x8f, 0x56, 0x2a, 0x33, 0xfd, 0xab, 0xd6, 0x8d, 0x78, 0x2e,
      0xb8, 0xf2, 0x6c, 0xd9, 0x32, 0xff, 0x5,  0x1,  0x0,  0x19, 0xab, 0x45, 0xad, 0xa2, 0x4c, 0x9e, 0x3e, 0x39, 0x7,
      0xca, 0x8a, 0xdf, 0x4a, 0x62, 0x7b, 0xaa, 0x59, 0x38, 0x1e, 0x89, 0xe2, 0xa6, 0x49, 0xb1, 0x4a, 0x2,  0x0,  0x2,
      0xb9, 0xbc, 0x2,  0x0,  0x0,  0x1};

  uint8_t buf[320] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x5a, 0x71, 0x17, 0xd1};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xfe, 0xf8, 0xfb, 0x24, 0xee, 0x9e, 0x66, 0xb0, 0xda, 0x98, 0x9a, 0x41, 0x93, 0x2,
                                     0x5e, 0xb8, 0x27, 0x77, 0xbc, 0x32, 0x7b, 0x1f, 0xa5, 0x49, 0xb,  0x46, 0x8b};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa4, 0x8f, 0x56, 0x2a, 0x33, 0xfd, 0xab, 0xd6, 0x8d,
                                     0x78, 0x2e, 0xb8, 0xf2, 0x6c, 0xd9, 0x32, 0xff, 0x5};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xab, 0x45, 0xad, 0xa2, 0x4c, 0x9e, 0x3e, 0x39, 0x7,  0xca, 0x8a, 0xdf, 0x4a,
                                     0x62, 0x7b, 0xaa, 0x59, 0x38, 0x1e, 0x89, 0xe2, 0xa6, 0x49, 0xb1, 0x4a};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xb9, 0xbc};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0};
  lwmqtt_string_t topic_filter_s5 = {0, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x63, 0xa6, 0x3b, 0x33, 0xe0, 0x8f, 0xcd, 0x91, 0x73, 0x2f, 0x7e, 0xd4, 0xb9, 0x4b};
  uint8_t bytesprops1[] = {0xb6, 0x6d, 0xda, 0x2d, 0x4c, 0xd2, 0x92, 0xa6, 0x1d, 0x7c, 0x11, 0xa5, 0x29,
                           0x38, 0xee, 0xc0, 0xac, 0x67, 0xb8, 0x89, 0xa7, 0x7a, 0xa8, 0xf8, 0xd3, 0x55};
  uint8_t bytesprops2[] = {0x85, 0x81, 0xef, 0x92};
  uint8_t bytesprops3[] = {0x2c, 0x6b, 0x6b, 0x0, 0xea, 0xd3, 0x18, 0x9f, 0x59, 0xb9, 0x35, 0xa4, 0x52, 0xa2};
  uint8_t bytesprops4[] = {0xb3, 0xd7, 0xb1, 0x7f, 0xd,  0xf9, 0xaa, 0x9,  0x49, 0xfd, 0x62, 0x40, 0xb8,
                           0xc3, 0xf6, 0x8f, 0xc1, 0xc2, 0x3c, 0x60, 0x19, 0x38, 0x72, 0x5,  0xa0};
  uint8_t bytesprops5[] = {0x85, 0x83, 0xd4, 0x37, 0x99, 0xf6, 0x30};
  uint8_t bytesprops6[] = {0xa7, 0x45, 0x27, 0x5a, 0xd1, 0x2a, 0x90, 0x3, 0x43};
  uint8_t bytesprops7[] = {0x91, 0x5e, 0xc9, 0x28, 0x30, 0x16, 0xae, 0xbc, 0xc6, 0x41, 0x1a, 0x66, 0x6c, 0x2c, 0x8b,
                           0x32, 0x5f, 0xe6, 0xe9, 0x4e, 0x52, 0x79, 0xcd, 0xff, 0xf9, 0x62, 0xa0, 0x9b, 0xb0};
  uint8_t bytesprops8[] = {0x76, 0x77, 0x6a, 0x25, 0x2b, 0x20, 0x8c, 0x96, 0x15, 0xe7, 0xf8,
                           0xbb, 0x2b, 0x82, 0xd2, 0x32, 0x6a, 0x15, 0xa8, 0x8,  0xbd, 0x79};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10841}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {26, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 196}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 165}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 69}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 119}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 58}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12503}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {7, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {9, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 38}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {29, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1094}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 155}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31491}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 5081, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25469 [("\196\234\233C\245\STX\229\154\t\US\r\b&>F\213\130\&4",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("}\ENQ\233z\235\223\134Z\220y\220\255\ACK\f8\r\211\178\171\145=\183\148\DC4\187{S:\215\247",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("SL0j\ENQ\STX\v\178\243,\155\168-3\RS*R\246\NAK\134f)\183\196",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\t\185T\132Z\205GI\DC2\146\156\233\201\134k\142\168\247\201=\179\134\&1",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\200\160\129\198|>\238\159\254\255\CANc\149\154\139\167#\234n",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\169\216=\154v",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("9\254'\139~\175N\ETX\172\240\223\&5^\171\"\163\222\225*\182\&2,\254\&6\174\EM2\f\227",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("o\SOH\195\158\&0R\138\250",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\EM\SYN\174\218\152k\247\&5i_\205`,\fm*\131_",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\163n)\179A=<\NUL\US\199\129\163\137+u",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] [PropContentType "\155\244\a\DC1\198\244J
// \146\r5\f\201\DC23\204",PropReceiveMaximum 31257,PropResponseInformation
// "$9\154\216\&7\238\DC2\204\252\254Z\209",PropTopicAlias 4733,PropRequestProblemInformation 43,PropResponseInformation
// "x\191S\255\152\DC3\a\139n\175\SOH*]\195\EOT\136\222\177\214:\NUL\130\GS\202",PropAssignedClientIdentifier
// "\253F?\STX?\172\167R\212(\206\213\200\227w\135\204\215\229\235",PropSubscriptionIdentifierAvailable
// 102,PropSessionExpiryInterval 19209,PropMaximumPacketSize 4183,PropContentType "\131\216\229\138",PropRetainAvailable
// 88,PropMaximumQoS 160,PropUserProperty "\210U\EOTm\128"
// "\151\146\212\169\159D}\154n\211x\vYOp\132`M_9\236\216M\221$L",PropWillDelayInterval 13355,PropResponseInformation
// "\199X\SYNK*",PropMessageExpiryInterval 6044,PropPayloadFormatIndicator 175,PropAssignedClientIdentifier
// "\243G\138\f\220\234W\182"]
TEST(Subscribe5QCTest, Encode12) {
  uint8_t pkt[] = {
      0x82, 0x98, 0x3,  0x63, 0x7d, 0xb6, 0x1,  0x3,  0x0,  0x10, 0x9b, 0xf4, 0x7,  0x11, 0xc6, 0xf4, 0x4a, 0x20, 0x92,
      0xd,  0x35, 0xc,  0xc9, 0x12, 0x33, 0xcc, 0x21, 0x7a, 0x19, 0x1a, 0x0,  0xc,  0x24, 0x39, 0x9a, 0xd8, 0x37, 0xee,
      0x12, 0xcc, 0xfc, 0xfe, 0x5a, 0xd1, 0x23, 0x12, 0x7d, 0x17, 0x2b, 0x1a, 0x0,  0x18, 0x78, 0xbf, 0x53, 0xff, 0x98,
      0x13, 0x7,  0x8b, 0x6e, 0xaf, 0x1,  0x2a, 0x5d, 0xc3, 0x4,  0x88, 0xde, 0xb1, 0xd6, 0x3a, 0x0,  0x82, 0x1d, 0xca,
      0x12, 0x0,  0x14, 0xfd, 0x46, 0x3f, 0x2,  0x3f, 0xac, 0xa7, 0x52, 0xd4, 0x28, 0xce, 0xd5, 0xc8, 0xe3, 0x77, 0x87,
      0xcc, 0xd7, 0xe5, 0xeb, 0x29, 0x66, 0x11, 0x0,  0x0,  0x4b, 0x9,  0x27, 0x0,  0x0,  0x10, 0x57, 0x3,  0x0,  0x4,
      0x83, 0xd8, 0xe5, 0x8a, 0x25, 0x58, 0x24, 0xa0, 0x26, 0x0,  0x5,  0xd2, 0x55, 0x4,  0x6d, 0x80, 0x0,  0x1a, 0x97,
      0x92, 0xd4, 0xa9, 0x9f, 0x44, 0x7d, 0x9a, 0x6e, 0xd3, 0x78, 0xb,  0x59, 0x4f, 0x70, 0x84, 0x60, 0x4d, 0x5f, 0x39,
      0xec, 0xd8, 0x4d, 0xdd, 0x24, 0x4c, 0x18, 0x0,  0x0,  0x34, 0x2b, 0x1a, 0x0,  0x5,  0xc7, 0x58, 0x16, 0x4b, 0x2a,
      0x2,  0x0,  0x0,  0x17, 0x9c, 0x1,  0xaf, 0x12, 0x0,  0x8,  0xf3, 0x47, 0x8a, 0xc,  0xdc, 0xea, 0x57, 0xb6, 0x0,
      0x12, 0xc4, 0xea, 0xe9, 0x43, 0xf5, 0x2,  0xe5, 0x9a, 0x9,  0x1f, 0xd,  0x8,  0x26, 0x3e, 0x46, 0xd5, 0x82, 0x34,
      0x1,  0x0,  0x1e, 0x7d, 0x5,  0xe9, 0x7a, 0xeb, 0xdf, 0x86, 0x5a, 0xdc, 0x79, 0xdc, 0xff, 0x6,  0xc,  0x38, 0xd,
      0xd3, 0xb2, 0xab, 0x91, 0x3d, 0xb7, 0x94, 0x14, 0xbb, 0x7b, 0x53, 0x3a, 0xd7, 0xf7, 0x2,  0x0,  0x18, 0x53, 0x4c,
      0x30, 0x6a, 0x5,  0x2,  0xb,  0xb2, 0xf3, 0x2c, 0x9b, 0xa8, 0x2d, 0x33, 0x1e, 0x2a, 0x52, 0xf6, 0x15, 0x86, 0x66,
      0x29, 0xb7, 0xc4, 0x2,  0x0,  0x17, 0x9,  0xb9, 0x54, 0x84, 0x5a, 0xcd, 0x47, 0x49, 0x12, 0x92, 0x9c, 0xe9, 0xc9,
      0x86, 0x6b, 0x8e, 0xa8, 0xf7, 0xc9, 0x3d, 0xb3, 0x86, 0x31, 0x1,  0x0,  0x13, 0xc8, 0xa0, 0x81, 0xc6, 0x7c, 0x3e,
      0xee, 0x9f, 0xfe, 0xff, 0x18, 0x63, 0x95, 0x9a, 0x8b, 0xa7, 0x23, 0xea, 0x6e, 0x2,  0x0,  0x5,  0xa9, 0xd8, 0x3d,
      0x9a, 0x76, 0x1,  0x0,  0x1d, 0x39, 0xfe, 0x27, 0x8b, 0x7e, 0xaf, 0x4e, 0x3,  0xac, 0xf0, 0xdf, 0x35, 0x5e, 0xab,
      0x22, 0xa3, 0xde, 0xe1, 0x2a, 0xb6, 0x32, 0x2c, 0xfe, 0x36, 0xae, 0x19, 0x32, 0xc,  0xe3, 0x2,  0x0,  0x8,  0x6f,
      0x1,  0xc3, 0x9e, 0x30, 0x52, 0x8a, 0xfa, 0x0,  0x0,  0x12, 0x19, 0x16, 0xae, 0xda, 0x98, 0x6b, 0xf7, 0x35, 0x69,
      0x5f, 0xcd, 0x60, 0x2c, 0xc,  0x6d, 0x2a, 0x83, 0x5f, 0x2,  0x0,  0xf,  0xa3, 0x6e, 0x29, 0xb3, 0x41, 0x3d, 0x3c,
      0x0,  0x1f, 0xc7, 0x81, 0xa3, 0x89, 0x2b, 0x75, 0x0,  0x0,  0x0,  0x2};

  uint8_t buf[421] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0xea, 0xe9, 0x43, 0xf5, 0x2,  0xe5, 0x9a, 0x9,
                                     0x1f, 0xd,  0x8,  0x26, 0x3e, 0x46, 0xd5, 0x82, 0x34};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7d, 0x5,  0xe9, 0x7a, 0xeb, 0xdf, 0x86, 0x5a, 0xdc, 0x79,
                                     0xdc, 0xff, 0x6,  0xc,  0x38, 0xd,  0xd3, 0xb2, 0xab, 0x91,
                                     0x3d, 0xb7, 0x94, 0x14, 0xbb, 0x7b, 0x53, 0x3a, 0xd7, 0xf7};
  lwmqtt_string_t topic_filter_s1 = {30, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x4c, 0x30, 0x6a, 0x5,  0x2,  0xb,  0xb2, 0xf3, 0x2c, 0x9b, 0xa8,
                                     0x2d, 0x33, 0x1e, 0x2a, 0x52, 0xf6, 0x15, 0x86, 0x66, 0x29, 0xb7, 0xc4};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x9,  0xb9, 0x54, 0x84, 0x5a, 0xcd, 0x47, 0x49, 0x12, 0x92, 0x9c, 0xe9,
                                     0xc9, 0x86, 0x6b, 0x8e, 0xa8, 0xf7, 0xc9, 0x3d, 0xb3, 0x86, 0x31};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xc8, 0xa0, 0x81, 0xc6, 0x7c, 0x3e, 0xee, 0x9f, 0xfe, 0xff,
                                     0x18, 0x63, 0x95, 0x9a, 0x8b, 0xa7, 0x23, 0xea, 0x6e};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa9, 0xd8, 0x3d, 0x9a, 0x76};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x39, 0xfe, 0x27, 0x8b, 0x7e, 0xaf, 0x4e, 0x3,  0xac, 0xf0,
                                     0xdf, 0x35, 0x5e, 0xab, 0x22, 0xa3, 0xde, 0xe1, 0x2a, 0xb6,
                                     0x32, 0x2c, 0xfe, 0x36, 0xae, 0x19, 0x32, 0xc,  0xe3};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x6f, 0x1, 0xc3, 0x9e, 0x30, 0x52, 0x8a, 0xfa};
  lwmqtt_string_t topic_filter_s7 = {8, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x19, 0x16, 0xae, 0xda, 0x98, 0x6b, 0xf7, 0x35, 0x69,
                                     0x5f, 0xcd, 0x60, 0x2c, 0xc,  0x6d, 0x2a, 0x83, 0x5f};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xa3, 0x6e, 0x29, 0xb3, 0x41, 0x3d, 0x3c, 0x0,
                                     0x1f, 0xc7, 0x81, 0xa3, 0x89, 0x2b, 0x75};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0};
  lwmqtt_string_t topic_filter_s10 = {0, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x9b, 0xf4, 0x7, 0x11, 0xc6, 0xf4, 0x4a, 0x20, 0x92, 0xd, 0x35, 0xc, 0xc9, 0x12, 0x33, 0xcc};
  uint8_t bytesprops1[] = {0x24, 0x39, 0x9a, 0xd8, 0x37, 0xee, 0x12, 0xcc, 0xfc, 0xfe, 0x5a, 0xd1};
  uint8_t bytesprops2[] = {0x78, 0xbf, 0x53, 0xff, 0x98, 0x13, 0x7,  0x8b, 0x6e, 0xaf, 0x1,  0x2a,
                           0x5d, 0xc3, 0x4,  0x88, 0xde, 0xb1, 0xd6, 0x3a, 0x0,  0x82, 0x1d, 0xca};
  uint8_t bytesprops3[] = {0xfd, 0x46, 0x3f, 0x2,  0x3f, 0xac, 0xa7, 0x52, 0xd4, 0x28,
                           0xce, 0xd5, 0xc8, 0xe3, 0x77, 0x87, 0xcc, 0xd7, 0xe5, 0xeb};
  uint8_t bytesprops4[] = {0x83, 0xd8, 0xe5, 0x8a};
  uint8_t bytesprops6[] = {0x97, 0x92, 0xd4, 0xa9, 0x9f, 0x44, 0x7d, 0x9a, 0x6e, 0xd3, 0x78, 0xb,  0x59,
                           0x4f, 0x70, 0x84, 0x60, 0x4d, 0x5f, 0x39, 0xec, 0xd8, 0x4d, 0xdd, 0x24, 0x4c};
  uint8_t bytesprops5[] = {0xd2, 0x55, 0x4, 0x6d, 0x80};
  uint8_t bytesprops7[] = {0xc7, 0x58, 0x16, 0x4b, 0x2a};
  uint8_t bytesprops8[] = {0xf3, 0x47, 0x8a, 0xc, 0xdc, 0xea, 0x57, 0xb6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 31257}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {12, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4733}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 43}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {24, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 102}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19209}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4183}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {4, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 88}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 160}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {5, (char*)&bytesprops5}, .v = {26, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 13355}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {5, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6044}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 175}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {8, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {19, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25469, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14214 [("96\SIk\238a\SI\ETX\203\216\176fgS\149\148\229\206$",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\242\218\225YA\243\153\247\189I",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("1\141\ENQ\206\182U",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationData
// "\155\207z\253\172\191\&9\211\156I\234\244Gl\212\210\a\134\ENQ\ACK\255\r\206\228\230/\229",PropContentType
// "\231\148>\255\162QmDX\176#\\D\191\202\251\194\&8\t\205t",PropMaximumQoS 27,PropCorrelationData
// ")T\204\185\r",PropUserProperty "\DEL\137R_I\GSqE\226\238\NAK\204\187\250\bj])U\EM\200\SO\195B"
// "a=[bS\189\r\144\161\155@Bs\ESC\EOT\253",PropMaximumPacketSize 20849]
TEST(Subscribe5QCTest, Encode13) {
  uint8_t pkt[] = {0x82, 0xa5, 0x1,  0x37, 0x86, 0x72, 0x16, 0x0,  0x1b, 0x9b, 0xcf, 0x7a, 0xfd, 0xac, 0xbf, 0x39, 0xd3,
                   0x9c, 0x49, 0xea, 0xf4, 0x47, 0x6c, 0xd4, 0xd2, 0x7,  0x86, 0x5,  0x6,  0xff, 0xd,  0xce, 0xe4, 0xe6,
                   0x2f, 0xe5, 0x3,  0x0,  0x15, 0xe7, 0x94, 0x3e, 0xff, 0xa2, 0x51, 0x6d, 0x44, 0x58, 0xb0, 0x23, 0x5c,
                   0x44, 0xbf, 0xca, 0xfb, 0xc2, 0x38, 0x9,  0xcd, 0x74, 0x24, 0x1b, 0x9,  0x0,  0x5,  0x29, 0x54, 0xcc,
                   0xb9, 0xd,  0x26, 0x0,  0x18, 0x7f, 0x89, 0x52, 0x5f, 0x49, 0x1d, 0x71, 0x45, 0xe2, 0xee, 0x15, 0xcc,
                   0xbb, 0xfa, 0x8,  0x6a, 0x5d, 0x29, 0x55, 0x19, 0xc8, 0xe,  0xc3, 0x42, 0x0,  0x10, 0x61, 0x3d, 0x5b,
                   0x62, 0x53, 0xbd, 0xd,  0x90, 0xa1, 0x9b, 0x40, 0x42, 0x73, 0x1b, 0x4,  0xfd, 0x27, 0x0,  0x0,  0x51,
                   0x71, 0x0,  0x13, 0x39, 0x36, 0xf,  0x6b, 0xee, 0x61, 0xf,  0x3,  0xcb, 0xd8, 0xb0, 0x66, 0x67, 0x53,
                   0x95, 0x94, 0xe5, 0xce, 0x24, 0x2,  0x0,  0xa,  0xf2, 0xda, 0xe1, 0x59, 0x41, 0xf3, 0x99, 0xf7, 0xbd,
                   0x49, 0x1,  0x0,  0x1,  0xeb, 0x0,  0x0,  0x6,  0x31, 0x8d, 0x5,  0xce, 0xb6, 0x55, 0x0};

  uint8_t buf[178] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x39, 0x36, 0xf,  0x6b, 0xee, 0x61, 0xf,  0x3,  0xcb, 0xd8,
                                     0xb0, 0x66, 0x67, 0x53, 0x95, 0x94, 0xe5, 0xce, 0x24};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf2, 0xda, 0xe1, 0x59, 0x41, 0xf3, 0x99, 0xf7, 0xbd, 0x49};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xeb};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x31, 0x8d, 0x5, 0xce, 0xb6, 0x55};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x9b, 0xcf, 0x7a, 0xfd, 0xac, 0xbf, 0x39, 0xd3, 0x9c, 0x49, 0xea, 0xf4, 0x47, 0x6c,
                           0xd4, 0xd2, 0x7,  0x86, 0x5,  0x6,  0xff, 0xd,  0xce, 0xe4, 0xe6, 0x2f, 0xe5};
  uint8_t bytesprops1[] = {0xe7, 0x94, 0x3e, 0xff, 0xa2, 0x51, 0x6d, 0x44, 0x58, 0xb0, 0x23,
                           0x5c, 0x44, 0xbf, 0xca, 0xfb, 0xc2, 0x38, 0x9,  0xcd, 0x74};
  uint8_t bytesprops2[] = {0x29, 0x54, 0xcc, 0xb9, 0xd};
  uint8_t bytesprops4[] = {0x61, 0x3d, 0x5b, 0x62, 0x53, 0xbd, 0xd, 0x90,
                           0xa1, 0x9b, 0x40, 0x42, 0x73, 0x1b, 0x4, 0xfd};
  uint8_t bytesprops3[] = {0x7f, 0x89, 0x52, 0x5f, 0x49, 0x1d, 0x71, 0x45, 0xe2, 0xee, 0x15, 0xcc,
                           0xbb, 0xfa, 0x8,  0x6a, 0x5d, 0x29, 0x55, 0x19, 0xc8, 0xe,  0xc3, 0x42};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 27}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {5, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {24, (char*)&bytesprops3}, .v = {16, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20849}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14214, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 26235 [("\DLE",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("m;1\220gk`\169\152\251",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\SIj6\144\200ar\STX",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\241c\229\NULx\190Q\SYN",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropResponseInformation
// "\168\DC3\ETX",PropCorrelationData
// "Z{\175\133\a\247\182Sh\158\140\141\141\186J\f\183\ENQ\167\238\200\242}Ii\200",PropRequestProblemInformation
// 109,PropResponseInformation "\199\212\227\135:",PropResponseInformation
// "\SI6x~\198A\EOT.\138\197\193\138/\v\EM--6\f\ACK\191\v\STX",PropSubscriptionIdentifier 26,PropSessionExpiryInterval
// 19031,PropMessageExpiryInterval 30136,PropMaximumPacketSize 18409,PropSubscriptionIdentifier
// 6,PropRequestResponseInformation 8,PropRetainAvailable 55,PropRequestResponseInformation 81]
TEST(Subscribe5QCTest, Encode14) {
  uint8_t pkt[] = {0x82, 0x8a, 0x1,  0x66, 0x7b, 0x60, 0x1a, 0x0,  0x3,  0xa8, 0x13, 0x3,  0x9,  0x0,  0x1a, 0x5a,
                   0x7b, 0xaf, 0x85, 0x7,  0xf7, 0xb6, 0x53, 0x68, 0x9e, 0x8c, 0x8d, 0x8d, 0xba, 0x4a, 0xc,  0xb7,
                   0x5,  0xa7, 0xee, 0xc8, 0xf2, 0x7d, 0x49, 0x69, 0xc8, 0x17, 0x6d, 0x1a, 0x0,  0x5,  0xc7, 0xd4,
                   0xe3, 0x87, 0x3a, 0x1a, 0x0,  0x17, 0xf,  0x36, 0x78, 0x7e, 0xc6, 0x41, 0x4,  0x2e, 0x8a, 0xc5,
                   0xc1, 0x8a, 0x2f, 0xb,  0x19, 0x2d, 0x2d, 0x36, 0xc,  0x6,  0xbf, 0xb,  0x2,  0xb,  0x1a, 0x11,
                   0x0,  0x0,  0x4a, 0x57, 0x2,  0x0,  0x0,  0x75, 0xb8, 0x27, 0x0,  0x0,  0x47, 0xe9, 0xb,  0x6,
                   0x19, 0x8,  0x25, 0x37, 0x19, 0x51, 0x0,  0x1,  0x10, 0x1,  0x0,  0xa,  0x6d, 0x3b, 0x31, 0xdc,
                   0x67, 0x6b, 0x60, 0xa9, 0x98, 0xfb, 0x1,  0x0,  0x8,  0xf,  0x6a, 0x36, 0x90, 0xc8, 0x61, 0x72,
                   0x2,  0x0,  0x0,  0x8,  0xf1, 0x63, 0xe5, 0x0,  0x78, 0xbe, 0x51, 0x16, 0x0};

  uint8_t buf[151] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x10};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6d, 0x3b, 0x31, 0xdc, 0x67, 0x6b, 0x60, 0xa9, 0x98, 0xfb};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf, 0x6a, 0x36, 0x90, 0xc8, 0x61, 0x72, 0x2};
  lwmqtt_string_t topic_filter_s2 = {8, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf1, 0x63, 0xe5, 0x0, 0x78, 0xbe, 0x51, 0x16};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0xa8, 0x13, 0x3};
  uint8_t bytesprops1[] = {0x5a, 0x7b, 0xaf, 0x85, 0x7, 0xf7, 0xb6, 0x53, 0x68, 0x9e, 0x8c, 0x8d, 0x8d,
                           0xba, 0x4a, 0xc,  0xb7, 0x5, 0xa7, 0xee, 0xc8, 0xf2, 0x7d, 0x49, 0x69, 0xc8};
  uint8_t bytesprops2[] = {0xc7, 0xd4, 0xe3, 0x87, 0x3a};
  uint8_t bytesprops3[] = {0xf,  0x36, 0x78, 0x7e, 0xc6, 0x41, 0x4, 0x2e, 0x8a, 0xc5, 0xc1, 0x8a,
                           0x2f, 0xb,  0x19, 0x2d, 0x2d, 0x36, 0xc, 0x6,  0xbf, 0xb,  0x2};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {3, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 109}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {5, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {23, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 26}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19031}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30136}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 18409}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 6}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 8}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 55}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 81}},
  };

  lwmqtt_properties_t props = {13, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 26235, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10474 [("\ACK\214li.\ESC\US;<O]t>\201}3\165",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\152\173{\218\168a\184Y_y\149\241F:y\188",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\147\ESC\141H\166\226\230G\180\252\198\196\GS",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\236\183\RSM\169v\254\179TT7\211\194\132\161fbQ\218\US\135\202\f\149E\197\197\SOHuK",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("3\179|)\222p\245\SUB\197\v\182\RSnw#\225\157t\ETX\DC2E",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\233\213\221\219\SUB0\164J\162\185\156\230\230\&5\156\244\133",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("d\NULN\129\242u`\152\ACK\DEL_\164\207\168\191T\132\177\"\FS*",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\136f7w\182\132'",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\220w'\179\FSxy\194[@\163;",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("9H\134H\191\242[\206S\129\162\243\244Kw$",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropResponseInformation
// "\240\203\GS\183\250\137l\224\235\250'\249}\SO\206|\144\162",PropResponseTopic
// "o6j\209\186\192\221<\139\204\253`\186\220\ETB?\213-?\239\132G",PropSharedSubscriptionAvailable 35,PropReasonString
// "X\DELS\248\184G\255+\194\169",PropMessageExpiryInterval 18569,PropTopicAlias 4449,PropReceiveMaximum
// 7814,PropTopicAlias 30892,PropUserProperty "e\a8\208\CAN\131b\134N\160\228\163\189y$\151a\130\169\244{\198\141\177"
// "\163\195M\241ue-\211\212\174\ACK\b\204\255\SYN\208\188+N\196\237\171\129R\129\226\ETX\163w",PropRetainAvailable
// 199,PropCorrelationData "}\165\223L\181\EOTt\CAN\253\176\210\209",PropServerKeepAlive
// 2300,PropWildcardSubscriptionAvailable 187]
TEST(Subscribe5QCTest, Encode15) {
  uint8_t pkt[] = {
      0x82, 0xe7, 0x2,  0x28, 0xea, 0x9b, 0x1,  0x1a, 0x0,  0x12, 0xf0, 0xcb, 0x1d, 0xb7, 0xfa, 0x89, 0x6c, 0xe0, 0xeb,
      0xfa, 0x27, 0xf9, 0x7d, 0xe,  0xce, 0x7c, 0x90, 0xa2, 0x8,  0x0,  0x16, 0x6f, 0x36, 0x6a, 0xd1, 0xba, 0xc0, 0xdd,
      0x3c, 0x8b, 0xcc, 0xfd, 0x60, 0xba, 0xdc, 0x17, 0x3f, 0xd5, 0x2d, 0x3f, 0xef, 0x84, 0x47, 0x2a, 0x23, 0x1f, 0x0,
      0xa,  0x58, 0x7f, 0x53, 0xf8, 0xb8, 0x47, 0xff, 0x2b, 0xc2, 0xa9, 0x2,  0x0,  0x0,  0x48, 0x89, 0x23, 0x11, 0x61,
      0x21, 0x1e, 0x86, 0x23, 0x78, 0xac, 0x26, 0x0,  0x18, 0x65, 0x7,  0x38, 0xd0, 0x18, 0x83, 0x62, 0x86, 0x4e, 0xa0,
      0xe4, 0xa3, 0xbd, 0x79, 0x24, 0x97, 0x61, 0x82, 0xa9, 0xf4, 0x7b, 0xc6, 0x8d, 0xb1, 0x0,  0x1d, 0xa3, 0xc3, 0x4d,
      0xf1, 0x75, 0x65, 0x2d, 0xd3, 0xd4, 0xae, 0x6,  0x8,  0xcc, 0xff, 0x16, 0xd0, 0xbc, 0x2b, 0x4e, 0xc4, 0xed, 0xab,
      0x81, 0x52, 0x81, 0xe2, 0x3,  0xa3, 0x77, 0x25, 0xc7, 0x9,  0x0,  0xc,  0x7d, 0xa5, 0xdf, 0x4c, 0xb5, 0x4,  0x74,
      0x18, 0xfd, 0xb0, 0xd2, 0xd1, 0x13, 0x8,  0xfc, 0x28, 0xbb, 0x0,  0x11, 0x6,  0xd6, 0x6c, 0x69, 0x2e, 0x1b, 0x1f,
      0x3b, 0x3c, 0x4f, 0x5d, 0x74, 0x3e, 0xc9, 0x7d, 0x33, 0xa5, 0x0,  0x0,  0x10, 0x98, 0xad, 0x7b, 0xda, 0xa8, 0x61,
      0xb8, 0x59, 0x5f, 0x79, 0x95, 0xf1, 0x46, 0x3a, 0x79, 0xbc, 0x2,  0x0,  0xd,  0x93, 0x1b, 0x8d, 0x48, 0xa6, 0xe2,
      0xe6, 0x47, 0xb4, 0xfc, 0xc6, 0xc4, 0x1d, 0x2,  0x0,  0x1e, 0xec, 0xb7, 0x1e, 0x4d, 0xa9, 0x76, 0xfe, 0xb3, 0x54,
      0x54, 0x37, 0xd3, 0xc2, 0x84, 0xa1, 0x66, 0x62, 0x51, 0xda, 0x1f, 0x87, 0xca, 0xc,  0x95, 0x45, 0xc5, 0xc5, 0x1,
      0x75, 0x4b, 0x0,  0x0,  0x15, 0x33, 0xb3, 0x7c, 0x29, 0xde, 0x70, 0xf5, 0x1a, 0xc5, 0xb,  0xb6, 0x1e, 0x6e, 0x77,
      0x23, 0xe1, 0x9d, 0x74, 0x3,  0x12, 0x45, 0x1,  0x0,  0x11, 0xe9, 0xd5, 0xdd, 0xdb, 0x1a, 0x30, 0xa4, 0x4a, 0xa2,
      0xb9, 0x9c, 0xe6, 0xe6, 0x35, 0x9c, 0xf4, 0x85, 0x2,  0x0,  0x15, 0x64, 0x0,  0x4e, 0x81, 0xf2, 0x75, 0x60, 0x98,
      0x6,  0x7f, 0x5f, 0xa4, 0xcf, 0xa8, 0xbf, 0x54, 0x84, 0xb1, 0x22, 0x1c, 0x2a, 0x2,  0x0,  0x7,  0x88, 0x66, 0x37,
      0x77, 0xb6, 0x84, 0x27, 0x2,  0x0,  0xc,  0xdc, 0x77, 0x27, 0xb3, 0x1c, 0x78, 0x79, 0xc2, 0x5b, 0x40, 0xa3, 0x3b,
      0x2,  0x0,  0x10, 0x39, 0x48, 0x86, 0x48, 0xbf, 0xf2, 0x5b, 0xce, 0x53, 0x81, 0xa2, 0xf3, 0xf4, 0x4b, 0x77, 0x24,
      0x1};

  uint8_t buf[372] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x6,  0xd6, 0x6c, 0x69, 0x2e, 0x1b, 0x1f, 0x3b, 0x3c,
                                     0x4f, 0x5d, 0x74, 0x3e, 0xc9, 0x7d, 0x33, 0xa5};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x98, 0xad, 0x7b, 0xda, 0xa8, 0x61, 0xb8, 0x59,
                                     0x5f, 0x79, 0x95, 0xf1, 0x46, 0x3a, 0x79, 0xbc};
  lwmqtt_string_t topic_filter_s1 = {16, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x93, 0x1b, 0x8d, 0x48, 0xa6, 0xe2, 0xe6, 0x47, 0xb4, 0xfc, 0xc6, 0xc4, 0x1d};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xec, 0xb7, 0x1e, 0x4d, 0xa9, 0x76, 0xfe, 0xb3, 0x54, 0x54,
                                     0x37, 0xd3, 0xc2, 0x84, 0xa1, 0x66, 0x62, 0x51, 0xda, 0x1f,
                                     0x87, 0xca, 0xc,  0x95, 0x45, 0xc5, 0xc5, 0x1,  0x75, 0x4b};
  lwmqtt_string_t topic_filter_s3 = {30, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x33, 0xb3, 0x7c, 0x29, 0xde, 0x70, 0xf5, 0x1a, 0xc5, 0xb, 0xb6,
                                     0x1e, 0x6e, 0x77, 0x23, 0xe1, 0x9d, 0x74, 0x3,  0x12, 0x45};
  lwmqtt_string_t topic_filter_s4 = {21, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe9, 0xd5, 0xdd, 0xdb, 0x1a, 0x30, 0xa4, 0x4a, 0xa2,
                                     0xb9, 0x9c, 0xe6, 0xe6, 0x35, 0x9c, 0xf4, 0x85};
  lwmqtt_string_t topic_filter_s5 = {17, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x64, 0x0,  0x4e, 0x81, 0xf2, 0x75, 0x60, 0x98, 0x6,  0x7f, 0x5f,
                                     0xa4, 0xcf, 0xa8, 0xbf, 0x54, 0x84, 0xb1, 0x22, 0x1c, 0x2a};
  lwmqtt_string_t topic_filter_s6 = {21, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x88, 0x66, 0x37, 0x77, 0xb6, 0x84, 0x27};
  lwmqtt_string_t topic_filter_s7 = {7, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdc, 0x77, 0x27, 0xb3, 0x1c, 0x78, 0x79, 0xc2, 0x5b, 0x40, 0xa3, 0x3b};
  lwmqtt_string_t topic_filter_s8 = {12, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x39, 0x48, 0x86, 0x48, 0xbf, 0xf2, 0x5b, 0xce,
                                     0x53, 0x81, 0xa2, 0xf3, 0xf4, 0x4b, 0x77, 0x24};
  lwmqtt_string_t topic_filter_s9 = {16, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xf0, 0xcb, 0x1d, 0xb7, 0xfa, 0x89, 0x6c, 0xe0, 0xeb,
                           0xfa, 0x27, 0xf9, 0x7d, 0xe,  0xce, 0x7c, 0x90, 0xa2};
  uint8_t bytesprops1[] = {0x6f, 0x36, 0x6a, 0xd1, 0xba, 0xc0, 0xdd, 0x3c, 0x8b, 0xcc, 0xfd,
                           0x60, 0xba, 0xdc, 0x17, 0x3f, 0xd5, 0x2d, 0x3f, 0xef, 0x84, 0x47};
  uint8_t bytesprops2[] = {0x58, 0x7f, 0x53, 0xf8, 0xb8, 0x47, 0xff, 0x2b, 0xc2, 0xa9};
  uint8_t bytesprops4[] = {0xa3, 0xc3, 0x4d, 0xf1, 0x75, 0x65, 0x2d, 0xd3, 0xd4, 0xae, 0x6,  0x8, 0xcc, 0xff, 0x16,
                           0xd0, 0xbc, 0x2b, 0x4e, 0xc4, 0xed, 0xab, 0x81, 0x52, 0x81, 0xe2, 0x3, 0xa3, 0x77};
  uint8_t bytesprops3[] = {0x65, 0x7,  0x38, 0xd0, 0x18, 0x83, 0x62, 0x86, 0x4e, 0xa0, 0xe4, 0xa3,
                           0xbd, 0x79, 0x24, 0x97, 0x61, 0x82, 0xa9, 0xf4, 0x7b, 0xc6, 0x8d, 0xb1};
  uint8_t bytesprops5[] = {0x7d, 0xa5, 0xdf, 0x4c, 0xb5, 0x4, 0x74, 0x18, 0xfd, 0xb0, 0xd2, 0xd1};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {22, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 35}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18569}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4449}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 7814}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 30892}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {24, (char*)&bytesprops3}, .v = {29, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 199}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2300}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 187}},
  };

  lwmqtt_properties_t props = {13, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10474, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3250 [("x\215}:\240\130\FS\DC3r\185\253t\214\&4\231\195dG<\187\f",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\ETB\236&\173\154\233\&7\EOT~",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("!\CAN\STX\GSG;\179\203\n\224\213",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\208d*\128\&7+\217w\"\f\250\ENQ\189\159\234\236\247\238\ACK0\195",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\155\218X\182O\200\175-#",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\219\217L\214\219",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("A\235\201\159~{C\168\132nu\ETB",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\159jI\215+\216\176`\223\230\169\155\239\249q6",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropAssignedClientIdentifier
// "\199es!\\\EOT\210\170\134",PropAuthenticationMethod "\219\135",PropTopicAlias 24882,PropResponseTopic
// "g\146\RSP",PropContentType "\\\188\201\153\183\157\226\172\219\vb\224\217\157\&9\162\SOH",PropAuthenticationMethod
// "\162\t\209c\229\&4Mr{\"E\229\223\183\r\EMq\ENQUBD",PropReasonString
// "\222\140\b\153\&4L\244\147A|L\EMd\163\US\156\&4\244\137\156",PropAssignedClientIdentifier
// "v\EM\186\129\USkJ\162",PropTopicAliasMaximum 17487,PropServerReference
// "!\136\189\242%\245\SO\184\204\203",PropSubscriptionIdentifier 27,PropServerReference "=\175\132",PropCorrelationData
// "\172\206\t\b\143\167\&7|5~",PropCorrelationData "y\229\234D\199",PropTopicAliasMaximum 9292,PropMaximumQoS
// 48,PropContentType "\237\207\183\254\EM`\201,Y\ETX\232\n\246\166\179\198\227-",PropSubscriptionIdentifier 4]
TEST(Subscribe5QCTest, Encode16) {
  uint8_t pkt[] = {
      0x82, 0xb6, 0x2,  0xc,  0xb2, 0xb2, 0x1,  0x12, 0x0,  0x9,  0xc7, 0x65, 0x73, 0x21, 0x5c, 0x4,  0xd2, 0xaa, 0x86,
      0x15, 0x0,  0x2,  0xdb, 0x87, 0x23, 0x61, 0x32, 0x8,  0x0,  0x4,  0x67, 0x92, 0x1e, 0x50, 0x3,  0x0,  0x11, 0x5c,
      0xbc, 0xc9, 0x99, 0xb7, 0x9d, 0xe2, 0xac, 0xdb, 0xb,  0x62, 0xe0, 0xd9, 0x9d, 0x39, 0xa2, 0x1,  0x15, 0x0,  0x15,
      0xa2, 0x9,  0xd1, 0x63, 0xe5, 0x34, 0x4d, 0x72, 0x7b, 0x22, 0x45, 0xe5, 0xdf, 0xb7, 0xd,  0x19, 0x71, 0x5,  0x55,
      0x42, 0x44, 0x1f, 0x0,  0x14, 0xde, 0x8c, 0x8,  0x99, 0x34, 0x4c, 0xf4, 0x93, 0x41, 0x7c, 0x4c, 0x19, 0x64, 0xa3,
      0x1f, 0x9c, 0x34, 0xf4, 0x89, 0x9c, 0x12, 0x0,  0x8,  0x76, 0x19, 0xba, 0x81, 0x1f, 0x6b, 0x4a, 0xa2, 0x22, 0x44,
      0x4f, 0x1c, 0x0,  0xa,  0x21, 0x88, 0xbd, 0xf2, 0x25, 0xf5, 0xe,  0xb8, 0xcc, 0xcb, 0xb,  0x1b, 0x1c, 0x0,  0x3,
      0x3d, 0xaf, 0x84, 0x9,  0x0,  0xa,  0xac, 0xce, 0x9,  0x8,  0x8f, 0xa7, 0x37, 0x7c, 0x35, 0x7e, 0x9,  0x0,  0x5,
      0x79, 0xe5, 0xea, 0x44, 0xc7, 0x22, 0x24, 0x4c, 0x24, 0x30, 0x3,  0x0,  0x12, 0xed, 0xcf, 0xb7, 0xfe, 0x19, 0x60,
      0xc9, 0x2c, 0x59, 0x3,  0xe8, 0xa,  0xf6, 0xa6, 0xb3, 0xc6, 0xe3, 0x2d, 0xb,  0x4,  0x0,  0x15, 0x78, 0xd7, 0x7d,
      0x3a, 0xf0, 0x82, 0x1c, 0x13, 0x72, 0xb9, 0xfd, 0x74, 0xd6, 0x34, 0xe7, 0xc3, 0x64, 0x47, 0x3c, 0xbb, 0xc,  0x0,
      0x0,  0x9,  0x17, 0xec, 0x26, 0xad, 0x9a, 0xe9, 0x37, 0x4,  0x7e, 0x2,  0x0,  0xb,  0x21, 0x18, 0x2,  0x1d, 0x47,
      0x3b, 0xb3, 0xcb, 0xa,  0xe0, 0xd5, 0x0,  0x0,  0x15, 0xd0, 0x64, 0x2a, 0x80, 0x37, 0x2b, 0xd9, 0x77, 0x22, 0xc,
      0xfa, 0x5,  0xbd, 0x9f, 0xea, 0xec, 0xf7, 0xee, 0x6,  0x30, 0xc3, 0x0,  0x0,  0x9,  0x9b, 0xda, 0x58, 0xb6, 0x4f,
      0xc8, 0xaf, 0x2d, 0x23, 0x1,  0x0,  0x5,  0xdb, 0xd9, 0x4c, 0xd6, 0xdb, 0x1,  0x0,  0xc,  0x41, 0xeb, 0xc9, 0x9f,
      0x7e, 0x7b, 0x43, 0xa8, 0x84, 0x6e, 0x75, 0x17, 0x1,  0x0,  0x10, 0x9f, 0x6a, 0x49, 0xd7, 0x2b, 0xd8, 0xb0, 0x60,
      0xdf, 0xe6, 0xa9, 0x9b, 0xef, 0xf9, 0x71, 0x36, 0x1};

  uint8_t buf[323] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x78, 0xd7, 0x7d, 0x3a, 0xf0, 0x82, 0x1c, 0x13, 0x72, 0xb9, 0xfd,
                                     0x74, 0xd6, 0x34, 0xe7, 0xc3, 0x64, 0x47, 0x3c, 0xbb, 0xc};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x17, 0xec, 0x26, 0xad, 0x9a, 0xe9, 0x37, 0x4, 0x7e};
  lwmqtt_string_t topic_filter_s1 = {9, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x21, 0x18, 0x2, 0x1d, 0x47, 0x3b, 0xb3, 0xcb, 0xa, 0xe0, 0xd5};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd0, 0x64, 0x2a, 0x80, 0x37, 0x2b, 0xd9, 0x77, 0x22, 0xc, 0xfa,
                                     0x5,  0xbd, 0x9f, 0xea, 0xec, 0xf7, 0xee, 0x6,  0x30, 0xc3};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0xda, 0x58, 0xb6, 0x4f, 0xc8, 0xaf, 0x2d, 0x23};
  lwmqtt_string_t topic_filter_s4 = {9, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xdb, 0xd9, 0x4c, 0xd6, 0xdb};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x41, 0xeb, 0xc9, 0x9f, 0x7e, 0x7b, 0x43, 0xa8, 0x84, 0x6e, 0x75, 0x17};
  lwmqtt_string_t topic_filter_s6 = {12, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x9f, 0x6a, 0x49, 0xd7, 0x2b, 0xd8, 0xb0, 0x60,
                                     0xdf, 0xe6, 0xa9, 0x9b, 0xef, 0xf9, 0x71, 0x36};
  lwmqtt_string_t topic_filter_s7 = {16, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xc7, 0x65, 0x73, 0x21, 0x5c, 0x4, 0xd2, 0xaa, 0x86};
  uint8_t bytesprops1[] = {0xdb, 0x87};
  uint8_t bytesprops2[] = {0x67, 0x92, 0x1e, 0x50};
  uint8_t bytesprops3[] = {0x5c, 0xbc, 0xc9, 0x99, 0xb7, 0x9d, 0xe2, 0xac, 0xdb,
                           0xb,  0x62, 0xe0, 0xd9, 0x9d, 0x39, 0xa2, 0x1};
  uint8_t bytesprops4[] = {0xa2, 0x9,  0xd1, 0x63, 0xe5, 0x34, 0x4d, 0x72, 0x7b, 0x22, 0x45,
                           0xe5, 0xdf, 0xb7, 0xd,  0x19, 0x71, 0x5,  0x55, 0x42, 0x44};
  uint8_t bytesprops5[] = {0xde, 0x8c, 0x8,  0x99, 0x34, 0x4c, 0xf4, 0x93, 0x41, 0x7c,
                           0x4c, 0x19, 0x64, 0xa3, 0x1f, 0x9c, 0x34, 0xf4, 0x89, 0x9c};
  uint8_t bytesprops6[] = {0x76, 0x19, 0xba, 0x81, 0x1f, 0x6b, 0x4a, 0xa2};
  uint8_t bytesprops7[] = {0x21, 0x88, 0xbd, 0xf2, 0x25, 0xf5, 0xe, 0xb8, 0xcc, 0xcb};
  uint8_t bytesprops8[] = {0x3d, 0xaf, 0x84};
  uint8_t bytesprops9[] = {0xac, 0xce, 0x9, 0x8, 0x8f, 0xa7, 0x37, 0x7c, 0x35, 0x7e};
  uint8_t bytesprops10[] = {0x79, 0xe5, 0xea, 0x44, 0xc7};
  uint8_t bytesprops11[] = {0xed, 0xcf, 0xb7, 0xfe, 0x19, 0x60, 0xc9, 0x2c, 0x59,
                            0x3,  0xe8, 0xa,  0xf6, 0xa6, 0xb3, 0xc6, 0xe3, 0x2d};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {9, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 24882}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {17, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {8, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17487}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 27}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {5, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 9292}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 48}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 4}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 3250, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12034
// [("\128.\143\172\255%\203\247\222\207O\146%X\169\204g\245\223\SUB\150#\190tM\173Fw9",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropServerKeepAlive
// 4778,PropWillDelayInterval 10353,PropMessageExpiryInterval 18887,PropSharedSubscriptionAvailable 75,PropTopicAlias
// 8848,PropRetainAvailable 170,PropAuthenticationMethod "{\ETXs\233\138\SO*",PropWillDelayInterval
// 29469,PropMaximumPacketSize 4282,PropSharedSubscriptionAvailable 241,PropServerReference
// "",PropRequestProblemInformation 234,PropSubscriptionIdentifier 14,PropReceiveMaximum 24890,PropServerReference
// "\184}Wx\223M\202\NUL0\220E\249\247\n\191\202",PropSharedSubscriptionAvailable 112,PropRequestResponseInformation
// 142,PropSharedSubscriptionAvailable 65,PropSubscriptionIdentifier 12,PropReceiveMaximum 25373,PropServerKeepAlive
// 9978,PropReceiveMaximum 970]
TEST(Subscribe5QCTest, Encode17) {
  uint8_t pkt[] = {0x82, 0x7b, 0x2f, 0x2,  0x58, 0x13, 0x12, 0xaa, 0x18, 0x0,  0x0,  0x28, 0x71, 0x2,  0x0,  0x0,
                   0x49, 0xc7, 0x2a, 0x4b, 0x23, 0x22, 0x90, 0x25, 0xaa, 0x15, 0x0,  0x7,  0x7b, 0x3,  0x73, 0xe9,
                   0x8a, 0xe,  0x2a, 0x18, 0x0,  0x0,  0x73, 0x1d, 0x27, 0x0,  0x0,  0x10, 0xba, 0x2a, 0xf1, 0x1c,
                   0x0,  0x0,  0x17, 0xea, 0xb,  0xe,  0x21, 0x61, 0x3a, 0x1c, 0x0,  0x10, 0xb8, 0x7d, 0x57, 0x78,
                   0xdf, 0x4d, 0xca, 0x0,  0x30, 0xdc, 0x45, 0xf9, 0xf7, 0xa,  0xbf, 0xca, 0x2a, 0x70, 0x19, 0x8e,
                   0x2a, 0x41, 0xb,  0xc,  0x21, 0x63, 0x1d, 0x13, 0x26, 0xfa, 0x21, 0x3,  0xca, 0x0,  0x1d, 0x80,
                   0x2e, 0x8f, 0xac, 0xff, 0x25, 0xcb, 0xf7, 0xde, 0xcf, 0x4f, 0x92, 0x25, 0x58, 0xa9, 0xcc, 0x67,
                   0xf5, 0xdf, 0x1a, 0x96, 0x23, 0xbe, 0x74, 0x4d, 0xad, 0x46, 0x77, 0x39, 0x0};

  uint8_t buf[135] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x80, 0x2e, 0x8f, 0xac, 0xff, 0x25, 0xcb, 0xf7, 0xde, 0xcf,
                                     0x4f, 0x92, 0x25, 0x58, 0xa9, 0xcc, 0x67, 0xf5, 0xdf, 0x1a,
                                     0x96, 0x23, 0xbe, 0x74, 0x4d, 0xad, 0x46, 0x77, 0x39};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x7b, 0x3, 0x73, 0xe9, 0x8a, 0xe, 0x2a};
  uint8_t bytesprops1[] = {0};
  uint8_t bytesprops2[] = {0xb8, 0x7d, 0x57, 0x78, 0xdf, 0x4d, 0xca, 0x0,
                           0x30, 0xdc, 0x45, 0xf9, 0xf7, 0xa,  0xbf, 0xca};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 4778}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 10353}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18887}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 75}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 8848}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 170}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29469}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4282}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 241}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 234}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 14}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 24890}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {16, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 112}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 142}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 65}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 12}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 25373}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 9978}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 970}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12034, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4596 [("7\239\237\148",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\201\SI~\174\182\156;o{\142",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\219\b\DLE\SYN\228sb\177\143\195\230o<\196\246f=B",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\135\224?\NUL\161\188\134E\172\&4>1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),(".\233\181Y\146\&6\140\157\t\205\161Mo\215\&5\186\RSB_\ACK\219\186\f\238",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("1\174\&9\253\135o\201\235\GS\243\240\SYN\177jUy\141\218\158\251\232Pg\161\SYN\SO\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\137\&5u\EOT\209\DC4e\177\194H\NAKp;Q\228\b\149\178\182\140\217>!\",\FS\154\163\&1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\189r\185K\155\247:&\129\FS}\SUB\136\205\198gm\202\183|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAssignedClientIdentifier
// "\DC1\200\ta\151ad%\149\206\235\139-\ETX\224\&7j\168ZE\ACK*",PropTopicAlias 26951,PropSessionExpiryInterval
// 19408,PropServerKeepAlive 13738,PropAssignedClientIdentifier
// "K\177Yq\"\199\190\168\a\160\DC3Q6o\221\134\168\206\254\\.*9",PropServerKeepAlive 22953,PropMessageExpiryInterval
// 20380,PropRetainAvailable 82,PropPayloadFormatIndicator 101,PropSubscriptionIdentifierAvailable
// 35,PropWillDelayInterval 26378,PropSessionExpiryInterval 6332,PropMessageExpiryInterval 18541,PropAuthenticationData
// "J\130;\242\RS\213\230\152\169\243",PropWildcardSubscriptionAvailable 38,PropSessionExpiryInterval
// 12922,PropServerReference "Cv\165\&7\219\228\t,\ETX/\159\176\200(\227H\\f
// \178\FS&o\142\172'D\250\SYN",PropCorrelationData "\131\ESC\DC1nr\DEL\237\235\FS\ACK\220\238",PropReasonString
// "\251\194\163\212`F\160\FS5.\207d\241D\138\240n\ESC^*\ESC\174",PropServerReference
// "\233\v\244\185\DEL!6\131\243\232;\173\129a\242\176\147\b\161\209\156Z\169\DLE/"]
TEST(Subscribe5QCTest, Encode18) {
  uint8_t pkt[] = {
      0x82, 0x86, 0x3,  0x11, 0xf4, 0xd3, 0x1,  0x12, 0x0,  0x16, 0x11, 0xc8, 0x9,  0x61, 0x97, 0x61, 0x64, 0x25, 0x95,
      0xce, 0xeb, 0x8b, 0x2d, 0x3,  0xe0, 0x37, 0x6a, 0xa8, 0x5a, 0x45, 0x6,  0x2a, 0x23, 0x69, 0x47, 0x11, 0x0,  0x0,
      0x4b, 0xd0, 0x13, 0x35, 0xaa, 0x12, 0x0,  0x17, 0x4b, 0xb1, 0x59, 0x71, 0x22, 0xc7, 0xbe, 0xa8, 0x7,  0xa0, 0x13,
      0x51, 0x36, 0x6f, 0xdd, 0x86, 0xa8, 0xce, 0xfe, 0x5c, 0x2e, 0x2a, 0x39, 0x13, 0x59, 0xa9, 0x2,  0x0,  0x0,  0x4f,
      0x9c, 0x25, 0x52, 0x1,  0x65, 0x29, 0x23, 0x18, 0x0,  0x0,  0x67, 0xa,  0x11, 0x0,  0x0,  0x18, 0xbc, 0x2,  0x0,
      0x0,  0x48, 0x6d, 0x16, 0x0,  0xa,  0x4a, 0x82, 0x3b, 0xf2, 0x1e, 0xd5, 0xe6, 0x98, 0xa9, 0xf3, 0x28, 0x26, 0x11,
      0x0,  0x0,  0x32, 0x7a, 0x1c, 0x0,  0x1d, 0x43, 0x76, 0xa5, 0x37, 0xdb, 0xe4, 0x9,  0x2c, 0x3,  0x2f, 0x9f, 0xb0,
      0xc8, 0x28, 0xe3, 0x48, 0x5c, 0x66, 0x20, 0xb2, 0x1c, 0x26, 0x6f, 0x8e, 0xac, 0x27, 0x44, 0xfa, 0x16, 0x9,  0x0,
      0xc,  0x83, 0x1b, 0x11, 0x6e, 0x72, 0x7f, 0xed, 0xeb, 0x1c, 0x6,  0xdc, 0xee, 0x1f, 0x0,  0x16, 0xfb, 0xc2, 0xa3,
      0xd4, 0x60, 0x46, 0xa0, 0x1c, 0x35, 0x2e, 0xcf, 0x64, 0xf1, 0x44, 0x8a, 0xf0, 0x6e, 0x1b, 0x5e, 0x2a, 0x1b, 0xae,
      0x1c, 0x0,  0x19, 0xe9, 0xb,  0xf4, 0xb9, 0x7f, 0x21, 0x36, 0x83, 0xf3, 0xe8, 0x3b, 0xad, 0x81, 0x61, 0xf2, 0xb0,
      0x93, 0x8,  0xa1, 0xd1, 0x9c, 0x5a, 0xa9, 0x10, 0x2f, 0x0,  0x4,  0x37, 0xef, 0xed, 0x94, 0x2,  0x0,  0x0,  0x1,
      0x0,  0x1,  0xce, 0x2,  0x0,  0xa,  0xc9, 0xf,  0x7e, 0xae, 0xb6, 0x9c, 0x3b, 0x6f, 0x7b, 0x8e, 0x1,  0x0,  0x12,
      0xdb, 0x8,  0x10, 0x16, 0xe4, 0x73, 0x62, 0xb1, 0x8f, 0xc3, 0xe6, 0x6f, 0x3c, 0xc4, 0xf6, 0x66, 0x3d, 0x42, 0x2,
      0x0,  0xc,  0x87, 0xe0, 0x3f, 0x0,  0xa1, 0xbc, 0x86, 0x45, 0xac, 0x34, 0x3e, 0x31, 0x2,  0x0,  0x18, 0x2e, 0xe9,
      0xb5, 0x59, 0x92, 0x36, 0x8c, 0x9d, 0x9,  0xcd, 0xa1, 0x4d, 0x6f, 0xd7, 0x35, 0xba, 0x1e, 0x42, 0x5f, 0x6,  0xdb,
      0xba, 0xc,  0xee, 0x2,  0x0,  0x1b, 0x31, 0xae, 0x39, 0xfd, 0x87, 0x6f, 0xc9, 0xeb, 0x1d, 0xf3, 0xf0, 0x16, 0xb1,
      0x6a, 0x55, 0x79, 0x8d, 0xda, 0x9e, 0xfb, 0xe8, 0x50, 0x67, 0xa1, 0x16, 0xe,  0xa2, 0x2,  0x0,  0x1d, 0x89, 0x35,
      0x75, 0x4,  0xd1, 0x14, 0x65, 0xb1, 0xc2, 0x48, 0x15, 0x70, 0x3b, 0x51, 0xe4, 0x8,  0x95, 0xb2, 0xb6, 0x8c, 0xd9,
      0x3e, 0x21, 0x22, 0x2c, 0x1c, 0x9a, 0xa3, 0x31, 0x2,  0x0,  0x14, 0xbd, 0x72, 0xb9, 0x4b, 0x9b, 0xf7, 0x3a, 0x26,
      0x81, 0x1c, 0x7d, 0x1a, 0x88, 0xcd, 0xc6, 0x67, 0x6d, 0xca, 0xb7, 0x7c, 0x0};

  uint8_t buf[403] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x37, 0xef, 0xed, 0x94};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xce};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc9, 0xf, 0x7e, 0xae, 0xb6, 0x9c, 0x3b, 0x6f, 0x7b, 0x8e};
  lwmqtt_string_t topic_filter_s3 = {10, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xdb, 0x8,  0x10, 0x16, 0xe4, 0x73, 0x62, 0xb1, 0x8f,
                                     0xc3, 0xe6, 0x6f, 0x3c, 0xc4, 0xf6, 0x66, 0x3d, 0x42};
  lwmqtt_string_t topic_filter_s4 = {18, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x87, 0xe0, 0x3f, 0x0, 0xa1, 0xbc, 0x86, 0x45, 0xac, 0x34, 0x3e, 0x31};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x2e, 0xe9, 0xb5, 0x59, 0x92, 0x36, 0x8c, 0x9d, 0x9,  0xcd, 0xa1, 0x4d,
                                     0x6f, 0xd7, 0x35, 0xba, 0x1e, 0x42, 0x5f, 0x6,  0xdb, 0xba, 0xc,  0xee};
  lwmqtt_string_t topic_filter_s6 = {24, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x31, 0xae, 0x39, 0xfd, 0x87, 0x6f, 0xc9, 0xeb, 0x1d, 0xf3, 0xf0, 0x16, 0xb1, 0x6a,
                                     0x55, 0x79, 0x8d, 0xda, 0x9e, 0xfb, 0xe8, 0x50, 0x67, 0xa1, 0x16, 0xe,  0xa2};
  lwmqtt_string_t topic_filter_s7 = {27, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x89, 0x35, 0x75, 0x4,  0xd1, 0x14, 0x65, 0xb1, 0xc2, 0x48,
                                     0x15, 0x70, 0x3b, 0x51, 0xe4, 0x8,  0x95, 0xb2, 0xb6, 0x8c,
                                     0xd9, 0x3e, 0x21, 0x22, 0x2c, 0x1c, 0x9a, 0xa3, 0x31};
  lwmqtt_string_t topic_filter_s8 = {29, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbd, 0x72, 0xb9, 0x4b, 0x9b, 0xf7, 0x3a, 0x26, 0x81, 0x1c,
                                     0x7d, 0x1a, 0x88, 0xcd, 0xc6, 0x67, 0x6d, 0xca, 0xb7, 0x7c};
  lwmqtt_string_t topic_filter_s9 = {20, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x11, 0xc8, 0x9, 0x61, 0x97, 0x61, 0x64, 0x25, 0x95, 0xce, 0xeb,
                           0x8b, 0x2d, 0x3, 0xe0, 0x37, 0x6a, 0xa8, 0x5a, 0x45, 0x6,  0x2a};
  uint8_t bytesprops1[] = {0x4b, 0xb1, 0x59, 0x71, 0x22, 0xc7, 0xbe, 0xa8, 0x7,  0xa0, 0x13, 0x51,
                           0x36, 0x6f, 0xdd, 0x86, 0xa8, 0xce, 0xfe, 0x5c, 0x2e, 0x2a, 0x39};
  uint8_t bytesprops2[] = {0x4a, 0x82, 0x3b, 0xf2, 0x1e, 0xd5, 0xe6, 0x98, 0xa9, 0xf3};
  uint8_t bytesprops3[] = {0x43, 0x76, 0xa5, 0x37, 0xdb, 0xe4, 0x9,  0x2c, 0x3,  0x2f, 0x9f, 0xb0, 0xc8, 0x28, 0xe3,
                           0x48, 0x5c, 0x66, 0x20, 0xb2, 0x1c, 0x26, 0x6f, 0x8e, 0xac, 0x27, 0x44, 0xfa, 0x16};
  uint8_t bytesprops4[] = {0x83, 0x1b, 0x11, 0x6e, 0x72, 0x7f, 0xed, 0xeb, 0x1c, 0x6, 0xdc, 0xee};
  uint8_t bytesprops5[] = {0xfb, 0xc2, 0xa3, 0xd4, 0x60, 0x46, 0xa0, 0x1c, 0x35, 0x2e, 0xcf,
                           0x64, 0xf1, 0x44, 0x8a, 0xf0, 0x6e, 0x1b, 0x5e, 0x2a, 0x1b, 0xae};
  uint8_t bytesprops6[] = {0xe9, 0xb,  0xf4, 0xb9, 0x7f, 0x21, 0x36, 0x83, 0xf3, 0xe8, 0x3b, 0xad, 0x81,
                           0x61, 0xf2, 0xb0, 0x93, 0x8,  0xa1, 0xd1, 0x9c, 0x5a, 0xa9, 0x10, 0x2f};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 26951}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19408}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13738}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {23, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22953}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 20380}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 82}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 101}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 35}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26378}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 6332}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18541}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {10, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 38}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 12922}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {29, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {12, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&bytesprops6}}},
  };

  lwmqtt_properties_t props = {20, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4596, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12163 [("\r\156\"+\229.^L8\n\226%&\152\200\143De",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\233=P\128\f\151\147O\193\209\230l\183\&7Z\153\201\152z:\237\&8\STX\176Z\187\245\253",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\154\238U\255\128\128\129\222",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\178\STX7\173\221\210\128$\v\SOHQ\223\172\129",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("J\179\253\197\215CRg\185\217\STX1\223\&5\213\&17\245y\\h\154\DC4Jz\238\168\243\DC3!",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("G-\208\165h?\SO\131[\DC1",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\193\175\185E?\229\197iQ\ETX\234\174%\176\197\223\197\DLE\233M\211\250X\185wU",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropUserProperty
// "\199\SOH\DC4\"W\246\183`Q\194\223\255\154\197K\148\241o#B\212\156\133\203\193\248`\""
// "x\ESC\ETX4\207\FS\NAK\208\RSy",PropMaximumQoS 201,PropWillDelayInterval 10233,PropServerKeepAlive
// 20327,PropRequestProblemInformation 208,PropServerReference
// "\171\ETX\253Y\160\DC2\DC3n",PropRequestProblemInformation 23,PropSessionExpiryInterval
// 11687,PropMessageExpiryInterval 21409,PropContentType
// "\136\199\FSr\187\&1\187\225\&2Wu#",PropAssignedClientIdentifier
// "\SO\b\183\194\136\ENQW!\DC2\DC3\202\216[\200\148\168",PropMaximumPacketSize 20756,PropReceiveMaximum
// 23959,PropReceiveMaximum 15319,PropSubscriptionIdentifier 22,PropSubscriptionIdentifier
// 2,PropWildcardSubscriptionAvailable 114,PropReceiveMaximum 5175,PropAssignedClientIdentifier
// "a:\164\135\SYNk\182m\USl=\252\201\&8O\183\244p7\205pN\197\STX\188e\164\160\211",PropWildcardSubscriptionAvailable
// 0,PropMaximumQoS 212,PropSubscriptionIdentifierAvailable 170,PropRequestProblemInformation 179,PropWillDelayInterval
// 2439,PropRetainAvailable 181,PropServerReference "'\252\ACK\177",PropResponseInformation
// "\133\243",PropWildcardSubscriptionAvailable 194,PropMessageExpiryInterval 30882,PropAuthenticationMethod
// "\175\DC1\SUB\181\187=Q\225\SYN\135\&3wYc"]
TEST(Subscribe5QCTest, Encode19) {
  uint8_t pkt[] = {
      0x82, 0xf6, 0x2,  0x2f, 0x83, 0xd7, 0x1,  0x26, 0x0,  0x1c, 0xc7, 0x1,  0x14, 0x22, 0x57, 0xf6, 0xb7, 0x60, 0x51,
      0xc2, 0xdf, 0xff, 0x9a, 0xc5, 0x4b, 0x94, 0xf1, 0x6f, 0x23, 0x42, 0xd4, 0x9c, 0x85, 0xcb, 0xc1, 0xf8, 0x60, 0x22,
      0x0,  0xa,  0x78, 0x1b, 0x3,  0x34, 0xcf, 0x1c, 0x15, 0xd0, 0x1e, 0x79, 0x24, 0xc9, 0x18, 0x0,  0x0,  0x27, 0xf9,
      0x13, 0x4f, 0x67, 0x17, 0xd0, 0x1c, 0x0,  0x8,  0xab, 0x3,  0xfd, 0x59, 0xa0, 0x12, 0x13, 0x6e, 0x17, 0x17, 0x11,
      0x0,  0x0,  0x2d, 0xa7, 0x2,  0x0,  0x0,  0x53, 0xa1, 0x3,  0x0,  0xc,  0x88, 0xc7, 0x1c, 0x72, 0xbb, 0x31, 0xbb,
      0xe1, 0x32, 0x57, 0x75, 0x23, 0x12, 0x0,  0x10, 0xe,  0x8,  0xb7, 0xc2, 0x88, 0x5,  0x57, 0x21, 0x12, 0x13, 0xca,
      0xd8, 0x5b, 0xc8, 0x94, 0xa8, 0x27, 0x0,  0x0,  0x51, 0x14, 0x21, 0x5d, 0x97, 0x21, 0x3b, 0xd7, 0xb,  0x16, 0xb,
      0x2,  0x28, 0x72, 0x21, 0x14, 0x37, 0x12, 0x0,  0x1d, 0x61, 0x3a, 0xa4, 0x87, 0x16, 0x6b, 0xb6, 0x6d, 0x1f, 0x6c,
      0x3d, 0xfc, 0xc9, 0x38, 0x4f, 0xb7, 0xf4, 0x70, 0x37, 0xcd, 0x70, 0x4e, 0xc5, 0x2,  0xbc, 0x65, 0xa4, 0xa0, 0xd3,
      0x28, 0x0,  0x24, 0xd4, 0x29, 0xaa, 0x17, 0xb3, 0x18, 0x0,  0x0,  0x9,  0x87, 0x25, 0xb5, 0x1c, 0x0,  0x4,  0x27,
      0xfc, 0x6,  0xb1, 0x1a, 0x0,  0x2,  0x85, 0xf3, 0x28, 0xc2, 0x2,  0x0,  0x0,  0x78, 0xa2, 0x15, 0x0,  0xe,  0xaf,
      0x11, 0x1a, 0xb5, 0xbb, 0x3d, 0x51, 0xe1, 0x16, 0x87, 0x33, 0x77, 0x59, 0x63, 0x0,  0x12, 0xd,  0x9c, 0x22, 0x2b,
      0xe5, 0x2e, 0x5e, 0x4c, 0x38, 0xa,  0xe2, 0x25, 0x26, 0x98, 0xc8, 0x8f, 0x44, 0x65, 0x0,  0x0,  0x1c, 0xe9, 0x3d,
      0x50, 0x80, 0xc,  0x97, 0x93, 0x4f, 0xc1, 0xd1, 0xe6, 0x6c, 0xb7, 0x37, 0x5a, 0x99, 0xc9, 0x98, 0x7a, 0x3a, 0xed,
      0x38, 0x2,  0xb0, 0x5a, 0xbb, 0xf5, 0xfd, 0x2,  0x0,  0x8,  0x9a, 0xee, 0x55, 0xff, 0x80, 0x80, 0x81, 0xde, 0x2,
      0x0,  0xe,  0xb2, 0x2,  0x37, 0xad, 0xdd, 0xd2, 0x80, 0x24, 0xb,  0x1,  0x51, 0xdf, 0xac, 0x81, 0x2,  0x0,  0x1e,
      0x4a, 0xb3, 0xfd, 0xc5, 0xd7, 0x43, 0x52, 0x67, 0xb9, 0xd9, 0x2,  0x31, 0xdf, 0x35, 0xd5, 0x31, 0x37, 0xf5, 0x79,
      0x5c, 0x68, 0x9a, 0x14, 0x4a, 0x7a, 0xee, 0xa8, 0xf3, 0x13, 0x21, 0x0,  0x0,  0xa,  0x47, 0x2d, 0xd0, 0xa5, 0x68,
      0x3f, 0xe,  0x83, 0x5b, 0x11, 0x2,  0x0,  0x1a, 0xc1, 0xaf, 0xb9, 0x45, 0x3f, 0xe5, 0xc5, 0x69, 0x51, 0x3,  0xea,
      0xae, 0x25, 0xb0, 0xc5, 0xdf, 0xc5, 0x10, 0xe9, 0x4d, 0xd3, 0xfa, 0x58, 0xb9, 0x77, 0x55, 0x2};

  uint8_t buf[387] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xd, 0x9c, 0x22, 0x2b, 0xe5, 0x2e, 0x5e, 0x4c, 0x38,
                                     0xa, 0xe2, 0x25, 0x26, 0x98, 0xc8, 0x8f, 0x44, 0x65};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xe9, 0x3d, 0x50, 0x80, 0xc,  0x97, 0x93, 0x4f, 0xc1, 0xd1,
                                     0xe6, 0x6c, 0xb7, 0x37, 0x5a, 0x99, 0xc9, 0x98, 0x7a, 0x3a,
                                     0xed, 0x38, 0x2,  0xb0, 0x5a, 0xbb, 0xf5, 0xfd};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x9a, 0xee, 0x55, 0xff, 0x80, 0x80, 0x81, 0xde};
  lwmqtt_string_t topic_filter_s2 = {8, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb2, 0x2, 0x37, 0xad, 0xdd, 0xd2, 0x80, 0x24, 0xb, 0x1, 0x51, 0xdf, 0xac, 0x81};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4a, 0xb3, 0xfd, 0xc5, 0xd7, 0x43, 0x52, 0x67, 0xb9, 0xd9,
                                     0x2,  0x31, 0xdf, 0x35, 0xd5, 0x31, 0x37, 0xf5, 0x79, 0x5c,
                                     0x68, 0x9a, 0x14, 0x4a, 0x7a, 0xee, 0xa8, 0xf3, 0x13, 0x21};
  lwmqtt_string_t topic_filter_s4 = {30, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x47, 0x2d, 0xd0, 0xa5, 0x68, 0x3f, 0xe, 0x83, 0x5b, 0x11};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc1, 0xaf, 0xb9, 0x45, 0x3f, 0xe5, 0xc5, 0x69, 0x51, 0x3,  0xea, 0xae, 0x25,
                                     0xb0, 0xc5, 0xdf, 0xc5, 0x10, 0xe9, 0x4d, 0xd3, 0xfa, 0x58, 0xb9, 0x77, 0x55};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops1[] = {0x78, 0x1b, 0x3, 0x34, 0xcf, 0x1c, 0x15, 0xd0, 0x1e, 0x79};
  uint8_t bytesprops0[] = {0xc7, 0x1,  0x14, 0x22, 0x57, 0xf6, 0xb7, 0x60, 0x51, 0xc2, 0xdf, 0xff, 0x9a, 0xc5,
                           0x4b, 0x94, 0xf1, 0x6f, 0x23, 0x42, 0xd4, 0x9c, 0x85, 0xcb, 0xc1, 0xf8, 0x60, 0x22};
  uint8_t bytesprops2[] = {0xab, 0x3, 0xfd, 0x59, 0xa0, 0x12, 0x13, 0x6e};
  uint8_t bytesprops3[] = {0x88, 0xc7, 0x1c, 0x72, 0xbb, 0x31, 0xbb, 0xe1, 0x32, 0x57, 0x75, 0x23};
  uint8_t bytesprops4[] = {0xe, 0x8, 0xb7, 0xc2, 0x88, 0x5, 0x57, 0x21, 0x12, 0x13, 0xca, 0xd8, 0x5b, 0xc8, 0x94, 0xa8};
  uint8_t bytesprops5[] = {0x61, 0x3a, 0xa4, 0x87, 0x16, 0x6b, 0xb6, 0x6d, 0x1f, 0x6c, 0x3d, 0xfc, 0xc9, 0x38, 0x4f,
                           0xb7, 0xf4, 0x70, 0x37, 0xcd, 0x70, 0x4e, 0xc5, 0x2,  0xbc, 0x65, 0xa4, 0xa0, 0xd3};
  uint8_t bytesprops6[] = {0x27, 0xfc, 0x6, 0xb1};
  uint8_t bytesprops7[] = {0x85, 0xf3};
  uint8_t bytesprops8[] = {0xaf, 0x11, 0x1a, 0xb5, 0xbb, 0x3d, 0x51, 0xe1, 0x16, 0x87, 0x33, 0x77, 0x59, 0x63};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {28, (char*)&bytesprops0}, .v = {10, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 201}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 10233}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20327}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 208}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {8, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 23}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11687}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21409}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {12, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20756}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 23959}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15319}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 22}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 2}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 114}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 5175}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 0}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 212}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 170}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 179}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 2439}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 181}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 194}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30882}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12163, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21672 [(":f\201\245\150t\153",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("g^\195\215\\\138\194\147\188\181W\136",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\163\181\241IK\nA\212\254d\216",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] [PropCorrelationData "\US\225\249\235f=\176\228\234.",PropReasonString
// "-A\ACKM\206",PropRequestResponseInformation 8,PropUserProperty
// "h\r\185e\243\196\159\a\191\"!\160\193\DC46\128A\185,)gx\190"
// "\146,\136=~\194G\ri\ESC\ENQE\132\SYN\242\242G",PropMessageExpiryInterval 32206,PropMessageExpiryInterval
// 11439,PropUserProperty "t\252\251\235\172\255\234\204\b\SYN\170\148'\184z\t\139\212&\150H\\\184\223"
// "jS\144\130\ESCx\140\GS\221O\182\EM\ESCX\156",PropReceiveMaximum 19536,PropAssignedClientIdentifier
// "ij\232z+\133\ETB]]\148-,Ai\129\205\172\195d\175W$\236O",PropUserProperty
// "\239\192\\\153\166\ACK\ENQ_\224\131^k3\221\137\137\251B"
// "\203\NAK\180\150\USWn\\\235NF@\220\228\206=*",PropTopicAliasMaximum 13940,PropAssignedClientIdentifier
// "N0~\ETX;\185!S\STX\210M\148\186\206\SUB_",PropRequestResponseInformation 88,PropTopicAliasMaximum
// 12386,PropMaximumPacketSize 7196,PropAuthenticationMethod
// "\166\231p\217\241\205&\167Os\240\US.\151\197",PropTopicAliasMaximum 16731,PropAuthenticationMethod
// "+\175\&7c\141[\EM\204\202\222",PropSubscriptionIdentifierAvailable 86,PropAuthenticationData
// "S\214\FS\243\b\139Qt\130\132\ENQ\206\144\STX\142v\STX\DC1\197o\220E\131",PropCorrelationData
// "\244H\174",PropMaximumPacketSize 4306,PropMessageExpiryInterval 10977,PropMessageExpiryInterval
// 14925,PropRequestProblemInformation 220]
TEST(Subscribe5QCTest, Encode20) {
  uint8_t pkt[] = {
      0x82, 0xe0, 0x2,  0x54, 0xa8, 0xb5, 0x2,  0x9,  0x0,  0xa,  0x1f, 0xe1, 0xf9, 0xeb, 0x66, 0x3d, 0xb0, 0xe4, 0xea,
      0x2e, 0x1f, 0x0,  0x5,  0x2d, 0x41, 0x6,  0x4d, 0xce, 0x19, 0x8,  0x26, 0x0,  0x17, 0x68, 0xd,  0xb9, 0x65, 0xf3,
      0xc4, 0x9f, 0x7,  0xbf, 0x22, 0x21, 0xa0, 0xc1, 0x14, 0x36, 0x80, 0x41, 0xb9, 0x2c, 0x29, 0x67, 0x78, 0xbe, 0x0,
      0x11, 0x92, 0x2c, 0x88, 0x3d, 0x7e, 0xc2, 0x47, 0xd,  0x69, 0x1b, 0x5,  0x45, 0x84, 0x16, 0xf2, 0xf2, 0x47, 0x2,
      0x0,  0x0,  0x7d, 0xce, 0x2,  0x0,  0x0,  0x2c, 0xaf, 0x26, 0x0,  0x18, 0x74, 0xfc, 0xfb, 0xeb, 0xac, 0xff, 0xea,
      0xcc, 0x8,  0x16, 0xaa, 0x94, 0x27, 0xb8, 0x7a, 0x9,  0x8b, 0xd4, 0x26, 0x96, 0x48, 0x5c, 0xb8, 0xdf, 0x0,  0xf,
      0x6a, 0x53, 0x90, 0x82, 0x1b, 0x78, 0x8c, 0x1d, 0xdd, 0x4f, 0xb6, 0x19, 0x1b, 0x58, 0x9c, 0x21, 0x4c, 0x50, 0x12,
      0x0,  0x18, 0x69, 0x6a, 0xe8, 0x7a, 0x2b, 0x85, 0x17, 0x5d, 0x5d, 0x94, 0x2d, 0x2c, 0x41, 0x69, 0x81, 0xcd, 0xac,
      0xc3, 0x64, 0xaf, 0x57, 0x24, 0xec, 0x4f, 0x26, 0x0,  0x12, 0xef, 0xc0, 0x5c, 0x99, 0xa6, 0x6,  0x5,  0x5f, 0xe0,
      0x83, 0x5e, 0x6b, 0x33, 0xdd, 0x89, 0x89, 0xfb, 0x42, 0x0,  0x11, 0xcb, 0x15, 0xb4, 0x96, 0x1f, 0x57, 0x6e, 0x5c,
      0xeb, 0x4e, 0x46, 0x40, 0xdc, 0xe4, 0xce, 0x3d, 0x2a, 0x22, 0x36, 0x74, 0x12, 0x0,  0x10, 0x4e, 0x30, 0x7e, 0x3,
      0x3b, 0xb9, 0x21, 0x53, 0x2,  0xd2, 0x4d, 0x94, 0xba, 0xce, 0x1a, 0x5f, 0x19, 0x58, 0x22, 0x30, 0x62, 0x27, 0x0,
      0x0,  0x1c, 0x1c, 0x15, 0x0,  0xf,  0xa6, 0xe7, 0x70, 0xd9, 0xf1, 0xcd, 0x26, 0xa7, 0x4f, 0x73, 0xf0, 0x1f, 0x2e,
      0x97, 0xc5, 0x22, 0x41, 0x5b, 0x15, 0x0,  0xa,  0x2b, 0xaf, 0x37, 0x63, 0x8d, 0x5b, 0x19, 0xcc, 0xca, 0xde, 0x29,
      0x56, 0x16, 0x0,  0x17, 0x53, 0xd6, 0x1c, 0xf3, 0x8,  0x8b, 0x51, 0x74, 0x82, 0x84, 0x5,  0xce, 0x90, 0x2,  0x8e,
      0x76, 0x2,  0x11, 0xc5, 0x6f, 0xdc, 0x45, 0x83, 0x9,  0x0,  0x3,  0xf4, 0x48, 0xae, 0x27, 0x0,  0x0,  0x10, 0xd2,
      0x2,  0x0,  0x0,  0x2a, 0xe1, 0x2,  0x0,  0x0,  0x3a, 0x4d, 0x17, 0xdc, 0x0,  0x7,  0x3a, 0x66, 0xc9, 0xf5, 0x96,
      0x74, 0x99, 0x1,  0x0,  0xc,  0x67, 0x5e, 0xc3, 0xd7, 0x5c, 0x8a, 0xc2, 0x93, 0xbc, 0xb5, 0x57, 0x88, 0x0,  0x0,
      0xb,  0xa3, 0xb5, 0xf1, 0x49, 0x4b, 0xa,  0x41, 0xd4, 0xfe, 0x64, 0xd8, 0x0};

  uint8_t buf[365] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x3a, 0x66, 0xc9, 0xf5, 0x96, 0x74, 0x99};
  lwmqtt_string_t topic_filter_s0 = {7, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x67, 0x5e, 0xc3, 0xd7, 0x5c, 0x8a, 0xc2, 0x93, 0xbc, 0xb5, 0x57, 0x88};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa3, 0xb5, 0xf1, 0x49, 0x4b, 0xa, 0x41, 0xd4, 0xfe, 0x64, 0xd8};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x1f, 0xe1, 0xf9, 0xeb, 0x66, 0x3d, 0xb0, 0xe4, 0xea, 0x2e};
  uint8_t bytesprops1[] = {0x2d, 0x41, 0x6, 0x4d, 0xce};
  uint8_t bytesprops3[] = {0x92, 0x2c, 0x88, 0x3d, 0x7e, 0xc2, 0x47, 0xd, 0x69,
                           0x1b, 0x5,  0x45, 0x84, 0x16, 0xf2, 0xf2, 0x47};
  uint8_t bytesprops2[] = {0x68, 0xd,  0xb9, 0x65, 0xf3, 0xc4, 0x9f, 0x7,  0xbf, 0x22, 0x21, 0xa0,
                           0xc1, 0x14, 0x36, 0x80, 0x41, 0xb9, 0x2c, 0x29, 0x67, 0x78, 0xbe};
  uint8_t bytesprops5[] = {0x6a, 0x53, 0x90, 0x82, 0x1b, 0x78, 0x8c, 0x1d, 0xdd, 0x4f, 0xb6, 0x19, 0x1b, 0x58, 0x9c};
  uint8_t bytesprops4[] = {0x74, 0xfc, 0xfb, 0xeb, 0xac, 0xff, 0xea, 0xcc, 0x8,  0x16, 0xaa, 0x94,
                           0x27, 0xb8, 0x7a, 0x9,  0x8b, 0xd4, 0x26, 0x96, 0x48, 0x5c, 0xb8, 0xdf};
  uint8_t bytesprops6[] = {0x69, 0x6a, 0xe8, 0x7a, 0x2b, 0x85, 0x17, 0x5d, 0x5d, 0x94, 0x2d, 0x2c,
                           0x41, 0x69, 0x81, 0xcd, 0xac, 0xc3, 0x64, 0xaf, 0x57, 0x24, 0xec, 0x4f};
  uint8_t bytesprops8[] = {0xcb, 0x15, 0xb4, 0x96, 0x1f, 0x57, 0x6e, 0x5c, 0xeb,
                           0x4e, 0x46, 0x40, 0xdc, 0xe4, 0xce, 0x3d, 0x2a};
  uint8_t bytesprops7[] = {0xef, 0xc0, 0x5c, 0x99, 0xa6, 0x6,  0x5,  0x5f, 0xe0,
                           0x83, 0x5e, 0x6b, 0x33, 0xdd, 0x89, 0x89, 0xfb, 0x42};
  uint8_t bytesprops9[] = {0x4e, 0x30, 0x7e, 0x3,  0x3b, 0xb9, 0x21, 0x53,
                           0x2,  0xd2, 0x4d, 0x94, 0xba, 0xce, 0x1a, 0x5f};
  uint8_t bytesprops10[] = {0xa6, 0xe7, 0x70, 0xd9, 0xf1, 0xcd, 0x26, 0xa7, 0x4f, 0x73, 0xf0, 0x1f, 0x2e, 0x97, 0xc5};
  uint8_t bytesprops11[] = {0x2b, 0xaf, 0x37, 0x63, 0x8d, 0x5b, 0x19, 0xcc, 0xca, 0xde};
  uint8_t bytesprops12[] = {0x53, 0xd6, 0x1c, 0xf3, 0x8, 0x8b, 0x51, 0x74, 0x82, 0x84, 0x5, 0xce,
                            0x90, 0x2,  0x8e, 0x76, 0x2, 0x11, 0xc5, 0x6f, 0xdc, 0x45, 0x83};
  uint8_t bytesprops13[] = {0xf4, 0x48, 0xae};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {5, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 8}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {23, (char*)&bytesprops2}, .v = {17, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32206}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11439}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {24, (char*)&bytesprops4}, .v = {15, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19536}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {18, (char*)&bytesprops7}, .v = {17, (char*)&bytesprops8}}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13940}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 88}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 12386}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7196}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {15, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 16731}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 86}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {23, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {3, (char*)&bytesprops13}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 4306}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10977}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14925}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 220}},
  };

  lwmqtt_properties_t props = {25, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21672, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2811 [("\232\155/\190\204\180\EOT\185\187J",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\204\150\224\190\140\164\182\211\159\f`\DC1",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\246te&\248u\229%^L\158\FSG\SYNQPL\237b\SOH\240\185",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("k\ETX\f\tX\164\ETX",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropServerKeepAlive
// 22588,PropServerReference "",PropResponseTopic "\SO\214\\kc",PropRequestProblemInformation 203,PropServerReference
// "u\190\167\137\DC2\205v\US\145 \215\181h\f",PropResponseInformation "\236ri\GS\150\151g1\194i\199
// \252\140H9\174\204L\176\210tH\226\&4\213\147",PropMaximumPacketSize 17747,PropAuthenticationData
// "\139\f\232/3`\181\213`\253",PropAuthenticationData
// "20^\232]\215\251\227\&1\197_P5\"\144\SI\240#3RT\143\USj\202\DC1\174\250",PropAuthenticationMethod
// "3\185_\193\138\156\205\142=(k",PropSubscriptionIdentifierAvailable 30,PropResponseInformation
// "BE\229\205:\193",PropAssignedClientIdentifier
// "\129R\153C!\133}\220\131z\173m\ESC\239\201\EOT\255\239\ETXi\n\233",PropCorrelationData
// "\152-\152~\157\\",PropRequestResponseInformation 213,PropAuthenticationMethod
// "l\217\159r\ETXY\161\211\145\203\244\138\164\177%tv\203\&6\136\ETX\209\228\216\136\221Xy\179",PropAuthenticationMethod
// "\205#\141\&9\185\152\DLEm\RS\RS\231\239\STXZ\227O9t\167}\136\212\227>\191\128\EMC\196!",PropMessageExpiryInterval
// 7170,PropMaximumQoS 100,PropMessageExpiryInterval 3938,PropRequestResponseInformation 12]
TEST(Subscribe5QCTest, Encode21) {
  uint8_t pkt[] = {
      0x82, 0xbf, 0x2,  0xa,  0xfb, 0xfc, 0x1,  0x13, 0x58, 0x3c, 0x1c, 0x0,  0x0,  0x8,  0x0,  0x5,  0xe,  0xd6, 0x5c,
      0x6b, 0x63, 0x17, 0xcb, 0x1c, 0x0,  0xe,  0x75, 0xbe, 0xa7, 0x89, 0x12, 0xcd, 0x76, 0x1f, 0x91, 0x20, 0xd7, 0xb5,
      0x68, 0xc,  0x1a, 0x0,  0x1b, 0xec, 0x72, 0x69, 0x1d, 0x96, 0x97, 0x67, 0x31, 0xc2, 0x69, 0xc7, 0x20, 0xfc, 0x8c,
      0x48, 0x39, 0xae, 0xcc, 0x4c, 0xb0, 0xd2, 0x74, 0x48, 0xe2, 0x34, 0xd5, 0x93, 0x27, 0x0,  0x0,  0x45, 0x53, 0x16,
      0x0,  0xa,  0x8b, 0xc,  0xe8, 0x2f, 0x33, 0x60, 0xb5, 0xd5, 0x60, 0xfd, 0x16, 0x0,  0x1c, 0x32, 0x30, 0x5e, 0xe8,
      0x5d, 0xd7, 0xfb, 0xe3, 0x31, 0xc5, 0x5f, 0x50, 0x35, 0x22, 0x90, 0xf,  0xf0, 0x23, 0x33, 0x52, 0x54, 0x8f, 0x1f,
      0x6a, 0xca, 0x11, 0xae, 0xfa, 0x15, 0x0,  0xb,  0x33, 0xb9, 0x5f, 0xc1, 0x8a, 0x9c, 0xcd, 0x8e, 0x3d, 0x28, 0x6b,
      0x29, 0x1e, 0x1a, 0x0,  0x6,  0x42, 0x45, 0xe5, 0xcd, 0x3a, 0xc1, 0x12, 0x0,  0x16, 0x81, 0x52, 0x99, 0x43, 0x21,
      0x85, 0x7d, 0xdc, 0x83, 0x7a, 0xad, 0x6d, 0x1b, 0xef, 0xc9, 0x4,  0xff, 0xef, 0x3,  0x69, 0xa,  0xe9, 0x9,  0x0,
      0x6,  0x98, 0x2d, 0x98, 0x7e, 0x9d, 0x5c, 0x19, 0xd5, 0x15, 0x0,  0x1d, 0x6c, 0xd9, 0x9f, 0x72, 0x3,  0x59, 0xa1,
      0xd3, 0x91, 0xcb, 0xf4, 0x8a, 0xa4, 0xb1, 0x25, 0x74, 0x76, 0xcb, 0x36, 0x88, 0x3,  0xd1, 0xe4, 0xd8, 0x88, 0xdd,
      0x58, 0x79, 0xb3, 0x15, 0x0,  0x1e, 0xcd, 0x23, 0x8d, 0x39, 0xb9, 0x98, 0x10, 0x6d, 0x1e, 0x1e, 0xe7, 0xef, 0x2,
      0x5a, 0xe3, 0x4f, 0x39, 0x74, 0xa7, 0x7d, 0x88, 0xd4, 0xe3, 0x3e, 0xbf, 0x80, 0x19, 0x43, 0xc4, 0x21, 0x2,  0x0,
      0x0,  0x1c, 0x2,  0x24, 0x64, 0x2,  0x0,  0x0,  0xf,  0x62, 0x19, 0xc,  0x0,  0xa,  0xe8, 0x9b, 0x2f, 0xbe, 0xcc,
      0xb4, 0x4,  0xb9, 0xbb, 0x4a, 0x1,  0x0,  0xc,  0xcc, 0x96, 0xe0, 0xbe, 0x8c, 0xa4, 0xb6, 0xd3, 0x9f, 0xc,  0x60,
      0x11, 0x2,  0x0,  0x16, 0xf6, 0x74, 0x65, 0x26, 0xf8, 0x75, 0xe5, 0x25, 0x5e, 0x4c, 0x9e, 0x1c, 0x47, 0x16, 0x51,
      0x50, 0x4c, 0xed, 0x62, 0x1,  0xf0, 0xb9, 0x0,  0x0,  0x7,  0x6b, 0x3,  0xc,  0x9,  0x58, 0xa4, 0x3,  0x1};

  uint8_t buf[332] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xe8, 0x9b, 0x2f, 0xbe, 0xcc, 0xb4, 0x4, 0xb9, 0xbb, 0x4a};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcc, 0x96, 0xe0, 0xbe, 0x8c, 0xa4, 0xb6, 0xd3, 0x9f, 0xc, 0x60, 0x11};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf6, 0x74, 0x65, 0x26, 0xf8, 0x75, 0xe5, 0x25, 0x5e, 0x4c, 0x9e,
                                     0x1c, 0x47, 0x16, 0x51, 0x50, 0x4c, 0xed, 0x62, 0x1,  0xf0, 0xb9};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6b, 0x3, 0xc, 0x9, 0x58, 0xa4, 0x3};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0xe, 0xd6, 0x5c, 0x6b, 0x63};
  uint8_t bytesprops2[] = {0x75, 0xbe, 0xa7, 0x89, 0x12, 0xcd, 0x76, 0x1f, 0x91, 0x20, 0xd7, 0xb5, 0x68, 0xc};
  uint8_t bytesprops3[] = {0xec, 0x72, 0x69, 0x1d, 0x96, 0x97, 0x67, 0x31, 0xc2, 0x69, 0xc7, 0x20, 0xfc, 0x8c,
                           0x48, 0x39, 0xae, 0xcc, 0x4c, 0xb0, 0xd2, 0x74, 0x48, 0xe2, 0x34, 0xd5, 0x93};
  uint8_t bytesprops4[] = {0x8b, 0xc, 0xe8, 0x2f, 0x33, 0x60, 0xb5, 0xd5, 0x60, 0xfd};
  uint8_t bytesprops5[] = {0x32, 0x30, 0x5e, 0xe8, 0x5d, 0xd7, 0xfb, 0xe3, 0x31, 0xc5, 0x5f, 0x50, 0x35, 0x22,
                           0x90, 0xf,  0xf0, 0x23, 0x33, 0x52, 0x54, 0x8f, 0x1f, 0x6a, 0xca, 0x11, 0xae, 0xfa};
  uint8_t bytesprops6[] = {0x33, 0xb9, 0x5f, 0xc1, 0x8a, 0x9c, 0xcd, 0x8e, 0x3d, 0x28, 0x6b};
  uint8_t bytesprops7[] = {0x42, 0x45, 0xe5, 0xcd, 0x3a, 0xc1};
  uint8_t bytesprops8[] = {0x81, 0x52, 0x99, 0x43, 0x21, 0x85, 0x7d, 0xdc, 0x83, 0x7a, 0xad,
                           0x6d, 0x1b, 0xef, 0xc9, 0x4,  0xff, 0xef, 0x3,  0x69, 0xa,  0xe9};
  uint8_t bytesprops9[] = {0x98, 0x2d, 0x98, 0x7e, 0x9d, 0x5c};
  uint8_t bytesprops10[] = {0x6c, 0xd9, 0x9f, 0x72, 0x3,  0x59, 0xa1, 0xd3, 0x91, 0xcb, 0xf4, 0x8a, 0xa4, 0xb1, 0x25,
                            0x74, 0x76, 0xcb, 0x36, 0x88, 0x3,  0xd1, 0xe4, 0xd8, 0x88, 0xdd, 0x58, 0x79, 0xb3};
  uint8_t bytesprops11[] = {0xcd, 0x23, 0x8d, 0x39, 0xb9, 0x98, 0x10, 0x6d, 0x1e, 0x1e, 0xe7, 0xef, 0x2,  0x5a, 0xe3,
                            0x4f, 0x39, 0x74, 0xa7, 0x7d, 0x88, 0xd4, 0xe3, 0x3e, 0xbf, 0x80, 0x19, 0x43, 0xc4, 0x21};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22588}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 203}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {27, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 17747}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {10, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {28, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {11, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 30}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {29, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {30, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7170}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 100}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3938}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 12}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2811, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27615 [("\NAK\134\219\&6;\150\&1UX\155\237e\170\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("D\188\171\141\181i\189E\145\165\209^\172\DC3\184\&4\DC3\GS\221\USd\169UZ\156]\218",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("U\197\163\225\242\DELe\225y\183n'_\168\130\EOTv\134DS\164\148\vc=\226\240\215",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("%\220\143Z\STX\254s5\230\248\161\215\251k\222j2\132\174X\243\199\DC1\147\231",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\230\199yn\147I\171\f\206\152\247\ACK\246\205\&7i>7\137\ETXi",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("YLH\ETXb\224\237\198\151j\195\234\238",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NUL4\232",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1})] [PropReceiveMaximum 3944,PropResponseTopic "y`\151\a\136\219Y0x\163\134\148\250
// \209}\231",PropRequestProblemInformation 237,PropCorrelationData
// "\139\170\209\162\177n\149\NUL\DC4\ETB\142\183\175\202\234\169m\138\167a0\204\147\161\242\200\185\250\146\204",PropTopicAliasMaximum
// 32369,PropWildcardSubscriptionAvailable 198,PropMaximumPacketSize 19095,PropAssignedClientIdentifier
// "8L",PropServerReference
// "\225\SOH\ESC\NAK\167\162h?[\tfo\130F\251\227\214\&7J\EOT_\184\ENQ\136\193\223\157+",PropSubscriptionIdentifierAvailable
// 244,PropReasonString "\170V\146\DEL\147R}}\129\193\164\143\197\165[\225.%\156\&5R\213\194",PropUserProperty
// "\190\196\144y\243\201\161I\NULy\GS\234\251_(\242\US\221q2@\222\186\189x\189\129" "\201X\n
// \182\220P",PropWillDelayInterval 4591,PropSubscriptionIdentifierAvailable 212,PropResponseInformation
// "\ETXdcIt\a\GS\GSsp_BO",PropRequestProblemInformation 141,PropWillDelayInterval 26969,PropRequestProblemInformation
// 7,PropCorrelationData "\162\137+6\186\161V\133(\158\156\US\DC2`\207FQ\166\233>\224S\NUL\218R",PropServerReference
// "\SOH\184O_\237\167=\f\223\243Q\ETB\252\154\FSu\ETB>\151\219\131N\239l",PropRetainAvailable 116,PropServerKeepAlive
// 14370,PropTopicAlias 352,PropServerReference
// "\NUL\NUL8d\145\245\148\161\DC1\153N\183\129\172_\SYN\214.\200*=\189\142\DC1\150kL4",PropCorrelationData
// "\179{g0\EOT\195\129t\169_2\202y\255~-\239\254G\DC1+\EOT",PropWillDelayInterval 23938,PropMaximumQoS
// 131,PropWildcardSubscriptionAvailable 137,PropServerReference
// "?\SI\151S\130\GS$>(\140~\DLE\158$f(A\210'\132\&6",PropTopicAlias 20026]
TEST(Subscribe5QCTest, Encode22) {
  uint8_t pkt[] = {
      0x82, 0x85, 0x4,  0x6b, 0xdf, 0xe6, 0x2,  0x21, 0xf,  0x68, 0x8,  0x0,  0x11, 0x79, 0x60, 0x97, 0x7,  0x88, 0xdb,
      0x59, 0x30, 0x78, 0xa3, 0x86, 0x94, 0xfa, 0x20, 0xd1, 0x7d, 0xe7, 0x17, 0xed, 0x9,  0x0,  0x1e, 0x8b, 0xaa, 0xd1,
      0xa2, 0xb1, 0x6e, 0x95, 0x0,  0x14, 0x17, 0x8e, 0xb7, 0xaf, 0xca, 0xea, 0xa9, 0x6d, 0x8a, 0xa7, 0x61, 0x30, 0xcc,
      0x93, 0xa1, 0xf2, 0xc8, 0xb9, 0xfa, 0x92, 0xcc, 0x22, 0x7e, 0x71, 0x28, 0xc6, 0x27, 0x0,  0x0,  0x4a, 0x97, 0x12,
      0x0,  0x2,  0x38, 0x4c, 0x1c, 0x0,  0x1c, 0xe1, 0x1,  0x1b, 0x15, 0xa7, 0xa2, 0x68, 0x3f, 0x5b, 0x9,  0x66, 0x6f,
      0x82, 0x46, 0xfb, 0xe3, 0xd6, 0x37, 0x4a, 0x4,  0x5f, 0xb8, 0x5,  0x88, 0xc1, 0xdf, 0x9d, 0x2b, 0x29, 0xf4, 0x1f,
      0x0,  0x17, 0xaa, 0x56, 0x92, 0x7f, 0x93, 0x52, 0x7d, 0x7d, 0x81, 0xc1, 0xa4, 0x8f, 0xc5, 0xa5, 0x5b, 0xe1, 0x2e,
      0x25, 0x9c, 0x35, 0x52, 0xd5, 0xc2, 0x26, 0x0,  0x1b, 0xbe, 0xc4, 0x90, 0x79, 0xf3, 0xc9, 0xa1, 0x49, 0x0,  0x79,
      0x1d, 0xea, 0xfb, 0x5f, 0x28, 0xf2, 0x1f, 0xdd, 0x71, 0x32, 0x40, 0xde, 0xba, 0xbd, 0x78, 0xbd, 0x81, 0x0,  0x7,
      0xc9, 0x58, 0xa,  0x20, 0xb6, 0xdc, 0x50, 0x18, 0x0,  0x0,  0x11, 0xef, 0x29, 0xd4, 0x1a, 0x0,  0xd,  0x3,  0x64,
      0x63, 0x49, 0x74, 0x7,  0x1d, 0x1d, 0x73, 0x70, 0x5f, 0x42, 0x4f, 0x17, 0x8d, 0x18, 0x0,  0x0,  0x69, 0x59, 0x17,
      0x7,  0x9,  0x0,  0x19, 0xa2, 0x89, 0x2b, 0x36, 0xba, 0xa1, 0x56, 0x85, 0x28, 0x9e, 0x9c, 0x1f, 0x12, 0x60, 0xcf,
      0x46, 0x51, 0xa6, 0xe9, 0x3e, 0xe0, 0x53, 0x0,  0xda, 0x52, 0x1c, 0x0,  0x18, 0x1,  0xb8, 0x4f, 0x5f, 0xed, 0xa7,
      0x3d, 0xc,  0xdf, 0xf3, 0x51, 0x17, 0xfc, 0x9a, 0x1c, 0x75, 0x17, 0x3e, 0x97, 0xdb, 0x83, 0x4e, 0xef, 0x6c, 0x25,
      0x74, 0x13, 0x38, 0x22, 0x23, 0x1,  0x60, 0x1c, 0x0,  0x1c, 0x0,  0x0,  0x38, 0x64, 0x91, 0xf5, 0x94, 0xa1, 0x11,
      0x99, 0x4e, 0xb7, 0x81, 0xac, 0x5f, 0x16, 0xd6, 0x2e, 0xc8, 0x2a, 0x3d, 0xbd, 0x8e, 0x11, 0x96, 0x6b, 0x4c, 0x34,
      0x9,  0x0,  0x16, 0xb3, 0x7b, 0x67, 0x30, 0x4,  0xc3, 0x81, 0x74, 0xa9, 0x5f, 0x32, 0xca, 0x79, 0xff, 0x7e, 0x2d,
      0xef, 0xfe, 0x47, 0x11, 0x2b, 0x4,  0x18, 0x0,  0x0,  0x5d, 0x82, 0x24, 0x83, 0x28, 0x89, 0x1c, 0x0,  0x15, 0x3f,
      0xf,  0x97, 0x53, 0x82, 0x1d, 0x24, 0x3e, 0x28, 0x8c, 0x7e, 0x10, 0x9e, 0x24, 0x66, 0x28, 0x41, 0xd2, 0x27, 0x84,
      0x36, 0x23, 0x4e, 0x3a, 0x0,  0xe,  0x15, 0x86, 0xdb, 0x36, 0x3b, 0x96, 0x31, 0x55, 0x58, 0x9b, 0xed, 0x65, 0xaa,
      0xdd, 0x2,  0x0,  0x0,  0x2,  0x0,  0x1b, 0x44, 0xbc, 0xab, 0x8d, 0xb5, 0x69, 0xbd, 0x45, 0x91, 0xa5, 0xd1, 0x5e,
      0xac, 0x13, 0xb8, 0x34, 0x13, 0x1d, 0xdd, 0x1f, 0x64, 0xa9, 0x55, 0x5a, 0x9c, 0x5d, 0xda, 0x2,  0x0,  0x1c, 0x55,
      0xc5, 0xa3, 0xe1, 0xf2, 0x7f, 0x65, 0xe1, 0x79, 0xb7, 0x6e, 0x27, 0x5f, 0xa8, 0x82, 0x4,  0x76, 0x86, 0x44, 0x53,
      0xa4, 0x94, 0xb,  0x63, 0x3d, 0xe2, 0xf0, 0xd7, 0x2,  0x0,  0x19, 0x25, 0xdc, 0x8f, 0x5a, 0x2,  0xfe, 0x73, 0x35,
      0xe6, 0xf8, 0xa1, 0xd7, 0xfb, 0x6b, 0xde, 0x6a, 0x32, 0x84, 0xae, 0x58, 0xf3, 0xc7, 0x11, 0x93, 0xe7, 0x1,  0x0,
      0x15, 0xe6, 0xc7, 0x79, 0x6e, 0x93, 0x49, 0xab, 0xc,  0xce, 0x98, 0xf7, 0x6,  0xf6, 0xcd, 0x37, 0x69, 0x3e, 0x37,
      0x89, 0x3,  0x69, 0x1,  0x0,  0xd,  0x59, 0x4c, 0x48, 0x3,  0x62, 0xe0, 0xed, 0xc6, 0x97, 0x6a, 0xc3, 0xea, 0xee,
      0x0,  0x0,  0x3,  0x0,  0x34, 0xe8, 0x1};

  uint8_t buf[530] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x86, 0xdb, 0x36, 0x3b, 0x96, 0x31,
                                     0x55, 0x58, 0x9b, 0xed, 0x65, 0xaa, 0xdd};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x44, 0xbc, 0xab, 0x8d, 0xb5, 0x69, 0xbd, 0x45, 0x91, 0xa5, 0xd1, 0x5e, 0xac, 0x13,
                                     0xb8, 0x34, 0x13, 0x1d, 0xdd, 0x1f, 0x64, 0xa9, 0x55, 0x5a, 0x9c, 0x5d, 0xda};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x55, 0xc5, 0xa3, 0xe1, 0xf2, 0x7f, 0x65, 0xe1, 0x79, 0xb7,
                                     0x6e, 0x27, 0x5f, 0xa8, 0x82, 0x4,  0x76, 0x86, 0x44, 0x53,
                                     0xa4, 0x94, 0xb,  0x63, 0x3d, 0xe2, 0xf0, 0xd7};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x25, 0xdc, 0x8f, 0x5a, 0x2,  0xfe, 0x73, 0x35, 0xe6, 0xf8, 0xa1, 0xd7, 0xfb,
                                     0x6b, 0xde, 0x6a, 0x32, 0x84, 0xae, 0x58, 0xf3, 0xc7, 0x11, 0x93, 0xe7};
  lwmqtt_string_t topic_filter_s4 = {25, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe6, 0xc7, 0x79, 0x6e, 0x93, 0x49, 0xab, 0xc,  0xce, 0x98, 0xf7,
                                     0x6,  0xf6, 0xcd, 0x37, 0x69, 0x3e, 0x37, 0x89, 0x3,  0x69};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x59, 0x4c, 0x48, 0x3, 0x62, 0xe0, 0xed, 0xc6, 0x97, 0x6a, 0xc3, 0xea, 0xee};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x0, 0x34, 0xe8};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x79, 0x60, 0x97, 0x7,  0x88, 0xdb, 0x59, 0x30, 0x78,
                           0xa3, 0x86, 0x94, 0xfa, 0x20, 0xd1, 0x7d, 0xe7};
  uint8_t bytesprops1[] = {0x8b, 0xaa, 0xd1, 0xa2, 0xb1, 0x6e, 0x95, 0x0,  0x14, 0x17, 0x8e, 0xb7, 0xaf, 0xca, 0xea,
                           0xa9, 0x6d, 0x8a, 0xa7, 0x61, 0x30, 0xcc, 0x93, 0xa1, 0xf2, 0xc8, 0xb9, 0xfa, 0x92, 0xcc};
  uint8_t bytesprops2[] = {0x38, 0x4c};
  uint8_t bytesprops3[] = {0xe1, 0x1,  0x1b, 0x15, 0xa7, 0xa2, 0x68, 0x3f, 0x5b, 0x9,  0x66, 0x6f, 0x82, 0x46,
                           0xfb, 0xe3, 0xd6, 0x37, 0x4a, 0x4,  0x5f, 0xb8, 0x5,  0x88, 0xc1, 0xdf, 0x9d, 0x2b};
  uint8_t bytesprops4[] = {0xaa, 0x56, 0x92, 0x7f, 0x93, 0x52, 0x7d, 0x7d, 0x81, 0xc1, 0xa4, 0x8f,
                           0xc5, 0xa5, 0x5b, 0xe1, 0x2e, 0x25, 0x9c, 0x35, 0x52, 0xd5, 0xc2};
  uint8_t bytesprops6[] = {0xc9, 0x58, 0xa, 0x20, 0xb6, 0xdc, 0x50};
  uint8_t bytesprops5[] = {0xbe, 0xc4, 0x90, 0x79, 0xf3, 0xc9, 0xa1, 0x49, 0x0,  0x79, 0x1d, 0xea, 0xfb, 0x5f,
                           0x28, 0xf2, 0x1f, 0xdd, 0x71, 0x32, 0x40, 0xde, 0xba, 0xbd, 0x78, 0xbd, 0x81};
  uint8_t bytesprops7[] = {0x3, 0x64, 0x63, 0x49, 0x74, 0x7, 0x1d, 0x1d, 0x73, 0x70, 0x5f, 0x42, 0x4f};
  uint8_t bytesprops8[] = {0xa2, 0x89, 0x2b, 0x36, 0xba, 0xa1, 0x56, 0x85, 0x28, 0x9e, 0x9c, 0x1f, 0x12,
                           0x60, 0xcf, 0x46, 0x51, 0xa6, 0xe9, 0x3e, 0xe0, 0x53, 0x0,  0xda, 0x52};
  uint8_t bytesprops9[] = {0x1,  0xb8, 0x4f, 0x5f, 0xed, 0xa7, 0x3d, 0xc,  0xdf, 0xf3, 0x51, 0x17,
                           0xfc, 0x9a, 0x1c, 0x75, 0x17, 0x3e, 0x97, 0xdb, 0x83, 0x4e, 0xef, 0x6c};
  uint8_t bytesprops10[] = {0x0,  0x0,  0x38, 0x64, 0x91, 0xf5, 0x94, 0xa1, 0x11, 0x99, 0x4e, 0xb7, 0x81, 0xac,
                            0x5f, 0x16, 0xd6, 0x2e, 0xc8, 0x2a, 0x3d, 0xbd, 0x8e, 0x11, 0x96, 0x6b, 0x4c, 0x34};
  uint8_t bytesprops11[] = {0xb3, 0x7b, 0x67, 0x30, 0x4,  0xc3, 0x81, 0x74, 0xa9, 0x5f, 0x32,
                            0xca, 0x79, 0xff, 0x7e, 0x2d, 0xef, 0xfe, 0x47, 0x11, 0x2b, 0x4};
  uint8_t bytesprops12[] = {0x3f, 0xf,  0x97, 0x53, 0x82, 0x1d, 0x24, 0x3e, 0x28, 0x8c, 0x7e,
                            0x10, 0x9e, 0x24, 0x66, 0x28, 0x41, 0xd2, 0x27, 0x84, 0x36};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3944}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 237}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32369}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 198}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 19095}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {2, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {28, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 244}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {23, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {27, (char*)&bytesprops5}, .v = {7, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4591}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 212}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 141}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 26969}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 7}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {25, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 116}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 14370}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 352}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {28, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {22, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 23938}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 137}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 20026}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 27615, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14083 [("\135\234\FS",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("n\183\&9\DC1f\NUL@\185\255\185qq\STX\"\173\fJ\218\SUB",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\128p\197\DC1\162\160\171\171K\149\206 \ACK\145\202\142",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropUserProperty "\196"
// "\178\189\SOH\171\CAN\DLEf\EM\139\r\193\188\201\DC1x\244/\EOT}\151\&1\ETB\204\172",PropCorrelationData
// "\198\247%\146\202'\172",PropWildcardSubscriptionAvailable 255,PropServerReference "I@",PropTopicAliasMaximum
// 29613,PropAuthenticationMethod "\177\DC2P\ESC",PropAuthenticationMethod
// "\ENQ\167\214\183J\159u",PropWillDelayInterval 17943]
TEST(Subscribe5QCTest, Encode23) {
  uint8_t pkt[] = {0x82, 0x7a, 0x37, 0x3,  0x48, 0x26, 0x0,  0x1,  0xc4, 0x0,  0x18, 0xb2, 0xbd, 0x1,  0xab, 0x18,
                   0x10, 0x66, 0x19, 0x8b, 0xd,  0xc1, 0xbc, 0xc9, 0x11, 0x78, 0xf4, 0x2f, 0x4,  0x7d, 0x97, 0x31,
                   0x17, 0xcc, 0xac, 0x9,  0x0,  0x7,  0xc6, 0xf7, 0x25, 0x92, 0xca, 0x27, 0xac, 0x28, 0xff, 0x1c,
                   0x0,  0x2,  0x49, 0x40, 0x22, 0x73, 0xad, 0x15, 0x0,  0x4,  0xb1, 0x12, 0x50, 0x1b, 0x15, 0x0,
                   0x7,  0x5,  0xa7, 0xd6, 0xb7, 0x4a, 0x9f, 0x75, 0x18, 0x0,  0x0,  0x46, 0x17, 0x0,  0x3,  0x87,
                   0xea, 0x1c, 0x2,  0x0,  0x13, 0x6e, 0xb7, 0x39, 0x11, 0x66, 0x0,  0x40, 0xb9, 0xff, 0xb9, 0x71,
                   0x71, 0x2,  0x22, 0xad, 0xc,  0x4a, 0xda, 0x1a, 0x1,  0x0,  0x10, 0x80, 0x70, 0xc5, 0x11, 0xa2,
                   0xa0, 0xab, 0xab, 0x4b, 0x95, 0xce, 0x20, 0x6,  0x91, 0xca, 0x8e, 0x0};

  uint8_t buf[134] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x87, 0xea, 0x1c};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6e, 0xb7, 0x39, 0x11, 0x66, 0x0, 0x40, 0xb9, 0xff, 0xb9,
                                     0x71, 0x71, 0x2,  0x22, 0xad, 0xc, 0x4a, 0xda, 0x1a};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x80, 0x70, 0xc5, 0x11, 0xa2, 0xa0, 0xab, 0xab,
                                     0x4b, 0x95, 0xce, 0x20, 0x6,  0x91, 0xca, 0x8e};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0};
  uint8_t bytesprops1[] = {0xb2, 0xbd, 0x1,  0xab, 0x18, 0x10, 0x66, 0x19, 0x8b, 0xd,  0xc1, 0xbc,
                           0xc9, 0x11, 0x78, 0xf4, 0x2f, 0x4,  0x7d, 0x97, 0x31, 0x17, 0xcc, 0xac};
  uint8_t bytesprops0[] = {0xc4};
  uint8_t bytesprops2[] = {0xc6, 0xf7, 0x25, 0x92, 0xca, 0x27, 0xac};
  uint8_t bytesprops3[] = {0x49, 0x40};
  uint8_t bytesprops4[] = {0xb1, 0x12, 0x50, 0x1b};
  uint8_t bytesprops5[] = {0x5, 0xa7, 0xd6, 0xb7, 0x4a, 0x9f, 0x75};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {1, (char*)&bytesprops0}, .v = {24, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 255}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {2, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29613}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17943}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14083, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16713 [("\141D\238n\154\164\246$)\214WR\f v\189\185*\139\r\DLE\ESC\135\SOH\164\132",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\185\139@\EM\a\ETX\186\130\FS\DC4\149\129",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS1}),("\139\211\225\252\160\193\136\130\164\243{3h\210\157/\220\156Eg\147l52",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\254\153c\253\205\198H\213\STX\SYN\139d#\249ON\143{\v\NAK3Iwz\EOT|\GS\ESC:^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropSubscriptionIdentifier
// 27,PropSessionExpiryInterval 19874,PropTopicAlias 16501,PropSharedSubscriptionAvailable
// 94,PropAssignedClientIdentifier
// "\135\RS\176~j\DC13G\224\SO6\160\254\v\159\253\169\130\198",PropRequestProblemInformation 64,PropServerReference
// "1b\148\133\SUB\134\165\248\131",PropSharedSubscriptionAvailable 53,PropAuthenticationData
// "I6\144\178w\185\190\n7Y\195\230T",PropSessionExpiryInterval 54,PropTopicAlias 17109]
TEST(Subscribe5QCTest, Encode24) {
  uint8_t pkt[] = {0x82, 0xb5, 0x1,  0x41, 0x49, 0x4a, 0xb,  0x1b, 0x11, 0x0,  0x0,  0x4d, 0xa2, 0x23, 0x40, 0x75, 0x2a,
                   0x5e, 0x12, 0x0,  0x13, 0x87, 0x1e, 0xb0, 0x7e, 0x6a, 0x11, 0x33, 0x47, 0xe0, 0xe,  0x36, 0xa0, 0xfe,
                   0xb,  0x9f, 0xfd, 0xa9, 0x82, 0xc6, 0x17, 0x40, 0x1c, 0x0,  0x9,  0x31, 0x62, 0x94, 0x85, 0x1a, 0x86,
                   0xa5, 0xf8, 0x83, 0x2a, 0x35, 0x16, 0x0,  0xd,  0x49, 0x36, 0x90, 0xb2, 0x77, 0xb9, 0xbe, 0xa,  0x37,
                   0x59, 0xc3, 0xe6, 0x54, 0x11, 0x0,  0x0,  0x0,  0x36, 0x23, 0x42, 0xd5, 0x0,  0x1a, 0x8d, 0x44, 0xee,
                   0x6e, 0x9a, 0xa4, 0xf6, 0x24, 0x29, 0xd6, 0x57, 0x52, 0xc,  0x20, 0x76, 0xbd, 0xb9, 0x2a, 0x8b, 0xd,
                   0x10, 0x1b, 0x87, 0x1,  0xa4, 0x84, 0x2,  0x0,  0xc,  0xb9, 0x8b, 0x40, 0x19, 0x7,  0x3,  0xba, 0x82,
                   0x1c, 0x14, 0x95, 0x81, 0x1,  0x0,  0x18, 0x8b, 0xd3, 0xe1, 0xfc, 0xa0, 0xc1, 0x88, 0x82, 0xa4, 0xf3,
                   0x7b, 0x33, 0x68, 0xd2, 0x9d, 0x2f, 0xdc, 0x9c, 0x45, 0x67, 0x93, 0x6c, 0x35, 0x32, 0x1,  0x0,  0x1e,
                   0xfe, 0x99, 0x63, 0xfd, 0xcd, 0xc6, 0x48, 0xd5, 0x2,  0x16, 0x8b, 0x64, 0x23, 0xf9, 0x4f, 0x4e, 0x8f,
                   0x7b, 0xb,  0x15, 0x33, 0x49, 0x77, 0x7a, 0x4,  0x7c, 0x1d, 0x1b, 0x3a, 0x5e, 0x2};

  uint8_t buf[194] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x8d, 0x44, 0xee, 0x6e, 0x9a, 0xa4, 0xf6, 0x24, 0x29, 0xd6, 0x57, 0x52, 0xc,
                                     0x20, 0x76, 0xbd, 0xb9, 0x2a, 0x8b, 0xd,  0x10, 0x1b, 0x87, 0x1,  0xa4, 0x84};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb9, 0x8b, 0x40, 0x19, 0x7, 0x3, 0xba, 0x82, 0x1c, 0x14, 0x95, 0x81};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8b, 0xd3, 0xe1, 0xfc, 0xa0, 0xc1, 0x88, 0x82, 0xa4, 0xf3, 0x7b, 0x33,
                                     0x68, 0xd2, 0x9d, 0x2f, 0xdc, 0x9c, 0x45, 0x67, 0x93, 0x6c, 0x35, 0x32};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfe, 0x99, 0x63, 0xfd, 0xcd, 0xc6, 0x48, 0xd5, 0x2,  0x16,
                                     0x8b, 0x64, 0x23, 0xf9, 0x4f, 0x4e, 0x8f, 0x7b, 0xb,  0x15,
                                     0x33, 0x49, 0x77, 0x7a, 0x4,  0x7c, 0x1d, 0x1b, 0x3a, 0x5e};
  lwmqtt_string_t topic_filter_s3 = {30, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x87, 0x1e, 0xb0, 0x7e, 0x6a, 0x11, 0x33, 0x47, 0xe0, 0xe,
                           0x36, 0xa0, 0xfe, 0xb,  0x9f, 0xfd, 0xa9, 0x82, 0xc6};
  uint8_t bytesprops1[] = {0x31, 0x62, 0x94, 0x85, 0x1a, 0x86, 0xa5, 0xf8, 0x83};
  uint8_t bytesprops2[] = {0x49, 0x36, 0x90, 0xb2, 0x77, 0xb9, 0xbe, 0xa, 0x37, 0x59, 0xc3, 0xe6, 0x54};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 27}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19874}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 16501}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 94}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 64}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 53}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {13, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 54}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 17109}},
  };

  lwmqtt_properties_t props = {11, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 16713, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25471 [("
// g\199\217\146\253&\DC3\235\b\186\200\t\171\254\172\FS\140m\DC3\CAN\238F\224\187\190\171\242",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\179hw\206r\aC\GS\159\n\206\SUB\255$mE\EOTm]\210A\224",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("Vd\170\246\&2\v",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\230\130+\153\214\164\236\ENQas\251\192}h)\SOH\ESC{\189=\190\235'w\202\225\&4\223\ACK",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\221\&8F\142\&7\197\DC4\193\151\193@\EOT\151\ACK\146\157\239\149\STX\181\220\148\157\STX\224",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("l\160\229\230\146",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0})] [PropServerKeepAlive 17235,PropSharedSubscriptionAvailable
// 126,PropSubscriptionIdentifierAvailable 74,PropAuthenticationData
// "o\198\221\DC2H4\149>\169\142\223\199$\202\NUL\146\142\SOH\163_",PropSessionExpiryInterval 6247,PropTopicAlias
// 31335,PropAuthenticationData
// "S\244(!\a\EM\137\142\155=9p<\DEL\DC4\SYN\140V\STX\STX\159\198",PropSharedSubscriptionAvailable 146]
TEST(Subscribe5QCTest, Encode25) {
  uint8_t pkt[] = {
      0x82, 0xcc, 0x1,  0x63, 0x7f, 0x41, 0x13, 0x43, 0x53, 0x2a, 0x7e, 0x29, 0x4a, 0x16, 0x0,  0x14, 0x6f, 0xc6, 0xdd,
      0x12, 0x48, 0x34, 0x95, 0x3e, 0xa9, 0x8e, 0xdf, 0xc7, 0x24, 0xca, 0x0,  0x92, 0x8e, 0x1,  0xa3, 0x5f, 0x11, 0x0,
      0x0,  0x18, 0x67, 0x23, 0x7a, 0x67, 0x16, 0x0,  0x16, 0x53, 0xf4, 0x28, 0x21, 0x7,  0x19, 0x89, 0x8e, 0x9b, 0x3d,
      0x39, 0x70, 0x3c, 0x7f, 0x14, 0x16, 0x8c, 0x56, 0x2,  0x2,  0x9f, 0xc6, 0x2a, 0x92, 0x0,  0x1c, 0x20, 0x67, 0xc7,
      0xd9, 0x92, 0xfd, 0x26, 0x13, 0xeb, 0x8,  0xba, 0xc8, 0x9,  0xab, 0xfe, 0xac, 0x1c, 0x8c, 0x6d, 0x13, 0x18, 0xee,
      0x46, 0xe0, 0xbb, 0xbe, 0xab, 0xf2, 0x0,  0x0,  0x0,  0x1,  0x0,  0x16, 0xb3, 0x68, 0x77, 0xce, 0x72, 0x7,  0x43,
      0x1d, 0x9f, 0xa,  0xce, 0x1a, 0xff, 0x24, 0x6d, 0x45, 0x4,  0x6d, 0x5d, 0xd2, 0x41, 0xe0, 0x0,  0x0,  0x6,  0x56,
      0x64, 0xaa, 0xf6, 0x32, 0xb,  0x1,  0x0,  0x1d, 0xe6, 0x82, 0x2b, 0x99, 0xd6, 0xa4, 0xec, 0x5,  0x61, 0x73, 0xfb,
      0xc0, 0x7d, 0x68, 0x29, 0x1,  0x1b, 0x7b, 0xbd, 0x3d, 0xbe, 0xeb, 0x27, 0x77, 0xca, 0xe1, 0x34, 0xdf, 0x6,  0x1,
      0x0,  0x19, 0xdd, 0x38, 0x46, 0x8e, 0x37, 0xc5, 0x14, 0xc1, 0x97, 0xc1, 0x40, 0x4,  0x97, 0x6,  0x92, 0x9d, 0xef,
      0x95, 0x2,  0xb5, 0xdc, 0x94, 0x9d, 0x2,  0xe0, 0x1,  0x0,  0x5,  0x6c, 0xa0, 0xe5, 0xe6, 0x92, 0x0};

  uint8_t buf[217] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x20, 0x67, 0xc7, 0xd9, 0x92, 0xfd, 0x26, 0x13, 0xeb, 0x8,
                                     0xba, 0xc8, 0x9,  0xab, 0xfe, 0xac, 0x1c, 0x8c, 0x6d, 0x13,
                                     0x18, 0xee, 0x46, 0xe0, 0xbb, 0xbe, 0xab, 0xf2};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb3, 0x68, 0x77, 0xce, 0x72, 0x7, 0x43, 0x1d, 0x9f, 0xa,  0xce,
                                     0x1a, 0xff, 0x24, 0x6d, 0x45, 0x4, 0x6d, 0x5d, 0xd2, 0x41, 0xe0};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x56, 0x64, 0xaa, 0xf6, 0x32, 0xb};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe6, 0x82, 0x2b, 0x99, 0xd6, 0xa4, 0xec, 0x5,  0x61, 0x73,
                                     0xfb, 0xc0, 0x7d, 0x68, 0x29, 0x1,  0x1b, 0x7b, 0xbd, 0x3d,
                                     0xbe, 0xeb, 0x27, 0x77, 0xca, 0xe1, 0x34, 0xdf, 0x6};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xdd, 0x38, 0x46, 0x8e, 0x37, 0xc5, 0x14, 0xc1, 0x97, 0xc1, 0x40, 0x4, 0x97,
                                     0x6,  0x92, 0x9d, 0xef, 0x95, 0x2,  0xb5, 0xdc, 0x94, 0x9d, 0x2,  0xe0};
  lwmqtt_string_t topic_filter_s5 = {25, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x6c, 0xa0, 0xe5, 0xe6, 0x92};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x6f, 0xc6, 0xdd, 0x12, 0x48, 0x34, 0x95, 0x3e, 0xa9, 0x8e,
                           0xdf, 0xc7, 0x24, 0xca, 0x0,  0x92, 0x8e, 0x1,  0xa3, 0x5f};
  uint8_t bytesprops1[] = {0x53, 0xf4, 0x28, 0x21, 0x7,  0x19, 0x89, 0x8e, 0x9b, 0x3d, 0x39,
                           0x70, 0x3c, 0x7f, 0x14, 0x16, 0x8c, 0x56, 0x2,  0x2,  0x9f, 0xc6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 17235}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 126}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 74}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 6247}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 31335}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {22, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 146}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25471, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10657 [("\ENQ4\f\143\197\ENQ\145\193\247\141\221i\199\192\173\223",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\188\156\DC3\177\134%\161",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\\\222\217\&5\226r",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\176c\ESCP\163\GSx\DC3",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("G\ENQ\204\136\fTN\163\214\228\254eHG\166\CAN\210\146>",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\172\144=\175\\\ESC\f\226\179v\175\164D$R9\211",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("S\242\171\242\STX\221\188uJ\199l\155\137\232\\\135\187\141\SYN\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\NAK\205\STX\156\ENQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\161\200eM1\161*\234\207\198\169\252.\DC2nE\230\227HE8\135\164\244",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("al}\149\EOT(\233\DLE\STX\233\208\183ui-F\t",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropTopicAliasMaximum 29858,PropServerReference
// "]9\CAN\DC3\197\217E\197_g\206\202.pF\203k\211",PropPayloadFormatIndicator 191,PropTopicAliasMaximum
// 6452,PropServerReference "t\216\160\150~",PropTopicAlias 5241,PropTopicAlias 29173,PropSharedSubscriptionAvailable
// 168,PropMaximumPacketSize 3240,PropSubscriptionIdentifierAvailable 206,PropUserProperty
// ":\232\199\223v'\194\209\SUB\253\171" "Ek\GS\169\133\ACK\DC4\v\176~E",PropAssignedClientIdentifier
// "\NAK\NAK\190.v\156\229\136\FSN\249\212T\134\231\218\152#K",PropReasonString "\NAK\DELI",PropResponseInformation
// "\ESC\251\217,\228\a\183N\194\132\&4\154\226y\NUL\133\192L)#M\ENQ\140xX\SYN4\212\204",PropMaximumPacketSize
// 27146,PropTopicAlias 1220,PropMessageExpiryInterval 612,PropContentType
// "Bf\GS\207\180\DC4\US\201\229o\232\212\209\251\251$U)\DLE\134\SYN\DC3\227\149W@\STX",PropSessionExpiryInterval
// 13945,PropAuthenticationMethod
// "^\139B\228L\STXt\142R\228a\197\194\137\160\&2\177\181\192\tjY\190\148\SI",PropMaximumPacketSize
// 10669,PropUserProperty "\158\201H\153\198\246Q"
// "\a\245\233\150\t\t\NUL\155\219\159[\240\140\226\n",PropAuthenticationData "S"]
TEST(Subscribe5QCTest, Encode26) {
  uint8_t pkt[] = {
      0x82, 0xa8, 0x3,  0x29, 0xa1, 0xfb, 0x1,  0x22, 0x74, 0xa2, 0x1c, 0x0,  0x12, 0x5d, 0x39, 0x18, 0x13, 0xc5, 0xd9,
      0x45, 0xc5, 0x5f, 0x67, 0xce, 0xca, 0x2e, 0x70, 0x46, 0xcb, 0x6b, 0xd3, 0x1,  0xbf, 0x22, 0x19, 0x34, 0x1c, 0x0,
      0x5,  0x74, 0xd8, 0xa0, 0x96, 0x7e, 0x23, 0x14, 0x79, 0x23, 0x71, 0xf5, 0x2a, 0xa8, 0x27, 0x0,  0x0,  0xc,  0xa8,
      0x29, 0xce, 0x26, 0x0,  0xb,  0x3a, 0xe8, 0xc7, 0xdf, 0x76, 0x27, 0xc2, 0xd1, 0x1a, 0xfd, 0xab, 0x0,  0xb,  0x45,
      0x6b, 0x1d, 0xa9, 0x85, 0x6,  0x14, 0xb,  0xb0, 0x7e, 0x45, 0x12, 0x0,  0x13, 0x15, 0x15, 0xbe, 0x2e, 0x76, 0x9c,
      0xe5, 0x88, 0x1c, 0x4e, 0xf9, 0xd4, 0x54, 0x86, 0xe7, 0xda, 0x98, 0x23, 0x4b, 0x1f, 0x0,  0x3,  0x15, 0x7f, 0x49,
      0x1a, 0x0,  0x1d, 0x1b, 0xfb, 0xd9, 0x2c, 0xe4, 0x7,  0xb7, 0x4e, 0xc2, 0x84, 0x34, 0x9a, 0xe2, 0x79, 0x0,  0x85,
      0xc0, 0x4c, 0x29, 0x23, 0x4d, 0x5,  0x8c, 0x78, 0x58, 0x16, 0x34, 0xd4, 0xcc, 0x27, 0x0,  0x0,  0x6a, 0xa,  0x23,
      0x4,  0xc4, 0x2,  0x0,  0x0,  0x2,  0x64, 0x3,  0x0,  0x1b, 0x42, 0x66, 0x1d, 0xcf, 0xb4, 0x14, 0x1f, 0xc9, 0xe5,
      0x6f, 0xe8, 0xd4, 0xd1, 0xfb, 0xfb, 0x24, 0x55, 0x29, 0x10, 0x86, 0x16, 0x13, 0xe3, 0x95, 0x57, 0x40, 0x2,  0x11,
      0x0,  0x0,  0x36, 0x79, 0x15, 0x0,  0x19, 0x5e, 0x8b, 0x42, 0xe4, 0x4c, 0x2,  0x74, 0x8e, 0x52, 0xe4, 0x61, 0xc5,
      0xc2, 0x89, 0xa0, 0x32, 0xb1, 0xb5, 0xc0, 0x9,  0x6a, 0x59, 0xbe, 0x94, 0xf,  0x27, 0x0,  0x0,  0x29, 0xad, 0x26,
      0x0,  0x7,  0x9e, 0xc9, 0x48, 0x99, 0xc6, 0xf6, 0x51, 0x0,  0xf,  0x7,  0xf5, 0xe9, 0x96, 0x9,  0x9,  0x0,  0x9b,
      0xdb, 0x9f, 0x5b, 0xf0, 0x8c, 0xe2, 0xa,  0x16, 0x0,  0x1,  0x53, 0x0,  0x10, 0x5,  0x34, 0xc,  0x8f, 0xc5, 0x5,
      0x91, 0xc1, 0xf7, 0x8d, 0xdd, 0x69, 0xc7, 0xc0, 0xad, 0xdf, 0x2,  0x0,  0x7,  0xbc, 0x9c, 0x13, 0xb1, 0x86, 0x25,
      0xa1, 0x0,  0x0,  0x6,  0x5c, 0xde, 0xd9, 0x35, 0xe2, 0x72, 0x2,  0x0,  0x8,  0xb0, 0x63, 0x1b, 0x50, 0xa3, 0x1d,
      0x78, 0x13, 0x1,  0x0,  0x13, 0x47, 0x5,  0xcc, 0x88, 0xc,  0x54, 0x4e, 0xa3, 0xd6, 0xe4, 0xfe, 0x65, 0x48, 0x47,
      0xa6, 0x18, 0xd2, 0x92, 0x3e, 0x1,  0x0,  0x11, 0xac, 0x90, 0x3d, 0xaf, 0x5c, 0x1b, 0xc,  0xe2, 0xb3, 0x76, 0xaf,
      0xa4, 0x44, 0x24, 0x52, 0x39, 0xd3, 0x1,  0x0,  0x14, 0x53, 0xf2, 0xab, 0xf2, 0x2,  0xdd, 0xbc, 0x75, 0x4a, 0xc7,
      0x6c, 0x9b, 0x89, 0xe8, 0x5c, 0x87, 0xbb, 0x8d, 0x16, 0xd9, 0x1,  0x0,  0x5,  0x15, 0xcd, 0x2,  0x9c, 0x5,  0x1,
      0x0,  0x18, 0xa1, 0xc8, 0x65, 0x4d, 0x31, 0xa1, 0x2a, 0xea, 0xcf, 0xc6, 0xa9, 0xfc, 0x2e, 0x12, 0x6e, 0x45, 0xe6,
      0xe3, 0x48, 0x45, 0x38, 0x87, 0xa4, 0xf4, 0x1,  0x0,  0x11, 0x61, 0x6c, 0x7d, 0x95, 0x4,  0x28, 0xe9, 0x10, 0x2,
      0xe9, 0xd0, 0xb7, 0x75, 0x69, 0x2d, 0x46, 0x9,  0x2};

  uint8_t buf[437] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x5,  0x34, 0xc,  0x8f, 0xc5, 0x5,  0x91, 0xc1,
                                     0xf7, 0x8d, 0xdd, 0x69, 0xc7, 0xc0, 0xad, 0xdf};
  lwmqtt_string_t topic_filter_s0 = {16, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xbc, 0x9c, 0x13, 0xb1, 0x86, 0x25, 0xa1};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5c, 0xde, 0xd9, 0x35, 0xe2, 0x72};
  lwmqtt_string_t topic_filter_s2 = {6, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb0, 0x63, 0x1b, 0x50, 0xa3, 0x1d, 0x78, 0x13};
  lwmqtt_string_t topic_filter_s3 = {8, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x47, 0x5,  0xcc, 0x88, 0xc,  0x54, 0x4e, 0xa3, 0xd6, 0xe4,
                                     0xfe, 0x65, 0x48, 0x47, 0xa6, 0x18, 0xd2, 0x92, 0x3e};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xac, 0x90, 0x3d, 0xaf, 0x5c, 0x1b, 0xc,  0xe2, 0xb3,
                                     0x76, 0xaf, 0xa4, 0x44, 0x24, 0x52, 0x39, 0xd3};
  lwmqtt_string_t topic_filter_s5 = {17, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x53, 0xf2, 0xab, 0xf2, 0x2,  0xdd, 0xbc, 0x75, 0x4a, 0xc7,
                                     0x6c, 0x9b, 0x89, 0xe8, 0x5c, 0x87, 0xbb, 0x8d, 0x16, 0xd9};
  lwmqtt_string_t topic_filter_s6 = {20, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x15, 0xcd, 0x2, 0x9c, 0x5};
  lwmqtt_string_t topic_filter_s7 = {5, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xa1, 0xc8, 0x65, 0x4d, 0x31, 0xa1, 0x2a, 0xea, 0xcf, 0xc6, 0xa9, 0xfc,
                                     0x2e, 0x12, 0x6e, 0x45, 0xe6, 0xe3, 0x48, 0x45, 0x38, 0x87, 0xa4, 0xf4};
  lwmqtt_string_t topic_filter_s8 = {24, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x61, 0x6c, 0x7d, 0x95, 0x4,  0x28, 0xe9, 0x10, 0x2,
                                     0xe9, 0xd0, 0xb7, 0x75, 0x69, 0x2d, 0x46, 0x9};
  lwmqtt_string_t topic_filter_s9 = {17, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x5d, 0x39, 0x18, 0x13, 0xc5, 0xd9, 0x45, 0xc5, 0x5f,
                           0x67, 0xce, 0xca, 0x2e, 0x70, 0x46, 0xcb, 0x6b, 0xd3};
  uint8_t bytesprops1[] = {0x74, 0xd8, 0xa0, 0x96, 0x7e};
  uint8_t bytesprops3[] = {0x45, 0x6b, 0x1d, 0xa9, 0x85, 0x6, 0x14, 0xb, 0xb0, 0x7e, 0x45};
  uint8_t bytesprops2[] = {0x3a, 0xe8, 0xc7, 0xdf, 0x76, 0x27, 0xc2, 0xd1, 0x1a, 0xfd, 0xab};
  uint8_t bytesprops4[] = {0x15, 0x15, 0xbe, 0x2e, 0x76, 0x9c, 0xe5, 0x88, 0x1c, 0x4e,
                           0xf9, 0xd4, 0x54, 0x86, 0xe7, 0xda, 0x98, 0x23, 0x4b};
  uint8_t bytesprops5[] = {0x15, 0x7f, 0x49};
  uint8_t bytesprops6[] = {0x1b, 0xfb, 0xd9, 0x2c, 0xe4, 0x7,  0xb7, 0x4e, 0xc2, 0x84, 0x34, 0x9a, 0xe2, 0x79, 0x0,
                           0x85, 0xc0, 0x4c, 0x29, 0x23, 0x4d, 0x5,  0x8c, 0x78, 0x58, 0x16, 0x34, 0xd4, 0xcc};
  uint8_t bytesprops7[] = {0x42, 0x66, 0x1d, 0xcf, 0xb4, 0x14, 0x1f, 0xc9, 0xe5, 0x6f, 0xe8, 0xd4, 0xd1, 0xfb,
                           0xfb, 0x24, 0x55, 0x29, 0x10, 0x86, 0x16, 0x13, 0xe3, 0x95, 0x57, 0x40, 0x2};
  uint8_t bytesprops8[] = {0x5e, 0x8b, 0x42, 0xe4, 0x4c, 0x2,  0x74, 0x8e, 0x52, 0xe4, 0x61, 0xc5, 0xc2,
                           0x89, 0xa0, 0x32, 0xb1, 0xb5, 0xc0, 0x9,  0x6a, 0x59, 0xbe, 0x94, 0xf};
  uint8_t bytesprops10[] = {0x7, 0xf5, 0xe9, 0x96, 0x9, 0x9, 0x0, 0x9b, 0xdb, 0x9f, 0x5b, 0xf0, 0x8c, 0xe2, 0xa};
  uint8_t bytesprops9[] = {0x9e, 0xc9, 0x48, 0x99, 0xc6, 0xf6, 0x51};
  uint8_t bytesprops11[] = {0x53};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29858}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {18, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 191}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6452}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 5241}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29173}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 168}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 3240}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 206}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {11, (char*)&bytesprops2}, .v = {11, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {29, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27146}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1220}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 612}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {27, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 13945}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 10669}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {7, (char*)&bytesprops9}, .v = {15, (char*)&bytesprops10}}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops11}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10657, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 15036 [("\ETB\177\238\199$\NUL\128\209",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("3r:\DC1c[upm\234_c`\195V\252C\vu\153\196",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("g\238\250",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("\183\236\166\159+\v\b\SI\149\DC2\247\&1",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\ESCd\242\134N\161i\169\135\230\198m\163\166\229\247e\211E",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("Y\216\242f(\ETX=\152\ESC\208?B|\197\n\198Z\148\153\199\f\r\\n5\137#4",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropUserProperty "\DLE\DLE\177\184
// \237{\223\SUBR\b\153=j;" "\\\172\155\241c]\132g`_\227aO\SO1\167\"\238\RSy",PropPayloadFormatIndicator
// 213,PropSessionExpiryInterval 24785,PropMaximumQoS 239,PropMaximumQoS 27,PropSubscriptionIdentifier
// 28,PropMaximumPacketSize 7341,PropRequestResponseInformation 196,PropMessageExpiryInterval
// 25044,PropAssignedClientIdentifier
// "\129\225=\207.UC\165*)\160\184\197\a\r\213H\EOT\202\&2\163\249u*",PropUserProperty
// "\138Z&\167\EM\219\DEL\218\234\243\FS\231\224\248z"
// "\FS\152\&8\US\230\153\150\175\238`\211\161R\DLE\DC1\"\209\&4\209wm\174k\239V",PropWildcardSubscriptionAvailable
// 234,PropResponseInformation ""]
TEST(Subscribe5QCTest, Encode27) {
  uint8_t pkt[] = {
      0x82, 0xff, 0x1,  0x3a, 0xbc, 0x8e, 0x1,  0x26, 0x0,  0xf,  0x10, 0x10, 0xb1, 0xb8, 0x20, 0xed, 0x7b, 0xdf, 0x1a,
      0x52, 0x8,  0x99, 0x3d, 0x6a, 0x3b, 0x0,  0x14, 0x5c, 0xac, 0x9b, 0xf1, 0x63, 0x5d, 0x84, 0x67, 0x60, 0x5f, 0xe3,
      0x61, 0x4f, 0xe,  0x31, 0xa7, 0x22, 0xee, 0x1e, 0x79, 0x1,  0xd5, 0x11, 0x0,  0x0,  0x60, 0xd1, 0x24, 0xef, 0x24,
      0x1b, 0xb,  0x1c, 0x27, 0x0,  0x0,  0x1c, 0xad, 0x19, 0xc4, 0x2,  0x0,  0x0,  0x61, 0xd4, 0x12, 0x0,  0x18, 0x81,
      0xe1, 0x3d, 0xcf, 0x2e, 0x55, 0x43, 0xa5, 0x2a, 0x29, 0xa0, 0xb8, 0xc5, 0x7,  0xd,  0xd5, 0x48, 0x4,  0xca, 0x32,
      0xa3, 0xf9, 0x75, 0x2a, 0x26, 0x0,  0xf,  0x8a, 0x5a, 0x26, 0xa7, 0x19, 0xdb, 0x7f, 0xda, 0xea, 0xf3, 0x1c, 0xe7,
      0xe0, 0xf8, 0x7a, 0x0,  0x19, 0x1c, 0x98, 0x38, 0x1f, 0xe6, 0x99, 0x96, 0xaf, 0xee, 0x60, 0xd3, 0xa1, 0x52, 0x10,
      0x11, 0x22, 0xd1, 0x34, 0xd1, 0x77, 0x6d, 0xae, 0x6b, 0xef, 0x56, 0x28, 0xea, 0x1a, 0x0,  0x0,  0x0,  0x8,  0x17,
      0xb1, 0xee, 0xc7, 0x24, 0x0,  0x80, 0xd1, 0x0,  0x0,  0x15, 0x33, 0x72, 0x3a, 0x11, 0x63, 0x5b, 0x75, 0x70, 0x6d,
      0xea, 0x5f, 0x63, 0x60, 0xc3, 0x56, 0xfc, 0x43, 0xb,  0x75, 0x99, 0xc4, 0x1,  0x0,  0x3,  0x67, 0xee, 0xfa, 0x0,
      0x0,  0xc,  0xb7, 0xec, 0xa6, 0x9f, 0x2b, 0xb,  0x8,  0xf,  0x95, 0x12, 0xf7, 0x31, 0x2,  0x0,  0x13, 0x1b, 0x64,
      0xf2, 0x86, 0x4e, 0xa1, 0x69, 0xa9, 0x87, 0xe6, 0xc6, 0x6d, 0xa3, 0xa6, 0xe5, 0xf7, 0x65, 0xd3, 0x45, 0x0,  0x0,
      0x1c, 0x59, 0xd8, 0xf2, 0x66, 0x28, 0x3,  0x3d, 0x98, 0x1b, 0xd0, 0x3f, 0x42, 0x7c, 0xc5, 0xa,  0xc6, 0x5a, 0x94,
      0x99, 0xc7, 0xc,  0xd,  0x5c, 0x6e, 0x35, 0x89, 0x23, 0x34, 0x1};

  uint8_t buf[268] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x17, 0xb1, 0xee, 0xc7, 0x24, 0x0, 0x80, 0xd1};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x33, 0x72, 0x3a, 0x11, 0x63, 0x5b, 0x75, 0x70, 0x6d, 0xea, 0x5f,
                                     0x63, 0x60, 0xc3, 0x56, 0xfc, 0x43, 0xb,  0x75, 0x99, 0xc4};
  lwmqtt_string_t topic_filter_s1 = {21, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x67, 0xee, 0xfa};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb7, 0xec, 0xa6, 0x9f, 0x2b, 0xb, 0x8, 0xf, 0x95, 0x12, 0xf7, 0x31};
  lwmqtt_string_t topic_filter_s3 = {12, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x1b, 0x64, 0xf2, 0x86, 0x4e, 0xa1, 0x69, 0xa9, 0x87, 0xe6,
                                     0xc6, 0x6d, 0xa3, 0xa6, 0xe5, 0xf7, 0x65, 0xd3, 0x45};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x59, 0xd8, 0xf2, 0x66, 0x28, 0x3,  0x3d, 0x98, 0x1b, 0xd0,
                                     0x3f, 0x42, 0x7c, 0xc5, 0xa,  0xc6, 0x5a, 0x94, 0x99, 0xc7,
                                     0xc,  0xd,  0x5c, 0x6e, 0x35, 0x89, 0x23, 0x34};
  lwmqtt_string_t topic_filter_s5 = {28, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops1[] = {0x5c, 0xac, 0x9b, 0xf1, 0x63, 0x5d, 0x84, 0x67, 0x60, 0x5f,
                           0xe3, 0x61, 0x4f, 0xe,  0x31, 0xa7, 0x22, 0xee, 0x1e, 0x79};
  uint8_t bytesprops0[] = {0x10, 0x10, 0xb1, 0xb8, 0x20, 0xed, 0x7b, 0xdf, 0x1a, 0x52, 0x8, 0x99, 0x3d, 0x6a, 0x3b};
  uint8_t bytesprops2[] = {0x81, 0xe1, 0x3d, 0xcf, 0x2e, 0x55, 0x43, 0xa5, 0x2a, 0x29, 0xa0, 0xb8,
                           0xc5, 0x7,  0xd,  0xd5, 0x48, 0x4,  0xca, 0x32, 0xa3, 0xf9, 0x75, 0x2a};
  uint8_t bytesprops4[] = {0x1c, 0x98, 0x38, 0x1f, 0xe6, 0x99, 0x96, 0xaf, 0xee, 0x60, 0xd3, 0xa1, 0x52,
                           0x10, 0x11, 0x22, 0xd1, 0x34, 0xd1, 0x77, 0x6d, 0xae, 0x6b, 0xef, 0x56};
  uint8_t bytesprops3[] = {0x8a, 0x5a, 0x26, 0xa7, 0x19, 0xdb, 0x7f, 0xda, 0xea, 0xf3, 0x1c, 0xe7, 0xe0, 0xf8, 0x7a};
  uint8_t bytesprops5[] = {0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {15, (char*)&bytesprops0}, .v = {20, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 24785}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 239}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 27}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 28}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 7341}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 196}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25044}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {24, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {15, (char*)&bytesprops3}, .v = {25, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 234}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {0, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {13, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 15036, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2876 [("\143\161\221\224\191",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("rT\145\ay\160\215s,\146c\129\150>@!/\217\141",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\r\184\142p\151\204\170\249\180/\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\235\167\DLE\217\198\169\175\SI\182\ESC",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("G\130\214\&0\b\EM/\194\249\193\148`\222\217\ETXQZ\251\&7\n\147k\254\158t\249\130\219-E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\SO\205\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2}),("\175\GS\210~\190\GS\178\&9\230=\236|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\213\RSA\148\250i2Cbmo\147D\254\170\&33p\218\CAN\232\206\SO\142\&7",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\169\DEL\233~\135W\168q\226\158\197\227\151}9",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropCorrelationData
// "\177\207\186!\SUB\162\215\147X\144",PropWildcardSubscriptionAvailable 78,PropResponseInformation
// "[\NAK\229M",PropSubscriptionIdentifierAvailable 176,PropTopicAlias 10740,PropPayloadFormatIndicator
// 225,PropWildcardSubscriptionAvailable 1,PropSharedSubscriptionAvailable 127,PropResponseInformation
// "\ENQ\229\169\159Q\161\r6\245\220\&4",PropRequestResponseInformation 127]
TEST(Subscribe5QCTest, Encode28) {
  uint8_t pkt[] = {0x82, 0xd4, 0x1,  0xb,  0x3c, 0x31, 0x9,  0x0,  0xa,  0xb1, 0xcf, 0xba, 0x21, 0x1a, 0xa2, 0xd7, 0x93,
                   0x58, 0x90, 0x28, 0x4e, 0x1a, 0x0,  0x4,  0x5b, 0x15, 0xe5, 0x4d, 0x29, 0xb0, 0x23, 0x29, 0xf4, 0x1,
                   0xe1, 0x28, 0x1,  0x2a, 0x7f, 0x1a, 0x0,  0xb,  0x5,  0xe5, 0xa9, 0x9f, 0x51, 0xa1, 0xd,  0x36, 0xf5,
                   0xdc, 0x34, 0x19, 0x7f, 0x0,  0x5,  0x8f, 0xa1, 0xdd, 0xe0, 0xbf, 0x1,  0x0,  0x13, 0x72, 0x54, 0x91,
                   0x7,  0x79, 0xa0, 0xd7, 0x73, 0x2c, 0x92, 0x63, 0x81, 0x96, 0x3e, 0x40, 0x21, 0x2f, 0xd9, 0x8d, 0x0,
                   0x0,  0x0,  0x0,  0x0,  0xb,  0xd,  0xb8, 0x8e, 0x70, 0x97, 0xcc, 0xaa, 0xf9, 0xb4, 0x2f, 0xd2, 0x1,
                   0x0,  0xa,  0xeb, 0xa7, 0x10, 0xd9, 0xc6, 0xa9, 0xaf, 0xf,  0xb6, 0x1b, 0x1,  0x0,  0x1e, 0x47, 0x82,
                   0xd6, 0x30, 0x8,  0x19, 0x2f, 0xc2, 0xf9, 0xc1, 0x94, 0x60, 0xde, 0xd9, 0x3,  0x51, 0x5a, 0xfb, 0x37,
                   0xa,  0x93, 0x6b, 0xfe, 0x9e, 0x74, 0xf9, 0x82, 0xdb, 0x2d, 0x45, 0x0,  0x0,  0x3,  0xe,  0xcd, 0xce,
                   0x2,  0x0,  0xc,  0xaf, 0x1d, 0xd2, 0x7e, 0xbe, 0x1d, 0xb2, 0x39, 0xe6, 0x3d, 0xec, 0x7c, 0x2,  0x0,
                   0x19, 0xd5, 0x1e, 0x41, 0x94, 0xfa, 0x69, 0x32, 0x43, 0x62, 0x6d, 0x6f, 0x93, 0x44, 0xfe, 0xaa, 0x33,
                   0x33, 0x70, 0xda, 0x18, 0xe8, 0xce, 0xe,  0x8e, 0x37, 0x1,  0x0,  0xf,  0xa9, 0x7f, 0xe9, 0x7e, 0x87,
                   0x57, 0xa8, 0x71, 0xe2, 0x9e, 0xc5, 0xe3, 0x97, 0x7d, 0x39, 0x2};

  uint8_t buf[225] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x8f, 0xa1, 0xdd, 0xe0, 0xbf};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x72, 0x54, 0x91, 0x7,  0x79, 0xa0, 0xd7, 0x73, 0x2c, 0x92,
                                     0x63, 0x81, 0x96, 0x3e, 0x40, 0x21, 0x2f, 0xd9, 0x8d};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0};
  lwmqtt_string_t topic_filter_s2 = {0, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xd, 0xb8, 0x8e, 0x70, 0x97, 0xcc, 0xaa, 0xf9, 0xb4, 0x2f, 0xd2};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xeb, 0xa7, 0x10, 0xd9, 0xc6, 0xa9, 0xaf, 0xf, 0xb6, 0x1b};
  lwmqtt_string_t topic_filter_s4 = {10, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x47, 0x82, 0xd6, 0x30, 0x8,  0x19, 0x2f, 0xc2, 0xf9, 0xc1,
                                     0x94, 0x60, 0xde, 0xd9, 0x3,  0x51, 0x5a, 0xfb, 0x37, 0xa,
                                     0x93, 0x6b, 0xfe, 0x9e, 0x74, 0xf9, 0x82, 0xdb, 0x2d, 0x45};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xe, 0xcd, 0xce};
  lwmqtt_string_t topic_filter_s6 = {3, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xaf, 0x1d, 0xd2, 0x7e, 0xbe, 0x1d, 0xb2, 0x39, 0xe6, 0x3d, 0xec, 0x7c};
  lwmqtt_string_t topic_filter_s7 = {12, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xd5, 0x1e, 0x41, 0x94, 0xfa, 0x69, 0x32, 0x43, 0x62, 0x6d, 0x6f, 0x93, 0x44,
                                     0xfe, 0xaa, 0x33, 0x33, 0x70, 0xda, 0x18, 0xe8, 0xce, 0xe,  0x8e, 0x37};
  lwmqtt_string_t topic_filter_s8 = {25, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xa9, 0x7f, 0xe9, 0x7e, 0x87, 0x57, 0xa8, 0x71,
                                     0xe2, 0x9e, 0xc5, 0xe3, 0x97, 0x7d, 0x39};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0xb1, 0xcf, 0xba, 0x21, 0x1a, 0xa2, 0xd7, 0x93, 0x58, 0x90};
  uint8_t bytesprops1[] = {0x5b, 0x15, 0xe5, 0x4d};
  uint8_t bytesprops2[] = {0x5, 0xe5, 0xa9, 0x9f, 0x51, 0xa1, 0xd, 0x36, 0xf5, 0xdc, 0x34};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {4, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 176}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10740}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 225}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 1}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 127}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 127}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2876, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30960 [("\185\236\245\223\167kV\209\203\206v",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("`\208\168\173\228W\128\NUL\ESC\220\215\244'8\132
// \151\&8\151\138\SO\228g",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\196b\128&>\147\253\195D\218\SI\NAK\EOT\ETBV\195\140\"s\215\166Z:9",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("=|\155\128\168\238V\248\201^w7\200+\247\FS\194\185\218\184",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropUserProperty "\149"
// "\247\196\167(\a8\153M\220l\USq\252R\182[",PropWildcardSubscriptionAvailable 231,PropTopicAlias 32292,PropContentType
// "i\CANt\218\SIGE\189\158\211`\130\195\240M15.a\250\135$",PropAuthenticationData
// "\131\239B\132\161W\226\&88\187\228\191\DC4\200\209\NAKr\249",PropPayloadFormatIndicator 255,PropUserProperty
// "\175\231\176\254\238\r\145\SIDk\CAN[\157\153l\185\146\254\184\238\218\SI\134\244\ETXM"
// "\253\140\167H\b",PropAuthenticationMethod "\182\190\172\245k)\163PB\253",PropWillDelayInterval
// 27287,PropRetainAvailable 119,PropServerReference
// "l\r\149\216\138\253\166\209z\f\230\DEL[\195\236\169\FS\250",PropSharedSubscriptionAvailable
// 23,PropRequestProblemInformation 121,PropResponseTopic
// "|81`lO\243\&8d\227\SI\169\176`\248\246\239:-7\193?\137B8\CAN\172p\205",PropSubscriptionIdentifier
// 14,PropPayloadFormatIndicator 208,PropMessageExpiryInterval 26592,PropContentType
// "%]\187\SI\207\153\181\169",PropMessageExpiryInterval 19734,PropAuthenticationMethod
// "\RS\231\216\STXEz\172\208Le\188\&2\RS\132He\185",PropCorrelationData
// "|d<\DC44\161uC\143\209\248\DEL5)\225V\251@\235\160\240\210m<>a\166\&5F",PropMessageExpiryInterval
// 27232,PropAuthenticationData
// "\226\166a\147E\132S\247\128\205_\247\169\152\&68\131\171\DC4\DC3\ACKng=\169L\230\&1\161",PropMaximumPacketSize
// 22761,PropMessageExpiryInterval 11220]
TEST(Subscribe5QCTest, Encode29) {
  uint8_t pkt[] = {
      0x82, 0x99, 0x3,  0x78, 0xf0, 0xb8, 0x2,  0x26, 0x0,  0x1,  0x95, 0x0,  0x10, 0xf7, 0xc4, 0xa7, 0x28, 0x7,  0x38,
      0x99, 0x4d, 0xdc, 0x6c, 0x1f, 0x71, 0xfc, 0x52, 0xb6, 0x5b, 0x28, 0xe7, 0x23, 0x7e, 0x24, 0x3,  0x0,  0x16, 0x69,
      0x18, 0x74, 0xda, 0xf,  0x47, 0x45, 0xbd, 0x9e, 0xd3, 0x60, 0x82, 0xc3, 0xf0, 0x4d, 0x31, 0x35, 0x2e, 0x61, 0xfa,
      0x87, 0x24, 0x16, 0x0,  0x12, 0x83, 0xef, 0x42, 0x84, 0xa1, 0x57, 0xe2, 0x38, 0x38, 0xbb, 0xe4, 0xbf, 0x14, 0xc8,
      0xd1, 0x15, 0x72, 0xf9, 0x1,  0xff, 0x26, 0x0,  0x1a, 0xaf, 0xe7, 0xb0, 0xfe, 0xee, 0xd,  0x91, 0xf,  0x44, 0x6b,
      0x18, 0x5b, 0x9d, 0x99, 0x6c, 0xb9, 0x92, 0xfe, 0xb8, 0xee, 0xda, 0xf,  0x86, 0xf4, 0x3,  0x4d, 0x0,  0x5,  0xfd,
      0x8c, 0xa7, 0x48, 0x8,  0x15, 0x0,  0xa,  0xb6, 0xbe, 0xac, 0xf5, 0x6b, 0x29, 0xa3, 0x50, 0x42, 0xfd, 0x18, 0x0,
      0x0,  0x6a, 0x97, 0x25, 0x77, 0x1c, 0x0,  0x12, 0x6c, 0xd,  0x95, 0xd8, 0x8a, 0xfd, 0xa6, 0xd1, 0x7a, 0xc,  0xe6,
      0x7f, 0x5b, 0xc3, 0xec, 0xa9, 0x1c, 0xfa, 0x2a, 0x17, 0x17, 0x79, 0x8,  0x0,  0x1d, 0x7c, 0x38, 0x31, 0x60, 0x6c,
      0x4f, 0xf3, 0x38, 0x64, 0xe3, 0xf,  0xa9, 0xb0, 0x60, 0xf8, 0xf6, 0xef, 0x3a, 0x2d, 0x37, 0xc1, 0x3f, 0x89, 0x42,
      0x38, 0x18, 0xac, 0x70, 0xcd, 0xb,  0xe,  0x1,  0xd0, 0x2,  0x0,  0x0,  0x67, 0xe0, 0x3,  0x0,  0x8,  0x25, 0x5d,
      0xbb, 0xf,  0xcf, 0x99, 0xb5, 0xa9, 0x2,  0x0,  0x0,  0x4d, 0x16, 0x15, 0x0,  0x11, 0x1e, 0xe7, 0xd8, 0x2,  0x45,
      0x7a, 0xac, 0xd0, 0x4c, 0x65, 0xbc, 0x32, 0x1e, 0x84, 0x48, 0x65, 0xb9, 0x9,  0x0,  0x1d, 0x7c, 0x64, 0x3c, 0x14,
      0x34, 0xa1, 0x75, 0x43, 0x8f, 0xd1, 0xf8, 0x7f, 0x35, 0x29, 0xe1, 0x56, 0xfb, 0x40, 0xeb, 0xa0, 0xf0, 0xd2, 0x6d,
      0x3c, 0x3e, 0x61, 0xa6, 0x35, 0x46, 0x2,  0x0,  0x0,  0x6a, 0x60, 0x16, 0x0,  0x1d, 0xe2, 0xa6, 0x61, 0x93, 0x45,
      0x84, 0x53, 0xf7, 0x80, 0xcd, 0x5f, 0xf7, 0xa9, 0x98, 0x36, 0x38, 0x83, 0xab, 0x14, 0x13, 0x6,  0x6e, 0x67, 0x3d,
      0xa9, 0x4c, 0xe6, 0x31, 0xa1, 0x27, 0x0,  0x0,  0x58, 0xe9, 0x2,  0x0,  0x0,  0x2b, 0xd4, 0x0,  0xb,  0xb9, 0xec,
      0xf5, 0xdf, 0xa7, 0x6b, 0x56, 0xd1, 0xcb, 0xce, 0x76, 0x1,  0x0,  0x0,  0x2,  0x0,  0x17, 0x60, 0xd0, 0xa8, 0xad,
      0xe4, 0x57, 0x80, 0x0,  0x1b, 0xdc, 0xd7, 0xf4, 0x27, 0x38, 0x84, 0x20, 0x97, 0x38, 0x97, 0x8a, 0xe,  0xe4, 0x67,
      0x1,  0x0,  0x18, 0xc4, 0x62, 0x80, 0x26, 0x3e, 0x93, 0xfd, 0xc3, 0x44, 0xda, 0xf,  0x15, 0x4,  0x17, 0x56, 0xc3,
      0x8c, 0x22, 0x73, 0xd7, 0xa6, 0x5a, 0x3a, 0x39, 0x2,  0x0,  0x14, 0x3d, 0x7c, 0x9b, 0x80, 0xa8, 0xee, 0x56, 0xf8,
      0xc9, 0x5e, 0x77, 0x37, 0xc8, 0x2b, 0xf7, 0x1c, 0xc2, 0xb9, 0xda, 0xb8, 0x1};

  uint8_t buf[422] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xb9, 0xec, 0xf5, 0xdf, 0xa7, 0x6b, 0x56, 0xd1, 0xcb, 0xce, 0x76};
  lwmqtt_string_t topic_filter_s0 = {11, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x60, 0xd0, 0xa8, 0xad, 0xe4, 0x57, 0x80, 0x0,  0x1b, 0xdc, 0xd7, 0xf4,
                                     0x27, 0x38, 0x84, 0x20, 0x97, 0x38, 0x97, 0x8a, 0xe,  0xe4, 0x67};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc4, 0x62, 0x80, 0x26, 0x3e, 0x93, 0xfd, 0xc3, 0x44, 0xda, 0xf,  0x15,
                                     0x4,  0x17, 0x56, 0xc3, 0x8c, 0x22, 0x73, 0xd7, 0xa6, 0x5a, 0x3a, 0x39};
  lwmqtt_string_t topic_filter_s3 = {24, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x3d, 0x7c, 0x9b, 0x80, 0xa8, 0xee, 0x56, 0xf8, 0xc9, 0x5e,
                                     0x77, 0x37, 0xc8, 0x2b, 0xf7, 0x1c, 0xc2, 0xb9, 0xda, 0xb8};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops1[] = {0xf7, 0xc4, 0xa7, 0x28, 0x7,  0x38, 0x99, 0x4d,
                           0xdc, 0x6c, 0x1f, 0x71, 0xfc, 0x52, 0xb6, 0x5b};
  uint8_t bytesprops0[] = {0x95};
  uint8_t bytesprops2[] = {0x69, 0x18, 0x74, 0xda, 0xf,  0x47, 0x45, 0xbd, 0x9e, 0xd3, 0x60,
                           0x82, 0xc3, 0xf0, 0x4d, 0x31, 0x35, 0x2e, 0x61, 0xfa, 0x87, 0x24};
  uint8_t bytesprops3[] = {0x83, 0xef, 0x42, 0x84, 0xa1, 0x57, 0xe2, 0x38, 0x38,
                           0xbb, 0xe4, 0xbf, 0x14, 0xc8, 0xd1, 0x15, 0x72, 0xf9};
  uint8_t bytesprops5[] = {0xfd, 0x8c, 0xa7, 0x48, 0x8};
  uint8_t bytesprops4[] = {0xaf, 0xe7, 0xb0, 0xfe, 0xee, 0xd,  0x91, 0xf,  0x44, 0x6b, 0x18, 0x5b, 0x9d,
                           0x99, 0x6c, 0xb9, 0x92, 0xfe, 0xb8, 0xee, 0xda, 0xf,  0x86, 0xf4, 0x3,  0x4d};
  uint8_t bytesprops6[] = {0xb6, 0xbe, 0xac, 0xf5, 0x6b, 0x29, 0xa3, 0x50, 0x42, 0xfd};
  uint8_t bytesprops7[] = {0x6c, 0xd,  0x95, 0xd8, 0x8a, 0xfd, 0xa6, 0xd1, 0x7a,
                           0xc,  0xe6, 0x7f, 0x5b, 0xc3, 0xec, 0xa9, 0x1c, 0xfa};
  uint8_t bytesprops8[] = {0x7c, 0x38, 0x31, 0x60, 0x6c, 0x4f, 0xf3, 0x38, 0x64, 0xe3, 0xf,  0xa9, 0xb0, 0x60, 0xf8,
                           0xf6, 0xef, 0x3a, 0x2d, 0x37, 0xc1, 0x3f, 0x89, 0x42, 0x38, 0x18, 0xac, 0x70, 0xcd};
  uint8_t bytesprops9[] = {0x25, 0x5d, 0xbb, 0xf, 0xcf, 0x99, 0xb5, 0xa9};
  uint8_t bytesprops10[] = {0x1e, 0xe7, 0xd8, 0x2,  0x45, 0x7a, 0xac, 0xd0, 0x4c,
                            0x65, 0xbc, 0x32, 0x1e, 0x84, 0x48, 0x65, 0xb9};
  uint8_t bytesprops11[] = {0x7c, 0x64, 0x3c, 0x14, 0x34, 0xa1, 0x75, 0x43, 0x8f, 0xd1, 0xf8, 0x7f, 0x35, 0x29, 0xe1,
                            0x56, 0xfb, 0x40, 0xeb, 0xa0, 0xf0, 0xd2, 0x6d, 0x3c, 0x3e, 0x61, 0xa6, 0x35, 0x46};
  uint8_t bytesprops12[] = {0xe2, 0xa6, 0x61, 0x93, 0x45, 0x84, 0x53, 0xf7, 0x80, 0xcd, 0x5f, 0xf7, 0xa9, 0x98, 0x36,
                            0x38, 0x83, 0xab, 0x14, 0x13, 0x6,  0x6e, 0x67, 0x3d, 0xa9, 0x4c, 0xe6, 0x31, 0xa1};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {1, (char*)&bytesprops0}, .v = {16, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 231}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32292}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 255}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {26, (char*)&bytesprops4}, .v = {5, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 27287}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 119}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {18, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 23}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 121}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 14}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 208}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 26592}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19734}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {29, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27232}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {29, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 22761}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11220}},
  };

  lwmqtt_properties_t props = {25, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 30960, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 19821 [("\162",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\200\151\208c\FS\228\171\229\143c\210\no\DC1F(\147w\158",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("w\206\216e\255h\237\252\178.",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\196)\168x0\242\199\SI\251\223L\150\183\234\205\197\137`\215'\aD\164\EOT5\148\ETB\189",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropAuthenticationMethod
// "x\205\226K\169ZM\228\155,w\FS\a\193n\192\225N\251\166\241\230\159\172\249\144",PropSharedSubscriptionAvailable
// 169,PropWildcardSubscriptionAvailable 229,PropReceiveMaximum 27247,PropSharedSubscriptionAvailable 7,PropTopicAlias
// 6098,PropWillDelayInterval 7011,PropResponseTopic "\ENQR]\202\145\167\246\253\199",PropAssignedClientIdentifier
// "\196\163>\154q<\245\182\NAK\155\254,\137MQ\234\190h\SYN",PropServerKeepAlive 28601]
TEST(Subscribe5QCTest, Encode30) {
  uint8_t pkt[] = {0x82, 0x9c, 0x1,  0x4d, 0x6d, 0x53, 0x15, 0x0,  0x1a, 0x78, 0xcd, 0xe2, 0x4b, 0xa9, 0x5a, 0x4d,
                   0xe4, 0x9b, 0x2c, 0x77, 0x1c, 0x7,  0xc1, 0x6e, 0xc0, 0xe1, 0x4e, 0xfb, 0xa6, 0xf1, 0xe6, 0x9f,
                   0xac, 0xf9, 0x90, 0x2a, 0xa9, 0x28, 0xe5, 0x21, 0x6a, 0x6f, 0x2a, 0x7,  0x23, 0x17, 0xd2, 0x18,
                   0x0,  0x0,  0x1b, 0x63, 0x8,  0x0,  0x9,  0x5,  0x52, 0x5d, 0xca, 0x91, 0xa7, 0xf6, 0xfd, 0xc7,
                   0x12, 0x0,  0x13, 0xc4, 0xa3, 0x3e, 0x9a, 0x71, 0x3c, 0xf5, 0xb6, 0x15, 0x9b, 0xfe, 0x2c, 0x89,
                   0x4d, 0x51, 0xea, 0xbe, 0x68, 0x16, 0x13, 0x6f, 0xb9, 0x0,  0x1,  0xa2, 0x2,  0x0,  0x13, 0xc8,
                   0x97, 0xd0, 0x63, 0x1c, 0xe4, 0xab, 0xe5, 0x8f, 0x63, 0xd2, 0xa,  0x6f, 0x11, 0x46, 0x28, 0x93,
                   0x77, 0x9e, 0x1,  0x0,  0xa,  0x77, 0xce, 0xd8, 0x65, 0xff, 0x68, 0xed, 0xfc, 0xb2, 0x2e, 0x2,
                   0x0,  0x1c, 0xc4, 0x29, 0xa8, 0x78, 0x30, 0xf2, 0xc7, 0xf,  0xfb, 0xdf, 0x4c, 0x96, 0xb7, 0xea,
                   0xcd, 0xc5, 0x89, 0x60, 0xd7, 0x27, 0x7,  0x44, 0xa4, 0x4,  0x35, 0x94, 0x17, 0xbd, 0x2};

  uint8_t buf[169] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xa2};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc8, 0x97, 0xd0, 0x63, 0x1c, 0xe4, 0xab, 0xe5, 0x8f, 0x63,
                                     0xd2, 0xa,  0x6f, 0x11, 0x46, 0x28, 0x93, 0x77, 0x9e};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x77, 0xce, 0xd8, 0x65, 0xff, 0x68, 0xed, 0xfc, 0xb2, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc4, 0x29, 0xa8, 0x78, 0x30, 0xf2, 0xc7, 0xf,  0xfb, 0xdf,
                                     0x4c, 0x96, 0xb7, 0xea, 0xcd, 0xc5, 0x89, 0x60, 0xd7, 0x27,
                                     0x7,  0x44, 0xa4, 0x4,  0x35, 0x94, 0x17, 0xbd};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x78, 0xcd, 0xe2, 0x4b, 0xa9, 0x5a, 0x4d, 0xe4, 0x9b, 0x2c, 0x77, 0x1c, 0x7,
                           0xc1, 0x6e, 0xc0, 0xe1, 0x4e, 0xfb, 0xa6, 0xf1, 0xe6, 0x9f, 0xac, 0xf9, 0x90};
  uint8_t bytesprops1[] = {0x5, 0x52, 0x5d, 0xca, 0x91, 0xa7, 0xf6, 0xfd, 0xc7};
  uint8_t bytesprops2[] = {0xc4, 0xa3, 0x3e, 0x9a, 0x71, 0x3c, 0xf5, 0xb6, 0x15, 0x9b,
                           0xfe, 0x2c, 0x89, 0x4d, 0x51, 0xea, 0xbe, 0x68, 0x16};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 169}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 229}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 27247}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 7}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6098}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 7011}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 28601}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 19821, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21770
// [("\139=b\145p\157\223b|\STX[\197\203\167e^\171\235\151}k\149\EOT\132\SO\239\218\159\152",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ACK\227+\134\ETB\170\253\166",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\148-\198\ACKO:X\191\162",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\128\150\&7\b\f^g\182Dr\t8k\240\170\&7",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("jBu\DC1!5\207\193K6\164\a\EOT\189m\169\154}\186\220\246\141\&8\167\GS\184\RS\192",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("s\207#\r\188b4B|f>\135\234\142\&7\202\154\186",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropSubscriptionIdentifierAvailable
// 66,PropContentType ",Gd\165.?\DC2b\148H\244]\NAK\179\b\230\199\162\249/\168\255",PropContentType
// "\161\128\&7\169\SI\STX\132\142\241\r\DC3\234e\153\180\193j\164\DC2\230\220a\194H\154\217z?",PropSubscriptionIdentifier
// 20,PropServerKeepAlive 27818,PropWildcardSubscriptionAvailable 207,PropAuthenticationMethod
// "0\248\178\173\199\STX\t5\251\236 /FAy\158\174\230\SYN\152\151",PropPayloadFormatIndicator 0,PropCorrelationData
// "&\250\151Y",PropAuthenticationData
// "e\191\149m\242\ACKN\208\EOTu\GS\STX\142\155\b\225\243\154\172Z~O\250\165\157",PropRequestProblemInformation
// 85,PropMessageExpiryInterval 32539,PropRetainAvailable 248,PropWillDelayInterval 17574,PropRequestResponseInformation
// 127,PropSharedSubscriptionAvailable 69,PropTopicAlias 32610,PropTopicAliasMaximum 1124,PropRequestProblemInformation
// 52,PropServerKeepAlive 14995,PropSubscriptionIdentifier 22,PropWildcardSubscriptionAvailable
// 199,PropMaximumPacketSize 31108,PropRetainAvailable 211,PropCorrelationData "6\247\174\209",PropTopicAlias 25422]
TEST(Subscribe5QCTest, Encode31) {
  uint8_t pkt[] = {
      0x82, 0xb2, 0x2,  0x55, 0xa,  0xb0, 0x1,  0x29, 0x42, 0x3,  0x0,  0x16, 0x2c, 0x47, 0x64, 0xa5, 0x2e, 0x3f, 0x12,
      0x62, 0x94, 0x48, 0xf4, 0x5d, 0x15, 0xb3, 0x8,  0xe6, 0xc7, 0xa2, 0xf9, 0x2f, 0xa8, 0xff, 0x3,  0x0,  0x1c, 0xa1,
      0x80, 0x37, 0xa9, 0xf,  0x2,  0x84, 0x8e, 0xf1, 0xd,  0x13, 0xea, 0x65, 0x99, 0xb4, 0xc1, 0x6a, 0xa4, 0x12, 0xe6,
      0xdc, 0x61, 0xc2, 0x48, 0x9a, 0xd9, 0x7a, 0x3f, 0xb,  0x14, 0x13, 0x6c, 0xaa, 0x28, 0xcf, 0x15, 0x0,  0x15, 0x30,
      0xf8, 0xb2, 0xad, 0xc7, 0x2,  0x9,  0x35, 0xfb, 0xec, 0x20, 0x2f, 0x46, 0x41, 0x79, 0x9e, 0xae, 0xe6, 0x16, 0x98,
      0x97, 0x1,  0x0,  0x9,  0x0,  0x4,  0x26, 0xfa, 0x97, 0x59, 0x16, 0x0,  0x19, 0x65, 0xbf, 0x95, 0x6d, 0xf2, 0x6,
      0x4e, 0xd0, 0x4,  0x75, 0x1d, 0x2,  0x8e, 0x9b, 0x8,  0xe1, 0xf3, 0x9a, 0xac, 0x5a, 0x7e, 0x4f, 0xfa, 0xa5, 0x9d,
      0x17, 0x55, 0x2,  0x0,  0x0,  0x7f, 0x1b, 0x25, 0xf8, 0x18, 0x0,  0x0,  0x44, 0xa6, 0x19, 0x7f, 0x2a, 0x45, 0x23,
      0x7f, 0x62, 0x22, 0x4,  0x64, 0x17, 0x34, 0x13, 0x3a, 0x93, 0xb,  0x16, 0x28, 0xc7, 0x27, 0x0,  0x0,  0x79, 0x84,
      0x25, 0xd3, 0x9,  0x0,  0x4,  0x36, 0xf7, 0xae, 0xd1, 0x23, 0x63, 0x4e, 0x0,  0x1d, 0x8b, 0x3d, 0x62, 0x91, 0x70,
      0x9d, 0xdf, 0x62, 0x7c, 0x2,  0x5b, 0xc5, 0xcb, 0xa7, 0x65, 0x5e, 0xab, 0xeb, 0x97, 0x7d, 0x6b, 0x95, 0x4,  0x84,
      0xe,  0xef, 0xda, 0x9f, 0x98, 0x1,  0x0,  0x8,  0x6,  0xe3, 0x2b, 0x86, 0x17, 0xaa, 0xfd, 0xa6, 0x2,  0x0,  0x9,
      0x94, 0x2d, 0xc6, 0x6,  0x4f, 0x3a, 0x58, 0xbf, 0xa2, 0x2,  0x0,  0x10, 0x80, 0x96, 0x37, 0x8,  0xc,  0x5e, 0x67,
      0xb6, 0x44, 0x72, 0x9,  0x38, 0x6b, 0xf0, 0xaa, 0x37, 0x1,  0x0,  0x1c, 0x6a, 0x42, 0x75, 0x11, 0x21, 0x35, 0xcf,
      0xc1, 0x4b, 0x36, 0xa4, 0x7,  0x4,  0xbd, 0x6d, 0xa9, 0x9a, 0x7d, 0xba, 0xdc, 0xf6, 0x8d, 0x38, 0xa7, 0x1d, 0xb8,
      0x1e, 0xc0, 0x2,  0x0,  0x12, 0x73, 0xcf, 0x23, 0xd,  0xbc, 0x62, 0x34, 0x42, 0x7c, 0x66, 0x3e, 0x87, 0xea, 0x8e,
      0x37, 0xca, 0x9a, 0xba, 0x1};

  uint8_t buf[319] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x8b, 0x3d, 0x62, 0x91, 0x70, 0x9d, 0xdf, 0x62, 0x7c, 0x2,
                                     0x5b, 0xc5, 0xcb, 0xa7, 0x65, 0x5e, 0xab, 0xeb, 0x97, 0x7d,
                                     0x6b, 0x95, 0x4,  0x84, 0xe,  0xef, 0xda, 0x9f, 0x98};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6, 0xe3, 0x2b, 0x86, 0x17, 0xaa, 0xfd, 0xa6};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x94, 0x2d, 0xc6, 0x6, 0x4f, 0x3a, 0x58, 0xbf, 0xa2};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x80, 0x96, 0x37, 0x8,  0xc,  0x5e, 0x67, 0xb6,
                                     0x44, 0x72, 0x9,  0x38, 0x6b, 0xf0, 0xaa, 0x37};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6a, 0x42, 0x75, 0x11, 0x21, 0x35, 0xcf, 0xc1, 0x4b, 0x36,
                                     0xa4, 0x7,  0x4,  0xbd, 0x6d, 0xa9, 0x9a, 0x7d, 0xba, 0xdc,
                                     0xf6, 0x8d, 0x38, 0xa7, 0x1d, 0xb8, 0x1e, 0xc0};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x73, 0xcf, 0x23, 0xd,  0xbc, 0x62, 0x34, 0x42, 0x7c,
                                     0x66, 0x3e, 0x87, 0xea, 0x8e, 0x37, 0xca, 0x9a, 0xba};
  lwmqtt_string_t topic_filter_s5 = {18, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x2c, 0x47, 0x64, 0xa5, 0x2e, 0x3f, 0x12, 0x62, 0x94, 0x48, 0xf4,
                           0x5d, 0x15, 0xb3, 0x8,  0xe6, 0xc7, 0xa2, 0xf9, 0x2f, 0xa8, 0xff};
  uint8_t bytesprops1[] = {0xa1, 0x80, 0x37, 0xa9, 0xf,  0x2,  0x84, 0x8e, 0xf1, 0xd,  0x13, 0xea, 0x65, 0x99,
                           0xb4, 0xc1, 0x6a, 0xa4, 0x12, 0xe6, 0xdc, 0x61, 0xc2, 0x48, 0x9a, 0xd9, 0x7a, 0x3f};
  uint8_t bytesprops2[] = {0x30, 0xf8, 0xb2, 0xad, 0xc7, 0x2,  0x9,  0x35, 0xfb, 0xec, 0x20,
                           0x2f, 0x46, 0x41, 0x79, 0x9e, 0xae, 0xe6, 0x16, 0x98, 0x97};
  uint8_t bytesprops3[] = {0x26, 0xfa, 0x97, 0x59};
  uint8_t bytesprops4[] = {0x65, 0xbf, 0x95, 0x6d, 0xf2, 0x6,  0x4e, 0xd0, 0x4,  0x75, 0x1d, 0x2, 0x8e,
                           0x9b, 0x8,  0xe1, 0xf3, 0x9a, 0xac, 0x5a, 0x7e, 0x4f, 0xfa, 0xa5, 0x9d};
  uint8_t bytesprops5[] = {0x36, 0xf7, 0xae, 0xd1};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 66}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 20}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27818}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 207}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 0}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 85}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32539}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 248}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17574}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 127}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 69}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 32610}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1124}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 52}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 14995}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 22}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 199}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31108}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 211}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {4, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25422}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21770, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 24232
// [("\228\219\211\ENQ\144\&1\EMRC\252<\249\191\134\214I\149\ENQ\204~\DC4\165\182\150\219\180^\DC2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("js\191\171\SYN\189\226K\172j8\255\165\172\234R\174`\205\174\r)\ESCN\b\166\150\&6\151",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\195\230#0b={P\147",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS =
// QoS1}),("\b\181\152j\EMo\228\134\219\174\179~\246\170>\175\209\193\138D\129\150K\v\163.\223@",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("F\212\150u\137\212\165\227\t\252\203'8\195\187\205~",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\232\133xTT\221\207\NUL",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\ETX}\171pE",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("@$\166\244=%&\CANS\tx2\215\"\DLE\204\197\147\DC4nU\ENQ]\229>\EM`\246H",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\153\175\GS\173\ETB\160a\b\FS\195\152\193\STX\139\242\129\254{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\244\&6\\v\143b\181\188\130\153t\237\185>\130",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\161g3\193\181G;",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropMaximumPacketSize
// 3126,PropCorrelationData "\204\133\131*K.8\158\&1\DEL:\174yq\GS\SUB",PropMessageExpiryInterval
// 6930,PropRequestResponseInformation 253,PropContentType "\204\186%\178\187",PropTopicAliasMaximum
// 24459,PropTopicAlias 21845,PropContentType "lM\v>",PropResponseTopic
// "\199\a\138\137\&1_\135/\203/\141\153q\194\153\245B\177\156",PropAuthenticationMethod
// "",PropRequestProblemInformation 137]
TEST(Subscribe5QCTest, Encode32) {
  uint8_t pkt[] = {
      0x82, 0xb4, 0x2,  0x5e, 0xa8, 0x4f, 0x27, 0x0,  0x0,  0xc,  0x36, 0x9,  0x0,  0x10, 0xcc, 0x85, 0x83, 0x2a, 0x4b,
      0x2e, 0x38, 0x9e, 0x31, 0x7f, 0x3a, 0xae, 0x79, 0x71, 0x1d, 0x1a, 0x2,  0x0,  0x0,  0x1b, 0x12, 0x19, 0xfd, 0x3,
      0x0,  0x5,  0xcc, 0xba, 0x25, 0xb2, 0xbb, 0x22, 0x5f, 0x8b, 0x23, 0x55, 0x55, 0x3,  0x0,  0x4,  0x6c, 0x4d, 0xb,
      0x3e, 0x8,  0x0,  0x13, 0xc7, 0x7,  0x8a, 0x89, 0x31, 0x5f, 0x87, 0x2f, 0xcb, 0x2f, 0x8d, 0x99, 0x71, 0xc2, 0x99,
      0xf5, 0x42, 0xb1, 0x9c, 0x15, 0x0,  0x0,  0x17, 0x89, 0x0,  0x1c, 0xe4, 0xdb, 0xd3, 0x5,  0x90, 0x31, 0x19, 0x52,
      0x43, 0xfc, 0x3c, 0xf9, 0xbf, 0x86, 0xd6, 0x49, 0x95, 0x5,  0xcc, 0x7e, 0x14, 0xa5, 0xb6, 0x96, 0xdb, 0xb4, 0x5e,
      0x12, 0x0,  0x0,  0x1d, 0x6a, 0x73, 0xbf, 0xab, 0x16, 0xbd, 0xe2, 0x4b, 0xac, 0x6a, 0x38, 0xff, 0xa5, 0xac, 0xea,
      0x52, 0xae, 0x60, 0xcd, 0xae, 0xd,  0x29, 0x1b, 0x4e, 0x8,  0xa6, 0x96, 0x36, 0x97, 0x0,  0x0,  0x9,  0xc3, 0xe6,
      0x23, 0x30, 0x62, 0x3d, 0x7b, 0x50, 0x93, 0x1,  0x0,  0x1c, 0x8,  0xb5, 0x98, 0x6a, 0x19, 0x6f, 0xe4, 0x86, 0xdb,
      0xae, 0xb3, 0x7e, 0xf6, 0xaa, 0x3e, 0xaf, 0xd1, 0xc1, 0x8a, 0x44, 0x81, 0x96, 0x4b, 0xb,  0xa3, 0x2e, 0xdf, 0x40,
      0x1,  0x0,  0x11, 0x46, 0xd4, 0x96, 0x75, 0x89, 0xd4, 0xa5, 0xe3, 0x9,  0xfc, 0xcb, 0x27, 0x38, 0xc3, 0xbb, 0xcd,
      0x7e, 0x1,  0x0,  0x8,  0xe8, 0x85, 0x78, 0x54, 0x54, 0xdd, 0xcf, 0x0,  0x0,  0x0,  0x5,  0x3,  0x7d, 0xab, 0x70,
      0x45, 0x1,  0x0,  0x1d, 0x40, 0x24, 0xa6, 0xf4, 0x3d, 0x25, 0x26, 0x18, 0x53, 0x9,  0x78, 0x32, 0xd7, 0x22, 0x10,
      0xcc, 0xc5, 0x93, 0x14, 0x6e, 0x55, 0x5,  0x5d, 0xe5, 0x3e, 0x19, 0x60, 0xf6, 0x48, 0x0,  0x0,  0x12, 0x99, 0xaf,
      0x1d, 0xad, 0x17, 0xa0, 0x61, 0x8,  0x1c, 0xc3, 0x98, 0xc1, 0x2,  0x8b, 0xf2, 0x81, 0xfe, 0x7b, 0x0,  0x0,  0xf,
      0xf4, 0x36, 0x5c, 0x76, 0x8f, 0x62, 0xb5, 0xbc, 0x82, 0x99, 0x74, 0xed, 0xb9, 0x3e, 0x82, 0x2,  0x0,  0x7,  0xa1,
      0x67, 0x33, 0xc1, 0xb5, 0x47, 0x3b, 0x1};

  uint8_t buf[321] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xe4, 0xdb, 0xd3, 0x5, 0x90, 0x31, 0x19, 0x52, 0x43, 0xfc, 0x3c, 0xf9, 0xbf, 0x86,
                                     0xd6, 0x49, 0x95, 0x5, 0xcc, 0x7e, 0x14, 0xa5, 0xb6, 0x96, 0xdb, 0xb4, 0x5e, 0x12};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x6a, 0x73, 0xbf, 0xab, 0x16, 0xbd, 0xe2, 0x4b, 0xac, 0x6a,
                                     0x38, 0xff, 0xa5, 0xac, 0xea, 0x52, 0xae, 0x60, 0xcd, 0xae,
                                     0xd,  0x29, 0x1b, 0x4e, 0x8,  0xa6, 0x96, 0x36, 0x97};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc3, 0xe6, 0x23, 0x30, 0x62, 0x3d, 0x7b, 0x50, 0x93};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8,  0xb5, 0x98, 0x6a, 0x19, 0x6f, 0xe4, 0x86, 0xdb, 0xae,
                                     0xb3, 0x7e, 0xf6, 0xaa, 0x3e, 0xaf, 0xd1, 0xc1, 0x8a, 0x44,
                                     0x81, 0x96, 0x4b, 0xb,  0xa3, 0x2e, 0xdf, 0x40};
  lwmqtt_string_t topic_filter_s3 = {28, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x46, 0xd4, 0x96, 0x75, 0x89, 0xd4, 0xa5, 0xe3, 0x9,
                                     0xfc, 0xcb, 0x27, 0x38, 0xc3, 0xbb, 0xcd, 0x7e};
  lwmqtt_string_t topic_filter_s4 = {17, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe8, 0x85, 0x78, 0x54, 0x54, 0xdd, 0xcf, 0x0};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3, 0x7d, 0xab, 0x70, 0x45};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x40, 0x24, 0xa6, 0xf4, 0x3d, 0x25, 0x26, 0x18, 0x53, 0x9,
                                     0x78, 0x32, 0xd7, 0x22, 0x10, 0xcc, 0xc5, 0x93, 0x14, 0x6e,
                                     0x55, 0x5,  0x5d, 0xe5, 0x3e, 0x19, 0x60, 0xf6, 0x48};
  lwmqtt_string_t topic_filter_s7 = {29, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x99, 0xaf, 0x1d, 0xad, 0x17, 0xa0, 0x61, 0x8,  0x1c,
                                     0xc3, 0x98, 0xc1, 0x2,  0x8b, 0xf2, 0x81, 0xfe, 0x7b};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf4, 0x36, 0x5c, 0x76, 0x8f, 0x62, 0xb5, 0xbc,
                                     0x82, 0x99, 0x74, 0xed, 0xb9, 0x3e, 0x82};
  lwmqtt_string_t topic_filter_s9 = {15, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xa1, 0x67, 0x33, 0xc1, 0xb5, 0x47, 0x3b};
  lwmqtt_string_t topic_filter_s10 = {7, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xcc, 0x85, 0x83, 0x2a, 0x4b, 0x2e, 0x38, 0x9e,
                           0x31, 0x7f, 0x3a, 0xae, 0x79, 0x71, 0x1d, 0x1a};
  uint8_t bytesprops1[] = {0xcc, 0xba, 0x25, 0xb2, 0xbb};
  uint8_t bytesprops2[] = {0x6c, 0x4d, 0xb, 0x3e};
  uint8_t bytesprops3[] = {0xc7, 0x7,  0x8a, 0x89, 0x31, 0x5f, 0x87, 0x2f, 0xcb, 0x2f,
                           0x8d, 0x99, 0x71, 0xc2, 0x99, 0xf5, 0x42, 0xb1, 0x9c};
  uint8_t bytesprops4[] = {0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 3126}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6930}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 253}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {5, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24459}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21845}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {4, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {0, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 137}},
  };

  lwmqtt_properties_t props = {11, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 24232, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1966 [("\202jY\229%\180?VjcM\232\215\146\SYNs\253\SYNW\162\170\244Y",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("6\r\249\236N\201*c",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("K\131A\193\166$\USc,N\221\254\172\242\137\232s\"l\ETB\DC4;S\198(",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("r\129\"\198\151\161\183\159\156\156\202\DC1\GS\153\EOT\ETX\146",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\202aP!\RSH\210E\130Q\ETX\r\161r
// \168u\216\145\SYN\157G\204\148\180\STX",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("]wv2\143\149\148\159\RS\157",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\158\DC4\161$H\248\233\&7q\130-\225\219em\181\DC4nH\v\228=G#0\243O\f\DC4{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),(";\232\243\148t\249g\EM\247\&4
// \198\130\228\f\ACK\203\199\250\215\&6\RS\148",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS0}),("I\191\225\be\SO\193\210\CAN=z\199$i\\a\157\145\132\&7\137\174\GS\148\ESC\245\194\193\134J",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\189\225\230\152\147\154q\DC2\158\197\187\194\178\146&\GSl\235\157\248\246\"\232\253\204\253I\DC2\143<",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropAuthenticationMethod "D\199\188\STX\SO9\\\155M\171\CAN\241u\223\237\253'",PropTopicAliasMaximum
// 29564,PropServerReference "\153}\CAN\241\237\175w\139,\197\252",PropServerKeepAlive
// 32502,PropSharedSubscriptionAvailable 2,PropMaximumQoS 21,PropMaximumPacketSize 11144,PropTopicAlias
// 22858,PropSharedSubscriptionAvailable 196,PropServerReference "\230\&66\242M]h\193\160",PropMaximumQoS
// 22,PropTopicAliasMaximum 32231,PropUserProperty
// "&\168\228\236\146'\185A\US\234\137\DLEA\215hp]\196\129\t{\167\161\STX\217sK\214C"
// "*+\DELc4\ESCR\155S\196>7\159\159\142\141\137|O;8\163j\148\251\167\250!P",PropTopicAlias
// 4591,PropRequestResponseInformation 66,PropCorrelationData
// "\EOTj\198\r\rd\207\129c4\200\SOH\EM\152]\254Vq",PropTopicAlias 13262,PropRetainAvailable 146,PropTopicAliasMaximum
// 12396,PropRequestResponseInformation 210,PropAuthenticationData
// "\240\166T\CAN;\CAN\SI\DC2\NUL;\209H",PropResponseTopic
// "\195\170\142tsHK*8eDw\165&\EMX]\240\&24\154\138\254",PropContentType
// "\SOH.X\215\150\130\&6+\165\132\197\DELSf\130x\192\CAN&\ENQ\157",PropRequestResponseInformation
// 87,PropRequestProblemInformation 55,PropAuthenticationMethod
// "\217\178-3\238(\224\166\233&\b\159\252\238J\194\207\DEL\161*\168\238{\232g\139\ETB\133",PropPayloadFormatIndicator
// 63,PropContentType "qG\237'\210\159\168^o)\RS",PropUserProperty "\244;\233\139\207\213\237-wS\STX\168y\244"
// "\134\156\223\b\r\RS\240\181I8\183.\235T\188\165-o\190"]
TEST(Subscribe5QCTest, Encode33) {
  uint8_t pkt[] = {
      0x82, 0xc4, 0x4,  0x7,  0xae, 0xc4, 0x2,  0x15, 0x0,  0x11, 0x44, 0xc7, 0xbc, 0x2,  0xe,  0x39, 0x5c, 0x9b, 0x4d,
      0xab, 0x18, 0xf1, 0x75, 0xdf, 0xed, 0xfd, 0x27, 0x22, 0x73, 0x7c, 0x1c, 0x0,  0xb,  0x99, 0x7d, 0x18, 0xf1, 0xed,
      0xaf, 0x77, 0x8b, 0x2c, 0xc5, 0xfc, 0x13, 0x7e, 0xf6, 0x2a, 0x2,  0x24, 0x15, 0x27, 0x0,  0x0,  0x2b, 0x88, 0x23,
      0x59, 0x4a, 0x2a, 0xc4, 0x1c, 0x0,  0x9,  0xe6, 0x36, 0x36, 0xf2, 0x4d, 0x5d, 0x68, 0xc1, 0xa0, 0x24, 0x16, 0x22,
      0x7d, 0xe7, 0x26, 0x0,  0x1d, 0x26, 0xa8, 0xe4, 0xec, 0x92, 0x27, 0xb9, 0x41, 0x1f, 0xea, 0x89, 0x10, 0x41, 0xd7,
      0x68, 0x70, 0x5d, 0xc4, 0x81, 0x9,  0x7b, 0xa7, 0xa1, 0x2,  0xd9, 0x73, 0x4b, 0xd6, 0x43, 0x0,  0x1d, 0x2a, 0x2b,
      0x7f, 0x63, 0x34, 0x1b, 0x52, 0x9b, 0x53, 0xc4, 0x3e, 0x37, 0x9f, 0x9f, 0x8e, 0x8d, 0x89, 0x7c, 0x4f, 0x3b, 0x38,
      0xa3, 0x6a, 0x94, 0xfb, 0xa7, 0xfa, 0x21, 0x50, 0x23, 0x11, 0xef, 0x19, 0x42, 0x9,  0x0,  0x12, 0x4,  0x6a, 0xc6,
      0xd,  0xd,  0x64, 0xcf, 0x81, 0x63, 0x34, 0xc8, 0x1,  0x19, 0x98, 0x5d, 0xfe, 0x56, 0x71, 0x23, 0x33, 0xce, 0x25,
      0x92, 0x22, 0x30, 0x6c, 0x19, 0xd2, 0x16, 0x0,  0xc,  0xf0, 0xa6, 0x54, 0x18, 0x3b, 0x18, 0xf,  0x12, 0x0,  0x3b,
      0xd1, 0x48, 0x8,  0x0,  0x17, 0xc3, 0xaa, 0x8e, 0x74, 0x73, 0x48, 0x4b, 0x2a, 0x38, 0x65, 0x44, 0x77, 0xa5, 0x26,
      0x19, 0x58, 0x5d, 0xf0, 0x32, 0x34, 0x9a, 0x8a, 0xfe, 0x3,  0x0,  0x15, 0x1,  0x2e, 0x58, 0xd7, 0x96, 0x82, 0x36,
      0x2b, 0xa5, 0x84, 0xc5, 0x7f, 0x53, 0x66, 0x82, 0x78, 0xc0, 0x18, 0x26, 0x5,  0x9d, 0x19, 0x57, 0x17, 0x37, 0x15,
      0x0,  0x1c, 0xd9, 0xb2, 0x2d, 0x33, 0xee, 0x28, 0xe0, 0xa6, 0xe9, 0x26, 0x8,  0x9f, 0xfc, 0xee, 0x4a, 0xc2, 0xcf,
      0x7f, 0xa1, 0x2a, 0xa8, 0xee, 0x7b, 0xe8, 0x67, 0x8b, 0x17, 0x85, 0x1,  0x3f, 0x3,  0x0,  0xb,  0x71, 0x47, 0xed,
      0x27, 0xd2, 0x9f, 0xa8, 0x5e, 0x6f, 0x29, 0x1e, 0x26, 0x0,  0xe,  0xf4, 0x3b, 0xe9, 0x8b, 0xcf, 0xd5, 0xed, 0x2d,
      0x77, 0x53, 0x2,  0xa8, 0x79, 0xf4, 0x0,  0x13, 0x86, 0x9c, 0xdf, 0x8,  0xd,  0x1e, 0xf0, 0xb5, 0x49, 0x38, 0xb7,
      0x2e, 0xeb, 0x54, 0xbc, 0xa5, 0x2d, 0x6f, 0xbe, 0x0,  0x17, 0xca, 0x6a, 0x59, 0xe5, 0x25, 0xb4, 0x3f, 0x56, 0x6a,
      0x63, 0x4d, 0xe8, 0xd7, 0x92, 0x16, 0x73, 0xfd, 0x16, 0x57, 0xa2, 0xaa, 0xf4, 0x59, 0x2,  0x0,  0x8,  0x36, 0xd,
      0xf9, 0xec, 0x4e, 0xc9, 0x2a, 0x63, 0x0,  0x0,  0x19, 0x4b, 0x83, 0x41, 0xc1, 0xa6, 0x24, 0x1f, 0x63, 0x2c, 0x4e,
      0xdd, 0xfe, 0xac, 0xf2, 0x89, 0xe8, 0x73, 0x22, 0x6c, 0x17, 0x14, 0x3b, 0x53, 0xc6, 0x28, 0x2,  0x0,  0x11, 0x72,
      0x81, 0x22, 0xc6, 0x97, 0xa1, 0xb7, 0x9f, 0x9c, 0x9c, 0xca, 0x11, 0x1d, 0x99, 0x4,  0x3,  0x92, 0x0,  0x0,  0x1a,
      0xca, 0x61, 0x50, 0x21, 0x1e, 0x48, 0xd2, 0x45, 0x82, 0x51, 0x3,  0xd,  0xa1, 0x72, 0x20, 0xa8, 0x75, 0xd8, 0x91,
      0x16, 0x9d, 0x47, 0xcc, 0x94, 0xb4, 0x2,  0x0,  0x0,  0xa,  0x5d, 0x77, 0x76, 0x32, 0x8f, 0x95, 0x94, 0x9f, 0x1e,
      0x9d, 0x2,  0x0,  0x1e, 0x9e, 0x14, 0xa1, 0x24, 0x48, 0xf8, 0xe9, 0x37, 0x71, 0x82, 0x2d, 0xe1, 0xdb, 0x65, 0x6d,
      0xb5, 0x14, 0x6e, 0x48, 0xb,  0xe4, 0x3d, 0x47, 0x23, 0x30, 0xf3, 0x4f, 0xc,  0x14, 0x7b, 0x1,  0x0,  0x17, 0x3b,
      0xe8, 0xf3, 0x94, 0x74, 0xf9, 0x67, 0x19, 0xf7, 0x34, 0x20, 0xc6, 0x82, 0xe4, 0xc,  0x6,  0xcb, 0xc7, 0xfa, 0xd7,
      0x36, 0x1e, 0x94, 0x0,  0x0,  0x1e, 0x49, 0xbf, 0xe1, 0x8,  0x65, 0xe,  0xc1, 0xd2, 0x18, 0x3d, 0x7a, 0xc7, 0x24,
      0x69, 0x5c, 0x61, 0x9d, 0x91, 0x84, 0x37, 0x89, 0xae, 0x1d, 0x94, 0x1b, 0xf5, 0xc2, 0xc1, 0x86, 0x4a, 0x0,  0x0,
      0x1e, 0xbd, 0xe1, 0xe6, 0x98, 0x93, 0x9a, 0x71, 0x12, 0x9e, 0xc5, 0xbb, 0xc2, 0xb2, 0x92, 0x26, 0x1d, 0x6c, 0xeb,
      0x9d, 0xf8, 0xf6, 0x22, 0xe8, 0xfd, 0xcc, 0xfd, 0x49, 0x12, 0x8f, 0x3c, 0x2};

  uint8_t buf[593] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0xca, 0x6a, 0x59, 0xe5, 0x25, 0xb4, 0x3f, 0x56, 0x6a, 0x63, 0x4d, 0xe8,
                                     0xd7, 0x92, 0x16, 0x73, 0xfd, 0x16, 0x57, 0xa2, 0xaa, 0xf4, 0x59};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x36, 0xd, 0xf9, 0xec, 0x4e, 0xc9, 0x2a, 0x63};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4b, 0x83, 0x41, 0xc1, 0xa6, 0x24, 0x1f, 0x63, 0x2c, 0x4e, 0xdd, 0xfe, 0xac,
                                     0xf2, 0x89, 0xe8, 0x73, 0x22, 0x6c, 0x17, 0x14, 0x3b, 0x53, 0xc6, 0x28};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x72, 0x81, 0x22, 0xc6, 0x97, 0xa1, 0xb7, 0x9f, 0x9c,
                                     0x9c, 0xca, 0x11, 0x1d, 0x99, 0x4,  0x3,  0x92};
  lwmqtt_string_t topic_filter_s3 = {17, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xca, 0x61, 0x50, 0x21, 0x1e, 0x48, 0xd2, 0x45, 0x82, 0x51, 0x3,  0xd,  0xa1,
                                     0x72, 0x20, 0xa8, 0x75, 0xd8, 0x91, 0x16, 0x9d, 0x47, 0xcc, 0x94, 0xb4, 0x2};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x5d, 0x77, 0x76, 0x32, 0x8f, 0x95, 0x94, 0x9f, 0x1e, 0x9d};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x9e, 0x14, 0xa1, 0x24, 0x48, 0xf8, 0xe9, 0x37, 0x71, 0x82,
                                     0x2d, 0xe1, 0xdb, 0x65, 0x6d, 0xb5, 0x14, 0x6e, 0x48, 0xb,
                                     0xe4, 0x3d, 0x47, 0x23, 0x30, 0xf3, 0x4f, 0xc,  0x14, 0x7b};
  lwmqtt_string_t topic_filter_s6 = {30, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x3b, 0xe8, 0xf3, 0x94, 0x74, 0xf9, 0x67, 0x19, 0xf7, 0x34, 0x20, 0xc6,
                                     0x82, 0xe4, 0xc,  0x6,  0xcb, 0xc7, 0xfa, 0xd7, 0x36, 0x1e, 0x94};
  lwmqtt_string_t topic_filter_s7 = {23, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x49, 0xbf, 0xe1, 0x8,  0x65, 0xe,  0xc1, 0xd2, 0x18, 0x3d,
                                     0x7a, 0xc7, 0x24, 0x69, 0x5c, 0x61, 0x9d, 0x91, 0x84, 0x37,
                                     0x89, 0xae, 0x1d, 0x94, 0x1b, 0xf5, 0xc2, 0xc1, 0x86, 0x4a};
  lwmqtt_string_t topic_filter_s8 = {30, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xbd, 0xe1, 0xe6, 0x98, 0x93, 0x9a, 0x71, 0x12, 0x9e, 0xc5,
                                     0xbb, 0xc2, 0xb2, 0x92, 0x26, 0x1d, 0x6c, 0xeb, 0x9d, 0xf8,
                                     0xf6, 0x22, 0xe8, 0xfd, 0xcc, 0xfd, 0x49, 0x12, 0x8f, 0x3c};
  lwmqtt_string_t topic_filter_s9 = {30, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x44, 0xc7, 0xbc, 0x2,  0xe,  0x39, 0x5c, 0x9b, 0x4d,
                           0xab, 0x18, 0xf1, 0x75, 0xdf, 0xed, 0xfd, 0x27};
  uint8_t bytesprops1[] = {0x99, 0x7d, 0x18, 0xf1, 0xed, 0xaf, 0x77, 0x8b, 0x2c, 0xc5, 0xfc};
  uint8_t bytesprops2[] = {0xe6, 0x36, 0x36, 0xf2, 0x4d, 0x5d, 0x68, 0xc1, 0xa0};
  uint8_t bytesprops4[] = {0x2a, 0x2b, 0x7f, 0x63, 0x34, 0x1b, 0x52, 0x9b, 0x53, 0xc4, 0x3e, 0x37, 0x9f, 0x9f, 0x8e,
                           0x8d, 0x89, 0x7c, 0x4f, 0x3b, 0x38, 0xa3, 0x6a, 0x94, 0xfb, 0xa7, 0xfa, 0x21, 0x50};
  uint8_t bytesprops3[] = {0x26, 0xa8, 0xe4, 0xec, 0x92, 0x27, 0xb9, 0x41, 0x1f, 0xea, 0x89, 0x10, 0x41, 0xd7, 0x68,
                           0x70, 0x5d, 0xc4, 0x81, 0x9,  0x7b, 0xa7, 0xa1, 0x2,  0xd9, 0x73, 0x4b, 0xd6, 0x43};
  uint8_t bytesprops5[] = {0x4,  0x6a, 0xc6, 0xd,  0xd,  0x64, 0xcf, 0x81, 0x63,
                           0x34, 0xc8, 0x1,  0x19, 0x98, 0x5d, 0xfe, 0x56, 0x71};
  uint8_t bytesprops6[] = {0xf0, 0xa6, 0x54, 0x18, 0x3b, 0x18, 0xf, 0x12, 0x0, 0x3b, 0xd1, 0x48};
  uint8_t bytesprops7[] = {0xc3, 0xaa, 0x8e, 0x74, 0x73, 0x48, 0x4b, 0x2a, 0x38, 0x65, 0x44, 0x77,
                           0xa5, 0x26, 0x19, 0x58, 0x5d, 0xf0, 0x32, 0x34, 0x9a, 0x8a, 0xfe};
  uint8_t bytesprops8[] = {0x1,  0x2e, 0x58, 0xd7, 0x96, 0x82, 0x36, 0x2b, 0xa5, 0x84, 0xc5,
                           0x7f, 0x53, 0x66, 0x82, 0x78, 0xc0, 0x18, 0x26, 0x5,  0x9d};
  uint8_t bytesprops9[] = {0xd9, 0xb2, 0x2d, 0x33, 0xee, 0x28, 0xe0, 0xa6, 0xe9, 0x26, 0x8,  0x9f, 0xfc, 0xee,
                           0x4a, 0xc2, 0xcf, 0x7f, 0xa1, 0x2a, 0xa8, 0xee, 0x7b, 0xe8, 0x67, 0x8b, 0x17, 0x85};
  uint8_t bytesprops10[] = {0x71, 0x47, 0xed, 0x27, 0xd2, 0x9f, 0xa8, 0x5e, 0x6f, 0x29, 0x1e};
  uint8_t bytesprops12[] = {0x86, 0x9c, 0xdf, 0x8,  0xd,  0x1e, 0xf0, 0xb5, 0x49, 0x38,
                            0xb7, 0x2e, 0xeb, 0x54, 0xbc, 0xa5, 0x2d, 0x6f, 0xbe};
  uint8_t bytesprops11[] = {0xf4, 0x3b, 0xe9, 0x8b, 0xcf, 0xd5, 0xed, 0x2d, 0x77, 0x53, 0x2, 0xa8, 0x79, 0xf4};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {17, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 29564}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {11, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 32502}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 2}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 21}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 11144}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22858}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 196}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {9, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 22}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32231}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {29, (char*)&bytesprops3}, .v = {29, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4591}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 66}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {18, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 13262}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 146}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 12396}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 210}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 87}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 55}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {28, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 63}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {14, (char*)&bytesprops11}, .v = {19, (char*)&bytesprops12}}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1966, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 11595 [("\157Y\254\b\253\241E\158M\CAN\255\215Q\ENQ\217\131\177",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\171\DC1\150\DLE\ETBSSi\198{\213\206\249t\216\rt\218\236\161\143\&8\145",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\181\FS]\249\210A:\189\185\DC1\ENQ\175]\150\218\169\SOH\193\SOH`\150\169\182l",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\233/\143\172\SIn:m\212Pf\177&\234\165\181\226\DEL3\153\SI\241l\144\242",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropReceiveMaximum
// 4658,PropMaximumQoS 249,PropServerKeepAlive 13,PropResponseTopic
// "\156\163\169,\213\&3\131\186\DC1K\128\162\&2\222{\170\152y\164\DC1\255\180\137\142\237",PropCorrelationData
// "\254",PropTopicAliasMaximum 27561,PropSharedSubscriptionAvailable 233,PropMessageExpiryInterval
// 27068,PropResponseTopic "\186\196h\154\211<\n\180\\9@il`\149a~\246|\220\226\ESC\204",PropMessageExpiryInterval
// 23693,PropSubscriptionIdentifier 16,PropTopicAlias 18385,PropSharedSubscriptionAvailable 18,PropContentType
// "\SOH\138o\228\229B\206\136B\ESCX\147\EOT\FSa",PropAuthenticationData
// "y\129H;\ENQ4\237\v\183\182yn\ACK.\SO\132n\205,\187\DC4`\239>\188",PropResponseInformation
// "\FS\205\250\DC3\134\193\b\SO\239\&2HM",PropSubscriptionIdentifier 27,PropMaximumQoS 122]
TEST(Subscribe5QCTest, Encode34) {
  uint8_t pkt[] = {
      0x82, 0x82, 0x2,  0x2d, 0x4b, 0x99, 0x1,  0x21, 0x12, 0x32, 0x24, 0xf9, 0x13, 0x0,  0xd,  0x8,  0x0,  0x19, 0x9c,
      0xa3, 0xa9, 0x2c, 0xd5, 0x33, 0x83, 0xba, 0x11, 0x4b, 0x80, 0xa2, 0x32, 0xde, 0x7b, 0xaa, 0x98, 0x79, 0xa4, 0x11,
      0xff, 0xb4, 0x89, 0x8e, 0xed, 0x9,  0x0,  0x1,  0xfe, 0x22, 0x6b, 0xa9, 0x2a, 0xe9, 0x2,  0x0,  0x0,  0x69, 0xbc,
      0x8,  0x0,  0x17, 0xba, 0xc4, 0x68, 0x9a, 0xd3, 0x3c, 0xa,  0xb4, 0x5c, 0x39, 0x40, 0x69, 0x6c, 0x60, 0x95, 0x61,
      0x7e, 0xf6, 0x7c, 0xdc, 0xe2, 0x1b, 0xcc, 0x2,  0x0,  0x0,  0x5c, 0x8d, 0xb,  0x10, 0x23, 0x47, 0xd1, 0x2a, 0x12,
      0x3,  0x0,  0xf,  0x1,  0x8a, 0x6f, 0xe4, 0xe5, 0x42, 0xce, 0x88, 0x42, 0x1b, 0x58, 0x93, 0x4,  0x1c, 0x61, 0x16,
      0x0,  0x19, 0x79, 0x81, 0x48, 0x3b, 0x5,  0x34, 0xed, 0xb,  0xb7, 0xb6, 0x79, 0x6e, 0x6,  0x2e, 0xe,  0x84, 0x6e,
      0xcd, 0x2c, 0xbb, 0x14, 0x60, 0xef, 0x3e, 0xbc, 0x1a, 0x0,  0xc,  0x1c, 0xcd, 0xfa, 0x13, 0x86, 0xc1, 0x8,  0xe,
      0xef, 0x32, 0x48, 0x4d, 0xb,  0x1b, 0x24, 0x7a, 0x0,  0x11, 0x9d, 0x59, 0xfe, 0x8,  0xfd, 0xf1, 0x45, 0x9e, 0x4d,
      0x18, 0xff, 0xd7, 0x51, 0x5,  0xd9, 0x83, 0xb1, 0x2,  0x0,  0x17, 0xab, 0x11, 0x96, 0x10, 0x17, 0x53, 0x53, 0x69,
      0xc6, 0x7b, 0xd5, 0xce, 0xf9, 0x74, 0xd8, 0xd,  0x74, 0xda, 0xec, 0xa1, 0x8f, 0x38, 0x91, 0x2,  0x0,  0x18, 0xb5,
      0x1c, 0x5d, 0xf9, 0xd2, 0x41, 0x3a, 0xbd, 0xb9, 0x11, 0x5,  0xaf, 0x5d, 0x96, 0xda, 0xa9, 0x1,  0xc1, 0x1,  0x60,
      0x96, 0xa9, 0xb6, 0x6c, 0x2,  0x0,  0x19, 0xe9, 0x2f, 0x8f, 0xac, 0xf,  0x6e, 0x3a, 0x6d, 0xd4, 0x50, 0x66, 0xb1,
      0x26, 0xea, 0xa5, 0xb5, 0xe2, 0x7f, 0x33, 0x99, 0xf,  0xf1, 0x6c, 0x90, 0xf2, 0x1};

  uint8_t buf[271] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x9d, 0x59, 0xfe, 0x8,  0xfd, 0xf1, 0x45, 0x9e, 0x4d,
                                     0x18, 0xff, 0xd7, 0x51, 0x5,  0xd9, 0x83, 0xb1};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x11, 0x96, 0x10, 0x17, 0x53, 0x53, 0x69, 0xc6, 0x7b, 0xd5, 0xce,
                                     0xf9, 0x74, 0xd8, 0xd,  0x74, 0xda, 0xec, 0xa1, 0x8f, 0x38, 0x91};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb5, 0x1c, 0x5d, 0xf9, 0xd2, 0x41, 0x3a, 0xbd, 0xb9, 0x11, 0x5,  0xaf,
                                     0x5d, 0x96, 0xda, 0xa9, 0x1,  0xc1, 0x1,  0x60, 0x96, 0xa9, 0xb6, 0x6c};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xe9, 0x2f, 0x8f, 0xac, 0xf,  0x6e, 0x3a, 0x6d, 0xd4, 0x50, 0x66, 0xb1, 0x26,
                                     0xea, 0xa5, 0xb5, 0xe2, 0x7f, 0x33, 0x99, 0xf,  0xf1, 0x6c, 0x90, 0xf2};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x9c, 0xa3, 0xa9, 0x2c, 0xd5, 0x33, 0x83, 0xba, 0x11, 0x4b, 0x80, 0xa2, 0x32,
                           0xde, 0x7b, 0xaa, 0x98, 0x79, 0xa4, 0x11, 0xff, 0xb4, 0x89, 0x8e, 0xed};
  uint8_t bytesprops1[] = {0xfe};
  uint8_t bytesprops2[] = {0xba, 0xc4, 0x68, 0x9a, 0xd3, 0x3c, 0xa,  0xb4, 0x5c, 0x39, 0x40, 0x69,
                           0x6c, 0x60, 0x95, 0x61, 0x7e, 0xf6, 0x7c, 0xdc, 0xe2, 0x1b, 0xcc};
  uint8_t bytesprops3[] = {0x1, 0x8a, 0x6f, 0xe4, 0xe5, 0x42, 0xce, 0x88, 0x42, 0x1b, 0x58, 0x93, 0x4, 0x1c, 0x61};
  uint8_t bytesprops4[] = {0x79, 0x81, 0x48, 0x3b, 0x5,  0x34, 0xed, 0xb,  0xb7, 0xb6, 0x79, 0x6e, 0x6,
                           0x2e, 0xe,  0x84, 0x6e, 0xcd, 0x2c, 0xbb, 0x14, 0x60, 0xef, 0x3e, 0xbc};
  uint8_t bytesprops5[] = {0x1c, 0xcd, 0xfa, 0x13, 0x86, 0xc1, 0x8, 0xe, 0xef, 0x32, 0x48, 0x4d};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 4658}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 249}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {1, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 27561}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 233}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27068}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23693}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 16}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18385}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 18}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {12, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 27}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 122}},
  };

  lwmqtt_properties_t props = {18, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 11595, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3561 [("\SI\230\235\135\157\175%\128",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\174\n|v\146#k\154\224-R\219\SUB\245k\186\207:
// \r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\DC2\181\156\155\180{\234\ETX\GS\223\168\199u\168N\218w\246\&3\DC3z\168y\249",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\170\211",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("R\230\221\&6\239O\211\146vM3YD\140\129+\194B\160\200\163\189",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropServerReference "i",PropCorrelationData
// "&\244t\193\&3o\f\193\186g\SUB\143\225\215",PropResponseTopic "q=\170\168R\167",PropMaximumQoS
// 195,PropSharedSubscriptionAvailable 84,PropResponseInformation
// "\186\207\146\n\"\201\&9\160m;B\GS\208\201\179\132\205.\131n\221C",PropSessionExpiryInterval
// 31601,PropServerKeepAlive 20698,PropServerReference
// "\132\216\221)\172\160\SI\SUB\a\US*=\SYN\GS\185F\141Y>P\194",PropAuthenticationData
// "\201\209\189\193\GS\193\235\143\USD\FS\193\r\231\t\142\221\132\166\184s\192\157\GSS",PropUserProperty ""
// "I^z\212\224#\235UQ\188\224\244\SYN\USq$\166",PropRequestProblemInformation 35,PropPayloadFormatIndicator
// 73,PropServerKeepAlive 15730,PropTopicAliasMaximum 6340,PropMessageExpiryInterval 27016,PropUserProperty "\149\245"
// "M\169\168\ETXu\FS\185_\156",PropReceiveMaximum 29452,PropMessageExpiryInterval 31914,PropMaximumPacketSize
// 30557,PropCorrelationData "",PropServerReference "}",PropResponseTopic
// "\214\197\244\128\222fq",PropAuthenticationMethod
// "O\170i\240\179\136\207b\206g\222\r\242\221\234^_\140u9i\201\222\173e",PropMaximumQoS 166,PropMessageExpiryInterval
// 9383,PropRequestProblemInformation 42,PropMaximumQoS 173,PropSessionExpiryInterval 20164,PropResponseTopic
// "\186I\232\SUB"]
TEST(Subscribe5QCTest, Encode35) {
  uint8_t pkt[] = {
      0x82, 0xdc, 0x2,  0xd,  0xe9, 0xfd, 0x1,  0x1c, 0x0,  0x1,  0x69, 0x9,  0x0,  0xe,  0x26, 0xf4, 0x74, 0xc1, 0x33,
      0x6f, 0xc,  0xc1, 0xba, 0x67, 0x1a, 0x8f, 0xe1, 0xd7, 0x8,  0x0,  0x6,  0x71, 0x3d, 0xaa, 0xa8, 0x52, 0xa7, 0x24,
      0xc3, 0x2a, 0x54, 0x1a, 0x0,  0x16, 0xba, 0xcf, 0x92, 0xa,  0x22, 0xc9, 0x39, 0xa0, 0x6d, 0x3b, 0x42, 0x1d, 0xd0,
      0xc9, 0xb3, 0x84, 0xcd, 0x2e, 0x83, 0x6e, 0xdd, 0x43, 0x11, 0x0,  0x0,  0x7b, 0x71, 0x13, 0x50, 0xda, 0x1c, 0x0,
      0x15, 0x84, 0xd8, 0xdd, 0x29, 0xac, 0xa0, 0xf,  0x1a, 0x7,  0x1f, 0x2a, 0x3d, 0x16, 0x1d, 0xb9, 0x46, 0x8d, 0x59,
      0x3e, 0x50, 0xc2, 0x16, 0x0,  0x19, 0xc9, 0xd1, 0xbd, 0xc1, 0x1d, 0xc1, 0xeb, 0x8f, 0x1f, 0x44, 0x1c, 0xc1, 0xd,
      0xe7, 0x9,  0x8e, 0xdd, 0x84, 0xa6, 0xb8, 0x73, 0xc0, 0x9d, 0x1d, 0x53, 0x26, 0x0,  0x0,  0x0,  0x11, 0x49, 0x5e,
      0x7a, 0xd4, 0xe0, 0x23, 0xeb, 0x55, 0x51, 0xbc, 0xe0, 0xf4, 0x16, 0x1f, 0x71, 0x24, 0xa6, 0x17, 0x23, 0x1,  0x49,
      0x13, 0x3d, 0x72, 0x22, 0x18, 0xc4, 0x2,  0x0,  0x0,  0x69, 0x88, 0x26, 0x0,  0x2,  0x95, 0xf5, 0x0,  0x9,  0x4d,
      0xa9, 0xa8, 0x3,  0x75, 0x1c, 0xb9, 0x5f, 0x9c, 0x21, 0x73, 0xc,  0x2,  0x0,  0x0,  0x7c, 0xaa, 0x27, 0x0,  0x0,
      0x77, 0x5d, 0x9,  0x0,  0x0,  0x1c, 0x0,  0x1,  0x7d, 0x8,  0x0,  0x7,  0xd6, 0xc5, 0xf4, 0x80, 0xde, 0x66, 0x71,
      0x15, 0x0,  0x19, 0x4f, 0xaa, 0x69, 0xf0, 0xb3, 0x88, 0xcf, 0x62, 0xce, 0x67, 0xde, 0xd,  0xf2, 0xdd, 0xea, 0x5e,
      0x5f, 0x8c, 0x75, 0x39, 0x69, 0xc9, 0xde, 0xad, 0x65, 0x24, 0xa6, 0x2,  0x0,  0x0,  0x24, 0xa7, 0x17, 0x2a, 0x24,
      0xad, 0x11, 0x0,  0x0,  0x4e, 0xc4, 0x8,  0x0,  0x4,  0xba, 0x49, 0xe8, 0x1a, 0x0,  0x8,  0xf,  0xe6, 0xeb, 0x87,
      0x9d, 0xaf, 0x25, 0x80, 0x0,  0x0,  0x14, 0xae, 0xa,  0x7c, 0x76, 0x92, 0x23, 0x6b, 0x9a, 0xe0, 0x2d, 0x52, 0xdb,
      0x1a, 0xf5, 0x6b, 0xba, 0xcf, 0x3a, 0x20, 0xd,  0x0,  0x0,  0x18, 0x12, 0xb5, 0x9c, 0x9b, 0xb4, 0x7b, 0xea, 0x3,
      0x1d, 0xdf, 0xa8, 0xc7, 0x75, 0xa8, 0x4e, 0xda, 0x77, 0xf6, 0x33, 0x13, 0x7a, 0xa8, 0x79, 0xf9, 0x1,  0x0,  0x2,
      0xaa, 0xd3, 0x2,  0x0,  0x16, 0x52, 0xe6, 0xdd, 0x36, 0xef, 0x4f, 0xd3, 0x92, 0x76, 0x4d, 0x33, 0x59, 0x44, 0x8c,
      0x81, 0x2b, 0xc2, 0x42, 0xa0, 0xc8, 0xa3, 0xbd, 0x0};

  uint8_t buf[361] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xf, 0xe6, 0xeb, 0x87, 0x9d, 0xaf, 0x25, 0x80};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0xa,  0x7c, 0x76, 0x92, 0x23, 0x6b, 0x9a, 0xe0, 0x2d,
                                     0x52, 0xdb, 0x1a, 0xf5, 0x6b, 0xba, 0xcf, 0x3a, 0x20, 0xd};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x12, 0xb5, 0x9c, 0x9b, 0xb4, 0x7b, 0xea, 0x3,  0x1d, 0xdf, 0xa8, 0xc7,
                                     0x75, 0xa8, 0x4e, 0xda, 0x77, 0xf6, 0x33, 0x13, 0x7a, 0xa8, 0x79, 0xf9};
  lwmqtt_string_t topic_filter_s2 = {24, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xaa, 0xd3};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x52, 0xe6, 0xdd, 0x36, 0xef, 0x4f, 0xd3, 0x92, 0x76, 0x4d, 0x33,
                                     0x59, 0x44, 0x8c, 0x81, 0x2b, 0xc2, 0x42, 0xa0, 0xc8, 0xa3, 0xbd};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x69};
  uint8_t bytesprops1[] = {0x26, 0xf4, 0x74, 0xc1, 0x33, 0x6f, 0xc, 0xc1, 0xba, 0x67, 0x1a, 0x8f, 0xe1, 0xd7};
  uint8_t bytesprops2[] = {0x71, 0x3d, 0xaa, 0xa8, 0x52, 0xa7};
  uint8_t bytesprops3[] = {0xba, 0xcf, 0x92, 0xa,  0x22, 0xc9, 0x39, 0xa0, 0x6d, 0x3b, 0x42,
                           0x1d, 0xd0, 0xc9, 0xb3, 0x84, 0xcd, 0x2e, 0x83, 0x6e, 0xdd, 0x43};
  uint8_t bytesprops4[] = {0x84, 0xd8, 0xdd, 0x29, 0xac, 0xa0, 0xf,  0x1a, 0x7,  0x1f, 0x2a,
                           0x3d, 0x16, 0x1d, 0xb9, 0x46, 0x8d, 0x59, 0x3e, 0x50, 0xc2};
  uint8_t bytesprops5[] = {0xc9, 0xd1, 0xbd, 0xc1, 0x1d, 0xc1, 0xeb, 0x8f, 0x1f, 0x44, 0x1c, 0xc1, 0xd,
                           0xe7, 0x9,  0x8e, 0xdd, 0x84, 0xa6, 0xb8, 0x73, 0xc0, 0x9d, 0x1d, 0x53};
  uint8_t bytesprops7[] = {0x49, 0x5e, 0x7a, 0xd4, 0xe0, 0x23, 0xeb, 0x55, 0x51,
                           0xbc, 0xe0, 0xf4, 0x16, 0x1f, 0x71, 0x24, 0xa6};
  uint8_t bytesprops6[] = {0};
  uint8_t bytesprops9[] = {0x4d, 0xa9, 0xa8, 0x3, 0x75, 0x1c, 0xb9, 0x5f, 0x9c};
  uint8_t bytesprops8[] = {0x95, 0xf5};
  uint8_t bytesprops10[] = {0};
  uint8_t bytesprops11[] = {0x7d};
  uint8_t bytesprops12[] = {0xd6, 0xc5, 0xf4, 0x80, 0xde, 0x66, 0x71};
  uint8_t bytesprops13[] = {0x4f, 0xaa, 0x69, 0xf0, 0xb3, 0x88, 0xcf, 0x62, 0xce, 0x67, 0xde, 0xd, 0xf2,
                            0xdd, 0xea, 0x5e, 0x5f, 0x8c, 0x75, 0x39, 0x69, 0xc9, 0xde, 0xad, 0x65};
  uint8_t bytesprops14[] = {0xba, 0x49, 0xe8, 0x1a};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {6, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 195}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 84}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31601}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20698}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {0, (char*)&bytesprops6}, .v = {17, (char*)&bytesprops7}}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 35}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 73}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 15730}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6340}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 27016}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {2, (char*)&bytesprops8}, .v = {9, (char*)&bytesprops9}}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29452}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31914}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 30557}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {0, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {25, (char*)&bytesprops13}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 166}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9383}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 42}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 173}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 20164}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops14}}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 3561, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27717 [("\241m\204\194)1\\\134\EOTj\252\251\183\169o~+",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\165\223\t",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ETX)\192\ETXE\164\158\181\239\216\SOH\131\171\196\207",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\182bC|\240!\219\DC4Q\200\161",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\160\162\&7\226\196(\141G\165\139\207\SI\255\171\251J\DC2\ETX\168q'1\240-^\185\192\191]",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("}$%\168\155\130\v\149v!\166",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\167o\ETX\243\&6\210\&8\STX\199\236h\129H1M\147\GS\241\143S\246B\130\234\160\215\223\184",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\SUBq\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("]g\181\SUBP\232h\172\GS\180\247\RS\203\236",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\201\158",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("C\229\189\187\171\185\NAKjA!\129\253",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] [PropUserProperty "\172\&7\175\206\210_"
// "\164\129\&4\176\STX\153\214\v2\200\"\144i\216\&1\236\251\147\164m\230\151Z\245",PropWildcardSubscriptionAvailable
// 179]
TEST(Subscribe5QCTest, Encode36) {
  uint8_t pkt[] = {0x82, 0xda, 0x1,  0x6c, 0x45, 0x25, 0x26, 0x0,  0x6,  0xac, 0x37, 0xaf, 0xce, 0xd2, 0x5f, 0x0,  0x18,
                   0xa4, 0x81, 0x34, 0xb0, 0x2,  0x99, 0xd6, 0xb,  0x32, 0xc8, 0x22, 0x90, 0x69, 0xd8, 0x31, 0xec, 0xfb,
                   0x93, 0xa4, 0x6d, 0xe6, 0x97, 0x5a, 0xf5, 0x28, 0xb3, 0x0,  0x11, 0xf1, 0x6d, 0xcc, 0xc2, 0x29, 0x31,
                   0x5c, 0x86, 0x4,  0x6a, 0xfc, 0xfb, 0xb7, 0xa9, 0x6f, 0x7e, 0x2b, 0x1,  0x0,  0x3,  0xa5, 0xdf, 0x9,
                   0x1,  0x0,  0xf,  0x3,  0x29, 0xc0, 0x3,  0x45, 0xa4, 0x9e, 0xb5, 0xef, 0xd8, 0x1,  0x83, 0xab, 0xc4,
                   0xcf, 0x2,  0x0,  0xb,  0xb6, 0x62, 0x43, 0x7c, 0xf0, 0x21, 0xdb, 0x14, 0x51, 0xc8, 0xa1, 0x1,  0x0,
                   0x1d, 0xa0, 0xa2, 0x37, 0xe2, 0xc4, 0x28, 0x8d, 0x47, 0xa5, 0x8b, 0xcf, 0xf,  0xff, 0xab, 0xfb, 0x4a,
                   0x12, 0x3,  0xa8, 0x71, 0x27, 0x31, 0xf0, 0x2d, 0x5e, 0xb9, 0xc0, 0xbf, 0x5d, 0x1,  0x0,  0xb,  0x7d,
                   0x24, 0x25, 0xa8, 0x9b, 0x82, 0xb,  0x95, 0x76, 0x21, 0xa6, 0x2,  0x0,  0x1c, 0xa7, 0x6f, 0x3,  0xf3,
                   0x36, 0xd2, 0x38, 0x2,  0xc7, 0xec, 0x68, 0x81, 0x48, 0x31, 0x4d, 0x93, 0x1d, 0xf1, 0x8f, 0x53, 0xf6,
                   0x42, 0x82, 0xea, 0xa0, 0xd7, 0xdf, 0xb8, 0x2,  0x0,  0x3,  0x1a, 0x71, 0xeb, 0x0,  0x0,  0xe,  0x5d,
                   0x67, 0xb5, 0x1a, 0x50, 0xe8, 0x68, 0xac, 0x1d, 0xb4, 0xf7, 0x1e, 0xcb, 0xec, 0x1,  0x0,  0x2,  0xc9,
                   0x9e, 0x1,  0x0,  0xc,  0x43, 0xe5, 0xbd, 0xbb, 0xab, 0xb9, 0x15, 0x6a, 0x41, 0x21, 0x81, 0xfd, 0x2};

  uint8_t buf[231] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xf1, 0x6d, 0xcc, 0xc2, 0x29, 0x31, 0x5c, 0x86, 0x4,
                                     0x6a, 0xfc, 0xfb, 0xb7, 0xa9, 0x6f, 0x7e, 0x2b};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa5, 0xdf, 0x9};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x3,  0x29, 0xc0, 0x3,  0x45, 0xa4, 0x9e, 0xb5,
                                     0xef, 0xd8, 0x1,  0x83, 0xab, 0xc4, 0xcf};
  lwmqtt_string_t topic_filter_s2 = {15, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb6, 0x62, 0x43, 0x7c, 0xf0, 0x21, 0xdb, 0x14, 0x51, 0xc8, 0xa1};
  lwmqtt_string_t topic_filter_s3 = {11, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xa0, 0xa2, 0x37, 0xe2, 0xc4, 0x28, 0x8d, 0x47, 0xa5, 0x8b,
                                     0xcf, 0xf,  0xff, 0xab, 0xfb, 0x4a, 0x12, 0x3,  0xa8, 0x71,
                                     0x27, 0x31, 0xf0, 0x2d, 0x5e, 0xb9, 0xc0, 0xbf, 0x5d};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x24, 0x25, 0xa8, 0x9b, 0x82, 0xb, 0x95, 0x76, 0x21, 0xa6};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xa7, 0x6f, 0x3,  0xf3, 0x36, 0xd2, 0x38, 0x2,  0xc7, 0xec,
                                     0x68, 0x81, 0x48, 0x31, 0x4d, 0x93, 0x1d, 0xf1, 0x8f, 0x53,
                                     0xf6, 0x42, 0x82, 0xea, 0xa0, 0xd7, 0xdf, 0xb8};
  lwmqtt_string_t topic_filter_s6 = {28, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x1a, 0x71, 0xeb};
  lwmqtt_string_t topic_filter_s7 = {3, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x5d, 0x67, 0xb5, 0x1a, 0x50, 0xe8, 0x68,
                                     0xac, 0x1d, 0xb4, 0xf7, 0x1e, 0xcb, 0xec};
  lwmqtt_string_t topic_filter_s8 = {14, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xc9, 0x9e};
  lwmqtt_string_t topic_filter_s9 = {2, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x43, 0xe5, 0xbd, 0xbb, 0xab, 0xb9, 0x15, 0x6a, 0x41, 0x21, 0x81, 0xfd};
  lwmqtt_string_t topic_filter_s10 = {12, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops1[] = {0xa4, 0x81, 0x34, 0xb0, 0x2,  0x99, 0xd6, 0xb,  0x32, 0xc8, 0x22, 0x90,
                           0x69, 0xd8, 0x31, 0xec, 0xfb, 0x93, 0xa4, 0x6d, 0xe6, 0x97, 0x5a, 0xf5};
  uint8_t bytesprops0[] = {0xac, 0x37, 0xaf, 0xce, 0xd2, 0x5f};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {6, (char*)&bytesprops0}, .v = {24, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 179}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 27717, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10081 [("\254\182\236\b\134\175Afy\149p\146)\CAN\196]\172",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\140\141\202Y\140aB-\ENQx\198i\168\DEL\ESC\244\250-",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropReasonString
// "\214\243\154\153\177c\229p\198\168\n+{\251\199",PropMessageExpiryInterval 30022,PropPayloadFormatIndicator
// 179,PropWildcardSubscriptionAvailable 40,PropUserProperty ",@a\201\ACK'\244\221"
// "@\b\255\217Z\154T}\216",PropSubscriptionIdentifierAvailable 130,PropPayloadFormatIndicator
// 96,PropAssignedClientIdentifier "MR\166\195\176/xo )x\n0\251\SYN+\140\234\160}"]
TEST(Subscribe5QCTest, Encode37) {
  uint8_t pkt[] = {0x82, 0x78, 0x27, 0x61, 0x4c, 0x1f, 0x0,  0xf,  0xd6, 0xf3, 0x9a, 0x99, 0xb1, 0x63, 0xe5, 0x70,
                   0xc6, 0xa8, 0xa,  0x2b, 0x7b, 0xfb, 0xc7, 0x2,  0x0,  0x0,  0x75, 0x46, 0x1,  0xb3, 0x28, 0x28,
                   0x26, 0x0,  0x8,  0x2c, 0x40, 0x61, 0xc9, 0x6,  0x27, 0xf4, 0xdd, 0x0,  0x9,  0x40, 0x8,  0xff,
                   0xd9, 0x5a, 0x9a, 0x54, 0x7d, 0xd8, 0x29, 0x82, 0x1,  0x60, 0x12, 0x0,  0x14, 0x4d, 0x52, 0xa6,
                   0xc3, 0xb0, 0x2f, 0x78, 0x6f, 0x20, 0x29, 0x78, 0xa,  0x30, 0xfb, 0x16, 0x2b, 0x8c, 0xea, 0xa0,
                   0x7d, 0x0,  0x11, 0xfe, 0xb6, 0xec, 0x8,  0x86, 0xaf, 0x41, 0x66, 0x79, 0x95, 0x70, 0x92, 0x29,
                   0x18, 0xc4, 0x5d, 0xac, 0x0,  0x0,  0x12, 0x8c, 0x8d, 0xca, 0x59, 0x8c, 0x61, 0x42, 0x2d, 0x5,
                   0x78, 0xc6, 0x69, 0xa8, 0x7f, 0x1b, 0xf4, 0xfa, 0x2d, 0x1};

  uint8_t buf[132] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xfe, 0xb6, 0xec, 0x8,  0x86, 0xaf, 0x41, 0x66, 0x79,
                                     0x95, 0x70, 0x92, 0x29, 0x18, 0xc4, 0x5d, 0xac};
  lwmqtt_string_t topic_filter_s0 = {17, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8c, 0x8d, 0xca, 0x59, 0x8c, 0x61, 0x42, 0x2d, 0x5,
                                     0x78, 0xc6, 0x69, 0xa8, 0x7f, 0x1b, 0xf4, 0xfa, 0x2d};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xd6, 0xf3, 0x9a, 0x99, 0xb1, 0x63, 0xe5, 0x70, 0xc6, 0xa8, 0xa, 0x2b, 0x7b, 0xfb, 0xc7};
  uint8_t bytesprops2[] = {0x40, 0x8, 0xff, 0xd9, 0x5a, 0x9a, 0x54, 0x7d, 0xd8};
  uint8_t bytesprops1[] = {0x2c, 0x40, 0x61, 0xc9, 0x6, 0x27, 0xf4, 0xdd};
  uint8_t bytesprops3[] = {0x4d, 0x52, 0xa6, 0xc3, 0xb0, 0x2f, 0x78, 0x6f, 0x20, 0x29,
                           0x78, 0xa,  0x30, 0xfb, 0x16, 0x2b, 0x8c, 0xea, 0xa0, 0x7d};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {15, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30022}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 179}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 40}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {8, (char*)&bytesprops1}, .v = {9, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 130}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 96}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops3}}},
  };

  lwmqtt_properties_t props = {8, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10081, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12277 [("Qa\142\154\DC1\250'%d\167",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\251-\198\134\225\144X\220\STXN\142\199g*\SYN\128\238\209\135\238\166\183Q\232K)",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\173\&7va\196^-\248\&9\223;d\152(1\217u\154X\206\246\247\129o\211Z",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("8\207\165@\ESC\201\ri\241",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\141{KJ$\219&c3\196\b3,W\232`\131~\\\165\243\175\201\199E\240\SO6",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe5QCTest, Encode38) {
  uint8_t pkt[] = {0x82, 0x75, 0x2f, 0xf5, 0x0,  0x0,  0xa,  0x51, 0x61, 0x8e, 0x9a, 0x11, 0xfa, 0x27, 0x25, 0x64, 0xa7,
                   0x1,  0x0,  0x1a, 0xfb, 0x2d, 0xc6, 0x86, 0xe1, 0x90, 0x58, 0xdc, 0x2,  0x4e, 0x8e, 0xc7, 0x67, 0x2a,
                   0x16, 0x80, 0xee, 0xd1, 0x87, 0xee, 0xa6, 0xb7, 0x51, 0xe8, 0x4b, 0x29, 0x1,  0x0,  0x1a, 0xad, 0x37,
                   0x76, 0x61, 0xc4, 0x5e, 0x2d, 0xf8, 0x39, 0xdf, 0x3b, 0x64, 0x98, 0x28, 0x31, 0xd9, 0x75, 0x9a, 0x58,
                   0xce, 0xf6, 0xf7, 0x81, 0x6f, 0xd3, 0x5a, 0x1,  0x0,  0x9,  0x38, 0xcf, 0xa5, 0x40, 0x1b, 0xc9, 0xd,
                   0x69, 0xf1, 0x2,  0x0,  0x1c, 0x8d, 0x7b, 0x4b, 0x4a, 0x24, 0xdb, 0x26, 0x63, 0x33, 0xc4, 0x8,  0x33,
                   0x2c, 0x57, 0xe8, 0x60, 0x83, 0x7e, 0x5c, 0xa5, 0xf3, 0xaf, 0xc9, 0xc7, 0x45, 0xf0, 0xe,  0x36, 0x0};

  uint8_t buf[129] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x51, 0x61, 0x8e, 0x9a, 0x11, 0xfa, 0x27, 0x25, 0x64, 0xa7};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xfb, 0x2d, 0xc6, 0x86, 0xe1, 0x90, 0x58, 0xdc, 0x2,  0x4e, 0x8e, 0xc7, 0x67,
                                     0x2a, 0x16, 0x80, 0xee, 0xd1, 0x87, 0xee, 0xa6, 0xb7, 0x51, 0xe8, 0x4b, 0x29};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xad, 0x37, 0x76, 0x61, 0xc4, 0x5e, 0x2d, 0xf8, 0x39, 0xdf, 0x3b, 0x64, 0x98,
                                     0x28, 0x31, 0xd9, 0x75, 0x9a, 0x58, 0xce, 0xf6, 0xf7, 0x81, 0x6f, 0xd3, 0x5a};
  lwmqtt_string_t topic_filter_s2 = {26, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x38, 0xcf, 0xa5, 0x40, 0x1b, 0xc9, 0xd, 0x69, 0xf1};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8d, 0x7b, 0x4b, 0x4a, 0x24, 0xdb, 0x26, 0x63, 0x33, 0xc4,
                                     0x8,  0x33, 0x2c, 0x57, 0xe8, 0x60, 0x83, 0x7e, 0x5c, 0xa5,
                                     0xf3, 0xaf, 0xc9, 0xc7, 0x45, 0xf0, 0xe,  0x36};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12277, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 518 [("\139\STXE:n\137b\f\184\166\168\143a\150+/\136,\154\148\190k\196u\189n\n",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropSubscriptionIdentifierAvailable 150,PropReasonString
// "b\253\SO\253\138\136t\232\141\182\SI\198O",PropMessageExpiryInterval 4658,PropWildcardSubscriptionAvailable
// 197,PropResponseTopic "\247!\184Y\240\b.\142\226l\195",PropAuthenticationMethod
// "\173\154u\SOHo#&H\213\207\162\253\203\237",PropMessageExpiryInterval 31275,PropSubscriptionIdentifierAvailable
// 128,PropAssignedClientIdentifier "",PropMessageExpiryInterval 10976,PropSubscriptionIdentifierAvailable
// 167,PropResponseTopic "\ESC\242EU\158I\242\FSB\205(#u\138\216\DLE\SIQ\\\171\227ae\206\&3",PropRetainAvailable
// 215,PropPayloadFormatIndicator 160,PropTopicAliasMaximum 10006,PropMaximumQoS 198]
TEST(Subscribe5QCTest, Encode39) {
  uint8_t pkt[] = {0x82, 0x8f, 0x1,  0x2,  0x6,  0x6e, 0x29, 0x96, 0x1f, 0x0,  0xd,  0x62, 0xfd, 0xe,  0xfd, 0x8a, 0x88,
                   0x74, 0xe8, 0x8d, 0xb6, 0xf,  0xc6, 0x4f, 0x2,  0x0,  0x0,  0x12, 0x32, 0x28, 0xc5, 0x8,  0x0,  0xb,
                   0xf7, 0x21, 0xb8, 0x59, 0xf0, 0x8,  0x2e, 0x8e, 0xe2, 0x6c, 0xc3, 0x15, 0x0,  0xe,  0xad, 0x9a, 0x75,
                   0x1,  0x6f, 0x23, 0x26, 0x48, 0xd5, 0xcf, 0xa2, 0xfd, 0xcb, 0xed, 0x2,  0x0,  0x0,  0x7a, 0x2b, 0x29,
                   0x80, 0x12, 0x0,  0x0,  0x2,  0x0,  0x0,  0x2a, 0xe0, 0x29, 0xa7, 0x8,  0x0,  0x19, 0x1b, 0xf2, 0x45,
                   0x55, 0x9e, 0x49, 0xf2, 0x1c, 0x42, 0xcd, 0x28, 0x23, 0x75, 0x8a, 0xd8, 0x10, 0xf,  0x51, 0x5c, 0xab,
                   0xe3, 0x61, 0x65, 0xce, 0x33, 0x25, 0xd7, 0x1,  0xa0, 0x22, 0x27, 0x16, 0x24, 0xc6, 0x0,  0x1b, 0x8b,
                   0x2,  0x45, 0x3a, 0x6e, 0x89, 0x62, 0xc,  0xb8, 0xa6, 0xa8, 0x8f, 0x61, 0x96, 0x2b, 0x2f, 0x88, 0x2c,
                   0x9a, 0x94, 0xbe, 0x6b, 0xc4, 0x75, 0xbd, 0x6e, 0xa,  0x2};

  uint8_t buf[156] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x8b, 0x2,  0x45, 0x3a, 0x6e, 0x89, 0x62, 0xc,  0xb8, 0xa6, 0xa8, 0x8f, 0x61, 0x96,
                                     0x2b, 0x2f, 0x88, 0x2c, 0x9a, 0x94, 0xbe, 0x6b, 0xc4, 0x75, 0xbd, 0x6e, 0xa};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x62, 0xfd, 0xe, 0xfd, 0x8a, 0x88, 0x74, 0xe8, 0x8d, 0xb6, 0xf, 0xc6, 0x4f};
  uint8_t bytesprops1[] = {0xf7, 0x21, 0xb8, 0x59, 0xf0, 0x8, 0x2e, 0x8e, 0xe2, 0x6c, 0xc3};
  uint8_t bytesprops2[] = {0xad, 0x9a, 0x75, 0x1, 0x6f, 0x23, 0x26, 0x48, 0xd5, 0xcf, 0xa2, 0xfd, 0xcb, 0xed};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0x1b, 0xf2, 0x45, 0x55, 0x9e, 0x49, 0xf2, 0x1c, 0x42, 0xcd, 0x28, 0x23, 0x75,
                           0x8a, 0xd8, 0x10, 0xf,  0x51, 0x5c, 0xab, 0xe3, 0x61, 0x65, 0xce, 0x33};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 150}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {13, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4658}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 197}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {11, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31275}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 128}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10976}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 167}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 215}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 160}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 10006}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 198}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 518, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 20513 [("\246\249y9",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\174\158\&9I\236",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\234)\247\155]i\178i\160:\ENQ\162\186\204\194v^KTS.P\233&\189",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropMessageExpiryInterval
// 4904,PropRequestProblemInformation 22,PropMessageExpiryInterval 8007,PropMaximumQoS
// 78,PropWildcardSubscriptionAvailable 176,PropTopicAlias 11429,PropResponseTopic
// "V\180\210\236\&4\253U\210C\179\244bq",PropSharedSubscriptionAvailable 151,PropSharedSubscriptionAvailable
// 145,PropContentType "\167\237$\a\200\203\156\180\138\250\a\237@",PropServerKeepAlive 20621,PropCorrelationData
// "\129*~\205L\n\192_Q\207\167N8~\132rB\140\140z|+\223\128\238\218",PropSubscriptionIdentifier 3,PropTopicAliasMaximum
// 14322,PropResponseInformation "/?!\CAN-?w\249\223\207",PropRetainAvailable 126,PropMessageExpiryInterval
// 25279,PropMessageExpiryInterval 2138,PropRetainAvailable 215,PropServerReference
// "q,\210\STX\151b\139A",PropResponseTopic "$\177\175\161",PropServerKeepAlive 31943,PropSharedSubscriptionAvailable
// 237,PropPayloadFormatIndicator 39,PropSubscriptionIdentifierAvailable 194,PropResponseTopic
// "\169a\243Y",PropCorrelationData "\206S\135R\226:\157\245\247~\218\159\203\136",PropTopicAliasMaximum
// 6865,PropSubscriptionIdentifierAvailable 165]
TEST(Subscribe5QCTest, Encode40) {
  uint8_t pkt[] = {
      0x82, 0xde, 0x1,  0x50, 0x21, 0xaf, 0x1,  0x2,  0x0,  0x0,  0x13, 0x28, 0x17, 0x16, 0x2,  0x0,  0x0,  0x1f, 0x47,
      0x24, 0x4e, 0x28, 0xb0, 0x23, 0x2c, 0xa5, 0x8,  0x0,  0xd,  0x56, 0xb4, 0xd2, 0xec, 0x34, 0xfd, 0x55, 0xd2, 0x43,
      0xb3, 0xf4, 0x62, 0x71, 0x2a, 0x97, 0x2a, 0x91, 0x3,  0x0,  0xd,  0xa7, 0xed, 0x24, 0x7,  0xc8, 0xcb, 0x9c, 0xb4,
      0x8a, 0xfa, 0x7,  0xed, 0x40, 0x13, 0x50, 0x8d, 0x9,  0x0,  0x1a, 0x81, 0x2a, 0x7e, 0xcd, 0x4c, 0xa,  0xc0, 0x5f,
      0x51, 0xcf, 0xa7, 0x4e, 0x38, 0x7e, 0x84, 0x72, 0x42, 0x8c, 0x8c, 0x7a, 0x7c, 0x2b, 0xdf, 0x80, 0xee, 0xda, 0xb,
      0x3,  0x22, 0x37, 0xf2, 0x1a, 0x0,  0xa,  0x2f, 0x3f, 0x21, 0x18, 0x2d, 0x3f, 0x77, 0xf9, 0xdf, 0xcf, 0x25, 0x7e,
      0x2,  0x0,  0x0,  0x62, 0xbf, 0x2,  0x0,  0x0,  0x8,  0x5a, 0x25, 0xd7, 0x1c, 0x0,  0x8,  0x71, 0x2c, 0xd2, 0x2,
      0x97, 0x62, 0x8b, 0x41, 0x8,  0x0,  0x4,  0x24, 0xb1, 0xaf, 0xa1, 0x13, 0x7c, 0xc7, 0x2a, 0xed, 0x1,  0x27, 0x29,
      0xc2, 0x8,  0x0,  0x4,  0xa9, 0x61, 0xf3, 0x59, 0x9,  0x0,  0xe,  0xce, 0x53, 0x87, 0x52, 0xe2, 0x3a, 0x9d, 0xf5,
      0xf7, 0x7e, 0xda, 0x9f, 0xcb, 0x88, 0x22, 0x1a, 0xd1, 0x29, 0xa5, 0x0,  0x4,  0xf6, 0xf9, 0x79, 0x39, 0x0,  0x0,
      0x5,  0xae, 0x9e, 0x39, 0x49, 0xec, 0x1,  0x0,  0x19, 0xea, 0x29, 0xf7, 0x9b, 0x5d, 0x69, 0xb2, 0x69, 0xa0, 0x3a,
      0x5,  0xa2, 0xba, 0xcc, 0xc2, 0x76, 0x5e, 0x4b, 0x54, 0x53, 0x2e, 0x50, 0xe9, 0x26, 0xbd, 0x1};

  uint8_t buf[235] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0xf6, 0xf9, 0x79, 0x39};
  lwmqtt_string_t topic_filter_s0 = {4, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xae, 0x9e, 0x39, 0x49, 0xec};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xea, 0x29, 0xf7, 0x9b, 0x5d, 0x69, 0xb2, 0x69, 0xa0, 0x3a, 0x5,  0xa2, 0xba,
                                     0xcc, 0xc2, 0x76, 0x5e, 0x4b, 0x54, 0x53, 0x2e, 0x50, 0xe9, 0x26, 0xbd};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x56, 0xb4, 0xd2, 0xec, 0x34, 0xfd, 0x55, 0xd2, 0x43, 0xb3, 0xf4, 0x62, 0x71};
  uint8_t bytesprops1[] = {0xa7, 0xed, 0x24, 0x7, 0xc8, 0xcb, 0x9c, 0xb4, 0x8a, 0xfa, 0x7, 0xed, 0x40};
  uint8_t bytesprops2[] = {0x81, 0x2a, 0x7e, 0xcd, 0x4c, 0xa,  0xc0, 0x5f, 0x51, 0xcf, 0xa7, 0x4e, 0x38,
                           0x7e, 0x84, 0x72, 0x42, 0x8c, 0x8c, 0x7a, 0x7c, 0x2b, 0xdf, 0x80, 0xee, 0xda};
  uint8_t bytesprops3[] = {0x2f, 0x3f, 0x21, 0x18, 0x2d, 0x3f, 0x77, 0xf9, 0xdf, 0xcf};
  uint8_t bytesprops4[] = {0x71, 0x2c, 0xd2, 0x2, 0x97, 0x62, 0x8b, 0x41};
  uint8_t bytesprops5[] = {0x24, 0xb1, 0xaf, 0xa1};
  uint8_t bytesprops6[] = {0xa9, 0x61, 0xf3, 0x59};
  uint8_t bytesprops7[] = {0xce, 0x53, 0x87, 0x52, 0xe2, 0x3a, 0x9d, 0xf5, 0xf7, 0x7e, 0xda, 0x9f, 0xcb, 0x88};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4904}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 22}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8007}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 176}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11429}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {13, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 151}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 145}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {13, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20621}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 3}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 14322}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 126}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25279}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2138}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 215}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {8, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 31943}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 237}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 39}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 194}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {4, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 6865}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 165}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 20513, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13179 [("YR\212\171\209\EOTx\164\209\197\US\155",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\235",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\172\250G",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\r\149\246#m\237\132i\162%c\ESC\144\159F`\229\254\ENQG",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("}O6\STX\EM\250D>\167\STX",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\140\134n",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2})] [PropResponseTopic
// "<\185t\174\203e\SUBL\235\232\154\CAN_\199\217\164\&4R\161\ACK\239\v\211",PropTopicAlias 2853,PropServerKeepAlive
// 20997,PropResponseTopic ";\213",PropMaximumQoS 53,PropWillDelayInterval 19196,PropCorrelationData
// "\188\134\175\158\211}Z\208\157\137\SYN\130\US",PropPayloadFormatIndicator 46,PropAuthenticationData
// "\154\251",PropUserProperty "\243:\176T\161*\195\213\SOH" "\159",PropSubscriptionIdentifier 17,PropTopicAliasMaximum
// 19238,PropServerReference "",PropMessageExpiryInterval 20733,PropSubscriptionIdentifierAvailable 57,PropResponseTopic
// "\206\v\206_\179\190t",PropResponseInformation "l\219\230\175\255\171",PropServerKeepAlive 16101,PropTopicAlias
// 5826,PropSharedSubscriptionAvailable 113,PropRequestProblemInformation 166,PropReceiveMaximum 6526,PropTopicAlias
// 21054,PropSessionExpiryInterval 21021,PropSubscriptionIdentifierAvailable 245,PropMessageExpiryInterval
// 26743,PropReasonString "f\"w]\\\v\b\237U\227\144\r\216\137.kl\130X/\DC16+\ESC{\ETBD]X",PropSessionExpiryInterval
// 9739,PropSubscriptionIdentifier 3,PropTopicAlias 22499]
TEST(Subscribe5QCTest, Encode41) {
  uint8_t pkt[] = {
      0x82, 0x84, 0x2,  0x33, 0x7b, 0xba, 0x1,  0x8,  0x0,  0x17, 0x3c, 0xb9, 0x74, 0xae, 0xcb, 0x65, 0x1a, 0x4c, 0xeb,
      0xe8, 0x9a, 0x18, 0x5f, 0xc7, 0xd9, 0xa4, 0x34, 0x52, 0xa1, 0x6,  0xef, 0xb,  0xd3, 0x23, 0xb,  0x25, 0x13, 0x52,
      0x5,  0x8,  0x0,  0x2,  0x3b, 0xd5, 0x24, 0x35, 0x18, 0x0,  0x0,  0x4a, 0xfc, 0x9,  0x0,  0xd,  0xbc, 0x86, 0xaf,
      0x9e, 0xd3, 0x7d, 0x5a, 0xd0, 0x9d, 0x89, 0x16, 0x82, 0x1f, 0x1,  0x2e, 0x16, 0x0,  0x2,  0x9a, 0xfb, 0x26, 0x0,
      0x9,  0xf3, 0x3a, 0xb0, 0x54, 0xa1, 0x2a, 0xc3, 0xd5, 0x1,  0x0,  0x1,  0x9f, 0xb,  0x11, 0x22, 0x4b, 0x26, 0x1c,
      0x0,  0x0,  0x2,  0x0,  0x0,  0x50, 0xfd, 0x29, 0x39, 0x8,  0x0,  0x7,  0xce, 0xb,  0xce, 0x5f, 0xb3, 0xbe, 0x74,
      0x1a, 0x0,  0x6,  0x6c, 0xdb, 0xe6, 0xaf, 0xff, 0xab, 0x13, 0x3e, 0xe5, 0x23, 0x16, 0xc2, 0x2a, 0x71, 0x17, 0xa6,
      0x21, 0x19, 0x7e, 0x23, 0x52, 0x3e, 0x11, 0x0,  0x0,  0x52, 0x1d, 0x29, 0xf5, 0x2,  0x0,  0x0,  0x68, 0x77, 0x1f,
      0x0,  0x1d, 0x66, 0x22, 0x77, 0x5d, 0x5c, 0xb,  0x8,  0xed, 0x55, 0xe3, 0x90, 0xd,  0xd8, 0x89, 0x2e, 0x6b, 0x6c,
      0x82, 0x58, 0x2f, 0x11, 0x36, 0x2b, 0x1b, 0x7b, 0x17, 0x44, 0x5d, 0x58, 0x11, 0x0,  0x0,  0x26, 0xb,  0xb,  0x3,
      0x23, 0x57, 0xe3, 0x0,  0xc,  0x59, 0x52, 0xd4, 0xab, 0xd1, 0x4,  0x78, 0xa4, 0xd1, 0xc5, 0x1f, 0x9b, 0x1,  0x0,
      0x1,  0xeb, 0x1,  0x0,  0x3,  0xac, 0xfa, 0x47, 0x2,  0x0,  0x0,  0x2,  0x0,  0x14, 0xd,  0x95, 0xf6, 0x23, 0x6d,
      0xed, 0x84, 0x69, 0xa2, 0x25, 0x63, 0x1b, 0x90, 0x9f, 0x46, 0x60, 0xe5, 0xfe, 0x5,  0x47, 0x1,  0x0,  0xa,  0x7d,
      0x4f, 0x36, 0x2,  0x19, 0xfa, 0x44, 0x3e, 0xa7, 0x2,  0x0,  0x0,  0x3,  0x8c, 0x86, 0x6e, 0x2};

  uint8_t buf[273] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x59, 0x52, 0xd4, 0xab, 0xd1, 0x4, 0x78, 0xa4, 0xd1, 0xc5, 0x1f, 0x9b};
  lwmqtt_string_t topic_filter_s0 = {12, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xeb};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xac, 0xfa, 0x47};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0};
  lwmqtt_string_t topic_filter_s3 = {0, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd,  0x95, 0xf6, 0x23, 0x6d, 0xed, 0x84, 0x69, 0xa2, 0x25,
                                     0x63, 0x1b, 0x90, 0x9f, 0x46, 0x60, 0xe5, 0xfe, 0x5,  0x47};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x4f, 0x36, 0x2, 0x19, 0xfa, 0x44, 0x3e, 0xa7, 0x2};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8c, 0x86, 0x6e};
  lwmqtt_string_t topic_filter_s6 = {3, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x3c, 0xb9, 0x74, 0xae, 0xcb, 0x65, 0x1a, 0x4c, 0xeb, 0xe8, 0x9a, 0x18,
                           0x5f, 0xc7, 0xd9, 0xa4, 0x34, 0x52, 0xa1, 0x6,  0xef, 0xb,  0xd3};
  uint8_t bytesprops1[] = {0x3b, 0xd5};
  uint8_t bytesprops2[] = {0xbc, 0x86, 0xaf, 0x9e, 0xd3, 0x7d, 0x5a, 0xd0, 0x9d, 0x89, 0x16, 0x82, 0x1f};
  uint8_t bytesprops3[] = {0x9a, 0xfb};
  uint8_t bytesprops5[] = {0x9f};
  uint8_t bytesprops4[] = {0xf3, 0x3a, 0xb0, 0x54, 0xa1, 0x2a, 0xc3, 0xd5, 0x1};
  uint8_t bytesprops6[] = {0};
  uint8_t bytesprops7[] = {0xce, 0xb, 0xce, 0x5f, 0xb3, 0xbe, 0x74};
  uint8_t bytesprops8[] = {0x6c, 0xdb, 0xe6, 0xaf, 0xff, 0xab};
  uint8_t bytesprops9[] = {0x66, 0x22, 0x77, 0x5d, 0x5c, 0xb,  0x8,  0xed, 0x55, 0xe3, 0x90, 0xd,  0xd8, 0x89, 0x2e,
                           0x6b, 0x6c, 0x82, 0x58, 0x2f, 0x11, 0x36, 0x2b, 0x1b, 0x7b, 0x17, 0x44, 0x5d, 0x58};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {23, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 2853}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20997}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 53}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 19196}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {13, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 46}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {2, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {9, (char*)&bytesprops4}, .v = {1, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 17}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19238}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 20733}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 57}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {7, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 16101}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 5826}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 113}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 166}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 6526}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21054}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21021}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 245}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 26743}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9739}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 3}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 22499}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 13179, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2708 [("\128\SUB\143\242\FS\143\181\142tg\159H\SI\193<",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\STX\194;\241\194\228a\t\191u0o\203O|\SUBV\174x\171\235\159\149\&6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("4\173\128\155%\a\234\DLE\166\&1\188\EOT@\142qQuA\154N",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\169p4\162\139:?",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\130)\226\134",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropReasonString
// "J=\154\157t\176\185\252\239`r~j=",PropServerReference "\207\220\145R",PropServerKeepAlive 4925,PropContentType
// "\170\212\219I_\147\151uT\216~\248\200\240u\rU\DLE\148P\252'\180\207\RS\177",PropTopicAlias
// 1012,PropSharedSubscriptionAvailable 102,PropMessageExpiryInterval 4429,PropReasonString
// "\SOH\NUL\DC2\156\138\243\242i\182",PropContentType
// "\217\229\179\184v(\170\228\197\128\EM\184",PropSessionExpiryInterval 751,PropMessageExpiryInterval
// 2764,PropPayloadFormatIndicator 141,PropUserProperty "aef\RS\177"
// "\227\151\225\SOH~i\DC1ri\252\151\131\192\a\250\220\182`\174",PropTopicAliasMaximum 23948,PropMaximumPacketSize
// 15730]
TEST(Subscribe5QCTest, Encode42) {
  uint8_t pkt[] = {0x82, 0xe7, 0x1,  0xa,  0x94, 0x8e, 0x1,  0x1f, 0x0,  0xe,  0x4a, 0x3d, 0x9a, 0x9d, 0x74, 0xb0, 0xb9,
                   0xfc, 0xef, 0x60, 0x72, 0x7e, 0x6a, 0x3d, 0x1c, 0x0,  0x4,  0xcf, 0xdc, 0x91, 0x52, 0x13, 0x13, 0x3d,
                   0x3,  0x0,  0x1a, 0xaa, 0xd4, 0xdb, 0x49, 0x5f, 0x93, 0x97, 0x75, 0x54, 0xd8, 0x7e, 0xf8, 0xc8, 0xf0,
                   0x75, 0xd,  0x55, 0x10, 0x94, 0x50, 0xfc, 0x27, 0xb4, 0xcf, 0x1e, 0xb1, 0x23, 0x3,  0xf4, 0x2a, 0x66,
                   0x2,  0x0,  0x0,  0x11, 0x4d, 0x1f, 0x0,  0x9,  0x1,  0x0,  0x12, 0x9c, 0x8a, 0xf3, 0xf2, 0x69, 0xb6,
                   0x3,  0x0,  0xc,  0xd9, 0xe5, 0xb3, 0xb8, 0x76, 0x28, 0xaa, 0xe4, 0xc5, 0x80, 0x19, 0xb8, 0x11, 0x0,
                   0x0,  0x2,  0xef, 0x2,  0x0,  0x0,  0xa,  0xcc, 0x1,  0x8d, 0x26, 0x0,  0x5,  0x61, 0x65, 0x66, 0x1e,
                   0xb1, 0x0,  0x13, 0xe3, 0x97, 0xe1, 0x1,  0x7e, 0x69, 0x11, 0x72, 0x69, 0xfc, 0x97, 0x83, 0xc0, 0x7,
                   0xfa, 0xdc, 0xb6, 0x60, 0xae, 0x22, 0x5d, 0x8c, 0x27, 0x0,  0x0,  0x3d, 0x72, 0x0,  0xf,  0x80, 0x1a,
                   0x8f, 0xf2, 0x1c, 0x8f, 0xb5, 0x8e, 0x74, 0x67, 0x9f, 0x48, 0xf,  0xc1, 0x3c, 0x1,  0x0,  0x18, 0x2,
                   0xc2, 0x3b, 0xf1, 0xc2, 0xe4, 0x61, 0x9,  0xbf, 0x75, 0x30, 0x6f, 0xcb, 0x4f, 0x7c, 0x1a, 0x56, 0xae,
                   0x78, 0xab, 0xeb, 0x9f, 0x95, 0x36, 0x2,  0x0,  0x14, 0x34, 0xad, 0x80, 0x9b, 0x25, 0x7,  0xea, 0x10,
                   0xa6, 0x31, 0xbc, 0x4,  0x40, 0x8e, 0x71, 0x51, 0x75, 0x41, 0x9a, 0x4e, 0x1,  0x0,  0x7,  0xa9, 0x70,
                   0x34, 0xa2, 0x8b, 0x3a, 0x3f, 0x1,  0x0,  0x4,  0x82, 0x29, 0xe2, 0x86, 0x0};

  uint8_t buf[244] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x80, 0x1a, 0x8f, 0xf2, 0x1c, 0x8f, 0xb5, 0x8e,
                                     0x74, 0x67, 0x9f, 0x48, 0xf,  0xc1, 0x3c};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x2,  0xc2, 0x3b, 0xf1, 0xc2, 0xe4, 0x61, 0x9,  0xbf, 0x75, 0x30, 0x6f,
                                     0xcb, 0x4f, 0x7c, 0x1a, 0x56, 0xae, 0x78, 0xab, 0xeb, 0x9f, 0x95, 0x36};
  lwmqtt_string_t topic_filter_s1 = {24, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x34, 0xad, 0x80, 0x9b, 0x25, 0x7,  0xea, 0x10, 0xa6, 0x31,
                                     0xbc, 0x4,  0x40, 0x8e, 0x71, 0x51, 0x75, 0x41, 0x9a, 0x4e};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa9, 0x70, 0x34, 0xa2, 0x8b, 0x3a, 0x3f};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x82, 0x29, 0xe2, 0x86};
  lwmqtt_string_t topic_filter_s4 = {4, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x4a, 0x3d, 0x9a, 0x9d, 0x74, 0xb0, 0xb9, 0xfc, 0xef, 0x60, 0x72, 0x7e, 0x6a, 0x3d};
  uint8_t bytesprops1[] = {0xcf, 0xdc, 0x91, 0x52};
  uint8_t bytesprops2[] = {0xaa, 0xd4, 0xdb, 0x49, 0x5f, 0x93, 0x97, 0x75, 0x54, 0xd8, 0x7e, 0xf8, 0xc8,
                           0xf0, 0x75, 0xd,  0x55, 0x10, 0x94, 0x50, 0xfc, 0x27, 0xb4, 0xcf, 0x1e, 0xb1};
  uint8_t bytesprops3[] = {0x1, 0x0, 0x12, 0x9c, 0x8a, 0xf3, 0xf2, 0x69, 0xb6};
  uint8_t bytesprops4[] = {0xd9, 0xe5, 0xb3, 0xb8, 0x76, 0x28, 0xaa, 0xe4, 0xc5, 0x80, 0x19, 0xb8};
  uint8_t bytesprops6[] = {0xe3, 0x97, 0xe1, 0x1, 0x7e, 0x69, 0x11, 0x72, 0x69, 0xfc,
                           0x97, 0x83, 0xc0, 0x7, 0xfa, 0xdc, 0xb6, 0x60, 0xae};
  uint8_t bytesprops5[] = {0x61, 0x65, 0x66, 0x1e, 0xb1};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 4925}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 1012}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 102}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4429}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {9, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {12, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 751}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2764}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 141}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {5, (char*)&bytesprops5}, .v = {19, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 23948}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 15730}},
  };

  lwmqtt_properties_t props = {15, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2708, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22393 [("4\151\147%\225\205\145\214",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\170\240\162w`E\254\232
// \143\DC2x\209h3\148\197\DEL\195~\165h\DLE\232\201Bm",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\248\158\234\227[R.\240VV'\227@\DC3)\DLE\242\199\US\199\221H\199",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationData
// "",PropContentType "\206o\195\135\253\250\246\193\205\200\172\238|VO\rv\158\&4",PropServerKeepAlive
// 16840,PropSharedSubscriptionAvailable 14,PropResponseInformation
// ":E-\170:\ESC\232\GS\196A\166\168\238\182\220",PropAuthenticationMethod "b\STX4#\201",PropServerReference
// "\205\208\156\255a5A0\144<_\148\SIs\SI\152\130\137'\203",PropTopicAlias 19282,PropRequestResponseInformation
// 145,PropAssignedClientIdentifier
// "\161\193;\174\250\190\142Z\209Q\157\DC1'\210o\252\161g\a\132\141|\176p\FSh\173\186#D",PropCorrelationData
// "\147{\164A$\149\204ln\162]\220\162\&9NY",PropAssignedClientIdentifier "4\215\137cz\DC16&]",PropContentType
// "[`\147=\ETB\185\136\221\252\200\US\DC2\f\236\&9\198\205rkz\SI\171\&9\164\EM\227",PropUserProperty
// "\DC1\144\DLE\EMV|h\226\230u\205\194B\236\ETB/\220&\US\216s\EM\EOT4\177\a\178\175S\a"
// "\255\197\253\226\";\213\241S\225\194Y\169\SI1\133\180\140\240$Yo",PropAuthenticationData
// "*\130\DC3\239\&6\SI\206\252\156\223\\oS\NUL\216\164\NUL,\SOH\a",PropMaximumPacketSize 1890,PropUserProperty
// "\131\252\204\242\138\241\154\145\184\216\142\&9\187F\NAKU/\148a\179\205\DC3"
// "gQ\206\227\230\216\240\b\DEL|\144\135`\197\217Vx=\234\178i\244",PropRequestResponseInformation 81,PropUserProperty
// "\240{G" "",PropMaximumPacketSize 2959,PropWillDelayInterval 10548,PropReceiveMaximum
// 30850,PropSubscriptionIdentifierAvailable 177,PropMaximumQoS 0,PropWillDelayInterval 17382,PropCorrelationData
// "k'\188)\161\143",PropPayloadFormatIndicator 3,PropTopicAlias 7431,PropMaximumQoS 180]
TEST(Subscribe5QCTest, Encode43) {
  uint8_t pkt[] = {
      0x82, 0xae, 0x3,  0x57, 0x79, 0xe7, 0x2,  0x16, 0x0,  0x0,  0x3,  0x0,  0x13, 0xce, 0x6f, 0xc3, 0x87, 0xfd, 0xfa,
      0xf6, 0xc1, 0xcd, 0xc8, 0xac, 0xee, 0x7c, 0x56, 0x4f, 0xd,  0x76, 0x9e, 0x34, 0x13, 0x41, 0xc8, 0x2a, 0xe,  0x1a,
      0x0,  0xf,  0x3a, 0x45, 0x2d, 0xaa, 0x3a, 0x1b, 0xe8, 0x1d, 0xc4, 0x41, 0xa6, 0xa8, 0xee, 0xb6, 0xdc, 0x15, 0x0,
      0x5,  0x62, 0x2,  0x34, 0x23, 0xc9, 0x1c, 0x0,  0x14, 0xcd, 0xd0, 0x9c, 0xff, 0x61, 0x35, 0x41, 0x30, 0x90, 0x3c,
      0x5f, 0x94, 0xf,  0x73, 0xf,  0x98, 0x82, 0x89, 0x27, 0xcb, 0x23, 0x4b, 0x52, 0x19, 0x91, 0x12, 0x0,  0x1e, 0xa1,
      0xc1, 0x3b, 0xae, 0xfa, 0xbe, 0x8e, 0x5a, 0xd1, 0x51, 0x9d, 0x11, 0x27, 0xd2, 0x6f, 0xfc, 0xa1, 0x67, 0x7,  0x84,
      0x8d, 0x7c, 0xb0, 0x70, 0x1c, 0x68, 0xad, 0xba, 0x23, 0x44, 0x9,  0x0,  0x10, 0x93, 0x7b, 0xa4, 0x41, 0x24, 0x95,
      0xcc, 0x6c, 0x6e, 0xa2, 0x5d, 0xdc, 0xa2, 0x39, 0x4e, 0x59, 0x12, 0x0,  0x9,  0x34, 0xd7, 0x89, 0x63, 0x7a, 0x11,
      0x36, 0x26, 0x5d, 0x3,  0x0,  0x1a, 0x5b, 0x60, 0x93, 0x3d, 0x17, 0xb9, 0x88, 0xdd, 0xfc, 0xc8, 0x1f, 0x12, 0xc,
      0xec, 0x39, 0xc6, 0xcd, 0x72, 0x6b, 0x7a, 0xf,  0xab, 0x39, 0xa4, 0x19, 0xe3, 0x26, 0x0,  0x1e, 0x11, 0x90, 0x10,
      0x19, 0x56, 0x7c, 0x68, 0xe2, 0xe6, 0x75, 0xcd, 0xc2, 0x42, 0xec, 0x17, 0x2f, 0xdc, 0x26, 0x1f, 0xd8, 0x73, 0x19,
      0x4,  0x34, 0xb1, 0x7,  0xb2, 0xaf, 0x53, 0x7,  0x0,  0x16, 0xff, 0xc5, 0xfd, 0xe2, 0x22, 0x3b, 0xd5, 0xf1, 0x53,
      0xe1, 0xc2, 0x59, 0xa9, 0xf,  0x31, 0x85, 0xb4, 0x8c, 0xf0, 0x24, 0x59, 0x6f, 0x16, 0x0,  0x14, 0x2a, 0x82, 0x13,
      0xef, 0x36, 0xf,  0xce, 0xfc, 0x9c, 0xdf, 0x5c, 0x6f, 0x53, 0x0,  0xd8, 0xa4, 0x0,  0x2c, 0x1,  0x7,  0x27, 0x0,
      0x0,  0x7,  0x62, 0x26, 0x0,  0x16, 0x83, 0xfc, 0xcc, 0xf2, 0x8a, 0xf1, 0x9a, 0x91, 0xb8, 0xd8, 0x8e, 0x39, 0xbb,
      0x46, 0x15, 0x55, 0x2f, 0x94, 0x61, 0xb3, 0xcd, 0x13, 0x0,  0x16, 0x67, 0x51, 0xce, 0xe3, 0xe6, 0xd8, 0xf0, 0x8,
      0x7f, 0x7c, 0x90, 0x87, 0x60, 0xc5, 0xd9, 0x56, 0x78, 0x3d, 0xea, 0xb2, 0x69, 0xf4, 0x19, 0x51, 0x26, 0x0,  0x3,
      0xf0, 0x7b, 0x47, 0x0,  0x0,  0x27, 0x0,  0x0,  0xb,  0x8f, 0x18, 0x0,  0x0,  0x29, 0x34, 0x21, 0x78, 0x82, 0x29,
      0xb1, 0x24, 0x0,  0x18, 0x0,  0x0,  0x43, 0xe6, 0x9,  0x0,  0x6,  0x6b, 0x27, 0xbc, 0x29, 0xa1, 0x8f, 0x1,  0x3,
      0x23, 0x1d, 0x7,  0x24, 0xb4, 0x0,  0x8,  0x34, 0x97, 0x93, 0x25, 0xe1, 0xcd, 0x91, 0xd6, 0x2,  0x0,  0x1b, 0xaa,
      0xf0, 0xa2, 0x77, 0x60, 0x45, 0xfe, 0xe8, 0x20, 0x8f, 0x12, 0x78, 0xd1, 0x68, 0x33, 0x94, 0xc5, 0x7f, 0xc3, 0x7e,
      0xa5, 0x68, 0x10, 0xe8, 0xc9, 0x42, 0x6d, 0x2,  0x0,  0x17, 0xf8, 0x9e, 0xea, 0xe3, 0x5b, 0x52, 0x2e, 0xf0, 0x56,
      0x56, 0x27, 0xe3, 0x40, 0x13, 0x29, 0x10, 0xf2, 0xc7, 0x1f, 0xc7, 0xdd, 0x48, 0xc7, 0x0};

  uint8_t buf[443] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x34, 0x97, 0x93, 0x25, 0xe1, 0xcd, 0x91, 0xd6};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xaa, 0xf0, 0xa2, 0x77, 0x60, 0x45, 0xfe, 0xe8, 0x20, 0x8f, 0x12, 0x78, 0xd1, 0x68,
                                     0x33, 0x94, 0xc5, 0x7f, 0xc3, 0x7e, 0xa5, 0x68, 0x10, 0xe8, 0xc9, 0x42, 0x6d};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf8, 0x9e, 0xea, 0xe3, 0x5b, 0x52, 0x2e, 0xf0, 0x56, 0x56, 0x27, 0xe3,
                                     0x40, 0x13, 0x29, 0x10, 0xf2, 0xc7, 0x1f, 0xc7, 0xdd, 0x48, 0xc7};
  lwmqtt_string_t topic_filter_s2 = {23, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0xce, 0x6f, 0xc3, 0x87, 0xfd, 0xfa, 0xf6, 0xc1, 0xcd, 0xc8,
                           0xac, 0xee, 0x7c, 0x56, 0x4f, 0xd,  0x76, 0x9e, 0x34};
  uint8_t bytesprops2[] = {0x3a, 0x45, 0x2d, 0xaa, 0x3a, 0x1b, 0xe8, 0x1d, 0xc4, 0x41, 0xa6, 0xa8, 0xee, 0xb6, 0xdc};
  uint8_t bytesprops3[] = {0x62, 0x2, 0x34, 0x23, 0xc9};
  uint8_t bytesprops4[] = {0xcd, 0xd0, 0x9c, 0xff, 0x61, 0x35, 0x41, 0x30, 0x90, 0x3c,
                           0x5f, 0x94, 0xf,  0x73, 0xf,  0x98, 0x82, 0x89, 0x27, 0xcb};
  uint8_t bytesprops5[] = {0xa1, 0xc1, 0x3b, 0xae, 0xfa, 0xbe, 0x8e, 0x5a, 0xd1, 0x51, 0x9d, 0x11, 0x27, 0xd2, 0x6f,
                           0xfc, 0xa1, 0x67, 0x7,  0x84, 0x8d, 0x7c, 0xb0, 0x70, 0x1c, 0x68, 0xad, 0xba, 0x23, 0x44};
  uint8_t bytesprops6[] = {0x93, 0x7b, 0xa4, 0x41, 0x24, 0x95, 0xcc, 0x6c,
                           0x6e, 0xa2, 0x5d, 0xdc, 0xa2, 0x39, 0x4e, 0x59};
  uint8_t bytesprops7[] = {0x34, 0xd7, 0x89, 0x63, 0x7a, 0x11, 0x36, 0x26, 0x5d};
  uint8_t bytesprops8[] = {0x5b, 0x60, 0x93, 0x3d, 0x17, 0xb9, 0x88, 0xdd, 0xfc, 0xc8, 0x1f, 0x12, 0xc,
                           0xec, 0x39, 0xc6, 0xcd, 0x72, 0x6b, 0x7a, 0xf,  0xab, 0x39, 0xa4, 0x19, 0xe3};
  uint8_t bytesprops10[] = {0xff, 0xc5, 0xfd, 0xe2, 0x22, 0x3b, 0xd5, 0xf1, 0x53, 0xe1, 0xc2,
                            0x59, 0xa9, 0xf,  0x31, 0x85, 0xb4, 0x8c, 0xf0, 0x24, 0x59, 0x6f};
  uint8_t bytesprops9[] = {0x11, 0x90, 0x10, 0x19, 0x56, 0x7c, 0x68, 0xe2, 0xe6, 0x75, 0xcd, 0xc2, 0x42, 0xec, 0x17,
                           0x2f, 0xdc, 0x26, 0x1f, 0xd8, 0x73, 0x19, 0x4,  0x34, 0xb1, 0x7,  0xb2, 0xaf, 0x53, 0x7};
  uint8_t bytesprops11[] = {0x2a, 0x82, 0x13, 0xef, 0x36, 0xf,  0xce, 0xfc, 0x9c, 0xdf,
                            0x5c, 0x6f, 0x53, 0x0,  0xd8, 0xa4, 0x0,  0x2c, 0x1,  0x7};
  uint8_t bytesprops13[] = {0x67, 0x51, 0xce, 0xe3, 0xe6, 0xd8, 0xf0, 0x8,  0x7f, 0x7c, 0x90,
                            0x87, 0x60, 0xc5, 0xd9, 0x56, 0x78, 0x3d, 0xea, 0xb2, 0x69, 0xf4};
  uint8_t bytesprops12[] = {0x83, 0xfc, 0xcc, 0xf2, 0x8a, 0xf1, 0x9a, 0x91, 0xb8, 0xd8, 0x8e,
                            0x39, 0xbb, 0x46, 0x15, 0x55, 0x2f, 0x94, 0x61, 0xb3, 0xcd, 0x13};
  uint8_t bytesprops15[] = {0};
  uint8_t bytesprops14[] = {0xf0, 0x7b, 0x47};
  uint8_t bytesprops16[] = {0x6b, 0x27, 0xbc, 0x29, 0xa1, 0x8f};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {19, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 16840}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 14}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {15, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {5, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {20, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 19282}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 145}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {30, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {9, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {26, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {30, (char*)&bytesprops9}, .v = {22, (char*)&bytesprops10}}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1890}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {22, (char*)&bytesprops12}, .v = {22, (char*)&bytesprops13}}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 81}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {3, (char*)&bytesprops14}, .v = {0, (char*)&bytesprops15}}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2959}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 10548}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 30850}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 177}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 0}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 17382}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops16}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 3}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 7431}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 180}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 22393, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16009 [("\v\252$!\153S\184\231\225\247\182w\185\196\179\251-)D\130W\129\222\SYNQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("Bn\211\153\\\EOT\238\190\196\180C1\146B\199\236h\DC1\210\&9,\147I",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\EOT;7\159\130c%\243\CAN\148\213\v\247'",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\220\225\t\132\131\223\183",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropTopicAliasMaximum
// 20116,PropWildcardSubscriptionAvailable 84,PropWildcardSubscriptionAvailable 215,PropRetainAvailable
// 70,PropResponseTopic "\"?~\SI\178\156\215b\173`\235\DC2\243\ACK\165Q\157",PropRetainAvailable
// 7,PropRequestResponseInformation 91,PropReceiveMaximum 2391,PropTopicAliasMaximum
// 28497,PropSharedSubscriptionAvailable 22,PropRequestResponseInformation 239,PropAuthenticationData
// "A(\159\209\179$o\137>",PropReasonString "\202P
// \219\129\206D\\\214\165\237\195\SOH\209,\244\215t\DELg^\SOH\167\135",PropAuthenticationData
// "#\253T\223(8\215o\244cA\162\252\EM\DC2\160P\148\r>1\215\136\164!",PropTopicAlias 15751]
TEST(Subscribe5QCTest, Encode44) {
  uint8_t pkt[] = {0x82, 0xc5, 0x1,  0x3e, 0x89, 0x71, 0x22, 0x4e, 0x94, 0x28, 0x54, 0x28, 0xd7, 0x25, 0x46, 0x8,  0x0,
                   0x11, 0x22, 0x3f, 0x7e, 0xf,  0xb2, 0x9c, 0xd7, 0x62, 0xad, 0x60, 0xeb, 0x12, 0xf3, 0x6,  0xa5, 0x51,
                   0x9d, 0x25, 0x7,  0x19, 0x5b, 0x21, 0x9,  0x57, 0x22, 0x6f, 0x51, 0x2a, 0x16, 0x19, 0xef, 0x16, 0x0,
                   0x9,  0x41, 0x28, 0x9f, 0xd1, 0xb3, 0x24, 0x6f, 0x89, 0x3e, 0x1f, 0x0,  0x18, 0xca, 0x50, 0x20, 0xdb,
                   0x81, 0xce, 0x44, 0x5c, 0xd6, 0xa5, 0xed, 0xc3, 0x1,  0xd1, 0x2c, 0xf4, 0xd7, 0x74, 0x7f, 0x67, 0x5e,
                   0x1,  0xa7, 0x87, 0x16, 0x0,  0x19, 0x23, 0xfd, 0x54, 0xdf, 0x28, 0x38, 0xd7, 0x6f, 0xf4, 0x63, 0x41,
                   0xa2, 0xfc, 0x19, 0x12, 0xa0, 0x50, 0x94, 0xd,  0x3e, 0x31, 0xd7, 0x88, 0xa4, 0x21, 0x23, 0x3d, 0x87,
                   0x0,  0x19, 0xb,  0xfc, 0x24, 0x21, 0x99, 0x53, 0xb8, 0xe7, 0xe1, 0xf7, 0xb6, 0x77, 0xb9, 0xc4, 0xb3,
                   0xfb, 0x2d, 0x29, 0x44, 0x82, 0x57, 0x81, 0xde, 0x16, 0x51, 0x2,  0x0,  0x17, 0x42, 0x6e, 0xd3, 0x99,
                   0x5c, 0x4,  0xee, 0xbe, 0xc4, 0xb4, 0x43, 0x31, 0x92, 0x42, 0xc7, 0xec, 0x68, 0x11, 0xd2, 0x39, 0x2c,
                   0x93, 0x49, 0x1,  0x0,  0xe,  0x4,  0x3b, 0x37, 0x9f, 0x82, 0x63, 0x25, 0xf3, 0x18, 0x94, 0xd5, 0xb,
                   0xf7, 0x27, 0x1,  0x0,  0x7,  0xdc, 0xe1, 0x9,  0x84, 0x83, 0xdf, 0xb7, 0x1};

  uint8_t buf[210] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xb,  0xfc, 0x24, 0x21, 0x99, 0x53, 0xb8, 0xe7, 0xe1, 0xf7, 0xb6, 0x77, 0xb9,
                                     0xc4, 0xb3, 0xfb, 0x2d, 0x29, 0x44, 0x82, 0x57, 0x81, 0xde, 0x16, 0x51};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x42, 0x6e, 0xd3, 0x99, 0x5c, 0x4,  0xee, 0xbe, 0xc4, 0xb4, 0x43, 0x31,
                                     0x92, 0x42, 0xc7, 0xec, 0x68, 0x11, 0xd2, 0x39, 0x2c, 0x93, 0x49};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x4, 0x3b, 0x37, 0x9f, 0x82, 0x63, 0x25, 0xf3, 0x18, 0x94, 0xd5, 0xb, 0xf7, 0x27};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xdc, 0xe1, 0x9, 0x84, 0x83, 0xdf, 0xb7};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x22, 0x3f, 0x7e, 0xf,  0xb2, 0x9c, 0xd7, 0x62, 0xad,
                           0x60, 0xeb, 0x12, 0xf3, 0x6,  0xa5, 0x51, 0x9d};
  uint8_t bytesprops1[] = {0x41, 0x28, 0x9f, 0xd1, 0xb3, 0x24, 0x6f, 0x89, 0x3e};
  uint8_t bytesprops2[] = {0xca, 0x50, 0x20, 0xdb, 0x81, 0xce, 0x44, 0x5c, 0xd6, 0xa5, 0xed, 0xc3,
                           0x1,  0xd1, 0x2c, 0xf4, 0xd7, 0x74, 0x7f, 0x67, 0x5e, 0x1,  0xa7, 0x87};
  uint8_t bytesprops3[] = {0x23, 0xfd, 0x54, 0xdf, 0x28, 0x38, 0xd7, 0x6f, 0xf4, 0x63, 0x41, 0xa2, 0xfc,
                           0x19, 0x12, 0xa0, 0x50, 0x94, 0xd,  0x3e, 0x31, 0xd7, 0x88, 0xa4, 0x21};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20116}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 84}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 215}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 70}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 7}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 91}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 2391}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28497}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 22}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 239}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15751}},
  };

  lwmqtt_properties_t props = {15, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 16009, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14676 [("\219\215v\249b\191\208\&8H\181\rI&\210",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropAssignedClientIdentifier
// "",PropResponseInformation "\SOMU\195",PropServerKeepAlive 9648,PropUserProperty "0
// \"\229\155\171a\226\215\CAN\219\135\212\175P\202\172\179\251'q"
// "\187e\228\130\212>\155\230,`5\DC3\159\182\177\DC1\b\ESCT\135\GS\CAN\239\b\177\203\248",PropReasonString
// "I\237\USN\131\238C\177C",PropResponseInformation "xr\130a\v\244\180q*+\200\209\159\206\188\244\148["]
TEST(Subscribe5QCTest, Encode45) {
  uint8_t pkt[] = {0x82, 0x77, 0x39, 0x54, 0x63, 0x12, 0x0,  0x0,  0x1a, 0x0,  0x4,  0xe,  0x4d, 0x55, 0xc3, 0x13,
                   0x25, 0xb0, 0x26, 0x0,  0x15, 0x30, 0x20, 0x22, 0xe5, 0x9b, 0xab, 0x61, 0xe2, 0xd7, 0x18, 0xdb,
                   0x87, 0xd4, 0xaf, 0x50, 0xca, 0xac, 0xb3, 0xfb, 0x27, 0x71, 0x0,  0x1b, 0xbb, 0x65, 0xe4, 0x82,
                   0xd4, 0x3e, 0x9b, 0xe6, 0x2c, 0x60, 0x35, 0x13, 0x9f, 0xb6, 0xb1, 0x11, 0x8,  0x1b, 0x54, 0x87,
                   0x1d, 0x18, 0xef, 0x8,  0xb1, 0xcb, 0xf8, 0x1f, 0x0,  0x9,  0x49, 0xed, 0x1f, 0x4e, 0x83, 0xee,
                   0x43, 0xb1, 0x43, 0x1a, 0x0,  0x12, 0x78, 0x72, 0x82, 0x61, 0xb,  0xf4, 0xb4, 0x71, 0x2a, 0x2b,
                   0xc8, 0xd1, 0x9f, 0xce, 0xbc, 0xf4, 0x94, 0x5b, 0x0,  0xe,  0xdb, 0xd7, 0x76, 0xf9, 0x62, 0xbf,
                   0xd0, 0x38, 0x48, 0xb5, 0xd,  0x49, 0x26, 0xd2, 0x1};

  uint8_t buf[131] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xdb, 0xd7, 0x76, 0xf9, 0x62, 0xbf, 0xd0, 0x38, 0x48, 0xb5, 0xd, 0x49, 0x26, 0xd2};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0xe, 0x4d, 0x55, 0xc3};
  uint8_t bytesprops3[] = {0xbb, 0x65, 0xe4, 0x82, 0xd4, 0x3e, 0x9b, 0xe6, 0x2c, 0x60, 0x35, 0x13, 0x9f, 0xb6,
                           0xb1, 0x11, 0x8,  0x1b, 0x54, 0x87, 0x1d, 0x18, 0xef, 0x8,  0xb1, 0xcb, 0xf8};
  uint8_t bytesprops2[] = {0x30, 0x20, 0x22, 0xe5, 0x9b, 0xab, 0x61, 0xe2, 0xd7, 0x18, 0xdb,
                           0x87, 0xd4, 0xaf, 0x50, 0xca, 0xac, 0xb3, 0xfb, 0x27, 0x71};
  uint8_t bytesprops4[] = {0x49, 0xed, 0x1f, 0x4e, 0x83, 0xee, 0x43, 0xb1, 0x43};
  uint8_t bytesprops5[] = {0x78, 0x72, 0x82, 0x61, 0xb,  0xf4, 0xb4, 0x71, 0x2a,
                           0x2b, 0xc8, 0xd1, 0x9f, 0xce, 0xbc, 0xf4, 0x94, 0x5b};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {4, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 9648}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {21, (char*)&bytesprops2}, .v = {27, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {9, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {18, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14676, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2406
// [("\154wi\237\149\207\222\244\234fa?\209A\DEL\205\221\&5\DLE\224@\211\160\208\239\&0\134\SO\NUL",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("L|I\231\128\172e\STX@\198x",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("Sa \169\184R\183\199\225\251\153%v6\228H\"\244J\193",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),(";\"\b\143\221\r",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\210\147\237\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\141\237\229\157\173\ETXX/\224\174,\\\236\228",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\219\SOH\f)\241\252",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropMaximumPacketSize 29740,PropRequestResponseInformation 178,PropMessageExpiryInterval 17484,PropMaximumQoS
// 17,PropMaximumPacketSize 22624,PropSessionExpiryInterval 7138,PropResponseTopic
// "\180\242\156{\131p\177\222",PropResponseInformation
// "\139\227\221\&7\213\177'78/\186\215\133\GS\155\\Jy\143\a\217\239\181\247=~\NUL,j",PropSessionExpiryInterval
// 22972,PropWillDelayInterval 18526,PropReceiveMaximum 11707,PropReasonString "\157\147)\155)\USKX\185}|\DELt"]
TEST(Subscribe5QCTest, Encode46) {
  uint8_t pkt[] = {0x82, 0xd2, 0x1,  0x9,  0x66, 0x60, 0x27, 0x0,  0x0,  0x74, 0x2c, 0x19, 0xb2, 0x2,  0x0,  0x0,  0x44,
                   0x4c, 0x24, 0x11, 0x27, 0x0,  0x0,  0x58, 0x60, 0x11, 0x0,  0x0,  0x1b, 0xe2, 0x8,  0x0,  0x8,  0xb4,
                   0xf2, 0x9c, 0x7b, 0x83, 0x70, 0xb1, 0xde, 0x1a, 0x0,  0x1d, 0x8b, 0xe3, 0xdd, 0x37, 0xd5, 0xb1, 0x27,
                   0x37, 0x38, 0x2f, 0xba, 0xd7, 0x85, 0x1d, 0x9b, 0x5c, 0x4a, 0x79, 0x8f, 0x7,  0xd9, 0xef, 0xb5, 0xf7,
                   0x3d, 0x7e, 0x0,  0x2c, 0x6a, 0x11, 0x0,  0x0,  0x59, 0xbc, 0x18, 0x0,  0x0,  0x48, 0x5e, 0x21, 0x2d,
                   0xbb, 0x1f, 0x0,  0xd,  0x9d, 0x93, 0x29, 0x9b, 0x29, 0x1f, 0x4b, 0x58, 0xb9, 0x7d, 0x7c, 0x7f, 0x74,
                   0x0,  0x1d, 0x9a, 0x77, 0x69, 0xed, 0x95, 0xcf, 0xde, 0xf4, 0xea, 0x66, 0x61, 0x3f, 0xd1, 0x41, 0x7f,
                   0xcd, 0xdd, 0x35, 0x10, 0xe0, 0x40, 0xd3, 0xa0, 0xd0, 0xef, 0x30, 0x86, 0xe,  0x0,  0x0,  0x0,  0xb,
                   0x4c, 0x7c, 0x49, 0xe7, 0x80, 0xac, 0x65, 0x2,  0x40, 0xc6, 0x78, 0x0,  0x0,  0x14, 0x53, 0x61, 0x20,
                   0xa9, 0xb8, 0x52, 0xb7, 0xc7, 0xe1, 0xfb, 0x99, 0x25, 0x76, 0x36, 0xe4, 0x48, 0x22, 0xf4, 0x4a, 0xc1,
                   0x0,  0x0,  0x6,  0x3b, 0x22, 0x8,  0x8f, 0xdd, 0xd,  0x0,  0x0,  0x4,  0xd2, 0x93, 0xed, 0x19, 0x2,
                   0x0,  0xe,  0x8d, 0xed, 0xe5, 0x9d, 0xad, 0x3,  0x58, 0x2f, 0xe0, 0xae, 0x2c, 0x5c, 0xec, 0xe4, 0x2,
                   0x0,  0x6,  0xdb, 0x1,  0xc,  0x29, 0xf1, 0xfc, 0x1};

  uint8_t buf[223] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x9a, 0x77, 0x69, 0xed, 0x95, 0xcf, 0xde, 0xf4, 0xea, 0x66,
                                     0x61, 0x3f, 0xd1, 0x41, 0x7f, 0xcd, 0xdd, 0x35, 0x10, 0xe0,
                                     0x40, 0xd3, 0xa0, 0xd0, 0xef, 0x30, 0x86, 0xe,  0x0};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x4c, 0x7c, 0x49, 0xe7, 0x80, 0xac, 0x65, 0x2, 0x40, 0xc6, 0x78};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x61, 0x20, 0xa9, 0xb8, 0x52, 0xb7, 0xc7, 0xe1, 0xfb,
                                     0x99, 0x25, 0x76, 0x36, 0xe4, 0x48, 0x22, 0xf4, 0x4a, 0xc1};
  lwmqtt_string_t topic_filter_s2 = {20, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3b, 0x22, 0x8, 0x8f, 0xdd, 0xd};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd2, 0x93, 0xed, 0x19};
  lwmqtt_string_t topic_filter_s4 = {4, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8d, 0xed, 0xe5, 0x9d, 0xad, 0x3, 0x58, 0x2f, 0xe0, 0xae, 0x2c, 0x5c, 0xec, 0xe4};
  lwmqtt_string_t topic_filter_s5 = {14, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xdb, 0x1, 0xc, 0x29, 0xf1, 0xfc};
  lwmqtt_string_t topic_filter_s6 = {6, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xb4, 0xf2, 0x9c, 0x7b, 0x83, 0x70, 0xb1, 0xde};
  uint8_t bytesprops1[] = {0x8b, 0xe3, 0xdd, 0x37, 0xd5, 0xb1, 0x27, 0x37, 0x38, 0x2f, 0xba, 0xd7, 0x85, 0x1d, 0x9b,
                           0x5c, 0x4a, 0x79, 0x8f, 0x7,  0xd9, 0xef, 0xb5, 0xf7, 0x3d, 0x7e, 0x0,  0x2c, 0x6a};
  uint8_t bytesprops2[] = {0x9d, 0x93, 0x29, 0x9b, 0x29, 0x1f, 0x4b, 0x58, 0xb9, 0x7d, 0x7c, 0x7f, 0x74};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 29740}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 178}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 17484}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 17}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 22624}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 7138}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {29, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 22972}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 18526}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 11707}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {13, (char*)&bytesprops2}}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2406, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4955 [("\ENQ\139D6\149b\234\144\205\249k\207\248\b5\137\DC1\211*i\214\212Z\197\232\EM",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\193\&7\178\197`\133\195'\217\NAK\245\130i",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\vU\DEL\193\165\247\239O\244\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropCorrelationData "K",PropResponseInformation "\130\207\148~\RS[c",PropTopicAliasMaximum
// 13446,PropRequestResponseInformation 118,PropCorrelationData
// "\254\148Ng\143$\CANm\189x]J\242\175\211\183\SI5\242\227U\214o\NUL\245I\150\173
// j",PropSubscriptionIdentifierAvailable 163,PropRetainAvailable 40,PropMaximumQoS 150,PropContentType
// "\143\159h<\131*3\130\129\184\DC4\221,\141\254\139\ETX\235\131'x\187\158\EOT\157\219L\186\146\243",PropServerReference
// "\196s\218\CAN\217\SYNq\199\&8",PropAuthenticationData "P\151\251\167<.R\228\ETB\NAK\DLE",PropContentType
// "\156\173\156\174\161\138RF1\184y-3",PropResponseTopic
// "Z\241\196\229\168b\ESC[[0\"\185\192\t\225\&3SY\DEL",PropWildcardSubscriptionAvailable
// 75,PropWildcardSubscriptionAvailable 2,PropSessionExpiryInterval 28657,PropMaximumPacketSize
// 15747,PropSubscriptionIdentifierAvailable 219,PropServerReference
// "\193~UU\191a#\254\&8\196\236\181,i\136\217\202\161\231\144\160",PropSubscriptionIdentifier 6,PropServerKeepAlive
// 25297,PropSharedSubscriptionAvailable 104,PropRetainAvailable 181,PropSessionExpiryInterval 15689,PropCorrelationData
// "\151\144\230\192\241\&4\163tL\164e\179\210\178\232\v\ACK\242\151\173\191(\SYN'\221\181\202h",PropMaximumQoS
// 43,PropRequestResponseInformation 10]
TEST(Subscribe5QCTest, Encode47) {
  uint8_t pkt[] = {
      0x82, 0xb2, 0x2,  0x13, 0x5b, 0xf4, 0x1,  0x9,  0x0,  0x1,  0x4b, 0x1a, 0x0,  0x7,  0x82, 0xcf, 0x94, 0x7e, 0x1e,
      0x5b, 0x63, 0x22, 0x34, 0x86, 0x19, 0x76, 0x9,  0x0,  0x1e, 0xfe, 0x94, 0x4e, 0x67, 0x8f, 0x24, 0x18, 0x6d, 0xbd,
      0x78, 0x5d, 0x4a, 0xf2, 0xaf, 0xd3, 0xb7, 0xf,  0x35, 0xf2, 0xe3, 0x55, 0xd6, 0x6f, 0x0,  0xf5, 0x49, 0x96, 0xad,
      0x20, 0x6a, 0x29, 0xa3, 0x25, 0x28, 0x24, 0x96, 0x3,  0x0,  0x1e, 0x8f, 0x9f, 0x68, 0x3c, 0x83, 0x2a, 0x33, 0x82,
      0x81, 0xb8, 0x14, 0xdd, 0x2c, 0x8d, 0xfe, 0x8b, 0x3,  0xeb, 0x83, 0x27, 0x78, 0xbb, 0x9e, 0x4,  0x9d, 0xdb, 0x4c,
      0xba, 0x92, 0xf3, 0x1c, 0x0,  0x9,  0xc4, 0x73, 0xda, 0x18, 0xd9, 0x16, 0x71, 0xc7, 0x38, 0x16, 0x0,  0xb,  0x50,
      0x97, 0xfb, 0xa7, 0x3c, 0x2e, 0x52, 0xe4, 0x17, 0x15, 0x10, 0x3,  0x0,  0xd,  0x9c, 0xad, 0x9c, 0xae, 0xa1, 0x8a,
      0x52, 0x46, 0x31, 0xb8, 0x79, 0x2d, 0x33, 0x8,  0x0,  0x13, 0x5a, 0xf1, 0xc4, 0xe5, 0xa8, 0x62, 0x1b, 0x5b, 0x5b,
      0x30, 0x22, 0xb9, 0xc0, 0x9,  0xe1, 0x33, 0x53, 0x59, 0x7f, 0x28, 0x4b, 0x28, 0x2,  0x11, 0x0,  0x0,  0x6f, 0xf1,
      0x27, 0x0,  0x0,  0x3d, 0x83, 0x29, 0xdb, 0x1c, 0x0,  0x15, 0xc1, 0x7e, 0x55, 0x55, 0xbf, 0x61, 0x23, 0xfe, 0x38,
      0xc4, 0xec, 0xb5, 0x2c, 0x69, 0x88, 0xd9, 0xca, 0xa1, 0xe7, 0x90, 0xa0, 0xb,  0x6,  0x13, 0x62, 0xd1, 0x2a, 0x68,
      0x25, 0xb5, 0x11, 0x0,  0x0,  0x3d, 0x49, 0x9,  0x0,  0x1c, 0x97, 0x90, 0xe6, 0xc0, 0xf1, 0x34, 0xa3, 0x74, 0x4c,
      0xa4, 0x65, 0xb3, 0xd2, 0xb2, 0xe8, 0xb,  0x6,  0xf2, 0x97, 0xad, 0xbf, 0x28, 0x16, 0x27, 0xdd, 0xb5, 0xca, 0x68,
      0x24, 0x2b, 0x19, 0xa,  0x0,  0x1a, 0x5,  0x8b, 0x44, 0x36, 0x95, 0x62, 0xea, 0x90, 0xcd, 0xf9, 0x6b, 0xcf, 0xf8,
      0x8,  0x35, 0x89, 0x11, 0xd3, 0x2a, 0x69, 0xd6, 0xd4, 0x5a, 0xc5, 0xe8, 0x19, 0x0,  0x0,  0xd,  0xc1, 0x37, 0xb2,
      0xc5, 0x60, 0x85, 0xc3, 0x27, 0xd9, 0x15, 0xf5, 0x82, 0x69, 0x1,  0x0,  0xa,  0xb,  0x55, 0x7f, 0xc1, 0xa5, 0xf7,
      0xef, 0x4f, 0xf4, 0xdc, 0x1};

  uint8_t buf[319] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x5, 0x8b, 0x44, 0x36, 0x95, 0x62, 0xea, 0x90, 0xcd, 0xf9, 0x6b, 0xcf, 0xf8,
                                     0x8, 0x35, 0x89, 0x11, 0xd3, 0x2a, 0x69, 0xd6, 0xd4, 0x5a, 0xc5, 0xe8, 0x19};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x37, 0xb2, 0xc5, 0x60, 0x85, 0xc3, 0x27, 0xd9, 0x15, 0xf5, 0x82, 0x69};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb, 0x55, 0x7f, 0xc1, 0xa5, 0xf7, 0xef, 0x4f, 0xf4, 0xdc};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x4b};
  uint8_t bytesprops1[] = {0x82, 0xcf, 0x94, 0x7e, 0x1e, 0x5b, 0x63};
  uint8_t bytesprops2[] = {0xfe, 0x94, 0x4e, 0x67, 0x8f, 0x24, 0x18, 0x6d, 0xbd, 0x78, 0x5d, 0x4a, 0xf2, 0xaf, 0xd3,
                           0xb7, 0xf,  0x35, 0xf2, 0xe3, 0x55, 0xd6, 0x6f, 0x0,  0xf5, 0x49, 0x96, 0xad, 0x20, 0x6a};
  uint8_t bytesprops3[] = {0x8f, 0x9f, 0x68, 0x3c, 0x83, 0x2a, 0x33, 0x82, 0x81, 0xb8, 0x14, 0xdd, 0x2c, 0x8d, 0xfe,
                           0x8b, 0x3,  0xeb, 0x83, 0x27, 0x78, 0xbb, 0x9e, 0x4,  0x9d, 0xdb, 0x4c, 0xba, 0x92, 0xf3};
  uint8_t bytesprops4[] = {0xc4, 0x73, 0xda, 0x18, 0xd9, 0x16, 0x71, 0xc7, 0x38};
  uint8_t bytesprops5[] = {0x50, 0x97, 0xfb, 0xa7, 0x3c, 0x2e, 0x52, 0xe4, 0x17, 0x15, 0x10};
  uint8_t bytesprops6[] = {0x9c, 0xad, 0x9c, 0xae, 0xa1, 0x8a, 0x52, 0x46, 0x31, 0xb8, 0x79, 0x2d, 0x33};
  uint8_t bytesprops7[] = {0x5a, 0xf1, 0xc4, 0xe5, 0xa8, 0x62, 0x1b, 0x5b, 0x5b, 0x30,
                           0x22, 0xb9, 0xc0, 0x9,  0xe1, 0x33, 0x53, 0x59, 0x7f};
  uint8_t bytesprops8[] = {0xc1, 0x7e, 0x55, 0x55, 0xbf, 0x61, 0x23, 0xfe, 0x38, 0xc4, 0xec,
                           0xb5, 0x2c, 0x69, 0x88, 0xd9, 0xca, 0xa1, 0xe7, 0x90, 0xa0};
  uint8_t bytesprops9[] = {0x97, 0x90, 0xe6, 0xc0, 0xf1, 0x34, 0xa3, 0x74, 0x4c, 0xa4, 0x65, 0xb3, 0xd2, 0xb2,
                           0xe8, 0xb,  0x6,  0xf2, 0x97, 0xad, 0xbf, 0x28, 0x16, 0x27, 0xdd, 0xb5, 0xca, 0x68};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {1, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {7, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13446}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 118}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {30, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 163}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 40}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 150}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {9, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {13, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 75}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 2}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28657}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 15747}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 219}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 6}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 25297}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 104}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 181}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 15689}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {28, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 43}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 10}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4955, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 11203 [("\204\DC2P\234<\186\CANVS(\203F\SO\243\v\199\215\190\165-j\243",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\131\130\210u\174\253S\151\142FR\139\135\186\209\232\170\138\156\&1\NAKf\158E\186\167",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("#\151\&7\NULk\190\232\&6\DEL\DC4H\212\161\&6:\225",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\198\255$N$\183E\246\148\&8\242:\214\128\&2\178\149v/\140",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("O:\185)_;T{\187\198[\166&\148\153\147\203\\YB+Z\169fv\133\rL",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\182\ESC\138\244\250D\150\219B\SI\149\ENQ\172]i\166&\153\190~\228\193>\209",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\143\&6\\:",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropTopicAliasMaximum 5455,PropResponseTopic "\187\253\SUB\196\DC2",PropSubscriptionIdentifierAvailable
// 243,PropRequestProblemInformation 201,PropAuthenticationData
// "\161\182\235/\188\SYN\134\204\193\157\DC4\216",PropRequestProblemInformation 193,PropRetainAvailable
// 208,PropWillDelayInterval 24782,PropMessageExpiryInterval 9486,PropSharedSubscriptionAvailable 185,PropContentType
// "\230\200i\248\225\227\227\207\153\DC3\225<+'\f\154\174\133b\185\189A\205)\197\226l\168",PropMessageExpiryInterval
// 16144,PropSharedSubscriptionAvailable 132,PropWildcardSubscriptionAvailable 11,PropTopicAlias
// 24962,PropCorrelationData "\240='\222\206\181\SOHN\175\&0x",PropSubscriptionIdentifierAvailable 86]
TEST(Subscribe5QCTest, Encode48) {
  uint8_t pkt[] = {0x82, 0x8d, 0x2,  0x2b, 0xc3, 0x69, 0x22, 0x15, 0x4f, 0x8,  0x0,  0x5,  0xbb, 0xfd, 0x1a, 0xc4, 0x12,
                   0x29, 0xf3, 0x17, 0xc9, 0x16, 0x0,  0xc,  0xa1, 0xb6, 0xeb, 0x2f, 0xbc, 0x16, 0x86, 0xcc, 0xc1, 0x9d,
                   0x14, 0xd8, 0x17, 0xc1, 0x25, 0xd0, 0x18, 0x0,  0x0,  0x60, 0xce, 0x2,  0x0,  0x0,  0x25, 0xe,  0x2a,
                   0xb9, 0x3,  0x0,  0x1c, 0xe6, 0xc8, 0x69, 0xf8, 0xe1, 0xe3, 0xe3, 0xcf, 0x99, 0x13, 0xe1, 0x3c, 0x2b,
                   0x27, 0xc,  0x9a, 0xae, 0x85, 0x62, 0xb9, 0xbd, 0x41, 0xcd, 0x29, 0xc5, 0xe2, 0x6c, 0xa8, 0x2,  0x0,
                   0x0,  0x3f, 0x10, 0x2a, 0x84, 0x28, 0xb,  0x23, 0x61, 0x82, 0x9,  0x0,  0xb,  0xf0, 0x3d, 0x27, 0xde,
                   0xce, 0xb5, 0x1,  0x4e, 0xaf, 0x30, 0x78, 0x29, 0x56, 0x0,  0x16, 0xcc, 0x12, 0x50, 0xea, 0x3c, 0xba,
                   0x18, 0x56, 0x53, 0x28, 0xcb, 0x46, 0xe,  0xf3, 0xb,  0xc7, 0xd7, 0xbe, 0xa5, 0x2d, 0x6a, 0xf3, 0x0,
                   0x0,  0x1a, 0x83, 0x82, 0xd2, 0x75, 0xae, 0xfd, 0x53, 0x97, 0x8e, 0x46, 0x52, 0x8b, 0x87, 0xba, 0xd1,
                   0xe8, 0xaa, 0x8a, 0x9c, 0x31, 0x15, 0x66, 0x9e, 0x45, 0xba, 0xa7, 0x2,  0x0,  0x10, 0x23, 0x97, 0x37,
                   0x0,  0x6b, 0xbe, 0xe8, 0x36, 0x7f, 0x14, 0x48, 0xd4, 0xa1, 0x36, 0x3a, 0xe1, 0x0,  0x0,  0x14, 0xc6,
                   0xff, 0x24, 0x4e, 0x24, 0xb7, 0x45, 0xf6, 0x94, 0x38, 0xf2, 0x3a, 0xd6, 0x80, 0x32, 0xb2, 0x95, 0x76,
                   0x2f, 0x8c, 0x0,  0x0,  0x1c, 0x4f, 0x3a, 0xb9, 0x29, 0x5f, 0x3b, 0x54, 0x7b, 0xbb, 0xc6, 0x5b, 0xa6,
                   0x26, 0x94, 0x99, 0x93, 0xcb, 0x5c, 0x59, 0x42, 0x2b, 0x5a, 0xa9, 0x66, 0x76, 0x85, 0xd,  0x4c, 0x0,
                   0x0,  0x18, 0xb6, 0x1b, 0x8a, 0xf4, 0xfa, 0x44, 0x96, 0xdb, 0x42, 0xf,  0x95, 0x5,  0xac, 0x5d, 0x69,
                   0xa6, 0x26, 0x99, 0xbe, 0x7e, 0xe4, 0xc1, 0x3e, 0xd1, 0x1,  0x0,  0x4,  0x8f, 0x36, 0x5c, 0x3a, 0x1};

  uint8_t buf[282] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xcc, 0x12, 0x50, 0xea, 0x3c, 0xba, 0x18, 0x56, 0x53, 0x28, 0xcb,
                                     0x46, 0xe,  0xf3, 0xb,  0xc7, 0xd7, 0xbe, 0xa5, 0x2d, 0x6a, 0xf3};
  lwmqtt_string_t topic_filter_s0 = {22, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x83, 0x82, 0xd2, 0x75, 0xae, 0xfd, 0x53, 0x97, 0x8e, 0x46, 0x52, 0x8b, 0x87,
                                     0xba, 0xd1, 0xe8, 0xaa, 0x8a, 0x9c, 0x31, 0x15, 0x66, 0x9e, 0x45, 0xba, 0xa7};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x23, 0x97, 0x37, 0x0,  0x6b, 0xbe, 0xe8, 0x36,
                                     0x7f, 0x14, 0x48, 0xd4, 0xa1, 0x36, 0x3a, 0xe1};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc6, 0xff, 0x24, 0x4e, 0x24, 0xb7, 0x45, 0xf6, 0x94, 0x38,
                                     0xf2, 0x3a, 0xd6, 0x80, 0x32, 0xb2, 0x95, 0x76, 0x2f, 0x8c};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4f, 0x3a, 0xb9, 0x29, 0x5f, 0x3b, 0x54, 0x7b, 0xbb, 0xc6,
                                     0x5b, 0xa6, 0x26, 0x94, 0x99, 0x93, 0xcb, 0x5c, 0x59, 0x42,
                                     0x2b, 0x5a, 0xa9, 0x66, 0x76, 0x85, 0xd,  0x4c};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xb6, 0x1b, 0x8a, 0xf4, 0xfa, 0x44, 0x96, 0xdb, 0x42, 0xf,  0x95, 0x5,
                                     0xac, 0x5d, 0x69, 0xa6, 0x26, 0x99, 0xbe, 0x7e, 0xe4, 0xc1, 0x3e, 0xd1};
  lwmqtt_string_t topic_filter_s5 = {24, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8f, 0x36, 0x5c, 0x3a};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xbb, 0xfd, 0x1a, 0xc4, 0x12};
  uint8_t bytesprops1[] = {0xa1, 0xb6, 0xeb, 0x2f, 0xbc, 0x16, 0x86, 0xcc, 0xc1, 0x9d, 0x14, 0xd8};
  uint8_t bytesprops2[] = {0xe6, 0xc8, 0x69, 0xf8, 0xe1, 0xe3, 0xe3, 0xcf, 0x99, 0x13, 0xe1, 0x3c, 0x2b, 0x27,
                           0xc,  0x9a, 0xae, 0x85, 0x62, 0xb9, 0xbd, 0x41, 0xcd, 0x29, 0xc5, 0xe2, 0x6c, 0xa8};
  uint8_t bytesprops3[] = {0xf0, 0x3d, 0x27, 0xde, 0xce, 0xb5, 0x1, 0x4e, 0xaf, 0x30, 0x78};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 5455}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 243}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 201}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 193}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 208}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 24782}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9486}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 185}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16144}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 132}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 11}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 24962}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {11, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 86}},
  };

  lwmqtt_properties_t props = {17, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 11203, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30275 [("\NAK\ENQ",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] [PropServerKeepAlive 25108,PropMessageExpiryInterval 5293,PropResponseInformation
// "\132C\ACK>\207\166\158\244\153 \161\STX\246\192\246\254]H\FS!\219\&5\199\ETX~\135\195",PropTopicAliasMaximum
// 17913,PropAuthenticationData "\131\191\164\132\ETB\154\243`%\240",PropReceiveMaximum 28062,PropTopicAliasMaximum
// 15030]
TEST(Subscribe5QCTest, Encode49) {
  uint8_t pkt[] = {0x82, 0x44, 0x76, 0x43, 0x3c, 0x13, 0x62, 0x14, 0x2,  0x0,  0x0,  0x14, 0xad, 0x1a,
                   0x0,  0x1b, 0x84, 0x43, 0x6,  0x3e, 0xcf, 0xa6, 0x9e, 0xf4, 0x99, 0x20, 0xa1, 0x2,
                   0xf6, 0xc0, 0xf6, 0xfe, 0x5d, 0x48, 0x1c, 0x21, 0xdb, 0x35, 0xc7, 0x3,  0x7e, 0x87,
                   0xc3, 0x22, 0x45, 0xf9, 0x16, 0x0,  0xa,  0x83, 0xbf, 0xa4, 0x84, 0x17, 0x9a, 0xf3,
                   0x60, 0x25, 0xf0, 0x21, 0x6d, 0x9e, 0x22, 0x3a, 0xb6, 0x0,  0x2,  0x15, 0x5,  0x2};

  uint8_t buf[80] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x5};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x84, 0x43, 0x6,  0x3e, 0xcf, 0xa6, 0x9e, 0xf4, 0x99, 0x20, 0xa1, 0x2,  0xf6, 0xc0,
                           0xf6, 0xfe, 0x5d, 0x48, 0x1c, 0x21, 0xdb, 0x35, 0xc7, 0x3,  0x7e, 0x87, 0xc3};
  uint8_t bytesprops1[] = {0x83, 0xbf, 0xa4, 0x84, 0x17, 0x9a, 0xf3, 0x60, 0x25, 0xf0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 25108}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5293}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17913}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {10, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 28062}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 15030}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 30275, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 16095 [("\NAK;\166\150$",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("~U\133\EM",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\187m\GS\SOH\205\135\128<\RS\242\204^T\DC1]\f'\v\166\151\218v\STX\FS\131>\NUL",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("n\134\188wS\138\128\229\&1w*\244&",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] []
TEST(Subscribe5QCTest, Encode50) {
  uint8_t pkt[] = {0x82, 0x40, 0x3e, 0xdf, 0x0,  0x0,  0x5,  0x15, 0x3b, 0xa6, 0x96, 0x24, 0x1,  0x0,  0x4,  0x7e, 0x55,
                   0x85, 0x19, 0x1,  0x0,  0x1b, 0xbb, 0x6d, 0x1d, 0x1,  0xcd, 0x87, 0x80, 0x3c, 0x1e, 0xf2, 0xcc, 0x5e,
                   0x54, 0x11, 0x5d, 0xc,  0x27, 0xb,  0xa6, 0x97, 0xda, 0x76, 0x2,  0x1c, 0x83, 0x3e, 0x0,  0x0,  0x0,
                   0xd,  0x6e, 0x86, 0xbc, 0x77, 0x53, 0x8a, 0x80, 0xe5, 0x31, 0x77, 0x2a, 0xf4, 0x26, 0x2};

  uint8_t buf[76] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x15, 0x3b, 0xa6, 0x96, 0x24};
  lwmqtt_string_t topic_filter_s0 = {5, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7e, 0x55, 0x85, 0x19};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbb, 0x6d, 0x1d, 0x1, 0xcd, 0x87, 0x80, 0x3c, 0x1e, 0xf2, 0xcc, 0x5e, 0x54, 0x11,
                                     0x5d, 0xc,  0x27, 0xb, 0xa6, 0x97, 0xda, 0x76, 0x2,  0x1c, 0x83, 0x3e, 0x0};
  lwmqtt_string_t topic_filter_s2 = {27, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x6e, 0x86, 0xbc, 0x77, 0x53, 0x8a, 0x80, 0xe5, 0x31, 0x77, 0x2a, 0xf4, 0x26};
  lwmqtt_string_t topic_filter_s3 = {13, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 16095, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27116 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] [PropWildcardSubscriptionAvailable 131,PropTopicAliasMaximum 17943,PropResponseTopic
// "\NAK\134\198\&7K\241^\149\187:T\161\191\226l%\145\178\164\178\188\230\227\159\v",PropSharedSubscriptionAvailable
// 187,PropReasonString "\156\"\EMl\255\242]\GSy\223",PropRequestResponseInformation
// 144,PropSubscriptionIdentifierAvailable 48,PropContentType "\142\170\147!\223",PropMaximumPacketSize 32259]
TEST(Subscribe5QCTest, Encode51) {
  uint8_t pkt[] = {0x82, 0x47, 0x69, 0xec, 0x41, 0x28, 0x83, 0x22, 0x46, 0x17, 0x8,  0x0,  0x19, 0x15, 0x86,
                   0xc6, 0x37, 0x4b, 0xf1, 0x5e, 0x95, 0xbb, 0x3a, 0x54, 0xa1, 0xbf, 0xe2, 0x6c, 0x25, 0x91,
                   0xb2, 0xa4, 0xb2, 0xbc, 0xe6, 0xe3, 0x9f, 0xb,  0x2a, 0xbb, 0x1f, 0x0,  0xa,  0x9c, 0x22,
                   0x19, 0x6c, 0xff, 0xf2, 0x5d, 0x1d, 0x79, 0xdf, 0x19, 0x90, 0x29, 0x30, 0x3,  0x0,  0x5,
                   0x8e, 0xaa, 0x93, 0x21, 0xdf, 0x27, 0x0,  0x0,  0x7e, 0x3,  0x0,  0x0,  0x1};

  uint8_t buf[83] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x15, 0x86, 0xc6, 0x37, 0x4b, 0xf1, 0x5e, 0x95, 0xbb, 0x3a, 0x54, 0xa1, 0xbf,
                           0xe2, 0x6c, 0x25, 0x91, 0xb2, 0xa4, 0xb2, 0xbc, 0xe6, 0xe3, 0x9f, 0xb};
  uint8_t bytesprops1[] = {0x9c, 0x22, 0x19, 0x6c, 0xff, 0xf2, 0x5d, 0x1d, 0x79, 0xdf};
  uint8_t bytesprops2[] = {0x8e, 0xaa, 0x93, 0x21, 0xdf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17943}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 187}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 144}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 48}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {5, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32259}},
  };

  lwmqtt_properties_t props = {9, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 27116, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21718 [("1\174I~\249\CAN\ETB\DC1\225r>\134\n\208\t\160\184\206T\DC3\207L:\206C\137\158",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\207\SI\180J\RSA\SYN\212",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\b\176\222\185\206Sp\170\133",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe5QCTest, Encode52) {
  uint8_t pkt[] = {0x82, 0x38, 0x54, 0xd6, 0x0,  0x0,  0x1b, 0x31, 0xae, 0x49, 0x7e, 0xf9, 0x18, 0x17, 0x11,
                   0xe1, 0x72, 0x3e, 0x86, 0xa,  0xd0, 0x9,  0xa0, 0xb8, 0xce, 0x54, 0x13, 0xcf, 0x4c, 0x3a,
                   0xce, 0x43, 0x89, 0x9e, 0x2,  0x0,  0x8,  0xcf, 0xf,  0xb4, 0x4a, 0x1e, 0x41, 0x16, 0xd4,
                   0x1,  0x0,  0x9,  0x8,  0xb0, 0xde, 0xb9, 0xce, 0x53, 0x70, 0xaa, 0x85, 0x0};

  uint8_t buf[68] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x31, 0xae, 0x49, 0x7e, 0xf9, 0x18, 0x17, 0x11, 0xe1, 0x72, 0x3e, 0x86, 0xa, 0xd0,
                                     0x9,  0xa0, 0xb8, 0xce, 0x54, 0x13, 0xcf, 0x4c, 0x3a, 0xce, 0x43, 0x89, 0x9e};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcf, 0xf, 0xb4, 0x4a, 0x1e, 0x41, 0x16, 0xd4};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8, 0xb0, 0xde, 0xb9, 0xce, 0x53, 0x70, 0xaa, 0x85};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21718, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 32713 [("2\214\247\243(1\182\&4\130\248PZ\198\183\251=\\\128w\163\165~o\202",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("Z\195\171v<ncn\157",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),("\217\201\212Q\167\135\197\180\132\211\159.",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\219\CANe\r\135#\220",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropAssignedClientIdentifier
// "r[di\154\143\EOT\194\US\211\179\232\205\211\170+\CAN3\235Rc\SYN,\DC2_\196\ENQ\243",PropSubscriptionIdentifierAvailable
// 146,PropServerReference "*s\178s\243EK\231\196\&4Y\f\142\132\182\198K\t^I<\140",PropSubscriptionIdentifierAvailable
// 29,PropRetainAvailable 238,PropContentType "\228\220\151\&7\213E\129\DC3\171\au\164\&4`\241",PropTopicAlias
// 29805,PropSharedSubscriptionAvailable 115,PropReasonString
// "\247G\GS\146\165-\164\196|\tQ]\ETXm\GS\ACK\167o",PropPayloadFormatIndicator 98,PropPayloadFormatIndicator
// 186,PropAuthenticationMethod "\250\224\GS\236",PropSubscriptionIdentifierAvailable
// 54,PropWildcardSubscriptionAvailable 100,PropMaximumPacketSize 29770,PropMaximumQoS
// 149,PropSubscriptionIdentifierAvailable 140]
TEST(Subscribe5QCTest, Encode53) {
  uint8_t pkt[] = {0x82, 0xc6, 0x1,  0x7f, 0xc9, 0x82, 0x1,  0x12, 0x0,  0x1c, 0x72, 0x5b, 0x64, 0x69, 0x9a, 0x8f, 0x4,
                   0xc2, 0x1f, 0xd3, 0xb3, 0xe8, 0xcd, 0xd3, 0xaa, 0x2b, 0x18, 0x33, 0xeb, 0x52, 0x63, 0x16, 0x2c, 0x12,
                   0x5f, 0xc4, 0x5,  0xf3, 0x29, 0x92, 0x1c, 0x0,  0x16, 0x2a, 0x73, 0xb2, 0x73, 0xf3, 0x45, 0x4b, 0xe7,
                   0xc4, 0x34, 0x59, 0xc,  0x8e, 0x84, 0xb6, 0xc6, 0x4b, 0x9,  0x5e, 0x49, 0x3c, 0x8c, 0x29, 0x1d, 0x25,
                   0xee, 0x3,  0x0,  0xf,  0xe4, 0xdc, 0x97, 0x37, 0xd5, 0x45, 0x81, 0x13, 0xab, 0x7,  0x75, 0xa4, 0x34,
                   0x60, 0xf1, 0x23, 0x74, 0x6d, 0x2a, 0x73, 0x1f, 0x0,  0x12, 0xf7, 0x47, 0x1d, 0x92, 0xa5, 0x2d, 0xa4,
                   0xc4, 0x7c, 0x9,  0x51, 0x5d, 0x3,  0x6d, 0x1d, 0x6,  0xa7, 0x6f, 0x1,  0x62, 0x1,  0xba, 0x15, 0x0,
                   0x4,  0xfa, 0xe0, 0x1d, 0xec, 0x29, 0x36, 0x28, 0x64, 0x27, 0x0,  0x0,  0x74, 0x4a, 0x24, 0x95, 0x29,
                   0x8c, 0x0,  0x18, 0x32, 0xd6, 0xf7, 0xf3, 0x28, 0x31, 0xb6, 0x34, 0x82, 0xf8, 0x50, 0x5a, 0xc6, 0xb7,
                   0xfb, 0x3d, 0x5c, 0x80, 0x77, 0xa3, 0xa5, 0x7e, 0x6f, 0xca, 0x1,  0x0,  0x9,  0x5a, 0xc3, 0xab, 0x76,
                   0x3c, 0x6e, 0x63, 0x6e, 0x9d, 0x2,  0x0,  0xc,  0xd9, 0xc9, 0xd4, 0x51, 0xa7, 0x87, 0xc5, 0xb4, 0x84,
                   0xd3, 0x9f, 0x2e, 0x2,  0x0,  0x7,  0xdb, 0x18, 0x65, 0xd,  0x87, 0x23, 0xdc, 0x2};

  uint8_t buf[211] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x32, 0xd6, 0xf7, 0xf3, 0x28, 0x31, 0xb6, 0x34, 0x82, 0xf8, 0x50, 0x5a,
                                     0xc6, 0xb7, 0xfb, 0x3d, 0x5c, 0x80, 0x77, 0xa3, 0xa5, 0x7e, 0x6f, 0xca};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x5a, 0xc3, 0xab, 0x76, 0x3c, 0x6e, 0x63, 0x6e, 0x9d};
  lwmqtt_string_t topic_filter_s1 = {9, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xd9, 0xc9, 0xd4, 0x51, 0xa7, 0x87, 0xc5, 0xb4, 0x84, 0xd3, 0x9f, 0x2e};
  lwmqtt_string_t topic_filter_s2 = {12, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xdb, 0x18, 0x65, 0xd, 0x87, 0x23, 0xdc};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x72, 0x5b, 0x64, 0x69, 0x9a, 0x8f, 0x4,  0xc2, 0x1f, 0xd3, 0xb3, 0xe8, 0xcd, 0xd3,
                           0xaa, 0x2b, 0x18, 0x33, 0xeb, 0x52, 0x63, 0x16, 0x2c, 0x12, 0x5f, 0xc4, 0x5,  0xf3};
  uint8_t bytesprops1[] = {0x2a, 0x73, 0xb2, 0x73, 0xf3, 0x45, 0x4b, 0xe7, 0xc4, 0x34, 0x59,
                           0xc,  0x8e, 0x84, 0xb6, 0xc6, 0x4b, 0x9,  0x5e, 0x49, 0x3c, 0x8c};
  uint8_t bytesprops2[] = {0xe4, 0xdc, 0x97, 0x37, 0xd5, 0x45, 0x81, 0x13, 0xab, 0x7, 0x75, 0xa4, 0x34, 0x60, 0xf1};
  uint8_t bytesprops3[] = {0xf7, 0x47, 0x1d, 0x92, 0xa5, 0x2d, 0xa4, 0xc4, 0x7c,
                           0x9,  0x51, 0x5d, 0x3,  0x6d, 0x1d, 0x6,  0xa7, 0x6f};
  uint8_t bytesprops4[] = {0xfa, 0xe0, 0x1d, 0xec};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {28, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 146}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {22, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 29}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 238}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29805}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 115}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {18, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 98}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 186}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {4, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 54}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 100}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 29770}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 149}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 140}},
  };

  lwmqtt_properties_t props = {17, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 32713, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 29246 [("\237a\128\&0\FS\162\&4\135a\134-.\243=Z\131\255f^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("Wjn\237\248",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\140\183\154\b\172n\b)\ETXd",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("=\136\EOTZm\DC4\133\150\247V\183\175\213\168MPE\207a\189\171\233",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("UL\a\161\168U0\ETB\155\ESCn/\195\199\239:\170\185?\205\157\246\161x\218\242(\140\187",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\251\137,\142\241\190\248\206\209\242",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\187\133\204\252\DC3\170\128",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("k\t\DC1I(\ESC\193Zo\174\DC1D\153\213\166\n\141\158\ENQ\200",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropSharedSubscriptionAvailable
// 73,PropAuthenticationMethod "\n\243",PropResponseTopic
// "\154\241\134`\158\ETX^\229\ETX'S6>\219\&5=\227\f\227X1\\\178\172\251\165\154\161\194",PropWillDelayInterval
// 11579,PropMessageExpiryInterval 12043,PropSessionExpiryInterval 14813,PropTopicAliasMaximum 32111,PropMaximumQoS
// 129,PropCorrelationData "\198\187(",PropRequestResponseInformation 47,PropRetainAvailable 92,PropMaximumPacketSize
// 1709,PropContentType "\230\SUB\157\r\174'Z|Z\250pC\148\168\138\163\225\193Q\164\250J",PropMessageExpiryInterval
// 5711,PropRequestProblemInformation 109,PropPayloadFormatIndicator 229,PropAuthenticationMethod
// "\131\161\181M\203!\164\145-\161,\ACKq",PropServerReference
// "B\231W\171\175\ETB\138\140\230",PropMessageExpiryInterval 5530,PropRetainAvailable 242]
TEST(Subscribe5QCTest, Encode54) {
  uint8_t pkt[] = {
      0x82, 0xa5, 0x2,  0x72, 0x3e, 0x8f, 0x1,  0x2a, 0x49, 0x15, 0x0,  0x2,  0xa,  0xf3, 0x8,  0x0,  0x1d, 0x9a, 0xf1,
      0x86, 0x60, 0x9e, 0x3,  0x5e, 0xe5, 0x3,  0x27, 0x53, 0x36, 0x3e, 0xdb, 0x35, 0x3d, 0xe3, 0xc,  0xe3, 0x58, 0x31,
      0x5c, 0xb2, 0xac, 0xfb, 0xa5, 0x9a, 0xa1, 0xc2, 0x18, 0x0,  0x0,  0x2d, 0x3b, 0x2,  0x0,  0x0,  0x2f, 0xb,  0x11,
      0x0,  0x0,  0x39, 0xdd, 0x22, 0x7d, 0x6f, 0x24, 0x81, 0x9,  0x0,  0x3,  0xc6, 0xbb, 0x28, 0x19, 0x2f, 0x25, 0x5c,
      0x27, 0x0,  0x0,  0x6,  0xad, 0x3,  0x0,  0x16, 0xe6, 0x1a, 0x9d, 0xd,  0xae, 0x27, 0x5a, 0x7c, 0x5a, 0xfa, 0x70,
      0x43, 0x94, 0xa8, 0x8a, 0xa3, 0xe1, 0xc1, 0x51, 0xa4, 0xfa, 0x4a, 0x2,  0x0,  0x0,  0x16, 0x4f, 0x17, 0x6d, 0x1,
      0xe5, 0x15, 0x0,  0xd,  0x83, 0xa1, 0xb5, 0x4d, 0xcb, 0x21, 0xa4, 0x91, 0x2d, 0xa1, 0x2c, 0x6,  0x71, 0x1c, 0x0,
      0x9,  0x42, 0xe7, 0x57, 0xab, 0xaf, 0x17, 0x8a, 0x8c, 0xe6, 0x2,  0x0,  0x0,  0x15, 0x9a, 0x25, 0xf2, 0x0,  0x13,
      0xed, 0x61, 0x80, 0x30, 0x1c, 0xa2, 0x34, 0x87, 0x61, 0x86, 0x2d, 0x2e, 0xf3, 0x3d, 0x5a, 0x83, 0xff, 0x66, 0x5e,
      0x1,  0x0,  0x5,  0x57, 0x6a, 0x6e, 0xed, 0xf8, 0x2,  0x0,  0xa,  0x8c, 0xb7, 0x9a, 0x8,  0xac, 0x6e, 0x8,  0x29,
      0x3,  0x64, 0x1,  0x0,  0x16, 0x3d, 0x88, 0x4,  0x5a, 0x6d, 0x14, 0x85, 0x96, 0xf7, 0x56, 0xb7, 0xaf, 0xd5, 0xa8,
      0x4d, 0x50, 0x45, 0xcf, 0x61, 0xbd, 0xab, 0xe9, 0x0,  0x0,  0x1d, 0x55, 0x4c, 0x7,  0xa1, 0xa8, 0x55, 0x30, 0x17,
      0x9b, 0x1b, 0x6e, 0x2f, 0xc3, 0xc7, 0xef, 0x3a, 0xaa, 0xb9, 0x3f, 0xcd, 0x9d, 0xf6, 0xa1, 0x78, 0xda, 0xf2, 0x28,
      0x8c, 0xbb, 0x0,  0x0,  0xa,  0xfb, 0x89, 0x2c, 0x8e, 0xf1, 0xbe, 0xf8, 0xce, 0xd1, 0xf2, 0x1,  0x0,  0x7,  0xbb,
      0x85, 0xcc, 0xfc, 0x13, 0xaa, 0x80, 0x0,  0x0,  0x14, 0x6b, 0x9,  0x11, 0x49, 0x28, 0x1b, 0xc1, 0x5a, 0x6f, 0xae,
      0x11, 0x44, 0x99, 0xd5, 0xa6, 0xa,  0x8d, 0x9e, 0x5,  0xc8, 0x0};

  uint8_t buf[306] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xed, 0x61, 0x80, 0x30, 0x1c, 0xa2, 0x34, 0x87, 0x61, 0x86,
                                     0x2d, 0x2e, 0xf3, 0x3d, 0x5a, 0x83, 0xff, 0x66, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x57, 0x6a, 0x6e, 0xed, 0xf8};
  lwmqtt_string_t topic_filter_s1 = {5, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x8c, 0xb7, 0x9a, 0x8, 0xac, 0x6e, 0x8, 0x29, 0x3, 0x64};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3d, 0x88, 0x4,  0x5a, 0x6d, 0x14, 0x85, 0x96, 0xf7, 0x56, 0xb7,
                                     0xaf, 0xd5, 0xa8, 0x4d, 0x50, 0x45, 0xcf, 0x61, 0xbd, 0xab, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x55, 0x4c, 0x7,  0xa1, 0xa8, 0x55, 0x30, 0x17, 0x9b, 0x1b,
                                     0x6e, 0x2f, 0xc3, 0xc7, 0xef, 0x3a, 0xaa, 0xb9, 0x3f, 0xcd,
                                     0x9d, 0xf6, 0xa1, 0x78, 0xda, 0xf2, 0x28, 0x8c, 0xbb};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xfb, 0x89, 0x2c, 0x8e, 0xf1, 0xbe, 0xf8, 0xce, 0xd1, 0xf2};
  lwmqtt_string_t topic_filter_s5 = {10, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xbb, 0x85, 0xcc, 0xfc, 0x13, 0xaa, 0x80};
  lwmqtt_string_t topic_filter_s6 = {7, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x6b, 0x9,  0x11, 0x49, 0x28, 0x1b, 0xc1, 0x5a, 0x6f, 0xae,
                                     0x11, 0x44, 0x99, 0xd5, 0xa6, 0xa,  0x8d, 0x9e, 0x5,  0xc8};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0xa, 0xf3};
  uint8_t bytesprops1[] = {0x9a, 0xf1, 0x86, 0x60, 0x9e, 0x3,  0x5e, 0xe5, 0x3,  0x27, 0x53, 0x36, 0x3e, 0xdb, 0x35,
                           0x3d, 0xe3, 0xc,  0xe3, 0x58, 0x31, 0x5c, 0xb2, 0xac, 0xfb, 0xa5, 0x9a, 0xa1, 0xc2};
  uint8_t bytesprops2[] = {0xc6, 0xbb, 0x28};
  uint8_t bytesprops3[] = {0xe6, 0x1a, 0x9d, 0xd,  0xae, 0x27, 0x5a, 0x7c, 0x5a, 0xfa, 0x70,
                           0x43, 0x94, 0xa8, 0x8a, 0xa3, 0xe1, 0xc1, 0x51, 0xa4, 0xfa, 0x4a};
  uint8_t bytesprops4[] = {0x83, 0xa1, 0xb5, 0x4d, 0xcb, 0x21, 0xa4, 0x91, 0x2d, 0xa1, 0x2c, 0x6, 0x71};
  uint8_t bytesprops5[] = {0x42, 0xe7, 0x57, 0xab, 0xaf, 0x17, 0x8a, 0x8c, 0xe6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 73}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 11579}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 12043}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 14813}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 32111}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 129}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {3, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 47}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 92}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 1709}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {22, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5711}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 109}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 229}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {13, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {9, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5530}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 242}},
  };

  lwmqtt_properties_t props = {20, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 29246, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2039 [("\134\204K\176hu :\174\236V\DC1u\178\203",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\US\NULy38e\DC4\186\218\247&\r\202\247\214\221\158\tO:\146?c\221\188\174\202\241\206",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropServerReference "KXv\\y\228\248\185\228\&3\166\245\t\249=\STX)\173\182",PropRequestProblemInformation
// 175,PropRequestResponseInformation 131,PropCorrelationData
// "Yx\141(\159D6\176!.\181b\225.\145\r\206\ETB\163\234\243\175\180f\191\214\128",PropServerKeepAlive
// 27540,PropReceiveMaximum 20437,PropResponseInformation "\193\209\DC4:B\FSx\163\140\198\v",PropUserProperty
// "\a|\174\EOT3\136" "\147\134\143\DC3,",PropWillDelayInterval 22556,PropSessionExpiryInterval
// 11928,PropAuthenticationMethod "-\187\143\206\141Y\194\249\DC2\138\249\219k\158"]
TEST(Subscribe5QCTest, Encode55) {
  uint8_t pkt[] = {0x82, 0xac, 0x1,  0x7,  0xf7, 0x77, 0x1c, 0x0,  0x13, 0x4b, 0x58, 0x76, 0x5c, 0x79, 0xe4, 0xf8,
                   0xb9, 0xe4, 0x33, 0xa6, 0xf5, 0x9,  0xf9, 0x3d, 0x2,  0x29, 0xad, 0xb6, 0x17, 0xaf, 0x19, 0x83,
                   0x9,  0x0,  0x1b, 0x59, 0x78, 0x8d, 0x28, 0x9f, 0x44, 0x36, 0xb0, 0x21, 0x2e, 0xb5, 0x62, 0xe1,
                   0x2e, 0x91, 0xd,  0xce, 0x17, 0xa3, 0xea, 0xf3, 0xaf, 0xb4, 0x66, 0xbf, 0xd6, 0x80, 0x13, 0x6b,
                   0x94, 0x21, 0x4f, 0xd5, 0x1a, 0x0,  0xb,  0xc1, 0xd1, 0x14, 0x3a, 0x42, 0x1c, 0x78, 0xa3, 0x8c,
                   0xc6, 0xb,  0x26, 0x0,  0x6,  0x7,  0x7c, 0xae, 0x4,  0x33, 0x88, 0x0,  0x5,  0x93, 0x86, 0x8f,
                   0x13, 0x2c, 0x18, 0x0,  0x0,  0x58, 0x1c, 0x11, 0x0,  0x0,  0x2e, 0x98, 0x15, 0x0,  0xe,  0x2d,
                   0xbb, 0x8f, 0xce, 0x8d, 0x59, 0xc2, 0xf9, 0x12, 0x8a, 0xf9, 0xdb, 0x6b, 0x9e, 0x0,  0xf,  0x86,
                   0xcc, 0x4b, 0xb0, 0x68, 0x75, 0x20, 0x3a, 0xae, 0xec, 0x56, 0x11, 0x75, 0xb2, 0xcb, 0x1,  0x0,
                   0x1d, 0x1f, 0x0,  0x79, 0x33, 0x38, 0x65, 0x14, 0xba, 0xda, 0xf7, 0x26, 0xd,  0xca, 0xf7, 0xd6,
                   0xdd, 0x9e, 0x9,  0x4f, 0x3a, 0x92, 0x3f, 0x63, 0xdd, 0xbc, 0xae, 0xca, 0xf1, 0xce, 0x2};

  uint8_t buf[185] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0xcc, 0x4b, 0xb0, 0x68, 0x75, 0x20, 0x3a,
                                     0xae, 0xec, 0x56, 0x11, 0x75, 0xb2, 0xcb};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1f, 0x0,  0x79, 0x33, 0x38, 0x65, 0x14, 0xba, 0xda, 0xf7,
                                     0x26, 0xd,  0xca, 0xf7, 0xd6, 0xdd, 0x9e, 0x9,  0x4f, 0x3a,
                                     0x92, 0x3f, 0x63, 0xdd, 0xbc, 0xae, 0xca, 0xf1, 0xce};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x4b, 0x58, 0x76, 0x5c, 0x79, 0xe4, 0xf8, 0xb9, 0xe4, 0x33,
                           0xa6, 0xf5, 0x9,  0xf9, 0x3d, 0x2,  0x29, 0xad, 0xb6};
  uint8_t bytesprops1[] = {0x59, 0x78, 0x8d, 0x28, 0x9f, 0x44, 0x36, 0xb0, 0x21, 0x2e, 0xb5, 0x62, 0xe1, 0x2e,
                           0x91, 0xd,  0xce, 0x17, 0xa3, 0xea, 0xf3, 0xaf, 0xb4, 0x66, 0xbf, 0xd6, 0x80};
  uint8_t bytesprops2[] = {0xc1, 0xd1, 0x14, 0x3a, 0x42, 0x1c, 0x78, 0xa3, 0x8c, 0xc6, 0xb};
  uint8_t bytesprops4[] = {0x93, 0x86, 0x8f, 0x13, 0x2c};
  uint8_t bytesprops3[] = {0x7, 0x7c, 0xae, 0x4, 0x33, 0x88};
  uint8_t bytesprops5[] = {0x2d, 0xbb, 0x8f, 0xce, 0x8d, 0x59, 0xc2, 0xf9, 0x12, 0x8a, 0xf9, 0xdb, 0x6b, 0x9e};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 175}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {27, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 27540}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 20437}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {6, (char*)&bytesprops3}, .v = {5, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 22556}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11928}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {14, (char*)&bytesprops5}}},
  };

  lwmqtt_properties_t props = {11, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2039, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 29065
// [("^Q\224\196\169V\128\198eL\204\194\202.?\DEL\NAK\206Z\162;V\t\163\214\DLE\156\232",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\216\186a\141",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\173\DC4j\205\235",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2})] [PropMessageExpiryInterval 19729,PropSubscriptionIdentifier 11,PropContentType
// "{\213\222x#\147\160\190}\SYN\145\164\n[",PropResponseTopic "w\150\179\171\228\153E\f\216",PropContentType
// ";\208a\239\144y)tB'\DC2",PropMessageExpiryInterval 29087,PropServerReference "\181Fb
// \185\229\NUL\RS\158\150\n2\130",PropWillDelayInterval 4042,PropServerReference "w",PropContentType
// "\160\164\191\240\237Y\147\&9\182\193\ACK{B<\172\238\238u\161N\164V7\NAK%\241\214\192\200",PropReceiveMaximum
// 22724,PropResponseTopic "\EM\236\NUL<\146z\205\131\168%\186\&2",PropAssignedClientIdentifier
// "F\246\DC2\133\171\151\RS\129'2\254\162M\206\232\181`\f\209\148M",PropMaximumQoS 157,PropReceiveMaximum
// 26184,PropResponseTopic
// "\t_\236\130j\182\199\DC3Cl-\201\218\165a*\ENQ@\234\241\241\187\f\243\215\184\238\163",PropCorrelationData
// "\232\234:\223\164\218X\213\246y\SUB\143\244\175\209\&0l\176\211",PropAuthenticationData "\226\195\ACK\218
// A\136M\193)O3\255q~e'\154\242\190\136\147\176d\DC4d\231",PropSessionExpiryInterval 21583,PropAuthenticationMethod
// "\144\204\169x!^\213",PropServerKeepAlive 20138,PropMaximumQoS 108,PropContentType "\148\193\210F\163@\129\242"]
TEST(Subscribe5QCTest, Encode56) {
  uint8_t pkt[] = {
      0x82, 0xc3, 0x2,  0x71, 0x89, 0x91, 0x2,  0x2,  0x0,  0x0,  0x4d, 0x11, 0xb,  0xb,  0x3,  0x0,  0xe,  0x7b, 0xd5,
      0xde, 0x78, 0x23, 0x93, 0xa0, 0xbe, 0x7d, 0x16, 0x91, 0xa4, 0xa,  0x5b, 0x8,  0x0,  0x9,  0x77, 0x96, 0xb3, 0xab,
      0xe4, 0x99, 0x45, 0xc,  0xd8, 0x3,  0x0,  0xb,  0x3b, 0xd0, 0x61, 0xef, 0x90, 0x79, 0x29, 0x74, 0x42, 0x27, 0x12,
      0x2,  0x0,  0x0,  0x71, 0x9f, 0x1c, 0x0,  0xd,  0xb5, 0x46, 0x62, 0x20, 0xb9, 0xe5, 0x0,  0x1e, 0x9e, 0x96, 0xa,
      0x32, 0x82, 0x18, 0x0,  0x0,  0xf,  0xca, 0x1c, 0x0,  0x1,  0x77, 0x3,  0x0,  0x1d, 0xa0, 0xa4, 0xbf, 0xf0, 0xed,
      0x59, 0x93, 0x39, 0xb6, 0xc1, 0x6,  0x7b, 0x42, 0x3c, 0xac, 0xee, 0xee, 0x75, 0xa1, 0x4e, 0xa4, 0x56, 0x37, 0x15,
      0x25, 0xf1, 0xd6, 0xc0, 0xc8, 0x21, 0x58, 0xc4, 0x8,  0x0,  0xc,  0x19, 0xec, 0x0,  0x3c, 0x92, 0x7a, 0xcd, 0x83,
      0xa8, 0x25, 0xba, 0x32, 0x12, 0x0,  0x15, 0x46, 0xf6, 0x12, 0x85, 0xab, 0x97, 0x1e, 0x81, 0x27, 0x32, 0xfe, 0xa2,
      0x4d, 0xce, 0xe8, 0xb5, 0x60, 0xc,  0xd1, 0x94, 0x4d, 0x24, 0x9d, 0x21, 0x66, 0x48, 0x8,  0x0,  0x1c, 0x9,  0x5f,
      0xec, 0x82, 0x6a, 0xb6, 0xc7, 0x13, 0x43, 0x6c, 0x2d, 0xc9, 0xda, 0xa5, 0x61, 0x2a, 0x5,  0x40, 0xea, 0xf1, 0xf1,
      0xbb, 0xc,  0xf3, 0xd7, 0xb8, 0xee, 0xa3, 0x9,  0x0,  0x13, 0xe8, 0xea, 0x3a, 0xdf, 0xa4, 0xda, 0x58, 0xd5, 0xf6,
      0x79, 0x1a, 0x8f, 0xf4, 0xaf, 0xd1, 0x30, 0x6c, 0xb0, 0xd3, 0x16, 0x0,  0x1b, 0xe2, 0xc3, 0x6,  0xda, 0x20, 0x41,
      0x88, 0x4d, 0xc1, 0x29, 0x4f, 0x33, 0xff, 0x71, 0x7e, 0x65, 0x27, 0x9a, 0xf2, 0xbe, 0x88, 0x93, 0xb0, 0x64, 0x14,
      0x64, 0xe7, 0x11, 0x0,  0x0,  0x54, 0x4f, 0x15, 0x0,  0x7,  0x90, 0xcc, 0xa9, 0x78, 0x21, 0x5e, 0xd5, 0x13, 0x4e,
      0xaa, 0x24, 0x6c, 0x3,  0x0,  0x8,  0x94, 0xc1, 0xd2, 0x46, 0xa3, 0x40, 0x81, 0xf2, 0x0,  0x1c, 0x5e, 0x51, 0xe0,
      0xc4, 0xa9, 0x56, 0x80, 0xc6, 0x65, 0x4c, 0xcc, 0xc2, 0xca, 0x2e, 0x3f, 0x7f, 0x15, 0xce, 0x5a, 0xa2, 0x3b, 0x56,
      0x9,  0xa3, 0xd6, 0x10, 0x9c, 0xe8, 0x1,  0x0,  0x4,  0xd8, 0xba, 0x61, 0x8d, 0x1,  0x0,  0x5,  0xad, 0x14, 0x6a,
      0xcd, 0xeb, 0x2};

  uint8_t buf[336] = {0};

  lwmqtt_string_t topic_filters[3];
  uint8_t topic_filter_s0_bytes[] = {0x5e, 0x51, 0xe0, 0xc4, 0xa9, 0x56, 0x80, 0xc6, 0x65, 0x4c,
                                     0xcc, 0xc2, 0xca, 0x2e, 0x3f, 0x7f, 0x15, 0xce, 0x5a, 0xa2,
                                     0x3b, 0x56, 0x9,  0xa3, 0xd6, 0x10, 0x9c, 0xe8};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd8, 0xba, 0x61, 0x8d};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xad, 0x14, 0x6a, 0xcd, 0xeb};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x7b, 0xd5, 0xde, 0x78, 0x23, 0x93, 0xa0, 0xbe, 0x7d, 0x16, 0x91, 0xa4, 0xa, 0x5b};
  uint8_t bytesprops1[] = {0x77, 0x96, 0xb3, 0xab, 0xe4, 0x99, 0x45, 0xc, 0xd8};
  uint8_t bytesprops2[] = {0x3b, 0xd0, 0x61, 0xef, 0x90, 0x79, 0x29, 0x74, 0x42, 0x27, 0x12};
  uint8_t bytesprops3[] = {0xb5, 0x46, 0x62, 0x20, 0xb9, 0xe5, 0x0, 0x1e, 0x9e, 0x96, 0xa, 0x32, 0x82};
  uint8_t bytesprops4[] = {0x77};
  uint8_t bytesprops5[] = {0xa0, 0xa4, 0xbf, 0xf0, 0xed, 0x59, 0x93, 0x39, 0xb6, 0xc1, 0x6,  0x7b, 0x42, 0x3c, 0xac,
                           0xee, 0xee, 0x75, 0xa1, 0x4e, 0xa4, 0x56, 0x37, 0x15, 0x25, 0xf1, 0xd6, 0xc0, 0xc8};
  uint8_t bytesprops6[] = {0x19, 0xec, 0x0, 0x3c, 0x92, 0x7a, 0xcd, 0x83, 0xa8, 0x25, 0xba, 0x32};
  uint8_t bytesprops7[] = {0x46, 0xf6, 0x12, 0x85, 0xab, 0x97, 0x1e, 0x81, 0x27, 0x32, 0xfe,
                           0xa2, 0x4d, 0xce, 0xe8, 0xb5, 0x60, 0xc,  0xd1, 0x94, 0x4d};
  uint8_t bytesprops8[] = {0x9,  0x5f, 0xec, 0x82, 0x6a, 0xb6, 0xc7, 0x13, 0x43, 0x6c, 0x2d, 0xc9, 0xda, 0xa5,
                           0x61, 0x2a, 0x5,  0x40, 0xea, 0xf1, 0xf1, 0xbb, 0xc,  0xf3, 0xd7, 0xb8, 0xee, 0xa3};
  uint8_t bytesprops9[] = {0xe8, 0xea, 0x3a, 0xdf, 0xa4, 0xda, 0x58, 0xd5, 0xf6, 0x79,
                           0x1a, 0x8f, 0xf4, 0xaf, 0xd1, 0x30, 0x6c, 0xb0, 0xd3};
  uint8_t bytesprops10[] = {0xe2, 0xc3, 0x6,  0xda, 0x20, 0x41, 0x88, 0x4d, 0xc1, 0x29, 0x4f, 0x33, 0xff, 0x71,
                            0x7e, 0x65, 0x27, 0x9a, 0xf2, 0xbe, 0x88, 0x93, 0xb0, 0x64, 0x14, 0x64, 0xe7};
  uint8_t bytesprops11[] = {0x90, 0xcc, 0xa9, 0x78, 0x21, 0x5e, 0xd5};
  uint8_t bytesprops12[] = {0x94, 0xc1, 0xd2, 0x46, 0xa3, 0x40, 0x81, 0xf2};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19729}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 11}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29087}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {13, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4042}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {29, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 22724}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 157}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 26184}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {28, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {27, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21583}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {7, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20138}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 108}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops12}}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 29065, 3, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 6655 [("x\149\146\242D\207\254D\208\218\227h\141>hT\212\152\tmFk\v\159",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("v[g\156",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})]
// [PropMessageExpiryInterval 19764,PropAssignedClientIdentifier
// "\ACK\139Q\243#\155\166*\151\227\159\189\237w\185\EM",PropResponseTopic
// "\212F_\151B\237\207\186G07\r\153",PropWildcardSubscriptionAvailable 108,PropContentType
// "\192\225\STX\218\161\143\v\DC4:d;%\194\153\216\&7\ETB\235j\136",PropMaximumQoS 69,PropMessageExpiryInterval
// 4203,PropResponseInformation "",PropSubscriptionIdentifierAvailable 158,PropRequestProblemInformation
// 80,PropWildcardSubscriptionAvailable 181]
TEST(Subscribe5QCTest, Encode57) {
  uint8_t pkt[] = {0x82, 0x76, 0x19, 0xff, 0x51, 0x2,  0x0,  0x0,  0x4d, 0x34, 0x12, 0x0,  0x10, 0x6,  0x8b,
                   0x51, 0xf3, 0x23, 0x9b, 0xa6, 0x2a, 0x97, 0xe3, 0x9f, 0xbd, 0xed, 0x77, 0xb9, 0x19, 0x8,
                   0x0,  0xd,  0xd4, 0x46, 0x5f, 0x97, 0x42, 0xed, 0xcf, 0xba, 0x47, 0x30, 0x37, 0xd,  0x99,
                   0x28, 0x6c, 0x3,  0x0,  0x14, 0xc0, 0xe1, 0x2,  0xda, 0xa1, 0x8f, 0xb,  0x14, 0x3a, 0x64,
                   0x3b, 0x25, 0xc2, 0x99, 0xd8, 0x37, 0x17, 0xeb, 0x6a, 0x88, 0x24, 0x45, 0x2,  0x0,  0x0,
                   0x10, 0x6b, 0x1a, 0x0,  0x0,  0x29, 0x9e, 0x17, 0x50, 0x28, 0xb5, 0x0,  0x18, 0x78, 0x95,
                   0x92, 0xf2, 0x44, 0xcf, 0xfe, 0x44, 0xd0, 0xda, 0xe3, 0x68, 0x8d, 0x3e, 0x68, 0x54, 0xd4,
                   0x98, 0x9,  0x6d, 0x46, 0x6b, 0xb,  0x9f, 0x2,  0x0,  0x4,  0x76, 0x5b, 0x67, 0x9c, 0x0};

  uint8_t buf[130] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x78, 0x95, 0x92, 0xf2, 0x44, 0xcf, 0xfe, 0x44, 0xd0, 0xda, 0xe3, 0x68,
                                     0x8d, 0x3e, 0x68, 0x54, 0xd4, 0x98, 0x9,  0x6d, 0x46, 0x6b, 0xb,  0x9f};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x76, 0x5b, 0x67, 0x9c};
  lwmqtt_string_t topic_filter_s1 = {4, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x6,  0x8b, 0x51, 0xf3, 0x23, 0x9b, 0xa6, 0x2a,
                           0x97, 0xe3, 0x9f, 0xbd, 0xed, 0x77, 0xb9, 0x19};
  uint8_t bytesprops1[] = {0xd4, 0x46, 0x5f, 0x97, 0x42, 0xed, 0xcf, 0xba, 0x47, 0x30, 0x37, 0xd, 0x99};
  uint8_t bytesprops2[] = {0xc0, 0xe1, 0x2,  0xda, 0xa1, 0x8f, 0xb,  0x14, 0x3a, 0x64,
                           0x3b, 0x25, 0xc2, 0x99, 0xd8, 0x37, 0x17, 0xeb, 0x6a, 0x88};
  uint8_t bytesprops3[] = {0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19764}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {13, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 108}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {20, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 69}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4203}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 158}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 80}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 181}},
  };

  lwmqtt_properties_t props = {11, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 6655, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 2977 [("\137K3uf\128\132\202\FS\FS\224`z\196\144d\197\197\158\200y\233\ACK\184\220",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\171c\189\177zn\130)$\236\168",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\204\230!\136BX\135:J\204\170O\186\244\SO\140L2\187\"\132",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\185TD=\248\202\150\235L\245\DC4\184\200\145\EM\255\170\192\203\233\178\205\230\"w",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\138\215!n9\139\196\249\192\194\244\135Z'\136\194",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("S\170L\DC2\175\154u\143\228\222\"p8\148\148\170\224\213\161\189\147",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropSubscriptionIdentifier
// 29,PropResponseTopic "\171\193\SI\168\&5\FS\254\250",PropResponseInformation
// "\146\161\176w\ENQ\DC1\206\167\237\DLE\ACK\231@k\233\208g\154&:\132\217\148\240B",PropRetainAvailable
// 111,PropTopicAliasMaximum 4497,PropServerReference "f\234%l\243\128PT4\198",PropWildcardSubscriptionAvailable 55]
TEST(Subscribe5QCTest, Encode58) {
  uint8_t pkt[] = {0x82, 0xc9, 0x1,  0xb,  0xa1, 0x3d, 0xb,  0x1d, 0x8,  0x0,  0x8,  0xab, 0xc1, 0xf,  0xa8, 0x35, 0x1c,
                   0xfe, 0xfa, 0x1a, 0x0,  0x19, 0x92, 0xa1, 0xb0, 0x77, 0x5,  0x11, 0xce, 0xa7, 0xed, 0x10, 0x6,  0xe7,
                   0x40, 0x6b, 0xe9, 0xd0, 0x67, 0x9a, 0x26, 0x3a, 0x84, 0xd9, 0x94, 0xf0, 0x42, 0x25, 0x6f, 0x22, 0x11,
                   0x91, 0x1c, 0x0,  0xa,  0x66, 0xea, 0x25, 0x6c, 0xf3, 0x80, 0x50, 0x54, 0x34, 0xc6, 0x28, 0x37, 0x0,
                   0x19, 0x89, 0x4b, 0x33, 0x75, 0x66, 0x80, 0x84, 0xca, 0x1c, 0x1c, 0xe0, 0x60, 0x7a, 0xc4, 0x90, 0x64,
                   0xc5, 0xc5, 0x9e, 0xc8, 0x79, 0xe9, 0x6,  0xb8, 0xdc, 0x2,  0x0,  0xb,  0xab, 0x63, 0xbd, 0xb1, 0x7a,
                   0x6e, 0x82, 0x29, 0x24, 0xec, 0xa8, 0x1,  0x0,  0x15, 0xcc, 0xe6, 0x21, 0x88, 0x42, 0x58, 0x87, 0x3a,
                   0x4a, 0xcc, 0xaa, 0x4f, 0xba, 0xf4, 0xe,  0x8c, 0x4c, 0x32, 0xbb, 0x22, 0x84, 0x1,  0x0,  0x19, 0xb9,
                   0x54, 0x44, 0x3d, 0xf8, 0xca, 0x96, 0xeb, 0x4c, 0xf5, 0x14, 0xb8, 0xc8, 0x91, 0x19, 0xff, 0xaa, 0xc0,
                   0xcb, 0xe9, 0xb2, 0xcd, 0xe6, 0x22, 0x77, 0x1,  0x0,  0x10, 0x8a, 0xd7, 0x21, 0x6e, 0x39, 0x8b, 0xc4,
                   0xf9, 0xc0, 0xc2, 0xf4, 0x87, 0x5a, 0x27, 0x88, 0xc2, 0x0,  0x0,  0x15, 0x53, 0xaa, 0x4c, 0x12, 0xaf,
                   0x9a, 0x75, 0x8f, 0xe4, 0xde, 0x22, 0x70, 0x38, 0x94, 0x94, 0xaa, 0xe0, 0xd5, 0xa1, 0xbd, 0x93, 0x0};

  uint8_t buf[214] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x89, 0x4b, 0x33, 0x75, 0x66, 0x80, 0x84, 0xca, 0x1c, 0x1c, 0xe0, 0x60, 0x7a,
                                     0xc4, 0x90, 0x64, 0xc5, 0xc5, 0x9e, 0xc8, 0x79, 0xe9, 0x6,  0xb8, 0xdc};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xab, 0x63, 0xbd, 0xb1, 0x7a, 0x6e, 0x82, 0x29, 0x24, 0xec, 0xa8};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xcc, 0xe6, 0x21, 0x88, 0x42, 0x58, 0x87, 0x3a, 0x4a, 0xcc, 0xaa,
                                     0x4f, 0xba, 0xf4, 0xe,  0x8c, 0x4c, 0x32, 0xbb, 0x22, 0x84};
  lwmqtt_string_t topic_filter_s2 = {21, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb9, 0x54, 0x44, 0x3d, 0xf8, 0xca, 0x96, 0xeb, 0x4c, 0xf5, 0x14, 0xb8, 0xc8,
                                     0x91, 0x19, 0xff, 0xaa, 0xc0, 0xcb, 0xe9, 0xb2, 0xcd, 0xe6, 0x22, 0x77};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8a, 0xd7, 0x21, 0x6e, 0x39, 0x8b, 0xc4, 0xf9,
                                     0xc0, 0xc2, 0xf4, 0x87, 0x5a, 0x27, 0x88, 0xc2};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x53, 0xaa, 0x4c, 0x12, 0xaf, 0x9a, 0x75, 0x8f, 0xe4, 0xde, 0x22,
                                     0x70, 0x38, 0x94, 0x94, 0xaa, 0xe0, 0xd5, 0xa1, 0xbd, 0x93};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0xab, 0xc1, 0xf, 0xa8, 0x35, 0x1c, 0xfe, 0xfa};
  uint8_t bytesprops1[] = {0x92, 0xa1, 0xb0, 0x77, 0x5,  0x11, 0xce, 0xa7, 0xed, 0x10, 0x6,  0xe7, 0x40,
                           0x6b, 0xe9, 0xd0, 0x67, 0x9a, 0x26, 0x3a, 0x84, 0xd9, 0x94, 0xf0, 0x42};
  uint8_t bytesprops2[] = {0x66, 0xea, 0x25, 0x6c, 0xf3, 0x80, 0x50, 0x54, 0x34, 0xc6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 29}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {8, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {25, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 111}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4497}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 55}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 2977, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14796 [("dL\223\173OD1\b",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\194\241\150\GS\SYN\239\&9\227\136c\138\225ItdFP",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropSubscriptionIdentifier
// 0,PropWillDelayInterval 9891,PropTopicAliasMaximum 19892,PropMessageExpiryInterval 10256,PropServerReference
// "\236gE\STX\NUL\193\149\249\&7lh\154~\198",PropServerKeepAlive 4439,PropTopicAlias
// 19774,PropRequestResponseInformation 33,PropMessageExpiryInterval 1725]
TEST(Subscribe5QCTest, Encode59) {
  uint8_t pkt[] = {0x82, 0x4f, 0x39, 0xcc, 0x2d, 0xb,  0x0,  0x18, 0x0,  0x0,  0x26, 0xa3, 0x22, 0x4d, 0xb4, 0x2,  0x0,
                   0x0,  0x28, 0x10, 0x1c, 0x0,  0xe,  0xec, 0x67, 0x45, 0x2,  0x0,  0xc1, 0x95, 0xf9, 0x37, 0x6c, 0x68,
                   0x9a, 0x7e, 0xc6, 0x13, 0x11, 0x57, 0x23, 0x4d, 0x3e, 0x19, 0x21, 0x2,  0x0,  0x0,  0x6,  0xbd, 0x0,
                   0x8,  0x64, 0x4c, 0xdf, 0xad, 0x4f, 0x44, 0x31, 0x8,  0x1,  0x0,  0x11, 0xc2, 0xf1, 0x96, 0x1d, 0x16,
                   0xef, 0x39, 0xe3, 0x88, 0x63, 0x8a, 0xe1, 0x49, 0x74, 0x64, 0x46, 0x50, 0x1};

  uint8_t buf[91] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x64, 0x4c, 0xdf, 0xad, 0x4f, 0x44, 0x31, 0x8};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc2, 0xf1, 0x96, 0x1d, 0x16, 0xef, 0x39, 0xe3, 0x88,
                                     0x63, 0x8a, 0xe1, 0x49, 0x74, 0x64, 0x46, 0x50};
  lwmqtt_string_t topic_filter_s1 = {17, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xec, 0x67, 0x45, 0x2, 0x0, 0xc1, 0x95, 0xf9, 0x37, 0x6c, 0x68, 0x9a, 0x7e, 0xc6};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 0}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 9891}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19892}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 10256}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 4439}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 19774}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 33}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 1725}},
  };

  lwmqtt_properties_t props = {9, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14796, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12164 [("\215\191",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\183\&1\149d|\172\187\170\n\253\&0\247d\147\189",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\"-\141\168\ESCz\249\US;",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\248\206\134zY'gO\232M\144X\242\ESC\196\210\242Ka",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\155\&9\136\225\249<@6\DC2C8VS\170\237\208=1\161t\156e\198R'\149\183",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\138h\162\"\239\145\&1Q\212\182\ETB\132\178T\203\211\181\250\190\ETX\US\154\132c\168\205\218\139\176\171",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\165\160\138\189\b1fH\233\ACK_\\\a\250\137\DEL\130\251\NUL\US\166\145[\162J",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193\ETX\186T\206c}8/>H\163\255\173\&4",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("<\STX\246d\230",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("e\229|n.\CAN\FS\177\249\229Y\"Fe\193\209\"\225+\217x\190ub\253|",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\170R!*\191)5\154\202|,\DEL};bb\224\&1\233\194M\DC4`&\NUL\131",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropServerReference
// "\141\160\211*\222\198\STX\229\139\DC4\160B`\DC18\246/\192C\212\195\149]i\221\149D\242I\142",PropReasonString
// "?\255z\246\231\"\163\DLE\218i%O\209\246\224\217U\EOT\235\151\159\222",PropServerKeepAlive 9806,PropServerReference
// ".\230\&2(m\254\178u=R\151\227g\188KW_\182\216\222]\"P\fz",PropRetainAvailable 41,PropRequestProblemInformation
// 13,PropRetainAvailable 59,PropResponseInformation
// "k\216\247\&2|,\152Z\206\152\188\129-(\208\DLE\EM\164\f\146\202\234",PropServerReference
// "2\217\RS\141\&6U\190b",PropMaximumQoS 153,PropMaximumPacketSize 20414,PropAuthenticationData
// "\201\226\193\CANS\"\CAN\FS",PropAuthenticationData ")Ag\208\v\n\241\229\176\171u\217"]
TEST(Subscribe5QCTest, Encode60) {
  uint8_t pkt[] = {
      0x82, 0x90, 0x3,  0x2f, 0x84, 0xa4, 0x1,  0x1c, 0x0,  0x1e, 0x8d, 0xa0, 0xd3, 0x2a, 0xde, 0xc6, 0x2,  0xe5, 0x8b,
      0x14, 0xa0, 0x42, 0x60, 0x11, 0x38, 0xf6, 0x2f, 0xc0, 0x43, 0xd4, 0xc3, 0x95, 0x5d, 0x69, 0xdd, 0x95, 0x44, 0xf2,
      0x49, 0x8e, 0x1f, 0x0,  0x16, 0x3f, 0xff, 0x7a, 0xf6, 0xe7, 0x22, 0xa3, 0x10, 0xda, 0x69, 0x25, 0x4f, 0xd1, 0xf6,
      0xe0, 0xd9, 0x55, 0x4,  0xeb, 0x97, 0x9f, 0xde, 0x13, 0x26, 0x4e, 0x1c, 0x0,  0x19, 0x2e, 0xe6, 0x32, 0x28, 0x6d,
      0xfe, 0xb2, 0x75, 0x3d, 0x52, 0x97, 0xe3, 0x67, 0xbc, 0x4b, 0x57, 0x5f, 0xb6, 0xd8, 0xde, 0x5d, 0x22, 0x50, 0xc,
      0x7a, 0x25, 0x29, 0x17, 0xd,  0x25, 0x3b, 0x1a, 0x0,  0x16, 0x6b, 0xd8, 0xf7, 0x32, 0x7c, 0x2c, 0x98, 0x5a, 0xce,
      0x98, 0xbc, 0x81, 0x2d, 0x28, 0xd0, 0x10, 0x19, 0xa4, 0xc,  0x92, 0xca, 0xea, 0x1c, 0x0,  0x8,  0x32, 0xd9, 0x1e,
      0x8d, 0x36, 0x55, 0xbe, 0x62, 0x24, 0x99, 0x27, 0x0,  0x0,  0x4f, 0xbe, 0x16, 0x0,  0x8,  0xc9, 0xe2, 0xc1, 0x18,
      0x53, 0x22, 0x18, 0x1c, 0x16, 0x0,  0xc,  0x29, 0x41, 0x67, 0xd0, 0xb,  0xa,  0xf1, 0xe5, 0xb0, 0xab, 0x75, 0xd9,
      0x0,  0x2,  0xd7, 0xbf, 0x1,  0x0,  0xf,  0xb7, 0x31, 0x95, 0x64, 0x7c, 0xac, 0xbb, 0xaa, 0xa,  0xfd, 0x30, 0xf7,
      0x64, 0x93, 0xbd, 0x2,  0x0,  0x9,  0x22, 0x2d, 0x8d, 0xa8, 0x1b, 0x7a, 0xf9, 0x1f, 0x3b, 0x0,  0x0,  0x13, 0xf8,
      0xce, 0x86, 0x7a, 0x59, 0x27, 0x67, 0x4f, 0xe8, 0x4d, 0x90, 0x58, 0xf2, 0x1b, 0xc4, 0xd2, 0xf2, 0x4b, 0x61, 0x2,
      0x0,  0x1b, 0x9b, 0x39, 0x88, 0xe1, 0xf9, 0x3c, 0x40, 0x36, 0x12, 0x43, 0x38, 0x56, 0x53, 0xaa, 0xed, 0xd0, 0x3d,
      0x31, 0xa1, 0x74, 0x9c, 0x65, 0xc6, 0x52, 0x27, 0x95, 0xb7, 0x0,  0x0,  0x1e, 0x8a, 0x68, 0xa2, 0x22, 0xef, 0x91,
      0x31, 0x51, 0xd4, 0xb6, 0x17, 0x84, 0xb2, 0x54, 0xcb, 0xd3, 0xb5, 0xfa, 0xbe, 0x3,  0x1f, 0x9a, 0x84, 0x63, 0xa8,
      0xcd, 0xda, 0x8b, 0xb0, 0xab, 0x2,  0x0,  0x19, 0xa5, 0xa0, 0x8a, 0xbd, 0x8,  0x31, 0x66, 0x48, 0xe9, 0x6,  0x5f,
      0x5c, 0x7,  0xfa, 0x89, 0x7f, 0x82, 0xfb, 0x0,  0x1f, 0xa6, 0x91, 0x5b, 0xa2, 0x4a, 0x2,  0x0,  0xf,  0xc1, 0x3,
      0xba, 0x54, 0xce, 0x63, 0x7d, 0x38, 0x2f, 0x3e, 0x48, 0xa3, 0xff, 0xad, 0x34, 0x0,  0x0,  0x5,  0x3c, 0x2,  0xf6,
      0x64, 0xe6, 0x1,  0x0,  0x1a, 0x65, 0xe5, 0x7c, 0x6e, 0x2e, 0x18, 0x1c, 0xb1, 0xf9, 0xe5, 0x59, 0x22, 0x46, 0x65,
      0xc1, 0xd1, 0x22, 0xe1, 0x2b, 0xd9, 0x78, 0xbe, 0x75, 0x62, 0xfd, 0x7c, 0x2,  0x0,  0x1a, 0xaa, 0x52, 0x21, 0x2a,
      0xbf, 0x29, 0x35, 0x9a, 0xca, 0x7c, 0x2c, 0x7f, 0x7d, 0x3b, 0x62, 0x62, 0xe0, 0x31, 0xe9, 0xc2, 0x4d, 0x14, 0x60,
      0x26, 0x0,  0x83, 0x2};

  uint8_t buf[413] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xd7, 0xbf};
  lwmqtt_string_t topic_filter_s0 = {2, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb7, 0x31, 0x95, 0x64, 0x7c, 0xac, 0xbb, 0xaa,
                                     0xa,  0xfd, 0x30, 0xf7, 0x64, 0x93, 0xbd};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x22, 0x2d, 0x8d, 0xa8, 0x1b, 0x7a, 0xf9, 0x1f, 0x3b};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf8, 0xce, 0x86, 0x7a, 0x59, 0x27, 0x67, 0x4f, 0xe8, 0x4d,
                                     0x90, 0x58, 0xf2, 0x1b, 0xc4, 0xd2, 0xf2, 0x4b, 0x61};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9b, 0x39, 0x88, 0xe1, 0xf9, 0x3c, 0x40, 0x36, 0x12, 0x43, 0x38, 0x56, 0x53, 0xaa,
                                     0xed, 0xd0, 0x3d, 0x31, 0xa1, 0x74, 0x9c, 0x65, 0xc6, 0x52, 0x27, 0x95, 0xb7};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8a, 0x68, 0xa2, 0x22, 0xef, 0x91, 0x31, 0x51, 0xd4, 0xb6,
                                     0x17, 0x84, 0xb2, 0x54, 0xcb, 0xd3, 0xb5, 0xfa, 0xbe, 0x3,
                                     0x1f, 0x9a, 0x84, 0x63, 0xa8, 0xcd, 0xda, 0x8b, 0xb0, 0xab};
  lwmqtt_string_t topic_filter_s5 = {30, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xa5, 0xa0, 0x8a, 0xbd, 0x8,  0x31, 0x66, 0x48, 0xe9, 0x6,  0x5f, 0x5c, 0x7,
                                     0xfa, 0x89, 0x7f, 0x82, 0xfb, 0x0,  0x1f, 0xa6, 0x91, 0x5b, 0xa2, 0x4a};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xc1, 0x3,  0xba, 0x54, 0xce, 0x63, 0x7d, 0x38,
                                     0x2f, 0x3e, 0x48, 0xa3, 0xff, 0xad, 0x34};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x3c, 0x2, 0xf6, 0x64, 0xe6};
  lwmqtt_string_t topic_filter_s8 = {5, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x65, 0xe5, 0x7c, 0x6e, 0x2e, 0x18, 0x1c, 0xb1, 0xf9, 0xe5, 0x59, 0x22, 0x46,
                                     0x65, 0xc1, 0xd1, 0x22, 0xe1, 0x2b, 0xd9, 0x78, 0xbe, 0x75, 0x62, 0xfd, 0x7c};
  lwmqtt_string_t topic_filter_s9 = {26, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xaa, 0x52, 0x21, 0x2a, 0xbf, 0x29, 0x35, 0x9a, 0xca, 0x7c, 0x2c, 0x7f, 0x7d,
                                      0x3b, 0x62, 0x62, 0xe0, 0x31, 0xe9, 0xc2, 0x4d, 0x14, 0x60, 0x26, 0x0,  0x83};
  lwmqtt_string_t topic_filter_s10 = {26, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x8d, 0xa0, 0xd3, 0x2a, 0xde, 0xc6, 0x2,  0xe5, 0x8b, 0x14, 0xa0, 0x42, 0x60, 0x11, 0x38,
                           0xf6, 0x2f, 0xc0, 0x43, 0xd4, 0xc3, 0x95, 0x5d, 0x69, 0xdd, 0x95, 0x44, 0xf2, 0x49, 0x8e};
  uint8_t bytesprops1[] = {0x3f, 0xff, 0x7a, 0xf6, 0xe7, 0x22, 0xa3, 0x10, 0xda, 0x69, 0x25,
                           0x4f, 0xd1, 0xf6, 0xe0, 0xd9, 0x55, 0x4,  0xeb, 0x97, 0x9f, 0xde};
  uint8_t bytesprops2[] = {0x2e, 0xe6, 0x32, 0x28, 0x6d, 0xfe, 0xb2, 0x75, 0x3d, 0x52, 0x97, 0xe3, 0x67,
                           0xbc, 0x4b, 0x57, 0x5f, 0xb6, 0xd8, 0xde, 0x5d, 0x22, 0x50, 0xc,  0x7a};
  uint8_t bytesprops3[] = {0x6b, 0xd8, 0xf7, 0x32, 0x7c, 0x2c, 0x98, 0x5a, 0xce, 0x98, 0xbc,
                           0x81, 0x2d, 0x28, 0xd0, 0x10, 0x19, 0xa4, 0xc,  0x92, 0xca, 0xea};
  uint8_t bytesprops4[] = {0x32, 0xd9, 0x1e, 0x8d, 0x36, 0x55, 0xbe, 0x62};
  uint8_t bytesprops5[] = {0xc9, 0xe2, 0xc1, 0x18, 0x53, 0x22, 0x18, 0x1c};
  uint8_t bytesprops6[] = {0x29, 0x41, 0x67, 0xd0, 0xb, 0xa, 0xf1, 0xe5, 0xb0, 0xab, 0x75, 0xd9};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 9806}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {25, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 41}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 13}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 59}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {22, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {8, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 153}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20414}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {8, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops6}}},
  };

  lwmqtt_properties_t props = {13, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12164, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12633 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\142\241\204\138,\174\131\149\199\160o\205\146",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("r\146\242\132\DC1\212\252\ETX\DC3\192\195\&3\169\231!",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\225\238p\223\135rJ\134'\ETB\DEL\137\131\NUL\223h\DC4\171\ESC\248",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("l1\185\139a\217\DEL7?\r\EM?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("?<CE\195\171\147\151\165\153[\DC4\134",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\ETX)\224\148\161\DEL\177\145\SYN\ETX$\253_\148\204\248\GS\129.\182 \180,Z",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\202\&4(.\251\165[\160\186\189\138srVA",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),(" \228\227a",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\236D\151z\EM\252r",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropPayloadFormatIndicator
// 38,PropRequestProblemInformation 178,PropMaximumQoS 213,PropSharedSubscriptionAvailable 173,PropReceiveMaximum
// 32305,PropRetainAvailable 131,PropMaximumQoS 193,PropRequestProblemInformation 97,PropAssignedClientIdentifier
// "0\221\ESC\205\DEL\v.+\229Gy\222J~&\158\185\154/",PropResponseTopic
// "\154\143F\241\135\&8\220\t\181\151.",PropContentType "\161\181k",PropWildcardSubscriptionAvailable
// 178,PropServerReference
// "%E\159\209\235\146\nd\135\181\219\DEL\209\156]\159\216\242\255\204\v\159G\250L\v\142\171BZ",PropCorrelationData
// "\190\&6\\\201\224\141`\219\179\133^\212O\SI\b\EOT8"]
TEST(Subscribe5QCTest, Encode61) {
  uint8_t pkt[] = {
      0x82, 0x8e, 0x2,  0x31, 0x59, 0x72, 0x1,  0x26, 0x17, 0xb2, 0x24, 0xd5, 0x2a, 0xad, 0x21, 0x7e, 0x31, 0x25, 0x83,
      0x24, 0xc1, 0x17, 0x61, 0x12, 0x0,  0x13, 0x30, 0xdd, 0x1b, 0xcd, 0x7f, 0xb,  0x2e, 0x2b, 0xe5, 0x47, 0x79, 0xde,
      0x4a, 0x7e, 0x26, 0x9e, 0xb9, 0x9a, 0x2f, 0x8,  0x0,  0xb,  0x9a, 0x8f, 0x46, 0xf1, 0x87, 0x38, 0xdc, 0x9,  0xb5,
      0x97, 0x2e, 0x3,  0x0,  0x3,  0xa1, 0xb5, 0x6b, 0x28, 0xb2, 0x1c, 0x0,  0x1e, 0x25, 0x45, 0x9f, 0xd1, 0xeb, 0x92,
      0xa,  0x64, 0x87, 0xb5, 0xdb, 0x7f, 0xd1, 0x9c, 0x5d, 0x9f, 0xd8, 0xf2, 0xff, 0xcc, 0xb,  0x9f, 0x47, 0xfa, 0x4c,
      0xb,  0x8e, 0xab, 0x42, 0x5a, 0x9,  0x0,  0x11, 0xbe, 0x36, 0x5c, 0xc9, 0xe0, 0x8d, 0x60, 0xdb, 0xb3, 0x85, 0x5e,
      0xd4, 0x4f, 0xf,  0x8,  0x4,  0x38, 0x0,  0x0,  0x0,  0x0,  0xd,  0x8e, 0xf1, 0xcc, 0x8a, 0x2c, 0xae, 0x83, 0x95,
      0xc7, 0xa0, 0x6f, 0xcd, 0x92, 0x0,  0x0,  0xf,  0x72, 0x92, 0xf2, 0x84, 0x11, 0xd4, 0xfc, 0x3,  0x13, 0xc0, 0xc3,
      0x33, 0xa9, 0xe7, 0x21, 0x1,  0x0,  0x14, 0xe1, 0xee, 0x70, 0xdf, 0x87, 0x72, 0x4a, 0x86, 0x27, 0x17, 0x7f, 0x89,
      0x83, 0x0,  0xdf, 0x68, 0x14, 0xab, 0x1b, 0xf8, 0x0,  0x0,  0xc,  0x6c, 0x31, 0xb9, 0x8b, 0x61, 0xd9, 0x7f, 0x37,
      0x3f, 0xd,  0x19, 0x3f, 0x2,  0x0,  0xd,  0x3f, 0x3c, 0x43, 0x45, 0xc3, 0xab, 0x93, 0x97, 0xa5, 0x99, 0x5b, 0x14,
      0x86, 0x1,  0x0,  0x18, 0x3,  0x29, 0xe0, 0x94, 0xa1, 0x7f, 0xb1, 0x91, 0x16, 0x3,  0x24, 0xfd, 0x5f, 0x94, 0xcc,
      0xf8, 0x1d, 0x81, 0x2e, 0xb6, 0x20, 0xb4, 0x2c, 0x5a, 0x2,  0x0,  0xf,  0xca, 0x34, 0x28, 0x2e, 0xfb, 0xa5, 0x5b,
      0xa0, 0xba, 0xbd, 0x8a, 0x73, 0x72, 0x56, 0x41, 0x0,  0x0,  0x4,  0x20, 0xe4, 0xe3, 0x61, 0x0,  0x0,  0x7,  0xec,
      0x44, 0x97, 0x7a, 0x19, 0xfc, 0x72, 0x2};

  uint8_t buf[283] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8e, 0xf1, 0xcc, 0x8a, 0x2c, 0xae, 0x83, 0x95, 0xc7, 0xa0, 0x6f, 0xcd, 0x92};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x72, 0x92, 0xf2, 0x84, 0x11, 0xd4, 0xfc, 0x3,
                                     0x13, 0xc0, 0xc3, 0x33, 0xa9, 0xe7, 0x21};
  lwmqtt_string_t topic_filter_s2 = {15, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xe1, 0xee, 0x70, 0xdf, 0x87, 0x72, 0x4a, 0x86, 0x27, 0x17,
                                     0x7f, 0x89, 0x83, 0x0,  0xdf, 0x68, 0x14, 0xab, 0x1b, 0xf8};
  lwmqtt_string_t topic_filter_s3 = {20, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6c, 0x31, 0xb9, 0x8b, 0x61, 0xd9, 0x7f, 0x37, 0x3f, 0xd, 0x19, 0x3f};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x3f, 0x3c, 0x43, 0x45, 0xc3, 0xab, 0x93, 0x97, 0xa5, 0x99, 0x5b, 0x14, 0x86};
  lwmqtt_string_t topic_filter_s5 = {13, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3,  0x29, 0xe0, 0x94, 0xa1, 0x7f, 0xb1, 0x91, 0x16, 0x3,  0x24, 0xfd,
                                     0x5f, 0x94, 0xcc, 0xf8, 0x1d, 0x81, 0x2e, 0xb6, 0x20, 0xb4, 0x2c, 0x5a};
  lwmqtt_string_t topic_filter_s6 = {24, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xca, 0x34, 0x28, 0x2e, 0xfb, 0xa5, 0x5b, 0xa0,
                                     0xba, 0xbd, 0x8a, 0x73, 0x72, 0x56, 0x41};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x20, 0xe4, 0xe3, 0x61};
  lwmqtt_string_t topic_filter_s8 = {4, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xec, 0x44, 0x97, 0x7a, 0x19, 0xfc, 0x72};
  lwmqtt_string_t topic_filter_s9 = {7, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x30, 0xdd, 0x1b, 0xcd, 0x7f, 0xb,  0x2e, 0x2b, 0xe5, 0x47,
                           0x79, 0xde, 0x4a, 0x7e, 0x26, 0x9e, 0xb9, 0x9a, 0x2f};
  uint8_t bytesprops1[] = {0x9a, 0x8f, 0x46, 0xf1, 0x87, 0x38, 0xdc, 0x9, 0xb5, 0x97, 0x2e};
  uint8_t bytesprops2[] = {0xa1, 0xb5, 0x6b};
  uint8_t bytesprops3[] = {0x25, 0x45, 0x9f, 0xd1, 0xeb, 0x92, 0xa,  0x64, 0x87, 0xb5, 0xdb, 0x7f, 0xd1, 0x9c, 0x5d,
                           0x9f, 0xd8, 0xf2, 0xff, 0xcc, 0xb,  0x9f, 0x47, 0xfa, 0x4c, 0xb,  0x8e, 0xab, 0x42, 0x5a};
  uint8_t bytesprops4[] = {0xbe, 0x36, 0x5c, 0xc9, 0xe0, 0x8d, 0x60, 0xdb, 0xb3,
                           0x85, 0x5e, 0xd4, 0x4f, 0xf,  0x8,  0x4,  0x38};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 38}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 178}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 173}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 32305}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 193}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 97}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {11, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {3, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 178}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {17, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12633, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 21642 [("\217\193\146\133\233\237\&84\STX|9\SI^",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("!\191\250T>\226!\129{\254Q",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\FSG=\NUL",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\142gv\133\156\SYN\162\216C",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\152\212\158(t\138F\128{&?'-\194\239p\DC2H\132\131\SYNd\169\128\215\NAKa\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\179\212\228\145\130\161\198\&5\236H\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("\196\&6?\162\212TA\205\USkt\b\208",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropRequestResponseInformation
// 215,PropResponseInformation "\238w\DC3_W$!\151P1\237xy\158\140!~~\EMl\240",PropAuthenticationMethod
// "'\151b\\\162\166\174\GSV\248>\144",PropRetainAvailable 182,PropRetainAvailable 38,PropCorrelationData
// "2\148\238\164i\145\156(\245U\SO"]
TEST(Subscribe5QCTest, Encode62) {
  uint8_t pkt[] = {0x82, 0xac, 0x1,  0x54, 0x8a, 0x3b, 0x19, 0xd7, 0x1a, 0x0,  0x15, 0xee, 0x77, 0x13, 0x5f, 0x57,
                   0x24, 0x21, 0x97, 0x50, 0x31, 0xed, 0x78, 0x79, 0x9e, 0x8c, 0x21, 0x7e, 0x7e, 0x19, 0x6c, 0xf0,
                   0x15, 0x0,  0xc,  0x27, 0x97, 0x62, 0x5c, 0xa2, 0xa6, 0xae, 0x1d, 0x56, 0xf8, 0x3e, 0x90, 0x25,
                   0xb6, 0x25, 0x26, 0x9,  0x0,  0xb,  0x32, 0x94, 0xee, 0xa4, 0x69, 0x91, 0x9c, 0x28, 0xf5, 0x55,
                   0xe,  0x0,  0xd,  0xd9, 0xc1, 0x92, 0x85, 0xe9, 0xed, 0x38, 0x34, 0x2,  0x7c, 0x39, 0xf,  0x5e,
                   0x1,  0x0,  0xb,  0x21, 0xbf, 0xfa, 0x54, 0x3e, 0xe2, 0x21, 0x81, 0x7b, 0xfe, 0x51, 0x1,  0x0,
                   0x4,  0x1c, 0x47, 0x3d, 0x0,  0x1,  0x0,  0x9,  0x8e, 0x67, 0x76, 0x85, 0x9c, 0x16, 0xa2, 0xd8,
                   0x43, 0x1,  0x0,  0x1c, 0x98, 0xd4, 0x9e, 0x28, 0x74, 0x8a, 0x46, 0x80, 0x7b, 0x26, 0x3f, 0x27,
                   0x2d, 0xc2, 0xef, 0x70, 0x12, 0x48, 0x84, 0x83, 0x16, 0x64, 0xa9, 0x80, 0xd7, 0x15, 0x61, 0xd9,
                   0x2,  0x0,  0xb,  0xb3, 0xd4, 0xe4, 0x91, 0x82, 0xa1, 0xc6, 0x35, 0xec, 0x48, 0x98, 0x0,  0x0,
                   0xd,  0xc4, 0x36, 0x3f, 0xa2, 0xd4, 0x54, 0x41, 0xcd, 0x1f, 0x6b, 0x74, 0x8,  0xd0, 0x2};

  uint8_t buf[185] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xd9, 0xc1, 0x92, 0x85, 0xe9, 0xed, 0x38, 0x34, 0x2, 0x7c, 0x39, 0xf, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x21, 0xbf, 0xfa, 0x54, 0x3e, 0xe2, 0x21, 0x81, 0x7b, 0xfe, 0x51};
  lwmqtt_string_t topic_filter_s1 = {11, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x1c, 0x47, 0x3d, 0x0};
  lwmqtt_string_t topic_filter_s2 = {4, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8e, 0x67, 0x76, 0x85, 0x9c, 0x16, 0xa2, 0xd8, 0x43};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x98, 0xd4, 0x9e, 0x28, 0x74, 0x8a, 0x46, 0x80, 0x7b, 0x26,
                                     0x3f, 0x27, 0x2d, 0xc2, 0xef, 0x70, 0x12, 0x48, 0x84, 0x83,
                                     0x16, 0x64, 0xa9, 0x80, 0xd7, 0x15, 0x61, 0xd9};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xb3, 0xd4, 0xe4, 0x91, 0x82, 0xa1, 0xc6, 0x35, 0xec, 0x48, 0x98};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xc4, 0x36, 0x3f, 0xa2, 0xd4, 0x54, 0x41, 0xcd, 0x1f, 0x6b, 0x74, 0x8, 0xd0};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0xee, 0x77, 0x13, 0x5f, 0x57, 0x24, 0x21, 0x97, 0x50, 0x31, 0xed,
                           0x78, 0x79, 0x9e, 0x8c, 0x21, 0x7e, 0x7e, 0x19, 0x6c, 0xf0};
  uint8_t bytesprops1[] = {0x27, 0x97, 0x62, 0x5c, 0xa2, 0xa6, 0xae, 0x1d, 0x56, 0xf8, 0x3e, 0x90};
  uint8_t bytesprops2[] = {0x32, 0x94, 0xee, 0xa4, 0x69, 0x91, 0x9c, 0x28, 0xf5, 0x55, 0xe};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 215}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {21, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 182}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 38}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {11, (char*)&bytesprops2}}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 21642, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 17671 [("u\219]\165\215\137\250\193O\129\136\181\180\tG@\188t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\250\141\FS\155\a\192Q}\186\203\ACK\DEL\246\233\SUB\206\&2/\240\137\189'F$\189dq\159\142h",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\SYN\189~\178VN\200\201\v\165\218\230\166\ETB",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("L\136+\152\143",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\139\202\184\152g\f\231`",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] [PropResponseInformation
// "\146V\195\218\217\DC4H\209q\GS",PropPayloadFormatIndicator 34,PropContentType
// "6\a0\fVG^\148\132\138.\137\220\DC4\187\"=\188.",PropSubscriptionIdentifierAvailable 205,PropResponseTopic
// "\180\154\201r7N\146\195\"\175\198A)\171\250\155\133\t\228J\STX\172[\172",PropAssignedClientIdentifier
// "",PropServerKeepAlive 12008,PropReasonString "\198S\163,(\242\243",PropAuthenticationData
// "\253\131\189\&2\190*\208\DC4\DC2\149\220\184",PropSubscriptionIdentifier 28,PropRequestResponseInformation
// 174,PropCorrelationData "j\DLE\152\248\171'Y\147\DEL\233 \139\196\253b?\"\r\FS\191\163\159y"]
TEST(Subscribe5QCTest, Encode63) {
  uint8_t pkt[] = {0x82, 0xe3, 0x1,  0x45, 0x7,  0x7f, 0x1a, 0x0,  0xa,  0x92, 0x56, 0xc3, 0xda, 0xd9, 0x14, 0x48, 0xd1,
                   0x71, 0x1d, 0x1,  0x22, 0x3,  0x0,  0x13, 0x36, 0x7,  0x30, 0xc,  0x56, 0x47, 0x5e, 0x94, 0x84, 0x8a,
                   0x2e, 0x89, 0xdc, 0x14, 0xbb, 0x22, 0x3d, 0xbc, 0x2e, 0x29, 0xcd, 0x8,  0x0,  0x18, 0xb4, 0x9a, 0xc9,
                   0x72, 0x37, 0x4e, 0x92, 0xc3, 0x22, 0xaf, 0xc6, 0x41, 0x29, 0xab, 0xfa, 0x9b, 0x85, 0x9,  0xe4, 0x4a,
                   0x2,  0xac, 0x5b, 0xac, 0x12, 0x0,  0x0,  0x13, 0x2e, 0xe8, 0x1f, 0x0,  0x7,  0xc6, 0x53, 0xa3, 0x2c,
                   0x28, 0xf2, 0xf3, 0x16, 0x0,  0xc,  0xfd, 0x83, 0xbd, 0x32, 0xbe, 0x2a, 0xd0, 0x14, 0x12, 0x95, 0xdc,
                   0xb8, 0xb,  0x1c, 0x19, 0xae, 0x9,  0x0,  0x17, 0x6a, 0x10, 0x98, 0xf8, 0xab, 0x27, 0x59, 0x93, 0x7f,
                   0xe9, 0x20, 0x8b, 0xc4, 0xfd, 0x62, 0x3f, 0x22, 0xd,  0x1c, 0xbf, 0xa3, 0x9f, 0x79, 0x0,  0x12, 0x75,
                   0xdb, 0x5d, 0xa5, 0xd7, 0x89, 0xfa, 0xc1, 0x4f, 0x81, 0x88, 0xb5, 0xb4, 0x9,  0x47, 0x40, 0xbc, 0x74,
                   0x1,  0x0,  0x0,  0x1,  0x0,  0x1e, 0xfa, 0x8d, 0x1c, 0x9b, 0x7,  0xc0, 0x51, 0x7d, 0xba, 0xcb, 0x6,
                   0x7f, 0xf6, 0xe9, 0x1a, 0xce, 0x32, 0x2f, 0xf0, 0x89, 0xbd, 0x27, 0x46, 0x24, 0xbd, 0x64, 0x71, 0x9f,
                   0x8e, 0x68, 0x0,  0x0,  0xe,  0x16, 0xbd, 0x7e, 0xb2, 0x56, 0x4e, 0xc8, 0xc9, 0xb,  0xa5, 0xda, 0xe6,
                   0xa6, 0x17, 0x1,  0x0,  0x5,  0x4c, 0x88, 0x2b, 0x98, 0x8f, 0x2,  0x0,  0x8,  0x8b, 0xca, 0xb8, 0x98,
                   0x67, 0xc,  0xe7, 0x60, 0x1,  0x0,  0x1,  0x5c, 0x2};

  uint8_t buf[240] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x75, 0xdb, 0x5d, 0xa5, 0xd7, 0x89, 0xfa, 0xc1, 0x4f,
                                     0x81, 0x88, 0xb5, 0xb4, 0x9,  0x47, 0x40, 0xbc, 0x74};
  lwmqtt_string_t topic_filter_s0 = {18, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xfa, 0x8d, 0x1c, 0x9b, 0x7,  0xc0, 0x51, 0x7d, 0xba, 0xcb,
                                     0x6,  0x7f, 0xf6, 0xe9, 0x1a, 0xce, 0x32, 0x2f, 0xf0, 0x89,
                                     0xbd, 0x27, 0x46, 0x24, 0xbd, 0x64, 0x71, 0x9f, 0x8e, 0x68};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x16, 0xbd, 0x7e, 0xb2, 0x56, 0x4e, 0xc8, 0xc9, 0xb, 0xa5, 0xda, 0xe6, 0xa6, 0x17};
  lwmqtt_string_t topic_filter_s3 = {14, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x4c, 0x88, 0x2b, 0x98, 0x8f};
  lwmqtt_string_t topic_filter_s4 = {5, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x8b, 0xca, 0xb8, 0x98, 0x67, 0xc, 0xe7, 0x60};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x5c};
  lwmqtt_string_t topic_filter_s6 = {1, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x92, 0x56, 0xc3, 0xda, 0xd9, 0x14, 0x48, 0xd1, 0x71, 0x1d};
  uint8_t bytesprops1[] = {0x36, 0x7,  0x30, 0xc,  0x56, 0x47, 0x5e, 0x94, 0x84, 0x8a,
                           0x2e, 0x89, 0xdc, 0x14, 0xbb, 0x22, 0x3d, 0xbc, 0x2e};
  uint8_t bytesprops2[] = {0xb4, 0x9a, 0xc9, 0x72, 0x37, 0x4e, 0x92, 0xc3, 0x22, 0xaf, 0xc6, 0x41,
                           0x29, 0xab, 0xfa, 0x9b, 0x85, 0x9,  0xe4, 0x4a, 0x2,  0xac, 0x5b, 0xac};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0xc6, 0x53, 0xa3, 0x2c, 0x28, 0xf2, 0xf3};
  uint8_t bytesprops5[] = {0xfd, 0x83, 0xbd, 0x32, 0xbe, 0x2a, 0xd0, 0x14, 0x12, 0x95, 0xdc, 0xb8};
  uint8_t bytesprops6[] = {0x6a, 0x10, 0x98, 0xf8, 0xab, 0x27, 0x59, 0x93, 0x7f, 0xe9, 0x20, 0x8b,
                           0xc4, 0xfd, 0x62, 0x3f, 0x22, 0xd,  0x1c, 0xbf, 0xa3, 0x9f, 0x79};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 34}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {19, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 205}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {24, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 12008}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {7, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 28}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 174}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {23, (char*)&bytesprops6}}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 17671, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 18903 [("\245\147\176",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("sQ\169h\ACK\237\155\fg\232\206\138",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropSubscriptionIdentifier
// 7,PropTopicAliasMaximum 1496,PropResponseInformation "]\177\198?\210\a",PropRetainAvailable
// 103,PropMessageExpiryInterval 4264,PropMaximumPacketSize 17108,PropSessionExpiryInterval
// 13290,PropAuthenticationMethod "\139\169\181\186(]\220\a",PropAuthenticationMethod
// "\251vk\EM<8\157\SYN\172\&2\185\171\143\228\243\&0r\132B\251\&26\151\217-\225",PropContentType
// "X\147\161u\230\184\171\226\184[S\b\129ru\234\138\169",PropResponseTopic "\214*\r\155\154",PropServerKeepAlive
// 21747,PropMaximumPacketSize 31882,PropMessageExpiryInterval 2727,PropReasonString
// ":\193#\154|(8\182\185!\v0\240\148\147R\248C\146\205\US\STX\168\247\205\242\243\179",PropReasonString
// "\246\157'\205\&1\ETBS",PropWildcardSubscriptionAvailable 213,PropRetainAvailable
// 20,PropSubscriptionIdentifierAvailable 73,PropAssignedClientIdentifier
// "\ENQ.\158\SOHZK\228\173\138\202d&3\249\219\233*\229b:\236\DLE\CANQ\232\211DS",PropReasonString
// "y\209l\SO\152\198y/\132\251\251~\t\DC2\246\ETX<Wl\228\152\172",PropPayloadFormatIndicator
// 166,PropAssignedClientIdentifier
// "\130L]*\132\161;)?'\207`\184+'\ENQ\135d\246\155\243\fv\141\157\240\NAK\SYN\t\188",PropContentType
// "\194\235\215\201\233\150\212\249A\188\208\163~\174'\182\ACKg7\140+!\233\183\141\190\191-",PropServerKeepAlive
// 6005,PropAssignedClientIdentifier "$\146\232!\172",PropAuthenticationMethod "\255\EMRAie\242+\213",PropMaximumQoS
// 136]
TEST(Subscribe5QCTest, Encode64) {
  uint8_t pkt[] = {
      0x82, 0xcc, 0x2,  0x49, 0xd7, 0xb3, 0x2,  0xb,  0x7,  0x22, 0x5,  0xd8, 0x1a, 0x0,  0x6,  0x5d, 0xb1, 0xc6, 0x3f,
      0xd2, 0x7,  0x25, 0x67, 0x2,  0x0,  0x0,  0x10, 0xa8, 0x27, 0x0,  0x0,  0x42, 0xd4, 0x11, 0x0,  0x0,  0x33, 0xea,
      0x15, 0x0,  0x8,  0x8b, 0xa9, 0xb5, 0xba, 0x28, 0x5d, 0xdc, 0x7,  0x15, 0x0,  0x1a, 0xfb, 0x76, 0x6b, 0x19, 0x3c,
      0x38, 0x9d, 0x16, 0xac, 0x32, 0xb9, 0xab, 0x8f, 0xe4, 0xf3, 0x30, 0x72, 0x84, 0x42, 0xfb, 0x32, 0x36, 0x97, 0xd9,
      0x2d, 0xe1, 0x3,  0x0,  0x12, 0x58, 0x93, 0xa1, 0x75, 0xe6, 0xb8, 0xab, 0xe2, 0xb8, 0x5b, 0x53, 0x8,  0x81, 0x72,
      0x75, 0xea, 0x8a, 0xa9, 0x8,  0x0,  0x5,  0xd6, 0x2a, 0xd,  0x9b, 0x9a, 0x13, 0x54, 0xf3, 0x27, 0x0,  0x0,  0x7c,
      0x8a, 0x2,  0x0,  0x0,  0xa,  0xa7, 0x1f, 0x0,  0x1c, 0x3a, 0xc1, 0x23, 0x9a, 0x7c, 0x28, 0x38, 0xb6, 0xb9, 0x21,
      0xb,  0x30, 0xf0, 0x94, 0x93, 0x52, 0xf8, 0x43, 0x92, 0xcd, 0x1f, 0x2,  0xa8, 0xf7, 0xcd, 0xf2, 0xf3, 0xb3, 0x1f,
      0x0,  0x7,  0xf6, 0x9d, 0x27, 0xcd, 0x31, 0x17, 0x53, 0x28, 0xd5, 0x25, 0x14, 0x29, 0x49, 0x12, 0x0,  0x1c, 0x5,
      0x2e, 0x9e, 0x1,  0x5a, 0x4b, 0xe4, 0xad, 0x8a, 0xca, 0x64, 0x26, 0x33, 0xf9, 0xdb, 0xe9, 0x2a, 0xe5, 0x62, 0x3a,
      0xec, 0x10, 0x18, 0x51, 0xe8, 0xd3, 0x44, 0x53, 0x1f, 0x0,  0x16, 0x79, 0xd1, 0x6c, 0xe,  0x98, 0xc6, 0x79, 0x2f,
      0x84, 0xfb, 0xfb, 0x7e, 0x9,  0x12, 0xf6, 0x3,  0x3c, 0x57, 0x6c, 0xe4, 0x98, 0xac, 0x1,  0xa6, 0x12, 0x0,  0x1e,
      0x82, 0x4c, 0x5d, 0x2a, 0x84, 0xa1, 0x3b, 0x29, 0x3f, 0x27, 0xcf, 0x60, 0xb8, 0x2b, 0x27, 0x5,  0x87, 0x64, 0xf6,
      0x9b, 0xf3, 0xc,  0x76, 0x8d, 0x9d, 0xf0, 0x15, 0x16, 0x9,  0xbc, 0x3,  0x0,  0x1c, 0xc2, 0xeb, 0xd7, 0xc9, 0xe9,
      0x96, 0xd4, 0xf9, 0x41, 0xbc, 0xd0, 0xa3, 0x7e, 0xae, 0x27, 0xb6, 0x6,  0x67, 0x37, 0x8c, 0x2b, 0x21, 0xe9, 0xb7,
      0x8d, 0xbe, 0xbf, 0x2d, 0x13, 0x17, 0x75, 0x12, 0x0,  0x5,  0x24, 0x92, 0xe8, 0x21, 0xac, 0x15, 0x0,  0x9,  0xff,
      0x19, 0x52, 0x41, 0x69, 0x65, 0xf2, 0x2b, 0xd5, 0x24, 0x88, 0x0,  0x3,  0xf5, 0x93, 0xb0, 0x0,  0x0,  0xc,  0x73,
      0x51, 0xa9, 0x68, 0x6,  0xed, 0x9b, 0xc,  0x67, 0xe8, 0xce, 0x8a, 0x2};

  uint8_t buf[345] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xf5, 0x93, 0xb0};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x73, 0x51, 0xa9, 0x68, 0x6, 0xed, 0x9b, 0xc, 0x67, 0xe8, 0xce, 0x8a};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x5d, 0xb1, 0xc6, 0x3f, 0xd2, 0x7};
  uint8_t bytesprops1[] = {0x8b, 0xa9, 0xb5, 0xba, 0x28, 0x5d, 0xdc, 0x7};
  uint8_t bytesprops2[] = {0xfb, 0x76, 0x6b, 0x19, 0x3c, 0x38, 0x9d, 0x16, 0xac, 0x32, 0xb9, 0xab, 0x8f,
                           0xe4, 0xf3, 0x30, 0x72, 0x84, 0x42, 0xfb, 0x32, 0x36, 0x97, 0xd9, 0x2d, 0xe1};
  uint8_t bytesprops3[] = {0x58, 0x93, 0xa1, 0x75, 0xe6, 0xb8, 0xab, 0xe2, 0xb8,
                           0x5b, 0x53, 0x8,  0x81, 0x72, 0x75, 0xea, 0x8a, 0xa9};
  uint8_t bytesprops4[] = {0xd6, 0x2a, 0xd, 0x9b, 0x9a};
  uint8_t bytesprops5[] = {0x3a, 0xc1, 0x23, 0x9a, 0x7c, 0x28, 0x38, 0xb6, 0xb9, 0x21, 0xb,  0x30, 0xf0, 0x94,
                           0x93, 0x52, 0xf8, 0x43, 0x92, 0xcd, 0x1f, 0x2,  0xa8, 0xf7, 0xcd, 0xf2, 0xf3, 0xb3};
  uint8_t bytesprops6[] = {0xf6, 0x9d, 0x27, 0xcd, 0x31, 0x17, 0x53};
  uint8_t bytesprops7[] = {0x5,  0x2e, 0x9e, 0x1,  0x5a, 0x4b, 0xe4, 0xad, 0x8a, 0xca, 0x64, 0x26, 0x33, 0xf9,
                           0xdb, 0xe9, 0x2a, 0xe5, 0x62, 0x3a, 0xec, 0x10, 0x18, 0x51, 0xe8, 0xd3, 0x44, 0x53};
  uint8_t bytesprops8[] = {0x79, 0xd1, 0x6c, 0xe,  0x98, 0xc6, 0x79, 0x2f, 0x84, 0xfb, 0xfb,
                           0x7e, 0x9,  0x12, 0xf6, 0x3,  0x3c, 0x57, 0x6c, 0xe4, 0x98, 0xac};
  uint8_t bytesprops9[] = {0x82, 0x4c, 0x5d, 0x2a, 0x84, 0xa1, 0x3b, 0x29, 0x3f, 0x27, 0xcf, 0x60, 0xb8, 0x2b, 0x27,
                           0x5,  0x87, 0x64, 0xf6, 0x9b, 0xf3, 0xc,  0x76, 0x8d, 0x9d, 0xf0, 0x15, 0x16, 0x9,  0xbc};
  uint8_t bytesprops10[] = {0xc2, 0xeb, 0xd7, 0xc9, 0xe9, 0x96, 0xd4, 0xf9, 0x41, 0xbc, 0xd0, 0xa3, 0x7e, 0xae,
                            0x27, 0xb6, 0x6,  0x67, 0x37, 0x8c, 0x2b, 0x21, 0xe9, 0xb7, 0x8d, 0xbe, 0xbf, 0x2d};
  uint8_t bytesprops11[] = {0x24, 0x92, 0xe8, 0x21, 0xac};
  uint8_t bytesprops12[] = {0xff, 0x19, 0x52, 0x41, 0x69, 0x65, 0xf2, 0x2b, 0xd5};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 7}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1496}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 103}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 4264}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 17108}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 13290}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {8, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 21747}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 31882}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 2727}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {28, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {7, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 213}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 20}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 73}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {28, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 166}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {30, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {28, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 6005}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {5, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {9, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 136}},
  };

  lwmqtt_properties_t props = {28, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 18903, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 187 [("5>j",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("\134/\US\STX\249\130\n\159\"\235\ETB\FS\163\USR\194\156d>\213\144=\161/*'\231\"",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\DEL\250Oc\141\225\&8\234B\179",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\141\218\241\136\246\183d\251\&3\182\235#\208\bPH\170Y\194",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\215N",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("}'\141;\170\&26H\213Yh\130\RS\178\DLEuL\155\134\229\210\138\DLEi\GS~S",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\220\&6\DC2a\245\161\nd\210\tR\238\159Z1\236\207\215\181\204\ACKb}\252\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("f<B\131\\\216\160\251em2\245\DEL\243y\216|\157\129\231?\192+\219",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193g\214v\STX\187\231\254\172\&3\181\235\228H\158\160\231\r4\177",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("6\b^\ETX\173\159C+\NUL)C",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] [PropCorrelationData
// "\139\240\GS\245<\225DC\ACK\203\SI\249A\143V\184\139\US",PropUserProperty "n\240a\EOT,\208\172Z\135\162\SO\187p"
// "=\227\&4\195u",PropPayloadFormatIndicator 106,PropMaximumPacketSize 16815,PropMaximumQoS 65,PropUserProperty
// "\DC4.\185s\160\&4l1\ENQ\ETB\GS\225\EOTeE\DC4\190\166\175\242\167" "i\151\v.\204I\223\&4\NUL\202",PropMaximumQoS
// 149,PropResponseTopic
// "\250\174\198i\ETX\221&\228q$\245\&7w\ETX_\193\197\168A\141\253Xd\142\244+\226\146\226",PropTopicAliasMaximum
// 3041,PropServerReference ";]{S9\137",PropReasonString
// "\172\196\169\167\DELmW$\EM\194t\225ls\230\137\150:LXa@\135",PropWillDelayInterval 21047,PropRetainAvailable
// 243,PropSubscriptionIdentifier 19,PropResponseInformation
// "w\147%%\223\157\150e\222\142/)[\223\SYN\188\237\US\243",PropMessageExpiryInterval 24681,PropTopicAliasMaximum
// 28483,PropReceiveMaximum 3302,PropMaximumQoS 140,PropUserProperty
// "\242\213w00\162<\245\251\179\NULa\207\213\EM\241\135"
// "\191a\193\213\142v\158p\USt\161!\147\154W\150\STX\140vC\173^C\227\223\&3\211\240",PropAuthenticationData
// "\253\135Q\144\132&\143\206\150\US\252\186\209",PropRequestProblemInformation 98,PropServerKeepAlive
// 26683,PropServerKeepAlive 11828,PropResponseTopic "",PropSessionExpiryInterval 28144,PropTopicAliasMaximum
// 9374,PropAuthenticationMethod "h\SYN*\153\ETX\163\164\210\167\"\DC2\223"]
TEST(Subscribe5QCTest, Encode65) {
  uint8_t pkt[] = {
      0x82, 0xfc, 0x3,  0x0,  0xbb, 0xb1, 0x2,  0x9,  0x0,  0x12, 0x8b, 0xf0, 0x1d, 0xf5, 0x3c, 0xe1, 0x44, 0x43, 0x6,
      0xcb, 0xf,  0xf9, 0x41, 0x8f, 0x56, 0xb8, 0x8b, 0x1f, 0x26, 0x0,  0xd,  0x6e, 0xf0, 0x61, 0x4,  0x2c, 0xd0, 0xac,
      0x5a, 0x87, 0xa2, 0xe,  0xbb, 0x70, 0x0,  0x5,  0x3d, 0xe3, 0x34, 0xc3, 0x75, 0x1,  0x6a, 0x27, 0x0,  0x0,  0x41,
      0xaf, 0x24, 0x41, 0x26, 0x0,  0x15, 0x14, 0x2e, 0xb9, 0x73, 0xa0, 0x34, 0x6c, 0x31, 0x5,  0x17, 0x1d, 0xe1, 0x4,
      0x65, 0x45, 0x14, 0xbe, 0xa6, 0xaf, 0xf2, 0xa7, 0x0,  0xa,  0x69, 0x97, 0xb,  0x2e, 0xcc, 0x49, 0xdf, 0x34, 0x0,
      0xca, 0x24, 0x95, 0x8,  0x0,  0x1d, 0xfa, 0xae, 0xc6, 0x69, 0x3,  0xdd, 0x26, 0xe4, 0x71, 0x24, 0xf5, 0x37, 0x77,
      0x3,  0x5f, 0xc1, 0xc5, 0xa8, 0x41, 0x8d, 0xfd, 0x58, 0x64, 0x8e, 0xf4, 0x2b, 0xe2, 0x92, 0xe2, 0x22, 0xb,  0xe1,
      0x1c, 0x0,  0x6,  0x3b, 0x5d, 0x7b, 0x53, 0x39, 0x89, 0x1f, 0x0,  0x17, 0xac, 0xc4, 0xa9, 0xa7, 0x7f, 0x6d, 0x57,
      0x24, 0x19, 0xc2, 0x74, 0xe1, 0x6c, 0x73, 0xe6, 0x89, 0x96, 0x3a, 0x4c, 0x58, 0x61, 0x40, 0x87, 0x18, 0x0,  0x0,
      0x52, 0x37, 0x25, 0xf3, 0xb,  0x13, 0x1a, 0x0,  0x13, 0x77, 0x93, 0x25, 0x25, 0xdf, 0x9d, 0x96, 0x65, 0xde, 0x8e,
      0x2f, 0x29, 0x5b, 0xdf, 0x16, 0xbc, 0xed, 0x1f, 0xf3, 0x2,  0x0,  0x0,  0x60, 0x69, 0x22, 0x6f, 0x43, 0x21, 0xc,
      0xe6, 0x24, 0x8c, 0x26, 0x0,  0x11, 0xf2, 0xd5, 0x77, 0x30, 0x30, 0xa2, 0x3c, 0xf5, 0xfb, 0xb3, 0x0,  0x61, 0xcf,
      0xd5, 0x19, 0xf1, 0x87, 0x0,  0x1c, 0xbf, 0x61, 0xc1, 0xd5, 0x8e, 0x76, 0x9e, 0x70, 0x1f, 0x74, 0xa1, 0x21, 0x93,
      0x9a, 0x57, 0x96, 0x2,  0x8c, 0x76, 0x43, 0xad, 0x5e, 0x43, 0xe3, 0xdf, 0x33, 0xd3, 0xf0, 0x16, 0x0,  0xd,  0xfd,
      0x87, 0x51, 0x90, 0x84, 0x26, 0x8f, 0xce, 0x96, 0x1f, 0xfc, 0xba, 0xd1, 0x17, 0x62, 0x13, 0x68, 0x3b, 0x13, 0x2e,
      0x34, 0x8,  0x0,  0x0,  0x11, 0x0,  0x0,  0x6d, 0xf0, 0x22, 0x24, 0x9e, 0x15, 0x0,  0xc,  0x68, 0x16, 0x2a, 0x99,
      0x3,  0xa3, 0xa4, 0xd2, 0xa7, 0x22, 0x12, 0xdf, 0x0,  0x3,  0x35, 0x3e, 0x6a, 0x1,  0x0,  0x1c, 0x86, 0x2f, 0x1f,
      0x2,  0xf9, 0x82, 0xa,  0x9f, 0x22, 0xeb, 0x17, 0x1c, 0xa3, 0x1f, 0x52, 0xc2, 0x9c, 0x64, 0x3e, 0xd5, 0x90, 0x3d,
      0xa1, 0x2f, 0x2a, 0x27, 0xe7, 0x22, 0x1,  0x0,  0xa,  0x7f, 0xfa, 0x4f, 0x63, 0x8d, 0xe1, 0x38, 0xea, 0x42, 0xb3,
      0x0,  0x0,  0x13, 0x8d, 0xda, 0xf1, 0x88, 0xf6, 0xb7, 0x64, 0xfb, 0x33, 0xb6, 0xeb, 0x23, 0xd0, 0x8,  0x50, 0x48,
      0xaa, 0x59, 0xc2, 0x0,  0x0,  0x2,  0xd7, 0x4e, 0x1,  0x0,  0x1b, 0x7d, 0x27, 0x8d, 0x3b, 0xaa, 0x32, 0x36, 0x48,
      0xd5, 0x59, 0x68, 0x82, 0x1e, 0xb2, 0x10, 0x75, 0x4c, 0x9b, 0x86, 0xe5, 0xd2, 0x8a, 0x10, 0x69, 0x1d, 0x7e, 0x53,
      0x1,  0x0,  0x19, 0xdc, 0x36, 0x12, 0x61, 0xf5, 0xa1, 0xa,  0x64, 0xd2, 0x9,  0x52, 0xee, 0x9f, 0x5a, 0x31, 0xec,
      0xcf, 0xd7, 0xb5, 0xcc, 0x6,  0x62, 0x7d, 0xfc, 0xd9, 0x1,  0x0,  0x18, 0x66, 0x3c, 0x42, 0x83, 0x5c, 0xd8, 0xa0,
      0xfb, 0x65, 0x6d, 0x32, 0xf5, 0x7f, 0xf3, 0x79, 0xd8, 0x7c, 0x9d, 0x81, 0xe7, 0x3f, 0xc0, 0x2b, 0xdb, 0x2,  0x0,
      0x14, 0xc1, 0x67, 0xd6, 0x76, 0x2,  0xbb, 0xe7, 0xfe, 0xac, 0x33, 0xb5, 0xeb, 0xe4, 0x48, 0x9e, 0xa0, 0xe7, 0xd,
      0x34, 0xb1, 0x2,  0x0,  0xb,  0x36, 0x8,  0x5e, 0x3,  0xad, 0x9f, 0x43, 0x2b, 0x0,  0x29, 0x43, 0x0};

  uint8_t buf[521] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x35, 0x3e, 0x6a};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86, 0x2f, 0x1f, 0x2,  0xf9, 0x82, 0xa,  0x9f, 0x22, 0xeb,
                                     0x17, 0x1c, 0xa3, 0x1f, 0x52, 0xc2, 0x9c, 0x64, 0x3e, 0xd5,
                                     0x90, 0x3d, 0xa1, 0x2f, 0x2a, 0x27, 0xe7, 0x22};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x7f, 0xfa, 0x4f, 0x63, 0x8d, 0xe1, 0x38, 0xea, 0x42, 0xb3};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8d, 0xda, 0xf1, 0x88, 0xf6, 0xb7, 0x64, 0xfb, 0x33, 0xb6,
                                     0xeb, 0x23, 0xd0, 0x8,  0x50, 0x48, 0xaa, 0x59, 0xc2};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd7, 0x4e};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x7d, 0x27, 0x8d, 0x3b, 0xaa, 0x32, 0x36, 0x48, 0xd5, 0x59, 0x68, 0x82, 0x1e, 0xb2,
                                     0x10, 0x75, 0x4c, 0x9b, 0x86, 0xe5, 0xd2, 0x8a, 0x10, 0x69, 0x1d, 0x7e, 0x53};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xdc, 0x36, 0x12, 0x61, 0xf5, 0xa1, 0xa,  0x64, 0xd2, 0x9,  0x52, 0xee, 0x9f,
                                     0x5a, 0x31, 0xec, 0xcf, 0xd7, 0xb5, 0xcc, 0x6,  0x62, 0x7d, 0xfc, 0xd9};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x66, 0x3c, 0x42, 0x83, 0x5c, 0xd8, 0xa0, 0xfb, 0x65, 0x6d, 0x32, 0xf5,
                                     0x7f, 0xf3, 0x79, 0xd8, 0x7c, 0x9d, 0x81, 0xe7, 0x3f, 0xc0, 0x2b, 0xdb};
  lwmqtt_string_t topic_filter_s7 = {24, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xc1, 0x67, 0xd6, 0x76, 0x2,  0xbb, 0xe7, 0xfe, 0xac, 0x33,
                                     0xb5, 0xeb, 0xe4, 0x48, 0x9e, 0xa0, 0xe7, 0xd,  0x34, 0xb1};
  lwmqtt_string_t topic_filter_s8 = {20, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x36, 0x8, 0x5e, 0x3, 0xad, 0x9f, 0x43, 0x2b, 0x0, 0x29, 0x43};
  lwmqtt_string_t topic_filter_s9 = {11, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x8b, 0xf0, 0x1d, 0xf5, 0x3c, 0xe1, 0x44, 0x43, 0x6,
                           0xcb, 0xf,  0xf9, 0x41, 0x8f, 0x56, 0xb8, 0x8b, 0x1f};
  uint8_t bytesprops2[] = {0x3d, 0xe3, 0x34, 0xc3, 0x75};
  uint8_t bytesprops1[] = {0x6e, 0xf0, 0x61, 0x4, 0x2c, 0xd0, 0xac, 0x5a, 0x87, 0xa2, 0xe, 0xbb, 0x70};
  uint8_t bytesprops4[] = {0x69, 0x97, 0xb, 0x2e, 0xcc, 0x49, 0xdf, 0x34, 0x0, 0xca};
  uint8_t bytesprops3[] = {0x14, 0x2e, 0xb9, 0x73, 0xa0, 0x34, 0x6c, 0x31, 0x5,  0x17, 0x1d,
                           0xe1, 0x4,  0x65, 0x45, 0x14, 0xbe, 0xa6, 0xaf, 0xf2, 0xa7};
  uint8_t bytesprops5[] = {0xfa, 0xae, 0xc6, 0x69, 0x3,  0xdd, 0x26, 0xe4, 0x71, 0x24, 0xf5, 0x37, 0x77, 0x3, 0x5f,
                           0xc1, 0xc5, 0xa8, 0x41, 0x8d, 0xfd, 0x58, 0x64, 0x8e, 0xf4, 0x2b, 0xe2, 0x92, 0xe2};
  uint8_t bytesprops6[] = {0x3b, 0x5d, 0x7b, 0x53, 0x39, 0x89};
  uint8_t bytesprops7[] = {0xac, 0xc4, 0xa9, 0xa7, 0x7f, 0x6d, 0x57, 0x24, 0x19, 0xc2, 0x74, 0xe1,
                           0x6c, 0x73, 0xe6, 0x89, 0x96, 0x3a, 0x4c, 0x58, 0x61, 0x40, 0x87};
  uint8_t bytesprops8[] = {0x77, 0x93, 0x25, 0x25, 0xdf, 0x9d, 0x96, 0x65, 0xde, 0x8e,
                           0x2f, 0x29, 0x5b, 0xdf, 0x16, 0xbc, 0xed, 0x1f, 0xf3};
  uint8_t bytesprops10[] = {0xbf, 0x61, 0xc1, 0xd5, 0x8e, 0x76, 0x9e, 0x70, 0x1f, 0x74, 0xa1, 0x21, 0x93, 0x9a,
                            0x57, 0x96, 0x2,  0x8c, 0x76, 0x43, 0xad, 0x5e, 0x43, 0xe3, 0xdf, 0x33, 0xd3, 0xf0};
  uint8_t bytesprops9[] = {0xf2, 0xd5, 0x77, 0x30, 0x30, 0xa2, 0x3c, 0xf5, 0xfb,
                           0xb3, 0x0,  0x61, 0xcf, 0xd5, 0x19, 0xf1, 0x87};
  uint8_t bytesprops11[] = {0xfd, 0x87, 0x51, 0x90, 0x84, 0x26, 0x8f, 0xce, 0x96, 0x1f, 0xfc, 0xba, 0xd1};
  uint8_t bytesprops12[] = {0};
  uint8_t bytesprops13[] = {0x68, 0x16, 0x2a, 0x99, 0x3, 0xa3, 0xa4, 0xd2, 0xa7, 0x22, 0x12, 0xdf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {18, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {13, (char*)&bytesprops1}, .v = {5, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 106}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 16815}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 65}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {21, (char*)&bytesprops3}, .v = {10, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 149}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 3041}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {23, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21047}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 243}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 19}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {19, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24681}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 28483}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3302}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 140}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {17, (char*)&bytesprops9}, .v = {28, (char*)&bytesprops10}}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {13, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 98}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 26683}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 11828}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {0, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28144}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 9374}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops13}}},
  };

  lwmqtt_properties_t props = {28, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 187, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4732 [("j\160\144\131\199\149\137\205\180
// 0\\\238'\v\239%\140y\130\166\DLEFW\196+/\SUB\175k",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS2}),("\165\208DR\186\164\169,\247\185\GS8.\251,j9\ENQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\236\&1\180e\159x\190{\ACKe\222\&5\150",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\169\ESC\164*w3X",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\136\v\137",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\243\193Mz&\151\240i\138\171=\222\226\169(\251\146\149k3\176t\206\161N~\165",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\177\209\242\173U\232\ETX*\217i\250\167Jh\240\SOH\210\230\EM\150z\205",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\183\189\159?,\251\246\DEL\FS$\134\134}",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] [PropResponseTopic
// "}\217C\199\144w\205\163\164\250*Q\r\188\136",PropMaximumPacketSize 2643,PropAssignedClientIdentifier
// "\240s\202\208\250[bc\132sP",PropSubscriptionIdentifier 8,PropUserProperty
// "\149m+\166\162}\n[o\252\169\151\168\DC2\DC4\217\184\149\149\US4\DC3\147\241\ACK"
// "\143$\195{\175\173~\149\249\184\234\134",PropTopicAlias 25146,PropSubscriptionIdentifier
// 25,PropRequestResponseInformation 97,PropRequestProblemInformation 217,PropContentType
// "X\255\141\\\194\155\FS\160\DC4\130ZY\223N\SO~\236\206TX\135\SI\DC29",PropSubscriptionIdentifierAvailable
// 16,PropResponseInformation
// "\199\DC2\SUB\154\213\159\209\t\163\170\244\238Y\SYN[\141hG\vH\130)\SO\161",PropReasonString
// "\150\242\156)rA1\144!\230\DLE\219\RS\RS",PropAuthenticationMethod
// "]#\SOH\146oe\140PY*\245AG\229\243",PropSessionExpiryInterval 24261,PropCorrelationData
// "\176\141yc\175D\237\231\247\&8[",PropRequestResponseInformation 23,PropWildcardSubscriptionAvailable
// 98,PropPayloadFormatIndicator 143,PropResponseTopic
// "\DC2\220p?\241\212\251\197=\211\&7\144\219s]\131I\141\SI",PropAuthenticationData
// "-\249\145\229\167\140\178\223\237\187>\DLE\USF\DC2\210D\237A\172\246;\FS"]
TEST(Subscribe5QCTest, Encode66) {
  uint8_t pkt[] = {
      0x82, 0x9f, 0x3,  0x12, 0x7c, 0xfe, 0x1,  0x8,  0x0,  0xf,  0x7d, 0xd9, 0x43, 0xc7, 0x90, 0x77, 0xcd, 0xa3, 0xa4,
      0xfa, 0x2a, 0x51, 0xd,  0xbc, 0x88, 0x27, 0x0,  0x0,  0xa,  0x53, 0x12, 0x0,  0xb,  0xf0, 0x73, 0xca, 0xd0, 0xfa,
      0x5b, 0x62, 0x63, 0x84, 0x73, 0x50, 0xb,  0x8,  0x26, 0x0,  0x19, 0x95, 0x6d, 0x2b, 0xa6, 0xa2, 0x7d, 0xa,  0x5b,
      0x6f, 0xfc, 0xa9, 0x97, 0xa8, 0x12, 0x14, 0xd9, 0xb8, 0x95, 0x95, 0x1f, 0x34, 0x13, 0x93, 0xf1, 0x6,  0x0,  0xc,
      0x8f, 0x24, 0xc3, 0x7b, 0xaf, 0xad, 0x7e, 0x95, 0xf9, 0xb8, 0xea, 0x86, 0x23, 0x62, 0x3a, 0xb,  0x19, 0x19, 0x61,
      0x17, 0xd9, 0x3,  0x0,  0x18, 0x58, 0xff, 0x8d, 0x5c, 0xc2, 0x9b, 0x1c, 0xa0, 0x14, 0x82, 0x5a, 0x59, 0xdf, 0x4e,
      0xe,  0x7e, 0xec, 0xce, 0x54, 0x58, 0x87, 0xf,  0x12, 0x39, 0x29, 0x10, 0x1a, 0x0,  0x18, 0xc7, 0x12, 0x1a, 0x9a,
      0xd5, 0x9f, 0xd1, 0x9,  0xa3, 0xaa, 0xf4, 0xee, 0x59, 0x16, 0x5b, 0x8d, 0x68, 0x47, 0xb,  0x48, 0x82, 0x29, 0xe,
      0xa1, 0x1f, 0x0,  0xe,  0x96, 0xf2, 0x9c, 0x29, 0x72, 0x41, 0x31, 0x90, 0x21, 0xe6, 0x10, 0xdb, 0x1e, 0x1e, 0x15,
      0x0,  0xf,  0x5d, 0x23, 0x1,  0x92, 0x6f, 0x65, 0x8c, 0x50, 0x59, 0x2a, 0xf5, 0x41, 0x47, 0xe5, 0xf3, 0x11, 0x0,
      0x0,  0x5e, 0xc5, 0x9,  0x0,  0xb,  0xb0, 0x8d, 0x79, 0x63, 0xaf, 0x44, 0xed, 0xe7, 0xf7, 0x38, 0x5b, 0x19, 0x17,
      0x28, 0x62, 0x1,  0x8f, 0x8,  0x0,  0x13, 0x12, 0xdc, 0x70, 0x3f, 0xf1, 0xd4, 0xfb, 0xc5, 0x3d, 0xd3, 0x37, 0x90,
      0xdb, 0x73, 0x5d, 0x83, 0x49, 0x8d, 0xf,  0x16, 0x0,  0x17, 0x2d, 0xf9, 0x91, 0xe5, 0xa7, 0x8c, 0xb2, 0xdf, 0xed,
      0xbb, 0x3e, 0x10, 0x1f, 0x46, 0x12, 0xd2, 0x44, 0xed, 0x41, 0xac, 0xf6, 0x3b, 0x1c, 0x0,  0x1e, 0x6a, 0xa0, 0x90,
      0x83, 0xc7, 0x95, 0x89, 0xcd, 0xb4, 0x20, 0x30, 0x5c, 0xee, 0x27, 0xb,  0xef, 0x25, 0x8c, 0x79, 0x82, 0xa6, 0x10,
      0x46, 0x57, 0xc4, 0x2b, 0x2f, 0x1a, 0xaf, 0x6b, 0x2,  0x0,  0x12, 0xa5, 0xd0, 0x44, 0x52, 0xba, 0xa4, 0xa9, 0x2c,
      0xf7, 0xb9, 0x1d, 0x38, 0x2e, 0xfb, 0x2c, 0x6a, 0x39, 0x5,  0x0,  0x0,  0xd,  0xec, 0x31, 0xb4, 0x65, 0x9f, 0x78,
      0xbe, 0x7b, 0x6,  0x65, 0xde, 0x35, 0x96, 0x2,  0x0,  0x7,  0xa9, 0x1b, 0xa4, 0x2a, 0x77, 0x33, 0x58, 0x0,  0x0,
      0x3,  0x88, 0xb,  0x89, 0x0,  0x0,  0x1b, 0xf3, 0xc1, 0x4d, 0x7a, 0x26, 0x97, 0xf0, 0x69, 0x8a, 0xab, 0x3d, 0xde,
      0xe2, 0xa9, 0x28, 0xfb, 0x92, 0x95, 0x6b, 0x33, 0xb0, 0x74, 0xce, 0xa1, 0x4e, 0x7e, 0xa5, 0x0,  0x0,  0x16, 0xb1,
      0xd1, 0xf2, 0xad, 0x55, 0xe8, 0x3,  0x2a, 0xd9, 0x69, 0xfa, 0xa7, 0x4a, 0x68, 0xf0, 0x1,  0xd2, 0xe6, 0x19, 0x96,
      0x7a, 0xcd, 0x2,  0x0,  0xd,  0xb7, 0xbd, 0x9f, 0x3f, 0x2c, 0xfb, 0xf6, 0x7f, 0x1c, 0x24, 0x86, 0x86, 0x7d, 0x1};

  uint8_t buf[428] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x6a, 0xa0, 0x90, 0x83, 0xc7, 0x95, 0x89, 0xcd, 0xb4, 0x20,
                                     0x30, 0x5c, 0xee, 0x27, 0xb,  0xef, 0x25, 0x8c, 0x79, 0x82,
                                     0xa6, 0x10, 0x46, 0x57, 0xc4, 0x2b, 0x2f, 0x1a, 0xaf, 0x6b};
  lwmqtt_string_t topic_filter_s0 = {30, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa5, 0xd0, 0x44, 0x52, 0xba, 0xa4, 0xa9, 0x2c, 0xf7,
                                     0xb9, 0x1d, 0x38, 0x2e, 0xfb, 0x2c, 0x6a, 0x39, 0x5};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xec, 0x31, 0xb4, 0x65, 0x9f, 0x78, 0xbe, 0x7b, 0x6, 0x65, 0xde, 0x35, 0x96};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa9, 0x1b, 0xa4, 0x2a, 0x77, 0x33, 0x58};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x88, 0xb, 0x89};
  lwmqtt_string_t topic_filter_s4 = {3, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf3, 0xc1, 0x4d, 0x7a, 0x26, 0x97, 0xf0, 0x69, 0x8a, 0xab, 0x3d, 0xde, 0xe2, 0xa9,
                                     0x28, 0xfb, 0x92, 0x95, 0x6b, 0x33, 0xb0, 0x74, 0xce, 0xa1, 0x4e, 0x7e, 0xa5};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb1, 0xd1, 0xf2, 0xad, 0x55, 0xe8, 0x3,  0x2a, 0xd9, 0x69, 0xfa,
                                     0xa7, 0x4a, 0x68, 0xf0, 0x1,  0xd2, 0xe6, 0x19, 0x96, 0x7a, 0xcd};
  lwmqtt_string_t topic_filter_s6 = {22, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xb7, 0xbd, 0x9f, 0x3f, 0x2c, 0xfb, 0xf6, 0x7f, 0x1c, 0x24, 0x86, 0x86, 0x7d};
  lwmqtt_string_t topic_filter_s7 = {13, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x7d, 0xd9, 0x43, 0xc7, 0x90, 0x77, 0xcd, 0xa3, 0xa4, 0xfa, 0x2a, 0x51, 0xd, 0xbc, 0x88};
  uint8_t bytesprops1[] = {0xf0, 0x73, 0xca, 0xd0, 0xfa, 0x5b, 0x62, 0x63, 0x84, 0x73, 0x50};
  uint8_t bytesprops3[] = {0x8f, 0x24, 0xc3, 0x7b, 0xaf, 0xad, 0x7e, 0x95, 0xf9, 0xb8, 0xea, 0x86};
  uint8_t bytesprops2[] = {0x95, 0x6d, 0x2b, 0xa6, 0xa2, 0x7d, 0xa,  0x5b, 0x6f, 0xfc, 0xa9, 0x97, 0xa8,
                           0x12, 0x14, 0xd9, 0xb8, 0x95, 0x95, 0x1f, 0x34, 0x13, 0x93, 0xf1, 0x6};
  uint8_t bytesprops4[] = {0x58, 0xff, 0x8d, 0x5c, 0xc2, 0x9b, 0x1c, 0xa0, 0x14, 0x82, 0x5a, 0x59,
                           0xdf, 0x4e, 0xe,  0x7e, 0xec, 0xce, 0x54, 0x58, 0x87, 0xf,  0x12, 0x39};
  uint8_t bytesprops5[] = {0xc7, 0x12, 0x1a, 0x9a, 0xd5, 0x9f, 0xd1, 0x9,  0xa3, 0xaa, 0xf4, 0xee,
                           0x59, 0x16, 0x5b, 0x8d, 0x68, 0x47, 0xb,  0x48, 0x82, 0x29, 0xe,  0xa1};
  uint8_t bytesprops6[] = {0x96, 0xf2, 0x9c, 0x29, 0x72, 0x41, 0x31, 0x90, 0x21, 0xe6, 0x10, 0xdb, 0x1e, 0x1e};
  uint8_t bytesprops7[] = {0x5d, 0x23, 0x1, 0x92, 0x6f, 0x65, 0x8c, 0x50, 0x59, 0x2a, 0xf5, 0x41, 0x47, 0xe5, 0xf3};
  uint8_t bytesprops8[] = {0xb0, 0x8d, 0x79, 0x63, 0xaf, 0x44, 0xed, 0xe7, 0xf7, 0x38, 0x5b};
  uint8_t bytesprops9[] = {0x12, 0xdc, 0x70, 0x3f, 0xf1, 0xd4, 0xfb, 0xc5, 0x3d, 0xd3,
                           0x37, 0x90, 0xdb, 0x73, 0x5d, 0x83, 0x49, 0x8d, 0xf};
  uint8_t bytesprops10[] = {0x2d, 0xf9, 0x91, 0xe5, 0xa7, 0x8c, 0xb2, 0xdf, 0xed, 0xbb, 0x3e, 0x10,
                            0x1f, 0x46, 0x12, 0xd2, 0x44, 0xed, 0x41, 0xac, 0xf6, 0x3b, 0x1c};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {15, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2643}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {11, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 8}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {25, (char*)&bytesprops2}, .v = {12, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 25146}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 25}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 97}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 217}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {24, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 16}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {24, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {15, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 24261}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {11, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 23}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 98}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 143}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {19, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {23, (char*)&bytesprops10}}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4732, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14957
// [("J\147\230\135V\211\184\205\203c\167\216Fb\245\187\165\175\&7\175Zh\224\EOT\247\147&#",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\134n\153\177\133\152\145aTM\141\223#\220\167X\138\DLE\143JK\148\201\ETX\251\138\229",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropMessageExpiryInterval 6325,PropRequestResponseInformation 164,PropWildcardSubscriptionAvailable
// 61,PropContentType "&\138\128\202\\\208\172\237e<w\243\230\151\DEL",PropResponseInformation
// "0\t\DC4\SI\GS&;\204S)",PropAuthenticationMethod
// "\a\SUB\129a\DC4\255\244\&7Q\201\NAK-F\139\137\154[\166W\199",PropServerKeepAlive 13033,PropResponseInformation
// "\DC24\GSQ6u",PropWildcardSubscriptionAvailable 40,PropAuthenticationMethod
// "\134\158\226\171r\219`T\DEL\SYNY5%\141\172\&8\179\ENQ\236\b\\",PropRequestResponseInformation
// 112,PropRequestProblemInformation 183,PropRequestResponseInformation 49,PropRetainAvailable
// 181,PropPayloadFormatIndicator 156,PropMaximumQoS 164,PropMaximumPacketSize 13257]
TEST(Subscribe5QCTest, Encode67) {
  uint8_t pkt[] = {0x82, 0xb6, 0x1,  0x3a, 0x6d, 0x76, 0x2,  0x0,  0x0,  0x18, 0xb5, 0x19, 0xa4, 0x28, 0x3d, 0x3,  0x0,
                   0xf,  0x26, 0x8a, 0x80, 0xca, 0x5c, 0xd0, 0xac, 0xed, 0x65, 0x3c, 0x77, 0xf3, 0xe6, 0x97, 0x7f, 0x1a,
                   0x0,  0xa,  0x30, 0x9,  0x14, 0xf,  0x1d, 0x26, 0x3b, 0xcc, 0x53, 0x29, 0x15, 0x0,  0x14, 0x7,  0x1a,
                   0x81, 0x61, 0x14, 0xff, 0xf4, 0x37, 0x51, 0xc9, 0x15, 0x2d, 0x46, 0x8b, 0x89, 0x9a, 0x5b, 0xa6, 0x57,
                   0xc7, 0x13, 0x32, 0xe9, 0x1a, 0x0,  0x6,  0x12, 0x34, 0x1d, 0x51, 0x36, 0x75, 0x28, 0x28, 0x15, 0x0,
                   0x15, 0x86, 0x9e, 0xe2, 0xab, 0x72, 0xdb, 0x60, 0x54, 0x7f, 0x16, 0x59, 0x35, 0x25, 0x8d, 0xac, 0x38,
                   0xb3, 0x5,  0xec, 0x8,  0x5c, 0x19, 0x70, 0x17, 0xb7, 0x19, 0x31, 0x25, 0xb5, 0x1,  0x9c, 0x24, 0xa4,
                   0x27, 0x0,  0x0,  0x33, 0xc9, 0x0,  0x1c, 0x4a, 0x93, 0xe6, 0x87, 0x56, 0xd3, 0xb8, 0xcd, 0xcb, 0x63,
                   0xa7, 0xd8, 0x46, 0x62, 0xf5, 0xbb, 0xa5, 0xaf, 0x37, 0xaf, 0x5a, 0x68, 0xe0, 0x4,  0xf7, 0x93, 0x26,
                   0x23, 0x1,  0x0,  0x1b, 0x86, 0x6e, 0x99, 0xb1, 0x85, 0x98, 0x91, 0x61, 0x54, 0x4d, 0x8d, 0xdf, 0x23,
                   0xdc, 0xa7, 0x58, 0x8a, 0x10, 0x8f, 0x4a, 0x4b, 0x94, 0xc9, 0x3,  0xfb, 0x8a, 0xe5, 0x1};

  uint8_t buf[195] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x4a, 0x93, 0xe6, 0x87, 0x56, 0xd3, 0xb8, 0xcd, 0xcb, 0x63,
                                     0xa7, 0xd8, 0x46, 0x62, 0xf5, 0xbb, 0xa5, 0xaf, 0x37, 0xaf,
                                     0x5a, 0x68, 0xe0, 0x4,  0xf7, 0x93, 0x26, 0x23};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86, 0x6e, 0x99, 0xb1, 0x85, 0x98, 0x91, 0x61, 0x54, 0x4d, 0x8d, 0xdf, 0x23, 0xdc,
                                     0xa7, 0x58, 0x8a, 0x10, 0x8f, 0x4a, 0x4b, 0x94, 0xc9, 0x3,  0xfb, 0x8a, 0xe5};
  lwmqtt_string_t topic_filter_s1 = {27, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x26, 0x8a, 0x80, 0xca, 0x5c, 0xd0, 0xac, 0xed, 0x65, 0x3c, 0x77, 0xf3, 0xe6, 0x97, 0x7f};
  uint8_t bytesprops1[] = {0x30, 0x9, 0x14, 0xf, 0x1d, 0x26, 0x3b, 0xcc, 0x53, 0x29};
  uint8_t bytesprops2[] = {0x7,  0x1a, 0x81, 0x61, 0x14, 0xff, 0xf4, 0x37, 0x51, 0xc9,
                           0x15, 0x2d, 0x46, 0x8b, 0x89, 0x9a, 0x5b, 0xa6, 0x57, 0xc7};
  uint8_t bytesprops3[] = {0x12, 0x34, 0x1d, 0x51, 0x36, 0x75};
  uint8_t bytesprops4[] = {0x86, 0x9e, 0xe2, 0xab, 0x72, 0xdb, 0x60, 0x54, 0x7f, 0x16, 0x59,
                           0x35, 0x25, 0x8d, 0xac, 0x38, 0xb3, 0x5,  0xec, 0x8,  0x5c};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 6325}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 164}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 61}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {15, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13033}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {6, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 40}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {21, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 112}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 183}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 49}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 181}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 156}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 164}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 13257}},
  };

  lwmqtt_properties_t props = {17, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14957, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10919 [("t\SUB9\188\&6\246\145\139\179Z\219\201\195_E\251",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\193ia\255\232\&5\138\199>\245\230\190d\n",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS0}),("\SYN\233\177\236i\130\128\129L\208\174U\146\138F\247\182\212.\225y\DC2R\230s`9\178X_",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("C\183z\254h",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\232t\GS\132\129\184f\CAN\CAN>\141:L\216\DC3{\191Y\213\232\SYN|\212\146k\195",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\SO]\228\162\189*ST\168t\ACK\143\216r\249\178\199\&0(\200[}\173\235\206\159F",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\STX\148\192L*\157`\179\224=e\224\228\&6",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS0}),("\232J\211\179\136\130\218\157A\177\157j!\157\237\a\248\213\SUB\155",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropResponseInformation
// "\141\218\fB",PropMaximumQoS 48,PropUserProperty "8\STX\171\212E"
// "\205.\225\DC2)S\236\SO\221\ENQb\205\162\227G\206\194\171",PropWildcardSubscriptionAvailable 97,PropServerReference
// "",PropSharedSubscriptionAvailable 231,PropMessageExpiryInterval 8639,PropTopicAlias 18302,PropSubscriptionIdentifier
// 24,PropResponseTopic "N\232",PropRetainAvailable 16,PropServerReference
// "eR\198\190}\129\&0\DC4\130\133&\n\200\232q\197v\217\231|\236\&9\177",PropPayloadFormatIndicator
// 91,PropRequestResponseInformation 218,PropSubscriptionIdentifier 19,PropResponseTopic "\231\212A",PropContentType
// "\170\220\180\147\DC3\b\128\EOTD\166\220\EOTTr.\156\143es\186\f\SI\223",PropSubscriptionIdentifierAvailable
// 46,PropCorrelationData
// "\204s\151Y\143\185\163\219}\202\&3\197\DEL\230\162\201\223\"1\SUB\254s\246];\142ll\235",PropReceiveMaximum
// 11098,PropResponseInformation "\237)\FS.?~N",PropReasonString "t\239\236\164\&7\216]\131\205",PropUserProperty "@?l'"
// ">\215\168\185\215\198\234\247\182F\220\215\171\185\200\155\235\NUL7\133\128\n\v\146\183n+\214
// \249",PropMessageExpiryInterval 23401,PropPayloadFormatIndicator 155,PropMessageExpiryInterval
// 15350,PropMessageExpiryInterval 15537,PropRequestProblemInformation 205,PropMaximumPacketSize
// 25844,PropSessionExpiryInterval 9076]
TEST(Subscribe5QCTest, Encode68) {
  uint8_t pkt[] = {
      0x82, 0xb0, 0x3,  0x2a, 0xa7, 0xfc, 0x1,  0x1a, 0x0,  0x4,  0x8d, 0xda, 0xc,  0x42, 0x24, 0x30, 0x26, 0x0,  0x5,
      0x38, 0x2,  0xab, 0xd4, 0x45, 0x0,  0x12, 0xcd, 0x2e, 0xe1, 0x12, 0x29, 0x53, 0xec, 0xe,  0xdd, 0x5,  0x62, 0xcd,
      0xa2, 0xe3, 0x47, 0xce, 0xc2, 0xab, 0x28, 0x61, 0x1c, 0x0,  0x0,  0x2a, 0xe7, 0x2,  0x0,  0x0,  0x21, 0xbf, 0x23,
      0x47, 0x7e, 0xb,  0x18, 0x8,  0x0,  0x2,  0x4e, 0xe8, 0x25, 0x10, 0x1c, 0x0,  0x17, 0x65, 0x52, 0xc6, 0xbe, 0x7d,
      0x81, 0x30, 0x14, 0x82, 0x85, 0x26, 0xa,  0xc8, 0xe8, 0x71, 0xc5, 0x76, 0xd9, 0xe7, 0x7c, 0xec, 0x39, 0xb1, 0x1,
      0x5b, 0x19, 0xda, 0xb,  0x13, 0x8,  0x0,  0x3,  0xe7, 0xd4, 0x41, 0x3,  0x0,  0x17, 0xaa, 0xdc, 0xb4, 0x93, 0x13,
      0x8,  0x80, 0x4,  0x44, 0xa6, 0xdc, 0x4,  0x54, 0x72, 0x2e, 0x9c, 0x8f, 0x65, 0x73, 0xba, 0xc,  0xf,  0xdf, 0x29,
      0x2e, 0x9,  0x0,  0x1d, 0xcc, 0x73, 0x97, 0x59, 0x8f, 0xb9, 0xa3, 0xdb, 0x7d, 0xca, 0x33, 0xc5, 0x7f, 0xe6, 0xa2,
      0xc9, 0xdf, 0x22, 0x31, 0x1a, 0xfe, 0x73, 0xf6, 0x5d, 0x3b, 0x8e, 0x6c, 0x6c, 0xeb, 0x21, 0x2b, 0x5a, 0x1a, 0x0,
      0x7,  0xed, 0x29, 0x1c, 0x2e, 0x3f, 0x7e, 0x4e, 0x1f, 0x0,  0x9,  0x74, 0xef, 0xec, 0xa4, 0x37, 0xd8, 0x5d, 0x83,
      0xcd, 0x26, 0x0,  0x4,  0x40, 0x3f, 0x6c, 0x27, 0x0,  0x1e, 0x3e, 0xd7, 0xa8, 0xb9, 0xd7, 0xc6, 0xea, 0xf7, 0xb6,
      0x46, 0xdc, 0xd7, 0xab, 0xb9, 0xc8, 0x9b, 0xeb, 0x0,  0x37, 0x85, 0x80, 0xa,  0xb,  0x92, 0xb7, 0x6e, 0x2b, 0xd6,
      0x20, 0xf9, 0x2,  0x0,  0x0,  0x5b, 0x69, 0x1,  0x9b, 0x2,  0x0,  0x0,  0x3b, 0xf6, 0x2,  0x0,  0x0,  0x3c, 0xb1,
      0x17, 0xcd, 0x27, 0x0,  0x0,  0x64, 0xf4, 0x11, 0x0,  0x0,  0x23, 0x74, 0x0,  0x10, 0x74, 0x1a, 0x39, 0xbc, 0x36,
      0xf6, 0x91, 0x8b, 0xb3, 0x5a, 0xdb, 0xc9, 0xc3, 0x5f, 0x45, 0xfb, 0x1,  0x0,  0xe,  0xc1, 0x69, 0x61, 0xff, 0xe8,
      0x35, 0x8a, 0xc7, 0x3e, 0xf5, 0xe6, 0xbe, 0x64, 0xa,  0x0,  0x0,  0x1e, 0x16, 0xe9, 0xb1, 0xec, 0x69, 0x82, 0x80,
      0x81, 0x4c, 0xd0, 0xae, 0x55, 0x92, 0x8a, 0x46, 0xf7, 0xb6, 0xd4, 0x2e, 0xe1, 0x79, 0x12, 0x52, 0xe6, 0x73, 0x60,
      0x39, 0xb2, 0x58, 0x5f, 0x0,  0x0,  0x5,  0x43, 0xb7, 0x7a, 0xfe, 0x68, 0x1,  0x0,  0x1a, 0xe8, 0x74, 0x1d, 0x84,
      0x81, 0xb8, 0x66, 0x18, 0x18, 0x3e, 0x8d, 0x3a, 0x4c, 0xd8, 0x13, 0x7b, 0xbf, 0x59, 0xd5, 0xe8, 0x16, 0x7c, 0xd4,
      0x92, 0x6b, 0xc3, 0x1,  0x0,  0x1b, 0xe,  0x5d, 0xe4, 0xa2, 0xbd, 0x2a, 0x53, 0x54, 0xa8, 0x74, 0x6,  0x8f, 0xd8,
      0x72, 0xf9, 0xb2, 0xc7, 0x30, 0x28, 0xc8, 0x5b, 0x7d, 0xad, 0xeb, 0xce, 0x9f, 0x46, 0x1,  0x0,  0xe,  0x2,  0x94,
      0xc0, 0x4c, 0x2a, 0x9d, 0x60, 0xb3, 0xe0, 0x3d, 0x65, 0xe0, 0xe4, 0x36, 0x0,  0x0,  0x14, 0xe8, 0x4a, 0xd3, 0xb3,
      0x88, 0x82, 0xda, 0x9d, 0x41, 0xb1, 0x9d, 0x6a, 0x21, 0x9d, 0xed, 0x7,  0xf8, 0xd5, 0x1a, 0x9b, 0x0};

  uint8_t buf[445] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x74, 0x1a, 0x39, 0xbc, 0x36, 0xf6, 0x91, 0x8b,
                                     0xb3, 0x5a, 0xdb, 0xc9, 0xc3, 0x5f, 0x45, 0xfb};
  lwmqtt_string_t topic_filter_s0 = {16, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x69, 0x61, 0xff, 0xe8, 0x35, 0x8a, 0xc7, 0x3e, 0xf5, 0xe6, 0xbe, 0x64, 0xa};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x16, 0xe9, 0xb1, 0xec, 0x69, 0x82, 0x80, 0x81, 0x4c, 0xd0,
                                     0xae, 0x55, 0x92, 0x8a, 0x46, 0xf7, 0xb6, 0xd4, 0x2e, 0xe1,
                                     0x79, 0x12, 0x52, 0xe6, 0x73, 0x60, 0x39, 0xb2, 0x58, 0x5f};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x43, 0xb7, 0x7a, 0xfe, 0x68};
  lwmqtt_string_t topic_filter_s3 = {5, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe8, 0x74, 0x1d, 0x84, 0x81, 0xb8, 0x66, 0x18, 0x18, 0x3e, 0x8d, 0x3a, 0x4c,
                                     0xd8, 0x13, 0x7b, 0xbf, 0x59, 0xd5, 0xe8, 0x16, 0x7c, 0xd4, 0x92, 0x6b, 0xc3};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe,  0x5d, 0xe4, 0xa2, 0xbd, 0x2a, 0x53, 0x54, 0xa8, 0x74, 0x6,  0x8f, 0xd8, 0x72,
                                     0xf9, 0xb2, 0xc7, 0x30, 0x28, 0xc8, 0x5b, 0x7d, 0xad, 0xeb, 0xce, 0x9f, 0x46};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x2, 0x94, 0xc0, 0x4c, 0x2a, 0x9d, 0x60, 0xb3, 0xe0, 0x3d, 0x65, 0xe0, 0xe4, 0x36};
  lwmqtt_string_t topic_filter_s6 = {14, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xe8, 0x4a, 0xd3, 0xb3, 0x88, 0x82, 0xda, 0x9d, 0x41, 0xb1,
                                     0x9d, 0x6a, 0x21, 0x9d, 0xed, 0x7,  0xf8, 0xd5, 0x1a, 0x9b};
  lwmqtt_string_t topic_filter_s7 = {20, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x8d, 0xda, 0xc, 0x42};
  uint8_t bytesprops2[] = {0xcd, 0x2e, 0xe1, 0x12, 0x29, 0x53, 0xec, 0xe,  0xdd,
                           0x5,  0x62, 0xcd, 0xa2, 0xe3, 0x47, 0xce, 0xc2, 0xab};
  uint8_t bytesprops1[] = {0x38, 0x2, 0xab, 0xd4, 0x45};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0x4e, 0xe8};
  uint8_t bytesprops5[] = {0x65, 0x52, 0xc6, 0xbe, 0x7d, 0x81, 0x30, 0x14, 0x82, 0x85, 0x26, 0xa,
                           0xc8, 0xe8, 0x71, 0xc5, 0x76, 0xd9, 0xe7, 0x7c, 0xec, 0x39, 0xb1};
  uint8_t bytesprops6[] = {0xe7, 0xd4, 0x41};
  uint8_t bytesprops7[] = {0xaa, 0xdc, 0xb4, 0x93, 0x13, 0x8,  0x80, 0x4,  0x44, 0xa6, 0xdc, 0x4,
                           0x54, 0x72, 0x2e, 0x9c, 0x8f, 0x65, 0x73, 0xba, 0xc,  0xf,  0xdf};
  uint8_t bytesprops8[] = {0xcc, 0x73, 0x97, 0x59, 0x8f, 0xb9, 0xa3, 0xdb, 0x7d, 0xca, 0x33, 0xc5, 0x7f, 0xe6, 0xa2,
                           0xc9, 0xdf, 0x22, 0x31, 0x1a, 0xfe, 0x73, 0xf6, 0x5d, 0x3b, 0x8e, 0x6c, 0x6c, 0xeb};
  uint8_t bytesprops9[] = {0xed, 0x29, 0x1c, 0x2e, 0x3f, 0x7e, 0x4e};
  uint8_t bytesprops10[] = {0x74, 0xef, 0xec, 0xa4, 0x37, 0xd8, 0x5d, 0x83, 0xcd};
  uint8_t bytesprops12[] = {0x3e, 0xd7, 0xa8, 0xb9, 0xd7, 0xc6, 0xea, 0xf7, 0xb6, 0x46, 0xdc, 0xd7, 0xab, 0xb9, 0xc8,
                            0x9b, 0xeb, 0x0,  0x37, 0x85, 0x80, 0xa,  0xb,  0x92, 0xb7, 0x6e, 0x2b, 0xd6, 0x20, 0xf9};
  uint8_t bytesprops11[] = {0x40, 0x3f, 0x6c, 0x27};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {4, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 48}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {5, (char*)&bytesprops1}, .v = {18, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 97}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 231}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8639}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18302}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 24}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {2, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 16}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 91}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 218}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 19}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {3, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 46}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {29, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 11098}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {7, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {9, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {4, (char*)&bytesprops11}, .v = {30, (char*)&bytesprops12}}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23401}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 155}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15350}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 15537}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 205}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 25844}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 9076}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10919, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 692 [("\151\140>\206\207\NUL\208\139\194L\251\227\220\170\163\153*~?,w\245u",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\227\154\215d\192;_\237G\128o\235Q\218rV\202\SOHr\DEL\144\155",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("S'\141\229\&7]\"\179\212\174\r\185\176",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\137\202Y\ENQ\254#\197\FS(R\208\234n0x\ACK\141\210i\227$0\182H%",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("0\237\190\218C6",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\247/{\nv\233V\144\198e\158",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\247\194\142\228\247\186\227\&8",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("J",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\200\183{SW\236\248y\197\224\172K\STX\184W\v~\211",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\247\146\ETB\254\241\SYN\199\197\175\237\\\220\213\154\178\214\136k\147S\SI\228\EM\219\129.\240",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\249h\135(AF",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1})] [PropPayloadFormatIndicator 98,PropSubscriptionIdentifierAvailable 91,PropAssignedClientIdentifier
// "",PropReceiveMaximum 7702,PropReasonString
// "\DEL\212\RS\209\138\vV\203\176\167\GSh\166\241a\174\223\134i\ACK\180\141\167\143\GS*W",PropResponseInformation
// "S\n\222\138\232",PropSubscriptionIdentifierAvailable 17,PropRequestResponseInformation 229,PropMessageExpiryInterval
// 357,PropUserProperty "\194\165\224\b\149\&0\226KTy\175\187\RSC5" "\177W]>\200NI6gJ\199\&4\148{\129Y\202
// [1\244\223\141\240S"]
TEST(Subscribe5QCTest, Encode69) {
  uint8_t pkt[] = {
      0x82, 0xaa, 0x2,  0x2,  0xb4, 0x66, 0x1,  0x62, 0x29, 0x5b, 0x12, 0x0,  0x0,  0x21, 0x1e, 0x16, 0x1f, 0x0,  0x1b,
      0x7f, 0xd4, 0x1e, 0xd1, 0x8a, 0xb,  0x56, 0xcb, 0xb0, 0xa7, 0x1d, 0x68, 0xa6, 0xf1, 0x61, 0xae, 0xdf, 0x86, 0x69,
      0x6,  0xb4, 0x8d, 0xa7, 0x8f, 0x1d, 0x2a, 0x57, 0x1a, 0x0,  0x5,  0x53, 0xa,  0xde, 0x8a, 0xe8, 0x29, 0x11, 0x19,
      0xe5, 0x2,  0x0,  0x0,  0x1,  0x65, 0x26, 0x0,  0xf,  0xc2, 0xa5, 0xe0, 0x8,  0x95, 0x30, 0xe2, 0x4b, 0x54, 0x79,
      0xaf, 0xbb, 0x1e, 0x43, 0x35, 0x0,  0x19, 0xb1, 0x57, 0x5d, 0x3e, 0xc8, 0x4e, 0x49, 0x36, 0x67, 0x4a, 0xc7, 0x34,
      0x94, 0x7b, 0x81, 0x59, 0xca, 0x20, 0x5b, 0x31, 0xf4, 0xdf, 0x8d, 0xf0, 0x53, 0x0,  0x17, 0x97, 0x8c, 0x3e, 0xce,
      0xcf, 0x0,  0xd0, 0x8b, 0xc2, 0x4c, 0xfb, 0xe3, 0xdc, 0xaa, 0xa3, 0x99, 0x2a, 0x7e, 0x3f, 0x2c, 0x77, 0xf5, 0x75,
      0x2,  0x0,  0x16, 0xe3, 0x9a, 0xd7, 0x64, 0xc0, 0x3b, 0x5f, 0xed, 0x47, 0x80, 0x6f, 0xeb, 0x51, 0xda, 0x72, 0x56,
      0xca, 0x1,  0x72, 0x7f, 0x90, 0x9b, 0x0,  0x0,  0xd,  0x53, 0x27, 0x8d, 0xe5, 0x37, 0x5d, 0x22, 0xb3, 0xd4, 0xae,
      0xd,  0xb9, 0xb0, 0x1,  0x0,  0x19, 0x89, 0xca, 0x59, 0x5,  0xfe, 0x23, 0xc5, 0x1c, 0x28, 0x52, 0xd0, 0xea, 0x6e,
      0x30, 0x78, 0x6,  0x8d, 0xd2, 0x69, 0xe3, 0x24, 0x30, 0xb6, 0x48, 0x25, 0x1,  0x0,  0x6,  0x30, 0xed, 0xbe, 0xda,
      0x43, 0x36, 0x1,  0x0,  0xb,  0xf7, 0x2f, 0x7b, 0xa,  0x76, 0xe9, 0x56, 0x90, 0xc6, 0x65, 0x9e, 0x0,  0x0,  0x8,
      0xf7, 0xc2, 0x8e, 0xe4, 0xf7, 0xba, 0xe3, 0x38, 0x0,  0x0,  0x1,  0x4a, 0x2,  0x0,  0x12, 0xc8, 0xb7, 0x7b, 0x53,
      0x57, 0xec, 0xf8, 0x79, 0xc5, 0xe0, 0xac, 0x4b, 0x2,  0xb8, 0x57, 0xb,  0x7e, 0xd3, 0x0,  0x0,  0x1b, 0xf7, 0x92,
      0x17, 0xfe, 0xf1, 0x16, 0xc7, 0xc5, 0xaf, 0xed, 0x5c, 0xdc, 0xd5, 0x9a, 0xb2, 0xd6, 0x88, 0x6b, 0x93, 0x53, 0xf,
      0xe4, 0x19, 0xdb, 0x81, 0x2e, 0xf0, 0x2,  0x0,  0x6,  0xf9, 0x68, 0x87, 0x28, 0x41, 0x46, 0x1};

  uint8_t buf[311] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x97, 0x8c, 0x3e, 0xce, 0xcf, 0x0,  0xd0, 0x8b, 0xc2, 0x4c, 0xfb, 0xe3,
                                     0xdc, 0xaa, 0xa3, 0x99, 0x2a, 0x7e, 0x3f, 0x2c, 0x77, 0xf5, 0x75};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xe3, 0x9a, 0xd7, 0x64, 0xc0, 0x3b, 0x5f, 0xed, 0x47, 0x80, 0x6f,
                                     0xeb, 0x51, 0xda, 0x72, 0x56, 0xca, 0x1,  0x72, 0x7f, 0x90, 0x9b};
  lwmqtt_string_t topic_filter_s1 = {22, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x53, 0x27, 0x8d, 0xe5, 0x37, 0x5d, 0x22, 0xb3, 0xd4, 0xae, 0xd, 0xb9, 0xb0};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x89, 0xca, 0x59, 0x5,  0xfe, 0x23, 0xc5, 0x1c, 0x28, 0x52, 0xd0, 0xea, 0x6e,
                                     0x30, 0x78, 0x6,  0x8d, 0xd2, 0x69, 0xe3, 0x24, 0x30, 0xb6, 0x48, 0x25};
  lwmqtt_string_t topic_filter_s3 = {25, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x30, 0xed, 0xbe, 0xda, 0x43, 0x36};
  lwmqtt_string_t topic_filter_s4 = {6, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf7, 0x2f, 0x7b, 0xa, 0x76, 0xe9, 0x56, 0x90, 0xc6, 0x65, 0x9e};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xf7, 0xc2, 0x8e, 0xe4, 0xf7, 0xba, 0xe3, 0x38};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x4a};
  lwmqtt_string_t topic_filter_s7 = {1, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xc8, 0xb7, 0x7b, 0x53, 0x57, 0xec, 0xf8, 0x79, 0xc5,
                                     0xe0, 0xac, 0x4b, 0x2,  0xb8, 0x57, 0xb,  0x7e, 0xd3};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xf7, 0x92, 0x17, 0xfe, 0xf1, 0x16, 0xc7, 0xc5, 0xaf, 0xed, 0x5c, 0xdc, 0xd5, 0x9a,
                                     0xb2, 0xd6, 0x88, 0x6b, 0x93, 0x53, 0xf,  0xe4, 0x19, 0xdb, 0x81, 0x2e, 0xf0};
  lwmqtt_string_t topic_filter_s9 = {27, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xf9, 0x68, 0x87, 0x28, 0x41, 0x46};
  lwmqtt_string_t topic_filter_s10 = {6, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0x7f, 0xd4, 0x1e, 0xd1, 0x8a, 0xb, 0x56, 0xcb, 0xb0, 0xa7, 0x1d, 0x68, 0xa6, 0xf1,
                           0x61, 0xae, 0xdf, 0x86, 0x69, 0x6, 0xb4, 0x8d, 0xa7, 0x8f, 0x1d, 0x2a, 0x57};
  uint8_t bytesprops2[] = {0x53, 0xa, 0xde, 0x8a, 0xe8};
  uint8_t bytesprops4[] = {0xb1, 0x57, 0x5d, 0x3e, 0xc8, 0x4e, 0x49, 0x36, 0x67, 0x4a, 0xc7, 0x34, 0x94,
                           0x7b, 0x81, 0x59, 0xca, 0x20, 0x5b, 0x31, 0xf4, 0xdf, 0x8d, 0xf0, 0x53};
  uint8_t bytesprops3[] = {0xc2, 0xa5, 0xe0, 0x8, 0x95, 0x30, 0xe2, 0x4b, 0x54, 0x79, 0xaf, 0xbb, 0x1e, 0x43, 0x35};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 98}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 91}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 7702}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {27, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {5, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 17}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 229}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 357}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {15, (char*)&bytesprops3}, .v = {25, (char*)&bytesprops4}}}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 692, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1184 [("\170g\\2\a\FS\243\&2\134#\245<\232\v<s\136\131\ETB\221/?\ah(Q@\177",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\255",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\236\208\198",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS0}),("\FS",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\146\DLEf\245n@\208m\191\ENQ\248\235=\213\192s\225\ENQ+\152\160\f|\204",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})]
// [PropServerKeepAlive 20912,PropSubscriptionIdentifier 30,PropWillDelayInterval 21511,PropContentType
// "\132\r7]\r\144\222|xHc\174\128)A\DEL\190\217.[",PropServerKeepAlive 855,PropAuthenticationMethod
// "D\f",PropReceiveMaximum 24514,PropRetainAvailable 69,PropResponseInformation
// "\185\151\232\177h{\178\246\248S\177\234\211\246\NULg\171\168\161 \166\198(\204\181\DLE\158\NUL",PropUserProperty
// "^\197=\137\221\194+R>\154\&8;\169\197< " "\254\218t\234\144\136Yf<",PropResponseTopic
// "\174Zi\154\174d_\135\215\224oYC\210j*\192\186Fh\SYN\v\215L[\SOD\206\238",PropResponseTopic
// "=I\DLE\222\\e\188#\188\n\154\154\&5i\178\239\199\157@{\SOH\STX\254b8k\131",PropMessageExpiryInterval
// 28387,PropServerReference "4\245\EMk",PropPayloadFormatIndicator 115]
TEST(Subscribe5QCTest, Encode70) {
  uint8_t pkt[] = {
      0x82, 0x83, 0x2,  0x4,  0xa0, 0xb7, 0x1,  0x13, 0x51, 0xb0, 0xb,  0x1e, 0x18, 0x0,  0x0,  0x54, 0x7,  0x3,  0x0,
      0x14, 0x84, 0xd,  0x37, 0x5d, 0xd,  0x90, 0xde, 0x7c, 0x78, 0x48, 0x63, 0xae, 0x80, 0x29, 0x41, 0x7f, 0xbe, 0xd9,
      0x2e, 0x5b, 0x13, 0x3,  0x57, 0x15, 0x0,  0x2,  0x44, 0xc,  0x21, 0x5f, 0xc2, 0x25, 0x45, 0x1a, 0x0,  0x1c, 0xb9,
      0x97, 0xe8, 0xb1, 0x68, 0x7b, 0xb2, 0xf6, 0xf8, 0x53, 0xb1, 0xea, 0xd3, 0xf6, 0x0,  0x67, 0xab, 0xa8, 0xa1, 0x20,
      0xa6, 0xc6, 0x28, 0xcc, 0xb5, 0x10, 0x9e, 0x0,  0x26, 0x0,  0x10, 0x5e, 0xc5, 0x3d, 0x89, 0xdd, 0xc2, 0x2b, 0x52,
      0x3e, 0x9a, 0x38, 0x3b, 0xa9, 0xc5, 0x3c, 0x20, 0x0,  0x9,  0xfe, 0xda, 0x74, 0xea, 0x90, 0x88, 0x59, 0x66, 0x3c,
      0x8,  0x0,  0x1d, 0xae, 0x5a, 0x69, 0x9a, 0xae, 0x64, 0x5f, 0x87, 0xd7, 0xe0, 0x6f, 0x59, 0x43, 0xd2, 0x6a, 0x2a,
      0xc0, 0xba, 0x46, 0x68, 0x16, 0xb,  0xd7, 0x4c, 0x5b, 0xe,  0x44, 0xce, 0xee, 0x8,  0x0,  0x1b, 0x3d, 0x49, 0x10,
      0xde, 0x5c, 0x65, 0xbc, 0x23, 0xbc, 0xa,  0x9a, 0x9a, 0x35, 0x69, 0xb2, 0xef, 0xc7, 0x9d, 0x40, 0x7b, 0x1,  0x2,
      0xfe, 0x62, 0x38, 0x6b, 0x83, 0x2,  0x0,  0x0,  0x6e, 0xe3, 0x1c, 0x0,  0x4,  0x34, 0xf5, 0x19, 0x6b, 0x1,  0x73,
      0x0,  0x1c, 0xaa, 0x67, 0x5c, 0x32, 0x7,  0x1c, 0xf3, 0x32, 0x86, 0x23, 0xf5, 0x3c, 0xe8, 0xb,  0x3c, 0x73, 0x88,
      0x83, 0x17, 0xdd, 0x2f, 0x3f, 0x7,  0x68, 0x28, 0x51, 0x40, 0xb1, 0x1,  0x0,  0x1,  0xff, 0x2,  0x0,  0x3,  0xec,
      0xd0, 0xc6, 0x0,  0x0,  0x1,  0x1c, 0x1,  0x0,  0x18, 0x92, 0x10, 0x66, 0xf5, 0x6e, 0x40, 0xd0, 0x6d, 0xbf, 0x5,
      0xf8, 0xeb, 0x3d, 0xd5, 0xc0, 0x73, 0xe1, 0x5,  0x2b, 0x98, 0xa0, 0xc,  0x7c, 0xcc, 0x1};

  uint8_t buf[272] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xaa, 0x67, 0x5c, 0x32, 0x7,  0x1c, 0xf3, 0x32, 0x86, 0x23,
                                     0xf5, 0x3c, 0xe8, 0xb,  0x3c, 0x73, 0x88, 0x83, 0x17, 0xdd,
                                     0x2f, 0x3f, 0x7,  0x68, 0x28, 0x51, 0x40, 0xb1};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xff};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xec, 0xd0, 0xc6};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1c};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x92, 0x10, 0x66, 0xf5, 0x6e, 0x40, 0xd0, 0x6d, 0xbf, 0x5, 0xf8, 0xeb,
                                     0x3d, 0xd5, 0xc0, 0x73, 0xe1, 0x5,  0x2b, 0x98, 0xa0, 0xc, 0x7c, 0xcc};
  lwmqtt_string_t topic_filter_s4 = {24, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x84, 0xd,  0x37, 0x5d, 0xd,  0x90, 0xde, 0x7c, 0x78, 0x48,
                           0x63, 0xae, 0x80, 0x29, 0x41, 0x7f, 0xbe, 0xd9, 0x2e, 0x5b};
  uint8_t bytesprops1[] = {0x44, 0xc};
  uint8_t bytesprops2[] = {0xb9, 0x97, 0xe8, 0xb1, 0x68, 0x7b, 0xb2, 0xf6, 0xf8, 0x53, 0xb1, 0xea, 0xd3, 0xf6,
                           0x0,  0x67, 0xab, 0xa8, 0xa1, 0x20, 0xa6, 0xc6, 0x28, 0xcc, 0xb5, 0x10, 0x9e, 0x0};
  uint8_t bytesprops4[] = {0xfe, 0xda, 0x74, 0xea, 0x90, 0x88, 0x59, 0x66, 0x3c};
  uint8_t bytesprops3[] = {0x5e, 0xc5, 0x3d, 0x89, 0xdd, 0xc2, 0x2b, 0x52,
                           0x3e, 0x9a, 0x38, 0x3b, 0xa9, 0xc5, 0x3c, 0x20};
  uint8_t bytesprops5[] = {0xae, 0x5a, 0x69, 0x9a, 0xae, 0x64, 0x5f, 0x87, 0xd7, 0xe0, 0x6f, 0x59, 0x43, 0xd2, 0x6a,
                           0x2a, 0xc0, 0xba, 0x46, 0x68, 0x16, 0xb,  0xd7, 0x4c, 0x5b, 0xe,  0x44, 0xce, 0xee};
  uint8_t bytesprops6[] = {0x3d, 0x49, 0x10, 0xde, 0x5c, 0x65, 0xbc, 0x23, 0xbc, 0xa,  0x9a, 0x9a, 0x35, 0x69,
                           0xb2, 0xef, 0xc7, 0x9d, 0x40, 0x7b, 0x1,  0x2,  0xfe, 0x62, 0x38, 0x6b, 0x83};
  uint8_t bytesprops7[] = {0x34, 0xf5, 0x19, 0x6b};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20912}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 30}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 21511}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {20, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 855}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 24514}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 69}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {28, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {16, (char*)&bytesprops3}, .v = {9, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28387}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 115}},
  };

  lwmqtt_properties_t props = {15, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1184, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28334 [("\196\208x\145\a\197\236\166\237\198\\-\222a\r\140\158N\199\&7\178\RS`=>!E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\163/?",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("_",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\\\158\228\223\ETB:\150)dY|!\236\205\164s\139\v\167>\221\EM",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\232\208\185f\157\247N\190\191\ETX\212\t\213\229\SOH
// \206\v\178@\162^",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("m\137\v\f7\141&\216@\158!\GS\192\191\189",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\EOTg\241\167",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropSharedSubscriptionAvailable
// 34,PropServerKeepAlive 10247,PropAuthenticationMethod
// "\DEL=z\205\128\181C\232*\242:\233L\ve4\143D\155\208\&0ht\132Z{\ESC\238\159\201",PropSubscriptionIdentifierAvailable
// 248,PropRetainAvailable 28,PropMessageExpiryInterval 32489,PropMaximumPacketSize 21512,PropAuthenticationData
// "\147",PropMessageExpiryInterval 25286,PropUserProperty
// "\157\n\ACK\203\149\128\a\SYN\142\DC4}\133\193\168\228\243\200" "\128",PropReceiveMaximum
// 24957,PropSubscriptionIdentifierAvailable 191,PropAuthenticationData
// "\147\DLE\172\EM\159\172r\223Zfi.",PropMessageExpiryInterval 32172,PropSessionExpiryInterval 22638,PropReceiveMaximum
// 19477,PropTopicAlias 20439,PropRequestResponseInformation 231,PropServerKeepAlive 22562,PropMaximumPacketSize
// 20475,PropTopicAliasMaximum 14896,PropServerReference
// "\t\ETXMbx\253\ENQ4A}E\SUBR\t\138\147\141\199\253*V=\205\157",PropAssignedClientIdentifier
// "\CAN\230\&6\SO\204\212f\137m\227'\234\166o\176\222\136='F\181\137Gy\220\204\a\192\n",PropUserProperty "\245\f"
// "\176\244\230\b\213\SOH\201lP\\\158\202z\163!\198P\133\202",PropPayloadFormatIndicator 161,PropAuthenticationData
// "\\W\EM)\142\185\DC1\CAN\131f\STX\200\RS\230u\147\187\165\205"]
TEST(Subscribe5QCTest, Encode71) {
  uint8_t pkt[] = {
      0x82, 0xe9, 0x2,  0x6e, 0xae, 0xf2, 0x1,  0x2a, 0x22, 0x13, 0x28, 0x7,  0x15, 0x0,  0x1e, 0x7f, 0x3d, 0x7a, 0xcd,
      0x80, 0xb5, 0x43, 0xe8, 0x2a, 0xf2, 0x3a, 0xe9, 0x4c, 0xb,  0x65, 0x34, 0x8f, 0x44, 0x9b, 0xd0, 0x30, 0x68, 0x74,
      0x84, 0x5a, 0x7b, 0x1b, 0xee, 0x9f, 0xc9, 0x29, 0xf8, 0x25, 0x1c, 0x2,  0x0,  0x0,  0x7e, 0xe9, 0x27, 0x0,  0x0,
      0x54, 0x8,  0x16, 0x0,  0x1,  0x93, 0x2,  0x0,  0x0,  0x62, 0xc6, 0x26, 0x0,  0x11, 0x9d, 0xa,  0x6,  0xcb, 0x95,
      0x80, 0x7,  0x16, 0x8e, 0x14, 0x7d, 0x85, 0xc1, 0xa8, 0xe4, 0xf3, 0xc8, 0x0,  0x1,  0x80, 0x21, 0x61, 0x7d, 0x29,
      0xbf, 0x16, 0x0,  0xc,  0x93, 0x10, 0xac, 0x19, 0x9f, 0xac, 0x72, 0xdf, 0x5a, 0x66, 0x69, 0x2e, 0x2,  0x0,  0x0,
      0x7d, 0xac, 0x11, 0x0,  0x0,  0x58, 0x6e, 0x21, 0x4c, 0x15, 0x23, 0x4f, 0xd7, 0x19, 0xe7, 0x13, 0x58, 0x22, 0x27,
      0x0,  0x0,  0x4f, 0xfb, 0x22, 0x3a, 0x30, 0x1c, 0x0,  0x18, 0x9,  0x3,  0x4d, 0x62, 0x78, 0xfd, 0x5,  0x34, 0x41,
      0x7d, 0x45, 0x1a, 0x52, 0x9,  0x8a, 0x93, 0x8d, 0xc7, 0xfd, 0x2a, 0x56, 0x3d, 0xcd, 0x9d, 0x12, 0x0,  0x1d, 0x18,
      0xe6, 0x36, 0xe,  0xcc, 0xd4, 0x66, 0x89, 0x6d, 0xe3, 0x27, 0xea, 0xa6, 0x6f, 0xb0, 0xde, 0x88, 0x3d, 0x27, 0x46,
      0xb5, 0x89, 0x47, 0x79, 0xdc, 0xcc, 0x7,  0xc0, 0xa,  0x26, 0x0,  0x2,  0xf5, 0xc,  0x0,  0x13, 0xb0, 0xf4, 0xe6,
      0x8,  0xd5, 0x1,  0xc9, 0x6c, 0x50, 0x5c, 0x9e, 0xca, 0x7a, 0xa3, 0x21, 0xc6, 0x50, 0x85, 0xca, 0x1,  0xa1, 0x16,
      0x0,  0x13, 0x5c, 0x57, 0x19, 0x29, 0x8e, 0xb9, 0x11, 0x18, 0x83, 0x66, 0x2,  0xc8, 0x1e, 0xe6, 0x75, 0x93, 0xbb,
      0xa5, 0xcd, 0x0,  0x1b, 0xc4, 0xd0, 0x78, 0x91, 0x7,  0xc5, 0xec, 0xa6, 0xed, 0xc6, 0x5c, 0x2d, 0xde, 0x61, 0xd,
      0x8c, 0x9e, 0x4e, 0xc7, 0x37, 0xb2, 0x1e, 0x60, 0x3d, 0x3e, 0x21, 0x45, 0x0,  0x0,  0x3,  0xa3, 0x2f, 0x3f, 0x1,
      0x0,  0x1,  0x5f, 0x2,  0x0,  0x16, 0x5c, 0x9e, 0xe4, 0xdf, 0x17, 0x3a, 0x96, 0x29, 0x64, 0x59, 0x7c, 0x21, 0xec,
      0xcd, 0xa4, 0x73, 0x8b, 0xb,  0xa7, 0x3e, 0xdd, 0x19, 0x2,  0x0,  0x16, 0xe8, 0xd0, 0xb9, 0x66, 0x9d, 0xf7, 0x4e,
      0xbe, 0xbf, 0x3,  0xd4, 0x9,  0xd5, 0xe5, 0x1,  0x20, 0xce, 0xb,  0xb2, 0x40, 0xa2, 0x5e, 0x1,  0x0,  0xf,  0x6d,
      0x89, 0xb,  0xc,  0x37, 0x8d, 0x26, 0xd8, 0x40, 0x9e, 0x21, 0x1d, 0xc0, 0xbf, 0xbd, 0x1,  0x0,  0x4,  0x4,  0x67,
      0xf1, 0xa7, 0x1};

  uint8_t buf[374] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0xd0, 0x78, 0x91, 0x7,  0xc5, 0xec, 0xa6, 0xed, 0xc6, 0x5c, 0x2d, 0xde, 0x61,
                                     0xd,  0x8c, 0x9e, 0x4e, 0xc7, 0x37, 0xb2, 0x1e, 0x60, 0x3d, 0x3e, 0x21, 0x45};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa3, 0x2f, 0x3f};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5f};
  lwmqtt_string_t topic_filter_s2 = {1, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x5c, 0x9e, 0xe4, 0xdf, 0x17, 0x3a, 0x96, 0x29, 0x64, 0x59, 0x7c,
                                     0x21, 0xec, 0xcd, 0xa4, 0x73, 0x8b, 0xb,  0xa7, 0x3e, 0xdd, 0x19};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe8, 0xd0, 0xb9, 0x66, 0x9d, 0xf7, 0x4e, 0xbe, 0xbf, 0x3,  0xd4,
                                     0x9,  0xd5, 0xe5, 0x1,  0x20, 0xce, 0xb,  0xb2, 0x40, 0xa2, 0x5e};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x6d, 0x89, 0xb,  0xc,  0x37, 0x8d, 0x26, 0xd8,
                                     0x40, 0x9e, 0x21, 0x1d, 0xc0, 0xbf, 0xbd};
  lwmqtt_string_t topic_filter_s5 = {15, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x4, 0x67, 0xf1, 0xa7};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x7f, 0x3d, 0x7a, 0xcd, 0x80, 0xb5, 0x43, 0xe8, 0x2a, 0xf2, 0x3a, 0xe9, 0x4c, 0xb,  0x65,
                           0x34, 0x8f, 0x44, 0x9b, 0xd0, 0x30, 0x68, 0x74, 0x84, 0x5a, 0x7b, 0x1b, 0xee, 0x9f, 0xc9};
  uint8_t bytesprops1[] = {0x93};
  uint8_t bytesprops3[] = {0x80};
  uint8_t bytesprops2[] = {0x9d, 0xa,  0x6,  0xcb, 0x95, 0x80, 0x7,  0x16, 0x8e,
                           0x14, 0x7d, 0x85, 0xc1, 0xa8, 0xe4, 0xf3, 0xc8};
  uint8_t bytesprops4[] = {0x93, 0x10, 0xac, 0x19, 0x9f, 0xac, 0x72, 0xdf, 0x5a, 0x66, 0x69, 0x2e};
  uint8_t bytesprops5[] = {0x9,  0x3, 0x4d, 0x62, 0x78, 0xfd, 0x5,  0x34, 0x41, 0x7d, 0x45, 0x1a,
                           0x52, 0x9, 0x8a, 0x93, 0x8d, 0xc7, 0xfd, 0x2a, 0x56, 0x3d, 0xcd, 0x9d};
  uint8_t bytesprops6[] = {0x18, 0xe6, 0x36, 0xe,  0xcc, 0xd4, 0x66, 0x89, 0x6d, 0xe3, 0x27, 0xea, 0xa6, 0x6f, 0xb0,
                           0xde, 0x88, 0x3d, 0x27, 0x46, 0xb5, 0x89, 0x47, 0x79, 0xdc, 0xcc, 0x7,  0xc0, 0xa};
  uint8_t bytesprops8[] = {0xb0, 0xf4, 0xe6, 0x8,  0xd5, 0x1,  0xc9, 0x6c, 0x50, 0x5c,
                           0x9e, 0xca, 0x7a, 0xa3, 0x21, 0xc6, 0x50, 0x85, 0xca};
  uint8_t bytesprops7[] = {0xf5, 0xc};
  uint8_t bytesprops9[] = {0x5c, 0x57, 0x19, 0x29, 0x8e, 0xb9, 0x11, 0x18, 0x83, 0x66,
                           0x2,  0xc8, 0x1e, 0xe6, 0x75, 0x93, 0xbb, 0xa5, 0xcd};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 34}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 10247}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {30, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 248}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 28}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32489}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 21512}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {1, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25286}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {17, (char*)&bytesprops2}, .v = {1, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 24957}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 191}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 32172}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 22638}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 19477}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 20439}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 231}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 22562}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 20475}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 14896}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {29, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {2, (char*)&bytesprops7}, .v = {19, (char*)&bytesprops8}}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 161}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops9}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 28334, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 26598 [("=\225\250g\177\216\249\&8\252='RyD\192\199@\SOh\247\158\236\151\&4d\199\247",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("#\151\183Z\151O\182\172\150*i\\\161\230\221\176\251\180\217H;]\215\250\196L\201\228\DC3\244",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\243\152\219Kk\182Q,eE \RS*/\SYN\134V\DC3FyOS[",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\139\SOH\t\179g\DC3&n'\158C\223Y\254",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\205$\145XN\129y\188+2W2",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1})] [PropRequestResponseInformation 96,PropMessageExpiryInterval
// 28136,PropContentType
// "\214\134\176\130\223\&1\163\252\\\195\213\226\&5o\218Y6\177\140\252\204",PropRequestResponseInformation
// 139,PropReceiveMaximum 16930,PropUserProperty "\137\&1\174\174"
// "\244\252\233$*-\ESC\217z\183\165M\DC1\CAN\159S\238\232\175&|j\228U\226\171*pd\199",PropAssignedClientIdentifier
// "",PropCorrelationData "\FS\161",PropTopicAlias 6017,PropAuthenticationData
// "\NAKX\210\187\SO<\246\&2\208QF\165\205\152\145\252\203",PropReasonString
// "\165\194\150{sK\198\166\n2\174Q\213\194\&29\237_\EM!?\135\&3$\DEL\141Y\240\EM",PropResponseInformation
// "\t\245Mk@N\240\&4IC,^\249\DC2\179\SIq\211\135}v?8\135\190\159.\a.",PropReasonString
// "\f\214R3\DC2mI\182\202Dr\147\176h\ETXr\244\139\&9\NUL",PropReasonString "5\214y",PropSubscriptionIdentifierAvailable
// 161,PropSubscriptionIdentifierAvailable 197]
TEST(Subscribe5QCTest, Encode72) {
  uint8_t pkt[] = {
      0x82, 0xcb, 0x2,  0x67, 0xe6, 0xcb, 0x1,  0x19, 0x60, 0x2,  0x0,  0x0,  0x6d, 0xe8, 0x3,  0x0,  0x15, 0xd6, 0x86,
      0xb0, 0x82, 0xdf, 0x31, 0xa3, 0xfc, 0x5c, 0xc3, 0xd5, 0xe2, 0x35, 0x6f, 0xda, 0x59, 0x36, 0xb1, 0x8c, 0xfc, 0xcc,
      0x19, 0x8b, 0x21, 0x42, 0x22, 0x26, 0x0,  0x4,  0x89, 0x31, 0xae, 0xae, 0x0,  0x1e, 0xf4, 0xfc, 0xe9, 0x24, 0x2a,
      0x2d, 0x1b, 0xd9, 0x7a, 0xb7, 0xa5, 0x4d, 0x11, 0x18, 0x9f, 0x53, 0xee, 0xe8, 0xaf, 0x26, 0x7c, 0x6a, 0xe4, 0x55,
      0xe2, 0xab, 0x2a, 0x70, 0x64, 0xc7, 0x12, 0x0,  0x0,  0x9,  0x0,  0x2,  0x1c, 0xa1, 0x23, 0x17, 0x81, 0x16, 0x0,
      0x11, 0x15, 0x58, 0xd2, 0xbb, 0xe,  0x3c, 0xf6, 0x32, 0xd0, 0x51, 0x46, 0xa5, 0xcd, 0x98, 0x91, 0xfc, 0xcb, 0x1f,
      0x0,  0x1d, 0xa5, 0xc2, 0x96, 0x7b, 0x73, 0x4b, 0xc6, 0xa6, 0xa,  0x32, 0xae, 0x51, 0xd5, 0xc2, 0x32, 0x39, 0xed,
      0x5f, 0x19, 0x21, 0x3f, 0x87, 0x33, 0x24, 0x7f, 0x8d, 0x59, 0xf0, 0x19, 0x1a, 0x0,  0x1d, 0x9,  0xf5, 0x4d, 0x6b,
      0x40, 0x4e, 0xf0, 0x34, 0x49, 0x43, 0x2c, 0x5e, 0xf9, 0x12, 0xb3, 0xf,  0x71, 0xd3, 0x87, 0x7d, 0x76, 0x3f, 0x38,
      0x87, 0xbe, 0x9f, 0x2e, 0x7,  0x2e, 0x1f, 0x0,  0x14, 0xc,  0xd6, 0x52, 0x33, 0x12, 0x6d, 0x49, 0xb6, 0xca, 0x44,
      0x72, 0x93, 0xb0, 0x68, 0x3,  0x72, 0xf4, 0x8b, 0x39, 0x0,  0x1f, 0x0,  0x3,  0x35, 0xd6, 0x79, 0x29, 0xa1, 0x29,
      0xc5, 0x0,  0x1b, 0x3d, 0xe1, 0xfa, 0x67, 0xb1, 0xd8, 0xf9, 0x38, 0xfc, 0x3d, 0x27, 0x52, 0x79, 0x44, 0xc0, 0xc7,
      0x40, 0xe,  0x68, 0xf7, 0x9e, 0xec, 0x97, 0x34, 0x64, 0xc7, 0xf7, 0x2,  0x0,  0x0,  0x1,  0x0,  0x1e, 0x23, 0x97,
      0xb7, 0x5a, 0x97, 0x4f, 0xb6, 0xac, 0x96, 0x2a, 0x69, 0x5c, 0xa1, 0xe6, 0xdd, 0xb0, 0xfb, 0xb4, 0xd9, 0x48, 0x3b,
      0x5d, 0xd7, 0xfa, 0xc4, 0x4c, 0xc9, 0xe4, 0x13, 0xf4, 0x0,  0x0,  0x17, 0xf3, 0x98, 0xdb, 0x4b, 0x6b, 0xb6, 0x51,
      0x2c, 0x65, 0x45, 0x20, 0x1e, 0x2a, 0x2f, 0x16, 0x86, 0x56, 0x13, 0x46, 0x79, 0x4f, 0x53, 0x5b, 0x1,  0x0,  0xe,
      0x8b, 0x1,  0x9,  0xb3, 0x67, 0x13, 0x26, 0x6e, 0x27, 0x9e, 0x43, 0xdf, 0x59, 0xfe, 0x0,  0x0,  0xc,  0xcd, 0x24,
      0x91, 0x58, 0x4e, 0x81, 0x79, 0xbc, 0x2b, 0x32, 0x57, 0x32, 0x1};

  uint8_t buf[344] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x3d, 0xe1, 0xfa, 0x67, 0xb1, 0xd8, 0xf9, 0x38, 0xfc, 0x3d, 0x27, 0x52, 0x79, 0x44,
                                     0xc0, 0xc7, 0x40, 0xe,  0x68, 0xf7, 0x9e, 0xec, 0x97, 0x34, 0x64, 0xc7, 0xf7};
  lwmqtt_string_t topic_filter_s0 = {27, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x23, 0x97, 0xb7, 0x5a, 0x97, 0x4f, 0xb6, 0xac, 0x96, 0x2a,
                                     0x69, 0x5c, 0xa1, 0xe6, 0xdd, 0xb0, 0xfb, 0xb4, 0xd9, 0x48,
                                     0x3b, 0x5d, 0xd7, 0xfa, 0xc4, 0x4c, 0xc9, 0xe4, 0x13, 0xf4};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xf3, 0x98, 0xdb, 0x4b, 0x6b, 0xb6, 0x51, 0x2c, 0x65, 0x45, 0x20, 0x1e,
                                     0x2a, 0x2f, 0x16, 0x86, 0x56, 0x13, 0x46, 0x79, 0x4f, 0x53, 0x5b};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x8b, 0x1, 0x9, 0xb3, 0x67, 0x13, 0x26, 0x6e, 0x27, 0x9e, 0x43, 0xdf, 0x59, 0xfe};
  lwmqtt_string_t topic_filter_s4 = {14, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xcd, 0x24, 0x91, 0x58, 0x4e, 0x81, 0x79, 0xbc, 0x2b, 0x32, 0x57, 0x32};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xd6, 0x86, 0xb0, 0x82, 0xdf, 0x31, 0xa3, 0xfc, 0x5c, 0xc3, 0xd5,
                           0xe2, 0x35, 0x6f, 0xda, 0x59, 0x36, 0xb1, 0x8c, 0xfc, 0xcc};
  uint8_t bytesprops2[] = {0xf4, 0xfc, 0xe9, 0x24, 0x2a, 0x2d, 0x1b, 0xd9, 0x7a, 0xb7, 0xa5, 0x4d, 0x11, 0x18, 0x9f,
                           0x53, 0xee, 0xe8, 0xaf, 0x26, 0x7c, 0x6a, 0xe4, 0x55, 0xe2, 0xab, 0x2a, 0x70, 0x64, 0xc7};
  uint8_t bytesprops1[] = {0x89, 0x31, 0xae, 0xae};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0x1c, 0xa1};
  uint8_t bytesprops5[] = {0x15, 0x58, 0xd2, 0xbb, 0xe,  0x3c, 0xf6, 0x32, 0xd0,
                           0x51, 0x46, 0xa5, 0xcd, 0x98, 0x91, 0xfc, 0xcb};
  uint8_t bytesprops6[] = {0xa5, 0xc2, 0x96, 0x7b, 0x73, 0x4b, 0xc6, 0xa6, 0xa,  0x32, 0xae, 0x51, 0xd5, 0xc2, 0x32,
                           0x39, 0xed, 0x5f, 0x19, 0x21, 0x3f, 0x87, 0x33, 0x24, 0x7f, 0x8d, 0x59, 0xf0, 0x19};
  uint8_t bytesprops7[] = {0x9, 0xf5, 0x4d, 0x6b, 0x40, 0x4e, 0xf0, 0x34, 0x49, 0x43, 0x2c, 0x5e, 0xf9, 0x12, 0xb3,
                           0xf, 0x71, 0xd3, 0x87, 0x7d, 0x76, 0x3f, 0x38, 0x87, 0xbe, 0x9f, 0x2e, 0x7,  0x2e};
  uint8_t bytesprops8[] = {0xc,  0xd6, 0x52, 0x33, 0x12, 0x6d, 0x49, 0xb6, 0xca, 0x44,
                           0x72, 0x93, 0xb0, 0x68, 0x3,  0x72, 0xf4, 0x8b, 0x39, 0x0};
  uint8_t bytesprops9[] = {0x35, 0xd6, 0x79};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 96}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28136}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 139}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 16930}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {4, (char*)&bytesprops1}, .v = {30, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {2, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6017}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {17, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {29, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {20, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {3, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 161}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 197}},
  };

  lwmqtt_properties_t props = {16, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 26598, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8075 [("\153\219wC\224\141\212\158d\179\204\165\177\194fH\170\138^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\163{\DC4\190\210\150W\162\228}\131*;\DC1\208;\155n\214I\147\176\137\176",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\v\244\209y\179\242\230\161\147:u\140\228\&5k\177\179\250",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("<c\220Q\219\172,\169\135\208\141ks\132\"\227\SOH\199\136\SUB@",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\NAK\248\202\244\EMh#\175\134\193\250\DC2J\166o&_\ACK\FS\SUB\231\219\128",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationMethod
// "",PropResponseInformation "4\SUB\197K1\a\133\SYN2\212Zm\153",PropUserProperty
// "\140j\138Xy\US\140\152\239\233H\US2\242\227V\a\236\215^\218"
// "Y\206\182\148\&4\252Sf_\STX\170\244\245\137I\NAK-\225\248[P\191\228\244Dl'~",PropMaximumQoS
// 116,PropWillDelayInterval 29685,PropRequestProblemInformation 31,PropSubscriptionIdentifier 0,PropTopicAliasMaximum
// 19746,PropRequestResponseInformation 73,PropUserProperty "`\252\160\198\231V\202o"
// "\197.vQ\172\240;\v\146\DEL\138\252j\DLE\217\130\207IJ\253",PropRequestProblemInformation 204]
TEST(Subscribe5QCTest, Encode73) {
  uint8_t pkt[] = {0x82, 0xf7, 0x1,  0x1f, 0x8b, 0x7c, 0x15, 0x0,  0x0,  0x1a, 0x0,  0xd,  0x34, 0x1a, 0xc5, 0x4b, 0x31,
                   0x7,  0x85, 0x16, 0x32, 0xd4, 0x5a, 0x6d, 0x99, 0x26, 0x0,  0x15, 0x8c, 0x6a, 0x8a, 0x58, 0x79, 0x1f,
                   0x8c, 0x98, 0xef, 0xe9, 0x48, 0x1f, 0x32, 0xf2, 0xe3, 0x56, 0x7,  0xec, 0xd7, 0x5e, 0xda, 0x0,  0x1c,
                   0x59, 0xce, 0xb6, 0x94, 0x34, 0xfc, 0x53, 0x66, 0x5f, 0x2,  0xaa, 0xf4, 0xf5, 0x89, 0x49, 0x15, 0x2d,
                   0xe1, 0xf8, 0x5b, 0x50, 0xbf, 0xe4, 0xf4, 0x44, 0x6c, 0x27, 0x7e, 0x24, 0x74, 0x18, 0x0,  0x0,  0x73,
                   0xf5, 0x17, 0x1f, 0xb,  0x0,  0x22, 0x4d, 0x22, 0x19, 0x49, 0x26, 0x0,  0x8,  0x60, 0xfc, 0xa0, 0xc6,
                   0xe7, 0x56, 0xca, 0x6f, 0x0,  0x14, 0xc5, 0x2e, 0x76, 0x51, 0xac, 0xf0, 0x3b, 0xb,  0x92, 0x7f, 0x8a,
                   0xfc, 0x6a, 0x10, 0xd9, 0x82, 0xcf, 0x49, 0x4a, 0xfd, 0x17, 0xcc, 0x0,  0x13, 0x99, 0xdb, 0x77, 0x43,
                   0xe0, 0x8d, 0xd4, 0x9e, 0x64, 0xb3, 0xcc, 0xa5, 0xb1, 0xc2, 0x66, 0x48, 0xaa, 0x8a, 0x5e, 0x1,  0x0,
                   0x18, 0xa3, 0x7b, 0x14, 0xbe, 0xd2, 0x96, 0x57, 0xa2, 0xe4, 0x7d, 0x83, 0x2a, 0x3b, 0x11, 0xd0, 0x3b,
                   0x9b, 0x6e, 0xd6, 0x49, 0x93, 0xb0, 0x89, 0xb0, 0x2,  0x0,  0x12, 0xb,  0xf4, 0xd1, 0x79, 0xb3, 0xf2,
                   0xe6, 0xa1, 0x93, 0x3a, 0x75, 0x8c, 0xe4, 0x35, 0x6b, 0xb1, 0xb3, 0xfa, 0x2,  0x0,  0x15, 0x3c, 0x63,
                   0xdc, 0x51, 0xdb, 0xac, 0x2c, 0xa9, 0x87, 0xd0, 0x8d, 0x6b, 0x73, 0x84, 0x22, 0xe3, 0x1,  0xc7, 0x88,
                   0x1a, 0x40, 0x0,  0x0,  0x17, 0x15, 0xf8, 0xca, 0xf4, 0x19, 0x68, 0x23, 0xaf, 0x86, 0xc1, 0xfa, 0x12,
                   0x4a, 0xa6, 0x6f, 0x26, 0x5f, 0x6,  0x1c, 0x1a, 0xe7, 0xdb, 0x80, 0x0};

  uint8_t buf[260] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x99, 0xdb, 0x77, 0x43, 0xe0, 0x8d, 0xd4, 0x9e, 0x64, 0xb3,
                                     0xcc, 0xa5, 0xb1, 0xc2, 0x66, 0x48, 0xaa, 0x8a, 0x5e};
  lwmqtt_string_t topic_filter_s0 = {19, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xa3, 0x7b, 0x14, 0xbe, 0xd2, 0x96, 0x57, 0xa2, 0xe4, 0x7d, 0x83, 0x2a,
                                     0x3b, 0x11, 0xd0, 0x3b, 0x9b, 0x6e, 0xd6, 0x49, 0x93, 0xb0, 0x89, 0xb0};
  lwmqtt_string_t topic_filter_s1 = {24, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb,  0xf4, 0xd1, 0x79, 0xb3, 0xf2, 0xe6, 0xa1, 0x93,
                                     0x3a, 0x75, 0x8c, 0xe4, 0x35, 0x6b, 0xb1, 0xb3, 0xfa};
  lwmqtt_string_t topic_filter_s2 = {18, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x3c, 0x63, 0xdc, 0x51, 0xdb, 0xac, 0x2c, 0xa9, 0x87, 0xd0, 0x8d,
                                     0x6b, 0x73, 0x84, 0x22, 0xe3, 0x1,  0xc7, 0x88, 0x1a, 0x40};
  lwmqtt_string_t topic_filter_s3 = {21, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x15, 0xf8, 0xca, 0xf4, 0x19, 0x68, 0x23, 0xaf, 0x86, 0xc1, 0xfa, 0x12,
                                     0x4a, 0xa6, 0x6f, 0x26, 0x5f, 0x6,  0x1c, 0x1a, 0xe7, 0xdb, 0x80};
  lwmqtt_string_t topic_filter_s4 = {23, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0};
  uint8_t bytesprops1[] = {0x34, 0x1a, 0xc5, 0x4b, 0x31, 0x7, 0x85, 0x16, 0x32, 0xd4, 0x5a, 0x6d, 0x99};
  uint8_t bytesprops3[] = {0x59, 0xce, 0xb6, 0x94, 0x34, 0xfc, 0x53, 0x66, 0x5f, 0x2,  0xaa, 0xf4, 0xf5, 0x89,
                           0x49, 0x15, 0x2d, 0xe1, 0xf8, 0x5b, 0x50, 0xbf, 0xe4, 0xf4, 0x44, 0x6c, 0x27, 0x7e};
  uint8_t bytesprops2[] = {0x8c, 0x6a, 0x8a, 0x58, 0x79, 0x1f, 0x8c, 0x98, 0xef, 0xe9, 0x48,
                           0x1f, 0x32, 0xf2, 0xe3, 0x56, 0x7,  0xec, 0xd7, 0x5e, 0xda};
  uint8_t bytesprops5[] = {0xc5, 0x2e, 0x76, 0x51, 0xac, 0xf0, 0x3b, 0xb,  0x92, 0x7f,
                           0x8a, 0xfc, 0x6a, 0x10, 0xd9, 0x82, 0xcf, 0x49, 0x4a, 0xfd};
  uint8_t bytesprops4[] = {0x60, 0xfc, 0xa0, 0xc6, 0xe7, 0x56, 0xca, 0x6f};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {0, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {21, (char*)&bytesprops2}, .v = {28, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 116}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29685}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 31}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 0}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19746}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 73}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {8, (char*)&bytesprops4}, .v = {20, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 204}},
  };

  lwmqtt_properties_t props = {11, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 8075, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 17947 [("E",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\b\194\179\135\DEL\153\\",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS =
// QoS1}),("Ck\239\&5\r'\223d\205C\238\188\149\179\198\131\139\135\200j\152\135\161aZ5r\178",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("P\157\181\133\180{",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("hs_K\231\&7\ENQ\142\157\194\196\252\240\136)\157\159\167\255G",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("t\128h\134T\160\178ra\146\201",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("2\136\235\225",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("t\200\SOH\144\243\v\159F&\253\186*\163\136d\rA\DC1\ACK\209\"\DC1\193V\DC1",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\232\169\205\147\SYN\129\145\196#!\ACK\171I\225",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\215\221\EM\254/\164d>\184\211O\228\212N\251O\183\208V\241\211\t\209\244\RS\186",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropResponseTopic
// "\ENQ\140\&1\235e",PropSubscriptionIdentifierAvailable 44,PropSubscriptionIdentifierAvailable
// 21,PropMaximumPacketSize 27004,PropSubscriptionIdentifier 12,PropRequestResponseInformation 254]
TEST(Subscribe5QCTest, Encode74) {
  uint8_t pkt[] = {0x82, 0xc7, 0x1,  0x46, 0x1b, 0x15, 0x8,  0x0,  0x5,  0x5,  0x8c, 0x31, 0xeb, 0x65, 0x29, 0x2c, 0x29,
                   0x15, 0x27, 0x0,  0x0,  0x69, 0x7c, 0xb,  0xc,  0x19, 0xfe, 0x0,  0x1,  0x45, 0x0,  0x0,  0x7,  0x8,
                   0xc2, 0xb3, 0x87, 0x7f, 0x99, 0x5c, 0x1,  0x0,  0x1c, 0x43, 0x6b, 0xef, 0x35, 0xd,  0x27, 0xdf, 0x64,
                   0xcd, 0x43, 0xee, 0xbc, 0x95, 0xb3, 0xc6, 0x83, 0x8b, 0x87, 0xc8, 0x6a, 0x98, 0x87, 0xa1, 0x61, 0x5a,
                   0x35, 0x72, 0xb2, 0x0,  0x0,  0x6,  0x50, 0x9d, 0xb5, 0x85, 0xb4, 0x7b, 0x1,  0x0,  0x14, 0x68, 0x73,
                   0x5f, 0x4b, 0xe7, 0x37, 0x5,  0x8e, 0x9d, 0xc2, 0xc4, 0xfc, 0xf0, 0x88, 0x29, 0x9d, 0x9f, 0xa7, 0xff,
                   0x47, 0x0,  0x0,  0xb,  0x74, 0x80, 0x68, 0x86, 0x54, 0xa0, 0xb2, 0x72, 0x61, 0x92, 0xc9, 0x2,  0x0,
                   0x4,  0x32, 0x88, 0xeb, 0xe1, 0x0,  0x0,  0x0,  0x1,  0x0,  0x19, 0x74, 0xc8, 0x1,  0x90, 0xf3, 0xb,
                   0x9f, 0x46, 0x26, 0xfd, 0xba, 0x2a, 0xa3, 0x88, 0x64, 0xd,  0x41, 0x11, 0x6,  0xd1, 0x22, 0x11, 0xc1,
                   0x56, 0x11, 0x2,  0x0,  0xe,  0xe8, 0xa9, 0xcd, 0x93, 0x16, 0x81, 0x91, 0xc4, 0x23, 0x21, 0x6,  0xab,
                   0x49, 0xe1, 0x1,  0x0,  0x1a, 0xd7, 0xdd, 0x19, 0xfe, 0x2f, 0xa4, 0x64, 0x3e, 0xb8, 0xd3, 0x4f, 0xe4,
                   0xd4, 0x4e, 0xfb, 0x4f, 0xb7, 0xd0, 0x56, 0xf1, 0xd3, 0x9,  0xd1, 0xf4, 0x1e, 0xba, 0x1};

  uint8_t buf[212] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0x45};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x8, 0xc2, 0xb3, 0x87, 0x7f, 0x99, 0x5c};
  lwmqtt_string_t topic_filter_s1 = {7, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x43, 0x6b, 0xef, 0x35, 0xd,  0x27, 0xdf, 0x64, 0xcd, 0x43,
                                     0xee, 0xbc, 0x95, 0xb3, 0xc6, 0x83, 0x8b, 0x87, 0xc8, 0x6a,
                                     0x98, 0x87, 0xa1, 0x61, 0x5a, 0x35, 0x72, 0xb2};
  lwmqtt_string_t topic_filter_s2 = {28, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x50, 0x9d, 0xb5, 0x85, 0xb4, 0x7b};
  lwmqtt_string_t topic_filter_s3 = {6, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x68, 0x73, 0x5f, 0x4b, 0xe7, 0x37, 0x5,  0x8e, 0x9d, 0xc2,
                                     0xc4, 0xfc, 0xf0, 0x88, 0x29, 0x9d, 0x9f, 0xa7, 0xff, 0x47};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x74, 0x80, 0x68, 0x86, 0x54, 0xa0, 0xb2, 0x72, 0x61, 0x92, 0xc9};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x32, 0x88, 0xeb, 0xe1};
  lwmqtt_string_t topic_filter_s6 = {4, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0};
  lwmqtt_string_t topic_filter_s7 = {0, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x74, 0xc8, 0x1, 0x90, 0xf3, 0xb, 0x9f, 0x46, 0x26, 0xfd, 0xba, 0x2a, 0xa3,
                                     0x88, 0x64, 0xd, 0x41, 0x11, 0x6, 0xd1, 0x22, 0x11, 0xc1, 0x56, 0x11};
  lwmqtt_string_t topic_filter_s8 = {25, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0xe8, 0xa9, 0xcd, 0x93, 0x16, 0x81, 0x91, 0xc4, 0x23, 0x21, 0x6, 0xab, 0x49, 0xe1};
  lwmqtt_string_t topic_filter_s9 = {14, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0xd7, 0xdd, 0x19, 0xfe, 0x2f, 0xa4, 0x64, 0x3e, 0xb8, 0xd3, 0x4f, 0xe4, 0xd4,
                                      0x4e, 0xfb, 0x4f, 0xb7, 0xd0, 0x56, 0xf1, 0xd3, 0x9,  0xd1, 0xf4, 0x1e, 0xba};
  lwmqtt_string_t topic_filter_s10 = {26, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x5, 0x8c, 0x31, 0xeb, 0x65};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {5, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 44}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 21}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 27004}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 12}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 254}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 17947, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 167 [("\231\169\150\t\250\191\150<\142\244\175\168\192\184\179",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\212\vx}\a\239:\\|\164~\165\239\172\b\182j\"e\244",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\199\200~",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\US97\178\208\r#N\n\150nm+6\213\NUL\171\252\t",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\137\ETX\197\217\NUL\223\232\207\253\202\144V#\158k\156DSE2\145\ENQ\158\234\133\150",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("#\149\222<\ETXQ\182,\188$Y~(\178|T\176_\145\151'",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\175\ENQ\GS\245\242)\153\DC2\129\190\DC4\n\235\129\160 \190\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("DJ\236\247\\fp\240\131\213\DLEP\133\CAN\133",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\188n\248-\193\248\138\147\SI\181\to\137\t\148\230\233=",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropServerReference
// "\159\250\222\226B\146z{\n\GS\163Q>\212\209b\140\f^|\225!\ETBS",PropRequestProblemInformation 41,PropCorrelationData
// "\167\165\236\242\220\NUL!\243\239\236\249(50\143",PropCorrelationData "!V\136\227\201R\STX",PropReasonString
// "\204\220Z\199A\209\242\&4\137\ETB\182r\nQ\137\234P\239\174^&\SYN",PropRequestProblemInformation
// 146,PropResponseTopic "\153+\SYN\164\143\202\203\241\178\ETX/\129\179\SI\165:L\187\249aXN",PropSubscriptionIdentifier
// 13,PropRequestResponseInformation 80,PropMessageExpiryInterval 23274,PropReceiveMaximum
// 1962,PropSharedSubscriptionAvailable 149,PropMaximumQoS 62,PropResponseInformation
// "QD5\172e\226i\226F\131J\188\136",PropResponseTopic "\EM\160\CAN\131
// \229\162\139LF\219\159\167p,\217b\176\208\242Y\199I\US\246(\169",PropSharedSubscriptionAvailable
// 59,PropReceiveMaximum 31104,PropMessageExpiryInterval 8247,PropAssignedClientIdentifier
// "\GSA\148\189\b\203\157\128T\142%\EOT`\179{N\151l",PropRequestResponseInformation 165,PropRequestProblemInformation
// 246,PropAssignedClientIdentifier
// "\255\243\220\ENQ\239\198\194d\159\145\171\ENQ\f\149\EMH\176g\235",PropReceiveMaximum 18795]
TEST(Subscribe5QCTest, Encode75) {
  uint8_t pkt[] = {
      0x82, 0xa1, 0x3,  0x0,  0xa7, 0xe7, 0x1,  0x1c, 0x0,  0x18, 0x9f, 0xfa, 0xde, 0xe2, 0x42, 0x92, 0x7a, 0x7b, 0xa,
      0x1d, 0xa3, 0x51, 0x3e, 0xd4, 0xd1, 0x62, 0x8c, 0xc,  0x5e, 0x7c, 0xe1, 0x21, 0x17, 0x53, 0x17, 0x29, 0x9,  0x0,
      0xf,  0xa7, 0xa5, 0xec, 0xf2, 0xdc, 0x0,  0x21, 0xf3, 0xef, 0xec, 0xf9, 0x28, 0x35, 0x30, 0x8f, 0x9,  0x0,  0x7,
      0x21, 0x56, 0x88, 0xe3, 0xc9, 0x52, 0x2,  0x1f, 0x0,  0x16, 0xcc, 0xdc, 0x5a, 0xc7, 0x41, 0xd1, 0xf2, 0x34, 0x89,
      0x17, 0xb6, 0x72, 0xa,  0x51, 0x89, 0xea, 0x50, 0xef, 0xae, 0x5e, 0x26, 0x16, 0x17, 0x92, 0x8,  0x0,  0x16, 0x99,
      0x2b, 0x16, 0xa4, 0x8f, 0xca, 0xcb, 0xf1, 0xb2, 0x3,  0x2f, 0x81, 0xb3, 0xf,  0xa5, 0x3a, 0x4c, 0xbb, 0xf9, 0x61,
      0x58, 0x4e, 0xb,  0xd,  0x19, 0x50, 0x2,  0x0,  0x0,  0x5a, 0xea, 0x21, 0x7,  0xaa, 0x2a, 0x95, 0x24, 0x3e, 0x1a,
      0x0,  0xd,  0x51, 0x44, 0x35, 0xac, 0x65, 0xe2, 0x69, 0xe2, 0x46, 0x83, 0x4a, 0xbc, 0x88, 0x8,  0x0,  0x1b, 0x19,
      0xa0, 0x18, 0x83, 0x20, 0xe5, 0xa2, 0x8b, 0x4c, 0x46, 0xdb, 0x9f, 0xa7, 0x70, 0x2c, 0xd9, 0x62, 0xb0, 0xd0, 0xf2,
      0x59, 0xc7, 0x49, 0x1f, 0xf6, 0x28, 0xa9, 0x2a, 0x3b, 0x21, 0x79, 0x80, 0x2,  0x0,  0x0,  0x20, 0x37, 0x12, 0x0,
      0x12, 0x1d, 0x41, 0x94, 0xbd, 0x8,  0xcb, 0x9d, 0x80, 0x54, 0x8e, 0x25, 0x4,  0x60, 0xb3, 0x7b, 0x4e, 0x97, 0x6c,
      0x19, 0xa5, 0x17, 0xf6, 0x12, 0x0,  0x13, 0xff, 0xf3, 0xdc, 0x5,  0xef, 0xc6, 0xc2, 0x64, 0x9f, 0x91, 0xab, 0x5,
      0xc,  0x95, 0x19, 0x48, 0xb0, 0x67, 0xeb, 0x21, 0x49, 0x6b, 0x0,  0xf,  0xe7, 0xa9, 0x96, 0x9,  0xfa, 0xbf, 0x96,
      0x3c, 0x8e, 0xf4, 0xaf, 0xa8, 0xc0, 0xb8, 0xb3, 0x2,  0x0,  0x14, 0xd4, 0xb,  0x78, 0x7d, 0x7,  0xef, 0x3a, 0x5c,
      0x7c, 0xa4, 0x7e, 0xa5, 0xef, 0xac, 0x8,  0xb6, 0x6a, 0x22, 0x65, 0xf4, 0x2,  0x0,  0x3,  0xc7, 0xc8, 0x7e, 0x0,
      0x0,  0x13, 0x1f, 0x39, 0x37, 0xb2, 0xd0, 0xd,  0x23, 0x4e, 0xa,  0x96, 0x6e, 0x6d, 0x2b, 0x36, 0xd5, 0x0,  0xab,
      0xfc, 0x9,  0x2,  0x0,  0x1a, 0x89, 0x3,  0xc5, 0xd9, 0x0,  0xdf, 0xe8, 0xcf, 0xfd, 0xca, 0x90, 0x56, 0x23, 0x9e,
      0x6b, 0x9c, 0x44, 0x53, 0x45, 0x32, 0x91, 0x5,  0x9e, 0xea, 0x85, 0x96, 0x1,  0x0,  0x15, 0x23, 0x95, 0xde, 0x3c,
      0x3,  0x51, 0xb6, 0x2c, 0xbc, 0x24, 0x59, 0x7e, 0x28, 0xb2, 0x7c, 0x54, 0xb0, 0x5f, 0x91, 0x97, 0x27, 0x0,  0x0,
      0x12, 0xaf, 0x5,  0x1d, 0xf5, 0xf2, 0x29, 0x99, 0x12, 0x81, 0xbe, 0x14, 0xa,  0xeb, 0x81, 0xa0, 0x20, 0xbe, 0xe9,
      0x2,  0x0,  0xf,  0x44, 0x4a, 0xec, 0xf7, 0x5c, 0x66, 0x70, 0xf0, 0x83, 0xd5, 0x10, 0x50, 0x85, 0x18, 0x85, 0x1,
      0x0,  0x12, 0xbc, 0x6e, 0xf8, 0x2d, 0xc1, 0xf8, 0x8a, 0x93, 0xf,  0xb5, 0x9,  0x6f, 0x89, 0x9,  0x94, 0xe6, 0xe9,
      0x3d, 0x1};

  uint8_t buf[430] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0xe7, 0xa9, 0x96, 0x9,  0xfa, 0xbf, 0x96, 0x3c,
                                     0x8e, 0xf4, 0xaf, 0xa8, 0xc0, 0xb8, 0xb3};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xd4, 0xb,  0x78, 0x7d, 0x7, 0xef, 0x3a, 0x5c, 0x7c, 0xa4,
                                     0x7e, 0xa5, 0xef, 0xac, 0x8, 0xb6, 0x6a, 0x22, 0x65, 0xf4};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xc7, 0xc8, 0x7e};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1f, 0x39, 0x37, 0xb2, 0xd0, 0xd, 0x23, 0x4e, 0xa, 0x96,
                                     0x6e, 0x6d, 0x2b, 0x36, 0xd5, 0x0, 0xab, 0xfc, 0x9};
  lwmqtt_string_t topic_filter_s3 = {19, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x89, 0x3,  0xc5, 0xd9, 0x0,  0xdf, 0xe8, 0xcf, 0xfd, 0xca, 0x90, 0x56, 0x23,
                                     0x9e, 0x6b, 0x9c, 0x44, 0x53, 0x45, 0x32, 0x91, 0x5,  0x9e, 0xea, 0x85, 0x96};
  lwmqtt_string_t topic_filter_s4 = {26, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x23, 0x95, 0xde, 0x3c, 0x3,  0x51, 0xb6, 0x2c, 0xbc, 0x24, 0x59,
                                     0x7e, 0x28, 0xb2, 0x7c, 0x54, 0xb0, 0x5f, 0x91, 0x97, 0x27};
  lwmqtt_string_t topic_filter_s5 = {21, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xaf, 0x5,  0x1d, 0xf5, 0xf2, 0x29, 0x99, 0x12, 0x81,
                                     0xbe, 0x14, 0xa,  0xeb, 0x81, 0xa0, 0x20, 0xbe, 0xe9};
  lwmqtt_string_t topic_filter_s6 = {18, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x44, 0x4a, 0xec, 0xf7, 0x5c, 0x66, 0x70, 0xf0,
                                     0x83, 0xd5, 0x10, 0x50, 0x85, 0x18, 0x85};
  lwmqtt_string_t topic_filter_s7 = {15, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xbc, 0x6e, 0xf8, 0x2d, 0xc1, 0xf8, 0x8a, 0x93, 0xf,
                                     0xb5, 0x9,  0x6f, 0x89, 0x9,  0x94, 0xe6, 0xe9, 0x3d};
  lwmqtt_string_t topic_filter_s8 = {18, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x9f, 0xfa, 0xde, 0xe2, 0x42, 0x92, 0x7a, 0x7b, 0xa,  0x1d, 0xa3, 0x51,
                           0x3e, 0xd4, 0xd1, 0x62, 0x8c, 0xc,  0x5e, 0x7c, 0xe1, 0x21, 0x17, 0x53};
  uint8_t bytesprops1[] = {0xa7, 0xa5, 0xec, 0xf2, 0xdc, 0x0, 0x21, 0xf3, 0xef, 0xec, 0xf9, 0x28, 0x35, 0x30, 0x8f};
  uint8_t bytesprops2[] = {0x21, 0x56, 0x88, 0xe3, 0xc9, 0x52, 0x2};
  uint8_t bytesprops3[] = {0xcc, 0xdc, 0x5a, 0xc7, 0x41, 0xd1, 0xf2, 0x34, 0x89, 0x17, 0xb6,
                           0x72, 0xa,  0x51, 0x89, 0xea, 0x50, 0xef, 0xae, 0x5e, 0x26, 0x16};
  uint8_t bytesprops4[] = {0x99, 0x2b, 0x16, 0xa4, 0x8f, 0xca, 0xcb, 0xf1, 0xb2, 0x3,  0x2f,
                           0x81, 0xb3, 0xf,  0xa5, 0x3a, 0x4c, 0xbb, 0xf9, 0x61, 0x58, 0x4e};
  uint8_t bytesprops5[] = {0x51, 0x44, 0x35, 0xac, 0x65, 0xe2, 0x69, 0xe2, 0x46, 0x83, 0x4a, 0xbc, 0x88};
  uint8_t bytesprops6[] = {0x19, 0xa0, 0x18, 0x83, 0x20, 0xe5, 0xa2, 0x8b, 0x4c, 0x46, 0xdb, 0x9f, 0xa7, 0x70,
                           0x2c, 0xd9, 0x62, 0xb0, 0xd0, 0xf2, 0x59, 0xc7, 0x49, 0x1f, 0xf6, 0x28, 0xa9};
  uint8_t bytesprops7[] = {0x1d, 0x41, 0x94, 0xbd, 0x8,  0xcb, 0x9d, 0x80, 0x54,
                           0x8e, 0x25, 0x4,  0x60, 0xb3, 0x7b, 0x4e, 0x97, 0x6c};
  uint8_t bytesprops8[] = {0xff, 0xf3, 0xdc, 0x5,  0xef, 0xc6, 0xc2, 0x64, 0x9f, 0x91,
                           0xab, 0x5,  0xc,  0x95, 0x19, 0x48, 0xb0, 0x67, 0xeb};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {24, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 41}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {15, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {7, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {22, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 146}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {22, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 13}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 80}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23274}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 1962}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 149}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 62}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {13, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 59}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 31104}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8247}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {18, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 165}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 246}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {19, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 18795}},
  };

  lwmqtt_properties_t props = {23, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 167, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 3223 [("U#\128\166r\217",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("\198l]6!\158\151\NUL\255\155|\156\254",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropMessageExpiryInterval
// 18865,PropRetainAvailable 202,PropTopicAlias 15710,PropResponseInformation
// "\238\&7\201Y\185y\211Ij\205\207\ACK\162\ETX",PropReasonString
// "!c\200DX\145\208I\215\184\&1\174\131\234\202\132\159\164\222\159q&\189<\203\145",PropReceiveMaximum
// 29462,PropMaximumQoS 133,PropMessageExpiryInterval 13197,PropReceiveMaximum 15894,PropSubscriptionIdentifierAvailable
// 133,PropTopicAlias 18101,PropMessageExpiryInterval 16249,PropSessionExpiryInterval 17732,PropResponseInformation
// ";\155\231\222\240\216\162M\195\&3x\ACKxX\STXm",PropSessionExpiryInterval 3716,PropMessageExpiryInterval
// 31538,PropRetainAvailable 30,PropRequestResponseInformation 254,PropContentType
// "\208\GSp\244\&3\210sa{\134\SUB\204\129%\213\162\159\185['K5\146\251\173",PropRetainAvailable 147,PropCorrelationData
// "\185vv\211r;\240\137",PropRetainAvailable 46,PropTopicAlias 12882,PropWildcardSubscriptionAvailable
// 188,PropTopicAlias 15907,PropAuthenticationData "\167\141\SOuS\147\248k\STX\218X\189\203\&7$\242x\181\&0<\v\253\168\a
// ",PropMaximumPacketSize 8047]
TEST(Subscribe5QCTest, Encode76) {
  uint8_t pkt[] = {0x82, 0xe6, 0x1,  0xc,  0x97, 0xc9, 0x1,  0x2,  0x0,  0x0,  0x49, 0xb1, 0x25, 0xca, 0x23, 0x3d, 0x5e,
                   0x1a, 0x0,  0xe,  0xee, 0x37, 0xc9, 0x59, 0xb9, 0x79, 0xd3, 0x49, 0x6a, 0xcd, 0xcf, 0x6,  0xa2, 0x3,
                   0x1f, 0x0,  0x1a, 0x21, 0x63, 0xc8, 0x44, 0x58, 0x91, 0xd0, 0x49, 0xd7, 0xb8, 0x31, 0xae, 0x83, 0xea,
                   0xca, 0x84, 0x9f, 0xa4, 0xde, 0x9f, 0x71, 0x26, 0xbd, 0x3c, 0xcb, 0x91, 0x21, 0x73, 0x16, 0x24, 0x85,
                   0x2,  0x0,  0x0,  0x33, 0x8d, 0x21, 0x3e, 0x16, 0x29, 0x85, 0x23, 0x46, 0xb5, 0x2,  0x0,  0x0,  0x3f,
                   0x79, 0x11, 0x0,  0x0,  0x45, 0x44, 0x1a, 0x0,  0x10, 0x3b, 0x9b, 0xe7, 0xde, 0xf0, 0xd8, 0xa2, 0x4d,
                   0xc3, 0x33, 0x78, 0x6,  0x78, 0x58, 0x2,  0x6d, 0x11, 0x0,  0x0,  0xe,  0x84, 0x2,  0x0,  0x0,  0x7b,
                   0x32, 0x25, 0x1e, 0x19, 0xfe, 0x3,  0x0,  0x19, 0xd0, 0x1d, 0x70, 0xf4, 0x33, 0xd2, 0x73, 0x61, 0x7b,
                   0x86, 0x1a, 0xcc, 0x81, 0x25, 0xd5, 0xa2, 0x9f, 0xb9, 0x5b, 0x27, 0x4b, 0x35, 0x92, 0xfb, 0xad, 0x25,
                   0x93, 0x9,  0x0,  0x8,  0xb9, 0x76, 0x76, 0xd3, 0x72, 0x3b, 0xf0, 0x89, 0x25, 0x2e, 0x23, 0x32, 0x52,
                   0x28, 0xbc, 0x23, 0x3e, 0x23, 0x16, 0x0,  0x19, 0xa7, 0x8d, 0xe,  0x75, 0x53, 0x93, 0xf8, 0x6b, 0x2,
                   0xda, 0x58, 0xbd, 0xcb, 0x37, 0x24, 0xf2, 0x78, 0xb5, 0x30, 0x3c, 0xb,  0xfd, 0xa8, 0x7,  0x20, 0x27,
                   0x0,  0x0,  0x1f, 0x6f, 0x0,  0x6,  0x55, 0x23, 0x80, 0xa6, 0x72, 0xd9, 0x0,  0x0,  0xd,  0xc6, 0x6c,
                   0x5d, 0x36, 0x21, 0x9e, 0x97, 0x0,  0xff, 0x9b, 0x7c, 0x9c, 0xfe, 0x1};

  uint8_t buf[243] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0x55, 0x23, 0x80, 0xa6, 0x72, 0xd9};
  lwmqtt_string_t topic_filter_s0 = {6, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc6, 0x6c, 0x5d, 0x36, 0x21, 0x9e, 0x97, 0x0, 0xff, 0x9b, 0x7c, 0x9c, 0xfe};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xee, 0x37, 0xc9, 0x59, 0xb9, 0x79, 0xd3, 0x49, 0x6a, 0xcd, 0xcf, 0x6, 0xa2, 0x3};
  uint8_t bytesprops1[] = {0x21, 0x63, 0xc8, 0x44, 0x58, 0x91, 0xd0, 0x49, 0xd7, 0xb8, 0x31, 0xae, 0x83,
                           0xea, 0xca, 0x84, 0x9f, 0xa4, 0xde, 0x9f, 0x71, 0x26, 0xbd, 0x3c, 0xcb, 0x91};
  uint8_t bytesprops2[] = {0x3b, 0x9b, 0xe7, 0xde, 0xf0, 0xd8, 0xa2, 0x4d,
                           0xc3, 0x33, 0x78, 0x6,  0x78, 0x58, 0x2,  0x6d};
  uint8_t bytesprops3[] = {0xd0, 0x1d, 0x70, 0xf4, 0x33, 0xd2, 0x73, 0x61, 0x7b, 0x86, 0x1a, 0xcc, 0x81,
                           0x25, 0xd5, 0xa2, 0x9f, 0xb9, 0x5b, 0x27, 0x4b, 0x35, 0x92, 0xfb, 0xad};
  uint8_t bytesprops4[] = {0xb9, 0x76, 0x76, 0xd3, 0x72, 0x3b, 0xf0, 0x89};
  uint8_t bytesprops5[] = {0xa7, 0x8d, 0xe,  0x75, 0x53, 0x93, 0xf8, 0x6b, 0x2,  0xda, 0x58, 0xbd, 0xcb,
                           0x37, 0x24, 0xf2, 0x78, 0xb5, 0x30, 0x3c, 0xb,  0xfd, 0xa8, 0x7,  0x20};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18865}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 202}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15710}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {26, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29462}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 133}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13197}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15894}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 133}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18101}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16249}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 17732}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {16, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 3716}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31538}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 30}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 254}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {25, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 147}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {8, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 46}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 12882}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 188}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 15907}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {25, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 8047}},
  };

  lwmqtt_properties_t props = {27, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 3223, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1845 [("\196\128\&4\163O\255",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("f\255\128\199\ETXD\164B\184\249 \251\243\158TM\242\130",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("d@V!\249\199\168\166\194\241\244\243y\202\222\203\132\164\184\145\196\164",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\SYN\197\232MQ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\242W\198\204\146t\ESC\192'\177\DC49>\166`{\152Q\247v\213\133\EM \160~@",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\229\252\136\170\181]\155\129\151\157\222\219P\163\177\130\146F\205",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\234\196[a\EOTi\137\214",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\232\&4\187\230\144aj3\ETB\EM\162%t\228",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\STXv\213",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\"=\211\194\176",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropTopicAlias
// 21229,PropMessageExpiryInterval 5033,PropWillDelayInterval 9775,PropWildcardSubscriptionAvailable
// 227,PropUserProperty "\162\141\132\193:%{\193\EM\199\159["
// "\144\172\ACK@5\206\203\141\f\218:\223.zN\176\226I;\150",PropMaximumQoS 255,PropServerReference
// "\151\DEL|\194\172\180o\208\163o\176m\250\ESC\159\223\188&.\173\144\v\233\179\210\224",PropSessionExpiryInterval
// 14355,PropWildcardSubscriptionAvailable 15,PropAssignedClientIdentifier
// "\DC2<\FSy\144\SYN\170\216\159\140H\151s\195Z6\220W\215H,\SUB\137",PropRetainAvailable
// 162,PropRequestProblemInformation 225,PropResponseInformation
// "{\197{\170\210\200\204\&8^\144\154\195K\EOT\209z\231\243\131\222k\185\171\221b\170^\159\195",PropTopicAlias
// 6806,PropResponseTopic "\US9\206\131\NUL\145\DC1\233\226\&7\FS\135",PropContentType
// "D",PropSharedSubscriptionAvailable 205,PropMessageExpiryInterval 31351,PropWillDelayInterval
// 12650,PropMessageExpiryInterval 30600,PropSubscriptionIdentifier 30,PropAuthenticationData
// "D\188\255kP\167x\228\DC3v\164\246`\144=\203\152R\242"]
TEST(Subscribe5QCTest, Encode77) {
  uint8_t pkt[] = {
      0x82, 0xfb, 0x2,  0x7,  0x35, 0xd7, 0x1,  0x23, 0x52, 0xed, 0x2,  0x0,  0x0,  0x13, 0xa9, 0x18, 0x0,  0x0,  0x26,
      0x2f, 0x28, 0xe3, 0x26, 0x0,  0xc,  0xa2, 0x8d, 0x84, 0xc1, 0x3a, 0x25, 0x7b, 0xc1, 0x19, 0xc7, 0x9f, 0x5b, 0x0,
      0x14, 0x90, 0xac, 0x6,  0x40, 0x35, 0xce, 0xcb, 0x8d, 0xc,  0xda, 0x3a, 0xdf, 0x2e, 0x7a, 0x4e, 0xb0, 0xe2, 0x49,
      0x3b, 0x96, 0x24, 0xff, 0x1c, 0x0,  0x1a, 0x97, 0x7f, 0x7c, 0xc2, 0xac, 0xb4, 0x6f, 0xd0, 0xa3, 0x6f, 0xb0, 0x6d,
      0xfa, 0x1b, 0x9f, 0xdf, 0xbc, 0x26, 0x2e, 0xad, 0x90, 0xb,  0xe9, 0xb3, 0xd2, 0xe0, 0x11, 0x0,  0x0,  0x38, 0x13,
      0x28, 0xf,  0x12, 0x0,  0x17, 0x12, 0x3c, 0x1c, 0x79, 0x90, 0x16, 0xaa, 0xd8, 0x9f, 0x8c, 0x48, 0x97, 0x73, 0xc3,
      0x5a, 0x36, 0xdc, 0x57, 0xd7, 0x48, 0x2c, 0x1a, 0x89, 0x25, 0xa2, 0x17, 0xe1, 0x1a, 0x0,  0x1d, 0x7b, 0xc5, 0x7b,
      0xaa, 0xd2, 0xc8, 0xcc, 0x38, 0x5e, 0x90, 0x9a, 0xc3, 0x4b, 0x4,  0xd1, 0x7a, 0xe7, 0xf3, 0x83, 0xde, 0x6b, 0xb9,
      0xab, 0xdd, 0x62, 0xaa, 0x5e, 0x9f, 0xc3, 0x23, 0x1a, 0x96, 0x8,  0x0,  0xc,  0x1f, 0x39, 0xce, 0x83, 0x0,  0x91,
      0x11, 0xe9, 0xe2, 0x37, 0x1c, 0x87, 0x3,  0x0,  0x1,  0x44, 0x2a, 0xcd, 0x2,  0x0,  0x0,  0x7a, 0x77, 0x18, 0x0,
      0x0,  0x31, 0x6a, 0x2,  0x0,  0x0,  0x77, 0x88, 0xb,  0x1e, 0x16, 0x0,  0x13, 0x44, 0xbc, 0xff, 0x6b, 0x50, 0xa7,
      0x78, 0xe4, 0x13, 0x76, 0xa4, 0xf6, 0x60, 0x90, 0x3d, 0xcb, 0x98, 0x52, 0xf2, 0x0,  0x6,  0xc4, 0x80, 0x34, 0xa3,
      0x4f, 0xff, 0x2,  0x0,  0x12, 0x66, 0xff, 0x80, 0xc7, 0x3,  0x44, 0xa4, 0x42, 0xb8, 0xf9, 0x20, 0xfb, 0xf3, 0x9e,
      0x54, 0x4d, 0xf2, 0x82, 0x0,  0x0,  0x16, 0x64, 0x40, 0x56, 0x21, 0xf9, 0xc7, 0xa8, 0xa6, 0xc2, 0xf1, 0xf4, 0xf3,
      0x79, 0xca, 0xde, 0xcb, 0x84, 0xa4, 0xb8, 0x91, 0xc4, 0xa4, 0x0,  0x0,  0x5,  0x16, 0xc5, 0xe8, 0x4d, 0x51, 0x1,
      0x0,  0x1b, 0xf2, 0x57, 0xc6, 0xcc, 0x92, 0x74, 0x1b, 0xc0, 0x27, 0xb1, 0x14, 0x39, 0x3e, 0xa6, 0x60, 0x7b, 0x98,
      0x51, 0xf7, 0x76, 0xd5, 0x85, 0x19, 0x20, 0xa0, 0x7e, 0x40, 0x0,  0x0,  0x13, 0xe5, 0xfc, 0x88, 0xaa, 0xb5, 0x5d,
      0x9b, 0x81, 0x97, 0x9d, 0xde, 0xdb, 0x50, 0xa3, 0xb1, 0x82, 0x92, 0x46, 0xcd, 0x1,  0x0,  0x0,  0x0,  0x0,  0x8,
      0xea, 0xc4, 0x5b, 0x61, 0x4,  0x69, 0x89, 0xd6, 0x2,  0x0,  0xe,  0xe8, 0x34, 0xbb, 0xe6, 0x90, 0x61, 0x6a, 0x33,
      0x17, 0x19, 0xa2, 0x25, 0x74, 0xe4, 0x0,  0x0,  0x3,  0x2,  0x76, 0xd5, 0x2,  0x0,  0x5,  0x22, 0x3d, 0xd3, 0xc2,
      0xb0, 0x2};

  uint8_t buf[392] = {0};

  lwmqtt_string_t topic_filters[11];
  uint8_t topic_filter_s0_bytes[] = {0xc4, 0x80, 0x34, 0xa3, 0x4f, 0xff};
  lwmqtt_string_t topic_filter_s0 = {6, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x66, 0xff, 0x80, 0xc7, 0x3,  0x44, 0xa4, 0x42, 0xb8,
                                     0xf9, 0x20, 0xfb, 0xf3, 0x9e, 0x54, 0x4d, 0xf2, 0x82};
  lwmqtt_string_t topic_filter_s1 = {18, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x64, 0x40, 0x56, 0x21, 0xf9, 0xc7, 0xa8, 0xa6, 0xc2, 0xf1, 0xf4,
                                     0xf3, 0x79, 0xca, 0xde, 0xcb, 0x84, 0xa4, 0xb8, 0x91, 0xc4, 0xa4};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x16, 0xc5, 0xe8, 0x4d, 0x51};
  lwmqtt_string_t topic_filter_s3 = {5, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xf2, 0x57, 0xc6, 0xcc, 0x92, 0x74, 0x1b, 0xc0, 0x27, 0xb1, 0x14, 0x39, 0x3e, 0xa6,
                                     0x60, 0x7b, 0x98, 0x51, 0xf7, 0x76, 0xd5, 0x85, 0x19, 0x20, 0xa0, 0x7e, 0x40};
  lwmqtt_string_t topic_filter_s4 = {27, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xe5, 0xfc, 0x88, 0xaa, 0xb5, 0x5d, 0x9b, 0x81, 0x97, 0x9d,
                                     0xde, 0xdb, 0x50, 0xa3, 0xb1, 0x82, 0x92, 0x46, 0xcd};
  lwmqtt_string_t topic_filter_s5 = {19, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0};
  lwmqtt_string_t topic_filter_s6 = {0, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xea, 0xc4, 0x5b, 0x61, 0x4, 0x69, 0x89, 0xd6};
  lwmqtt_string_t topic_filter_s7 = {8, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xe8, 0x34, 0xbb, 0xe6, 0x90, 0x61, 0x6a,
                                     0x33, 0x17, 0x19, 0xa2, 0x25, 0x74, 0xe4};
  lwmqtt_string_t topic_filter_s8 = {14, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x2, 0x76, 0xd5};
  lwmqtt_string_t topic_filter_s9 = {3, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  uint8_t topic_filter_s10_bytes[] = {0x22, 0x3d, 0xd3, 0xc2, 0xb0};
  lwmqtt_string_t topic_filter_s10 = {5, (char*)&topic_filter_s10_bytes};
  topic_filters[10] = topic_filter_s10;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops1[] = {0x90, 0xac, 0x6,  0x40, 0x35, 0xce, 0xcb, 0x8d, 0xc,  0xda,
                           0x3a, 0xdf, 0x2e, 0x7a, 0x4e, 0xb0, 0xe2, 0x49, 0x3b, 0x96};
  uint8_t bytesprops0[] = {0xa2, 0x8d, 0x84, 0xc1, 0x3a, 0x25, 0x7b, 0xc1, 0x19, 0xc7, 0x9f, 0x5b};
  uint8_t bytesprops2[] = {0x97, 0x7f, 0x7c, 0xc2, 0xac, 0xb4, 0x6f, 0xd0, 0xa3, 0x6f, 0xb0, 0x6d, 0xfa,
                           0x1b, 0x9f, 0xdf, 0xbc, 0x26, 0x2e, 0xad, 0x90, 0xb,  0xe9, 0xb3, 0xd2, 0xe0};
  uint8_t bytesprops3[] = {0x12, 0x3c, 0x1c, 0x79, 0x90, 0x16, 0xaa, 0xd8, 0x9f, 0x8c, 0x48, 0x97,
                           0x73, 0xc3, 0x5a, 0x36, 0xdc, 0x57, 0xd7, 0x48, 0x2c, 0x1a, 0x89};
  uint8_t bytesprops4[] = {0x7b, 0xc5, 0x7b, 0xaa, 0xd2, 0xc8, 0xcc, 0x38, 0x5e, 0x90, 0x9a, 0xc3, 0x4b, 0x4, 0xd1,
                           0x7a, 0xe7, 0xf3, 0x83, 0xde, 0x6b, 0xb9, 0xab, 0xdd, 0x62, 0xaa, 0x5e, 0x9f, 0xc3};
  uint8_t bytesprops5[] = {0x1f, 0x39, 0xce, 0x83, 0x0, 0x91, 0x11, 0xe9, 0xe2, 0x37, 0x1c, 0x87};
  uint8_t bytesprops6[] = {0x44};
  uint8_t bytesprops7[] = {0x44, 0xbc, 0xff, 0x6b, 0x50, 0xa7, 0x78, 0xe4, 0x13, 0x76,
                           0xa4, 0xf6, 0x60, 0x90, 0x3d, 0xcb, 0x98, 0x52, 0xf2};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 21229}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5033}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 9775}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 227}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {12, (char*)&bytesprops0}, .v = {20, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 255}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {26, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 14355}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 15}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {23, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 162}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 225}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {29, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6806}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {1, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 205}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31351}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 12650}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 30600}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 30}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {19, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1845, 11, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 12377 [("\156\222Z\207\145\DC1\171\133j\149\210Dr\137\&1\130\219\182 2H\210\203s",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropUserProperty
// "\DC4" "u\208\RS\233\"\219\SUB\211{G\250\142\a|\SO\206\221=\166\a\b.\USG\234",PropTopicAlias
// 28621,PropSharedSubscriptionAvailable 82,PropRetainAvailable 188,PropWildcardSubscriptionAvailable 205,PropMaximumQoS
// 207,PropSubscriptionIdentifierAvailable 249,PropMessageExpiryInterval 21158,PropSessionExpiryInterval
// 21268,PropSessionExpiryInterval 31778,PropAuthenticationMethod
// "\157\&4\177\242\134\GS\ESC\187R\131y3\255.\STX",PropAssignedClientIdentifier
// "\"\183\DC1\222\220\183b\193\198m\v\211\&7\205\205\225\128\GS",PropTopicAlias 11340,PropRequestProblemInformation
// 134,PropMessageExpiryInterval 16425]
TEST(Subscribe5QCTest, Encode78) {
  uint8_t pkt[] = {0x82, 0x8a, 0x1,  0x30, 0x59, 0x6c, 0x26, 0x0,  0x1,  0x14, 0x0,  0x19, 0x75, 0xd0, 0x1e, 0xe9,
                   0x22, 0xdb, 0x1a, 0xd3, 0x7b, 0x47, 0xfa, 0x8e, 0x7,  0x7c, 0xe,  0xce, 0xdd, 0x3d, 0xa6, 0x7,
                   0x8,  0x2e, 0x1f, 0x47, 0xea, 0x23, 0x6f, 0xcd, 0x2a, 0x52, 0x25, 0xbc, 0x28, 0xcd, 0x24, 0xcf,
                   0x29, 0xf9, 0x2,  0x0,  0x0,  0x52, 0xa6, 0x11, 0x0,  0x0,  0x53, 0x14, 0x11, 0x0,  0x0,  0x7c,
                   0x22, 0x15, 0x0,  0xf,  0x9d, 0x34, 0xb1, 0xf2, 0x86, 0x1d, 0x1b, 0xbb, 0x52, 0x83, 0x79, 0x33,
                   0xff, 0x2e, 0x2,  0x12, 0x0,  0x12, 0x22, 0xb7, 0x11, 0xde, 0xdc, 0xb7, 0x62, 0xc1, 0xc6, 0x6d,
                   0xb,  0xd3, 0x37, 0xcd, 0xcd, 0xe1, 0x80, 0x1d, 0x23, 0x2c, 0x4c, 0x17, 0x86, 0x2,  0x0,  0x0,
                   0x40, 0x29, 0x0,  0x18, 0x9c, 0xde, 0x5a, 0xcf, 0x91, 0x11, 0xab, 0x85, 0x6a, 0x95, 0xd2, 0x44,
                   0x72, 0x89, 0x31, 0x82, 0xdb, 0xb6, 0x20, 0x32, 0x48, 0xd2, 0xcb, 0x73, 0x1};

  uint8_t buf[151] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x9c, 0xde, 0x5a, 0xcf, 0x91, 0x11, 0xab, 0x85, 0x6a, 0x95, 0xd2, 0x44,
                                     0x72, 0x89, 0x31, 0x82, 0xdb, 0xb6, 0x20, 0x32, 0x48, 0xd2, 0xcb, 0x73};
  lwmqtt_string_t topic_filter_s0 = {24, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops1[] = {0x75, 0xd0, 0x1e, 0xe9, 0x22, 0xdb, 0x1a, 0xd3, 0x7b, 0x47, 0xfa, 0x8e, 0x7,
                           0x7c, 0xe,  0xce, 0xdd, 0x3d, 0xa6, 0x7,  0x8,  0x2e, 0x1f, 0x47, 0xea};
  uint8_t bytesprops0[] = {0x14};
  uint8_t bytesprops2[] = {0x9d, 0x34, 0xb1, 0xf2, 0x86, 0x1d, 0x1b, 0xbb, 0x52, 0x83, 0x79, 0x33, 0xff, 0x2e, 0x2};
  uint8_t bytesprops3[] = {0x22, 0xb7, 0x11, 0xde, 0xdc, 0xb7, 0x62, 0xc1, 0xc6,
                           0x6d, 0xb,  0xd3, 0x37, 0xcd, 0xcd, 0xe1, 0x80, 0x1d};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {1, (char*)&bytesprops0}, .v = {25, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 28621}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 82}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 188}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 205}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 207}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 249}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21158}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 21268}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31778}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {15, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {18, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11340}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 134}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 16425}},
  };

  lwmqtt_properties_t props = {15, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 12377, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 290 [("-\CAN\FSe\144\STXP\243wu\191%\250\176\&5\250\204V\239\137}",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\128&U[\222\&1,\232\&9\137\194\vD\146\155m\DLE\213\249\229d\FSI+\v]",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\232g?\215\156\STXD\132\NUL\197\ACK(\234:\DC1\153C\148\b/\180^",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\176\160\178:&\NUL\182\\\173\RS\138\144\138@\148U\ENQA>\191\&1t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),(".\162!\217\216*\155\205\236\RSc\tEWe2\159'\216\149\193\235\DC1[\200\188\233\230\215",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\187\152j\248\219\&2\152\&3\SO\GS\135",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\176\144m\168\226",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\227\202\180@6a",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("|\129\183e\162\160X\243e\238E\183\184\128SY\157\EM6\253",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropTopicAlias
// 24863,PropWildcardSubscriptionAvailable 239,PropUserProperty "{Z"
// "\186\233\227\247%\136R",PropWildcardSubscriptionAvailable 225,PropSessionExpiryInterval 19459,PropCorrelationData
// "\v\132\148-\145\ETB\191\228'Y\230\150\207q\218\140",PropContentType "",PropAssignedClientIdentifier
// "\a\200\136\148\t\162\222q\192",PropReasonString
// "\128^\"\EOT\DC4\201Z\SOH$\172\218\249G\147\&5>",PropTopicAliasMaximum 20513,PropContentType
// "\216r\EOTN\213\231\185\146\197\a\193k\ETB\170\246\227\174JI\192\FS\230\228v'\193\128\209=\144",PropServerReference
// "m@:"]
TEST(Subscribe5QCTest, Encode79) {
  uint8_t pkt[] = {
      0x82, 0xb9, 0x2,  0x1,  0x22, 0x79, 0x23, 0x61, 0x1f, 0x28, 0xef, 0x26, 0x0,  0x2,  0x7b, 0x5a, 0x0,  0x7,  0xba,
      0xe9, 0xe3, 0xf7, 0x25, 0x88, 0x52, 0x28, 0xe1, 0x11, 0x0,  0x0,  0x4c, 0x3,  0x9,  0x0,  0x10, 0xb,  0x84, 0x94,
      0x2d, 0x91, 0x17, 0xbf, 0xe4, 0x27, 0x59, 0xe6, 0x96, 0xcf, 0x71, 0xda, 0x8c, 0x3,  0x0,  0x0,  0x12, 0x0,  0x9,
      0x7,  0xc8, 0x88, 0x94, 0x9,  0xa2, 0xde, 0x71, 0xc0, 0x1f, 0x0,  0x10, 0x80, 0x5e, 0x22, 0x4,  0x14, 0xc9, 0x5a,
      0x1,  0x24, 0xac, 0xda, 0xf9, 0x47, 0x93, 0x35, 0x3e, 0x22, 0x50, 0x21, 0x3,  0x0,  0x1e, 0xd8, 0x72, 0x4,  0x4e,
      0xd5, 0xe7, 0xb9, 0x92, 0xc5, 0x7,  0xc1, 0x6b, 0x17, 0xaa, 0xf6, 0xe3, 0xae, 0x4a, 0x49, 0xc0, 0x1c, 0xe6, 0xe4,
      0x76, 0x27, 0xc1, 0x80, 0xd1, 0x3d, 0x90, 0x1c, 0x0,  0x3,  0x6d, 0x40, 0x3a, 0x0,  0x15, 0x2d, 0x18, 0x1c, 0x65,
      0x90, 0x2,  0x50, 0xf3, 0x77, 0x75, 0xbf, 0x25, 0xfa, 0xb0, 0x35, 0xfa, 0xcc, 0x56, 0xef, 0x89, 0x7d, 0x1,  0x0,
      0x1a, 0x80, 0x26, 0x55, 0x5b, 0xde, 0x31, 0x2c, 0xe8, 0x39, 0x89, 0xc2, 0xb,  0x44, 0x92, 0x9b, 0x6d, 0x10, 0xd5,
      0xf9, 0xe5, 0x64, 0x1c, 0x49, 0x2b, 0xb,  0x5d, 0x0,  0x0,  0x16, 0xe8, 0x67, 0x3f, 0xd7, 0x9c, 0x2,  0x44, 0x84,
      0x0,  0xc5, 0x6,  0x28, 0xea, 0x3a, 0x11, 0x99, 0x43, 0x94, 0x8,  0x2f, 0xb4, 0x5e, 0x1,  0x0,  0x16, 0xb0, 0xa0,
      0xb2, 0x3a, 0x26, 0x0,  0xb6, 0x5c, 0xad, 0x1e, 0x8a, 0x90, 0x8a, 0x40, 0x94, 0x55, 0x5,  0x41, 0x3e, 0xbf, 0x31,
      0x74, 0x1,  0x0,  0x1d, 0x2e, 0xa2, 0x21, 0xd9, 0xd8, 0x2a, 0x9b, 0xcd, 0xec, 0x1e, 0x63, 0x9,  0x45, 0x57, 0x65,
      0x32, 0x9f, 0x27, 0xd8, 0x95, 0xc1, 0xeb, 0x11, 0x5b, 0xc8, 0xbc, 0xe9, 0xe6, 0xd7, 0x2,  0x0,  0xb,  0xbb, 0x98,
      0x6a, 0xf8, 0xdb, 0x32, 0x98, 0x33, 0xe,  0x1d, 0x87, 0x2,  0x0,  0x5,  0xb0, 0x90, 0x6d, 0xa8, 0xe2, 0x1,  0x0,
      0x6,  0xe3, 0xca, 0xb4, 0x40, 0x36, 0x61, 0x2,  0x0,  0x14, 0x7c, 0x81, 0xb7, 0x65, 0xa2, 0xa0, 0x58, 0xf3, 0x65,
      0xee, 0x45, 0xb7, 0xb8, 0x80, 0x53, 0x59, 0x9d, 0x19, 0x36, 0xfd, 0x1};

  uint8_t buf[326] = {0};

  lwmqtt_string_t topic_filters[9];
  uint8_t topic_filter_s0_bytes[] = {0x2d, 0x18, 0x1c, 0x65, 0x90, 0x2,  0x50, 0xf3, 0x77, 0x75, 0xbf,
                                     0x25, 0xfa, 0xb0, 0x35, 0xfa, 0xcc, 0x56, 0xef, 0x89, 0x7d};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x80, 0x26, 0x55, 0x5b, 0xde, 0x31, 0x2c, 0xe8, 0x39, 0x89, 0xc2, 0xb, 0x44,
                                     0x92, 0x9b, 0x6d, 0x10, 0xd5, 0xf9, 0xe5, 0x64, 0x1c, 0x49, 0x2b, 0xb, 0x5d};
  lwmqtt_string_t topic_filter_s1 = {26, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe8, 0x67, 0x3f, 0xd7, 0x9c, 0x2,  0x44, 0x84, 0x0,  0xc5, 0x6,
                                     0x28, 0xea, 0x3a, 0x11, 0x99, 0x43, 0x94, 0x8,  0x2f, 0xb4, 0x5e};
  lwmqtt_string_t topic_filter_s2 = {22, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb0, 0xa0, 0xb2, 0x3a, 0x26, 0x0, 0xb6, 0x5c, 0xad, 0x1e, 0x8a,
                                     0x90, 0x8a, 0x40, 0x94, 0x55, 0x5, 0x41, 0x3e, 0xbf, 0x31, 0x74};
  lwmqtt_string_t topic_filter_s3 = {22, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x2e, 0xa2, 0x21, 0xd9, 0xd8, 0x2a, 0x9b, 0xcd, 0xec, 0x1e,
                                     0x63, 0x9,  0x45, 0x57, 0x65, 0x32, 0x9f, 0x27, 0xd8, 0x95,
                                     0xc1, 0xeb, 0x11, 0x5b, 0xc8, 0xbc, 0xe9, 0xe6, 0xd7};
  lwmqtt_string_t topic_filter_s4 = {29, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xbb, 0x98, 0x6a, 0xf8, 0xdb, 0x32, 0x98, 0x33, 0xe, 0x1d, 0x87};
  lwmqtt_string_t topic_filter_s5 = {11, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xb0, 0x90, 0x6d, 0xa8, 0xe2};
  lwmqtt_string_t topic_filter_s6 = {5, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xe3, 0xca, 0xb4, 0x40, 0x36, 0x61};
  lwmqtt_string_t topic_filter_s7 = {6, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0x7c, 0x81, 0xb7, 0x65, 0xa2, 0xa0, 0x58, 0xf3, 0x65, 0xee,
                                     0x45, 0xb7, 0xb8, 0x80, 0x53, 0x59, 0x9d, 0x19, 0x36, 0xfd};
  lwmqtt_string_t topic_filter_s8 = {20, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops1[] = {0xba, 0xe9, 0xe3, 0xf7, 0x25, 0x88, 0x52};
  uint8_t bytesprops0[] = {0x7b, 0x5a};
  uint8_t bytesprops2[] = {0xb,  0x84, 0x94, 0x2d, 0x91, 0x17, 0xbf, 0xe4,
                           0x27, 0x59, 0xe6, 0x96, 0xcf, 0x71, 0xda, 0x8c};
  uint8_t bytesprops3[] = {0};
  uint8_t bytesprops4[] = {0x7, 0xc8, 0x88, 0x94, 0x9, 0xa2, 0xde, 0x71, 0xc0};
  uint8_t bytesprops5[] = {0x80, 0x5e, 0x22, 0x4,  0x14, 0xc9, 0x5a, 0x1,
                           0x24, 0xac, 0xda, 0xf9, 0x47, 0x93, 0x35, 0x3e};
  uint8_t bytesprops6[] = {0xd8, 0x72, 0x4,  0x4e, 0xd5, 0xe7, 0xb9, 0x92, 0xc5, 0x7,  0xc1, 0x6b, 0x17, 0xaa, 0xf6,
                           0xe3, 0xae, 0x4a, 0x49, 0xc0, 0x1c, 0xe6, 0xe4, 0x76, 0x27, 0xc1, 0x80, 0xd1, 0x3d, 0x90};
  uint8_t bytesprops7[] = {0x6d, 0x40, 0x3a};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 24863}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 239}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {2, (char*)&bytesprops0}, .v = {7, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 225}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19459}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {0, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {9, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {16, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 20513}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {30, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {3, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {12, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 290, 9, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 28088 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS2}),(":\193@\178\186\219\136\180",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\254\238]\245\184?\239",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("W'\132<\DC3\nUBMC\159\172b\NUL\185",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1})] [PropRequestProblemInformation 165,PropUserProperty
// "\242N\RS\214\&9\199\245ZQ" "",PropServerReference "\235\207Mm\ETB",PropAuthenticationData
// "\131X\147\FSD\246",PropServerReference
// "\219\149tsY\SI\152#5\DC3\225\f\255\233\SO\SOH\205\182\163$\255\223\224\246\SI\150\tOE\226",PropMessageExpiryInterval
// 28313,PropSubscriptionIdentifierAvailable 11,PropServerKeepAlive 2536,PropSubscriptionIdentifierAvailable
// 53,PropSubscriptionIdentifierAvailable 117,PropSubscriptionIdentifier 23,PropCorrelationData
// "/\164\vQ\174\ACK",PropRequestResponseInformation 202,PropSubscriptionIdentifierAvailable 246,PropMaximumQoS
// 136,PropMaximumQoS 177,PropAuthenticationMethod "\215\v\NUL5\249\n",PropTopicAliasMaximum
// 24195,PropSessionExpiryInterval 19137,PropSharedSubscriptionAvailable 204,PropReceiveMaximum
// 12776,PropAuthenticationData "\160KZ\159r\143R\136\226\239vy\SYN\DC4\FS\204\SOH\228"]
TEST(Subscribe5QCTest, Encode80) {
  uint8_t pkt[] = {0x82, 0xbc, 0x1,  0x6d, 0xb8, 0x8e, 0x1,  0x17, 0xa5, 0x26, 0x0,  0x9,  0xf2, 0x4e, 0x1e, 0xd6,
                   0x39, 0xc7, 0xf5, 0x5a, 0x51, 0x0,  0x0,  0x1c, 0x0,  0x5,  0xeb, 0xcf, 0x4d, 0x6d, 0x17, 0x16,
                   0x0,  0x6,  0x83, 0x58, 0x93, 0x1c, 0x44, 0xf6, 0x1c, 0x0,  0x1e, 0xdb, 0x95, 0x74, 0x73, 0x59,
                   0xf,  0x98, 0x23, 0x35, 0x13, 0xe1, 0xc,  0xff, 0xe9, 0xe,  0x1,  0xcd, 0xb6, 0xa3, 0x24, 0xff,
                   0xdf, 0xe0, 0xf6, 0xf,  0x96, 0x9,  0x4f, 0x45, 0xe2, 0x2,  0x0,  0x0,  0x6e, 0x99, 0x29, 0xb,
                   0x13, 0x9,  0xe8, 0x29, 0x35, 0x29, 0x75, 0xb,  0x17, 0x9,  0x0,  0x6,  0x2f, 0xa4, 0xb,  0x51,
                   0xae, 0x6,  0x19, 0xca, 0x29, 0xf6, 0x24, 0x88, 0x24, 0xb1, 0x15, 0x0,  0x6,  0xd7, 0xb,  0x0,
                   0x35, 0xf9, 0xa,  0x22, 0x5e, 0x83, 0x11, 0x0,  0x0,  0x4a, 0xc1, 0x2a, 0xcc, 0x21, 0x31, 0xe8,
                   0x16, 0x0,  0x12, 0xa0, 0x4b, 0x5a, 0x9f, 0x72, 0x8f, 0x52, 0x88, 0xe2, 0xef, 0x76, 0x79, 0x16,
                   0x14, 0x1c, 0xcc, 0x1,  0xe4, 0x0,  0x0,  0x2,  0x0,  0x8,  0x3a, 0xc1, 0x40, 0xb2, 0xba, 0xdb,
                   0x88, 0xb4, 0x2,  0x0,  0x7,  0xfe, 0xee, 0x5d, 0xf5, 0xb8, 0x3f, 0xef, 0x0,  0x0,  0xf,  0x57,
                   0x27, 0x84, 0x3c, 0x13, 0xa,  0x55, 0x42, 0x4d, 0x43, 0x9f, 0xac, 0x62, 0x0,  0xb9, 0x1};

  uint8_t buf[201] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x3a, 0xc1, 0x40, 0xb2, 0xba, 0xdb, 0x88, 0xb4};
  lwmqtt_string_t topic_filter_s1 = {8, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xfe, 0xee, 0x5d, 0xf5, 0xb8, 0x3f, 0xef};
  lwmqtt_string_t topic_filter_s2 = {7, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x57, 0x27, 0x84, 0x3c, 0x13, 0xa, 0x55, 0x42,
                                     0x4d, 0x43, 0x9f, 0xac, 0x62, 0x0, 0xb9};
  lwmqtt_string_t topic_filter_s3 = {15, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops1[] = {0};
  uint8_t bytesprops0[] = {0xf2, 0x4e, 0x1e, 0xd6, 0x39, 0xc7, 0xf5, 0x5a, 0x51};
  uint8_t bytesprops2[] = {0xeb, 0xcf, 0x4d, 0x6d, 0x17};
  uint8_t bytesprops3[] = {0x83, 0x58, 0x93, 0x1c, 0x44, 0xf6};
  uint8_t bytesprops4[] = {0xdb, 0x95, 0x74, 0x73, 0x59, 0xf,  0x98, 0x23, 0x35, 0x13, 0xe1, 0xc, 0xff, 0xe9, 0xe,
                           0x1,  0xcd, 0xb6, 0xa3, 0x24, 0xff, 0xdf, 0xe0, 0xf6, 0xf,  0x96, 0x9, 0x4f, 0x45, 0xe2};
  uint8_t bytesprops5[] = {0x2f, 0xa4, 0xb, 0x51, 0xae, 0x6};
  uint8_t bytesprops6[] = {0xd7, 0xb, 0x0, 0x35, 0xf9, 0xa};
  uint8_t bytesprops7[] = {0xa0, 0x4b, 0x5a, 0x9f, 0x72, 0x8f, 0x52, 0x88, 0xe2,
                           0xef, 0x76, 0x79, 0x16, 0x14, 0x1c, 0xcc, 0x1,  0xe4};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 165}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {9, (char*)&bytesprops0}, .v = {0, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {5, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {6, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {30, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28313}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 11}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 2536}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 53}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 117}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 23}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {6, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 202}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 246}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 136}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 177}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {6, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24195}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 19137}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 204}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 12776}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {18, (char*)&bytesprops7}}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 28088, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4272 [("\":\159\"\202S\RS\ACK\244z5",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\242\235\190\253wC6\EMH\250\232\247\131u\172\a=\132\224\&9\192 \GS",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\222!bl\193ck\202\&8K",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\162\190\167\211\FS\232\161;\130{%\ENQ\ACK\200\DC1\153\206\DC2\172b\193r\138",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("!",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropServerReference
// "g\GS,j\141\215\ETXY\202\154\226>\167\230\b9",PropPayloadFormatIndicator 19]
TEST(Subscribe5QCTest, Encode81) {
  uint8_t pkt[] = {0x82, 0x6b, 0x10, 0xb0, 0x15, 0x1c, 0x0,  0x10, 0x67, 0x1d, 0x2c, 0x6a, 0x8d, 0xd7, 0x3,  0x59,
                   0xca, 0x9a, 0xe2, 0x3e, 0xa7, 0xe6, 0x8,  0x39, 0x1,  0x13, 0x0,  0xb,  0x22, 0x3a, 0x9f, 0x22,
                   0xca, 0x53, 0x1e, 0x6,  0xf4, 0x7a, 0x35, 0x2,  0x0,  0x17, 0xf2, 0xeb, 0xbe, 0xfd, 0x77, 0x43,
                   0x36, 0x19, 0x48, 0xfa, 0xe8, 0xf7, 0x83, 0x75, 0xac, 0x7,  0x3d, 0x84, 0xe0, 0x39, 0xc0, 0x20,
                   0x1d, 0x0,  0x0,  0xa,  0xde, 0x21, 0x62, 0x6c, 0xc1, 0x63, 0x6b, 0xca, 0x38, 0x4b, 0x0,  0x0,
                   0x17, 0xa2, 0xbe, 0xa7, 0xd3, 0x1c, 0xe8, 0xa1, 0x3b, 0x82, 0x7b, 0x25, 0x5,  0x6,  0xc8, 0x11,
                   0x99, 0xce, 0x12, 0xac, 0x62, 0xc1, 0x72, 0x8a, 0x2,  0x0,  0x1,  0x21, 0x2};

  uint8_t buf[119] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0x22, 0x3a, 0x9f, 0x22, 0xca, 0x53, 0x1e, 0x6, 0xf4, 0x7a, 0x35};
  lwmqtt_string_t topic_filter_s0 = {11, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xf2, 0xeb, 0xbe, 0xfd, 0x77, 0x43, 0x36, 0x19, 0x48, 0xfa, 0xe8, 0xf7,
                                     0x83, 0x75, 0xac, 0x7,  0x3d, 0x84, 0xe0, 0x39, 0xc0, 0x20, 0x1d};
  lwmqtt_string_t topic_filter_s1 = {23, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xde, 0x21, 0x62, 0x6c, 0xc1, 0x63, 0x6b, 0xca, 0x38, 0x4b};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xa2, 0xbe, 0xa7, 0xd3, 0x1c, 0xe8, 0xa1, 0x3b, 0x82, 0x7b, 0x25, 0x5,
                                     0x6,  0xc8, 0x11, 0x99, 0xce, 0x12, 0xac, 0x62, 0xc1, 0x72, 0x8a};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x21};
  lwmqtt_string_t topic_filter_s4 = {1, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x67, 0x1d, 0x2c, 0x6a, 0x8d, 0xd7, 0x3, 0x59,
                           0xca, 0x9a, 0xe2, 0x3e, 0xa7, 0xe6, 0x8, 0x39};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {16, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 19}},
  };

  lwmqtt_properties_t props = {2, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4272, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14420 [("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\193\143\248\171\SUBB\US\162U`\238\207",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\230\138\SIF\159~gN\227\241|",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("'\194\SUB\DC1\143+,\"\128\209\SUB\220\162\DC1\240\196\DC3\226\NUL\146\226:\STX\189J*~&\200",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("~3\195L&]\160\184\161\STX\168\181#Em!\205\252K\253",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("dI\177g\202Vp4k\ENQ\178\255z\171x\212\STX\224\RSS\FS\169\144\180\151\182\201",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("6\NAK\EOT\145\216\229B\EM\247\242\&1b\223\131\141",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropRequestProblemInformation
// 252,PropAssignedClientIdentifier
// "%B\255}\155\198\220`\225\SUB\199A\186\240\129\&2\DLE\236y\186",PropMessageExpiryInterval 25332]
TEST(Subscribe5QCTest, Encode82) {
  uint8_t pkt[] = {
      0x82, 0xa8, 0x1,  0x38, 0x54, 0x1e, 0x17, 0xfc, 0x12, 0x0,  0x14, 0x25, 0x42, 0xff, 0x7d, 0x9b, 0xc6, 0xdc, 0x60,
      0xe1, 0x1a, 0xc7, 0x41, 0xba, 0xf0, 0x81, 0x32, 0x10, 0xec, 0x79, 0xba, 0x2,  0x0,  0x0,  0x62, 0xf4, 0x0,  0x0,
      0x0,  0x0,  0xc,  0xc1, 0x8f, 0xf8, 0xab, 0x1a, 0x42, 0x1f, 0xa2, 0x55, 0x60, 0xee, 0xcf, 0x0,  0x0,  0xb,  0xe6,
      0x8a, 0xf,  0x46, 0x9f, 0x7e, 0x67, 0x4e, 0xe3, 0xf1, 0x7c, 0x0,  0x0,  0x1d, 0x27, 0xc2, 0x1a, 0x11, 0x8f, 0x2b,
      0x2c, 0x22, 0x80, 0xd1, 0x1a, 0xdc, 0xa2, 0x11, 0xf0, 0xc4, 0x13, 0xe2, 0x0,  0x92, 0xe2, 0x3a, 0x2,  0xbd, 0x4a,
      0x2a, 0x7e, 0x26, 0xc8, 0x2,  0x0,  0x14, 0x7e, 0x33, 0xc3, 0x4c, 0x26, 0x5d, 0xa0, 0xb8, 0xa1, 0x2,  0xa8, 0xb5,
      0x23, 0x45, 0x6d, 0x21, 0xcd, 0xfc, 0x4b, 0xfd, 0x2,  0x0,  0x1b, 0x64, 0x49, 0xb1, 0x67, 0xca, 0x56, 0x70, 0x34,
      0x6b, 0x5,  0xb2, 0xff, 0x7a, 0xab, 0x78, 0xd4, 0x2,  0xe0, 0x1e, 0x53, 0x1c, 0xa9, 0x90, 0xb4, 0x97, 0xb6, 0xc9,
      0x2,  0x0,  0xf,  0x36, 0x15, 0x4,  0x91, 0xd8, 0xe5, 0x42, 0x19, 0xf7, 0xf2, 0x31, 0x62, 0xdf, 0x83, 0x8d, 0x2};

  uint8_t buf[181] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0};
  lwmqtt_string_t topic_filter_s0 = {0, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc1, 0x8f, 0xf8, 0xab, 0x1a, 0x42, 0x1f, 0xa2, 0x55, 0x60, 0xee, 0xcf};
  lwmqtt_string_t topic_filter_s1 = {12, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe6, 0x8a, 0xf, 0x46, 0x9f, 0x7e, 0x67, 0x4e, 0xe3, 0xf1, 0x7c};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x27, 0xc2, 0x1a, 0x11, 0x8f, 0x2b, 0x2c, 0x22, 0x80, 0xd1,
                                     0x1a, 0xdc, 0xa2, 0x11, 0xf0, 0xc4, 0x13, 0xe2, 0x0,  0x92,
                                     0xe2, 0x3a, 0x2,  0xbd, 0x4a, 0x2a, 0x7e, 0x26, 0xc8};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x7e, 0x33, 0xc3, 0x4c, 0x26, 0x5d, 0xa0, 0xb8, 0xa1, 0x2,
                                     0xa8, 0xb5, 0x23, 0x45, 0x6d, 0x21, 0xcd, 0xfc, 0x4b, 0xfd};
  lwmqtt_string_t topic_filter_s4 = {20, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x64, 0x49, 0xb1, 0x67, 0xca, 0x56, 0x70, 0x34, 0x6b, 0x5,  0xb2, 0xff, 0x7a, 0xab,
                                     0x78, 0xd4, 0x2,  0xe0, 0x1e, 0x53, 0x1c, 0xa9, 0x90, 0xb4, 0x97, 0xb6, 0xc9};
  lwmqtt_string_t topic_filter_s5 = {27, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x36, 0x15, 0x4,  0x91, 0xd8, 0xe5, 0x42, 0x19,
                                     0xf7, 0xf2, 0x31, 0x62, 0xdf, 0x83, 0x8d};
  lwmqtt_string_t topic_filter_s6 = {15, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2,
                               LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x25, 0x42, 0xff, 0x7d, 0x9b, 0xc6, 0xdc, 0x60, 0xe1, 0x1a,
                           0xc7, 0x41, 0xba, 0xf0, 0x81, 0x32, 0x10, 0xec, 0x79, 0xba};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 252}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {20, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25332}},
  };

  lwmqtt_properties_t props = {3, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14420, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 27160 [("\162D\159",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS2}),("\195_\131\NULo|\DC3\153\204\130Z\129\a\148$\133jPw\238<\201\&1X\151F\133\248\217l",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\168\&1\255\241I\162\173v\254uZ*\140G",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS =
// QoS1}),("\US=\184j\\AA\155\156@\178\229r'K0i\204\ESC\168Q'\196\226\234\233",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropSharedSubscriptionAvailable
// 187,PropWildcardSubscriptionAvailable 85,PropReasonString "a~\212\\2\174",PropMessageExpiryInterval
// 1915,PropAuthenticationMethod "\203\EOT\163\f\ETB\185g+ny",PropMaximumQoS 220,PropReasonString
// "}m\a\DEL\205\&6'n\191\249\179d\213\200",PropSessionExpiryInterval 29557,PropCorrelationData
// "\160\194{\148{\SI\195\&8\174\f3\165\142\231(\180\145\NAK\216\214\152\201\187",PropWildcardSubscriptionAvailable 203]
TEST(Subscribe5QCTest, Encode83) {
  uint8_t pkt[] = {0x82, 0xab, 0x1,  0x6a, 0x18, 0x53, 0x2a, 0xbb, 0x28, 0x55, 0x1f, 0x0,  0x6,  0x61, 0x7e, 0xd4,
                   0x5c, 0x32, 0xae, 0x2,  0x0,  0x0,  0x7,  0x7b, 0x15, 0x0,  0xa,  0xcb, 0x4,  0xa3, 0xc,  0x17,
                   0xb9, 0x67, 0x2b, 0x6e, 0x79, 0x24, 0xdc, 0x1f, 0x0,  0xe,  0x7d, 0x6d, 0x7,  0x7f, 0xcd, 0x36,
                   0x27, 0x6e, 0xbf, 0xf9, 0xb3, 0x64, 0xd5, 0xc8, 0x11, 0x0,  0x0,  0x73, 0x75, 0x9,  0x0,  0x17,
                   0xa0, 0xc2, 0x7b, 0x94, 0x7b, 0xf,  0xc3, 0x38, 0xae, 0xc,  0x33, 0xa5, 0x8e, 0xe7, 0x28, 0xb4,
                   0x91, 0x15, 0xd8, 0xd6, 0x98, 0xc9, 0xbb, 0x28, 0xcb, 0x0,  0x3,  0xa2, 0x44, 0x9f, 0x2,  0x0,
                   0x1e, 0xc3, 0x5f, 0x83, 0x0,  0x6f, 0x7c, 0x13, 0x99, 0xcc, 0x82, 0x5a, 0x81, 0x7,  0x94, 0x24,
                   0x85, 0x6a, 0x50, 0x77, 0xee, 0x3c, 0xc9, 0x31, 0x58, 0x97, 0x46, 0x85, 0xf8, 0xd9, 0x6c, 0x2,
                   0x0,  0xe,  0xa8, 0x31, 0xff, 0xf1, 0x49, 0xa2, 0xad, 0x76, 0xfe, 0x75, 0x5a, 0x2a, 0x8c, 0x47,
                   0x1,  0x0,  0x1a, 0x1f, 0x3d, 0xb8, 0x6a, 0x5c, 0x41, 0x41, 0x9b, 0x9c, 0x40, 0xb2, 0xe5, 0x72,
                   0x27, 0x4b, 0x30, 0x69, 0xcc, 0x1b, 0xa8, 0x51, 0x27, 0xc4, 0xe2, 0xea, 0xe9, 0x2};

  uint8_t buf[184] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0xa2, 0x44, 0x9f};
  lwmqtt_string_t topic_filter_s0 = {3, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xc3, 0x5f, 0x83, 0x0,  0x6f, 0x7c, 0x13, 0x99, 0xcc, 0x82,
                                     0x5a, 0x81, 0x7,  0x94, 0x24, 0x85, 0x6a, 0x50, 0x77, 0xee,
                                     0x3c, 0xc9, 0x31, 0x58, 0x97, 0x46, 0x85, 0xf8, 0xd9, 0x6c};
  lwmqtt_string_t topic_filter_s1 = {30, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa8, 0x31, 0xff, 0xf1, 0x49, 0xa2, 0xad,
                                     0x76, 0xfe, 0x75, 0x5a, 0x2a, 0x8c, 0x47};
  lwmqtt_string_t topic_filter_s2 = {14, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x1f, 0x3d, 0xb8, 0x6a, 0x5c, 0x41, 0x41, 0x9b, 0x9c, 0x40, 0xb2, 0xe5, 0x72,
                                     0x27, 0x4b, 0x30, 0x69, 0xcc, 0x1b, 0xa8, 0x51, 0x27, 0xc4, 0xe2, 0xea, 0xe9};
  lwmqtt_string_t topic_filter_s3 = {26, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x61, 0x7e, 0xd4, 0x5c, 0x32, 0xae};
  uint8_t bytesprops1[] = {0xcb, 0x4, 0xa3, 0xc, 0x17, 0xb9, 0x67, 0x2b, 0x6e, 0x79};
  uint8_t bytesprops2[] = {0x7d, 0x6d, 0x7, 0x7f, 0xcd, 0x36, 0x27, 0x6e, 0xbf, 0xf9, 0xb3, 0x64, 0xd5, 0xc8};
  uint8_t bytesprops3[] = {0xa0, 0xc2, 0x7b, 0x94, 0x7b, 0xf,  0xc3, 0x38, 0xae, 0xc,  0x33, 0xa5,
                           0x8e, 0xe7, 0x28, 0xb4, 0x91, 0x15, 0xd8, 0xd6, 0x98, 0xc9, 0xbb};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 187}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 85}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 1915}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 220}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 29557}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {23, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 203}},
  };

  lwmqtt_properties_t props = {10, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 27160, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22660
// [("k\215\&6o4\168\148\NAKl|\DC2eLi\r\203\ETX\152\158\131\197\142\143\248\134l\CAN\243\SYN",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("!m\185",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS1}),("t\a\155\243\134r\ETB)\244Y:",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\144",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS1}),("Dy",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS =
// QoS0}),("\169p\197\187\137\SUBA\138\224\242\167\174\rh\b\143\210f\225\220\STX\200\t",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\rw\214#2r\221~\249",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropMaximumPacketSize 15050,PropMessageExpiryInterval 9141,PropTopicAliasMaximum 1046,PropContentType
// "Cw\245\144na\225\236s\130\SO\167\166\DEL\246\227\139\140\131\161Y\DLE/i\149\173 ",PropRequestProblemInformation
// 147,PropWillDelayInterval 25750,PropContentType
// "\128\179\&7[\212\ETX\252\DC3\242\226}\EMT\198\134\&1\150\NUL\165n\140\&8{}\134",PropContentType
// "\a\r\192\211\194\202\197\255M:\214\196\SUB\ETB",PropWildcardSubscriptionAvailable 34,PropSubscriptionIdentifier
// 7,PropWillDelayInterval 11753,PropReceiveMaximum 29355,PropRetainAvailable 27,PropUserProperty
// "\173\202\135N\253\&3\186\\Yh\234Q\156\166\170\&9\148"
// "\156\203h`>Pmip\STX\214:\RSc\221\240\211\183\217ZQ\183,\175)\217\133>",PropMaximumQoS 212,PropTopicAlias
// 13251,PropWildcardSubscriptionAvailable 11,PropContentType
// "\183\175b\225!\234\241\EOT\189I\133f\158M",PropMessageExpiryInterval 19195,PropSessionExpiryInterval
// 3913,PropSubscriptionIdentifier 3,PropContentType "\226\212H\204\184\198",PropTopicAlias
// 4680,PropRequestResponseInformation 110,PropCorrelationData
// "\223\162K\142\179\DC1\ETX7\137s\250i\NUL\a\206'.",PropServerReference
// "/\151\SUB\232\186cY\147s3U/E\219\161z\214\210\148\228\227i\183"]
TEST(Subscribe5QCTest, Encode84) {
  uint8_t pkt[] = {
      0x82, 0xe6, 0x2,  0x58, 0x84, 0xff, 0x1,  0x27, 0x0,  0x0,  0x3a, 0xca, 0x2,  0x0,  0x0,  0x23, 0xb5, 0x22, 0x4,
      0x16, 0x3,  0x0,  0x1b, 0x43, 0x77, 0xf5, 0x90, 0x6e, 0x61, 0xe1, 0xec, 0x73, 0x82, 0xe,  0xa7, 0xa6, 0x7f, 0xf6,
      0xe3, 0x8b, 0x8c, 0x83, 0xa1, 0x59, 0x10, 0x2f, 0x69, 0x95, 0xad, 0x20, 0x17, 0x93, 0x18, 0x0,  0x0,  0x64, 0x96,
      0x3,  0x0,  0x19, 0x80, 0xb3, 0x37, 0x5b, 0xd4, 0x3,  0xfc, 0x13, 0xf2, 0xe2, 0x7d, 0x19, 0x54, 0xc6, 0x86, 0x31,
      0x96, 0x0,  0xa5, 0x6e, 0x8c, 0x38, 0x7b, 0x7d, 0x86, 0x3,  0x0,  0xe,  0x7,  0xd,  0xc0, 0xd3, 0xc2, 0xca, 0xc5,
      0xff, 0x4d, 0x3a, 0xd6, 0xc4, 0x1a, 0x17, 0x28, 0x22, 0xb,  0x7,  0x18, 0x0,  0x0,  0x2d, 0xe9, 0x21, 0x72, 0xab,
      0x25, 0x1b, 0x26, 0x0,  0x11, 0xad, 0xca, 0x87, 0x4e, 0xfd, 0x33, 0xba, 0x5c, 0x59, 0x68, 0xea, 0x51, 0x9c, 0xa6,
      0xaa, 0x39, 0x94, 0x0,  0x1c, 0x9c, 0xcb, 0x68, 0x60, 0x3e, 0x50, 0x6d, 0x69, 0x70, 0x2,  0xd6, 0x3a, 0x1e, 0x63,
      0xdd, 0xf0, 0xd3, 0xb7, 0xd9, 0x5a, 0x51, 0xb7, 0x2c, 0xaf, 0x29, 0xd9, 0x85, 0x3e, 0x24, 0xd4, 0x23, 0x33, 0xc3,
      0x28, 0xb,  0x3,  0x0,  0xe,  0xb7, 0xaf, 0x62, 0xe1, 0x21, 0xea, 0xf1, 0x4,  0xbd, 0x49, 0x85, 0x66, 0x9e, 0x4d,
      0x2,  0x0,  0x0,  0x4a, 0xfb, 0x11, 0x0,  0x0,  0xf,  0x49, 0xb,  0x3,  0x3,  0x0,  0x6,  0xe2, 0xd4, 0x48, 0xcc,
      0xb8, 0xc6, 0x23, 0x12, 0x48, 0x19, 0x6e, 0x9,  0x0,  0x11, 0xdf, 0xa2, 0x4b, 0x8e, 0xb3, 0x11, 0x3,  0x37, 0x89,
      0x73, 0xfa, 0x69, 0x0,  0x7,  0xce, 0x27, 0x2e, 0x1c, 0x0,  0x17, 0x2f, 0x97, 0x1a, 0xe8, 0xba, 0x63, 0x59, 0x93,
      0x73, 0x33, 0x55, 0x2f, 0x45, 0xdb, 0xa1, 0x7a, 0xd6, 0xd2, 0x94, 0xe4, 0xe3, 0x69, 0xb7, 0x0,  0x1d, 0x6b, 0xd7,
      0x36, 0x6f, 0x34, 0xa8, 0x94, 0x15, 0x6c, 0x7c, 0x12, 0x65, 0x4c, 0x69, 0xd,  0xcb, 0x3,  0x98, 0x9e, 0x83, 0xc5,
      0x8e, 0x8f, 0xf8, 0x86, 0x6c, 0x18, 0xf3, 0x16, 0x0,  0x0,  0x3,  0x21, 0x6d, 0xb9, 0x1,  0x0,  0xb,  0x74, 0x7,
      0x9b, 0xf3, 0x86, 0x72, 0x17, 0x29, 0xf4, 0x59, 0x3a, 0x2,  0x0,  0x1,  0x90, 0x1,  0x0,  0x2,  0x44, 0x79, 0x0,
      0x0,  0x17, 0xa9, 0x70, 0xc5, 0xbb, 0x89, 0x1a, 0x41, 0x8a, 0xe0, 0xf2, 0xa7, 0xae, 0xd,  0x68, 0x8,  0x8f, 0xd2,
      0x66, 0xe1, 0xdc, 0x2,  0xc8, 0x9,  0x1,  0x0,  0x9,  0xd,  0x77, 0xd6, 0x23, 0x32, 0x72, 0xdd, 0x7e, 0xf9, 0x2};

  uint8_t buf[371] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x6b, 0xd7, 0x36, 0x6f, 0x34, 0xa8, 0x94, 0x15, 0x6c, 0x7c,
                                     0x12, 0x65, 0x4c, 0x69, 0xd,  0xcb, 0x3,  0x98, 0x9e, 0x83,
                                     0xc5, 0x8e, 0x8f, 0xf8, 0x86, 0x6c, 0x18, 0xf3, 0x16};
  lwmqtt_string_t topic_filter_s0 = {29, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x21, 0x6d, 0xb9};
  lwmqtt_string_t topic_filter_s1 = {3, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x74, 0x7, 0x9b, 0xf3, 0x86, 0x72, 0x17, 0x29, 0xf4, 0x59, 0x3a};
  lwmqtt_string_t topic_filter_s2 = {11, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x90};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x44, 0x79};
  lwmqtt_string_t topic_filter_s4 = {2, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xa9, 0x70, 0xc5, 0xbb, 0x89, 0x1a, 0x41, 0x8a, 0xe0, 0xf2, 0xa7, 0xae,
                                     0xd,  0x68, 0x8,  0x8f, 0xd2, 0x66, 0xe1, 0xdc, 0x2,  0xc8, 0x9};
  lwmqtt_string_t topic_filter_s5 = {23, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0xd, 0x77, 0xd6, 0x23, 0x32, 0x72, 0xdd, 0x7e, 0xf9};
  lwmqtt_string_t topic_filter_s6 = {9, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x43, 0x77, 0xf5, 0x90, 0x6e, 0x61, 0xe1, 0xec, 0x73, 0x82, 0xe,  0xa7, 0xa6, 0x7f,
                           0xf6, 0xe3, 0x8b, 0x8c, 0x83, 0xa1, 0x59, 0x10, 0x2f, 0x69, 0x95, 0xad, 0x20};
  uint8_t bytesprops1[] = {0x80, 0xb3, 0x37, 0x5b, 0xd4, 0x3,  0xfc, 0x13, 0xf2, 0xe2, 0x7d, 0x19, 0x54,
                           0xc6, 0x86, 0x31, 0x96, 0x0,  0xa5, 0x6e, 0x8c, 0x38, 0x7b, 0x7d, 0x86};
  uint8_t bytesprops2[] = {0x7, 0xd, 0xc0, 0xd3, 0xc2, 0xca, 0xc5, 0xff, 0x4d, 0x3a, 0xd6, 0xc4, 0x1a, 0x17};
  uint8_t bytesprops4[] = {0x9c, 0xcb, 0x68, 0x60, 0x3e, 0x50, 0x6d, 0x69, 0x70, 0x2,  0xd6, 0x3a, 0x1e, 0x63,
                           0xdd, 0xf0, 0xd3, 0xb7, 0xd9, 0x5a, 0x51, 0xb7, 0x2c, 0xaf, 0x29, 0xd9, 0x85, 0x3e};
  uint8_t bytesprops3[] = {0xad, 0xca, 0x87, 0x4e, 0xfd, 0x33, 0xba, 0x5c, 0x59,
                           0x68, 0xea, 0x51, 0x9c, 0xa6, 0xaa, 0x39, 0x94};
  uint8_t bytesprops5[] = {0xb7, 0xaf, 0x62, 0xe1, 0x21, 0xea, 0xf1, 0x4, 0xbd, 0x49, 0x85, 0x66, 0x9e, 0x4d};
  uint8_t bytesprops6[] = {0xe2, 0xd4, 0x48, 0xcc, 0xb8, 0xc6};
  uint8_t bytesprops7[] = {0xdf, 0xa2, 0x4b, 0x8e, 0xb3, 0x11, 0x3,  0x37, 0x89,
                           0x73, 0xfa, 0x69, 0x0,  0x7,  0xce, 0x27, 0x2e};
  uint8_t bytesprops8[] = {0x2f, 0x97, 0x1a, 0xe8, 0xba, 0x63, 0x59, 0x93, 0x73, 0x33, 0x55, 0x2f,
                           0x45, 0xdb, 0xa1, 0x7a, 0xd6, 0xd2, 0x94, 0xe4, 0xe3, 0x69, 0xb7};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 15050}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 9141}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1046}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 147}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 25750}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {25, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 34}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 7}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 11753}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 29355}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 27}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {17, (char*)&bytesprops3}, .v = {28, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 212}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 13251}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 11}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {14, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 19195}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 3913}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 3}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {6, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 4680}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 110}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {17, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&bytesprops8}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 22660, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13206 [("\134\245\ft\GS\160Zb\214\NAK\247^\170\162\CAN\201D\147\244$\SUB\DC2\130d\170",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\134",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\190\142\210",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS2}),("9",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False,
// _subQoS = QoS1}),("\NAKe\ETB\156>o\252\206\DC2F\DLE\224\224\183\231O\254`K\185\191\202",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\246\204EG\236x\DC3\172\243\168+\175\196v@#\DEL\188\&4\205M\226p1\165\174",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\ETX;\137\191}\SOdq\196\DC1\234\160\DEL1\173\155Rr8(\241S\132\173\129",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropResponseTopic
// "\178d\243\202\146\135\EM\156\214\174\SO\170\195\ESCNQ\190\bi\166f\213\182\244EK\192",PropSessionExpiryInterval
// 31168,PropResponseInformation
// "i\242\233\191\143\187&\129\136ZFH\209\129\SO\226\161&\ESC\155\221v\244d\ESC4\229b1^",PropMessageExpiryInterval
// 31515,PropRetainAvailable 52,PropReasonString "cA\DC3_d\NUL\FS\157\234\129",PropServerReference
// "{U\217\208\211m\186\r9\248\STX<\162|(\247\147\175ok\ESC",PropMaximumQoS 193,PropServerReference
// "\147kpEV\130",PropUserProperty "\137" "%(\164\218\157
// \229\253\142\193\220\DLEMU[#\251\131\230\241\201\&5B\147\182",PropRequestProblemInformation 70,PropResponseTopic
// "s\STX\155RN\130\175\133v\240]\222\214\241\170E\ESC\DEL9\138\193\ETX\170\&0~m\ESC",PropWillDelayInterval
// 488,PropResponseTopic "\\y/2ZW\NUL^ n\215\227\248_\ESC\241p\248bW",PropReasonString
// "\169\230i\DC2\251d\164\250&\DLE\184\158|\187\156}\141,\141\241\176\181\226\134}xe\210",PropCorrelationData
// "5u\129\201\165b\137\239\SOHY\RS\250`\255\192\131",PropAuthenticationMethod
// "\208*1$\174\&6d4\224\238\255\141E\207,\fv\214<U",PropRequestProblemInformation 157,PropWildcardSubscriptionAvailable
// 186,PropUserProperty ")\149l\232\156\141\&1\148VdPd\230&\198e\165\SI\231O\141Y\162"
// "\150\234\154\213J\194V\132\148\150\184\ESC\158\172\GS",PropReasonString
// "0TWU\202\162r73\ENQi\249\ACK>\240}\137",PropMessageExpiryInterval 7357,PropAssignedClientIdentifier
// "\199g!\229\219jw\246GP\248~>\212\143F0\DLE\246\161D\150\a\253\188\173\b",PropMessageExpiryInterval
// 14764,PropMessageExpiryInterval 29761,PropContentType
// "^\188<g\191\164>\172\164<9\245l\128\254\141\170\\",PropSharedSubscriptionAvailable 167,PropTopicAliasMaximum
// 11277,PropAssignedClientIdentifier "\165w4"]
TEST(Subscribe5QCTest, Encode85) {
  uint8_t pkt[] = {
      0x82, 0xaf, 0x4,  0x33, 0x96, 0xaf, 0x3,  0x8,  0x0,  0x1b, 0xb2, 0x64, 0xf3, 0xca, 0x92, 0x87, 0x19, 0x9c, 0xd6,
      0xae, 0xe,  0xaa, 0xc3, 0x1b, 0x4e, 0x51, 0xbe, 0x8,  0x69, 0xa6, 0x66, 0xd5, 0xb6, 0xf4, 0x45, 0x4b, 0xc0, 0x11,
      0x0,  0x0,  0x79, 0xc0, 0x1a, 0x0,  0x1e, 0x69, 0xf2, 0xe9, 0xbf, 0x8f, 0xbb, 0x26, 0x81, 0x88, 0x5a, 0x46, 0x48,
      0xd1, 0x81, 0xe,  0xe2, 0xa1, 0x26, 0x1b, 0x9b, 0xdd, 0x76, 0xf4, 0x64, 0x1b, 0x34, 0xe5, 0x62, 0x31, 0x5e, 0x2,
      0x0,  0x0,  0x7b, 0x1b, 0x25, 0x34, 0x1f, 0x0,  0xa,  0x63, 0x41, 0x13, 0x5f, 0x64, 0x0,  0x1c, 0x9d, 0xea, 0x81,
      0x1c, 0x0,  0x15, 0x7b, 0x55, 0xd9, 0xd0, 0xd3, 0x6d, 0xba, 0xd,  0x39, 0xf8, 0x2,  0x3c, 0xa2, 0x7c, 0x28, 0xf7,
      0x93, 0xaf, 0x6f, 0x6b, 0x1b, 0x24, 0xc1, 0x1c, 0x0,  0x6,  0x93, 0x6b, 0x70, 0x45, 0x56, 0x82, 0x26, 0x0,  0x1,
      0x89, 0x0,  0x19, 0x25, 0x28, 0xa4, 0xda, 0x9d, 0x20, 0xe5, 0xfd, 0x8e, 0xc1, 0xdc, 0x10, 0x4d, 0x55, 0x5b, 0x23,
      0xfb, 0x83, 0xe6, 0xf1, 0xc9, 0x35, 0x42, 0x93, 0xb6, 0x17, 0x46, 0x8,  0x0,  0x1b, 0x73, 0x2,  0x9b, 0x52, 0x4e,
      0x82, 0xaf, 0x85, 0x76, 0xf0, 0x5d, 0xde, 0xd6, 0xf1, 0xaa, 0x45, 0x1b, 0x7f, 0x39, 0x8a, 0xc1, 0x3,  0xaa, 0x30,
      0x7e, 0x6d, 0x1b, 0x18, 0x0,  0x0,  0x1,  0xe8, 0x8,  0x0,  0x14, 0x5c, 0x79, 0x2f, 0x32, 0x5a, 0x57, 0x0,  0x5e,
      0x20, 0x6e, 0xd7, 0xe3, 0xf8, 0x5f, 0x1b, 0xf1, 0x70, 0xf8, 0x62, 0x57, 0x1f, 0x0,  0x1c, 0xa9, 0xe6, 0x69, 0x12,
      0xfb, 0x64, 0xa4, 0xfa, 0x26, 0x10, 0xb8, 0x9e, 0x7c, 0xbb, 0x9c, 0x7d, 0x8d, 0x2c, 0x8d, 0xf1, 0xb0, 0xb5, 0xe2,
      0x86, 0x7d, 0x78, 0x65, 0xd2, 0x9,  0x0,  0x10, 0x35, 0x75, 0x81, 0xc9, 0xa5, 0x62, 0x89, 0xef, 0x1,  0x59, 0x1e,
      0xfa, 0x60, 0xff, 0xc0, 0x83, 0x15, 0x0,  0x14, 0xd0, 0x2a, 0x31, 0x24, 0xae, 0x36, 0x64, 0x34, 0xe0, 0xee, 0xff,
      0x8d, 0x45, 0xcf, 0x2c, 0xc,  0x76, 0xd6, 0x3c, 0x55, 0x17, 0x9d, 0x28, 0xba, 0x26, 0x0,  0x17, 0x29, 0x95, 0x6c,
      0xe8, 0x9c, 0x8d, 0x31, 0x94, 0x56, 0x64, 0x50, 0x64, 0xe6, 0x26, 0xc6, 0x65, 0xa5, 0xf,  0xe7, 0x4f, 0x8d, 0x59,
      0xa2, 0x0,  0xf,  0x96, 0xea, 0x9a, 0xd5, 0x4a, 0xc2, 0x56, 0x84, 0x94, 0x96, 0xb8, 0x1b, 0x9e, 0xac, 0x1d, 0x1f,
      0x0,  0x11, 0x30, 0x54, 0x57, 0x55, 0xca, 0xa2, 0x72, 0x37, 0x33, 0x5,  0x69, 0xf9, 0x6,  0x3e, 0xf0, 0x7d, 0x89,
      0x2,  0x0,  0x0,  0x1c, 0xbd, 0x12, 0x0,  0x1b, 0xc7, 0x67, 0x21, 0xe5, 0xdb, 0x6a, 0x77, 0xf6, 0x47, 0x50, 0xf8,
      0x7e, 0x3e, 0xd4, 0x8f, 0x46, 0x30, 0x10, 0xf6, 0xa1, 0x44, 0x96, 0x7,  0xfd, 0xbc, 0xad, 0x8,  0x2,  0x0,  0x0,
      0x39, 0xac, 0x2,  0x0,  0x0,  0x74, 0x41, 0x3,  0x0,  0x12, 0x5e, 0xbc, 0x3c, 0x67, 0xbf, 0xa4, 0x3e, 0xac, 0xa4,
      0x3c, 0x39, 0xf5, 0x6c, 0x80, 0xfe, 0x8d, 0xaa, 0x5c, 0x2a, 0xa7, 0x22, 0x2c, 0xd,  0x12, 0x0,  0x3,  0xa5, 0x77,
      0x34, 0x0,  0x19, 0x86, 0xf5, 0xc,  0x74, 0x1d, 0xa0, 0x5a, 0x62, 0xd6, 0x15, 0xf7, 0x5e, 0xaa, 0xa2, 0x18, 0xc9,
      0x44, 0x93, 0xf4, 0x24, 0x1a, 0x12, 0x82, 0x64, 0xaa, 0x1,  0x0,  0x1,  0x86, 0x1,  0x0,  0x3,  0xbe, 0x8e, 0xd2,
      0x2,  0x0,  0x1,  0x39, 0x1,  0x0,  0x16, 0x15, 0x65, 0x17, 0x9c, 0x3e, 0x6f, 0xfc, 0xce, 0x12, 0x46, 0x10, 0xe0,
      0xe0, 0xb7, 0xe7, 0x4f, 0xfe, 0x60, 0x4b, 0xb9, 0xbf, 0xca, 0x2,  0x0,  0x1a, 0xf6, 0xcc, 0x45, 0x47, 0xec, 0x78,
      0x13, 0xac, 0xf3, 0xa8, 0x2b, 0xaf, 0xc4, 0x76, 0x40, 0x23, 0x7f, 0xbc, 0x34, 0xcd, 0x4d, 0xe2, 0x70, 0x31, 0xa5,
      0xae, 0x0,  0x0,  0x19, 0x3,  0x3b, 0x89, 0xbf, 0x7d, 0xe,  0x64, 0x71, 0xc4, 0x11, 0xea, 0xa0, 0x7f, 0x31, 0xad,
      0x9b, 0x52, 0x72, 0x38, 0x28, 0xf1, 0x53, 0x84, 0xad, 0x81, 0x1};

  uint8_t buf[572] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0x86, 0xf5, 0xc,  0x74, 0x1d, 0xa0, 0x5a, 0x62, 0xd6, 0x15, 0xf7, 0x5e, 0xaa,
                                     0xa2, 0x18, 0xc9, 0x44, 0x93, 0xf4, 0x24, 0x1a, 0x12, 0x82, 0x64, 0xaa};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x86};
  lwmqtt_string_t topic_filter_s1 = {1, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xbe, 0x8e, 0xd2};
  lwmqtt_string_t topic_filter_s2 = {3, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x39};
  lwmqtt_string_t topic_filter_s3 = {1, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x15, 0x65, 0x17, 0x9c, 0x3e, 0x6f, 0xfc, 0xce, 0x12, 0x46, 0x10,
                                     0xe0, 0xe0, 0xb7, 0xe7, 0x4f, 0xfe, 0x60, 0x4b, 0xb9, 0xbf, 0xca};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf6, 0xcc, 0x45, 0x47, 0xec, 0x78, 0x13, 0xac, 0xf3, 0xa8, 0x2b, 0xaf, 0xc4,
                                     0x76, 0x40, 0x23, 0x7f, 0xbc, 0x34, 0xcd, 0x4d, 0xe2, 0x70, 0x31, 0xa5, 0xae};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x3,  0x3b, 0x89, 0xbf, 0x7d, 0xe,  0x64, 0x71, 0xc4, 0x11, 0xea, 0xa0, 0x7f,
                                     0x31, 0xad, 0x9b, 0x52, 0x72, 0x38, 0x28, 0xf1, 0x53, 0x84, 0xad, 0x81};
  lwmqtt_string_t topic_filter_s6 = {25, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xb2, 0x64, 0xf3, 0xca, 0x92, 0x87, 0x19, 0x9c, 0xd6, 0xae, 0xe,  0xaa, 0xc3, 0x1b,
                           0x4e, 0x51, 0xbe, 0x8,  0x69, 0xa6, 0x66, 0xd5, 0xb6, 0xf4, 0x45, 0x4b, 0xc0};
  uint8_t bytesprops1[] = {0x69, 0xf2, 0xe9, 0xbf, 0x8f, 0xbb, 0x26, 0x81, 0x88, 0x5a, 0x46, 0x48, 0xd1, 0x81, 0xe,
                           0xe2, 0xa1, 0x26, 0x1b, 0x9b, 0xdd, 0x76, 0xf4, 0x64, 0x1b, 0x34, 0xe5, 0x62, 0x31, 0x5e};
  uint8_t bytesprops2[] = {0x63, 0x41, 0x13, 0x5f, 0x64, 0x0, 0x1c, 0x9d, 0xea, 0x81};
  uint8_t bytesprops3[] = {0x7b, 0x55, 0xd9, 0xd0, 0xd3, 0x6d, 0xba, 0xd,  0x39, 0xf8, 0x2,
                           0x3c, 0xa2, 0x7c, 0x28, 0xf7, 0x93, 0xaf, 0x6f, 0x6b, 0x1b};
  uint8_t bytesprops4[] = {0x93, 0x6b, 0x70, 0x45, 0x56, 0x82};
  uint8_t bytesprops6[] = {0x25, 0x28, 0xa4, 0xda, 0x9d, 0x20, 0xe5, 0xfd, 0x8e, 0xc1, 0xdc, 0x10, 0x4d,
                           0x55, 0x5b, 0x23, 0xfb, 0x83, 0xe6, 0xf1, 0xc9, 0x35, 0x42, 0x93, 0xb6};
  uint8_t bytesprops5[] = {0x89};
  uint8_t bytesprops7[] = {0x73, 0x2,  0x9b, 0x52, 0x4e, 0x82, 0xaf, 0x85, 0x76, 0xf0, 0x5d, 0xde, 0xd6, 0xf1,
                           0xaa, 0x45, 0x1b, 0x7f, 0x39, 0x8a, 0xc1, 0x3,  0xaa, 0x30, 0x7e, 0x6d, 0x1b};
  uint8_t bytesprops8[] = {0x5c, 0x79, 0x2f, 0x32, 0x5a, 0x57, 0x0,  0x5e, 0x20, 0x6e,
                           0xd7, 0xe3, 0xf8, 0x5f, 0x1b, 0xf1, 0x70, 0xf8, 0x62, 0x57};
  uint8_t bytesprops9[] = {0xa9, 0xe6, 0x69, 0x12, 0xfb, 0x64, 0xa4, 0xfa, 0x26, 0x10, 0xb8, 0x9e, 0x7c, 0xbb,
                           0x9c, 0x7d, 0x8d, 0x2c, 0x8d, 0xf1, 0xb0, 0xb5, 0xe2, 0x86, 0x7d, 0x78, 0x65, 0xd2};
  uint8_t bytesprops10[] = {0x35, 0x75, 0x81, 0xc9, 0xa5, 0x62, 0x89, 0xef,
                            0x1,  0x59, 0x1e, 0xfa, 0x60, 0xff, 0xc0, 0x83};
  uint8_t bytesprops11[] = {0xd0, 0x2a, 0x31, 0x24, 0xae, 0x36, 0x64, 0x34, 0xe0, 0xee,
                            0xff, 0x8d, 0x45, 0xcf, 0x2c, 0xc,  0x76, 0xd6, 0x3c, 0x55};
  uint8_t bytesprops13[] = {0x96, 0xea, 0x9a, 0xd5, 0x4a, 0xc2, 0x56, 0x84, 0x94, 0x96, 0xb8, 0x1b, 0x9e, 0xac, 0x1d};
  uint8_t bytesprops12[] = {0x29, 0x95, 0x6c, 0xe8, 0x9c, 0x8d, 0x31, 0x94, 0x56, 0x64, 0x50, 0x64,
                            0xe6, 0x26, 0xc6, 0x65, 0xa5, 0xf,  0xe7, 0x4f, 0x8d, 0x59, 0xa2};
  uint8_t bytesprops14[] = {0x30, 0x54, 0x57, 0x55, 0xca, 0xa2, 0x72, 0x37, 0x33,
                            0x5,  0x69, 0xf9, 0x6,  0x3e, 0xf0, 0x7d, 0x89};
  uint8_t bytesprops15[] = {0xc7, 0x67, 0x21, 0xe5, 0xdb, 0x6a, 0x77, 0xf6, 0x47, 0x50, 0xf8, 0x7e, 0x3e, 0xd4,
                            0x8f, 0x46, 0x30, 0x10, 0xf6, 0xa1, 0x44, 0x96, 0x7,  0xfd, 0xbc, 0xad, 0x8};
  uint8_t bytesprops16[] = {0x5e, 0xbc, 0x3c, 0x67, 0xbf, 0xa4, 0x3e, 0xac, 0xa4,
                            0x3c, 0x39, 0xf5, 0x6c, 0x80, 0xfe, 0x8d, 0xaa, 0x5c};
  uint8_t bytesprops17[] = {0xa5, 0x77, 0x34};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 31168}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {30, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 31515}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 52}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {10, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {21, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 193}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {1, (char*)&bytesprops5}, .v = {25, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 70}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {27, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 488}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {28, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {16, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {20, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 157}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 186}},
      {.prop = (lwmqtt_prop_t)38,
       .value = {.pair = {.k = {23, (char*)&bytesprops12}, .v = {15, (char*)&bytesprops13}}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {17, (char*)&bytesprops14}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7357}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {27, (char*)&bytesprops15}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14764}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29761}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops16}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 167}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 11277}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {3, (char*)&bytesprops17}}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 13206, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8501 [("\203p\176B\229Ul'\142n\159\GS\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropMessageExpiryInterval
// 24653,PropTopicAliasMaximum 4164,PropServerReference "t\177\211\&1\236\ETB\210\242\225\211I\183\254\219\208s\240\DC3E
// y\197\134\&3V\185\176",PropTopicAliasMaximum 23401,PropCorrelationData
// "@$\USa\SYNU\143\DC2\183%%><-\231\160\229\187\216",PropMessageExpiryInterval 8933,PropServerReference
// "9\234X\STX\GS\173\169\197Q\131\224\&9\191",PropServerReference "\185b\205ge!",PropAuthenticationMethod
// "\221\SIDGQ",PropSharedSubscriptionAvailable 181,PropSharedSubscriptionAvailable 26,PropSubscriptionIdentifier
// 4,PropServerReference
// "W\237\135\DC3\252\190\a\144\179\187g\140\175W$\226\181\240\&9\206\221\STX\FS\216\r\136\129",PropMessageExpiryInterval
// 13114,PropAuthenticationData
// "^\f\DC4\EOT\"b)\129\239\130\200\177\174\136\187jD\184\230'",PropRequestProblemInformation 92,PropServerReference
// "2t.\\\158\RSV",PropContentType "sEGBA\198a[\DC3\255\STX",PropServerReference
// "\169\"\212\129\aJl-\209\152",PropReasonString
// "!\168m/\210\144\DLE,\232\215G\156",PropSubscriptionIdentifierAvailable 122,PropCorrelationData
// "\149\FS%k5\143\US\v\203\&1",PropAuthenticationData "W\191 5]_RE\255\244\228\229",PropUserProperty "\233 "
// "\201\172\136\145#\206ub",PropRequestProblemInformation 148,PropResponseTopic "t\\>\184W\200\240\&9\143.1\229%:"]
TEST(Subscribe5QCTest, Encode86) {
  uint8_t pkt[] = {0x82, 0xaf, 0x2,  0x21, 0x35, 0x9b, 0x2,  0x2,  0x0,  0x0,  0x60, 0x4d, 0x22, 0x10, 0x44, 0x1c, 0x0,
                   0x1b, 0x74, 0xb1, 0xd3, 0x31, 0xec, 0x17, 0xd2, 0xf2, 0xe1, 0xd3, 0x49, 0xb7, 0xfe, 0xdb, 0xd0, 0x73,
                   0xf0, 0x13, 0x45, 0x20, 0x79, 0xc5, 0x86, 0x33, 0x56, 0xb9, 0xb0, 0x22, 0x5b, 0x69, 0x9,  0x0,  0x13,
                   0x40, 0x24, 0x1f, 0x61, 0x16, 0x55, 0x8f, 0x12, 0xb7, 0x25, 0x25, 0x3e, 0x3c, 0x2d, 0xe7, 0xa0, 0xe5,
                   0xbb, 0xd8, 0x2,  0x0,  0x0,  0x22, 0xe5, 0x1c, 0x0,  0xd,  0x39, 0xea, 0x58, 0x2,  0x1d, 0xad, 0xa9,
                   0xc5, 0x51, 0x83, 0xe0, 0x39, 0xbf, 0x1c, 0x0,  0x6,  0xb9, 0x62, 0xcd, 0x67, 0x65, 0x21, 0x15, 0x0,
                   0x5,  0xdd, 0xf,  0x44, 0x47, 0x51, 0x2a, 0xb5, 0x2a, 0x1a, 0xb,  0x4,  0x1c, 0x0,  0x1b, 0x57, 0xed,
                   0x87, 0x13, 0xfc, 0xbe, 0x7,  0x90, 0xb3, 0xbb, 0x67, 0x8c, 0xaf, 0x57, 0x24, 0xe2, 0xb5, 0xf0, 0x39,
                   0xce, 0xdd, 0x2,  0x1c, 0xd8, 0xd,  0x88, 0x81, 0x2,  0x0,  0x0,  0x33, 0x3a, 0x16, 0x0,  0x14, 0x5e,
                   0xc,  0x14, 0x4,  0x22, 0x62, 0x29, 0x81, 0xef, 0x82, 0xc8, 0xb1, 0xae, 0x88, 0xbb, 0x6a, 0x44, 0xb8,
                   0xe6, 0x27, 0x17, 0x5c, 0x1c, 0x0,  0x7,  0x32, 0x74, 0x2e, 0x5c, 0x9e, 0x1e, 0x56, 0x3,  0x0,  0xb,
                   0x73, 0x45, 0x47, 0x42, 0x41, 0xc6, 0x61, 0x5b, 0x13, 0xff, 0x2,  0x1c, 0x0,  0xa,  0xa9, 0x22, 0xd4,
                   0x81, 0x7,  0x4a, 0x6c, 0x2d, 0xd1, 0x98, 0x1f, 0x0,  0xc,  0x21, 0xa8, 0x6d, 0x2f, 0xd2, 0x90, 0x10,
                   0x2c, 0xe8, 0xd7, 0x47, 0x9c, 0x29, 0x7a, 0x9,  0x0,  0xa,  0x95, 0x1c, 0x25, 0x6b, 0x35, 0x8f, 0x1f,
                   0xb,  0xcb, 0x31, 0x16, 0x0,  0xc,  0x57, 0xbf, 0x20, 0x35, 0x5d, 0x5f, 0x52, 0x45, 0xff, 0xf4, 0xe4,
                   0xe5, 0x26, 0x0,  0x2,  0xe9, 0x20, 0x0,  0x8,  0xc9, 0xac, 0x88, 0x91, 0x23, 0xce, 0x75, 0x62, 0x17,
                   0x94, 0x8,  0x0,  0xe,  0x74, 0x5c, 0x3e, 0xb8, 0x57, 0xc8, 0xf0, 0x39, 0x8f, 0x2e, 0x31, 0xe5, 0x25,
                   0x3a, 0x0,  0xd,  0xcb, 0x70, 0xb0, 0x42, 0xe5, 0x55, 0x6c, 0x27, 0x8e, 0x6e, 0x9f, 0x1d, 0xdd, 0x2};

  uint8_t buf[316] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xcb, 0x70, 0xb0, 0x42, 0xe5, 0x55, 0x6c, 0x27, 0x8e, 0x6e, 0x9f, 0x1d, 0xdd};
  lwmqtt_string_t topic_filter_s0 = {13, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x74, 0xb1, 0xd3, 0x31, 0xec, 0x17, 0xd2, 0xf2, 0xe1, 0xd3, 0x49, 0xb7, 0xfe, 0xdb,
                           0xd0, 0x73, 0xf0, 0x13, 0x45, 0x20, 0x79, 0xc5, 0x86, 0x33, 0x56, 0xb9, 0xb0};
  uint8_t bytesprops1[] = {0x40, 0x24, 0x1f, 0x61, 0x16, 0x55, 0x8f, 0x12, 0xb7, 0x25,
                           0x25, 0x3e, 0x3c, 0x2d, 0xe7, 0xa0, 0xe5, 0xbb, 0xd8};
  uint8_t bytesprops2[] = {0x39, 0xea, 0x58, 0x2, 0x1d, 0xad, 0xa9, 0xc5, 0x51, 0x83, 0xe0, 0x39, 0xbf};
  uint8_t bytesprops3[] = {0xb9, 0x62, 0xcd, 0x67, 0x65, 0x21};
  uint8_t bytesprops4[] = {0xdd, 0xf, 0x44, 0x47, 0x51};
  uint8_t bytesprops5[] = {0x57, 0xed, 0x87, 0x13, 0xfc, 0xbe, 0x7,  0x90, 0xb3, 0xbb, 0x67, 0x8c, 0xaf, 0x57,
                           0x24, 0xe2, 0xb5, 0xf0, 0x39, 0xce, 0xdd, 0x2,  0x1c, 0xd8, 0xd,  0x88, 0x81};
  uint8_t bytesprops6[] = {0x5e, 0xc,  0x14, 0x4,  0x22, 0x62, 0x29, 0x81, 0xef, 0x82,
                           0xc8, 0xb1, 0xae, 0x88, 0xbb, 0x6a, 0x44, 0xb8, 0xe6, 0x27};
  uint8_t bytesprops7[] = {0x32, 0x74, 0x2e, 0x5c, 0x9e, 0x1e, 0x56};
  uint8_t bytesprops8[] = {0x73, 0x45, 0x47, 0x42, 0x41, 0xc6, 0x61, 0x5b, 0x13, 0xff, 0x2};
  uint8_t bytesprops9[] = {0xa9, 0x22, 0xd4, 0x81, 0x7, 0x4a, 0x6c, 0x2d, 0xd1, 0x98};
  uint8_t bytesprops10[] = {0x21, 0xa8, 0x6d, 0x2f, 0xd2, 0x90, 0x10, 0x2c, 0xe8, 0xd7, 0x47, 0x9c};
  uint8_t bytesprops11[] = {0x95, 0x1c, 0x25, 0x6b, 0x35, 0x8f, 0x1f, 0xb, 0xcb, 0x31};
  uint8_t bytesprops12[] = {0x57, 0xbf, 0x20, 0x35, 0x5d, 0x5f, 0x52, 0x45, 0xff, 0xf4, 0xe4, 0xe5};
  uint8_t bytesprops14[] = {0xc9, 0xac, 0x88, 0x91, 0x23, 0xce, 0x75, 0x62};
  uint8_t bytesprops13[] = {0xe9, 0x20};
  uint8_t bytesprops15[] = {0x74, 0x5c, 0x3e, 0xb8, 0x57, 0xc8, 0xf0, 0x39, 0x8f, 0x2e, 0x31, 0xe5, 0x25, 0x3a};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 24653}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 4164}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 23401}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8933}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {13, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {5, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 181}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 26}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 4}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {27, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13114}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {20, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 92}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {7, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {11, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {12, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 122}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {10, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {2, (char*)&bytesprops13}, .v = {8, (char*)&bytesprops14}}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 148}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {14, (char*)&bytesprops15}}},
  };

  lwmqtt_properties_t props = {26, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 8501, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25153 [("\132f\153\132\244w'\154\220S",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("\249\167\241%",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\142\244",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\151NI\219\241\129\216N\187\248`\189\"G}\165\133)7R\135\154\ETX~\175",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("/;\227\164B+\151W!\206\238\128\136\GS\vz\163\244:G\172V",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0}),("5\145\185{#B\152\236",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("<\131\162\143,2\130\130\159\151\150\CAN2\223\208\ESC\181\218\201\149\&6",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropContentType
// "5\251\237Ie\142\CANs",PropMessageExpiryInterval 23405,PropContentType
// "DI\171\251Z\ETB\216\185`N\246d\194+\f\164\245>h\177\b\217c\144",PropUserProperty
// "\211\162\150O\132h\138\&37N\205\STX\NAK\129\152\230\213\167\SOH\213\176\157:\140d\251"
// "\193n\241w\SO\223>\DLE\t\175WH?]\220{\SIJ\179\238\240`\199]\a\DLE\235\213\204",PropUserProperty
// "L\149\140\154xwdj~.\201\158\175ce\ENQ\173?OV2\212\189sB\US" "\r\251",PropTopicAlias
// 20702,PropSharedSubscriptionAvailable 44,PropServerKeepAlive 20616,PropMessageExpiryInterval
// 3019,PropSubscriptionIdentifier 2,PropAuthenticationData
// ":\ACK\184\168F8Z\204\227\229=\DC3\255Z\197\145\128\168\136\228\165\251u(\149\188",PropReasonString
// "\145\133\201\f\250\235\229\251C8\181\160\US\SUB\154\167\234\210\220T8",PropSubscriptionIdentifierAvailable
// 201,PropResponseInformation "\EOT5\174\EM\197\236\RS\239n\164",PropAuthenticationMethod
// "\162h7\140t|\202\FSw\DC1\SOHeh\169ONq\139\204\250\219\145\193\246BL",PropSharedSubscriptionAvailable
// 142,PropSharedSubscriptionAvailable 223,PropRequestProblemInformation 38,PropAuthenticationMethod
// "\DC3Bf\242\201#\200ldr*\215_\DLE\206\202",PropRetainAvailable 40,PropRetainAvailable 73,PropResponseTopic
// "\STX}\253\252\215Q\128\213z\160\EM\208T\164a\133\&0\b(\214\n+a\136oL5\143.",PropAuthenticationMethod
// "\210\212\183DL\b4!]y_\234\232\237\DC3\226C\175",PropServerKeepAlive 31013,PropMessageExpiryInterval
// 5923,PropMaximumPacketSize 6507,PropSessionExpiryInterval 27876,PropSessionExpiryInterval 11429]
TEST(Subscribe5QCTest, Encode87) {
  uint8_t pkt[] = {
      0x82, 0xd9, 0x3,  0x62, 0x41, 0xe1, 0x2,  0x3,  0x0,  0x8,  0x35, 0xfb, 0xed, 0x49, 0x65, 0x8e, 0x18, 0x73, 0x2,
      0x0,  0x0,  0x5b, 0x6d, 0x3,  0x0,  0x18, 0x44, 0x49, 0xab, 0xfb, 0x5a, 0x17, 0xd8, 0xb9, 0x60, 0x4e, 0xf6, 0x64,
      0xc2, 0x2b, 0xc,  0xa4, 0xf5, 0x3e, 0x68, 0xb1, 0x8,  0xd9, 0x63, 0x90, 0x26, 0x0,  0x1a, 0xd3, 0xa2, 0x96, 0x4f,
      0x84, 0x68, 0x8a, 0x33, 0x37, 0x4e, 0xcd, 0x2,  0x15, 0x81, 0x98, 0xe6, 0xd5, 0xa7, 0x1,  0xd5, 0xb0, 0x9d, 0x3a,
      0x8c, 0x64, 0xfb, 0x0,  0x1d, 0xc1, 0x6e, 0xf1, 0x77, 0xe,  0xdf, 0x3e, 0x10, 0x9,  0xaf, 0x57, 0x48, 0x3f, 0x5d,
      0xdc, 0x7b, 0xf,  0x4a, 0xb3, 0xee, 0xf0, 0x60, 0xc7, 0x5d, 0x7,  0x10, 0xeb, 0xd5, 0xcc, 0x26, 0x0,  0x1a, 0x4c,
      0x95, 0x8c, 0x9a, 0x78, 0x77, 0x64, 0x6a, 0x7e, 0x2e, 0xc9, 0x9e, 0xaf, 0x63, 0x65, 0x5,  0xad, 0x3f, 0x4f, 0x56,
      0x32, 0xd4, 0xbd, 0x73, 0x42, 0x1f, 0x0,  0x2,  0xd,  0xfb, 0x23, 0x50, 0xde, 0x2a, 0x2c, 0x13, 0x50, 0x88, 0x2,
      0x0,  0x0,  0xb,  0xcb, 0xb,  0x2,  0x16, 0x0,  0x1a, 0x3a, 0x6,  0xb8, 0xa8, 0x46, 0x38, 0x5a, 0xcc, 0xe3, 0xe5,
      0x3d, 0x13, 0xff, 0x5a, 0xc5, 0x91, 0x80, 0xa8, 0x88, 0xe4, 0xa5, 0xfb, 0x75, 0x28, 0x95, 0xbc, 0x1f, 0x0,  0x15,
      0x91, 0x85, 0xc9, 0xc,  0xfa, 0xeb, 0xe5, 0xfb, 0x43, 0x38, 0xb5, 0xa0, 0x1f, 0x1a, 0x9a, 0xa7, 0xea, 0xd2, 0xdc,
      0x54, 0x38, 0x29, 0xc9, 0x1a, 0x0,  0xa,  0x4,  0x35, 0xae, 0x19, 0xc5, 0xec, 0x1e, 0xef, 0x6e, 0xa4, 0x15, 0x0,
      0x1a, 0xa2, 0x68, 0x37, 0x8c, 0x74, 0x7c, 0xca, 0x1c, 0x77, 0x11, 0x1,  0x65, 0x68, 0xa9, 0x4f, 0x4e, 0x71, 0x8b,
      0xcc, 0xfa, 0xdb, 0x91, 0xc1, 0xf6, 0x42, 0x4c, 0x2a, 0x8e, 0x2a, 0xdf, 0x17, 0x26, 0x15, 0x0,  0x10, 0x13, 0x42,
      0x66, 0xf2, 0xc9, 0x23, 0xc8, 0x6c, 0x64, 0x72, 0x2a, 0xd7, 0x5f, 0x10, 0xce, 0xca, 0x25, 0x28, 0x25, 0x49, 0x8,
      0x0,  0x1d, 0x2,  0x7d, 0xfd, 0xfc, 0xd7, 0x51, 0x80, 0xd5, 0x7a, 0xa0, 0x19, 0xd0, 0x54, 0xa4, 0x61, 0x85, 0x30,
      0x8,  0x28, 0xd6, 0xa,  0x2b, 0x61, 0x88, 0x6f, 0x4c, 0x35, 0x8f, 0x2e, 0x15, 0x0,  0x12, 0xd2, 0xd4, 0xb7, 0x44,
      0x4c, 0x8,  0x34, 0x21, 0x5d, 0x79, 0x5f, 0xea, 0xe8, 0xed, 0x13, 0xe2, 0x43, 0xaf, 0x13, 0x79, 0x25, 0x2,  0x0,
      0x0,  0x17, 0x23, 0x27, 0x0,  0x0,  0x19, 0x6b, 0x11, 0x0,  0x0,  0x6c, 0xe4, 0x11, 0x0,  0x0,  0x2c, 0xa5, 0x0,
      0xa,  0x84, 0x66, 0x99, 0x84, 0xf4, 0x77, 0x27, 0x9a, 0xdc, 0x53, 0x0,  0x0,  0x0,  0x0,  0x0,  0x4,  0xf9, 0xa7,
      0xf1, 0x25, 0x2,  0x0,  0x2,  0x8e, 0xf4, 0x1,  0x0,  0x19, 0x97, 0x4e, 0x49, 0xdb, 0xf1, 0x81, 0xd8, 0x4e, 0xbb,
      0xf8, 0x60, 0xbd, 0x22, 0x47, 0x7d, 0xa5, 0x85, 0x29, 0x37, 0x52, 0x87, 0x9a, 0x3,  0x7e, 0xaf, 0x0,  0x0,  0x16,
      0x2f, 0x3b, 0xe3, 0xa4, 0x42, 0x2b, 0x97, 0x57, 0x21, 0xce, 0xee, 0x80, 0x88, 0x1d, 0xb,  0x7a, 0xa3, 0xf4, 0x3a,
      0x47, 0xac, 0x56, 0x0,  0x0,  0x8,  0x35, 0x91, 0xb9, 0x7b, 0x23, 0x42, 0x98, 0xec, 0x0,  0x0,  0x15, 0x3c, 0x83,
      0xa2, 0x8f, 0x2c, 0x32, 0x82, 0x82, 0x9f, 0x97, 0x96, 0x18, 0x32, 0xdf, 0xd0, 0x1b, 0xb5, 0xda, 0xc9, 0x95, 0x36,
      0x0};

  uint8_t buf[486] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x84, 0x66, 0x99, 0x84, 0xf4, 0x77, 0x27, 0x9a, 0xdc, 0x53};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0};
  lwmqtt_string_t topic_filter_s1 = {0, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xf9, 0xa7, 0xf1, 0x25};
  lwmqtt_string_t topic_filter_s2 = {4, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x8e, 0xf4};
  lwmqtt_string_t topic_filter_s3 = {2, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x97, 0x4e, 0x49, 0xdb, 0xf1, 0x81, 0xd8, 0x4e, 0xbb, 0xf8, 0x60, 0xbd, 0x22,
                                     0x47, 0x7d, 0xa5, 0x85, 0x29, 0x37, 0x52, 0x87, 0x9a, 0x3,  0x7e, 0xaf};
  lwmqtt_string_t topic_filter_s4 = {25, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x2f, 0x3b, 0xe3, 0xa4, 0x42, 0x2b, 0x97, 0x57, 0x21, 0xce, 0xee,
                                     0x80, 0x88, 0x1d, 0xb,  0x7a, 0xa3, 0xf4, 0x3a, 0x47, 0xac, 0x56};
  lwmqtt_string_t topic_filter_s5 = {22, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x35, 0x91, 0xb9, 0x7b, 0x23, 0x42, 0x98, 0xec};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x3c, 0x83, 0xa2, 0x8f, 0x2c, 0x32, 0x82, 0x82, 0x9f, 0x97, 0x96,
                                     0x18, 0x32, 0xdf, 0xd0, 0x1b, 0xb5, 0xda, 0xc9, 0x95, 0x36};
  lwmqtt_string_t topic_filter_s7 = {21, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x35, 0xfb, 0xed, 0x49, 0x65, 0x8e, 0x18, 0x73};
  uint8_t bytesprops1[] = {0x44, 0x49, 0xab, 0xfb, 0x5a, 0x17, 0xd8, 0xb9, 0x60, 0x4e, 0xf6, 0x64,
                           0xc2, 0x2b, 0xc,  0xa4, 0xf5, 0x3e, 0x68, 0xb1, 0x8,  0xd9, 0x63, 0x90};
  uint8_t bytesprops3[] = {0xc1, 0x6e, 0xf1, 0x77, 0xe,  0xdf, 0x3e, 0x10, 0x9,  0xaf, 0x57, 0x48, 0x3f, 0x5d, 0xdc,
                           0x7b, 0xf,  0x4a, 0xb3, 0xee, 0xf0, 0x60, 0xc7, 0x5d, 0x7,  0x10, 0xeb, 0xd5, 0xcc};
  uint8_t bytesprops2[] = {0xd3, 0xa2, 0x96, 0x4f, 0x84, 0x68, 0x8a, 0x33, 0x37, 0x4e, 0xcd, 0x2,  0x15,
                           0x81, 0x98, 0xe6, 0xd5, 0xa7, 0x1,  0xd5, 0xb0, 0x9d, 0x3a, 0x8c, 0x64, 0xfb};
  uint8_t bytesprops5[] = {0xd, 0xfb};
  uint8_t bytesprops4[] = {0x4c, 0x95, 0x8c, 0x9a, 0x78, 0x77, 0x64, 0x6a, 0x7e, 0x2e, 0xc9, 0x9e, 0xaf,
                           0x63, 0x65, 0x5,  0xad, 0x3f, 0x4f, 0x56, 0x32, 0xd4, 0xbd, 0x73, 0x42, 0x1f};
  uint8_t bytesprops6[] = {0x3a, 0x6,  0xb8, 0xa8, 0x46, 0x38, 0x5a, 0xcc, 0xe3, 0xe5, 0x3d, 0x13, 0xff,
                           0x5a, 0xc5, 0x91, 0x80, 0xa8, 0x88, 0xe4, 0xa5, 0xfb, 0x75, 0x28, 0x95, 0xbc};
  uint8_t bytesprops7[] = {0x91, 0x85, 0xc9, 0xc,  0xfa, 0xeb, 0xe5, 0xfb, 0x43, 0x38, 0xb5,
                           0xa0, 0x1f, 0x1a, 0x9a, 0xa7, 0xea, 0xd2, 0xdc, 0x54, 0x38};
  uint8_t bytesprops8[] = {0x4, 0x35, 0xae, 0x19, 0xc5, 0xec, 0x1e, 0xef, 0x6e, 0xa4};
  uint8_t bytesprops9[] = {0xa2, 0x68, 0x37, 0x8c, 0x74, 0x7c, 0xca, 0x1c, 0x77, 0x11, 0x1,  0x65, 0x68,
                           0xa9, 0x4f, 0x4e, 0x71, 0x8b, 0xcc, 0xfa, 0xdb, 0x91, 0xc1, 0xf6, 0x42, 0x4c};
  uint8_t bytesprops10[] = {0x13, 0x42, 0x66, 0xf2, 0xc9, 0x23, 0xc8, 0x6c,
                            0x64, 0x72, 0x2a, 0xd7, 0x5f, 0x10, 0xce, 0xca};
  uint8_t bytesprops11[] = {0x2,  0x7d, 0xfd, 0xfc, 0xd7, 0x51, 0x80, 0xd5, 0x7a, 0xa0, 0x19, 0xd0, 0x54, 0xa4, 0x61,
                            0x85, 0x30, 0x8,  0x28, 0xd6, 0xa,  0x2b, 0x61, 0x88, 0x6f, 0x4c, 0x35, 0x8f, 0x2e};
  uint8_t bytesprops12[] = {0xd2, 0xd4, 0xb7, 0x44, 0x4c, 0x8,  0x34, 0x21, 0x5d,
                            0x79, 0x5f, 0xea, 0xe8, 0xed, 0x13, 0xe2, 0x43, 0xaf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {8, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 23405}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {24, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {26, (char*)&bytesprops2}, .v = {29, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {26, (char*)&bytesprops4}, .v = {2, (char*)&bytesprops5}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 20702}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 44}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20616}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 3019}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 2}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {26, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {21, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 201}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {10, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {26, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 142}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 223}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 38}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {16, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 40}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 73}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {29, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {18, (char*)&bytesprops12}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 31013}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 5923}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 6507}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 27876}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11429}},
  };

  lwmqtt_properties_t props = {28, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25153, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 10517 [("\252",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1})] [PropMessageExpiryInterval 18639,PropMessageExpiryInterval 28021,PropResponseTopic
// "\200\189Z\216w\f\161\181C\217\187\EM",PropRequestProblemInformation 131,PropRequestResponseInformation
// 48,PropServerKeepAlive 14539,PropRetainAvailable 17,PropContentType "*\143\144Tg\215U",PropReceiveMaximum
// 5051,PropAuthenticationData "",PropSubscriptionIdentifierAvailable 70,PropRequestResponseInformation
// 31,PropTopicAlias 29124,PropRequestResponseInformation 52,PropServerKeepAlive
// 13965,PropSubscriptionIdentifierAvailable 44,PropTopicAlias 6091,PropSessionExpiryInterval 11780,PropUserProperty
// "\189e\133\205\194\218\162\170p)!\158\224\SIm\207\&5\128e\154" "e\252\170gv",PropMaximumPacketSize
// 3381,PropAssignedClientIdentifier
// "\t\210c\133\STX(\225\250\DC2a\137\192\180\DLE\242\154\EOTH\238T{\v^A\207",PropMessageExpiryInterval 7236]
TEST(Subscribe5QCTest, Encode88) {
  uint8_t pkt[] = {0x82, 0x94, 0x1,  0x29, 0x15, 0x8c, 0x1,  0x2,  0x0,  0x0,  0x48, 0xcf, 0x2,  0x0,  0x0,  0x6d, 0x75,
                   0x8,  0x0,  0xc,  0xc8, 0xbd, 0x5a, 0xd8, 0x77, 0xc,  0xa1, 0xb5, 0x43, 0xd9, 0xbb, 0x19, 0x17, 0x83,
                   0x19, 0x30, 0x13, 0x38, 0xcb, 0x25, 0x11, 0x3,  0x0,  0x7,  0x2a, 0x8f, 0x90, 0x54, 0x67, 0xd7, 0x55,
                   0x21, 0x13, 0xbb, 0x16, 0x0,  0x0,  0x29, 0x46, 0x19, 0x1f, 0x23, 0x71, 0xc4, 0x19, 0x34, 0x13, 0x36,
                   0x8d, 0x29, 0x2c, 0x23, 0x17, 0xcb, 0x11, 0x0,  0x0,  0x2e, 0x4,  0x26, 0x0,  0x14, 0xbd, 0x65, 0x85,
                   0xcd, 0xc2, 0xda, 0xa2, 0xaa, 0x70, 0x29, 0x21, 0x9e, 0xe0, 0xf,  0x6d, 0xcf, 0x35, 0x80, 0x65, 0x9a,
                   0x0,  0x5,  0x65, 0xfc, 0xaa, 0x67, 0x76, 0x27, 0x0,  0x0,  0xd,  0x35, 0x12, 0x0,  0x19, 0x9,  0xd2,
                   0x63, 0x85, 0x2,  0x28, 0xe1, 0xfa, 0x12, 0x61, 0x89, 0xc0, 0xb4, 0x10, 0xf2, 0x9a, 0x4,  0x48, 0xee,
                   0x54, 0x7b, 0xb,  0x5e, 0x41, 0xcf, 0x2,  0x0,  0x0,  0x1c, 0x44, 0x0,  0x1,  0xfc, 0x1};

  uint8_t buf[161] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xfc};
  lwmqtt_string_t topic_filter_s0 = {1, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xc8, 0xbd, 0x5a, 0xd8, 0x77, 0xc, 0xa1, 0xb5, 0x43, 0xd9, 0xbb, 0x19};
  uint8_t bytesprops1[] = {0x2a, 0x8f, 0x90, 0x54, 0x67, 0xd7, 0x55};
  uint8_t bytesprops2[] = {0};
  uint8_t bytesprops4[] = {0x65, 0xfc, 0xaa, 0x67, 0x76};
  uint8_t bytesprops3[] = {0xbd, 0x65, 0x85, 0xcd, 0xc2, 0xda, 0xa2, 0xaa, 0x70, 0x29,
                           0x21, 0x9e, 0xe0, 0xf,  0x6d, 0xcf, 0x35, 0x80, 0x65, 0x9a};
  uint8_t bytesprops5[] = {0x9,  0xd2, 0x63, 0x85, 0x2,  0x28, 0xe1, 0xfa, 0x12, 0x61, 0x89, 0xc0, 0xb4,
                           0x10, 0xf2, 0x9a, 0x4,  0x48, 0xee, 0x54, 0x7b, 0xb,  0x5e, 0x41, 0xcf};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 18639}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 28021}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {12, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 131}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 48}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 14539}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 17}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {7, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 5051}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {0, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 70}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 31}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 29124}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 52}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 13965}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 44}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 6091}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 11780}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {20, (char*)&bytesprops3}, .v = {5, (char*)&bytesprops4}}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 3381}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {25, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7236}},
  };

  lwmqtt_properties_t props = {22, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 10517, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 24618 [("\162\&7a\196\249\&0\135*\143\198O\209\148nI",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS0})] [PropAuthenticationMethod "s\"",PropContentType
// "\151\161:\SYN\182l\196#\210\240\136\v\140yS4\DC4\193\204\179\177\174c",PropMaximumQoS 231,PropPayloadFormatIndicator
// 171,PropAuthenticationMethod
// "\148\150\243\143\156\130r\168\FS\199\183\148\SUB\176\233E_\194\249\165\&6\191\246!\210\a{\NUL[\f",PropTopicAlias
// 3944]
TEST(Subscribe5QCTest, Encode89) {
  uint8_t pkt[] = {0x82, 0x5c, 0x60, 0x2a, 0x47, 0x15, 0x0,  0x2,  0x73, 0x22, 0x3,  0x0,  0x17, 0x97, 0xa1, 0x3a,
                   0x16, 0xb6, 0x6c, 0xc4, 0x23, 0xd2, 0xf0, 0x88, 0xb,  0x8c, 0x79, 0x53, 0x34, 0x14, 0xc1, 0xcc,
                   0xb3, 0xb1, 0xae, 0x63, 0x24, 0xe7, 0x1,  0xab, 0x15, 0x0,  0x1e, 0x94, 0x96, 0xf3, 0x8f, 0x9c,
                   0x82, 0x72, 0xa8, 0x1c, 0xc7, 0xb7, 0x94, 0x1a, 0xb0, 0xe9, 0x45, 0x5f, 0xc2, 0xf9, 0xa5, 0x36,
                   0xbf, 0xf6, 0x21, 0xd2, 0x7,  0x7b, 0x0,  0x5b, 0xc,  0x23, 0xf,  0x68, 0x0,  0xf,  0xa2, 0x37,
                   0x61, 0xc4, 0xf9, 0x30, 0x87, 0x2a, 0x8f, 0xc6, 0x4f, 0xd1, 0x94, 0x6e, 0x49, 0x0};

  uint8_t buf[104] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0xa2, 0x37, 0x61, 0xc4, 0xf9, 0x30, 0x87, 0x2a,
                                     0x8f, 0xc6, 0x4f, 0xd1, 0x94, 0x6e, 0x49};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0};
  uint8_t bytesprops0[] = {0x73, 0x22};
  uint8_t bytesprops1[] = {0x97, 0xa1, 0x3a, 0x16, 0xb6, 0x6c, 0xc4, 0x23, 0xd2, 0xf0, 0x88, 0xb,
                           0x8c, 0x79, 0x53, 0x34, 0x14, 0xc1, 0xcc, 0xb3, 0xb1, 0xae, 0x63};
  uint8_t bytesprops2[] = {0x94, 0x96, 0xf3, 0x8f, 0x9c, 0x82, 0x72, 0xa8, 0x1c, 0xc7, 0xb7, 0x94, 0x1a, 0xb0, 0xe9,
                           0x45, 0x5f, 0xc2, 0xf9, 0xa5, 0x36, 0xbf, 0xf6, 0x21, 0xd2, 0x7,  0x7b, 0x0,  0x5b, 0xc};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {2, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {23, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 231}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 171}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {30, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 3944}},
  };

  lwmqtt_properties_t props = {6, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 24618, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 32265 [("\188Z\ESCD\172\&2\GSO\235_\175N*$\243\136\224 =\137\169\155\DEL\227\&1",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\203\232q4\EM\v\220\158X\173l\SUB\174",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2})] [PropSharedSubscriptionAvailable 103,PropReasonString
// "\189\221b\217\174Y\212\151\168\b\173E$S\163\DELw7\175Tw\223\aF",PropWillDelayInterval
// 13033,PropMessageExpiryInterval 25541,PropCorrelationData
// "N\221\138\208\176\nu\157\143\130N_\SYNn\145\148\150\171\"",PropWillDelayInterval 28428,PropMessageExpiryInterval
// 21622,PropRequestProblemInformation 33,PropReceiveMaximum 16827,PropMessageExpiryInterval 8407,PropReasonString
// "\224\&4'7M\r*LN\136\254\237\222\180Jc\249h",PropTopicAlias 11873,PropReceiveMaximum
// 15245,PropRequestResponseInformation 108,PropAuthenticationMethod "u{!\146\234\n~\145>\253",PropServerKeepAlive
// 14260,PropRequestResponseInformation 184,PropMessageExpiryInterval 13662,PropRequestProblemInformation
// 209,PropContentType "|\181\241\162\DC3\166\218\192 \137\130\204pR>\192\&0\152",PropSharedSubscriptionAvailable 51]
TEST(Subscribe5QCTest, Encode90) {
  uint8_t pkt[] = {
      0x82, 0xce, 0x1,  0x7e, 0x9,  0x9e, 0x1,  0x2a, 0x67, 0x1f, 0x0,  0x18, 0xbd, 0xdd, 0x62, 0xd9, 0xae, 0x59, 0xd4,
      0x97, 0xa8, 0x8,  0xad, 0x45, 0x24, 0x53, 0xa3, 0x7f, 0x77, 0x37, 0xaf, 0x54, 0x77, 0xdf, 0x7,  0x46, 0x18, 0x0,
      0x0,  0x32, 0xe9, 0x2,  0x0,  0x0,  0x63, 0xc5, 0x9,  0x0,  0x13, 0x4e, 0xdd, 0x8a, 0xd0, 0xb0, 0xa,  0x75, 0x9d,
      0x8f, 0x82, 0x4e, 0x5f, 0x16, 0x6e, 0x91, 0x94, 0x96, 0xab, 0x22, 0x18, 0x0,  0x0,  0x6f, 0xc,  0x2,  0x0,  0x0,
      0x54, 0x76, 0x17, 0x21, 0x21, 0x41, 0xbb, 0x2,  0x0,  0x0,  0x20, 0xd7, 0x1f, 0x0,  0x12, 0xe0, 0x34, 0x27, 0x37,
      0x4d, 0xd,  0x2a, 0x4c, 0x4e, 0x88, 0xfe, 0xed, 0xde, 0xb4, 0x4a, 0x63, 0xf9, 0x68, 0x23, 0x2e, 0x61, 0x21, 0x3b,
      0x8d, 0x19, 0x6c, 0x15, 0x0,  0xa,  0x75, 0x7b, 0x21, 0x92, 0xea, 0xa,  0x7e, 0x91, 0x3e, 0xfd, 0x13, 0x37, 0xb4,
      0x19, 0xb8, 0x2,  0x0,  0x0,  0x35, 0x5e, 0x17, 0xd1, 0x3,  0x0,  0x12, 0x7c, 0xb5, 0xf1, 0xa2, 0x13, 0xa6, 0xda,
      0xc0, 0x20, 0x89, 0x82, 0xcc, 0x70, 0x52, 0x3e, 0xc0, 0x30, 0x98, 0x2a, 0x33, 0x0,  0x19, 0xbc, 0x5a, 0x1b, 0x44,
      0xac, 0x32, 0x1d, 0x4f, 0xeb, 0x5f, 0xaf, 0x4e, 0x2a, 0x24, 0xf3, 0x88, 0xe0, 0x20, 0x3d, 0x89, 0xa9, 0x9b, 0x7f,
      0xe3, 0x31, 0x0,  0x0,  0xd,  0xcb, 0xe8, 0x71, 0x34, 0x19, 0xb,  0xdc, 0x9e, 0x58, 0xad, 0x6c, 0x1a, 0xae, 0x2};

  uint8_t buf[219] = {0};

  lwmqtt_string_t topic_filters[2];
  uint8_t topic_filter_s0_bytes[] = {0xbc, 0x5a, 0x1b, 0x44, 0xac, 0x32, 0x1d, 0x4f, 0xeb, 0x5f, 0xaf, 0x4e, 0x2a,
                                     0x24, 0xf3, 0x88, 0xe0, 0x20, 0x3d, 0x89, 0xa9, 0x9b, 0x7f, 0xe3, 0x31};
  lwmqtt_string_t topic_filter_s0 = {25, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xcb, 0xe8, 0x71, 0x34, 0x19, 0xb, 0xdc, 0x9e, 0x58, 0xad, 0x6c, 0x1a, 0xae};
  lwmqtt_string_t topic_filter_s1 = {13, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0xbd, 0xdd, 0x62, 0xd9, 0xae, 0x59, 0xd4, 0x97, 0xa8, 0x8,  0xad, 0x45,
                           0x24, 0x53, 0xa3, 0x7f, 0x77, 0x37, 0xaf, 0x54, 0x77, 0xdf, 0x7,  0x46};
  uint8_t bytesprops1[] = {0x4e, 0xdd, 0x8a, 0xd0, 0xb0, 0xa,  0x75, 0x9d, 0x8f, 0x82,
                           0x4e, 0x5f, 0x16, 0x6e, 0x91, 0x94, 0x96, 0xab, 0x22};
  uint8_t bytesprops2[] = {0xe0, 0x34, 0x27, 0x37, 0x4d, 0xd,  0x2a, 0x4c, 0x4e,
                           0x88, 0xfe, 0xed, 0xde, 0xb4, 0x4a, 0x63, 0xf9, 0x68};
  uint8_t bytesprops3[] = {0x75, 0x7b, 0x21, 0x92, 0xea, 0xa, 0x7e, 0x91, 0x3e, 0xfd};
  uint8_t bytesprops4[] = {0x7c, 0xb5, 0xf1, 0xa2, 0x13, 0xa6, 0xda, 0xc0, 0x20,
                           0x89, 0x82, 0xcc, 0x70, 0x52, 0x3e, 0xc0, 0x30, 0x98};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 103}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {24, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 13033}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 25541}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {19, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 28428}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 21622}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 33}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 16827}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 8407}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {18, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 11873}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 15245}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 108}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {10, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 14260}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 184}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 13662}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 209}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {18, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 51}},
  };

  lwmqtt_properties_t props = {21, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 32265, 2, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 7342 [("\RS8\172\211YnUe\216\&6",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("~\\\198\&7Ty\GS\206{}\244\164c@{",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("j\227\vg\167<\\S\255\151",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0}),("$S\172",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS0}),("\174\RS\128=\161\254b\152\&4 \209\226m\237`\SOHcY\162",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\210\179\&8\244\FS\DC2\219W\171\&8!\186",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("Z\202\&4E\179\143\226E\151\146!\135\216",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\150\&5\226T\150\145THQ\tM\156\165\146Y\245\"\ESC\152YF\252\180\142\222\181\171\175D",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\220\144\&8\247r",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS1}),("G=\164\r\202\193\181\145:\160V\n7F/\251\199)\224\DLE\197\239\r",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropServerKeepAlive
// 20872,PropSubscriptionIdentifier 10,PropServerReference "3\157z\229n)",PropCorrelationData
// "G\242\"\SO\177\163\221\223\242",PropSharedSubscriptionAvailable 210]
TEST(Subscribe5QCTest, Encode91) {
  uint8_t pkt[] = {0x82, 0xc8, 0x1,  0x1c, 0xae, 0x1c, 0x13, 0x51, 0x88, 0xb,  0xa,  0x1c, 0x0,  0x6,  0x33, 0x9d, 0x7a,
                   0xe5, 0x6e, 0x29, 0x9,  0x0,  0x9,  0x47, 0xf2, 0x22, 0xe,  0xb1, 0xa3, 0xdd, 0xdf, 0xf2, 0x2a, 0xd2,
                   0x0,  0xa,  0x1e, 0x38, 0xac, 0xd3, 0x59, 0x6e, 0x55, 0x65, 0xd8, 0x36, 0x2,  0x0,  0xf,  0x7e, 0x5c,
                   0xc6, 0x37, 0x54, 0x79, 0x1d, 0xce, 0x7b, 0x7d, 0xf4, 0xa4, 0x63, 0x40, 0x7b, 0x2,  0x0,  0xa,  0x6a,
                   0xe3, 0xb,  0x67, 0xa7, 0x3c, 0x5c, 0x53, 0xff, 0x97, 0x0,  0x0,  0x3,  0x24, 0x53, 0xac, 0x0,  0x0,
                   0x13, 0xae, 0x1e, 0x80, 0x3d, 0xa1, 0xfe, 0x62, 0x98, 0x34, 0x20, 0xd1, 0xe2, 0x6d, 0xed, 0x60, 0x1,
                   0x63, 0x59, 0xa2, 0x1,  0x0,  0xc,  0xd2, 0xb3, 0x38, 0xf4, 0x1c, 0x12, 0xdb, 0x57, 0xab, 0x38, 0x21,
                   0xba, 0x1,  0x0,  0xd,  0x5a, 0xca, 0x34, 0x45, 0xb3, 0x8f, 0xe2, 0x45, 0x97, 0x92, 0x21, 0x87, 0xd8,
                   0x1,  0x0,  0x1d, 0x96, 0x35, 0xe2, 0x54, 0x96, 0x91, 0x54, 0x48, 0x51, 0x9,  0x4d, 0x9c, 0xa5, 0x92,
                   0x59, 0xf5, 0x22, 0x1b, 0x98, 0x59, 0x46, 0xfc, 0xb4, 0x8e, 0xde, 0xb5, 0xab, 0xaf, 0x44, 0x1,  0x0,
                   0x5,  0xdc, 0x90, 0x38, 0xf7, 0x72, 0x1,  0x0,  0x17, 0x47, 0x3d, 0xa4, 0xd,  0xca, 0xc1, 0xb5, 0x91,
                   0x3a, 0xa0, 0x56, 0xa,  0x37, 0x46, 0x2f, 0xfb, 0xc7, 0x29, 0xe0, 0x10, 0xc5, 0xef, 0xd,  0x2};

  uint8_t buf[213] = {0};

  lwmqtt_string_t topic_filters[10];
  uint8_t topic_filter_s0_bytes[] = {0x1e, 0x38, 0xac, 0xd3, 0x59, 0x6e, 0x55, 0x65, 0xd8, 0x36};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x7e, 0x5c, 0xc6, 0x37, 0x54, 0x79, 0x1d, 0xce,
                                     0x7b, 0x7d, 0xf4, 0xa4, 0x63, 0x40, 0x7b};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x6a, 0xe3, 0xb, 0x67, 0xa7, 0x3c, 0x5c, 0x53, 0xff, 0x97};
  lwmqtt_string_t topic_filter_s2 = {10, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x24, 0x53, 0xac};
  lwmqtt_string_t topic_filter_s3 = {3, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xae, 0x1e, 0x80, 0x3d, 0xa1, 0xfe, 0x62, 0x98, 0x34, 0x20,
                                     0xd1, 0xe2, 0x6d, 0xed, 0x60, 0x1,  0x63, 0x59, 0xa2};
  lwmqtt_string_t topic_filter_s4 = {19, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xd2, 0xb3, 0x38, 0xf4, 0x1c, 0x12, 0xdb, 0x57, 0xab, 0x38, 0x21, 0xba};
  lwmqtt_string_t topic_filter_s5 = {12, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x5a, 0xca, 0x34, 0x45, 0xb3, 0x8f, 0xe2, 0x45, 0x97, 0x92, 0x21, 0x87, 0xd8};
  lwmqtt_string_t topic_filter_s6 = {13, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0x96, 0x35, 0xe2, 0x54, 0x96, 0x91, 0x54, 0x48, 0x51, 0x9,
                                     0x4d, 0x9c, 0xa5, 0x92, 0x59, 0xf5, 0x22, 0x1b, 0x98, 0x59,
                                     0x46, 0xfc, 0xb4, 0x8e, 0xde, 0xb5, 0xab, 0xaf, 0x44};
  lwmqtt_string_t topic_filter_s7 = {29, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  uint8_t topic_filter_s8_bytes[] = {0xdc, 0x90, 0x38, 0xf7, 0x72};
  lwmqtt_string_t topic_filter_s8 = {5, (char*)&topic_filter_s8_bytes};
  topic_filters[8] = topic_filter_s8;
  uint8_t topic_filter_s9_bytes[] = {0x47, 0x3d, 0xa4, 0xd,  0xca, 0xc1, 0xb5, 0x91, 0x3a, 0xa0, 0x56, 0xa,
                                     0x37, 0x46, 0x2f, 0xfb, 0xc7, 0x29, 0xe0, 0x10, 0xc5, 0xef, 0xd};
  lwmqtt_string_t topic_filter_s9 = {23, (char*)&topic_filter_s9_bytes};
  topic_filters[9] = topic_filter_s9;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1,
                               LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x33, 0x9d, 0x7a, 0xe5, 0x6e, 0x29};
  uint8_t bytesprops1[] = {0x47, 0xf2, 0x22, 0xe, 0xb1, 0xa3, 0xdd, 0xdf, 0xf2};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 20872}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 10}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {6, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {9, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 210}},
  };

  lwmqtt_properties_t props = {5, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 7342, 10, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25785 [("4\DC1\131\219{\253\160\n\151f\226{\218\179",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("F\173\174\178\252\144\161\193\&0H\130c\170,\160\167-)\162",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\230\216\219R\ACK\203\\\EM\206|\151\250\&7",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("7!\245\132~\DC2(\164\v\167p\249O]\EOTx*&\173pP\249\209",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\213\FS\146i\223\DC4\233\DC1\SI\208*_B\198EP\ACK[\226\182)\255",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\247P\157\US\255e\250\180",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS0})] []
TEST(Subscribe5QCTest, Encode92) {
  uint8_t pkt[] = {0x82, 0x78, 0x64, 0xb9, 0x0,  0x0,  0xe,  0x34, 0x11, 0x83, 0xdb, 0x7b, 0xfd, 0xa0, 0xa,  0x97,
                   0x66, 0xe2, 0x7b, 0xda, 0xb3, 0x0,  0x0,  0x13, 0x46, 0xad, 0xae, 0xb2, 0xfc, 0x90, 0xa1, 0xc1,
                   0x30, 0x48, 0x82, 0x63, 0xaa, 0x2c, 0xa0, 0xa7, 0x2d, 0x29, 0xa2, 0x0,  0x0,  0xd,  0xe6, 0xd8,
                   0xdb, 0x52, 0x6,  0xcb, 0x5c, 0x19, 0xce, 0x7c, 0x97, 0xfa, 0x37, 0x1,  0x0,  0x17, 0x37, 0x21,
                   0xf5, 0x84, 0x7e, 0x12, 0x28, 0xa4, 0xb,  0xa7, 0x70, 0xf9, 0x4f, 0x5d, 0x4,  0x78, 0x2a, 0x26,
                   0xad, 0x70, 0x50, 0xf9, 0xd1, 0x1,  0x0,  0x16, 0xd5, 0x1c, 0x92, 0x69, 0xdf, 0x14, 0xe9, 0x11,
                   0xf,  0xd0, 0x2a, 0x5f, 0x42, 0xc6, 0x45, 0x50, 0x6,  0x5b, 0xe2, 0xb6, 0x29, 0xff, 0x2,  0x0,
                   0x8,  0xf7, 0x50, 0x9d, 0x1f, 0xff, 0x65, 0xfa, 0xb4, 0x0};

  uint8_t buf[132] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x34, 0x11, 0x83, 0xdb, 0x7b, 0xfd, 0xa0, 0xa, 0x97, 0x66, 0xe2, 0x7b, 0xda, 0xb3};
  lwmqtt_string_t topic_filter_s0 = {14, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x46, 0xad, 0xae, 0xb2, 0xfc, 0x90, 0xa1, 0xc1, 0x30, 0x48,
                                     0x82, 0x63, 0xaa, 0x2c, 0xa0, 0xa7, 0x2d, 0x29, 0xa2};
  lwmqtt_string_t topic_filter_s1 = {19, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe6, 0xd8, 0xdb, 0x52, 0x6, 0xcb, 0x5c, 0x19, 0xce, 0x7c, 0x97, 0xfa, 0x37};
  lwmqtt_string_t topic_filter_s2 = {13, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x37, 0x21, 0xf5, 0x84, 0x7e, 0x12, 0x28, 0xa4, 0xb,  0xa7, 0x70, 0xf9,
                                     0x4f, 0x5d, 0x4,  0x78, 0x2a, 0x26, 0xad, 0x70, 0x50, 0xf9, 0xd1};
  lwmqtt_string_t topic_filter_s3 = {23, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xd5, 0x1c, 0x92, 0x69, 0xdf, 0x14, 0xe9, 0x11, 0xf,  0xd0, 0x2a,
                                     0x5f, 0x42, 0xc6, 0x45, 0x50, 0x6,  0x5b, 0xe2, 0xb6, 0x29, 0xff};
  lwmqtt_string_t topic_filter_s4 = {22, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0xf7, 0x50, 0x9d, 0x1f, 0xff, 0x65, 0xfa, 0xb4};
  lwmqtt_string_t topic_filter_s5 = {8, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS0};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25785, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 8081 [("\247\197\143\CANr(\SO\230",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished
// = False, _noLocal = False, _subQoS = QoS0}),("\183\151u\251Or\149\230`\218\133\NUL\ETX\f",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("%\232\ACKq\200;\197\192\155\162\245|\t(\206\172\a\DELe\148\253\227\200\253\187s\219\179y",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("rp\156\133\138@\184",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal =
// False, _subQoS = QoS0}),("\STX\f\202\217I\195/\218#\168^<V3\251\221",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("V\188\NUL\151S\EM\251&\RS$\199\150\141\198\241)\ENQ;\153\145\189\184\ESC\166\190\t",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})]
// [PropAuthenticationMethod "w",PropRequestResponseInformation 233,PropWillDelayInterval
// 29708,PropPayloadFormatIndicator 24,PropWildcardSubscriptionAvailable 95,PropPayloadFormatIndicator
// 128,PropCorrelationData "\251\FS\131\240\DC3r\209\202C\247\183\vSM",PropPayloadFormatIndicator
// 77,PropSharedSubscriptionAvailable 93,PropReceiveMaximum 453,PropUserProperty "J\180\246\GS\DC30\202\210\156\202\189"
// "K\161\137\222\NAK\151\234x)z\183k\211\137O\SI\EOT\215\&1'\ETX\149\230\166\199\NUL",PropMessageExpiryInterval
// 17991,PropMaximumQoS 15,PropMessageExpiryInterval 693]
TEST(Subscribe5QCTest, Encode93) {
  uint8_t pkt[] = {
      0x82, 0xdb, 0x1,  0x1f, 0x91, 0x5f, 0x15, 0x0,  0x1,  0x77, 0x19, 0xe9, 0x18, 0x0,  0x0,  0x74, 0xc,  0x1,  0x18,
      0x28, 0x5f, 0x1,  0x80, 0x9,  0x0,  0xe,  0xfb, 0x1c, 0x83, 0xf0, 0x13, 0x72, 0xd1, 0xca, 0x43, 0xf7, 0xb7, 0xb,
      0x53, 0x4d, 0x1,  0x4d, 0x2a, 0x5d, 0x21, 0x1,  0xc5, 0x26, 0x0,  0xb,  0x4a, 0xb4, 0xf6, 0x1d, 0x13, 0x30, 0xca,
      0xd2, 0x9c, 0xca, 0xbd, 0x0,  0x1a, 0x4b, 0xa1, 0x89, 0xde, 0x15, 0x97, 0xea, 0x78, 0x29, 0x7a, 0xb7, 0x6b, 0xd3,
      0x89, 0x4f, 0xf,  0x4,  0xd7, 0x31, 0x27, 0x3,  0x95, 0xe6, 0xa6, 0xc7, 0x0,  0x2,  0x0,  0x0,  0x46, 0x47, 0x24,
      0xf,  0x2,  0x0,  0x0,  0x2,  0xb5, 0x0,  0x8,  0xf7, 0xc5, 0x8f, 0x18, 0x72, 0x28, 0xe,  0xe6, 0x0,  0x0,  0xe,
      0xb7, 0x97, 0x75, 0xfb, 0x4f, 0x72, 0x95, 0xe6, 0x60, 0xda, 0x85, 0x0,  0x3,  0xc,  0x0,  0x0,  0x1d, 0x25, 0xe8,
      0x6,  0x71, 0xc8, 0x3b, 0xc5, 0xc0, 0x9b, 0xa2, 0xf5, 0x7c, 0x9,  0x28, 0xce, 0xac, 0x7,  0x7f, 0x65, 0x94, 0xfd,
      0xe3, 0xc8, 0xfd, 0xbb, 0x73, 0xdb, 0xb3, 0x79, 0x0,  0x0,  0x7,  0x72, 0x70, 0x9c, 0x85, 0x8a, 0x40, 0xb8, 0x0,
      0x0,  0x0,  0x0,  0x0,  0x10, 0x2,  0xc,  0xca, 0xd9, 0x49, 0xc3, 0x2f, 0xda, 0x23, 0xa8, 0x5e, 0x3c, 0x56, 0x33,
      0xfb, 0xdd, 0x0,  0x0,  0x1a, 0x56, 0xbc, 0x0,  0x97, 0x53, 0x19, 0xfb, 0x26, 0x1e, 0x24, 0xc7, 0x96, 0x8d, 0xc6,
      0xf1, 0x29, 0x5,  0x3b, 0x99, 0x91, 0xbd, 0xb8, 0x1b, 0xa6, 0xbe, 0x9,  0x2};

  uint8_t buf[232] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xf7, 0xc5, 0x8f, 0x18, 0x72, 0x28, 0xe, 0xe6};
  lwmqtt_string_t topic_filter_s0 = {8, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0xb7, 0x97, 0x75, 0xfb, 0x4f, 0x72, 0x95, 0xe6, 0x60, 0xda, 0x85, 0x0, 0x3, 0xc};
  lwmqtt_string_t topic_filter_s1 = {14, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x25, 0xe8, 0x6,  0x71, 0xc8, 0x3b, 0xc5, 0xc0, 0x9b, 0xa2,
                                     0xf5, 0x7c, 0x9,  0x28, 0xce, 0xac, 0x7,  0x7f, 0x65, 0x94,
                                     0xfd, 0xe3, 0xc8, 0xfd, 0xbb, 0x73, 0xdb, 0xb3, 0x79};
  lwmqtt_string_t topic_filter_s2 = {29, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x72, 0x70, 0x9c, 0x85, 0x8a, 0x40, 0xb8};
  lwmqtt_string_t topic_filter_s3 = {7, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0};
  lwmqtt_string_t topic_filter_s4 = {0, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x2,  0xc,  0xca, 0xd9, 0x49, 0xc3, 0x2f, 0xda,
                                     0x23, 0xa8, 0x5e, 0x3c, 0x56, 0x33, 0xfb, 0xdd};
  lwmqtt_string_t topic_filter_s5 = {16, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x56, 0xbc, 0x0,  0x97, 0x53, 0x19, 0xfb, 0x26, 0x1e, 0x24, 0xc7, 0x96, 0x8d,
                                     0xc6, 0xf1, 0x29, 0x5,  0x3b, 0x99, 0x91, 0xbd, 0xb8, 0x1b, 0xa6, 0xbe, 0x9};
  lwmqtt_string_t topic_filter_s6 = {26, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS0,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x77};
  uint8_t bytesprops1[] = {0xfb, 0x1c, 0x83, 0xf0, 0x13, 0x72, 0xd1, 0xca, 0x43, 0xf7, 0xb7, 0xb, 0x53, 0x4d};
  uint8_t bytesprops3[] = {0x4b, 0xa1, 0x89, 0xde, 0x15, 0x97, 0xea, 0x78, 0x29, 0x7a, 0xb7, 0x6b, 0xd3,
                           0x89, 0x4f, 0xf,  0x4,  0xd7, 0x31, 0x27, 0x3,  0x95, 0xe6, 0xa6, 0xc7, 0x0};
  uint8_t bytesprops2[] = {0x4a, 0xb4, 0xf6, 0x1d, 0x13, 0x30, 0xca, 0xd2, 0x9c, 0xca, 0xbd};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {1, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 233}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 29708}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 24}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 95}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 128}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {14, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 77}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 93}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 453}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {11, (char*)&bytesprops2}, .v = {26, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 17991}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 15}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 693}},
  };

  lwmqtt_properties_t props = {14, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 8081, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 4638
// [("S\220\&2\154\206\\\254\EOT\\\212\FS\\\244\DC4\217?\144\230\200\137\252o\185\FS\US\148G\SOH",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("c\161\fG\150\206T\187E\170o\CAN\STX\168\172\238\249\210\154\215\144\238r\170-\175'h",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("tNSrg",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS
// = QoS2}),("\DC1y\160B\243\US\SI\228H\218\128\158\210[\140\147\f3\177\EOT\151\148\&2'",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\226\197\190\a)\156\155\246\157|\243\181[T\199p",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\\\248H\138\STX",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropUserProperty "\198<\227/"
// "/\231m\DC3]\196\160\163).\nc\218\rxc-",PropTopicAlias 18623,PropSessionExpiryInterval 30497,PropMaximumPacketSize
// 8366,PropRetainAvailable 159,PropRequestProblemInformation 250,PropRequestResponseInformation 248]
TEST(Subscribe5QCTest, Encode94) {
  uint8_t pkt[] = {0x82, 0xac, 0x1,  0x12, 0x1e, 0x2d, 0x26, 0x0,  0x4,  0xc6, 0x3c, 0xe3, 0x2f, 0x0,  0x11, 0x2f,
                   0xe7, 0x6d, 0x13, 0x5d, 0xc4, 0xa0, 0xa3, 0x29, 0x2e, 0xa,  0x63, 0xda, 0xd,  0x78, 0x63, 0x2d,
                   0x23, 0x48, 0xbf, 0x11, 0x0,  0x0,  0x77, 0x21, 0x27, 0x0,  0x0,  0x20, 0xae, 0x25, 0x9f, 0x17,
                   0xfa, 0x19, 0xf8, 0x0,  0x1c, 0x53, 0xdc, 0x32, 0x9a, 0xce, 0x5c, 0xfe, 0x4,  0x5c, 0xd4, 0x1c,
                   0x5c, 0xf4, 0x14, 0xd9, 0x3f, 0x90, 0xe6, 0xc8, 0x89, 0xfc, 0x6f, 0xb9, 0x1c, 0x1f, 0x94, 0x47,
                   0x1,  0x1,  0x0,  0x1c, 0x63, 0xa1, 0xc,  0x47, 0x96, 0xce, 0x54, 0xbb, 0x45, 0xaa, 0x6f, 0x18,
                   0x2,  0xa8, 0xac, 0xee, 0xf9, 0xd2, 0x9a, 0xd7, 0x90, 0xee, 0x72, 0xaa, 0x2d, 0xaf, 0x27, 0x68,
                   0x0,  0x0,  0x5,  0x74, 0x4e, 0x53, 0x72, 0x67, 0x2,  0x0,  0x18, 0x11, 0x79, 0xa0, 0x42, 0xf3,
                   0x1f, 0xf,  0xe4, 0x48, 0xda, 0x80, 0x9e, 0xd2, 0x5b, 0x8c, 0x93, 0xc,  0x33, 0xb1, 0x4,  0x97,
                   0x94, 0x32, 0x27, 0x2,  0x0,  0x10, 0xe2, 0xc5, 0xbe, 0x7,  0x29, 0x9c, 0x9b, 0xf6, 0x9d, 0x7c,
                   0xf3, 0xb5, 0x5b, 0x54, 0xc7, 0x70, 0x2,  0x0,  0x5,  0x5c, 0xf8, 0x48, 0x8a, 0x2,  0x2};

  uint8_t buf[185] = {0};

  lwmqtt_string_t topic_filters[6];
  uint8_t topic_filter_s0_bytes[] = {0x53, 0xdc, 0x32, 0x9a, 0xce, 0x5c, 0xfe, 0x4,  0x5c, 0xd4, 0x1c, 0x5c, 0xf4, 0x14,
                                     0xd9, 0x3f, 0x90, 0xe6, 0xc8, 0x89, 0xfc, 0x6f, 0xb9, 0x1c, 0x1f, 0x94, 0x47, 0x1};
  lwmqtt_string_t topic_filter_s0 = {28, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x63, 0xa1, 0xc,  0x47, 0x96, 0xce, 0x54, 0xbb, 0x45, 0xaa,
                                     0x6f, 0x18, 0x2,  0xa8, 0xac, 0xee, 0xf9, 0xd2, 0x9a, 0xd7,
                                     0x90, 0xee, 0x72, 0xaa, 0x2d, 0xaf, 0x27, 0x68};
  lwmqtt_string_t topic_filter_s1 = {28, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x74, 0x4e, 0x53, 0x72, 0x67};
  lwmqtt_string_t topic_filter_s2 = {5, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x11, 0x79, 0xa0, 0x42, 0xf3, 0x1f, 0xf,  0xe4, 0x48, 0xda, 0x80, 0x9e,
                                     0xd2, 0x5b, 0x8c, 0x93, 0xc,  0x33, 0xb1, 0x4,  0x97, 0x94, 0x32, 0x27};
  lwmqtt_string_t topic_filter_s3 = {24, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xe2, 0xc5, 0xbe, 0x7,  0x29, 0x9c, 0x9b, 0xf6,
                                     0x9d, 0x7c, 0xf3, 0xb5, 0x5b, 0x54, 0xc7, 0x70};
  lwmqtt_string_t topic_filter_s4 = {16, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x5c, 0xf8, 0x48, 0x8a, 0x2};
  lwmqtt_string_t topic_filter_s5 = {5, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops1[] = {0x2f, 0xe7, 0x6d, 0x13, 0x5d, 0xc4, 0xa0, 0xa3, 0x29,
                           0x2e, 0xa,  0x63, 0xda, 0xd,  0x78, 0x63, 0x2d};
  uint8_t bytesprops0[] = {0xc6, 0x3c, 0xe3, 0x2f};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {4, (char*)&bytesprops0}, .v = {17, (char*)&bytesprops1}}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 18623}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 30497}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 8366}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 159}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 250}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 248}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 4638, 6, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 30339 [("\179u\189\US\149]BIh\141\231\&6-\r\DC1Zc\223\\\DC3\163",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\RS\239\NAK.\t\226\168BS\142\163\209\211\134\\Uz\EOTV\129\STX.\ENQ\RS\ETB",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("r\146\230\ESC\129\250\136&\248\195p\140J(\DC2|",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\251\175\166\&3\137\173N\196\187T~\DEL\158\245\238\247B\151\139\r\142=\247\EOT/\171E",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\204\171\242\244a7\178\140\138\149\174\201",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\131\241\222xlu'9!6\242\213K\227\&0\234\199\150+d\"\DC2/\145\149i;EV",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\SYNr\167\NUL\254\180",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\193\211\192\222m\154\164",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2})] [PropRetainAvailable 242,PropServerReference
// "\DC2\147\&9\ESC\178\DEL\169\DC1\168\172",PropTopicAlias 3260,PropRequestProblemInformation 61,PropServerKeepAlive
// 24137,PropWillDelayInterval 1106,PropRetainAvailable 194,PropMaximumQoS 114,PropTopicAlias 31301,PropUserProperty
// "r\US\227\&3I\138$\229g\240\135\212F\157\142\&6\DC3\NAKw>\243\&5gR\165\231"
// "\t\148\246\163>\ENQ\185\132\&1y\158w\144\151\196\174A*\209\221\235\223E",PropMessageExpiryInterval
// 11966,PropMessageExpiryInterval 7995,PropWillDelayInterval 4193,PropResponseInformation
// "\129C\199\179\199\234\SOH\231\194\132eH?\210ZF\210Ce/\152\209!\217\151\178\205",PropAuthenticationData
// "\n&\253\209\t\211V7\250E\ENQ\228",PropResponseTopic
// "1\181\177\206\164\155?\243q\145\&6\227,\SUB`#\EM\236]\136\178\162\228\\(",PropMaximumQoS
// 7,PropSubscriptionIdentifierAvailable 214,PropMaximumPacketSize 17538,PropPayloadFormatIndicator
// 193,PropSessionExpiryInterval 27816,PropRequestProblemInformation 68,PropMaximumPacketSize
// 19853,PropTopicAliasMaximum 19517,PropReasonString
// "\135\158\251\144m\NUL9\DC1\EM\209\ACK\250=!\135\129\&6\DLE+)\v\190\154\204Y\GSA\217\140",PropRequestProblemInformation
// 99,PropSubscriptionIdentifier 24,PropSubscriptionIdentifierAvailable 200,PropReceiveMaximum 3399]
TEST(Subscribe5QCTest, Encode95) {
  uint8_t pkt[] = {
      0x82, 0x9f, 0x3,  0x76, 0x83, 0xf4, 0x1,  0x25, 0xf2, 0x1c, 0x0,  0xa,  0x12, 0x93, 0x39, 0x1b, 0xb2, 0x7f, 0xa9,
      0x11, 0xa8, 0xac, 0x23, 0xc,  0xbc, 0x17, 0x3d, 0x13, 0x5e, 0x49, 0x18, 0x0,  0x0,  0x4,  0x52, 0x25, 0xc2, 0x24,
      0x72, 0x23, 0x7a, 0x45, 0x26, 0x0,  0x1a, 0x72, 0x1f, 0xe3, 0x33, 0x49, 0x8a, 0x24, 0xe5, 0x67, 0xf0, 0x87, 0xd4,
      0x46, 0x9d, 0x8e, 0x36, 0x13, 0x15, 0x77, 0x3e, 0xf3, 0x35, 0x67, 0x52, 0xa5, 0xe7, 0x0,  0x17, 0x9,  0x94, 0xf6,
      0xa3, 0x3e, 0x5,  0xb9, 0x84, 0x31, 0x79, 0x9e, 0x77, 0x90, 0x97, 0xc4, 0xae, 0x41, 0x2a, 0xd1, 0xdd, 0xeb, 0xdf,
      0x45, 0x2,  0x0,  0x0,  0x2e, 0xbe, 0x2,  0x0,  0x0,  0x1f, 0x3b, 0x18, 0x0,  0x0,  0x10, 0x61, 0x1a, 0x0,  0x1b,
      0x81, 0x43, 0xc7, 0xb3, 0xc7, 0xea, 0x1,  0xe7, 0xc2, 0x84, 0x65, 0x48, 0x3f, 0xd2, 0x5a, 0x46, 0xd2, 0x43, 0x65,
      0x2f, 0x98, 0xd1, 0x21, 0xd9, 0x97, 0xb2, 0xcd, 0x16, 0x0,  0xc,  0xa,  0x26, 0xfd, 0xd1, 0x9,  0xd3, 0x56, 0x37,
      0xfa, 0x45, 0x5,  0xe4, 0x8,  0x0,  0x19, 0x31, 0xb5, 0xb1, 0xce, 0xa4, 0x9b, 0x3f, 0xf3, 0x71, 0x91, 0x36, 0xe3,
      0x2c, 0x1a, 0x60, 0x23, 0x19, 0xec, 0x5d, 0x88, 0xb2, 0xa2, 0xe4, 0x5c, 0x28, 0x24, 0x7,  0x29, 0xd6, 0x27, 0x0,
      0x0,  0x44, 0x82, 0x1,  0xc1, 0x11, 0x0,  0x0,  0x6c, 0xa8, 0x17, 0x44, 0x27, 0x0,  0x0,  0x4d, 0x8d, 0x22, 0x4c,
      0x3d, 0x1f, 0x0,  0x1d, 0x87, 0x9e, 0xfb, 0x90, 0x6d, 0x0,  0x39, 0x11, 0x19, 0xd1, 0x6,  0xfa, 0x3d, 0x21, 0x87,
      0x81, 0x36, 0x10, 0x2b, 0x29, 0xb,  0xbe, 0x9a, 0xcc, 0x59, 0x1d, 0x41, 0xd9, 0x8c, 0x17, 0x63, 0xb,  0x18, 0x29,
      0xc8, 0x21, 0xd,  0x47, 0x0,  0x15, 0xb3, 0x75, 0xbd, 0x1f, 0x95, 0x5d, 0x42, 0x49, 0x68, 0x8d, 0xe7, 0x36, 0x2d,
      0xd,  0x11, 0x5a, 0x63, 0xdf, 0x5c, 0x13, 0xa3, 0x0,  0x0,  0x19, 0x1e, 0xef, 0x15, 0x2e, 0x9,  0xe2, 0xa8, 0x42,
      0x53, 0x8e, 0xa3, 0xd1, 0xd3, 0x86, 0x5c, 0x55, 0x7a, 0x4,  0x56, 0x81, 0x2,  0x2e, 0x5,  0x1e, 0x17, 0x2,  0x0,
      0x10, 0x72, 0x92, 0xe6, 0x1b, 0x81, 0xfa, 0x88, 0x26, 0xf8, 0xc3, 0x70, 0x8c, 0x4a, 0x28, 0x12, 0x7c, 0x1,  0x0,
      0x1b, 0xfb, 0xaf, 0xa6, 0x33, 0x89, 0xad, 0x4e, 0xc4, 0xbb, 0x54, 0x7e, 0x7f, 0x9e, 0xf5, 0xee, 0xf7, 0x42, 0x97,
      0x8b, 0xd,  0x8e, 0x3d, 0xf7, 0x4,  0x2f, 0xab, 0x45, 0x0,  0x0,  0xc,  0xcc, 0xab, 0xf2, 0xf4, 0x61, 0x37, 0xb2,
      0x8c, 0x8a, 0x95, 0xae, 0xc9, 0x2,  0x0,  0x1d, 0x83, 0xf1, 0xde, 0x78, 0x6c, 0x75, 0x27, 0x39, 0x21, 0x36, 0xf2,
      0xd5, 0x4b, 0xe3, 0x30, 0xea, 0xc7, 0x96, 0x2b, 0x64, 0x22, 0x12, 0x2f, 0x91, 0x95, 0x69, 0x3b, 0x45, 0x56, 0x1,
      0x0,  0x6,  0x16, 0x72, 0xa7, 0x0,  0xfe, 0xb4, 0x2,  0x0,  0x7,  0xc1, 0xd3, 0xc0, 0xde, 0x6d, 0x9a, 0xa4, 0x2};

  uint8_t buf[428] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0xb3, 0x75, 0xbd, 0x1f, 0x95, 0x5d, 0x42, 0x49, 0x68, 0x8d, 0xe7,
                                     0x36, 0x2d, 0xd,  0x11, 0x5a, 0x63, 0xdf, 0x5c, 0x13, 0xa3};
  lwmqtt_string_t topic_filter_s0 = {21, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x1e, 0xef, 0x15, 0x2e, 0x9, 0xe2, 0xa8, 0x42, 0x53, 0x8e, 0xa3, 0xd1, 0xd3,
                                     0x86, 0x5c, 0x55, 0x7a, 0x4, 0x56, 0x81, 0x2,  0x2e, 0x5,  0x1e, 0x17};
  lwmqtt_string_t topic_filter_s1 = {25, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x72, 0x92, 0xe6, 0x1b, 0x81, 0xfa, 0x88, 0x26,
                                     0xf8, 0xc3, 0x70, 0x8c, 0x4a, 0x28, 0x12, 0x7c};
  lwmqtt_string_t topic_filter_s2 = {16, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xfb, 0xaf, 0xa6, 0x33, 0x89, 0xad, 0x4e, 0xc4, 0xbb, 0x54, 0x7e, 0x7f, 0x9e, 0xf5,
                                     0xee, 0xf7, 0x42, 0x97, 0x8b, 0xd,  0x8e, 0x3d, 0xf7, 0x4,  0x2f, 0xab, 0x45};
  lwmqtt_string_t topic_filter_s3 = {27, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xcc, 0xab, 0xf2, 0xf4, 0x61, 0x37, 0xb2, 0x8c, 0x8a, 0x95, 0xae, 0xc9};
  lwmqtt_string_t topic_filter_s4 = {12, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x83, 0xf1, 0xde, 0x78, 0x6c, 0x75, 0x27, 0x39, 0x21, 0x36,
                                     0xf2, 0xd5, 0x4b, 0xe3, 0x30, 0xea, 0xc7, 0x96, 0x2b, 0x64,
                                     0x22, 0x12, 0x2f, 0x91, 0x95, 0x69, 0x3b, 0x45, 0x56};
  lwmqtt_string_t topic_filter_s5 = {29, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x16, 0x72, 0xa7, 0x0, 0xfe, 0xb4};
  lwmqtt_string_t topic_filter_s6 = {6, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xc1, 0xd3, 0xc0, 0xde, 0x6d, 0x9a, 0xa4};
  lwmqtt_string_t topic_filter_s7 = {7, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0x12, 0x93, 0x39, 0x1b, 0xb2, 0x7f, 0xa9, 0x11, 0xa8, 0xac};
  uint8_t bytesprops2[] = {0x9,  0x94, 0xf6, 0xa3, 0x3e, 0x5,  0xb9, 0x84, 0x31, 0x79, 0x9e, 0x77,
                           0x90, 0x97, 0xc4, 0xae, 0x41, 0x2a, 0xd1, 0xdd, 0xeb, 0xdf, 0x45};
  uint8_t bytesprops1[] = {0x72, 0x1f, 0xe3, 0x33, 0x49, 0x8a, 0x24, 0xe5, 0x67, 0xf0, 0x87, 0xd4, 0x46,
                           0x9d, 0x8e, 0x36, 0x13, 0x15, 0x77, 0x3e, 0xf3, 0x35, 0x67, 0x52, 0xa5, 0xe7};
  uint8_t bytesprops3[] = {0x81, 0x43, 0xc7, 0xb3, 0xc7, 0xea, 0x1,  0xe7, 0xc2, 0x84, 0x65, 0x48, 0x3f, 0xd2,
                           0x5a, 0x46, 0xd2, 0x43, 0x65, 0x2f, 0x98, 0xd1, 0x21, 0xd9, 0x97, 0xb2, 0xcd};
  uint8_t bytesprops4[] = {0xa, 0x26, 0xfd, 0xd1, 0x9, 0xd3, 0x56, 0x37, 0xfa, 0x45, 0x5, 0xe4};
  uint8_t bytesprops5[] = {0x31, 0xb5, 0xb1, 0xce, 0xa4, 0x9b, 0x3f, 0xf3, 0x71, 0x91, 0x36, 0xe3, 0x2c,
                           0x1a, 0x60, 0x23, 0x19, 0xec, 0x5d, 0x88, 0xb2, 0xa2, 0xe4, 0x5c, 0x28};
  uint8_t bytesprops6[] = {0x87, 0x9e, 0xfb, 0x90, 0x6d, 0x0, 0x39, 0x11, 0x19, 0xd1, 0x6,  0xfa, 0x3d, 0x21, 0x87,
                           0x81, 0x36, 0x10, 0x2b, 0x29, 0xb, 0xbe, 0x9a, 0xcc, 0x59, 0x1d, 0x41, 0xd9, 0x8c};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 242}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {10, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 3260}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 61}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 24137}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 1106}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 194}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 114}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 31301}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {26, (char*)&bytesprops1}, .v = {23, (char*)&bytesprops2}}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 11966}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 7995}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4193}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {27, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {12, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {25, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 7}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 214}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 17538}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 193}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 27816}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 68}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 19853}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 19517}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {29, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 99}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 24}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 200}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 3399}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 30339, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 25983 [("\NULh]\172\248\158\GS:.\SOH<\\0\204q",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\CAN?\208\234\166~,\246\198\198\RS\128\a\167#\ESC\USb\161\FS",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\160\US\153\210\&2\243#\154\167",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\129\CAN\203\191Y5\132\246\162\129\192XU\"\172S",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] []
TEST(Subscribe5QCTest, Encode96) {
  uint8_t pkt[] = {0x82, 0x4b, 0x65, 0x7f, 0x0,  0x0,  0xf,  0x0,  0x68, 0x5d, 0xac, 0xf8, 0x9e, 0x1d, 0x3a, 0x2e,
                   0x1,  0x3c, 0x5c, 0x30, 0xcc, 0x71, 0x2,  0x0,  0x14, 0x18, 0x3f, 0xd0, 0xea, 0xa6, 0x7e, 0x2c,
                   0xf6, 0xc6, 0xc6, 0x1e, 0x80, 0x7,  0xa7, 0x23, 0x1b, 0x1f, 0x62, 0xa1, 0x1c, 0x1,  0x0,  0x9,
                   0xa0, 0x1f, 0x99, 0xd2, 0x32, 0xf3, 0x23, 0x9a, 0xa7, 0x0,  0x0,  0x10, 0x81, 0x18, 0xcb, 0xbf,
                   0x59, 0x35, 0x84, 0xf6, 0xa2, 0x81, 0xc0, 0x58, 0x55, 0x22, 0xac, 0x53, 0x1};

  uint8_t buf[87] = {0};

  lwmqtt_string_t topic_filters[4];
  uint8_t topic_filter_s0_bytes[] = {0x0,  0x68, 0x5d, 0xac, 0xf8, 0x9e, 0x1d, 0x3a,
                                     0x2e, 0x1,  0x3c, 0x5c, 0x30, 0xcc, 0x71};
  lwmqtt_string_t topic_filter_s0 = {15, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x18, 0x3f, 0xd0, 0xea, 0xa6, 0x7e, 0x2c, 0xf6, 0xc6, 0xc6,
                                     0x1e, 0x80, 0x7,  0xa7, 0x23, 0x1b, 0x1f, 0x62, 0xa1, 0x1c};
  lwmqtt_string_t topic_filter_s1 = {20, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xa0, 0x1f, 0x99, 0xd2, 0x32, 0xf3, 0x23, 0x9a, 0xa7};
  lwmqtt_string_t topic_filter_s2 = {9, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0x81, 0x18, 0xcb, 0xbf, 0x59, 0x35, 0x84, 0xf6,
                                     0xa2, 0x81, 0xc0, 0x58, 0x55, 0x22, 0xac, 0x53};
  lwmqtt_string_t topic_filter_s3 = {16, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS1};

  lwmqtt_property_t propslist[] = {};

  lwmqtt_properties_t props = {0, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 25983, 4, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 14533 [("\207u\229\191Dm6]U\152",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS2}),("\159\195\128\SOHK\243\248gf\DEL",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("[{\199\214\EMb\b\140H/\140\146\DC3\SYN\141\SOh\251\148\a\145\SOH*\160\190\145\130D\SO/",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2}),("\v6\STX\"\b%
// \211\241\184\238\234b\247\174\178w",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False,
// _noLocal = False, _subQoS = QoS2}),("\158\143\t\131\211\229\129,\234\193GG\206r\191\150\176\DC2",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("6\195\241\184/\168\206",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal
// = False, _subQoS = QoS0}),("\140\DC3M\195\237\DLEO\231",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropRequestProblemInformation
// 251,PropSubscriptionIdentifier 27,PropServerReference "\166",PropServerKeepAlive 26843,PropSubscriptionIdentifier
// 24,PropAssignedClientIdentifier "#\SYN'\154\145\133\138\183\237y\195]rp?\DC3\DC1\164\203\169\r",PropUserProperty
// "iT\ACK\197\191@3\226\DC4\225h\145\247\160\180\238\204\213\a\221c\188*\252"
// "@\226`hV\230I\187\221\150V\144\ESCuV\191",PropMessageExpiryInterval 14849,PropAuthenticationMethod
// "\184\175z\170\154\183\234\144\226\151W\224"]
TEST(Subscribe5QCTest, Encode97) {
  uint8_t pkt[] = {0x82, 0xe2, 0x1,  0x38, 0xc5, 0x66, 0x17, 0xfb, 0xb,  0x1b, 0x1c, 0x0,  0x1,  0xa6, 0x13, 0x68, 0xdb,
                   0xb,  0x18, 0x12, 0x0,  0x15, 0x23, 0x16, 0x27, 0x9a, 0x91, 0x85, 0x8a, 0xb7, 0xed, 0x79, 0xc3, 0x5d,
                   0x72, 0x70, 0x3f, 0x13, 0x11, 0xa4, 0xcb, 0xa9, 0xd,  0x26, 0x0,  0x18, 0x69, 0x54, 0x6,  0xc5, 0xbf,
                   0x40, 0x33, 0xe2, 0x14, 0xe1, 0x68, 0x91, 0xf7, 0xa0, 0xb4, 0xee, 0xcc, 0xd5, 0x7,  0xdd, 0x63, 0xbc,
                   0x2a, 0xfc, 0x0,  0x10, 0x40, 0xe2, 0x60, 0x68, 0x56, 0xe6, 0x49, 0xbb, 0xdd, 0x96, 0x56, 0x90, 0x1b,
                   0x75, 0x56, 0xbf, 0x2,  0x0,  0x0,  0x3a, 0x1,  0x15, 0x0,  0xc,  0xb8, 0xaf, 0x7a, 0xaa, 0x9a, 0xb7,
                   0xea, 0x90, 0xe2, 0x97, 0x57, 0xe0, 0x0,  0xa,  0xcf, 0x75, 0xe5, 0xbf, 0x44, 0x6d, 0x36, 0x5d, 0x55,
                   0x98, 0x2,  0x0,  0xa,  0x9f, 0xc3, 0x80, 0x1,  0x4b, 0xf3, 0xf8, 0x67, 0x66, 0x7f, 0x0,  0x0,  0x1e,
                   0x5b, 0x7b, 0xc7, 0xd6, 0x19, 0x62, 0x8,  0x8c, 0x48, 0x2f, 0x8c, 0x92, 0x13, 0x16, 0x8d, 0xe,  0x68,
                   0xfb, 0x94, 0x7,  0x91, 0x1,  0x2a, 0xa0, 0xbe, 0x91, 0x82, 0x44, 0xe,  0x2f, 0x2,  0x0,  0x11, 0xb,
                   0x36, 0x2,  0x22, 0x8,  0x25, 0x20, 0xd3, 0xf1, 0xb8, 0xee, 0xea, 0x62, 0xf7, 0xae, 0xb2, 0x77, 0x2,
                   0x0,  0x12, 0x9e, 0x8f, 0x9,  0x83, 0xd3, 0xe5, 0x81, 0x2c, 0xea, 0xc1, 0x47, 0x47, 0xce, 0x72, 0xbf,
                   0x96, 0xb0, 0x12, 0x0,  0x0,  0x7,  0x36, 0xc3, 0xf1, 0xb8, 0x2f, 0xa8, 0xce, 0x0,  0x0,  0x8,  0x8c,
                   0x13, 0x4d, 0xc3, 0xed, 0x10, 0x4f, 0xe7, 0x1};

  uint8_t buf[239] = {0};

  lwmqtt_string_t topic_filters[7];
  uint8_t topic_filter_s0_bytes[] = {0xcf, 0x75, 0xe5, 0xbf, 0x44, 0x6d, 0x36, 0x5d, 0x55, 0x98};
  lwmqtt_string_t topic_filter_s0 = {10, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x9f, 0xc3, 0x80, 0x1, 0x4b, 0xf3, 0xf8, 0x67, 0x66, 0x7f};
  lwmqtt_string_t topic_filter_s1 = {10, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0x5b, 0x7b, 0xc7, 0xd6, 0x19, 0x62, 0x8,  0x8c, 0x48, 0x2f,
                                     0x8c, 0x92, 0x13, 0x16, 0x8d, 0xe,  0x68, 0xfb, 0x94, 0x7,
                                     0x91, 0x1,  0x2a, 0xa0, 0xbe, 0x91, 0x82, 0x44, 0xe,  0x2f};
  lwmqtt_string_t topic_filter_s2 = {30, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xb,  0x36, 0x2,  0x22, 0x8,  0x25, 0x20, 0xd3, 0xf1,
                                     0xb8, 0xee, 0xea, 0x62, 0xf7, 0xae, 0xb2, 0x77};
  lwmqtt_string_t topic_filter_s3 = {17, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x9e, 0x8f, 0x9,  0x83, 0xd3, 0xe5, 0x81, 0x2c, 0xea,
                                     0xc1, 0x47, 0x47, 0xce, 0x72, 0xbf, 0x96, 0xb0, 0x12};
  lwmqtt_string_t topic_filter_s4 = {18, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x36, 0xc3, 0xf1, 0xb8, 0x2f, 0xa8, 0xce};
  lwmqtt_string_t topic_filter_s5 = {7, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x8c, 0x13, 0x4d, 0xc3, 0xed, 0x10, 0x4f, 0xe7};
  lwmqtt_string_t topic_filter_s6 = {8, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS2, LWMQTT_QOS0, LWMQTT_QOS2, LWMQTT_QOS2,
                               LWMQTT_QOS0, LWMQTT_QOS0, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xa6};
  uint8_t bytesprops1[] = {0x23, 0x16, 0x27, 0x9a, 0x91, 0x85, 0x8a, 0xb7, 0xed, 0x79, 0xc3,
                           0x5d, 0x72, 0x70, 0x3f, 0x13, 0x11, 0xa4, 0xcb, 0xa9, 0xd};
  uint8_t bytesprops3[] = {0x40, 0xe2, 0x60, 0x68, 0x56, 0xe6, 0x49, 0xbb,
                           0xdd, 0x96, 0x56, 0x90, 0x1b, 0x75, 0x56, 0xbf};
  uint8_t bytesprops2[] = {0x69, 0x54, 0x6,  0xc5, 0xbf, 0x40, 0x33, 0xe2, 0x14, 0xe1, 0x68, 0x91,
                           0xf7, 0xa0, 0xb4, 0xee, 0xcc, 0xd5, 0x7,  0xdd, 0x63, 0xbc, 0x2a, 0xfc};
  uint8_t bytesprops4[] = {0xb8, 0xaf, 0x7a, 0xaa, 0x9a, 0xb7, 0xea, 0x90, 0xe2, 0x97, 0x57, 0xe0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 251}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 27}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {1, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 26843}},
      {.prop = (lwmqtt_prop_t)11, .value = {.varint = 24}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {21, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {24, (char*)&bytesprops2}, .v = {16, (char*)&bytesprops3}}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 14849}},
      {.prop = (lwmqtt_prop_t)21, .value = {.str = {12, (char*)&bytesprops4}}},
  };

  lwmqtt_properties_t props = {9, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 14533, 7, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 1538
// [("\136v9\252\152\153\179\197P\132F\ETX\176\STX\166RR\222\t\216\163\143\252n\ETB\212",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropAssignedClientIdentifier
// "\DC1c1\177\SOHV?\239\218\ESCn\SOHw\209",PropRequestProblemInformation 42,PropServerReference
// "l4\ENQT4\206\180\147\246\133\144\227\196f\246r\156\173\180\185\161\145\ETB",PropTopicAliasMaximum
// 24939,PropSubscriptionIdentifierAvailable 37,PropResponseInformation "_\168\232",PropWillDelayInterval
// 4504,PropContentType "\180\175\DEL\203\188Y\132\218\USV\235\248\DC3\211FW\174\215\&0\145\DC4",PropAuthenticationData
// "\222\129\211\bX\179\228\157\DC2\255W",PropMessageExpiryInterval 29266,PropPayloadFormatIndicator
// 78,PropRequestProblemInformation 39,PropUserProperty "\ETB\219\158\168\n\163\204\231\&6\198\167\136\206\140\132"
// "\235\144\185\206n\202\145\GS\GSr\216Y\233z\235",PropMaximumPacketSize 6755,PropContentType
// "B\198",PropSharedSubscriptionAvailable 221,PropAssignedClientIdentifier
// "\132\186\207sp\139,\148\233\154\137\160",PropTopicAliasMaximum 13715,PropMaximumPacketSize
// 2433,PropSessionExpiryInterval 16981,PropTopicAlias 10270,PropUserProperty
// "\217\SYNH\205\201\163\196\135\237\239z;\167\227\NUL\202\&3\180\132I\199\200 r\156N"
// "\EM\164\182\b\235t&\139\158f\253.\b\ETX\195\219h?w\129\GS\140\141\234",PropPayloadFormatIndicator 167,PropTopicAlias
// 31167,PropMaximumQoS 132,PropWildcardSubscriptionAvailable 6,PropMaximumPacketSize 24806,PropAssignedClientIdentifier
// "",PropSessionExpiryInterval 28383]
TEST(Subscribe5QCTest, Encode98) {
  uint8_t pkt[] = {
      0x82, 0xa8, 0x2,  0x6,  0x2,  0x87, 0x2,  0x12, 0x0,  0xe,  0x11, 0x63, 0x31, 0xb1, 0x1,  0x56, 0x3f, 0xef, 0xda,
      0x1b, 0x6e, 0x1,  0x77, 0xd1, 0x17, 0x2a, 0x1c, 0x0,  0x17, 0x6c, 0x34, 0x5,  0x54, 0x34, 0xce, 0xb4, 0x93, 0xf6,
      0x85, 0x90, 0xe3, 0xc4, 0x66, 0xf6, 0x72, 0x9c, 0xad, 0xb4, 0xb9, 0xa1, 0x91, 0x17, 0x22, 0x61, 0x6b, 0x29, 0x25,
      0x1a, 0x0,  0x3,  0x5f, 0xa8, 0xe8, 0x18, 0x0,  0x0,  0x11, 0x98, 0x3,  0x0,  0x15, 0xb4, 0xaf, 0x7f, 0xcb, 0xbc,
      0x59, 0x84, 0xda, 0x1f, 0x56, 0xeb, 0xf8, 0x13, 0xd3, 0x46, 0x57, 0xae, 0xd7, 0x30, 0x91, 0x14, 0x16, 0x0,  0xb,
      0xde, 0x81, 0xd3, 0x8,  0x58, 0xb3, 0xe4, 0x9d, 0x12, 0xff, 0x57, 0x2,  0x0,  0x0,  0x72, 0x52, 0x1,  0x4e, 0x17,
      0x27, 0x26, 0x0,  0xf,  0x17, 0xdb, 0x9e, 0xa8, 0xa,  0xa3, 0xcc, 0xe7, 0x36, 0xc6, 0xa7, 0x88, 0xce, 0x8c, 0x84,
      0x0,  0xf,  0xeb, 0x90, 0xb9, 0xce, 0x6e, 0xca, 0x91, 0x1d, 0x1d, 0x72, 0xd8, 0x59, 0xe9, 0x7a, 0xeb, 0x27, 0x0,
      0x0,  0x1a, 0x63, 0x3,  0x0,  0x2,  0x42, 0xc6, 0x2a, 0xdd, 0x12, 0x0,  0xc,  0x84, 0xba, 0xcf, 0x73, 0x70, 0x8b,
      0x2c, 0x94, 0xe9, 0x9a, 0x89, 0xa0, 0x22, 0x35, 0x93, 0x27, 0x0,  0x0,  0x9,  0x81, 0x11, 0x0,  0x0,  0x42, 0x55,
      0x23, 0x28, 0x1e, 0x26, 0x0,  0x1a, 0xd9, 0x16, 0x48, 0xcd, 0xc9, 0xa3, 0xc4, 0x87, 0xed, 0xef, 0x7a, 0x3b, 0xa7,
      0xe3, 0x0,  0xca, 0x33, 0xb4, 0x84, 0x49, 0xc7, 0xc8, 0x20, 0x72, 0x9c, 0x4e, 0x0,  0x18, 0x19, 0xa4, 0xb6, 0x8,
      0xeb, 0x74, 0x26, 0x8b, 0x9e, 0x66, 0xfd, 0x2e, 0x8,  0x3,  0xc3, 0xdb, 0x68, 0x3f, 0x77, 0x81, 0x1d, 0x8c, 0x8d,
      0xea, 0x1,  0xa7, 0x23, 0x79, 0xbf, 0x24, 0x84, 0x28, 0x6,  0x27, 0x0,  0x0,  0x60, 0xe6, 0x12, 0x0,  0x0,  0x11,
      0x0,  0x0,  0x6e, 0xdf, 0x0,  0x1a, 0x88, 0x76, 0x39, 0xfc, 0x98, 0x99, 0xb3, 0xc5, 0x50, 0x84, 0x46, 0x3,  0xb0,
      0x2,  0xa6, 0x52, 0x52, 0xde, 0x9,  0xd8, 0xa3, 0x8f, 0xfc, 0x6e, 0x17, 0xd4, 0x1};

  uint8_t buf[309] = {0};

  lwmqtt_string_t topic_filters[1];
  uint8_t topic_filter_s0_bytes[] = {0x88, 0x76, 0x39, 0xfc, 0x98, 0x99, 0xb3, 0xc5, 0x50, 0x84, 0x46, 0x3,  0xb0,
                                     0x2,  0xa6, 0x52, 0x52, 0xde, 0x9,  0xd8, 0xa3, 0x8f, 0xfc, 0x6e, 0x17, 0xd4};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0x11, 0x63, 0x31, 0xb1, 0x1, 0x56, 0x3f, 0xef, 0xda, 0x1b, 0x6e, 0x1, 0x77, 0xd1};
  uint8_t bytesprops1[] = {0x6c, 0x34, 0x5,  0x54, 0x34, 0xce, 0xb4, 0x93, 0xf6, 0x85, 0x90, 0xe3,
                           0xc4, 0x66, 0xf6, 0x72, 0x9c, 0xad, 0xb4, 0xb9, 0xa1, 0x91, 0x17};
  uint8_t bytesprops2[] = {0x5f, 0xa8, 0xe8};
  uint8_t bytesprops3[] = {0xb4, 0xaf, 0x7f, 0xcb, 0xbc, 0x59, 0x84, 0xda, 0x1f, 0x56, 0xeb,
                           0xf8, 0x13, 0xd3, 0x46, 0x57, 0xae, 0xd7, 0x30, 0x91, 0x14};
  uint8_t bytesprops4[] = {0xde, 0x81, 0xd3, 0x8, 0x58, 0xb3, 0xe4, 0x9d, 0x12, 0xff, 0x57};
  uint8_t bytesprops6[] = {0xeb, 0x90, 0xb9, 0xce, 0x6e, 0xca, 0x91, 0x1d, 0x1d, 0x72, 0xd8, 0x59, 0xe9, 0x7a, 0xeb};
  uint8_t bytesprops5[] = {0x17, 0xdb, 0x9e, 0xa8, 0xa, 0xa3, 0xcc, 0xe7, 0x36, 0xc6, 0xa7, 0x88, 0xce, 0x8c, 0x84};
  uint8_t bytesprops7[] = {0x42, 0xc6};
  uint8_t bytesprops8[] = {0x84, 0xba, 0xcf, 0x73, 0x70, 0x8b, 0x2c, 0x94, 0xe9, 0x9a, 0x89, 0xa0};
  uint8_t bytesprops10[] = {0x19, 0xa4, 0xb6, 0x8,  0xeb, 0x74, 0x26, 0x8b, 0x9e, 0x66, 0xfd, 0x2e,
                            0x8,  0x3,  0xc3, 0xdb, 0x68, 0x3f, 0x77, 0x81, 0x1d, 0x8c, 0x8d, 0xea};
  uint8_t bytesprops9[] = {0xd9, 0x16, 0x48, 0xcd, 0xc9, 0xa3, 0xc4, 0x87, 0xed, 0xef, 0x7a, 0x3b, 0xa7,
                           0xe3, 0x0,  0xca, 0x33, 0xb4, 0x84, 0x49, 0xc7, 0xc8, 0x20, 0x72, 0x9c, 0x4e};
  uint8_t bytesprops11[] = {0};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {14, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 42}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {23, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 24939}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 37}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {3, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 4504}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {21, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {11, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)2, .value = {.int32 = 29266}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 39}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {15, (char*)&bytesprops5}, .v = {15, (char*)&bytesprops6}}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 6755}},
      {.prop = (lwmqtt_prop_t)3, .value = {.str = {2, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 221}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {12, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 13715}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 2433}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 16981}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 10270}},
      {.prop = (lwmqtt_prop_t)38, .value = {.pair = {.k = {26, (char*)&bytesprops9}, .v = {24, (char*)&bytesprops10}}}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 167}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 31167}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 132}},
      {.prop = (lwmqtt_prop_t)40, .value = {.byte = 6}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 24806}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {0, (char*)&bytesprops11}}},
      {.prop = (lwmqtt_prop_t)17, .value = {.int32 = 28383}},
  };

  lwmqtt_properties_t props = {29, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 1538, 1, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 22336 [("\239\178\194.\198\235(\167c\190\ETX\155\184\185\245\170}\US\231$\149\255\212",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("3\STXm\179%\DLE\247O\NULI\CAN\t\180\147\136\133\176\195[r\158\131\b\SOE\SYN\139\163\154",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\225\235\137<S\DEL4\245\221aD\167e\n\v\219\156\"\SYNIKN\161\162\217",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\192\248Z\217\171\ETX\220u\NAKu\b7\STX(\129\DC3\FS\223h\195\194\136\a@\SUB9lo\251",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("\252\147\191\160\176p\tq\131\159\156X\152<\168\141\140\229*\196[",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS = QoS2})] [PropAuthenticationData
// "\201\222\200\SO\224 \230\130x\249\137\204[]\133\242h&B\176^U\150\DELA-3",PropMaximumPacketSize
// 32231,PropResponseTopic "\212\205~*z\DC1\157\NUL\r#\209\v\140g\DLE,\219",PropAssignedClientIdentifier
// "\185\b\CAN\211r\EMB\188#F|\ENQ\US\ESC\EOTec'\137w\185\169",PropMaximumQoS 205,PropMaximumQoS 3,PropReceiveMaximum
// 5414,PropServerReference "d\134E\189",PropRequestResponseInformation 178,PropWillDelayInterval 31183,PropTopicAlias
// 27120,PropMaximumPacketSize 23005,PropReasonString
// "=\169.^b\226\130\236\213\206X7\131)\236Ed[\243{W",PropResponseTopic
// "\188U\RS\243\137\216\161\185\247\222\236\&2\160j\209\GS\ETB\241\186\181",PropRetainAvailable
// 47,PropPayloadFormatIndicator 186,PropResponseTopic "YS\221[\DELP\200\156\&2",PropCorrelationData
// "\GS\227p\225\204\DC2\238\207\149G\204\&4\SI]-2[V+T\209\160D\210\&8\246_9",PropAssignedClientIdentifier
// "_B\226\237\204\188\&6\"']>\179 ",PropRequestProblemInformation 71,PropTopicAlias 23140,PropTopicAliasMaximum
// 1797,PropMaximumPacketSize 22929,PropMaximumQoS 129,PropRetainAvailable 26,PropServerReference
// "]\140\148e\196yn\218+U\DEL\DC3\153P\EOT\131fk\EOT",PropReasonString "\136\&9gq\194-",PropSharedSubscriptionAvailable
// 175,PropRequestProblemInformation 36,PropCorrelationData
// "\ESC-\165\237\149\204q\219\"\138u(\249>\SYN\186==\248\155(\254\SUB\139"]
TEST(Subscribe5QCTest, Encode99) {
  uint8_t pkt[] = {
      0x82, 0xbc, 0x3,  0x57, 0x40, 0xaa, 0x2,  0x16, 0x0,  0x1b, 0xc9, 0xde, 0xc8, 0xe,  0xe0, 0x20, 0xe6, 0x82, 0x78,
      0xf9, 0x89, 0xcc, 0x5b, 0x5d, 0x85, 0xf2, 0x68, 0x26, 0x42, 0xb0, 0x5e, 0x55, 0x96, 0x7f, 0x41, 0x2d, 0x33, 0x27,
      0x0,  0x0,  0x7d, 0xe7, 0x8,  0x0,  0x11, 0xd4, 0xcd, 0x7e, 0x2a, 0x7a, 0x11, 0x9d, 0x0,  0xd,  0x23, 0xd1, 0xb,
      0x8c, 0x67, 0x10, 0x2c, 0xdb, 0x12, 0x0,  0x16, 0xb9, 0x8,  0x18, 0xd3, 0x72, 0x19, 0x42, 0xbc, 0x23, 0x46, 0x7c,
      0x5,  0x1f, 0x1b, 0x4,  0x65, 0x63, 0x27, 0x89, 0x77, 0xb9, 0xa9, 0x24, 0xcd, 0x24, 0x3,  0x21, 0x15, 0x26, 0x1c,
      0x0,  0x4,  0x64, 0x86, 0x45, 0xbd, 0x19, 0xb2, 0x18, 0x0,  0x0,  0x79, 0xcf, 0x23, 0x69, 0xf0, 0x27, 0x0,  0x0,
      0x59, 0xdd, 0x1f, 0x0,  0x15, 0x3d, 0xa9, 0x2e, 0x5e, 0x62, 0xe2, 0x82, 0xec, 0xd5, 0xce, 0x58, 0x37, 0x83, 0x29,
      0xec, 0x45, 0x64, 0x5b, 0xf3, 0x7b, 0x57, 0x8,  0x0,  0x14, 0xbc, 0x55, 0x1e, 0xf3, 0x89, 0xd8, 0xa1, 0xb9, 0xf7,
      0xde, 0xec, 0x32, 0xa0, 0x6a, 0xd1, 0x1d, 0x17, 0xf1, 0xba, 0xb5, 0x25, 0x2f, 0x1,  0xba, 0x8,  0x0,  0x9,  0x59,
      0x53, 0xdd, 0x5b, 0x7f, 0x50, 0xc8, 0x9c, 0x32, 0x9,  0x0,  0x1c, 0x1d, 0xe3, 0x70, 0xe1, 0xcc, 0x12, 0xee, 0xcf,
      0x95, 0x47, 0xcc, 0x34, 0xf,  0x5d, 0x2d, 0x32, 0x5b, 0x56, 0x2b, 0x54, 0xd1, 0xa0, 0x44, 0xd2, 0x38, 0xf6, 0x5f,
      0x39, 0x12, 0x0,  0xd,  0x5f, 0x42, 0xe2, 0xed, 0xcc, 0xbc, 0x36, 0x22, 0x27, 0x5d, 0x3e, 0xb3, 0x20, 0x17, 0x47,
      0x23, 0x5a, 0x64, 0x22, 0x7,  0x5,  0x27, 0x0,  0x0,  0x59, 0x91, 0x24, 0x81, 0x25, 0x1a, 0x1c, 0x0,  0x13, 0x5d,
      0x8c, 0x94, 0x65, 0xc4, 0x79, 0x6e, 0xda, 0x2b, 0x55, 0x7f, 0x13, 0x99, 0x50, 0x4,  0x83, 0x66, 0x6b, 0x4,  0x1f,
      0x0,  0x6,  0x88, 0x39, 0x67, 0x71, 0xc2, 0x2d, 0x2a, 0xaf, 0x17, 0x24, 0x9,  0x0,  0x18, 0x1b, 0x2d, 0xa5, 0xed,
      0x95, 0xcc, 0x71, 0xdb, 0x22, 0x8a, 0x75, 0x28, 0xf9, 0x3e, 0x16, 0xba, 0x3d, 0x3d, 0xf8, 0x9b, 0x28, 0xfe, 0x1a,
      0x8b, 0x0,  0x17, 0xef, 0xb2, 0xc2, 0x2e, 0xc6, 0xeb, 0x28, 0xa7, 0x63, 0xbe, 0x3,  0x9b, 0xb8, 0xb9, 0xf5, 0xaa,
      0x7d, 0x1f, 0xe7, 0x24, 0x95, 0xff, 0xd4, 0x1,  0x0,  0x1d, 0x33, 0x2,  0x6d, 0xb3, 0x25, 0x10, 0xf7, 0x4f, 0x0,
      0x49, 0x18, 0x9,  0xb4, 0x93, 0x88, 0x85, 0xb0, 0xc3, 0x5b, 0x72, 0x9e, 0x83, 0x8,  0xe,  0x45, 0x16, 0x8b, 0xa3,
      0x9a, 0x1,  0x0,  0x19, 0xe1, 0xeb, 0x89, 0x3c, 0x53, 0x7f, 0x34, 0xf5, 0xdd, 0x61, 0x44, 0xa7, 0x65, 0xa,  0xb,
      0xdb, 0x9c, 0x22, 0x16, 0x49, 0x4b, 0x4e, 0xa1, 0xa2, 0xd9, 0x1,  0x0,  0x1d, 0xc0, 0xf8, 0x5a, 0xd9, 0xab, 0x3,
      0xdc, 0x75, 0x15, 0x75, 0x8,  0x37, 0x2,  0x28, 0x81, 0x13, 0x1c, 0xdf, 0x68, 0xc3, 0xc2, 0x88, 0x7,  0x40, 0x1a,
      0x39, 0x6c, 0x6f, 0xfb, 0x0,  0x0,  0x15, 0xfc, 0x93, 0xbf, 0xa0, 0xb0, 0x70, 0x9,  0x71, 0x83, 0x9f, 0x9c, 0x58,
      0x98, 0x3c, 0xa8, 0x8d, 0x8c, 0xe5, 0x2a, 0xc4, 0x5b, 0x2};

  uint8_t buf[457] = {0};

  lwmqtt_string_t topic_filters[5];
  uint8_t topic_filter_s0_bytes[] = {0xef, 0xb2, 0xc2, 0x2e, 0xc6, 0xeb, 0x28, 0xa7, 0x63, 0xbe, 0x3, 0x9b,
                                     0xb8, 0xb9, 0xf5, 0xaa, 0x7d, 0x1f, 0xe7, 0x24, 0x95, 0xff, 0xd4};
  lwmqtt_string_t topic_filter_s0 = {23, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x33, 0x2,  0x6d, 0xb3, 0x25, 0x10, 0xf7, 0x4f, 0x0,  0x49,
                                     0x18, 0x9,  0xb4, 0x93, 0x88, 0x85, 0xb0, 0xc3, 0x5b, 0x72,
                                     0x9e, 0x83, 0x8,  0xe,  0x45, 0x16, 0x8b, 0xa3, 0x9a};
  lwmqtt_string_t topic_filter_s1 = {29, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xe1, 0xeb, 0x89, 0x3c, 0x53, 0x7f, 0x34, 0xf5, 0xdd, 0x61, 0x44, 0xa7, 0x65,
                                     0xa,  0xb,  0xdb, 0x9c, 0x22, 0x16, 0x49, 0x4b, 0x4e, 0xa1, 0xa2, 0xd9};
  lwmqtt_string_t topic_filter_s2 = {25, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xc0, 0xf8, 0x5a, 0xd9, 0xab, 0x3,  0xdc, 0x75, 0x15, 0x75,
                                     0x8,  0x37, 0x2,  0x28, 0x81, 0x13, 0x1c, 0xdf, 0x68, 0xc3,
                                     0xc2, 0x88, 0x7,  0x40, 0x1a, 0x39, 0x6c, 0x6f, 0xfb};
  lwmqtt_string_t topic_filter_s3 = {29, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0xfc, 0x93, 0xbf, 0xa0, 0xb0, 0x70, 0x9,  0x71, 0x83, 0x9f, 0x9c,
                                     0x58, 0x98, 0x3c, 0xa8, 0x8d, 0x8c, 0xe5, 0x2a, 0xc4, 0x5b};
  lwmqtt_string_t topic_filter_s4 = {21, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS0, LWMQTT_QOS2};
  uint8_t bytesprops0[] = {0xc9, 0xde, 0xc8, 0xe,  0xe0, 0x20, 0xe6, 0x82, 0x78, 0xf9, 0x89, 0xcc, 0x5b, 0x5d,
                           0x85, 0xf2, 0x68, 0x26, 0x42, 0xb0, 0x5e, 0x55, 0x96, 0x7f, 0x41, 0x2d, 0x33};
  uint8_t bytesprops1[] = {0xd4, 0xcd, 0x7e, 0x2a, 0x7a, 0x11, 0x9d, 0x0, 0xd,
                           0x23, 0xd1, 0xb,  0x8c, 0x67, 0x10, 0x2c, 0xdb};
  uint8_t bytesprops2[] = {0xb9, 0x8,  0x18, 0xd3, 0x72, 0x19, 0x42, 0xbc, 0x23, 0x46, 0x7c,
                           0x5,  0x1f, 0x1b, 0x4,  0x65, 0x63, 0x27, 0x89, 0x77, 0xb9, 0xa9};
  uint8_t bytesprops3[] = {0x64, 0x86, 0x45, 0xbd};
  uint8_t bytesprops4[] = {0x3d, 0xa9, 0x2e, 0x5e, 0x62, 0xe2, 0x82, 0xec, 0xd5, 0xce, 0x58,
                           0x37, 0x83, 0x29, 0xec, 0x45, 0x64, 0x5b, 0xf3, 0x7b, 0x57};
  uint8_t bytesprops5[] = {0xbc, 0x55, 0x1e, 0xf3, 0x89, 0xd8, 0xa1, 0xb9, 0xf7, 0xde,
                           0xec, 0x32, 0xa0, 0x6a, 0xd1, 0x1d, 0x17, 0xf1, 0xba, 0xb5};
  uint8_t bytesprops6[] = {0x59, 0x53, 0xdd, 0x5b, 0x7f, 0x50, 0xc8, 0x9c, 0x32};
  uint8_t bytesprops7[] = {0x1d, 0xe3, 0x70, 0xe1, 0xcc, 0x12, 0xee, 0xcf, 0x95, 0x47, 0xcc, 0x34, 0xf,  0x5d,
                           0x2d, 0x32, 0x5b, 0x56, 0x2b, 0x54, 0xd1, 0xa0, 0x44, 0xd2, 0x38, 0xf6, 0x5f, 0x39};
  uint8_t bytesprops8[] = {0x5f, 0x42, 0xe2, 0xed, 0xcc, 0xbc, 0x36, 0x22, 0x27, 0x5d, 0x3e, 0xb3, 0x20};
  uint8_t bytesprops9[] = {0x5d, 0x8c, 0x94, 0x65, 0xc4, 0x79, 0x6e, 0xda, 0x2b, 0x55,
                           0x7f, 0x13, 0x99, 0x50, 0x4,  0x83, 0x66, 0x6b, 0x4};
  uint8_t bytesprops10[] = {0x88, 0x39, 0x67, 0x71, 0xc2, 0x2d};
  uint8_t bytesprops11[] = {0x1b, 0x2d, 0xa5, 0xed, 0x95, 0xcc, 0x71, 0xdb, 0x22, 0x8a, 0x75, 0x28,
                            0xf9, 0x3e, 0x16, 0xba, 0x3d, 0x3d, 0xf8, 0x9b, 0x28, 0xfe, 0x1a, 0x8b};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)22, .value = {.str = {27, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 32231}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {17, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {22, (char*)&bytesprops2}}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 205}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 3}},
      {.prop = (lwmqtt_prop_t)33, .value = {.int16 = 5414}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {4, (char*)&bytesprops3}}},
      {.prop = (lwmqtt_prop_t)25, .value = {.byte = 178}},
      {.prop = (lwmqtt_prop_t)24, .value = {.int32 = 31183}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 27120}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 23005}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {21, (char*)&bytesprops4}}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {20, (char*)&bytesprops5}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 47}},
      {.prop = (lwmqtt_prop_t)1, .value = {.byte = 186}},
      {.prop = (lwmqtt_prop_t)8, .value = {.str = {9, (char*)&bytesprops6}}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {28, (char*)&bytesprops7}}},
      {.prop = (lwmqtt_prop_t)18, .value = {.str = {13, (char*)&bytesprops8}}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 71}},
      {.prop = (lwmqtt_prop_t)35, .value = {.int16 = 23140}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 1797}},
      {.prop = (lwmqtt_prop_t)39, .value = {.int32 = 22929}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 129}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 26}},
      {.prop = (lwmqtt_prop_t)28, .value = {.str = {19, (char*)&bytesprops9}}},
      {.prop = (lwmqtt_prop_t)31, .value = {.str = {6, (char*)&bytesprops10}}},
      {.prop = (lwmqtt_prop_t)42, .value = {.byte = 175}},
      {.prop = (lwmqtt_prop_t)23, .value = {.byte = 36}},
      {.prop = (lwmqtt_prop_t)9, .value = {.str = {24, (char*)&bytesprops11}}},
  };

  lwmqtt_properties_t props = {30, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 22336, 5, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}

// SubscribeRequest 13807 [("wL\191\189\221|G\238\226$\136\tIp\SO\n\STX\165, \246K\185U\237\\",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS0}),("T\FS\235=\v;\128q\152\153}\"U[\178",SubOptions {_retainHandling = SendOnSubscribe, _retainAsPublished =
// False, _noLocal = False, _subQoS = QoS1}),("\184\150",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1}),("\190\236)\ENQ@h\184\224\&0",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("j\178B\166\172b\202\203P\STX,'\174\145\243o>\197\223\157\229|5\SOH\220\&94\241",SubOptions {_retainHandling
// = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("BR\DLEz\176\178\218\206\141\160\252]Y\170\218\142\167\ETX\204\229=\r\255UWG",SubOptions {_retainHandling =
// SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS1}),("\144\229\227)\143\168?\194\171\204\212\138\180\ETX\176\GS+\SO\254C>bp\150\184\247\144\231 ",SubOptions
// {_retainHandling = SendOnSubscribe, _retainAsPublished = False, _noLocal = False, _subQoS =
// QoS2}),("\222CJ\178\&0\215~\186\&5\STX/\241\178\136H\207\"",SubOptions {_retainHandling = SendOnSubscribe,
// _retainAsPublished = False, _noLocal = False, _subQoS = QoS1})] [PropServerKeepAlive 18605,PropMaximumQoS
// 231,PropResponseInformation "\249\200",PropResponseInformation "J\246\210\198k\185wX",PropRetainAvailable
// 78,PropTopicAliasMaximum 17928,PropSubscriptionIdentifierAvailable 87]
TEST(Subscribe5QCTest, Encode100) {
  uint8_t pkt[] = {0x82, 0xcf, 0x1,  0x35, 0xef, 0x1c, 0x13, 0x48, 0xad, 0x24, 0xe7, 0x1a, 0x0,  0x2,  0xf9, 0xc8, 0x1a,
                   0x0,  0x8,  0x4a, 0xf6, 0xd2, 0xc6, 0x6b, 0xb9, 0x77, 0x58, 0x25, 0x4e, 0x22, 0x46, 0x8,  0x29, 0x57,
                   0x0,  0x1a, 0x77, 0x4c, 0xbf, 0xbd, 0xdd, 0x7c, 0x47, 0xee, 0xe2, 0x24, 0x88, 0x9,  0x49, 0x70, 0xe,
                   0xa,  0x2,  0xa5, 0x2c, 0x20, 0xf6, 0x4b, 0xb9, 0x55, 0xed, 0x5c, 0x0,  0x0,  0xf,  0x54, 0x1c, 0xeb,
                   0x3d, 0xb,  0x3b, 0x80, 0x71, 0x98, 0x99, 0x7d, 0x22, 0x55, 0x5b, 0xb2, 0x1,  0x0,  0x2,  0xb8, 0x96,
                   0x1,  0x0,  0x9,  0xbe, 0xec, 0x29, 0x5,  0x40, 0x68, 0xb8, 0xe0, 0x30, 0x1,  0x0,  0x1c, 0x6a, 0xb2,
                   0x42, 0xa6, 0xac, 0x62, 0xca, 0xcb, 0x50, 0x2,  0x2c, 0x27, 0xae, 0x91, 0xf3, 0x6f, 0x3e, 0xc5, 0xdf,
                   0x9d, 0xe5, 0x7c, 0x35, 0x1,  0xdc, 0x39, 0x34, 0xf1, 0x2,  0x0,  0x1a, 0x42, 0x52, 0x10, 0x7a, 0xb0,
                   0xb2, 0xda, 0xce, 0x8d, 0xa0, 0xfc, 0x5d, 0x59, 0xaa, 0xda, 0x8e, 0xa7, 0x3,  0xcc, 0xe5, 0x3d, 0xd,
                   0xff, 0x55, 0x57, 0x47, 0x1,  0x0,  0x1d, 0x90, 0xe5, 0xe3, 0x29, 0x8f, 0xa8, 0x3f, 0xc2, 0xab, 0xcc,
                   0xd4, 0x8a, 0xb4, 0x3,  0xb0, 0x1d, 0x2b, 0xe,  0xfe, 0x43, 0x3e, 0x62, 0x70, 0x96, 0xb8, 0xf7, 0x90,
                   0xe7, 0x20, 0x2,  0x0,  0x11, 0xde, 0x43, 0x4a, 0xb2, 0x30, 0xd7, 0x7e, 0xba, 0x35, 0x2,  0x2f, 0xf1,
                   0xb2, 0x88, 0x48, 0xcf, 0x22, 0x1};

  uint8_t buf[220] = {0};

  lwmqtt_string_t topic_filters[8];
  uint8_t topic_filter_s0_bytes[] = {0x77, 0x4c, 0xbf, 0xbd, 0xdd, 0x7c, 0x47, 0xee, 0xe2, 0x24, 0x88, 0x9,  0x49,
                                     0x70, 0xe,  0xa,  0x2,  0xa5, 0x2c, 0x20, 0xf6, 0x4b, 0xb9, 0x55, 0xed, 0x5c};
  lwmqtt_string_t topic_filter_s0 = {26, (char*)&topic_filter_s0_bytes};
  topic_filters[0] = topic_filter_s0;
  uint8_t topic_filter_s1_bytes[] = {0x54, 0x1c, 0xeb, 0x3d, 0xb,  0x3b, 0x80, 0x71,
                                     0x98, 0x99, 0x7d, 0x22, 0x55, 0x5b, 0xb2};
  lwmqtt_string_t topic_filter_s1 = {15, (char*)&topic_filter_s1_bytes};
  topic_filters[1] = topic_filter_s1;
  uint8_t topic_filter_s2_bytes[] = {0xb8, 0x96};
  lwmqtt_string_t topic_filter_s2 = {2, (char*)&topic_filter_s2_bytes};
  topic_filters[2] = topic_filter_s2;
  uint8_t topic_filter_s3_bytes[] = {0xbe, 0xec, 0x29, 0x5, 0x40, 0x68, 0xb8, 0xe0, 0x30};
  lwmqtt_string_t topic_filter_s3 = {9, (char*)&topic_filter_s3_bytes};
  topic_filters[3] = topic_filter_s3;
  uint8_t topic_filter_s4_bytes[] = {0x6a, 0xb2, 0x42, 0xa6, 0xac, 0x62, 0xca, 0xcb, 0x50, 0x2, 0x2c, 0x27, 0xae, 0x91,
                                     0xf3, 0x6f, 0x3e, 0xc5, 0xdf, 0x9d, 0xe5, 0x7c, 0x35, 0x1, 0xdc, 0x39, 0x34, 0xf1};
  lwmqtt_string_t topic_filter_s4 = {28, (char*)&topic_filter_s4_bytes};
  topic_filters[4] = topic_filter_s4;
  uint8_t topic_filter_s5_bytes[] = {0x42, 0x52, 0x10, 0x7a, 0xb0, 0xb2, 0xda, 0xce, 0x8d, 0xa0, 0xfc, 0x5d, 0x59,
                                     0xaa, 0xda, 0x8e, 0xa7, 0x3,  0xcc, 0xe5, 0x3d, 0xd,  0xff, 0x55, 0x57, 0x47};
  lwmqtt_string_t topic_filter_s5 = {26, (char*)&topic_filter_s5_bytes};
  topic_filters[5] = topic_filter_s5;
  uint8_t topic_filter_s6_bytes[] = {0x90, 0xe5, 0xe3, 0x29, 0x8f, 0xa8, 0x3f, 0xc2, 0xab, 0xcc,
                                     0xd4, 0x8a, 0xb4, 0x3,  0xb0, 0x1d, 0x2b, 0xe,  0xfe, 0x43,
                                     0x3e, 0x62, 0x70, 0x96, 0xb8, 0xf7, 0x90, 0xe7, 0x20};
  lwmqtt_string_t topic_filter_s6 = {29, (char*)&topic_filter_s6_bytes};
  topic_filters[6] = topic_filter_s6;
  uint8_t topic_filter_s7_bytes[] = {0xde, 0x43, 0x4a, 0xb2, 0x30, 0xd7, 0x7e, 0xba, 0x35,
                                     0x2,  0x2f, 0xf1, 0xb2, 0x88, 0x48, 0xcf, 0x22};
  lwmqtt_string_t topic_filter_s7 = {17, (char*)&topic_filter_s7_bytes};
  topic_filters[7] = topic_filter_s7;
  lwmqtt_qos_t qos_levels[] = {LWMQTT_QOS0, LWMQTT_QOS1, LWMQTT_QOS1, LWMQTT_QOS1,
                               LWMQTT_QOS2, LWMQTT_QOS1, LWMQTT_QOS2, LWMQTT_QOS1};
  uint8_t bytesprops0[] = {0xf9, 0xc8};
  uint8_t bytesprops1[] = {0x4a, 0xf6, 0xd2, 0xc6, 0x6b, 0xb9, 0x77, 0x58};

  lwmqtt_property_t propslist[] = {
      {.prop = (lwmqtt_prop_t)19, .value = {.int16 = 18605}},
      {.prop = (lwmqtt_prop_t)36, .value = {.byte = 231}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {2, (char*)&bytesprops0}}},
      {.prop = (lwmqtt_prop_t)26, .value = {.str = {8, (char*)&bytesprops1}}},
      {.prop = (lwmqtt_prop_t)37, .value = {.byte = 78}},
      {.prop = (lwmqtt_prop_t)34, .value = {.int16 = 17928}},
      {.prop = (lwmqtt_prop_t)41, .value = {.byte = 87}},
  };

  lwmqtt_properties_t props = {7, (lwmqtt_property_t*)&propslist};
  size_t len = 0;
  lwmqtt_err_t err =
      lwmqtt_encode_subscribe(buf, sizeof(buf), &len, LWMQTT_MQTT5, 13807, 8, topic_filters, qos_levels, props);

  EXPECT_EQ(err, LWMQTT_SUCCESS);
  EXPECT_ARRAY_EQ(pkt, buf, len);
}
